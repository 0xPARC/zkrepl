var iA=Object.defineProperty,oA=Object.defineProperties;var aA=Object.getOwnPropertyDescriptors;var wd=Object.getOwnPropertySymbols;var rA=Object.prototype.hasOwnProperty,sA=Object.prototype.propertyIsEnumerable;var rs=(ve,_e,Fe)=>_e in ve?iA(ve,_e,{enumerable:!0,configurable:!0,writable:!0,value:Fe}):ve[_e]=Fe,ta=(ve,_e)=>{for(var Fe in _e||(_e={}))rA.call(_e,Fe)&&rs(ve,Fe,_e[Fe]);if(wd)for(var Fe of wd(_e))sA.call(_e,Fe)&&rs(ve,Fe,_e[Fe]);return ve},ss=(ve,_e)=>oA(ve,aA(_e));var ai=(ve,_e,Fe)=>(rs(ve,typeof _e!="symbol"?_e+"":_e,Fe),Fe);(function(ve){"use strict";function _e(e,t){return t.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(i){if(i!=="default"&&!(i in e)){var o=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:function(){return n[i]}})}})}),Object.freeze(e)}async function Fe(e,t){t=t||{};const n=await WebAssembly.compile(e);let i;const o=await WebAssembly.instantiate(n,{runtime:{exceptionHandler:function(h){let u;throw h==1?u="Signal not found. ":h==2?u="Too many signals set. ":h==3?u="Signal already set. ":h==4?u="Assert Failed. ":h==5?u="Not enough memory. ":u=`Unknown error
`,u+=c(),new Error(u)},showSharedRWMemory:function(){d()}}}),a=!0;return i=new Id(o,a),i;function c(){for(var h="",u=o.exports.getMessageChar();u!=0;)h+=String.fromCharCode(u),u=o.exports.getMessageChar();return h}function d(){const h=o.exports.getFieldNumLen32(),u=new Uint32Array(h);for(let s=0;s<h;s++)u[h-1-s]=o.exports.readSharedRWMemory(s);t.log(ea(u))}}class Id{constructor(t,n){ai(this,"instance");ai(this,"version");ai(this,"n32");ai(this,"witnessSize");ai(this,"prime");ai(this,"sanityCheck");this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const i=new Array(this.n32);for(let o=0;o<this.n32;o++)i[this.n32-1-o]=this.instance.exports.readSharedRWMemory(o);this.prime=ea(i),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=n}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,n){this.instance.exports.init(this.sanityCheck||n?1:0);const i=Object.keys(t);var o=0;if(i.forEach(a=>{const c=Cd(a),d=parseInt(c.slice(0,8),16),h=parseInt(c.slice(8,16),16),u=Ed(t[a]);for(let s=0;s<u.length;s++){const _=bd(u[s],this.n32);for(let L=0;L<this.n32;L++)this.instance.exports.writeSharedRWMemory(L,_[this.n32-1-L]);try{this.instance.exports.setInputSignal(d,h,s),o++}catch(L){throw L.message.includes("Signal not found.")?new Error(`Unexpected input signal "${a}".`):new Error(L)}}}),o<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${o} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,n){const i=[];await this._doCalculateWitness(t,n);for(let o=0;o<this.witnessSize;o++){this.instance.exports.getWitness(o);const a=new Uint32Array(this.n32);for(let c=0;c<this.n32;c++)a[this.n32-1-c]=this.instance.exports.readSharedRWMemory(c);i.push(ea(a))}return i}async calculateBinWitness(t,n){const i=new Uint32Array(this.witnessSize*this.n32),o=new Uint8Array(i.buffer);await this._doCalculateWitness(t,n);for(let a=0;a<this.witnessSize;a++){this.instance.exports.getWitness(a);const c=a*this.n32;for(let d=0;d<this.n32;d++)i[c+d]=this.instance.exports.readSharedRWMemory(d)}return o}async calculateWTNSBin(t,n){const i=new Uint32Array(this.witnessSize*this.n32+this.n32+11),o=new Uint8Array(i.buffer);await this._doCalculateWitness(t,n),o[0]="w".charCodeAt(0),o[1]="t".charCodeAt(0),o[2]="n".charCodeAt(0),o[3]="s".charCodeAt(0),i[1]=2,i[2]=2,i[3]=1;const a=this.n32*4,d=(8+a).toString(16);i[4]=parseInt(d.slice(0,8),16),i[5]=parseInt(d.slice(8,16),16),i[6]=a,this.instance.exports.getRawPrime();var h=7;for(let _=0;_<this.n32;_++)i[h+_]=this.instance.exports.readSharedRWMemory(_);h+=this.n32,i[h]=this.witnessSize,h++,i[h]=2,h++;const s=(a*this.witnessSize).toString(16);i[h]=parseInt(s.slice(0,8),16),i[h+1]=parseInt(s.slice(8,16),16),h+=2;for(let _=0;_<this.witnessSize;_++){this.instance.exports.getWitness(_);for(let L=0;L<this.n32;L++)i[h+L]=this.instance.exports.readSharedRWMemory(L);h+=this.n32}return o}}function bd(e,t){const n=[];let i=BigInt(e);const o=BigInt(4294967296);for(;i;)n.unshift(Number(i%o)),i=i/o;if(t)for(var a=t-n.length;a>0;)n.unshift(0),a--;return n}function ea(e){var t=BigInt(0);const n=BigInt(4294967296);for(let i=0;i<e.length;i++)t=t*n+BigInt(e[i]);return t}function Ed(e){var t=[];return n(t,e),t;function n(i,o){if(Array.isArray(o))for(let a=0;a<o.length;a++)n(i,o[a]);else i.push(o)}}function Cd(e){const t=BigInt(2)**BigInt(64);let n=BigInt("0xCBF29CE484222325");for(var i=0;i<e.length;i++)n^=BigInt(e[i].charCodeAt(0)),n*=BigInt(1099511628211),n%=t;let o=n.toString(16),a=16-o.length;return o="0".repeat(a).concat(o),o}var en=[],Ve=[],vd=typeof Uint8Array!="undefined"?Uint8Array:Array,na=!1;function cs(){na=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)en[t]=e[t],Ve[e.charCodeAt(t)]=t;Ve["-".charCodeAt(0)]=62,Ve["_".charCodeAt(0)]=63}function Fd(e){na||cs();var t,n,i,o,a,c,d=e.length;if(d%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a=e[d-2]==="="?2:e[d-1]==="="?1:0,c=new vd(d*3/4-a),i=a>0?d-4:d;var h=0;for(t=0,n=0;t<i;t+=4,n+=3)o=Ve[e.charCodeAt(t)]<<18|Ve[e.charCodeAt(t+1)]<<12|Ve[e.charCodeAt(t+2)]<<6|Ve[e.charCodeAt(t+3)],c[h++]=o>>16&255,c[h++]=o>>8&255,c[h++]=o&255;return a===2?(o=Ve[e.charCodeAt(t)]<<2|Ve[e.charCodeAt(t+1)]>>4,c[h++]=o&255):a===1&&(o=Ve[e.charCodeAt(t)]<<10|Ve[e.charCodeAt(t+1)]<<4|Ve[e.charCodeAt(t+2)]>>2,c[h++]=o>>8&255,c[h++]=o&255),c}function Sd(e){return en[e>>18&63]+en[e>>12&63]+en[e>>6&63]+en[e&63]}function Bd(e,t,n){for(var i,o=[],a=t;a<n;a+=3)i=(e[a]<<16)+(e[a+1]<<8)+e[a+2],o.push(Sd(i));return o.join("")}function ls(e){na||cs();for(var t,n=e.length,i=n%3,o="",a=[],c=16383,d=0,h=n-i;d<h;d+=c)a.push(Bd(e,d,d+c>h?h:d+c));return i===1?(t=e[n-1],o+=en[t>>2],o+=en[t<<4&63],o+="=="):i===2&&(t=(e[n-2]<<8)+e[n-1],o+=en[t>>10],o+=en[t>>4&63],o+=en[t<<2&63],o+="="),a.push(o),a.join("")}function fo(e,t,n,i,o){var a,c,d=o*8-i-1,h=(1<<d)-1,u=h>>1,s=-7,_=n?o-1:0,L=n?-1:1,g=e[t+_];for(_+=L,a=g&(1<<-s)-1,g>>=-s,s+=d;s>0;a=a*256+e[t+_],_+=L,s-=8);for(c=a&(1<<-s)-1,a>>=-s,s+=i;s>0;c=c*256+e[t+_],_+=L,s-=8);if(a===0)a=1-u;else{if(a===h)return c?NaN:(g?-1:1)*(1/0);c=c+Math.pow(2,i),a=a-u}return(g?-1:1)*c*Math.pow(2,a-i)}function us(e,t,n,i,o,a){var c,d,h,u=a*8-o-1,s=(1<<u)-1,_=s>>1,L=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=i?0:a-1,F=i?1:-1,T=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(d=isNaN(t)?1:0,c=s):(c=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-c))<1&&(c--,h*=2),c+_>=1?t+=L/h:t+=L*Math.pow(2,1-_),t*h>=2&&(c++,h/=2),c+_>=s?(d=0,c=s):c+_>=1?(d=(t*h-1)*Math.pow(2,o),c=c+_):(d=t*Math.pow(2,_-1)*Math.pow(2,o),c=0));o>=8;e[n+g]=d&255,g+=F,d/=256,o-=8);for(c=c<<o|d,u+=o;u>0;e[n+g]=c&255,g+=F,c/=256,u-=8);e[n+g-F]|=T*128}var xd={}.toString,ds=Array.isArray||function(e){return xd.call(e)=="[object Array]"};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */var Od=50;bt.TYPED_ARRAY_SUPPORT=!0,ho();function ho(){return bt.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function mn(e,t){if(ho()<t)throw new RangeError("Invalid typed array length");return bt.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=bt.prototype):(e===null&&(e=new bt(t)),e.length=t),e}function bt(e,t,n){if(!bt.TYPED_ARRAY_SUPPORT&&!(this instanceof bt))return new bt(e,t,n);if(typeof e=="number"){if(typeof t=="string")throw new Error("If encoding is specified then the first argument must be a string");return ia(this,e)}return fs(this,e,t,n)}bt.poolSize=8192,bt._augment=function(e){return e.__proto__=bt.prototype,e};function fs(e,t,n,i){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer?Rd(e,t,n,i):typeof t=="string"?Pd(e,t,n):Ud(e,t)}bt.from=function(e,t,n){return fs(null,e,t,n)},bt.TYPED_ARRAY_SUPPORT&&(bt.prototype.__proto__=Uint8Array.prototype,bt.__proto__=Uint8Array,typeof Symbol!="undefined"&&Symbol.species&&bt[Symbol.species]===bt);function hs(e){if(typeof e!="number")throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function Td(e,t,n,i){return hs(t),t<=0?mn(e,t):n!==void 0?typeof i=="string"?mn(e,t).fill(n,i):mn(e,t).fill(n):mn(e,t)}bt.alloc=function(e,t,n){return Td(null,e,t,n)};function ia(e,t){if(hs(t),e=mn(e,t<0?0:aa(t)|0),!bt.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}bt.allocUnsafe=function(e){return ia(null,e)},bt.allocUnsafeSlow=function(e){return ia(null,e)};function Pd(e,t,n){if((typeof n!="string"||n==="")&&(n="utf8"),!bt.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=gs(t,n)|0;e=mn(e,i);var o=e.write(t,n);return o!==i&&(e=e.slice(0,o)),e}function oa(e,t){var n=t.length<0?0:aa(t.length)|0;e=mn(e,n);for(var i=0;i<n;i+=1)e[i]=t[i]&255;return e}function Rd(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return n===void 0&&i===void 0?t=new Uint8Array(t):i===void 0?t=new Uint8Array(t,n):t=new Uint8Array(t,n,i),bt.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=bt.prototype):e=oa(e,t),e}function Ud(e,t){if(nn(t)){var n=aa(t.length)|0;return e=mn(e,n),e.length===0||t.copy(e,0,0,n),e}if(t){if(typeof ArrayBuffer!="undefined"&&t.buffer instanceof ArrayBuffer||"length"in t)return typeof t.length!="number"||tf(t.length)?mn(e,0):oa(e,t);if(t.type==="Buffer"&&ds(t.data))return oa(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function aa(e){if(e>=ho())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ho().toString(16)+" bytes");return e|0}bt.isBuffer=ef;function nn(e){return!!(e!=null&&e._isBuffer)}bt.compare=function(t,n){if(!nn(t)||!nn(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var i=t.length,o=n.length,a=0,c=Math.min(i,o);a<c;++a)if(t[a]!==n[a]){i=t[a],o=n[a];break}return i<o?-1:o<i?1:0},bt.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},bt.concat=function(t,n){if(!ds(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return bt.alloc(0);var i;if(n===void 0)for(n=0,i=0;i<t.length;++i)n+=t[i].length;var o=bt.allocUnsafe(n),a=0;for(i=0;i<t.length;++i){var c=t[i];if(!nn(c))throw new TypeError('"list" argument must be an Array of Buffers');c.copy(o,a),a+=c.length}return o};function gs(e,t){if(nn(e))return e.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;typeof e!="string"&&(e=""+e);var n=e.length;if(n===0)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return _o(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n*2;case"hex":return n>>>1;case"base64":return bs(e).length;default:if(i)return _o(e).length;t=(""+t).toLowerCase(),i=!0}}bt.byteLength=gs;function Md(e,t,n){var i=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((n===void 0||n>this.length)&&(n=this.length),n<=0)||(n>>>=0,t>>>=0,n<=t))return"";for(e||(e="utf8");;)switch(e){case"hex":return Hd(this,t,n);case"utf8":case"utf-8":return Ls(this,t,n);case"ascii":return Wd(this,t,n);case"latin1":case"binary":return $d(this,t,n);case"base64":return kd(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return jd(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}bt.prototype._isBuffer=!0;function Qn(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}bt.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<t;n+=2)Qn(this,n,n+1);return this},bt.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<t;n+=4)Qn(this,n,n+3),Qn(this,n+1,n+2);return this},bt.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<t;n+=8)Qn(this,n,n+7),Qn(this,n+1,n+6),Qn(this,n+2,n+5),Qn(this,n+3,n+4);return this},bt.prototype.toString=function(){var t=this.length|0;return t===0?"":arguments.length===0?Ls(this,0,t):Md.apply(this,arguments)},bt.prototype.equals=function(t){if(!nn(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:bt.compare(this,t)===0},bt.prototype.inspect=function(){var t="",n=Od;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},bt.prototype.compare=function(t,n,i,o,a){if(!nn(t))throw new TypeError("Argument must be a Buffer");if(n===void 0&&(n=0),i===void 0&&(i=t?t.length:0),o===void 0&&(o=0),a===void 0&&(a=this.length),n<0||i>t.length||o<0||a>this.length)throw new RangeError("out of range index");if(o>=a&&n>=i)return 0;if(o>=a)return-1;if(n>=i)return 1;if(n>>>=0,i>>>=0,o>>>=0,a>>>=0,this===t)return 0;for(var c=a-o,d=i-n,h=Math.min(c,d),u=this.slice(o,a),s=t.slice(n,i),_=0;_<h;++_)if(u[_]!==s[_]){c=u[_],d=s[_];break}return c<d?-1:d<c?1:0};function ps(e,t,n,i,o){if(e.length===0)return-1;if(typeof n=="string"?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0)if(o)n=0;else return-1;if(typeof t=="string"&&(t=bt.from(t,i)),nn(t))return t.length===0?-1:_s(e,t,n,i,o);if(typeof t=="number")return t=t&255,bt.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):_s(e,[t],n,i,o);throw new TypeError("val must be string, number or Buffer")}function _s(e,t,n,i,o){var a=1,c=e.length,d=t.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(e.length<2||t.length<2)return-1;a=2,c/=2,d/=2,n/=2}function h(g,F){return a===1?g[F]:g.readUInt16BE(F*a)}var u;if(o){var s=-1;for(u=n;u<c;u++)if(h(e,u)===h(t,s===-1?0:u-s)){if(s===-1&&(s=u),u-s+1===d)return s*a}else s!==-1&&(u-=u-s),s=-1}else for(n+d>c&&(n=c-d),u=n;u>=0;u--){for(var _=!0,L=0;L<d;L++)if(h(e,u+L)!==h(t,L)){_=!1;break}if(_)return u}return-1}bt.prototype.includes=function(t,n,i){return this.indexOf(t,n,i)!==-1},bt.prototype.indexOf=function(t,n,i){return ps(this,t,n,i,!0)},bt.prototype.lastIndexOf=function(t,n,i){return ps(this,t,n,i,!1)};function Gd(e,t,n,i){n=Number(n)||0;var o=e.length-n;i?(i=Number(i),i>o&&(i=o)):i=o;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var c=0;c<i;++c){var d=parseInt(t.substr(c*2,2),16);if(isNaN(d))return c;e[n+c]=d}return c}function Nd(e,t,n,i){return mo(_o(t,e.length-n),e,n,i)}function ms(e,t,n,i){return mo(Jd(t),e,n,i)}function qd(e,t,n,i){return ms(e,t,n,i)}function zd(e,t,n,i){return mo(bs(t),e,n,i)}function Dd(e,t,n,i){return mo(Xd(t,e.length-n),e,n,i)}bt.prototype.write=function(t,n,i,o){if(n===void 0)o="utf8",i=this.length,n=0;else if(i===void 0&&typeof n=="string")o=n,i=this.length,n=0;else if(isFinite(n))n=n|0,isFinite(i)?(i=i|0,o===void 0&&(o="utf8")):(o=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var a=this.length-n;if((i===void 0||i>a)&&(i=a),t.length>0&&(i<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var c=!1;;)switch(o){case"hex":return Gd(this,t,n,i);case"utf8":case"utf-8":return Nd(this,t,n,i);case"ascii":return ms(this,t,n,i);case"latin1":case"binary":return qd(this,t,n,i);case"base64":return zd(this,t,n,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Dd(this,t,n,i);default:if(c)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),c=!0}},bt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function kd(e,t,n){return t===0&&n===e.length?ls(e):ls(e.slice(t,n))}function Ls(e,t,n){n=Math.min(e.length,n);for(var i=[],o=t;o<n;){var a=e[o],c=null,d=a>239?4:a>223?3:a>191?2:1;if(o+d<=n){var h,u,s,_;switch(d){case 1:a<128&&(c=a);break;case 2:h=e[o+1],(h&192)==128&&(_=(a&31)<<6|h&63,_>127&&(c=_));break;case 3:h=e[o+1],u=e[o+2],(h&192)==128&&(u&192)==128&&(_=(a&15)<<12|(h&63)<<6|u&63,_>2047&&(_<55296||_>57343)&&(c=_));break;case 4:h=e[o+1],u=e[o+2],s=e[o+3],(h&192)==128&&(u&192)==128&&(s&192)==128&&(_=(a&15)<<18|(h&63)<<12|(u&63)<<6|s&63,_>65535&&_<1114112&&(c=_))}}c===null?(c=65533,d=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|c&1023),i.push(c),o+=d}return Qd(i)}var ys=4096;function Qd(e){var t=e.length;if(t<=ys)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=ys));return n}function Wd(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(e[o]&127);return i}function $d(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(e[o]);return i}function Hd(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var o="",a=t;a<n;++a)o+=Zd(e[a]);return o}function jd(e,t,n){for(var i=e.slice(t,n),o="",a=0;a<i.length;a+=2)o+=String.fromCharCode(i[a]+i[a+1]*256);return o}bt.prototype.slice=function(t,n){var i=this.length;t=~~t,n=n===void 0?i:~~n,t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),n<0?(n+=i,n<0&&(n=0)):n>i&&(n=i),n<t&&(n=t);var o;if(bt.TYPED_ARRAY_SUPPORT)o=this.subarray(t,n),o.__proto__=bt.prototype;else{var a=n-t;o=new bt(a,void 0);for(var c=0;c<a;++c)o[c]=this[c+t]}return o};function me(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}bt.prototype.readUIntLE=function(t,n,i){t=t|0,n=n|0,i||me(t,n,this.length);for(var o=this[t],a=1,c=0;++c<n&&(a*=256);)o+=this[t+c]*a;return o},bt.prototype.readUIntBE=function(t,n,i){t=t|0,n=n|0,i||me(t,n,this.length);for(var o=this[t+--n],a=1;n>0&&(a*=256);)o+=this[t+--n]*a;return o},bt.prototype.readUInt8=function(t,n){return n||me(t,1,this.length),this[t]},bt.prototype.readUInt16LE=function(t,n){return n||me(t,2,this.length),this[t]|this[t+1]<<8},bt.prototype.readUInt16BE=function(t,n){return n||me(t,2,this.length),this[t]<<8|this[t+1]},bt.prototype.readUInt32LE=function(t,n){return n||me(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216},bt.prototype.readUInt32BE=function(t,n){return n||me(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])},bt.prototype.readIntLE=function(t,n,i){t=t|0,n=n|0,i||me(t,n,this.length);for(var o=this[t],a=1,c=0;++c<n&&(a*=256);)o+=this[t+c]*a;return a*=128,o>=a&&(o-=Math.pow(2,8*n)),o},bt.prototype.readIntBE=function(t,n,i){t=t|0,n=n|0,i||me(t,n,this.length);for(var o=n,a=1,c=this[t+--o];o>0&&(a*=256);)c+=this[t+--o]*a;return a*=128,c>=a&&(c-=Math.pow(2,8*n)),c},bt.prototype.readInt8=function(t,n){return n||me(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]},bt.prototype.readInt16LE=function(t,n){n||me(t,2,this.length);var i=this[t]|this[t+1]<<8;return i&32768?i|4294901760:i},bt.prototype.readInt16BE=function(t,n){n||me(t,2,this.length);var i=this[t+1]|this[t]<<8;return i&32768?i|4294901760:i},bt.prototype.readInt32LE=function(t,n){return n||me(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},bt.prototype.readInt32BE=function(t,n){return n||me(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},bt.prototype.readFloatLE=function(t,n){return n||me(t,4,this.length),fo(this,t,!0,23,4)},bt.prototype.readFloatBE=function(t,n){return n||me(t,4,this.length),fo(this,t,!1,23,4)},bt.prototype.readDoubleLE=function(t,n){return n||me(t,8,this.length),fo(this,t,!0,52,8)},bt.prototype.readDoubleBE=function(t,n){return n||me(t,8,this.length),fo(this,t,!1,52,8)};function Ue(e,t,n,i,o,a){if(!nn(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}bt.prototype.writeUIntLE=function(t,n,i,o){if(t=+t,n=n|0,i=i|0,!o){var a=Math.pow(2,8*i)-1;Ue(this,t,n,i,a,0)}var c=1,d=0;for(this[n]=t&255;++d<i&&(c*=256);)this[n+d]=t/c&255;return n+i},bt.prototype.writeUIntBE=function(t,n,i,o){if(t=+t,n=n|0,i=i|0,!o){var a=Math.pow(2,8*i)-1;Ue(this,t,n,i,a,0)}var c=i-1,d=1;for(this[n+c]=t&255;--c>=0&&(d*=256);)this[n+c]=t/d&255;return n+i},bt.prototype.writeUInt8=function(t,n,i){return t=+t,n=n|0,i||Ue(this,t,n,1,255,0),bt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=t&255,n+1};function go(e,t,n,i){t<0&&(t=65535+t+1);for(var o=0,a=Math.min(e.length-n,2);o<a;++o)e[n+o]=(t&255<<8*(i?o:1-o))>>>(i?o:1-o)*8}bt.prototype.writeUInt16LE=function(t,n,i){return t=+t,n=n|0,i||Ue(this,t,n,2,65535,0),bt.TYPED_ARRAY_SUPPORT?(this[n]=t&255,this[n+1]=t>>>8):go(this,t,n,!0),n+2},bt.prototype.writeUInt16BE=function(t,n,i){return t=+t,n=n|0,i||Ue(this,t,n,2,65535,0),bt.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=t&255):go(this,t,n,!1),n+2};function po(e,t,n,i){t<0&&(t=4294967295+t+1);for(var o=0,a=Math.min(e.length-n,4);o<a;++o)e[n+o]=t>>>(i?o:3-o)*8&255}bt.prototype.writeUInt32LE=function(t,n,i){return t=+t,n=n|0,i||Ue(this,t,n,4,4294967295,0),bt.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=t&255):po(this,t,n,!0),n+4},bt.prototype.writeUInt32BE=function(t,n,i){return t=+t,n=n|0,i||Ue(this,t,n,4,4294967295,0),bt.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=t&255):po(this,t,n,!1),n+4},bt.prototype.writeIntLE=function(t,n,i,o){if(t=+t,n=n|0,!o){var a=Math.pow(2,8*i-1);Ue(this,t,n,i,a-1,-a)}var c=0,d=1,h=0;for(this[n]=t&255;++c<i&&(d*=256);)t<0&&h===0&&this[n+c-1]!==0&&(h=1),this[n+c]=(t/d>>0)-h&255;return n+i},bt.prototype.writeIntBE=function(t,n,i,o){if(t=+t,n=n|0,!o){var a=Math.pow(2,8*i-1);Ue(this,t,n,i,a-1,-a)}var c=i-1,d=1,h=0;for(this[n+c]=t&255;--c>=0&&(d*=256);)t<0&&h===0&&this[n+c+1]!==0&&(h=1),this[n+c]=(t/d>>0)-h&255;return n+i},bt.prototype.writeInt8=function(t,n,i){return t=+t,n=n|0,i||Ue(this,t,n,1,127,-128),bt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=t&255,n+1},bt.prototype.writeInt16LE=function(t,n,i){return t=+t,n=n|0,i||Ue(this,t,n,2,32767,-32768),bt.TYPED_ARRAY_SUPPORT?(this[n]=t&255,this[n+1]=t>>>8):go(this,t,n,!0),n+2},bt.prototype.writeInt16BE=function(t,n,i){return t=+t,n=n|0,i||Ue(this,t,n,2,32767,-32768),bt.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=t&255):go(this,t,n,!1),n+2},bt.prototype.writeInt32LE=function(t,n,i){return t=+t,n=n|0,i||Ue(this,t,n,4,2147483647,-2147483648),bt.TYPED_ARRAY_SUPPORT?(this[n]=t&255,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):po(this,t,n,!0),n+4},bt.prototype.writeInt32BE=function(t,n,i){return t=+t,n=n|0,i||Ue(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),bt.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=t&255):po(this,t,n,!1),n+4};function As(e,t,n,i,o,a){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function ws(e,t,n,i,o){return o||As(e,t,n,4),us(e,t,n,i,23,4),n+4}bt.prototype.writeFloatLE=function(t,n,i){return ws(this,t,n,!0,i)},bt.prototype.writeFloatBE=function(t,n,i){return ws(this,t,n,!1,i)};function Is(e,t,n,i,o){return o||As(e,t,n,8),us(e,t,n,i,52,8),n+8}bt.prototype.writeDoubleLE=function(t,n,i){return Is(this,t,n,!0,i)},bt.prototype.writeDoubleBE=function(t,n,i){return Is(this,t,n,!1,i)},bt.prototype.copy=function(t,n,i,o){if(i||(i=0),!o&&o!==0&&(o=this.length),n>=t.length&&(n=t.length),n||(n=0),o>0&&o<i&&(o=i),o===i||t.length===0||this.length===0)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-n<o-i&&(o=t.length-n+i);var a=o-i,c;if(this===t&&i<n&&n<o)for(c=a-1;c>=0;--c)t[c+n]=this[c+i];else if(a<1e3||!bt.TYPED_ARRAY_SUPPORT)for(c=0;c<a;++c)t[c+n]=this[c+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+a),n);return a},bt.prototype.fill=function(t,n,i,o){if(typeof t=="string"){if(typeof n=="string"?(o=n,n=0,i=this.length):typeof i=="string"&&(o=i,i=this.length),t.length===1){var a=t.charCodeAt(0);a<256&&(t=a)}if(o!==void 0&&typeof o!="string")throw new TypeError("encoding must be a string");if(typeof o=="string"&&!bt.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else typeof t=="number"&&(t=t&255);if(n<0||this.length<n||this.length<i)throw new RangeError("Out of range index");if(i<=n)return this;n=n>>>0,i=i===void 0?this.length:i>>>0,t||(t=0);var c;if(typeof t=="number")for(c=n;c<i;++c)this[c]=t;else{var d=nn(t)?t:_o(new bt(t,o).toString()),h=d.length;for(c=0;c<i-n;++c)this[c+n]=d[c%h]}return this};var Vd=/[^+\/0-9A-Za-z-_]/g;function Kd(e){if(e=Yd(e).replace(Vd,""),e.length<2)return"";for(;e.length%4!=0;)e=e+"=";return e}function Yd(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Zd(e){return e<16?"0"+e.toString(16):e.toString(16)}function _o(e,t){t=t||1/0;for(var n,i=e.length,o=null,a=[],c=0;c<i;++c){if(n=e.charCodeAt(c),n>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}else if(c+1===i){(t-=3)>-1&&a.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(t-=3)>-1&&a.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,n&63|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,n&63|128)}else if(n<1114112){if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw new Error("Invalid code point")}return a}function Jd(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n)&255);return t}function Xd(e,t){for(var n,i,o,a=[],c=0;c<e.length&&!((t-=2)<0);++c)n=e.charCodeAt(c),i=n>>8,o=n%256,a.push(o),a.push(i);return a}function bs(e){return Fd(Kd(e))}function mo(e,t,n,i){for(var o=0;o<i&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function tf(e){return e!==e}function ef(e){return e!=null&&(!!e._isBuffer||Es(e)||nf(e))}function Es(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function nf(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&Es(e.slice(0,0))}var ra=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Cs(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),t}var ri={},Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});const of=typeof globalThis!="undefined"?globalThis:typeof ra!="undefined"?ra:{};Ti.BigIntPolyfill=typeof BigInt!="undefined"?BigInt:of.BigInt||Number;var sa={};Object.defineProperty(sa,"__esModule",{value:!0});const af=Ti;let Lo=DataView;Lo.prototype.setBigUint64||(Lo.prototype.setBigUint64=function(e,t,n){let i,o;if(t<2**32)i=Number(t),o=0;else{for(var a=t.toString(2),c="",d=0;d<64-a.length;d++)c+="0";c+=a,o=parseInt(c.substring(0,32),2),i=parseInt(c.substring(32),2)}this.setUint32(e+(n?0:4),i,n),this.setUint32(e+(n?4:0),o,n)},Lo.prototype.getBigUint64=function(e,t){let n=this.getUint32(e+(t?0:4),t),i=this.getUint32(e+(t?4:0),t);for(var o=n.toString(2),a=i.toString(2),c="",d=0;d<32-o.length;d++)c+="0";return c+=o,af.BigIntPolyfill("0b"+a+c)}),sa.DataViewPolyfill=Lo;var rf=Object.freeze({__proto__:null,default:bt}),sf=Cs(rf),vs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Ti;e.WASI_ESUCCESS=0,e.WASI_E2BIG=1,e.WASI_EACCES=2,e.WASI_EADDRINUSE=3,e.WASI_EADDRNOTAVAIL=4,e.WASI_EAFNOSUPPORT=5,e.WASI_EAGAIN=6,e.WASI_EALREADY=7,e.WASI_EBADF=8,e.WASI_EBADMSG=9,e.WASI_EBUSY=10,e.WASI_ECANCELED=11,e.WASI_ECHILD=12,e.WASI_ECONNABORTED=13,e.WASI_ECONNREFUSED=14,e.WASI_ECONNRESET=15,e.WASI_EDEADLK=16,e.WASI_EDESTADDRREQ=17,e.WASI_EDOM=18,e.WASI_EDQUOT=19,e.WASI_EEXIST=20,e.WASI_EFAULT=21,e.WASI_EFBIG=22,e.WASI_EHOSTUNREACH=23,e.WASI_EIDRM=24,e.WASI_EILSEQ=25,e.WASI_EINPROGRESS=26,e.WASI_EINTR=27,e.WASI_EINVAL=28,e.WASI_EIO=29,e.WASI_EISCONN=30,e.WASI_EISDIR=31,e.WASI_ELOOP=32,e.WASI_EMFILE=33,e.WASI_EMLINK=34,e.WASI_EMSGSIZE=35,e.WASI_EMULTIHOP=36,e.WASI_ENAMETOOLONG=37,e.WASI_ENETDOWN=38,e.WASI_ENETRESET=39,e.WASI_ENETUNREACH=40,e.WASI_ENFILE=41,e.WASI_ENOBUFS=42,e.WASI_ENODEV=43,e.WASI_ENOENT=44,e.WASI_ENOEXEC=45,e.WASI_ENOLCK=46,e.WASI_ENOLINK=47,e.WASI_ENOMEM=48,e.WASI_ENOMSG=49,e.WASI_ENOPROTOOPT=50,e.WASI_ENOSPC=51,e.WASI_ENOSYS=52,e.WASI_ENOTCONN=53,e.WASI_ENOTDIR=54,e.WASI_ENOTEMPTY=55,e.WASI_ENOTRECOVERABLE=56,e.WASI_ENOTSOCK=57,e.WASI_ENOTSUP=58,e.WASI_ENOTTY=59,e.WASI_ENXIO=60,e.WASI_EOVERFLOW=61,e.WASI_EOWNERDEAD=62,e.WASI_EPERM=63,e.WASI_EPIPE=64,e.WASI_EPROTO=65,e.WASI_EPROTONOSUPPORT=66,e.WASI_EPROTOTYPE=67,e.WASI_ERANGE=68,e.WASI_EROFS=69,e.WASI_ESPIPE=70,e.WASI_ESRCH=71,e.WASI_ESTALE=72,e.WASI_ETIMEDOUT=73,e.WASI_ETXTBSY=74,e.WASI_EXDEV=75,e.WASI_ENOTCAPABLE=76,e.WASI_SIGABRT=0,e.WASI_SIGALRM=1,e.WASI_SIGBUS=2,e.WASI_SIGCHLD=3,e.WASI_SIGCONT=4,e.WASI_SIGFPE=5,e.WASI_SIGHUP=6,e.WASI_SIGILL=7,e.WASI_SIGINT=8,e.WASI_SIGKILL=9,e.WASI_SIGPIPE=10,e.WASI_SIGQUIT=11,e.WASI_SIGSEGV=12,e.WASI_SIGSTOP=13,e.WASI_SIGTERM=14,e.WASI_SIGTRAP=15,e.WASI_SIGTSTP=16,e.WASI_SIGTTIN=17,e.WASI_SIGTTOU=18,e.WASI_SIGURG=19,e.WASI_SIGUSR1=20,e.WASI_SIGUSR2=21,e.WASI_SIGVTALRM=22,e.WASI_SIGXCPU=23,e.WASI_SIGXFSZ=24,e.WASI_FILETYPE_UNKNOWN=0,e.WASI_FILETYPE_BLOCK_DEVICE=1,e.WASI_FILETYPE_CHARACTER_DEVICE=2,e.WASI_FILETYPE_DIRECTORY=3,e.WASI_FILETYPE_REGULAR_FILE=4,e.WASI_FILETYPE_SOCKET_DGRAM=5,e.WASI_FILETYPE_SOCKET_STREAM=6,e.WASI_FILETYPE_SYMBOLIC_LINK=7,e.WASI_FDFLAG_APPEND=1,e.WASI_FDFLAG_DSYNC=2,e.WASI_FDFLAG_NONBLOCK=4,e.WASI_FDFLAG_RSYNC=8,e.WASI_FDFLAG_SYNC=16,e.WASI_RIGHT_FD_DATASYNC=t.BigIntPolyfill(1),e.WASI_RIGHT_FD_READ=t.BigIntPolyfill(2),e.WASI_RIGHT_FD_SEEK=t.BigIntPolyfill(4),e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS=t.BigIntPolyfill(8),e.WASI_RIGHT_FD_SYNC=t.BigIntPolyfill(16),e.WASI_RIGHT_FD_TELL=t.BigIntPolyfill(32),e.WASI_RIGHT_FD_WRITE=t.BigIntPolyfill(64),e.WASI_RIGHT_FD_ADVISE=t.BigIntPolyfill(128),e.WASI_RIGHT_FD_ALLOCATE=t.BigIntPolyfill(256),e.WASI_RIGHT_PATH_CREATE_DIRECTORY=t.BigIntPolyfill(512),e.WASI_RIGHT_PATH_CREATE_FILE=t.BigIntPolyfill(1024),e.WASI_RIGHT_PATH_LINK_SOURCE=t.BigIntPolyfill(2048),e.WASI_RIGHT_PATH_LINK_TARGET=t.BigIntPolyfill(4096),e.WASI_RIGHT_PATH_OPEN=t.BigIntPolyfill(8192),e.WASI_RIGHT_FD_READDIR=t.BigIntPolyfill(16384),e.WASI_RIGHT_PATH_READLINK=t.BigIntPolyfill(32768),e.WASI_RIGHT_PATH_RENAME_SOURCE=t.BigIntPolyfill(65536),e.WASI_RIGHT_PATH_RENAME_TARGET=t.BigIntPolyfill(131072),e.WASI_RIGHT_PATH_FILESTAT_GET=t.BigIntPolyfill(262144),e.WASI_RIGHT_PATH_FILESTAT_SET_SIZE=t.BigIntPolyfill(524288),e.WASI_RIGHT_PATH_FILESTAT_SET_TIMES=t.BigIntPolyfill(1048576),e.WASI_RIGHT_FD_FILESTAT_GET=t.BigIntPolyfill(2097152),e.WASI_RIGHT_FD_FILESTAT_SET_SIZE=t.BigIntPolyfill(4194304),e.WASI_RIGHT_FD_FILESTAT_SET_TIMES=t.BigIntPolyfill(8388608),e.WASI_RIGHT_PATH_SYMLINK=t.BigIntPolyfill(16777216),e.WASI_RIGHT_PATH_REMOVE_DIRECTORY=t.BigIntPolyfill(33554432),e.WASI_RIGHT_PATH_UNLINK_FILE=t.BigIntPolyfill(67108864),e.WASI_RIGHT_POLL_FD_READWRITE=t.BigIntPolyfill(134217728),e.WASI_RIGHT_SOCK_SHUTDOWN=t.BigIntPolyfill(268435456),e.RIGHTS_ALL=e.WASI_RIGHT_FD_DATASYNC|e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_SEEK|e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|e.WASI_RIGHT_FD_SYNC|e.WASI_RIGHT_FD_TELL|e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_ADVISE|e.WASI_RIGHT_FD_ALLOCATE|e.WASI_RIGHT_PATH_CREATE_DIRECTORY|e.WASI_RIGHT_PATH_CREATE_FILE|e.WASI_RIGHT_PATH_LINK_SOURCE|e.WASI_RIGHT_PATH_LINK_TARGET|e.WASI_RIGHT_PATH_OPEN|e.WASI_RIGHT_FD_READDIR|e.WASI_RIGHT_PATH_READLINK|e.WASI_RIGHT_PATH_RENAME_SOURCE|e.WASI_RIGHT_PATH_RENAME_TARGET|e.WASI_RIGHT_PATH_FILESTAT_GET|e.WASI_RIGHT_PATH_FILESTAT_SET_SIZE|e.WASI_RIGHT_PATH_FILESTAT_SET_TIMES|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_FD_FILESTAT_SET_TIMES|e.WASI_RIGHT_FD_FILESTAT_SET_SIZE|e.WASI_RIGHT_PATH_SYMLINK|e.WASI_RIGHT_PATH_UNLINK_FILE|e.WASI_RIGHT_PATH_REMOVE_DIRECTORY|e.WASI_RIGHT_POLL_FD_READWRITE|e.WASI_RIGHT_SOCK_SHUTDOWN,e.RIGHTS_BLOCK_DEVICE_BASE=e.RIGHTS_ALL,e.RIGHTS_BLOCK_DEVICE_INHERITING=e.RIGHTS_ALL,e.RIGHTS_CHARACTER_DEVICE_BASE=e.RIGHTS_ALL,e.RIGHTS_CHARACTER_DEVICE_INHERITING=e.RIGHTS_ALL,e.RIGHTS_REGULAR_FILE_BASE=e.WASI_RIGHT_FD_DATASYNC|e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_SEEK|e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|e.WASI_RIGHT_FD_SYNC|e.WASI_RIGHT_FD_TELL|e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_ADVISE|e.WASI_RIGHT_FD_ALLOCATE|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_FD_FILESTAT_SET_SIZE|e.WASI_RIGHT_FD_FILESTAT_SET_TIMES|e.WASI_RIGHT_POLL_FD_READWRITE,e.RIGHTS_REGULAR_FILE_INHERITING=t.BigIntPolyfill(0),e.RIGHTS_DIRECTORY_BASE=e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|e.WASI_RIGHT_FD_SYNC|e.WASI_RIGHT_FD_ADVISE|e.WASI_RIGHT_PATH_CREATE_DIRECTORY|e.WASI_RIGHT_PATH_CREATE_FILE|e.WASI_RIGHT_PATH_LINK_SOURCE|e.WASI_RIGHT_PATH_LINK_TARGET|e.WASI_RIGHT_PATH_OPEN|e.WASI_RIGHT_FD_READDIR|e.WASI_RIGHT_PATH_READLINK|e.WASI_RIGHT_PATH_RENAME_SOURCE|e.WASI_RIGHT_PATH_RENAME_TARGET|e.WASI_RIGHT_PATH_FILESTAT_GET|e.WASI_RIGHT_PATH_FILESTAT_SET_SIZE|e.WASI_RIGHT_PATH_FILESTAT_SET_TIMES|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_FD_FILESTAT_SET_TIMES|e.WASI_RIGHT_PATH_SYMLINK|e.WASI_RIGHT_PATH_UNLINK_FILE|e.WASI_RIGHT_PATH_REMOVE_DIRECTORY|e.WASI_RIGHT_POLL_FD_READWRITE,e.RIGHTS_DIRECTORY_INHERITING=e.RIGHTS_DIRECTORY_BASE|e.RIGHTS_REGULAR_FILE_BASE,e.RIGHTS_SOCKET_BASE=e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_POLL_FD_READWRITE|e.WASI_RIGHT_SOCK_SHUTDOWN,e.RIGHTS_SOCKET_INHERITING=e.RIGHTS_ALL,e.RIGHTS_TTY_BASE=e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_POLL_FD_READWRITE,e.RIGHTS_TTY_INHERITING=t.BigIntPolyfill(0),e.WASI_CLOCK_REALTIME=0,e.WASI_CLOCK_MONOTONIC=1,e.WASI_CLOCK_PROCESS_CPUTIME_ID=2,e.WASI_CLOCK_THREAD_CPUTIME_ID=3,e.WASI_EVENTTYPE_CLOCK=0,e.WASI_EVENTTYPE_FD_READ=1,e.WASI_EVENTTYPE_FD_WRITE=2,e.WASI_FILESTAT_SET_ATIM=1<<0,e.WASI_FILESTAT_SET_ATIM_NOW=1<<1,e.WASI_FILESTAT_SET_MTIM=1<<2,e.WASI_FILESTAT_SET_MTIM_NOW=1<<3,e.WASI_O_CREAT=1<<0,e.WASI_O_DIRECTORY=1<<1,e.WASI_O_EXCL=1<<2,e.WASI_O_TRUNC=1<<3,e.WASI_PREOPENTYPE_DIR=0,e.WASI_DIRCOOKIE_START=0,e.WASI_STDIN_FILENO=0,e.WASI_STDOUT_FILENO=1,e.WASI_STDERR_FILENO=2,e.WASI_WHENCE_SET=0,e.WASI_WHENCE_CUR=1,e.WASI_WHENCE_END=2,e.ERROR_MAP={E2BIG:e.WASI_E2BIG,EACCES:e.WASI_EACCES,EADDRINUSE:e.WASI_EADDRINUSE,EADDRNOTAVAIL:e.WASI_EADDRNOTAVAIL,EAFNOSUPPORT:e.WASI_EAFNOSUPPORT,EALREADY:e.WASI_EALREADY,EAGAIN:e.WASI_EAGAIN,EBADF:e.WASI_EBADF,EBADMSG:e.WASI_EBADMSG,EBUSY:e.WASI_EBUSY,ECANCELED:e.WASI_ECANCELED,ECHILD:e.WASI_ECHILD,ECONNABORTED:e.WASI_ECONNABORTED,ECONNREFUSED:e.WASI_ECONNREFUSED,ECONNRESET:e.WASI_ECONNRESET,EDEADLOCK:e.WASI_EDEADLK,EDESTADDRREQ:e.WASI_EDESTADDRREQ,EDOM:e.WASI_EDOM,EDQUOT:e.WASI_EDQUOT,EEXIST:e.WASI_EEXIST,EFAULT:e.WASI_EFAULT,EFBIG:e.WASI_EFBIG,EHOSTDOWN:e.WASI_EHOSTUNREACH,EHOSTUNREACH:e.WASI_EHOSTUNREACH,EIDRM:e.WASI_EIDRM,EILSEQ:e.WASI_EILSEQ,EINPROGRESS:e.WASI_EINPROGRESS,EINTR:e.WASI_EINTR,EINVAL:e.WASI_EINVAL,EIO:e.WASI_EIO,EISCONN:e.WASI_EISCONN,EISDIR:e.WASI_EISDIR,ELOOP:e.WASI_ELOOP,EMFILE:e.WASI_EMFILE,EMLINK:e.WASI_EMLINK,EMSGSIZE:e.WASI_EMSGSIZE,EMULTIHOP:e.WASI_EMULTIHOP,ENAMETOOLONG:e.WASI_ENAMETOOLONG,ENETDOWN:e.WASI_ENETDOWN,ENETRESET:e.WASI_ENETRESET,ENETUNREACH:e.WASI_ENETUNREACH,ENFILE:e.WASI_ENFILE,ENOBUFS:e.WASI_ENOBUFS,ENODEV:e.WASI_ENODEV,ENOENT:e.WASI_ENOENT,ENOEXEC:e.WASI_ENOEXEC,ENOLCK:e.WASI_ENOLCK,ENOLINK:e.WASI_ENOLINK,ENOMEM:e.WASI_ENOMEM,ENOMSG:e.WASI_ENOMSG,ENOPROTOOPT:e.WASI_ENOPROTOOPT,ENOSPC:e.WASI_ENOSPC,ENOSYS:e.WASI_ENOSYS,ENOTCONN:e.WASI_ENOTCONN,ENOTDIR:e.WASI_ENOTDIR,ENOTEMPTY:e.WASI_ENOTEMPTY,ENOTRECOVERABLE:e.WASI_ENOTRECOVERABLE,ENOTSOCK:e.WASI_ENOTSOCK,ENOTTY:e.WASI_ENOTTY,ENXIO:e.WASI_ENXIO,EOVERFLOW:e.WASI_EOVERFLOW,EOWNERDEAD:e.WASI_EOWNERDEAD,EPERM:e.WASI_EPERM,EPIPE:e.WASI_EPIPE,EPROTO:e.WASI_EPROTO,EPROTONOSUPPORT:e.WASI_EPROTONOSUPPORT,EPROTOTYPE:e.WASI_EPROTOTYPE,ERANGE:e.WASI_ERANGE,EROFS:e.WASI_EROFS,ESPIPE:e.WASI_ESPIPE,ESRCH:e.WASI_ESRCH,ESTALE:e.WASI_ESTALE,ETIMEDOUT:e.WASI_ETIMEDOUT,ETXTBSY:e.WASI_ETXTBSY,EXDEV:e.WASI_EXDEV},e.SIGNAL_MAP={[e.WASI_SIGHUP]:"SIGHUP",[e.WASI_SIGINT]:"SIGINT",[e.WASI_SIGQUIT]:"SIGQUIT",[e.WASI_SIGILL]:"SIGILL",[e.WASI_SIGTRAP]:"SIGTRAP",[e.WASI_SIGABRT]:"SIGABRT",[e.WASI_SIGBUS]:"SIGBUS",[e.WASI_SIGFPE]:"SIGFPE",[e.WASI_SIGKILL]:"SIGKILL",[e.WASI_SIGUSR1]:"SIGUSR1",[e.WASI_SIGSEGV]:"SIGSEGV",[e.WASI_SIGUSR2]:"SIGUSR2",[e.WASI_SIGPIPE]:"SIGPIPE",[e.WASI_SIGALRM]:"SIGALRM",[e.WASI_SIGTERM]:"SIGTERM",[e.WASI_SIGCHLD]:"SIGCHLD",[e.WASI_SIGCONT]:"SIGCONT",[e.WASI_SIGSTOP]:"SIGSTOP",[e.WASI_SIGTSTP]:"SIGTSTP",[e.WASI_SIGTTIN]:"SIGTTIN",[e.WASI_SIGTTOU]:"SIGTTOU",[e.WASI_SIGURG]:"SIGURG",[e.WASI_SIGXCPU]:"SIGXCPU",[e.WASI_SIGXFSZ]:"SIGXFSZ",[e.WASI_SIGVTALRM]:"SIGVTALRM"}})(vs),Object.defineProperty(ri,"__esModule",{value:!0});const Qt=Ti,cf=sa,oe=sf;let Fs;const K=vs,lf=K.WASI_RIGHT_FD_DATASYNC|K.WASI_RIGHT_FD_READ|K.WASI_RIGHT_FD_SYNC|K.WASI_RIGHT_FD_ADVISE|K.WASI_RIGHT_FD_FILESTAT_GET|K.WASI_RIGHT_POLL_FD_READWRITE,Ss=K.WASI_RIGHT_FD_DATASYNC|K.WASI_RIGHT_FD_WRITE|K.WASI_RIGHT_FD_SYNC|K.WASI_RIGHT_FD_ADVISE|K.WASI_RIGHT_FD_FILESTAT_GET|K.WASI_RIGHT_POLL_FD_READWRITE,uf=Ss,Wn=e=>{const t=Math.trunc(e),n=Qt.BigIntPolyfill(Math.round((e-t)*1e6));return Qt.BigIntPolyfill(t)*Qt.BigIntPolyfill(1e6)+n},si=e=>{typeof e=="number"&&(e=Math.trunc(e));const t=Qt.BigIntPolyfill(e);return Number(t/Qt.BigIntPolyfill(1e6))},Zt=e=>(...t)=>{try{return e(...t)}catch(n){if(n&&n.code&&typeof n.code=="string")return K.ERROR_MAP[n.code]||K.WASI_EINVAL;if(n instanceof ci)return n.errno;throw n}},Bs=(e,t)=>{const n=e.FD_MAP.get(t);if(!n)throw new ci(K.WASI_EBADF);if(n.filetype===void 0){const i=e.bindings.fs.fstatSync(n.real),{filetype:o,rightsBase:a,rightsInheriting:c}=xs(e,t,i);n.filetype=o,n.rights||(n.rights={base:a,inheriting:c})}return n},xs=(e,t,n)=>{switch(!0){case n.isBlockDevice():return{filetype:K.WASI_FILETYPE_BLOCK_DEVICE,rightsBase:K.RIGHTS_BLOCK_DEVICE_BASE,rightsInheriting:K.RIGHTS_BLOCK_DEVICE_INHERITING};case n.isCharacterDevice():{const i=K.WASI_FILETYPE_CHARACTER_DEVICE;return t!==void 0&&e.bindings.isTTY(t)?{filetype:i,rightsBase:K.RIGHTS_TTY_BASE,rightsInheriting:K.RIGHTS_TTY_INHERITING}:{filetype:i,rightsBase:K.RIGHTS_CHARACTER_DEVICE_BASE,rightsInheriting:K.RIGHTS_CHARACTER_DEVICE_INHERITING}}case n.isDirectory():return{filetype:K.WASI_FILETYPE_DIRECTORY,rightsBase:K.RIGHTS_DIRECTORY_BASE,rightsInheriting:K.RIGHTS_DIRECTORY_INHERITING};case n.isFIFO():return{filetype:K.WASI_FILETYPE_SOCKET_STREAM,rightsBase:K.RIGHTS_SOCKET_BASE,rightsInheriting:K.RIGHTS_SOCKET_INHERITING};case n.isFile():return{filetype:K.WASI_FILETYPE_REGULAR_FILE,rightsBase:K.RIGHTS_REGULAR_FILE_BASE,rightsInheriting:K.RIGHTS_REGULAR_FILE_INHERITING};case n.isSocket():return{filetype:K.WASI_FILETYPE_SOCKET_STREAM,rightsBase:K.RIGHTS_SOCKET_BASE,rightsInheriting:K.RIGHTS_SOCKET_INHERITING};case n.isSymbolicLink():return{filetype:K.WASI_FILETYPE_SYMBOLIC_LINK,rightsBase:Qt.BigIntPolyfill(0),rightsInheriting:Qt.BigIntPolyfill(0)};default:return{filetype:K.WASI_FILETYPE_UNKNOWN,rightsBase:Qt.BigIntPolyfill(0),rightsInheriting:Qt.BigIntPolyfill(0)}}};class ci extends Error{constructor(t){super();this.errno=t,Object.setPrototypeOf(this,ci.prototype)}}ri.WASIError=ci;class ca extends Error{constructor(t){super(`WASI Exit error: ${t}`);this.code=t,Object.setPrototypeOf(this,ca.prototype)}}var df=ri.WASIExitError=ca;class la extends Error{constructor(t){super(`WASI Kill signal: ${t}`);this.signal=t,Object.setPrototypeOf(this,la.prototype)}}var ff=ri.WASIKillError=la;class ua{constructor(t){let n={};t&&t.preopens?n=t.preopens:t&&t.preopenDirectories&&(n=t.preopenDirectories);let i={};t&&t.env&&(i=t.env);let o=[];t&&t.args&&(o=t.args);let a=Fs;t&&t.bindings&&(a=t.bindings),this.memory=void 0,this.view=void 0,this.bindings=a,this.FD_MAP=new Map([[K.WASI_STDIN_FILENO,{real:0,filetype:K.WASI_FILETYPE_CHARACTER_DEVICE,rights:{base:lf,inheriting:Qt.BigIntPolyfill(0)},path:void 0}],[K.WASI_STDOUT_FILENO,{real:1,filetype:K.WASI_FILETYPE_CHARACTER_DEVICE,rights:{base:Ss,inheriting:Qt.BigIntPolyfill(0)},path:void 0}],[K.WASI_STDERR_FILENO,{real:2,filetype:K.WASI_FILETYPE_CHARACTER_DEVICE,rights:{base:uf,inheriting:Qt.BigIntPolyfill(0)},path:void 0}]]);let c=this.bindings.fs,d=this.bindings.path;for(const[L,g]of Object.entries(n)){const F=c.openSync(g,c.constants.O_RDONLY),T=[...this.FD_MAP.keys()].reverse()[0]+1;this.FD_MAP.set(T,{real:F,filetype:K.WASI_FILETYPE_DIRECTORY,rights:{base:K.RIGHTS_DIRECTORY_BASE,inheriting:K.RIGHTS_DIRECTORY_INHERITING},fakePath:L,path:g})}const h=(L,g)=>(this.refreshMemory(),Array.from({length:g},(T,C)=>{const U=L+C*8,x=this.view.getUint32(U,!0),V=this.view.getUint32(U+4,!0);return new Uint8Array(this.memory.buffer,x,V)})),u=(L,g)=>{const F=Bs(this,L);if(g!==Qt.BigIntPolyfill(0)&&(F.rights.base&g)===Qt.BigIntPolyfill(0))throw new ci(K.WASI_EPERM);return F},s=a.hrtime(),_=L=>{switch(L){case K.WASI_CLOCK_MONOTONIC:return a.hrtime();case K.WASI_CLOCK_REALTIME:return Wn(Date.now());case K.WASI_CLOCK_PROCESS_CPUTIME_ID:case K.WASI_CLOCK_THREAD_CPUTIME_ID:return a.hrtime()-s;default:return null}};this.wasiImport={args_get:(L,g)=>{this.refreshMemory();let F=L,T=g;return o.forEach(C=>{this.view.setUint32(F,T,!0),F+=4,T+=oe.default.from(this.memory.buffer).write(`${C}\0`,T)}),K.WASI_ESUCCESS},args_sizes_get:(L,g)=>{this.refreshMemory(),this.view.setUint32(L,o.length,!0);const F=o.reduce((T,C)=>T+oe.default.byteLength(C)+1,0);return this.view.setUint32(g,F,!0),K.WASI_ESUCCESS},environ_get:(L,g)=>{this.refreshMemory();let F=L,T=g;return Object.entries(i).forEach(([C,U])=>{this.view.setUint32(F,T,!0),F+=4,T+=oe.default.from(this.memory.buffer).write(`${C}=${U}\0`,T)}),K.WASI_ESUCCESS},environ_sizes_get:(L,g)=>{this.refreshMemory();const F=Object.entries(i).map(([C,U])=>`${C}=${U}\0`),T=F.reduce((C,U)=>C+oe.default.byteLength(U),0);return this.view.setUint32(L,F.length,!0),this.view.setUint32(g,T,!0),K.WASI_ESUCCESS},clock_res_get:(L,g)=>{let F;switch(L){case K.WASI_CLOCK_MONOTONIC:case K.WASI_CLOCK_PROCESS_CPUTIME_ID:case K.WASI_CLOCK_THREAD_CPUTIME_ID:{F=Qt.BigIntPolyfill(1);break}case K.WASI_CLOCK_REALTIME:{F=Qt.BigIntPolyfill(1e3);break}}return this.view.setBigUint64(g,F),K.WASI_ESUCCESS},clock_time_get:(L,g,F)=>{this.refreshMemory();const T=_(L);return T===null?K.WASI_EINVAL:(this.view.setBigUint64(F,Qt.BigIntPolyfill(T),!0),K.WASI_ESUCCESS)},fd_advise:Zt((L,g,F,T)=>(u(L,K.WASI_RIGHT_FD_ADVISE),K.WASI_ENOSYS)),fd_allocate:Zt((L,g,F)=>(u(L,K.WASI_RIGHT_FD_ALLOCATE),K.WASI_ENOSYS)),fd_close:Zt(L=>{const g=u(L,Qt.BigIntPolyfill(0));return c.closeSync(g.real),this.FD_MAP.delete(L),K.WASI_ESUCCESS}),fd_datasync:Zt(L=>{const g=u(L,K.WASI_RIGHT_FD_DATASYNC);return c.fdatasyncSync(g.real),K.WASI_ESUCCESS}),fd_fdstat_get:Zt((L,g)=>{const F=u(L,Qt.BigIntPolyfill(0));return this.refreshMemory(),this.view.setUint8(g,F.filetype),this.view.setUint16(g+2,0,!0),this.view.setUint16(g+4,0,!0),this.view.setBigUint64(g+8,Qt.BigIntPolyfill(F.rights.base),!0),this.view.setBigUint64(g+8+8,Qt.BigIntPolyfill(F.rights.inheriting),!0),K.WASI_ESUCCESS}),fd_fdstat_set_flags:Zt((L,g)=>(u(L,K.WASI_RIGHT_FD_FDSTAT_SET_FLAGS),K.WASI_ENOSYS)),fd_fdstat_set_rights:Zt((L,g,F)=>{const T=u(L,Qt.BigIntPolyfill(0));return(T.rights.base|g)>T.rights.base||(T.rights.inheriting|F)>T.rights.inheriting?K.WASI_EPERM:(T.rights.base=g,T.rights.inheriting=F,K.WASI_ESUCCESS)}),fd_filestat_get:Zt((L,g)=>{const F=u(L,K.WASI_RIGHT_FD_FILESTAT_GET),T=c.fstatSync(F.real);return this.refreshMemory(),this.view.setBigUint64(g,Qt.BigIntPolyfill(T.dev),!0),g+=8,this.view.setBigUint64(g,Qt.BigIntPolyfill(T.ino),!0),g+=8,this.view.setUint8(g,F.filetype),g+=8,this.view.setBigUint64(g,Qt.BigIntPolyfill(T.nlink),!0),g+=8,this.view.setBigUint64(g,Qt.BigIntPolyfill(T.size),!0),g+=8,this.view.setBigUint64(g,Wn(T.atimeMs),!0),g+=8,this.view.setBigUint64(g,Wn(T.mtimeMs),!0),g+=8,this.view.setBigUint64(g,Wn(T.ctimeMs),!0),K.WASI_ESUCCESS}),fd_filestat_set_size:Zt((L,g)=>{const F=u(L,K.WASI_RIGHT_FD_FILESTAT_SET_SIZE);return c.ftruncateSync(F.real,Number(g)),K.WASI_ESUCCESS}),fd_filestat_set_times:Zt((L,g,F,T)=>{const C=u(L,K.WASI_RIGHT_FD_FILESTAT_SET_TIMES),U=c.fstatSync(C.real);let x=U.atime,V=U.mtime;const D=si(_(K.WASI_CLOCK_REALTIME)),$=K.WASI_FILESTAT_SET_ATIM|K.WASI_FILESTAT_SET_ATIM_NOW;if((T&$)===$)return K.WASI_EINVAL;const v=K.WASI_FILESTAT_SET_MTIM|K.WASI_FILESTAT_SET_MTIM_NOW;return(T&v)===v?K.WASI_EINVAL:((T&K.WASI_FILESTAT_SET_ATIM)===K.WASI_FILESTAT_SET_ATIM?x=si(g):(T&K.WASI_FILESTAT_SET_ATIM_NOW)===K.WASI_FILESTAT_SET_ATIM_NOW&&(x=D),(T&K.WASI_FILESTAT_SET_MTIM)===K.WASI_FILESTAT_SET_MTIM?V=si(F):(T&K.WASI_FILESTAT_SET_MTIM_NOW)===K.WASI_FILESTAT_SET_MTIM_NOW&&(V=D),c.futimesSync(C.real,new Date(x),new Date(V)),K.WASI_ESUCCESS)}),fd_prestat_get:Zt((L,g)=>{const F=u(L,Qt.BigIntPolyfill(0));return F.path?(this.refreshMemory(),this.view.setUint8(g,K.WASI_PREOPENTYPE_DIR),this.view.setUint32(g+4,oe.default.byteLength(F.fakePath),!0),K.WASI_ESUCCESS):K.WASI_EINVAL}),fd_prestat_dir_name:Zt((L,g,F)=>{const T=u(L,Qt.BigIntPolyfill(0));return T.path?(this.refreshMemory(),oe.default.from(this.memory.buffer).write(T.fakePath,g,F,"utf8"),K.WASI_ESUCCESS):K.WASI_EINVAL}),fd_pwrite:Zt((L,g,F,T,C)=>{const U=u(L,K.WASI_RIGHT_FD_WRITE|K.WASI_RIGHT_FD_SEEK);let x=0;return h(g,F).forEach(V=>{let D=0;for(;D<V.byteLength;)D+=c.writeSync(U.real,V,D,V.byteLength-D,Number(T)+x+D);x+=D}),this.view.setUint32(C,x,!0),K.WASI_ESUCCESS}),fd_write:Zt((L,g,F,T)=>{const C=u(L,K.WASI_RIGHT_FD_WRITE);let U=0;return h(g,F).forEach(x=>{let V=0;for(;V<x.byteLength;){const D=c.writeSync(C.real,x,V,x.byteLength-V,C.offset!==void 0?Number(C.offset):null);C.offset!==void 0&&(C.offset+=Qt.BigIntPolyfill(D)),V+=D}U+=V}),this.view.setUint32(T,U,!0),K.WASI_ESUCCESS}),fd_pread:Zt((L,g,F,T,C)=>{const U=u(L,K.WASI_RIGHT_FD_READ|K.WASI_RIGHT_FD_SEEK);let x=0;t:for(const V of h(g,F)){let D=0;for(;D<V.byteLength;){const $=V.byteLength-D,v=c.readSync(U.real,V,D,V.byteLength-D,Number(T)+x+D);if(D+=v,x+=v,v===0||v<$)break t}x+=D}return this.view.setUint32(C,x,!0),K.WASI_ESUCCESS}),fd_read:Zt((L,g,F,T)=>{const C=u(L,K.WASI_RIGHT_FD_READ),U=C.real===0;let x=0;t:for(const V of h(g,F)){let D=0;for(;D<V.byteLength;){let $=V.byteLength-D,v=U||C.offset===void 0?null:Number(C.offset),m=c.readSync(C.real,V,D,$,v);if(U||(C.offset=(C.offset?C.offset:Qt.BigIntPolyfill(0))+Qt.BigIntPolyfill(m)),D+=m,x+=m,m===0||m<$)break t}}return this.view.setUint32(T,x,!0),K.WASI_ESUCCESS}),fd_readdir:Zt((L,g,F,T,C)=>{const U=u(L,K.WASI_RIGHT_FD_READDIR);this.refreshMemory();const x=c.readdirSync(U.path,{withFileTypes:!0}),V=g;for(let $=Number(T);$<x.length;$+=1){const v=x[$];let m=oe.default.byteLength(v.name);if(g-V>F||(this.view.setBigUint64(g,Qt.BigIntPolyfill($+1),!0),g+=8,g-V>F))break;const y=c.statSync(d.resolve(U.path,v.name));if(this.view.setBigUint64(g,Qt.BigIntPolyfill(y.ino),!0),g+=8,g-V>F||(this.view.setUint32(g,m,!0),g+=4,g-V>F))break;let G;switch(!0){case y.isBlockDevice():G=K.WASI_FILETYPE_BLOCK_DEVICE;break;case y.isCharacterDevice():G=K.WASI_FILETYPE_CHARACTER_DEVICE;break;case y.isDirectory():G=K.WASI_FILETYPE_DIRECTORY;break;case y.isFIFO():G=K.WASI_FILETYPE_SOCKET_STREAM;break;case y.isFile():G=K.WASI_FILETYPE_REGULAR_FILE;break;case y.isSocket():G=K.WASI_FILETYPE_SOCKET_STREAM;break;case y.isSymbolicLink():G=K.WASI_FILETYPE_SYMBOLIC_LINK;break;default:G=K.WASI_FILETYPE_UNKNOWN;break}if(this.view.setUint8(g,G),g+=1,g+=3,g+m>=V+F)break;oe.default.from(this.memory.buffer).write(v.name,g),g+=m}const D=g-V;return this.view.setUint32(C,Math.min(D,F),!0),K.WASI_ESUCCESS}),fd_renumber:Zt((L,g)=>(u(L,Qt.BigIntPolyfill(0)),u(g,Qt.BigIntPolyfill(0)),c.closeSync(this.FD_MAP.get(L).real),this.FD_MAP.set(L,this.FD_MAP.get(g)),this.FD_MAP.delete(g),K.WASI_ESUCCESS)),fd_seek:Zt((L,g,F,T)=>{const C=u(L,K.WASI_RIGHT_FD_SEEK);switch(this.refreshMemory(),F){case K.WASI_WHENCE_CUR:C.offset=(C.offset?C.offset:Qt.BigIntPolyfill(0))+Qt.BigIntPolyfill(g);break;case K.WASI_WHENCE_END:const{size:U}=c.fstatSync(C.real);C.offset=Qt.BigIntPolyfill(U)+Qt.BigIntPolyfill(g);break;case K.WASI_WHENCE_SET:C.offset=Qt.BigIntPolyfill(g);break}return this.view.setBigUint64(T,C.offset,!0),K.WASI_ESUCCESS}),fd_tell:Zt((L,g)=>{const F=u(L,K.WASI_RIGHT_FD_TELL);return this.refreshMemory(),F.offset||(F.offset=Qt.BigIntPolyfill(0)),this.view.setBigUint64(g,F.offset,!0),K.WASI_ESUCCESS}),fd_sync:Zt(L=>{const g=u(L,K.WASI_RIGHT_FD_SYNC);return c.fsyncSync(g.real),K.WASI_ESUCCESS}),path_create_directory:Zt((L,g,F)=>{const T=u(L,K.WASI_RIGHT_PATH_CREATE_DIRECTORY);if(!T.path)return K.WASI_EINVAL;this.refreshMemory();const C=oe.default.from(this.memory.buffer,g,F).toString();return c.mkdirSync(d.resolve(T.path,C)),K.WASI_ESUCCESS}),path_filestat_get:Zt((L,g,F,T,C)=>{const U=u(L,K.WASI_RIGHT_PATH_FILESTAT_GET);if(!U.path)return K.WASI_EINVAL;this.refreshMemory();const x=oe.default.from(this.memory.buffer,F,T).toString(),V=c.statSync(d.resolve(U.path,x));return this.view.setBigUint64(C,Qt.BigIntPolyfill(V.dev),!0),C+=8,this.view.setBigUint64(C,Qt.BigIntPolyfill(V.ino),!0),C+=8,this.view.setUint8(C,xs(this,void 0,V).filetype),C+=8,this.view.setBigUint64(C,Qt.BigIntPolyfill(V.nlink),!0),C+=8,this.view.setBigUint64(C,Qt.BigIntPolyfill(V.size),!0),C+=8,this.view.setBigUint64(C,Wn(V.atimeMs),!0),C+=8,this.view.setBigUint64(C,Wn(V.mtimeMs),!0),C+=8,this.view.setBigUint64(C,Wn(V.ctimeMs),!0),K.WASI_ESUCCESS}),path_filestat_set_times:Zt((L,g,F,T,C,U,x)=>{const V=u(L,K.WASI_RIGHT_PATH_FILESTAT_SET_TIMES);if(!V.path)return K.WASI_EINVAL;this.refreshMemory();const D=c.fstatSync(V.real);let $=D.atime,v=D.mtime;const m=si(_(K.WASI_CLOCK_REALTIME)),y=K.WASI_FILESTAT_SET_ATIM|K.WASI_FILESTAT_SET_ATIM_NOW;if((x&y)===y)return K.WASI_EINVAL;const G=K.WASI_FILESTAT_SET_MTIM|K.WASI_FILESTAT_SET_MTIM_NOW;if((x&G)===G)return K.WASI_EINVAL;(x&K.WASI_FILESTAT_SET_ATIM)===K.WASI_FILESTAT_SET_ATIM?$=si(C):(x&K.WASI_FILESTAT_SET_ATIM_NOW)===K.WASI_FILESTAT_SET_ATIM_NOW&&($=m),(x&K.WASI_FILESTAT_SET_MTIM)===K.WASI_FILESTAT_SET_MTIM?v=si(U):(x&K.WASI_FILESTAT_SET_MTIM_NOW)===K.WASI_FILESTAT_SET_MTIM_NOW&&(v=m);const k=oe.default.from(this.memory.buffer,F,T).toString();return c.utimesSync(d.resolve(V.path,k),new Date($),new Date(v)),K.WASI_ESUCCESS}),path_link:Zt((L,g,F,T,C,U,x)=>{const V=u(L,K.WASI_RIGHT_PATH_LINK_SOURCE),D=u(C,K.WASI_RIGHT_PATH_LINK_TARGET);if(!V.path||!D.path)return K.WASI_EINVAL;this.refreshMemory();const $=oe.default.from(this.memory.buffer,F,T).toString(),v=oe.default.from(this.memory.buffer,U,x).toString();return c.linkSync(d.resolve(V.path,$),d.resolve(D.path,v)),K.WASI_ESUCCESS}),path_open:Zt((L,g,F,T,C,U,x,V,D)=>{const $=u(L,K.WASI_RIGHT_PATH_OPEN);U=Qt.BigIntPolyfill(U),x=Qt.BigIntPolyfill(x);const v=(U&(K.WASI_RIGHT_FD_READ|K.WASI_RIGHT_FD_READDIR))!==Qt.BigIntPolyfill(0),m=(U&(K.WASI_RIGHT_FD_DATASYNC|K.WASI_RIGHT_FD_WRITE|K.WASI_RIGHT_FD_ALLOCATE|K.WASI_RIGHT_FD_FILESTAT_SET_SIZE))!==Qt.BigIntPolyfill(0);let y;m&&v?y=c.constants.O_RDWR:v?y=c.constants.O_RDONLY:m&&(y=c.constants.O_WRONLY);let G=U|K.WASI_RIGHT_PATH_OPEN,k=U|x;(C&K.WASI_O_CREAT)!=0&&(y|=c.constants.O_CREAT,G|=K.WASI_RIGHT_PATH_CREATE_FILE),(C&K.WASI_O_DIRECTORY)!=0&&(y|=c.constants.O_DIRECTORY),(C&K.WASI_O_EXCL)!=0&&(y|=c.constants.O_EXCL),(C&K.WASI_O_TRUNC)!=0&&(y|=c.constants.O_TRUNC,G|=K.WASI_RIGHT_PATH_FILESTAT_SET_SIZE),(V&K.WASI_FDFLAG_APPEND)!=0&&(y|=c.constants.O_APPEND),(V&K.WASI_FDFLAG_DSYNC)!=0&&(c.constants.O_DSYNC?y|=c.constants.O_DSYNC:y|=c.constants.O_SYNC,k|=K.WASI_RIGHT_FD_DATASYNC),(V&K.WASI_FDFLAG_NONBLOCK)!=0&&(y|=c.constants.O_NONBLOCK),(V&K.WASI_FDFLAG_RSYNC)!=0&&(c.constants.O_RSYNC?y|=c.constants.O_RSYNC:y|=c.constants.O_SYNC,k|=K.WASI_RIGHT_FD_SYNC),(V&K.WASI_FDFLAG_SYNC)!=0&&(y|=c.constants.O_SYNC,k|=K.WASI_RIGHT_FD_SYNC),m&&(y&(c.constants.O_APPEND|c.constants.O_TRUNC))==0&&(k|=K.WASI_RIGHT_FD_SEEK),this.refreshMemory();const N=oe.default.from(this.memory.buffer,F,T).toString(),R=d.resolve($.path,N);if(d.relative($.path,R).startsWith(".."))return K.WASI_ENOTCAPABLE;let E;try{if(E=c.realpathSync(R),d.relative($.path,E).startsWith(".."))return K.WASI_ENOTCAPABLE}catch(it){if(it.code==="ENOENT")E=R;else throw it}let z;try{z=c.statSync(E).isDirectory()}catch{}let tt;!m&&z?tt=c.openSync(E,c.constants.O_RDONLY):tt=c.openSync(E,y);const at=[...this.FD_MAP.keys()].reverse()[0]+1;return this.FD_MAP.set(at,{real:tt,filetype:void 0,offset:BigInt(0),rights:{base:G,inheriting:k},path:E}),Bs(this,at),this.view.setUint32(D,at,!0),K.WASI_ESUCCESS}),path_readlink:Zt((L,g,F,T,C,U)=>{const x=u(L,K.WASI_RIGHT_PATH_READLINK);if(!x.path)return K.WASI_EINVAL;this.refreshMemory();const V=oe.default.from(this.memory.buffer,g,F).toString(),D=d.resolve(x.path,V),$=c.readlinkSync(D),v=oe.default.from(this.memory.buffer).write($,T,C);return this.view.setUint32(U,v,!0),K.WASI_ESUCCESS}),path_remove_directory:Zt((L,g,F)=>{const T=u(L,K.WASI_RIGHT_PATH_REMOVE_DIRECTORY);if(!T.path)return K.WASI_EINVAL;this.refreshMemory();const C=oe.default.from(this.memory.buffer,g,F).toString();return c.rmdirSync(d.resolve(T.path,C)),K.WASI_ESUCCESS}),path_rename:Zt((L,g,F,T,C,U)=>{const x=u(L,K.WASI_RIGHT_PATH_RENAME_SOURCE),V=u(T,K.WASI_RIGHT_PATH_RENAME_TARGET);if(!x.path||!V.path)return K.WASI_EINVAL;this.refreshMemory();const D=oe.default.from(this.memory.buffer,g,F).toString(),$=oe.default.from(this.memory.buffer,C,U).toString();return c.renameSync(d.resolve(x.path,D),d.resolve(V.path,$)),K.WASI_ESUCCESS}),path_symlink:Zt((L,g,F,T,C)=>{const U=u(F,K.WASI_RIGHT_PATH_SYMLINK);if(!U.path)return K.WASI_EINVAL;this.refreshMemory();const x=oe.default.from(this.memory.buffer,L,g).toString(),V=oe.default.from(this.memory.buffer,T,C).toString();return c.symlinkSync(x,d.resolve(U.path,V)),K.WASI_ESUCCESS}),path_unlink_file:Zt((L,g,F)=>{const T=u(L,K.WASI_RIGHT_PATH_UNLINK_FILE);if(!T.path)return K.WASI_EINVAL;this.refreshMemory();const C=oe.default.from(this.memory.buffer,g,F).toString();return c.unlinkSync(d.resolve(T.path,C)),K.WASI_ESUCCESS}),poll_oneoff:(L,g,F,T)=>{let C=0,U=0;this.refreshMemory();for(let x=0;x<F;x+=1){const V=this.view.getBigUint64(L,!0);L+=8;const D=this.view.getUint8(L);switch(L+=1,D){case K.WASI_EVENTTYPE_CLOCK:{L+=7,this.view.getBigUint64(L,!0),L+=8;const $=this.view.getUint32(L,!0);L+=4,L+=4;const v=this.view.getBigUint64(L,!0);L+=8,this.view.getBigUint64(L,!0),L+=8;const m=this.view.getUint16(L,!0);L+=2,L+=6;const y=m===1;let G=K.WASI_ESUCCESS;const k=Qt.BigIntPolyfill(_($));if(k===null)G=K.WASI_EINVAL;else{const N=y?v:k+v;U=N>U?N:U}this.view.setBigUint64(g,V,!0),g+=8,this.view.setUint16(g,G,!0),g+=2,this.view.setUint8(g,K.WASI_EVENTTYPE_CLOCK),g+=1,g+=5,C+=1;break}case K.WASI_EVENTTYPE_FD_READ:case K.WASI_EVENTTYPE_FD_WRITE:{L+=3,this.view.getUint32(L,!0),L+=4,this.view.setBigUint64(g,V,!0),g+=8,this.view.setUint16(g,K.WASI_ENOSYS,!0),g+=2,this.view.setUint8(g,D),g+=1,g+=5,C+=1;break}default:return K.WASI_EINVAL}}for(this.view.setUint32(T,C,!0);a.hrtime()<U;);return K.WASI_ESUCCESS},proc_exit:L=>(a.exit(L),K.WASI_ESUCCESS),proc_raise:L=>L in K.SIGNAL_MAP?(a.kill(K.SIGNAL_MAP[L]),K.WASI_ESUCCESS):K.WASI_EINVAL,random_get:(L,g)=>(this.refreshMemory(),a.randomFillSync(new Uint8Array(this.memory.buffer),L,g),K.WASI_ESUCCESS),sched_yield(){return K.WASI_ESUCCESS},sock_recv(){return K.WASI_ENOSYS},sock_send(){return K.WASI_ENOSYS},sock_shutdown(){return K.WASI_ENOSYS}},t.traceSyscalls&&Object.keys(this.wasiImport).forEach(L=>{const g=this.wasiImport[L];this.wasiImport[L]=function(...F){console.log(`WASI: wasiImport called: ${L} (${F})`);try{let T=g(...F);return console.log(`WASI:  => ${T}`),T}catch(T){throw console.log(`Catched error: ${T}`),T}}})}refreshMemory(){(!this.view||this.view.buffer.byteLength===0)&&(this.view=new cf.DataViewPolyfill(this.memory.buffer))}setMemory(t){this.memory=t}start(t){const n=t.exports;if(n===null||typeof n!="object")throw new Error(`instance.exports must be an Object. Received ${n}.`);const{memory:i}=n;if(!(i instanceof WebAssembly.Memory))throw new Error(`instance.exports.memory must be a WebAssembly.Memory. Recceived ${i}.`);this.setMemory(i),n._start&&n._start()}getImportNamespace(t){let n=null;for(let i of WebAssembly.Module.imports(t))if(i.kind==="function"&&!!i.module.startsWith("wasi_")){if(!n)n=i.module;else if(n!==i.module)throw new Error("Multiple namespaces detected.")}return n}getImports(t){switch(this.getImportNamespace(t)){case"wasi_unstable":return{wasi_unstable:this.wasiImport};case"wasi_snapshot_preview1":return{wasi_snapshot_preview1:this.wasiImport};default:throw new Error("Can't detect a WASI namespace for the WebAssembly Module")}}}ri.default=ua,ua.defaultBindings=Fs;var hf=ri.WASI=ua;function on(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function Os(e,t){for(var n="",i=0,o=-1,a=0,c,d=0;d<=e.length;++d){if(d<e.length)c=e.charCodeAt(d);else{if(c===47)break;c=47}if(c===47){if(!(o===d-1||a===1))if(o!==d-1&&a===2){if(n.length<2||i!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var h=n.lastIndexOf("/");if(h!==n.length-1){h===-1?(n="",i=0):(n=n.slice(0,h),i=n.length-1-n.lastIndexOf("/")),o=d,a=0;continue}}else if(n.length===2||n.length===1){n="",i=0,o=d,a=0;continue}}t&&(n.length>0?n+="/..":n="..",i=2)}else n.length>0?n+="/"+e.slice(o+1,d):n=e.slice(o+1,d),i=d-o-1;o=d,a=0}else c===46&&a!==-1?++a:a=-1}return n}function gf(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+e+i:i}var li={resolve:function(){for(var t="",n=!1,i,o=arguments.length-1;o>=-1&&!n;o--){var a;o>=0?a=arguments[o]:(i===void 0&&(i=process.cwd()),a=i),on(a),a.length!==0&&(t=a+"/"+t,n=a.charCodeAt(0)===47)}return t=Os(t,!n),n?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(t){if(on(t),t.length===0)return".";var n=t.charCodeAt(0)===47,i=t.charCodeAt(t.length-1)===47;return t=Os(t,!n),t.length===0&&!n&&(t="."),t.length>0&&i&&(t+="/"),n?"/"+t:t},isAbsolute:function(t){return on(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,n=0;n<arguments.length;++n){var i=arguments[n];on(i),i.length>0&&(t===void 0?t=i:t+="/"+i)}return t===void 0?".":li.normalize(t)},relative:function(t,n){if(on(t),on(n),t===n||(t=li.resolve(t),n=li.resolve(n),t===n))return"";for(var i=1;i<t.length&&t.charCodeAt(i)===47;++i);for(var o=t.length,a=o-i,c=1;c<n.length&&n.charCodeAt(c)===47;++c);for(var d=n.length,h=d-c,u=a<h?a:h,s=-1,_=0;_<=u;++_){if(_===u){if(h>u){if(n.charCodeAt(c+_)===47)return n.slice(c+_+1);if(_===0)return n.slice(c+_)}else a>u&&(t.charCodeAt(i+_)===47?s=_:_===0&&(s=0));break}var L=t.charCodeAt(i+_),g=n.charCodeAt(c+_);if(L!==g)break;L===47&&(s=_)}var F="";for(_=i+s+1;_<=o;++_)(_===o||t.charCodeAt(_)===47)&&(F.length===0?F+="..":F+="/..");return F.length>0?F+n.slice(c+s):(c+=s,n.charCodeAt(c)===47&&++c,n.slice(c))},_makeLong:function(t){return t},dirname:function(t){if(on(t),t.length===0)return".";for(var n=t.charCodeAt(0),i=n===47,o=-1,a=!0,c=t.length-1;c>=1;--c)if(n=t.charCodeAt(c),n===47){if(!a){o=c;break}}else a=!1;return o===-1?i?"/":".":i&&o===1?"//":t.slice(0,o)},basename:function(t,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');on(t);var i=0,o=-1,a=!0,c;if(n!==void 0&&n.length>0&&n.length<=t.length){if(n.length===t.length&&n===t)return"";var d=n.length-1,h=-1;for(c=t.length-1;c>=0;--c){var u=t.charCodeAt(c);if(u===47){if(!a){i=c+1;break}}else h===-1&&(a=!1,h=c+1),d>=0&&(u===n.charCodeAt(d)?--d==-1&&(o=c):(d=-1,o=h))}return i===o?o=h:o===-1&&(o=t.length),t.slice(i,o)}else{for(c=t.length-1;c>=0;--c)if(t.charCodeAt(c)===47){if(!a){i=c+1;break}}else o===-1&&(a=!1,o=c+1);return o===-1?"":t.slice(i,o)}},extname:function(t){on(t);for(var n=-1,i=0,o=-1,a=!0,c=0,d=t.length-1;d>=0;--d){var h=t.charCodeAt(d);if(h===47){if(!a){i=d+1;break}continue}o===-1&&(a=!1,o=d+1),h===46?n===-1?n=d:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||o===-1||c===0||c===1&&n===o-1&&n===i+1?"":t.slice(n,o)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return gf("/",t)},parse:function(t){on(t);var n={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return n;var i=t.charCodeAt(0),o=i===47,a;o?(n.root="/",a=1):a=0;for(var c=-1,d=0,h=-1,u=!0,s=t.length-1,_=0;s>=a;--s){if(i=t.charCodeAt(s),i===47){if(!u){d=s+1;break}continue}h===-1&&(u=!1,h=s+1),i===46?c===-1?c=s:_!==1&&(_=1):c!==-1&&(_=-1)}return c===-1||h===-1||_===0||_===1&&c===h-1&&c===d+1?h!==-1&&(d===0&&o?n.base=n.name=t.slice(1,h):n.base=n.name=t.slice(d,h)):(d===0&&o?(n.name=t.slice(1,c),n.base=t.slice(1,h)):(n.name=t.slice(d,c),n.base=t.slice(d,h)),n.ext=t.slice(c,h)),d>0?n.dir=t.slice(0,d-1):o&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};li.posix=li;var da=li,pf=_e({__proto__:null,default:da},[da]);function _f(e,t,n,i){return new(n||(n=Promise))(function(o,a){function c(u){try{h(i.next(u))}catch(s){a(s)}}function d(u){try{h(i.throw(u))}catch(s){a(s)}}function h(u){u.done?o(u.value):new n(function(s){s(u.value)}).then(c,d)}h((i=i.apply(e,t||[])).next())})}function mf(e,t){function n(u){return function(s){return i([u,s])}}function i(u){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,c&&(d=u[0]&2?c.return:u[0]?c.throw||((d=c.return)&&d.call(c),0):c.next)&&!(d=d.call(c,u[1])).done)return d;switch(c=0,d&&(u=[u[0]&2,d.value]),u[0]){case 0:case 1:d=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,c=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(d=o.trys,!(d=0<d.length&&d[d.length-1])&&(u[0]===6||u[0]===2)){o=0;continue}if(u[0]===3&&(!d||u[1]>d[0]&&u[1]<d[3]))o.label=u[1];else if(u[0]===6&&o.label<d[1])o.label=d[1],d=u;else if(d&&o.label<d[2])o.label=d[2],o.ops.push(u);else{d[2]&&o.ops.pop(),o.trys.pop();continue}}u=t.call(e,o)}catch(s){u=[6,s],c=0}finally{a=d=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}var o={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},a,c,d,h;return h={next:n(0),throw:n(1),return:n(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h}function fa(e){var t=typeof Symbol=="function"&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function Lf(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;e=n.call(e);var i,o=[];try{for(;(t===void 0||0<t--)&&!(i=e.next()).done;)o.push(i.value)}catch(c){var a={error:c}}finally{try{i&&!i.done&&(n=e.return)&&n.call(e)}finally{if(a)throw a.error}}return o}function yf(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Lf(arguments[t]));return e}var ce=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Se(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function be(e,t){return t={exports:{}},e(t,t.exports),t.exports}var jt=be(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.constants={O_RDONLY:0,O_WRONLY:1,O_RDWR:2,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,UV_FS_COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_EXCL:1,COPYFILE_FICLONE:2,COPYFILE_FICLONE_FORCE:4}});Se(jt);var Af=be(function(e,t){t.default=typeof BigInt=="function"?BigInt:function(){throw Error("BigInt is not supported in this environment.")}}),ui=be(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=jt.constants.S_IFMT,i=jt.constants.S_IFDIR,o=jt.constants.S_IFREG,a=jt.constants.S_IFBLK,c=jt.constants.S_IFCHR,d=jt.constants.S_IFLNK,h=jt.constants.S_IFIFO,u=jt.constants.S_IFSOCK;e=function(){function s(){}return s.build=function(_,L){L===void 0&&(L=!1);var g=new s,F=_.gid,T=_.atime,C=_.mtime,U=_.ctime;return L=L?Af.default:function(x){return x},g.uid=L(_.uid),g.gid=L(F),g.rdev=L(0),g.blksize=L(4096),g.ino=L(_.ino),g.size=L(_.getSize()),g.blocks=L(1),g.atime=T,g.mtime=C,g.ctime=U,g.birthtime=U,g.atimeMs=L(T.getTime()),g.mtimeMs=L(C.getTime()),F=L(U.getTime()),g.ctimeMs=F,g.birthtimeMs=F,g.dev=L(0),g.mode=L(_.mode),g.nlink=L(_.nlink),g},s.prototype._checkModeProperty=function(_){return(Number(this.mode)&n)===_},s.prototype.isDirectory=function(){return this._checkModeProperty(i)},s.prototype.isFile=function(){return this._checkModeProperty(o)},s.prototype.isBlockDevice=function(){return this._checkModeProperty(a)},s.prototype.isCharacterDevice=function(){return this._checkModeProperty(c)},s.prototype.isSymbolicLink=function(){return this._checkModeProperty(d)},s.prototype.isFIFO=function(){return this._checkModeProperty(h)},s.prototype.isSocket=function(){return this._checkModeProperty(u)},s}(),t.Stats=e,t.default=e});Se(ui);var $n=typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{},an=[],Ke=[],wf=typeof Uint8Array!="undefined"?Uint8Array:Array,ha=!1;function Ts(){ha=!0;for(var e=0;64>e;++e)an[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e],Ke["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;Ke[45]=62,Ke[95]=63}function If(e,t,n){for(var i=[],o=t;o<n;o+=3)t=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(an[t>>18&63]+an[t>>12&63]+an[t>>6&63]+an[t&63]);return i.join("")}function Ps(e){ha||Ts();for(var t=e.length,n=t%3,i="",o=[],a=0,c=t-n;a<c;a+=16383)o.push(If(e,a,a+16383>c?c:a+16383));return n===1?(e=e[t-1],i+=an[e>>2],i+=an[e<<4&63],i+="=="):n===2&&(e=(e[t-2]<<8)+e[t-1],i+=an[e>>10],i+=an[e>>4&63],i+=an[e<<2&63],i+="="),o.push(i),o.join("")}function yo(e,t,n,i,o){var a=8*o-i-1,c=(1<<a)-1,d=c>>1,h=-7;o=n?o-1:0;var u=n?-1:1,s=e[t+o];for(o+=u,n=s&(1<<-h)-1,s>>=-h,h+=a;0<h;n=256*n+e[t+o],o+=u,h-=8);for(a=n&(1<<-h)-1,n>>=-h,h+=i;0<h;a=256*a+e[t+o],o+=u,h-=8);if(n===0)n=1-d;else{if(n===c)return a?NaN:1/0*(s?-1:1);a+=Math.pow(2,i),n-=d}return(s?-1:1)*a*Math.pow(2,n-i)}function Ao(e,t,n,i,o,a){var c,d=8*a-o-1,h=(1<<d)-1,u=h>>1,s=o===23?Math.pow(2,-24)-Math.pow(2,-77):0;a=i?0:a-1;var _=i?1:-1,L=0>t||t===0&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(t=isNaN(t)?1:0,i=h):(i=Math.floor(Math.log(t)/Math.LN2),1>t*(c=Math.pow(2,-i))&&(i--,c*=2),t=1<=i+u?t+s/c:t+s*Math.pow(2,1-u),2<=t*c&&(i++,c/=2),i+u>=h?(t=0,i=h):1<=i+u?(t=(t*c-1)*Math.pow(2,o),i+=u):(t=t*Math.pow(2,u-1)*Math.pow(2,o),i=0));8<=o;e[n+a]=t&255,a+=_,t/=256,o-=8);for(i=i<<o|t,d+=o;0<d;e[n+a]=i&255,a+=_,i/=256,d-=8);e[n+a-_]|=128*L}var bf={}.toString,Rs=Array.isArray||function(e){return bf.call(e)=="[object Array]"};At.TYPED_ARRAY_SUPPORT=$n.TYPED_ARRAY_SUPPORT!==void 0?$n.TYPED_ARRAY_SUPPORT:!0;var Ef=At.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function Ln(e,t){if((At.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<t)throw new RangeError("Invalid typed array length");return At.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=At.prototype):(e===null&&(e=new At(t)),e.length=t),e}function At(e,t,n){if(!(At.TYPED_ARRAY_SUPPORT||this instanceof At))return new At(e,t,n);if(typeof e=="number"){if(typeof t=="string")throw Error("If encoding is specified then the first argument must be a string");return ga(this,e)}return Us(this,e,t,n)}At.poolSize=8192,At._augment=function(e){return e.__proto__=At.prototype,e};function Us(e,t,n,i){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');if(typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer){if(t.byteLength,0>n||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=n===void 0&&i===void 0?new Uint8Array(t):i===void 0?new Uint8Array(t,n):new Uint8Array(t,n,i),At.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=At.prototype):e=pa(e,t),e}if(typeof t=="string"){if(i=e,e=n,(typeof e!="string"||e==="")&&(e="utf8"),!At.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');return n=Gs(t,e)|0,i=Ln(i,n),t=i.write(t,e),t!==n&&(i=i.slice(0,t)),i}return Cf(e,t)}At.from=function(e,t,n){return Us(null,e,t,n)},At.TYPED_ARRAY_SUPPORT&&(At.prototype.__proto__=Uint8Array.prototype,At.__proto__=Uint8Array);function Ms(e){if(typeof e!="number")throw new TypeError('"size" argument must be a number');if(0>e)throw new RangeError('"size" argument must not be negative')}At.alloc=function(e,t,n){return Ms(e),e=0>=e?Ln(null,e):t!==void 0?typeof n=="string"?Ln(null,e).fill(t,n):Ln(null,e).fill(t):Ln(null,e),e};function ga(e,t){if(Ms(t),e=Ln(e,0>t?0:_a(t)|0),!At.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}At.allocUnsafe=function(e){return ga(null,e)},At.allocUnsafeSlow=function(e){return ga(null,e)};function pa(e,t){var n=0>t.length?0:_a(t.length)|0;e=Ln(e,n);for(var i=0;i<n;i+=1)e[i]=t[i]&255;return e}function Cf(e,t){if(rn(t)){var n=_a(t.length)|0;return e=Ln(e,n),e.length===0||t.copy(e,0,0,n),e}if(t){if(typeof ArrayBuffer!="undefined"&&t.buffer instanceof ArrayBuffer||"length"in t)return(n=typeof t.length!="number")||(n=t.length,n=n!==n),n?Ln(e,0):pa(e,t);if(t.type==="Buffer"&&Rs(t.data))return pa(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function _a(e){if(e>=(At.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(At.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return e|0}At.isBuffer=yn;function rn(e){return!(e==null||!e._isBuffer)}At.compare=function(e,t){if(!rn(e)||!rn(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,o=0,a=Math.min(n,i);o<a;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0},At.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},At.concat=function(e,t){if(!Rs(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return At.alloc(0);var n;if(t===void 0)for(n=t=0;n<e.length;++n)t+=e[n].length;t=At.allocUnsafe(t);var i=0;for(n=0;n<e.length;++n){var o=e[n];if(!rn(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(t,i),i+=o.length}return t};function Gs(e,t){if(rn(e))return e.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;typeof e!="string"&&(e=""+e);var n=e.length;if(n===0)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Eo(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Qs(e).length;default:if(i)return Eo(e).length;t=(""+t).toLowerCase(),i=!0}}At.byteLength=Gs;function vf(e,t,n){var i=!1;if((t===void 0||0>t)&&(t=0),t>this.length||((n===void 0||n>this.length)&&(n=this.length),0>=n)||(n>>>=0,t>>>=0,n<=t))return"";for(e||(e="utf8");;)switch(e){case"hex":for(e=t,t=n,n=this.length,(!e||0>e)&&(e=0),(!t||0>t||t>n)&&(t=n),i="",n=e;n<t;++n)e=i,i=this[n],i=16>i?"0"+i.toString(16):i.toString(16),i=e+i;return i;case"utf8":case"utf-8":return zs(this,t,n);case"ascii":for(e="",n=Math.min(this.length,n);t<n;++t)e+=String.fromCharCode(this[t]&127);return e;case"latin1":case"binary":for(e="",n=Math.min(this.length,n);t<n;++t)e+=String.fromCharCode(this[t]);return e;case"base64":return t=t===0&&n===this.length?Ps(this):Ps(this.slice(t,n)),t;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(t=this.slice(t,n),n="",e=0;e<t.length;e+=2)n+=String.fromCharCode(t[e]+256*t[e+1]);return n;default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}At.prototype._isBuffer=!0;function Hn(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}At.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Hn(this,t,t+1);return this},At.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Hn(this,t,t+3),Hn(this,t+1,t+2);return this},At.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Hn(this,t,t+7),Hn(this,t+1,t+6),Hn(this,t+2,t+5),Hn(this,t+3,t+4);return this},At.prototype.toString=function(){var e=this.length|0;return e===0?"":arguments.length===0?zs(this,0,e):vf.apply(this,arguments)},At.prototype.equals=function(e){if(!rn(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:At.compare(this,e)===0},At.prototype.inspect=function(){var e="";return 0<this.length&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(e+=" ... ")),"<Buffer "+e+">"},At.prototype.compare=function(e,t,n,i,o){if(!rn(e))throw new TypeError("Argument must be a Buffer");if(t===void 0&&(t=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),0>t||n>e.length||0>i||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=n)return 0;if(i>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;var a=o-i,c=n-t,d=Math.min(a,c);for(i=this.slice(i,o),e=e.slice(t,n),t=0;t<d;++t)if(i[t]!==e[t]){a=i[t],c=e[t];break}return a<c?-1:c<a?1:0};function Ns(e,t,n,i,o){if(e.length===0)return-1;if(typeof n=="string"?(i=n,n=0):2147483647<n?n=2147483647:-2147483648>n&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),0>n&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(0>n)if(o)n=0;else return-1;if(typeof t=="string"&&(t=At.from(t,i)),rn(t))return t.length===0?-1:qs(e,t,n,i,o);if(typeof t=="number")return t&=255,At.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):qs(e,[t],n,i,o);throw new TypeError("val must be string, number or Buffer")}function qs(e,t,n,i,o){function a(u,s){return c===1?u[s]:u.readUInt16BE(s*c)}var c=1,d=e.length,h=t.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(2>e.length||2>t.length)return-1;c=2,d/=2,h/=2,n/=2}if(o)for(i=-1;n<d;n++)if(a(e,n)===a(t,i===-1?0:n-i)){if(i===-1&&(i=n),n-i+1===h)return i*c}else i!==-1&&(n-=n-i),i=-1;else for(n+h>d&&(n=d-h);0<=n;n--){for(d=!0,i=0;i<h;i++)if(a(e,n+i)!==a(t,i)){d=!1;break}if(d)return n}return-1}At.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1},At.prototype.indexOf=function(e,t,n){return Ns(this,e,t,n,!0)},At.prototype.lastIndexOf=function(e,t,n){return Ns(this,e,t,n,!1)},At.prototype.write=function(e,t,n,i){if(t===void 0)i="utf8",n=this.length,t=0;else if(n===void 0&&typeof t=="string")i=t,n=this.length,t=0;else if(isFinite(t))t|=0,isFinite(n)?(n|=0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-t;if((n===void 0||n>o)&&(n=o),0<e.length&&(0>n||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");for(i||(i="utf8"),o=!1;;)switch(i){case"hex":t:{if(t=Number(t)||0,i=this.length-t,n?(n=Number(n),n>i&&(n=i)):n=i,i=e.length,i%2!=0)throw new TypeError("Invalid hex string");for(n>i/2&&(n=i/2),i=0;i<n;++i){if(o=parseInt(e.substr(2*i,2),16),isNaN(o)){e=i;break t}this[t+i]=o}e=i}return e;case"utf8":case"utf-8":return Pi(Eo(e,this.length-t),this,t,n);case"ascii":return Pi(ks(e),this,t,n);case"latin1":case"binary":return Pi(ks(e),this,t,n);case"base64":return Pi(Qs(e),this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=e,o=this.length-t;for(var a=[],c=0;c<i.length&&!(0>(o-=2));++c){var d=i.charCodeAt(c);e=d>>8,d%=256,a.push(d),a.push(e)}return Pi(a,this,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},At.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function zs(e,t,n){n=Math.min(e.length,n);for(var i=[];t<n;){var o=e[t],a=null,c=239<o?4:223<o?3:191<o?2:1;if(t+c<=n)switch(c){case 1:128>o&&(a=o);break;case 2:var d=e[t+1];(d&192)==128&&(o=(o&31)<<6|d&63,127<o&&(a=o));break;case 3:d=e[t+1];var h=e[t+2];(d&192)==128&&(h&192)==128&&(o=(o&15)<<12|(d&63)<<6|h&63,2047<o&&(55296>o||57343<o)&&(a=o));break;case 4:d=e[t+1],h=e[t+2];var u=e[t+3];(d&192)==128&&(h&192)==128&&(u&192)==128&&(o=(o&15)<<18|(d&63)<<12|(h&63)<<6|u&63,65535<o&&1114112>o&&(a=o))}a===null?(a=65533,c=1):65535<a&&(a-=65536,i.push(a>>>10&1023|55296),a=56320|a&1023),i.push(a),t+=c}if(e=i.length,e<=Ds)i=String.fromCharCode.apply(String,i);else{for(n="",t=0;t<e;)n+=String.fromCharCode.apply(String,i.slice(t,t+=Ds));i=n}return i}var Ds=4096;At.prototype.slice=function(e,t){var n=this.length;if(e=~~e,t=t===void 0?n:~~t,0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),t<e&&(t=e),At.TYPED_ARRAY_SUPPORT)t=this.subarray(e,t),t.__proto__=At.prototype;else{n=t-e,t=new At(n,void 0);for(var i=0;i<n;++i)t[i]=this[i+e]}return t};function Le(e,t,n){if(e%1!=0||0>e)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}At.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||Le(e,t,this.length),n=this[e];for(var i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},At.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||Le(e,t,this.length),n=this[e+--t];for(var i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},At.prototype.readUInt8=function(e,t){return t||Le(e,1,this.length),this[e]},At.prototype.readUInt16LE=function(e,t){return t||Le(e,2,this.length),this[e]|this[e+1]<<8},At.prototype.readUInt16BE=function(e,t){return t||Le(e,2,this.length),this[e]<<8|this[e+1]},At.prototype.readUInt32LE=function(e,t){return t||Le(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},At.prototype.readUInt32BE=function(e,t){return t||Le(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},At.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||Le(e,t,this.length),n=this[e];for(var i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=128*i&&(n-=Math.pow(2,8*t)),n},At.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||Le(e,t,this.length),n=t;for(var i=1,o=this[e+--n];0<n&&(i*=256);)o+=this[e+--n]*i;return o>=128*i&&(o-=Math.pow(2,8*t)),o},At.prototype.readInt8=function(e,t){return t||Le(e,1,this.length),this[e]&128?-1*(255-this[e]+1):this[e]},At.prototype.readInt16LE=function(e,t){return t||Le(e,2,this.length),e=this[e]|this[e+1]<<8,e&32768?e|4294901760:e},At.prototype.readInt16BE=function(e,t){return t||Le(e,2,this.length),e=this[e+1]|this[e]<<8,e&32768?e|4294901760:e},At.prototype.readInt32LE=function(e,t){return t||Le(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},At.prototype.readInt32BE=function(e,t){return t||Le(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},At.prototype.readFloatLE=function(e,t){return t||Le(e,4,this.length),yo(this,e,!0,23,4)},At.prototype.readFloatBE=function(e,t){return t||Le(e,4,this.length),yo(this,e,!1,23,4)},At.prototype.readDoubleLE=function(e,t){return t||Le(e,8,this.length),yo(this,e,!0,52,8)},At.prototype.readDoubleBE=function(e,t){return t||Le(e,8,this.length),yo(this,e,!1,52,8)};function Me(e,t,n,i,o,a){if(!rn(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}At.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||Me(this,e,t,n,Math.pow(2,8*n)-1,0),i=1;var o=0;for(this[t]=e&255;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},At.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||Me(this,e,t,n,Math.pow(2,8*n)-1,0),i=n-1;var o=1;for(this[t+i]=e&255;0<=--i&&(o*=256);)this[t+i]=e/o&255;return t+n},At.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||Me(this,e,t,1,255,0),At.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=e&255,t+1};function wo(e,t,n,i){0>t&&(t=65535+t+1);for(var o=0,a=Math.min(e.length-n,2);o<a;++o)e[n+o]=(t&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}At.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||Me(this,e,t,2,65535,0),At.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8):wo(this,e,t,!0),t+2},At.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||Me(this,e,t,2,65535,0),At.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=e&255):wo(this,e,t,!1),t+2};function Io(e,t,n,i){0>t&&(t=4294967295+t+1);for(var o=0,a=Math.min(e.length-n,4);o<a;++o)e[n+o]=t>>>8*(i?o:3-o)&255}At.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||Me(this,e,t,4,4294967295,0),At.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255):Io(this,e,t,!0),t+4},At.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||Me(this,e,t,4,4294967295,0),At.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255):Io(this,e,t,!1),t+4},At.prototype.writeIntLE=function(e,t,n,i){e=+e,t|=0,i||(i=Math.pow(2,8*n-1),Me(this,e,t,n,i-1,-i)),i=0;var o=1,a=0;for(this[t]=e&255;++i<n&&(o*=256);)0>e&&a===0&&this[t+i-1]!==0&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},At.prototype.writeIntBE=function(e,t,n,i){e=+e,t|=0,i||(i=Math.pow(2,8*n-1),Me(this,e,t,n,i-1,-i)),i=n-1;var o=1,a=0;for(this[t+i]=e&255;0<=--i&&(o*=256);)0>e&&a===0&&this[t+i+1]!==0&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},At.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||Me(this,e,t,1,127,-128),At.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[t]=e&255,t+1},At.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||Me(this,e,t,2,32767,-32768),At.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8):wo(this,e,t,!0),t+2},At.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||Me(this,e,t,2,32767,-32768),At.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=e&255):wo(this,e,t,!1),t+2},At.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||Me(this,e,t,4,2147483647,-2147483648),At.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):Io(this,e,t,!0),t+4},At.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||Me(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),At.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255):Io(this,e,t,!1),t+4};function bo(e,t,n,i){if(n+i>e.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}At.prototype.writeFloatLE=function(e,t,n){return n||bo(this,e,t,4),Ao(this,e,t,!0,23,4),t+4},At.prototype.writeFloatBE=function(e,t,n){return n||bo(this,e,t,4),Ao(this,e,t,!1,23,4),t+4},At.prototype.writeDoubleLE=function(e,t,n){return n||bo(this,e,t,8),Ao(this,e,t,!0,52,8),t+8},At.prototype.writeDoubleBE=function(e,t,n){return n||bo(this,e,t,8),Ao(this,e,t,!1,52,8),t+8},At.prototype.copy=function(e,t,n,i){if(n||(n=0),i||i===0||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),0<i&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>i)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var o=i-n;if(this===e&&n<t&&t<i)for(i=o-1;0<=i;--i)e[i+t]=this[i+n];else if(1e3>o||!At.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},At.prototype.fill=function(e,t,n,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),e.length===1){var o=e.charCodeAt(0);256>o&&(e=o)}if(i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!At.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else typeof e=="number"&&(e&=255);if(0>t||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=n===void 0?this.length:n>>>0,e||(e=0),typeof e=="number")for(i=t;i<n;++i)this[i]=e;else for(e=rn(e)?e:Eo(new At(e,i).toString()),o=e.length,i=0;i<n-t;++i)this[i+t]=e[i%o];return this};var Ff=/[^+\/0-9A-Za-z-_]/g;function Eo(e,t){t=t||1/0;for(var n,i=e.length,o=null,a=[],c=0;c<i;++c){if(n=e.charCodeAt(c),55295<n&&57344>n){if(!o){if(56319<n){-1<(t-=3)&&a.push(239,191,189);continue}else if(c+1===i){-1<(t-=3)&&a.push(239,191,189);continue}o=n;continue}if(56320>n){-1<(t-=3)&&a.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&-1<(t-=3)&&a.push(239,191,189);if(o=null,128>n){if(0>--t)break;a.push(n)}else if(2048>n){if(0>(t-=2))break;a.push(n>>6|192,n&63|128)}else if(65536>n){if(0>(t-=3))break;a.push(n>>12|224,n>>6&63|128,n&63|128)}else if(1114112>n){if(0>(t-=4))break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw Error("Invalid code point")}return a}function ks(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n)&255);return t}function Qs(e){if(e=(e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(Ff,""),2>e.length)e="";else for(;e.length%4!=0;)e+="=";ha||Ts();var t=e.length;if(0<t%4)throw Error("Invalid string. Length must be a multiple of 4");var n=e[t-2]==="="?2:e[t-1]==="="?1:0,i=new wf(3*t/4-n),o=0<n?t-4:t,a=0;for(t=0;t<o;t+=4){var c=Ke[e.charCodeAt(t)]<<18|Ke[e.charCodeAt(t+1)]<<12|Ke[e.charCodeAt(t+2)]<<6|Ke[e.charCodeAt(t+3)];i[a++]=c>>16&255,i[a++]=c>>8&255,i[a++]=c&255}return n===2?(c=Ke[e.charCodeAt(t)]<<2|Ke[e.charCodeAt(t+1)]>>4,i[a++]=c&255):n===1&&(c=Ke[e.charCodeAt(t)]<<10|Ke[e.charCodeAt(t+1)]<<4|Ke[e.charCodeAt(t+2)]>>2,i[a++]=c>>8&255,i[a++]=c&255),i}function Pi(e,t,n,i){for(var o=0;o<i&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function yn(e){return e!=null&&(!!e._isBuffer||Ws(e)||typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&Ws(e.slice(0,0)))}function Ws(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}var Ri=Object.freeze({__proto__:null,INSPECT_MAX_BYTES:50,kMaxLength:Ef,Buffer:At,SlowBuffer:function(e){return+e!=e&&(e=0),At.alloc(+e)},isBuffer:yn}),ee=be(function(e,t){function n(o){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];return new(Ri.Buffer.bind.apply(Ri.Buffer,i([void 0,o],a)))}var i=ce&&ce.__spreadArrays||function(){for(var o=0,a=0,c=arguments.length;a<c;a++)o+=arguments[a].length;o=Array(o);var d=0;for(a=0;a<c;a++)for(var h=arguments[a],u=0,s=h.length;u<s;u++,d++)o[d]=h[u];return o};Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=Ri.Buffer,t.bufferAllocUnsafe=Ri.Buffer.allocUnsafe||n,t.bufferFrom=Ri.Buffer.from||n});Se(ee);function $s(){throw Error("setTimeout has not been defined")}function Hs(){throw Error("clearTimeout has not been defined")}var Bn=$s,xn=Hs;typeof $n.setTimeout=="function"&&(Bn=setTimeout),typeof $n.clearTimeout=="function"&&(xn=clearTimeout);function js(e){if(Bn===setTimeout)return setTimeout(e,0);if((Bn===$s||!Bn)&&setTimeout)return Bn=setTimeout,setTimeout(e,0);try{return Bn(e,0)}catch{try{return Bn.call(null,e,0)}catch{return Bn.call(this,e,0)}}}function Sf(e){if(xn===clearTimeout)return clearTimeout(e);if((xn===Hs||!xn)&&clearTimeout)return xn=clearTimeout,clearTimeout(e);try{return xn(e)}catch{try{return xn.call(null,e)}catch{return xn.call(this,e)}}}var An=[],di=!1,jn,Co=-1;function Bf(){di&&jn&&(di=!1,jn.length?An=jn.concat(An):Co=-1,An.length&&Vs())}function Vs(){if(!di){var e=js(Bf);di=!0;for(var t=An.length;t;){for(jn=An,An=[];++Co<t;)jn&&jn[Co].run();Co=-1,t=An.length}jn=null,di=!1,Sf(e)}}function De(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];An.push(new Ks(e,t)),An.length!==1||di||js(Vs)}function Ks(e,t){this.fun=e,this.array=t}Ks.prototype.run=function(){this.fun.apply(null,this.array)};function Vn(){}var fi=$n.performance||{},xf=fi.now||fi.mozNow||fi.msNow||fi.oNow||fi.webkitNow||function(){return new Date().getTime()},Of=new Date,hi={nextTick:De,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:Vn,addListener:Vn,once:Vn,off:Vn,removeListener:Vn,removeAllListeners:Vn,emit:Vn,binding:function(){throw Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(){throw Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*xf.call(fi),n=Math.floor(t);return t=Math.floor(t%1*1e9),e&&(n-=e[0],t-=e[1],0>t&&(n--,t+=1e9)),[n,t]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Of)/1e3}},On=typeof Object.create=="function"?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){function n(){}e.super_=t,n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},Tf=/%[sdj%]/g;function ma(e){if(!Kn(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(sn(arguments[n]));return t.join(" ")}n=1;var i=arguments,o=i.length;t=String(e).replace(Tf,function(c){if(c==="%%")return"%";if(n>=o)return c;switch(c){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch{return"[Circular]"}default:return c}});for(var a=i[n];n<o;a=i[++n])t=a!==null&&Tn(a)?t+(" "+sn(a)):t+(" "+a);return t}function La(e,t){if(wn($n.process))return function(){return La(e,t).apply(this,arguments)};if(hi.noDeprecation===!0)return e;var n=!1;return function(){if(!n){if(hi.throwDeprecation)throw Error(t);hi.traceDeprecation?console.trace(t):console.error(t),n=!0}return e.apply(this,arguments)}}var vo={},ya;function Ys(e){return wn(ya)&&(ya=hi.env.NODE_DEBUG||""),e=e.toUpperCase(),vo[e]||(new RegExp("\\b"+e+"\\b","i").test(ya)?vo[e]=function(){var t=ma.apply(null,arguments);console.error("%s %d: %s",e,0,t)}:vo[e]=function(){}),vo[e]}function sn(e,t){var n={seen:[],stylize:Rf};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),Ia(t)?n.showHidden=t:t&&Xs(n,t),wn(n.showHidden)&&(n.showHidden=!1),wn(n.depth)&&(n.depth=2),wn(n.colors)&&(n.colors=!1),wn(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Pf),Fo(n,e,n.depth)}sn.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},sn.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Pf(e,t){return(t=sn.styles[t])?"["+sn.colors[t][0]+"m"+e+"["+sn.colors[t][1]+"m":e}function Rf(e){return e}function Uf(e){var t={};return e.forEach(function(n){t[n]=!0}),t}function Fo(e,t,n){if(e.customInspect&&t&&pi(t.inspect)&&t.inspect!==sn&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return Kn(i)||(i=Fo(e,i,n)),i}if(i=Mf(e,t))return i;var o=Object.keys(t),a=Uf(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),Mi(t)&&(0<=o.indexOf("message")||0<=o.indexOf("description")))return Aa(t);if(o.length===0){if(pi(t))return e.stylize("[Function"+(t.name?": "+t.name:"")+"]","special");if(gi(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(Ui(t))return e.stylize(Date.prototype.toString.call(t),"date");if(Mi(t))return Aa(t)}i="";var c=!1,d=["{","}"];return Zs(t)&&(c=!0,d=["[","]"]),pi(t)&&(i=" [Function"+(t.name?": "+t.name:"")+"]"),gi(t)&&(i=" "+RegExp.prototype.toString.call(t)),Ui(t)&&(i=" "+Date.prototype.toUTCString.call(t)),Mi(t)&&(i=" "+Aa(t)),o.length===0&&(!c||t.length==0)?d[0]+i+d[1]:0>n?gi(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),o=c?Gf(e,t,n,a,o):o.map(function(h){return wa(e,t,n,a,h,c)}),e.seen.pop(),Nf(o,i,d))}function Mf(e,t){if(wn(t))return e.stylize("undefined","undefined");if(Kn(t))return t="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",e.stylize(t,"string");if(Js(t))return e.stylize(""+t,"number");if(Ia(t))return e.stylize(""+t,"boolean");if(t===null)return e.stylize("null","null")}function Aa(e){return"["+Error.prototype.toString.call(e)+"]"}function Gf(e,t,n,i,o){for(var a=[],c=0,d=t.length;c<d;++c)Object.prototype.hasOwnProperty.call(t,String(c))?a.push(wa(e,t,n,i,String(c),!0)):a.push("");return o.forEach(function(h){h.match(/^\d+$/)||a.push(wa(e,t,n,i,h,!0))}),a}function wa(e,t,n,i,o,a){var c,d;if(t=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},t.get?d=t.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):t.set&&(d=e.stylize("[Setter]","special")),Object.prototype.hasOwnProperty.call(i,o)||(c="["+o+"]"),d||(0>e.seen.indexOf(t.value)?(d=n===null?Fo(e,t.value,null):Fo(e,t.value,n-1),-1<d.indexOf(`
`)&&(d=a?d.split(`
`).map(function(h){return"  "+h}).join(`
`).substr(2):`
`+d.split(`
`).map(function(h){return"   "+h}).join(`
`))):d=e.stylize("[Circular]","special")),wn(c)){if(a&&o.match(/^\d+$/))return d;c=JSON.stringify(""+o),c.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(c=c.substr(1,c.length-2),c=e.stylize(c,"name")):(c=c.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),c=e.stylize(c,"string"))}return c+": "+d}function Nf(e,t,n){return 60<e.reduce(function(i,o){return o.indexOf(`
`),i+o.replace(/\u001b\[\d\d?m/g,"").length+1},0)?n[0]+(t===""?"":t+`
 `)+" "+e.join(`,
  `)+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function Zs(e){return Array.isArray(e)}function Ia(e){return typeof e=="boolean"}function Js(e){return typeof e=="number"}function Kn(e){return typeof e=="string"}function wn(e){return e===void 0}function gi(e){return Tn(e)&&Object.prototype.toString.call(e)==="[object RegExp]"}function Tn(e){return typeof e=="object"&&e!==null}function Ui(e){return Tn(e)&&Object.prototype.toString.call(e)==="[object Date]"}function Mi(e){return Tn(e)&&(Object.prototype.toString.call(e)==="[object Error]"||e instanceof Error)}function pi(e){return typeof e=="function"}function ba(e){return e===null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||typeof e=="symbol"||typeof e=="undefined"}function Ea(e){return 10>e?"0"+e.toString(10):e.toString(10)}var qf="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");function zf(){var e=new Date,t=[Ea(e.getHours()),Ea(e.getMinutes()),Ea(e.getSeconds())].join(":");return[e.getDate(),qf[e.getMonth()],t].join(" ")}function Xs(e,t){if(!t||!Tn(t))return e;for(var n=Object.keys(t),i=n.length;i--;)e[n[i]]=t[n[i]];return e}var Gi={inherits:On,_extend:Xs,log:function(){console.log("%s - %s",zf(),ma.apply(null,arguments))},isBuffer:function(e){return yn(e)},isPrimitive:ba,isFunction:pi,isError:Mi,isDate:Ui,isObject:Tn,isRegExp:gi,isUndefined:wn,isSymbol:function(e){return typeof e=="symbol"},isString:Kn,isNumber:Js,isNullOrUndefined:function(e){return e==null},isNull:function(e){return e===null},isBoolean:Ia,isArray:Zs,inspect:sn,deprecate:La,format:ma,debuglog:Ys};function tc(e,t){if(e===t)return 0;for(var n=e.length,i=t.length,o=0,a=Math.min(n,i);o<a;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0}var Df=Object.prototype.hasOwnProperty,ec=Object.keys||function(e){var t=[],n;for(n in e)Df.call(e,n)&&t.push(n);return t},nc=Array.prototype.slice,Ca;function ic(){return typeof Ca!="undefined"?Ca:Ca=function(){return function(){}.name==="foo"}()}function oc(e){return yn(e)||typeof $n.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e?!!(e instanceof DataView||e.buffer&&e.buffer instanceof ArrayBuffer):!1}function ae(e,t){e||Ge(e,!0,t,"==",Fa)}var kf=/\s*function\s+([^\(\s]*)\s*/;function ac(e){if(pi(e))return ic()?e.name:(e=e.toString().match(kf))&&e[1]}ae.AssertionError=va;function va(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=rc(sc(this.actual),128)+" "+this.operator+" "+rc(sc(this.expected),128),this.generatedMessage=!0);var t=e.stackStartFunction||Ge;Error.captureStackTrace?Error.captureStackTrace(this,t):(e=Error(),e.stack&&(e=e.stack,t=ac(t),t=e.indexOf(`
`+t),0<=t&&(t=e.indexOf(`
`,t+1),e=e.substring(t+1)),this.stack=e))}On(va,Error);function rc(e,t){return typeof e=="string"?e.length<t?e:e.slice(0,t):e}function sc(e){return ic()||!pi(e)?sn(e):(e=ac(e),"[Function"+(e?": "+e:"")+"]")}function Ge(e,t,n,i,o){throw new va({message:n,actual:e,expected:t,operator:i,stackStartFunction:o})}ae.fail=Ge;function Fa(e,t){e||Ge(e,!0,t,"==",Fa)}ae.ok=Fa,ae.equal=cc;function cc(e,t,n){e!=t&&Ge(e,t,n,"==",cc)}ae.notEqual=lc;function lc(e,t,n){e==t&&Ge(e,t,n,"!=",lc)}ae.deepEqual=uc;function uc(e,t,n){_i(e,t,!1)||Ge(e,t,n,"deepEqual",uc)}ae.deepStrictEqual=dc;function dc(e,t,n){_i(e,t,!0)||Ge(e,t,n,"deepStrictEqual",dc)}function _i(e,t,n,i){if(e===t)return!0;if(yn(e)&&yn(t))return tc(e,t)===0;if(Ui(e)&&Ui(t))return e.getTime()===t.getTime();if(gi(e)&&gi(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(e!==null&&typeof e=="object"||t!==null&&typeof t=="object"){if(!oc(e)||!oc(t)||Object.prototype.toString.call(e)!==Object.prototype.toString.call(t)||e instanceof Float32Array||e instanceof Float64Array){if(yn(e)!==yn(t))return!1;i=i||{actual:[],expected:[]};var o=i.actual.indexOf(e);return o!==-1&&o===i.expected.indexOf(t)?!0:(i.actual.push(e),i.expected.push(t),Qf(e,t,n,i))}return tc(new Uint8Array(e.buffer),new Uint8Array(t.buffer))===0}return n?e===t:e==t}function fc(e){return Object.prototype.toString.call(e)=="[object Arguments]"}function Qf(e,t,n,i){if(e==null||t===null||t===void 0)return!1;if(ba(e)||ba(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var o=fc(e),a=fc(t);if(o&&!a||!o&&a)return!1;if(o)return e=nc.call(e),t=nc.call(t),_i(e,t,n);o=ec(e);var c=ec(t);if(o.length!==c.length)return!1;for(o.sort(),c.sort(),a=o.length-1;0<=a;a--)if(o[a]!==c[a])return!1;for(a=o.length-1;0<=a;a--)if(c=o[a],!_i(e[c],t[c],n,i))return!1;return!0}ae.notDeepEqual=hc;function hc(e,t,n){_i(e,t,!1)&&Ge(e,t,n,"notDeepEqual",hc)}ae.notDeepStrictEqual=gc;function gc(e,t,n){_i(e,t,!0)&&Ge(e,t,n,"notDeepStrictEqual",gc)}ae.strictEqual=pc;function pc(e,t,n){e!==t&&Ge(e,t,n,"===",pc)}ae.notStrictEqual=_c;function _c(e,t,n){e===t&&Ge(e,t,n,"!==",_c)}function mc(e,t){if(!e||!t)return!1;if(Object.prototype.toString.call(t)=="[object RegExp]")return t.test(e);try{if(e instanceof t)return!0}catch{}return Error.isPrototypeOf(t)?!1:t.call({},e)===!0}function Lc(e,t,n,i){if(typeof t!="function")throw new TypeError('"block" argument must be a function');typeof n=="string"&&(i=n,n=null);try{t()}catch(d){var o=d}t=o,i=(n&&n.name?" ("+n.name+").":".")+(i?" "+i:"."),e&&!t&&Ge(t,n,"Missing expected exception"+i),o=typeof i=="string";var a=!e&&Mi(t),c=!e&&t&&!n;if((a&&o&&mc(t,n)||c)&&Ge(t,n,"Got unwanted exception"+i),e&&t&&n&&!mc(t,n)||!e&&t)throw t}ae.throws=Wf;function Wf(e,t,n){Lc(!0,e,t,n)}ae.doesNotThrow=$f;function $f(e,t,n){Lc(!1,e,t,n)}ae.ifError=Hf;function Hf(e){if(e)throw e}var Ni=be(function(e,t){function n(u){return function(s){function _(L){for(var g=[],F=1;F<arguments.length;F++)g[F-1]=arguments[F];return g=s.call(this,i(L,g))||this,g.code=L,g[d]=L,g.name=s.prototype.name+" ["+g[d]+"]",g}return c(_,s),_}(u)}function i(u,s){ae.strictEqual(typeof u,"string");var _=h[u];if(ae(_,"An invalid error message key was used: "+u+"."),typeof _=="function")u=_;else{if(u=Gi.format,s===void 0||s.length===0)return _;s.unshift(_)}return String(u.apply(null,s))}function o(u,s){h[u]=typeof s=="function"?s:String(s)}function a(u,s){if(ae(u,"expected is required"),ae(typeof s=="string","thing is required"),Array.isArray(u)){var _=u.length;return ae(0<_,"At least one expected value needs to be specified"),u=u.map(function(L){return String(L)}),2<_?"one of "+s+" "+u.slice(0,_-1).join(", ")+", or "+u[_-1]:_===2?"one of "+s+" "+u[0]+" or "+u[1]:"of "+s+" "+u[0]}return"of "+s+" "+String(u)}var c=ce&&ce.__extends||function(){function u(s,_){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,g){L.__proto__=g}||function(L,g){for(var F in g)g.hasOwnProperty(F)&&(L[F]=g[F])},u(s,_)}return function(s,_){function L(){this.constructor=s}u(s,_),s.prototype=_===null?Object.create(_):(L.prototype=_.prototype,new L)}}();Object.defineProperty(t,"__esModule",{value:!0});var d=typeof Symbol=="undefined"?"_kCode":Symbol("code"),h={};e=function(u){function s(_){if(typeof _!="object"||_===null)throw new t.TypeError("ERR_INVALID_ARG_TYPE","options","object");var L=_.message?u.call(this,_.message)||this:u.call(this,Gi.inspect(_.actual).slice(0,128)+" "+(_.operator+" "+Gi.inspect(_.expected).slice(0,128)))||this;return L.generatedMessage=!_.message,L.name="AssertionError [ERR_ASSERTION]",L.code="ERR_ASSERTION",L.actual=_.actual,L.expected=_.expected,L.operator=_.operator,t.Error.captureStackTrace(L,_.stackStartFunction),L}return c(s,u),s}(ce.Error),t.AssertionError=e,t.message=i,t.E=o,t.Error=n(ce.Error),t.TypeError=n(ce.TypeError),t.RangeError=n(ce.RangeError),o("ERR_ARG_NOT_ITERABLE","%s must be iterable"),o("ERR_ASSERTION","%s"),o("ERR_BUFFER_OUT_OF_BOUNDS",function(u,s){return s?"Attempt to write outside buffer bounds":'"'+u+'" is outside of buffer bounds'}),o("ERR_CHILD_CLOSED_BEFORE_REPLY","Child closed before reply received"),o("ERR_CONSOLE_WRITABLE_STREAM","Console expects a writable stream instance for %s"),o("ERR_CPU_USAGE","Unable to obtain cpu usage %s"),o("ERR_DNS_SET_SERVERS_FAILED",function(u,s){return'c-ares failed to set servers: "'+u+'" ['+s+"]"}),o("ERR_FALSY_VALUE_REJECTION","Promise was rejected with falsy value"),o("ERR_ENCODING_NOT_SUPPORTED",function(u){return'The "'+u+'" encoding is not supported'}),o("ERR_ENCODING_INVALID_ENCODED_DATA",function(u){return"The encoded data was not valid for encoding "+u}),o("ERR_HTTP_HEADERS_SENT","Cannot render headers after they are sent to the client"),o("ERR_HTTP_INVALID_STATUS_CODE","Invalid status code: %s"),o("ERR_HTTP_TRAILER_INVALID","Trailers are invalid with this transfer encoding"),o("ERR_INDEX_OUT_OF_RANGE","Index out of range"),o("ERR_INVALID_ARG_TYPE",function(u,s,_){if(ae(u,"name is required"),s.includes("not ")){var L="must not be";s=s.split("not ")[1]}else L="must be";if(Array.isArray(u))L="The "+u.map(function(F){return'"'+F+'"'}).join(", ")+" arguments "+L+" "+a(s,"type");else if(u.includes(" argument"))L="The "+u+" "+L+" "+a(s,"type");else{var g=u.includes(".")?"property":"argument";L='The "'+u+'" '+g+" "+L+" "+a(s,"type")}return 3<=arguments.length&&(L+=". Received type "+(_!==null?typeof _:"null")),L}),o("ERR_INVALID_ARRAY_LENGTH",function(u,s,_){return ae.strictEqual(typeof _,"number"),'The array "'+u+'" (length '+_+") must be of length "+s+"."}),o("ERR_INVALID_BUFFER_SIZE","Buffer size must be a multiple of %s"),o("ERR_INVALID_CALLBACK","Callback must be a function"),o("ERR_INVALID_CHAR","Invalid character in %s"),o("ERR_INVALID_CURSOR_POS","Cannot set cursor row without setting its column"),o("ERR_INVALID_FD",'"fd" must be a positive integer: %s'),o("ERR_INVALID_FILE_URL_HOST",'File URL host must be "localhost" or empty on %s'),o("ERR_INVALID_FILE_URL_PATH","File URL path %s"),o("ERR_INVALID_HANDLE_TYPE","This handle type cannot be sent"),o("ERR_INVALID_IP_ADDRESS","Invalid IP address: %s"),o("ERR_INVALID_OPT_VALUE",function(u,s){return'The value "'+String(s)+'" is invalid for option "'+u+'"'}),o("ERR_INVALID_OPT_VALUE_ENCODING",function(u){return'The value "'+String(u)+'" is invalid for option "encoding"'}),o("ERR_INVALID_REPL_EVAL_CONFIG",'Cannot specify both "breakEvalOnSigint" and "eval" for REPL'),o("ERR_INVALID_SYNC_FORK_INPUT","Asynchronous forks do not support Buffer, Uint8Array or string input: %s"),o("ERR_INVALID_THIS",'Value of "this" must be of type %s'),o("ERR_INVALID_TUPLE","%s must be an iterable %s tuple"),o("ERR_INVALID_URL","Invalid URL: %s"),o("ERR_INVALID_URL_SCHEME",function(u){return"The URL must be "+a(u,"scheme")}),o("ERR_IPC_CHANNEL_CLOSED","Channel closed"),o("ERR_IPC_DISCONNECTED","IPC channel is already disconnected"),o("ERR_IPC_ONE_PIPE","Child process can have only one IPC pipe"),o("ERR_IPC_SYNC_FORK","IPC cannot be used with synchronous forks"),o("ERR_MISSING_ARGS",function(){for(var u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];ae(0<u.length,"At least one arg needs to be specified"),s="The ";var _=u.length;switch(u=u.map(function(L){return'"'+L+'"'}),_){case 1:s+=u[0]+" argument";break;case 2:s+=u[0]+" and "+u[1]+" arguments";break;default:s+=u.slice(0,_-1).join(", "),s+=", and "+u[_-1]+" arguments"}return s+" must be specified"}),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_NAPI_CONS_FUNCTION","Constructor must be a function"),o("ERR_NAPI_CONS_PROTOTYPE_OBJECT","Constructor.prototype must be an object"),o("ERR_NO_CRYPTO","Node.js is not compiled with OpenSSL crypto support"),o("ERR_NO_LONGER_SUPPORTED","%s is no longer supported"),o("ERR_PARSE_HISTORY_DATA","Could not parse history data in %s"),o("ERR_SOCKET_ALREADY_BOUND","Socket is already bound"),o("ERR_SOCKET_BAD_PORT","Port should be > 0 and < 65536"),o("ERR_SOCKET_BAD_TYPE","Bad socket type specified. Valid types are: udp4, udp6"),o("ERR_SOCKET_CANNOT_SEND","Unable to send data"),o("ERR_SOCKET_CLOSED","Socket is closed"),o("ERR_SOCKET_DGRAM_NOT_RUNNING","Not running"),o("ERR_STDERR_CLOSE","process.stderr cannot be closed"),o("ERR_STDOUT_CLOSE","process.stdout cannot be closed"),o("ERR_STREAM_WRAP","Stream has StringDecoder set or is in objectMode"),o("ERR_TLS_CERT_ALTNAME_INVALID","Hostname/IP does not match certificate's altnames: %s"),o("ERR_TLS_DH_PARAM_SIZE",function(u){return"DH parameter size "+u+" is less than 2048"}),o("ERR_TLS_HANDSHAKE_TIMEOUT","TLS handshake timeout"),o("ERR_TLS_RENEGOTIATION_FAILED","Failed to renegotiate"),o("ERR_TLS_REQUIRED_SERVER_NAME",'"servername" is required parameter for Server.addContext'),o("ERR_TLS_SESSION_ATTACK","TSL session renegotiation attack detected"),o("ERR_TRANSFORM_ALREADY_TRANSFORMING","Calling transform done when still transforming"),o("ERR_TRANSFORM_WITH_LENGTH_0","Calling transform done when writableState.length != 0"),o("ERR_UNKNOWN_ENCODING","Unknown encoding: %s"),o("ERR_UNKNOWN_SIGNAL","Unknown signal: %s"),o("ERR_UNKNOWN_STDIN_TYPE","Unknown stdin file type"),o("ERR_UNKNOWN_STREAM_TYPE","Unknown stream file type"),o("ERR_V8BREAKITERATOR","Full ICU data not installed. See https://github.com/nodejs/node/wiki/Intl")});Se(Ni);var Ye=be(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ENCODING_UTF8="utf8",t.assertEncoding=function(n){if(n&&!ee.Buffer.isEncoding(n))throw new Ni.TypeError("ERR_INVALID_OPT_VALUE_ENCODING",n)},t.strToEncoding=function(n,i){return i&&i!==t.ENCODING_UTF8?i==="buffer"?new ee.Buffer(n):new ee.Buffer(n).toString(i):n}});Se(Ye);var Sa=be(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=jt.constants.S_IFMT,i=jt.constants.S_IFDIR,o=jt.constants.S_IFREG,a=jt.constants.S_IFBLK,c=jt.constants.S_IFCHR,d=jt.constants.S_IFLNK,h=jt.constants.S_IFIFO,u=jt.constants.S_IFSOCK;e=function(){function s(){this.name="",this.mode=0}return s.build=function(_,L){var g=new s,F=_.getNode().mode;return g.name=Ye.strToEncoding(_.getName(),L),g.mode=F,g},s.prototype._checkModeProperty=function(_){return(this.mode&n)===_},s.prototype.isDirectory=function(){return this._checkModeProperty(i)},s.prototype.isFile=function(){return this._checkModeProperty(o)},s.prototype.isBlockDevice=function(){return this._checkModeProperty(a)},s.prototype.isCharacterDevice=function(){return this._checkModeProperty(c)},s.prototype.isSymbolicLink=function(){return this._checkModeProperty(d)},s.prototype.isFIFO=function(){return this._checkModeProperty(h)},s.prototype.isSocket=function(){return this._checkModeProperty(u)},s}(),t.Dirent=e,t.default=e});Se(Sa);function yc(e,t){for(var n=0,i=e.length-1;0<=i;i--){var o=e[i];o==="."?e.splice(i,1):o===".."?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var Ba=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function xa(){for(var e="",t=!1,n=arguments.length-1;-1<=n&&!t;n--){var i=0<=n?arguments[n]:"/";if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,t=i.charAt(0)==="/")}return e=yc(Pa(e.split("/"),function(o){return!!o}),!t).join("/"),(t?"/":"")+e||"."}function Ac(e){var t=wc(e),n=jf(e,-1)==="/";return(e=yc(Pa(e.split("/"),function(i){return!!i}),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e}function wc(e){return e.charAt(0)==="/"}function Oa(e,t){function n(c){for(var d=0;d<c.length&&c[d]==="";d++);for(var h=c.length-1;0<=h&&c[h]==="";h--);return d>h?[]:c.slice(d,h-d+1)}e=xa(e).substr(1),t=xa(t).substr(1),e=n(e.split("/")),t=n(t.split("/"));for(var i=Math.min(e.length,t.length),o=i,a=0;a<i;a++)if(e[a]!==t[a]){o=a;break}for(i=[],a=o;a<e.length;a++)i.push("..");return i=i.concat(t.slice(o)),i.join("/")}var Ta={extname:function(e){return Ba.exec(e).slice(1)[3]},basename:function(e,t){return e=Ba.exec(e).slice(1)[2],t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},dirname:function(e){var t=Ba.exec(e).slice(1);return e=t[0],t=t[1],!e&&!t?".":(t&&(t=t.substr(0,t.length-1)),e+t)},sep:"/",delimiter:":",relative:Oa,join:function(){var e=Array.prototype.slice.call(arguments,0);return Ac(Pa(e,function(t){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},isAbsolute:wc,normalize:Ac,resolve:xa};function Pa(e,t){if(e.filter)return e.filter(t);for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}var jf="ab".substr(-1)==="b"?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return 0>t&&(t=e.length+t),e.substr(t,n)},mi=be(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),e=typeof setImmediate=="function"?setImmediate.bind(ce):setTimeout.bind(ce),t.default=e});Se(mi);var Be=be(function(e,t){function n(){var i=hi||{};return i.getuid||(i.getuid=function(){return 0}),i.getgid||(i.getgid=function(){return 0}),i.cwd||(i.cwd=function(){return"/"}),i.nextTick||(i.nextTick=mi.default),i.emitWarning||(i.emitWarning=function(o,a){console.warn(""+a+(a?": ":"")+o)}),i.env||(i.env={}),i}Object.defineProperty(t,"__esModule",{value:!0}),t.createProcess=n,t.default=n()});Se(Be);function Pn(){}Pn.prototype=Object.create(null);function Vt(){Vt.init.call(this)}Vt.EventEmitter=Vt,Vt.usingDomains=!1,Vt.prototype.domain=void 0,Vt.prototype._events=void 0,Vt.prototype._maxListeners=void 0,Vt.defaultMaxListeners=10,Vt.init=function(){this.domain=null,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Pn,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Vt.prototype.setMaxListeners=function(e){if(typeof e!="number"||0>e||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Vt.prototype.getMaxListeners=function(){return this._maxListeners===void 0?Vt.defaultMaxListeners:this._maxListeners},Vt.prototype.emit=function(e){var t,n,i=e==="error";if(t=this._events)i=i&&t.error==null;else if(!i)return!1;var o=this.domain;if(i){if(t=arguments[1],o)t||(t=Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=o,t.domainThrown=!1,o.emit("error",t);else throw t instanceof Error?t:(o=Error('Uncaught, unspecified "error" event. ('+t+")"),o.context=t,o);return!1}if(o=t[e],!o)return!1;t=typeof o=="function";var a=arguments.length;switch(a){case 1:if(t)o.call(this);else for(t=o.length,o=qi(o,t),i=0;i<t;++i)o[i].call(this);break;case 2:if(i=arguments[1],t)o.call(this,i);else for(t=o.length,o=qi(o,t),a=0;a<t;++a)o[a].call(this,i);break;case 3:if(i=arguments[1],a=arguments[2],t)o.call(this,i,a);else for(t=o.length,o=qi(o,t),n=0;n<t;++n)o[n].call(this,i,a);break;case 4:if(i=arguments[1],a=arguments[2],n=arguments[3],t)o.call(this,i,a,n);else{t=o.length,o=qi(o,t);for(var c=0;c<t;++c)o[c].call(this,i,a,n)}break;default:for(i=Array(a-1),n=1;n<a;n++)i[n-1]=arguments[n];if(t)o.apply(this,i);else for(t=o.length,o=qi(o,t),a=0;a<t;++a)o[a].apply(this,i)}return!0};function Ic(e,t,n,i){var o;if(typeof n!="function")throw new TypeError('"listener" argument must be a function');if(o=e._events){o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events);var a=o[t]}else o=e._events=new Pn,e._eventsCount=0;return a?(typeof a=="function"?a=o[t]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),a.warned||(n=e._maxListeners===void 0?Vt.defaultMaxListeners:e._maxListeners)&&0<n&&a.length>n&&(a.warned=!0,n=Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit"),n.name="MaxListenersExceededWarning",n.emitter=e,n.type=t,n.count=a.length,typeof console.warn=="function"?console.warn(n):console.log(n))):(o[t]=n,++e._eventsCount),e}Vt.prototype.addListener=function(e,t){return Ic(this,e,t,!1)},Vt.prototype.on=Vt.prototype.addListener,Vt.prototype.prependListener=function(e,t){return Ic(this,e,t,!0)};function bc(e,t,n){function i(){e.removeListener(t,i),o||(o=!0,n.apply(e,arguments))}var o=!1;return i.listener=n,i}Vt.prototype.once=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.on(e,bc(this,e,t)),this},Vt.prototype.prependOnceListener=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(e,bc(this,e,t)),this},Vt.prototype.removeListener=function(e,t){var n;if(typeof t!="function")throw new TypeError('"listener" argument must be a function');var i=this._events;if(!i)return this;var o=i[e];if(!o)return this;if(o===t||o.listener&&o.listener===t)--this._eventsCount==0?this._events=new Pn:(delete i[e],i.removeListener&&this.emit("removeListener",e,o.listener||t));else if(typeof o!="function"){var a=-1;for(n=o.length;0<n--;)if(o[n]===t||o[n].listener&&o[n].listener===t){var c=o[n].listener;a=n;break}if(0>a)return this;if(o.length===1){if(o[0]=void 0,--this._eventsCount==0)return this._events=new Pn,this;delete i[e]}else{n=a+1;for(var d=o.length;n<d;a+=1,n+=1)o[a]=o[n];o.pop()}i.removeListener&&this.emit("removeListener",e,c||t)}return this},Vt.prototype.removeAllListeners=function(e){var t=this._events;if(!t)return this;if(!t.removeListener)return arguments.length===0?(this._events=new Pn,this._eventsCount=0):t[e]&&(--this._eventsCount==0?this._events=new Pn:delete t[e]),this;if(arguments.length===0){t=Object.keys(t);for(var n=0,i;n<t.length;++n)i=t[n],i!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new Pn,this._eventsCount=0,this}if(t=t[e],typeof t=="function")this.removeListener(e,t);else if(t)do this.removeListener(e,t[t.length-1]);while(t[0]);return this},Vt.prototype.listeners=function(e){var t=this._events;if(t)if(e=t[e])if(typeof e=="function")e=[e.listener||e];else{t=Array(e.length);for(var n=0;n<t.length;++n)t[n]=e[n].listener||e[n];e=t}else e=[];else e=[];return e},Vt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Ec.call(e,t)},Vt.prototype.listenerCount=Ec;function Ec(e){var t=this._events;if(t){if(e=t[e],typeof e=="function")return 1;if(e)return e.length}return 0}Vt.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};function qi(e,t){for(var n=Array(t);t--;)n[t]=e[t];return n}var zi=be(function(e,t){var n=ce&&ce.__extends||function(){function h(u,s){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,L){_.__proto__=L}||function(_,L){for(var g in L)L.hasOwnProperty(g)&&(_[g]=L[g])},h(u,s)}return function(u,s){function _(){this.constructor=u}h(u,s),u.prototype=s===null?Object.create(s):(_.prototype=s.prototype,new _)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=jt.constants.S_IFMT,o=jt.constants.S_IFDIR,a=jt.constants.S_IFREG,c=jt.constants.S_IFLNK,d=jt.constants.O_APPEND;t.SEP="/",e=function(h){function u(s,_){_===void 0&&(_=438);var L=h.call(this)||this;return L.uid=Be.default.getuid(),L.gid=Be.default.getgid(),L.atime=new Date,L.mtime=new Date,L.ctime=new Date,L.perm=438,L.mode=a,L.nlink=1,L.perm=_,L.mode|=_,L.ino=s,L}return n(u,h),u.prototype.getString=function(s){return s===void 0&&(s="utf8"),this.getBuffer().toString(s)},u.prototype.setString=function(s){this.buf=ee.bufferFrom(s,"utf8"),this.touch()},u.prototype.getBuffer=function(){return this.buf||this.setBuffer(ee.bufferAllocUnsafe(0)),ee.bufferFrom(this.buf)},u.prototype.setBuffer=function(s){this.buf=ee.bufferFrom(s),this.touch()},u.prototype.getSize=function(){return this.buf?this.buf.length:0},u.prototype.setModeProperty=function(s){this.mode=this.mode&~i|s},u.prototype.setIsFile=function(){this.setModeProperty(a)},u.prototype.setIsDirectory=function(){this.setModeProperty(o)},u.prototype.setIsSymlink=function(){this.setModeProperty(c)},u.prototype.isFile=function(){return(this.mode&i)===a},u.prototype.isDirectory=function(){return(this.mode&i)===o},u.prototype.isSymlink=function(){return(this.mode&i)===c},u.prototype.makeSymlink=function(s){this.symlink=s,this.setIsSymlink()},u.prototype.write=function(s,_,L,g){if(_===void 0&&(_=0),L===void 0&&(L=s.length),g===void 0&&(g=0),this.buf||(this.buf=ee.bufferAllocUnsafe(0)),g+L>this.buf.length){var F=ee.bufferAllocUnsafe(g+L);this.buf.copy(F,0,0,this.buf.length),this.buf=F}return s.copy(this.buf,g,_,_+L),this.touch(),L},u.prototype.read=function(s,_,L,g){return _===void 0&&(_=0),L===void 0&&(L=s.byteLength),g===void 0&&(g=0),this.buf||(this.buf=ee.bufferAllocUnsafe(0)),L>s.byteLength&&(L=s.byteLength),L+g>this.buf.length&&(L=this.buf.length-g),this.buf.copy(s,_,g,g+L),L},u.prototype.truncate=function(s){if(s===void 0&&(s=0),s)if(this.buf||(this.buf=ee.bufferAllocUnsafe(0)),s<=this.buf.length)this.buf=this.buf.slice(0,s);else{var _=ee.bufferAllocUnsafe(0);this.buf.copy(_),_.fill(0,s)}else this.buf=ee.bufferAllocUnsafe(0);this.touch()},u.prototype.chmod=function(s){this.perm=s,this.mode=this.mode&-512|s,this.touch()},u.prototype.chown=function(s,_){this.uid=s,this.gid=_,this.touch()},u.prototype.touch=function(){this.mtime=new Date,this.emit("change",this)},u.prototype.canRead=function(s,_){return s===void 0&&(s=Be.default.getuid()),_===void 0&&(_=Be.default.getgid()),!!(this.perm&4||_===this.gid&&this.perm&32||s===this.uid&&this.perm&256)},u.prototype.canWrite=function(s,_){return s===void 0&&(s=Be.default.getuid()),_===void 0&&(_=Be.default.getgid()),!!(this.perm&2||_===this.gid&&this.perm&16||s===this.uid&&this.perm&128)},u.prototype.del=function(){this.emit("delete",this)},u.prototype.toJSON=function(){return{ino:this.ino,uid:this.uid,gid:this.gid,atime:this.atime.getTime(),mtime:this.mtime.getTime(),ctime:this.ctime.getTime(),perm:this.perm,mode:this.mode,nlink:this.nlink,symlink:this.symlink,data:this.getString()}},u}(Vt.EventEmitter),t.Node=e,e=function(h){function u(s,_,L){var g=h.call(this)||this;return g.children={},g.steps=[],g.ino=0,g.length=0,g.vol=s,g.parent=_,g.steps=_?_.steps.concat([L]):[L],g}return n(u,h),u.prototype.setNode=function(s){this.node=s,this.ino=s.ino},u.prototype.getNode=function(){return this.node},u.prototype.createChild=function(s,_){_===void 0&&(_=this.vol.createNode());var L=new u(this.vol,this,s);return L.setNode(_),_.isDirectory(),this.setChild(s,L),L},u.prototype.setChild=function(s,_){return _===void 0&&(_=new u(this.vol,this,s)),this.children[s]=_,_.parent=this,this.length++,this.emit("child:add",_,this),_},u.prototype.deleteChild=function(s){delete this.children[s.getName()],this.length--,this.emit("child:delete",s,this)},u.prototype.getChild=function(s){if(Object.hasOwnProperty.call(this.children,s))return this.children[s]},u.prototype.getPath=function(){return this.steps.join(t.SEP)},u.prototype.getName=function(){return this.steps[this.steps.length-1]},u.prototype.walk=function(s,_,L){if(_===void 0&&(_=s.length),L===void 0&&(L=0),L>=s.length||L>=_)return this;var g=this.getChild(s[L]);return g?g.walk(s,_,L+1):null},u.prototype.toJSON=function(){return{steps:this.steps,ino:this.ino,children:Object.keys(this.children)}},u}(Vt.EventEmitter),t.Link=e,e=function(){function h(u,s,_,L){this.position=0,this.link=u,this.node=s,this.flags=_,this.fd=L}return h.prototype.getString=function(){return this.node.getString()},h.prototype.setString=function(u){this.node.setString(u)},h.prototype.getBuffer=function(){return this.node.getBuffer()},h.prototype.setBuffer=function(u){this.node.setBuffer(u)},h.prototype.getSize=function(){return this.node.getSize()},h.prototype.truncate=function(u){this.node.truncate(u)},h.prototype.seekTo=function(u){this.position=u},h.prototype.stats=function(){return ui.default.build(this.node)},h.prototype.write=function(u,s,_,L){return s===void 0&&(s=0),_===void 0&&(_=u.length),typeof L!="number"&&(L=this.position),this.flags&d&&(L=this.getSize()),u=this.node.write(u,s,_,L),this.position=L+u,u},h.prototype.read=function(u,s,_,L){return s===void 0&&(s=0),_===void 0&&(_=u.byteLength),typeof L!="number"&&(L=this.position),u=this.node.read(u,s,_,L),this.position=L+u,u},h.prototype.chmod=function(u){this.node.chmod(u)},h.prototype.chown=function(u,s){this.node.chown(u,s)},h}(),t.File=e});Se(zi);var Vf=zi.Node,Cc=be(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(n,i,o){var a=setTimeout.apply(null,arguments);return a&&typeof a=="object"&&typeof a.unref=="function"&&a.unref(),a}});Se(Cc);function Yn(){this.tail=this.head=null,this.length=0}Yn.prototype.push=function(e){e={data:e,next:null},0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length},Yn.prototype.unshift=function(e){e={data:e,next:this.head},this.length===0&&(this.tail=e),this.head=e,++this.length},Yn.prototype.shift=function(){if(this.length!==0){var e=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,e}},Yn.prototype.clear=function(){this.head=this.tail=null,this.length=0},Yn.prototype.join=function(e){if(this.length===0)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},Yn.prototype.concat=function(e){if(this.length===0)return At.alloc(0);if(this.length===1)return this.head.data;e=At.allocUnsafe(e>>>0);for(var t=this.head,n=0;t;)t.data.copy(e,n),n+=t.data.length,t=t.next;return e};var Kf=At.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Di(e){if(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),e&&!Kf(e))throw Error("Unknown encoding: "+e);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Zf;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Jf;break;default:this.write=Yf;return}this.charBuffer=new At(6),this.charLength=this.charReceived=0}Di.prototype.write=function(e){for(var t="";this.charLength;){if(t=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length,e.copy(this.charBuffer,this.charReceived,0,t),this.charReceived+=t,this.charReceived<this.charLength)return"";e=e.slice(t,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var n=t.charCodeAt(t.length-1);if(55296<=n&&56319>=n)this.charLength+=this.surrogateSize,t="";else{if(this.charReceived=this.charLength=0,e.length===0)return t;break}}this.detectIncompleteChar(e);var i=e.length;return this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i),i=t.length-1,n=t.charCodeAt(i),55296<=n&&56319>=n?(n=this.surrogateSize,this.charLength+=n,this.charReceived+=n,this.charBuffer.copy(this.charBuffer,n,0,n),e.copy(this.charBuffer,0,0,n),t.substring(0,i)):t},Di.prototype.detectIncompleteChar=function(e){for(var t=3<=e.length?3:e.length;0<t;t--){var n=e[e.length-t];if(t==1&&n>>5==6){this.charLength=2;break}if(2>=t&&n>>4==14){this.charLength=3;break}if(3>=t&&n>>3==30){this.charLength=4;break}}this.charReceived=t},Di.prototype.end=function(e){var t="";return e&&e.length&&(t=this.write(e)),this.charReceived&&(e=this.encoding,t+=this.charBuffer.slice(0,this.charReceived).toString(e)),t};function Yf(e){return e.toString(this.encoding)}function Zf(e){this.charLength=(this.charReceived=e.length%2)?2:0}function Jf(e){this.charLength=(this.charReceived=e.length%3)?3:0}re.ReadableState=vc;var Xt=Ys("stream");On(re,Vt);function Xf(e,t,n){if(typeof e.prependListener=="function")return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}function vc(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Ze&&(this.objectMode=this.objectMode||!!e.readableObjectMode),t=e.highWaterMark;var n=this.objectMode?16:16384;this.highWaterMark=t||t===0?t:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new Yn,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.reading=this.endEmitted=this.ended=!1,this.sync=!0,this.resumeScheduled=this.readableListening=this.emittedReadable=this.needReadable=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.encoding=this.decoder=null,e.encoding&&(this.decoder=new Di(e.encoding),this.encoding=e.encoding)}function re(e){if(!(this instanceof re))return new re(e);this._readableState=new vc(e,this),this.readable=!0,e&&typeof e.read=="function"&&(this._read=e.read),Vt.call(this)}re.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||typeof e!="string"||(t=t||n.defaultEncoding,t!==n.encoding&&(e=At.from(e,t),t="")),Fc(this,n,e,t,!1)},re.prototype.unshift=function(e){return Fc(this,this._readableState,e,"",!0)},re.prototype.isPaused=function(){return this._readableState.flowing===!1};function Fc(e,t,n,i,o){var a=n,c=null;if(yn(a)||typeof a=="string"||a===null||a===void 0||t.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),a=c)e.emit("error",a);else if(n===null)t.reading=!1,t.ended||(t.decoder&&(n=t.decoder.end())&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length),t.ended=!0,So(e));else if(t.objectMode||n&&0<n.length)if(t.ended&&!o)e.emit("error",Error("stream.push() after EOF"));else if(t.endEmitted&&o)e.emit("error",Error("stream.unshift() after end event"));else{if(t.decoder&&!o&&!i){n=t.decoder.write(n);var d=!t.objectMode&&n.length===0}o||(t.reading=!1),d||(t.flowing&&t.length===0&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,o?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&So(e))),t.readingMore||(t.readingMore=!0,De(th,e,t))}else o||(t.reading=!1);return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}re.prototype.setEncoding=function(e){return this._readableState.decoder=new Di(e),this._readableState.encoding=e,this};function Sc(e,t){if(0>=e||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(e!==e)return t.flowing&&t.length?t.buffer.head.data.length:t.length;if(e>t.highWaterMark){var n=e;8388608<=n?n=8388608:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),t.highWaterMark=n}return e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0)}re.prototype.read=function(e){Xt("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(e!==0&&(t.emittedReadable=!1),e===0&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return Xt("read: emitReadable",t.length,t.ended),t.length===0&&t.ended?Ua(this):So(this),null;if(e=Sc(e,t),e===0&&t.ended)return t.length===0&&Ua(this),null;var i=t.needReadable;return Xt("need readable",i),(t.length===0||t.length-e<t.highWaterMark)&&(i=!0,Xt("length less than watermark",i)),t.ended||t.reading?Xt("reading or ended",!1):i&&(Xt("do read"),t.reading=!0,t.sync=!0,t.length===0&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=Sc(n,t))),i=0<e?xc(e,t):null,i===null?(t.needReadable=!0,e=0):t.length-=e,t.length===0&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&Ua(this)),i!==null&&this.emit("data",i),i};function So(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(Xt("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?De(Bc,e):Bc(e))}function Bc(e){Xt("emit readable"),e.emit("readable"),Ra(e)}function th(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(Xt("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}re.prototype._read=function(){this.emit("error",Error("not implemented"))},re.prototype.pipe=function(e,t){function n(T){Xt("onunpipe"),T===s&&o()}function i(){Xt("onend"),e.end()}function o(){Xt("cleanup"),e.removeListener("close",d),e.removeListener("finish",h),e.removeListener("drain",L),e.removeListener("error",c),e.removeListener("unpipe",n),s.removeListener("end",i),s.removeListener("end",o),s.removeListener("data",a),g=!0,!_.awaitDrain||e._writableState&&!e._writableState.needDrain||L()}function a(T){Xt("ondata"),F=!1,e.write(T)!==!1||F||((_.pipesCount===1&&_.pipes===e||1<_.pipesCount&&Oc(_.pipes,e)!==-1)&&!g&&(Xt("false write response, pause",s._readableState.awaitDrain),s._readableState.awaitDrain++,F=!0),s.pause())}function c(T){Xt("onerror",T),u(),e.removeListener("error",c),e.listeners("error").length===0&&e.emit("error",T)}function d(){e.removeListener("finish",h),u()}function h(){Xt("onfinish"),e.removeListener("close",d),u()}function u(){Xt("unpipe"),s.unpipe(e)}var s=this,_=this._readableState;switch(_.pipesCount){case 0:_.pipes=e;break;case 1:_.pipes=[_.pipes,e];break;default:_.pipes.push(e)}_.pipesCount+=1,Xt("pipe count=%d opts=%j",_.pipesCount,t),t=t&&t.end===!1?o:i,_.endEmitted?De(t):s.once("end",t),e.on("unpipe",n);var L=eh(s);e.on("drain",L);var g=!1,F=!1;return s.on("data",a),Xf(e,"error",c),e.once("close",d),e.once("finish",h),e.emit("pipe",s),_.flowing||(Xt("pipe resume"),s.resume()),e};function eh(e){return function(){var t=e._readableState;Xt("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&e.listeners("data").length&&(t.flowing=!0,Ra(e))}}re.prototype.unpipe=function(e){var t=this._readableState;if(t.pipesCount===0)return this;if(t.pipesCount===1)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){e=t.pipes;var n=t.pipesCount;for(t.pipes=null,t.pipesCount=0,t.flowing=!1,t=0;t<n;t++)e[t].emit("unpipe",this);return this}return n=Oc(t.pipes,e),n===-1?this:(t.pipes.splice(n,1),--t.pipesCount,t.pipesCount===1&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},re.prototype.on=function(e,t){return t=Vt.prototype.on.call(this,e,t),e==="data"?this._readableState.flowing!==!1&&this.resume():e==="readable"&&(e=this._readableState,e.endEmitted||e.readableListening||(e.readableListening=e.needReadable=!0,e.emittedReadable=!1,e.reading?e.length&&So(this):De(nh,this))),t},re.prototype.addListener=re.prototype.on;function nh(e){Xt("readable nexttick read 0"),e.read(0)}re.prototype.resume=function(){var e=this._readableState;return e.flowing||(Xt("resume"),e.flowing=!0,e.resumeScheduled||(e.resumeScheduled=!0,De(ih,this,e))),this};function ih(e,t){t.reading||(Xt("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),Ra(e),t.flowing&&!t.reading&&e.read(0)}re.prototype.pause=function(){return Xt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Xt("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function Ra(e){var t=e._readableState;for(Xt("flow",t.flowing);t.flowing&&e.read()!==null;);}re.prototype.wrap=function(e){var t=this._readableState,n=!1,i=this;e.on("end",function(){if(Xt("wrapped end"),t.decoder&&!t.ended){var a=t.decoder.end();a&&a.length&&i.push(a)}i.push(null)}),e.on("data",function(a){Xt("wrapped data"),t.decoder&&(a=t.decoder.write(a)),t.objectMode&&a==null||!(t.objectMode||a&&a.length)||i.push(a)||(n=!0,e.pause())});for(var o in e)this[o]===void 0&&typeof e[o]=="function"&&(this[o]=function(a){return function(){return e[a].apply(e,arguments)}}(o));return ah(["error","close","destroy","pause","resume"],function(a){e.on(a,i.emit.bind(i,a))}),i._read=function(a){Xt("wrapped _read",a),n&&(n=!1,e.resume())},i},re._fromList=xc;function xc(e,t){if(t.length===0)return null;if(t.objectMode)var n=t.buffer.shift();else if(!e||e>=t.length)n=t.decoder?t.buffer.join(""):t.buffer.length===1?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear();else{if(n=t.buffer,t=t.decoder,e<n.head.data.length)t=n.head.data.slice(0,e),n.head.data=n.head.data.slice(e);else{if(e===n.head.data.length)n=n.shift();else if(t){t=n.head;var i=1,o=t.data;for(e-=o.length;t=t.next;){var a=t.data,c=e>a.length?a.length:e;if(o=c===a.length?o+a:o+a.slice(0,e),e-=c,e===0){c===a.length?(++i,n.head=t.next?t.next:n.tail=null):(n.head=t,t.data=a.slice(c));break}++i}n.length-=i,n=o}else{for(t=At.allocUnsafe(e),i=n.head,o=1,i.data.copy(t),e-=i.data.length;i=i.next;){if(a=i.data,c=e>a.length?a.length:e,a.copy(t,t.length-e,0,c),e-=c,e===0){c===a.length?(++o,n.head=i.next?i.next:n.tail=null):(n.head=i,i.data=a.slice(c));break}++o}n.length-=o,n=t}t=n}n=t}return n}function Ua(e){var t=e._readableState;if(0<t.length)throw Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,De(oh,t,e))}function oh(e,t){e.endEmitted||e.length!==0||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function ah(e,t){for(var n=0,i=e.length;n<i;n++)t(e[n],n)}function Oc(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}Ee.WritableState=Ma,On(Ee,Vt);function rh(){}function sh(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function Ma(e,t){Object.defineProperty(this,"buffer",{get:La(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Ze&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||n===0?n:i,this.highWaterMark=~~this.highWaterMark,this.finished=this.ended=this.ending=this.needDrain=!1,this.decodeStrings=e.decodeStrings!==!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(o){var a=t._writableState,c=a.sync,d=a.writecb;a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0,o?(--a.pendingcb,c?De(d,o):d(o),t._writableState.errorEmitted=!0,t.emit("error",o)):((o=Rc(a))||a.corked||a.bufferProcessing||!a.bufferedRequest||Pc(t,a),c?De(Tc,t,a,o,d):Tc(t,a,o,d))},this.writecb=null,this.writelen=0,this.lastBufferedRequest=this.bufferedRequest=null,this.pendingcb=0,this.errorEmitted=this.prefinished=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Mc(this)}Ma.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};function Ee(e){if(!(this instanceof Ee||this instanceof Ze))return new Ee(e);this._writableState=new Ma(e,this),this.writable=!0,e&&(typeof e.write=="function"&&(this._write=e.write),typeof e.writev=="function"&&(this._writev=e.writev)),Vt.call(this)}Ee.prototype.pipe=function(){this.emit("error",Error("Cannot pipe, not readable"))},Ee.prototype.write=function(e,t,n){var i=this._writableState,o=!1;if(typeof t=="function"&&(n=t,t=null),At.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),typeof n!="function"&&(n=rh),i.ended)i=n,e=Error("write after end"),this.emit("error",e),De(i,e);else{var a=n,c=!0,d=!1;e===null?d=new TypeError("May not write null values to stream"):At.isBuffer(e)||typeof e=="string"||e===void 0||i.objectMode||(d=new TypeError("Invalid non-string/buffer chunk")),d&&(this.emit("error",d),De(a,d),c=!1),c&&(i.pendingcb++,o=t,i.objectMode||i.decodeStrings===!1||typeof e!="string"||(e=At.from(e,o)),At.isBuffer(e)&&(o="buffer"),a=i.objectMode?1:e.length,i.length+=a,t=i.length<i.highWaterMark,t||(i.needDrain=!0),i.writing||i.corked?(a=i.lastBufferedRequest,i.lastBufferedRequest=new sh(e,o,n),a?a.next=i.lastBufferedRequest:i.bufferedRequest=i.lastBufferedRequest,i.bufferedRequestCount+=1):Ga(this,i,!1,a,e,o,n),o=t)}return o},Ee.prototype.cork=function(){this._writableState.corked++},Ee.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||Pc(this,e))},Ee.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(-1<"hex utf8 utf-8 ascii binary base64 ucs2 ucs-2 utf16le utf-16le raw".split(" ").indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function Ga(e,t,n,i,o,a,c){t.writelen=i,t.writecb=c,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,a,t.onwrite),t.sync=!1}function Tc(e,t,n,i){!n&&t.length===0&&t.needDrain&&(t.needDrain=!1,e.emit("drain")),t.pendingcb--,i(),Uc(e,t)}function Pc(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=Array(t.bufferedRequestCount),o=t.corkedRequestsFree;o.entry=n;for(var a=0;n;)i[a]=n,n=n.next,a+=1;Ga(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new Mc(t)}else{for(;n&&(i=n.chunk,Ga(e,t,!1,t.objectMode?1:i.length,i,n.encoding,n.callback),n=n.next,!t.writing););n===null&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}Ee.prototype._write=function(e,t,n){n(Error("not implemented"))},Ee.prototype._writev=null,Ee.prototype.end=function(e,t,n){var i=this._writableState;typeof e=="function"?(n=e,t=e=null):typeof t=="function"&&(n=t,t=null),e!=null&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),!i.ending&&!i.finished&&(e=n,i.ending=!0,Uc(this,i),e&&(i.finished?De(e):this.once("finish",e)),i.ended=!0,this.writable=!1)};function Rc(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function Uc(e,t){var n=Rc(t);return n&&(t.pendingcb===0?(t.prefinished||(t.prefinished=!0,e.emit("prefinish")),t.finished=!0,e.emit("finish")):t.prefinished||(t.prefinished=!0,e.emit("prefinish"))),n}function Mc(e){var t=this;this.entry=this.next=null,this.finish=function(n){var i=t.entry;for(t.entry=null;i;){var o=i.callback;e.pendingcb--,o(n),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}On(Ze,re);for(var Gc=Object.keys(Ee.prototype),Na=0;Na<Gc.length;Na++){var qa=Gc[Na];Ze.prototype[qa]||(Ze.prototype[qa]=Ee.prototype[qa])}function Ze(e){if(!(this instanceof Ze))return new Ze(e);re.call(this,e),Ee.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",ch)}function ch(){this.allowHalfOpen||this._writableState.ended||De(lh,this)}function lh(e){e.end()}On(cn,Ze);function uh(e){this.afterTransform=function(t,n){var i=e._transformState;i.transforming=!1;var o=i.writecb;return o?(i.writechunk=null,i.writecb=null,n!=null&&e.push(n),o(t),t=e._readableState,t.reading=!1,(t.needReadable||t.length<t.highWaterMark)&&e._read(t.highWaterMark),t=void 0):t=e.emit("error",Error("no writecb in Transform class")),t},this.transforming=this.needTransform=!1,this.writeencoding=this.writechunk=this.writecb=null}function cn(e){if(!(this instanceof cn))return new cn(e);Ze.call(this,e),this._transformState=new uh(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(n){Nc(t,n)}):Nc(t)})}cn.prototype.push=function(e,t){return this._transformState.needTransform=!1,Ze.prototype.push.call(this,e,t)},cn.prototype._transform=function(){throw Error("Not implemented")},cn.prototype._write=function(e,t,n){var i=this._transformState;i.writecb=n,i.writechunk=e,i.writeencoding=t,i.transforming||(e=this._readableState,(i.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark))},cn.prototype._read=function(){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};function Nc(e,t){if(t)return e.emit("error",t);if(t=e._transformState,e._writableState.length)throw Error("Calling transform done when ws.length != 0");if(t.transforming)throw Error("Calling transform done when still transforming");return e.push(null)}On(ki,cn);function ki(e){if(!(this instanceof ki))return new ki(e);cn.call(this,e)}ki.prototype._transform=function(e,t,n){n(null,e)},On(ke,Vt),ke.Readable=re,ke.Writable=Ee,ke.Duplex=Ze,ke.Transform=cn,ke.PassThrough=ki,ke.Stream=ke;function ke(){Vt.call(this)}ke.prototype.pipe=function(e,t){function n(s){e.writable&&e.write(s)===!1&&h.pause&&h.pause()}function i(){h.readable&&h.resume&&h.resume()}function o(){u||(u=!0,e.end())}function a(){u||(u=!0,typeof e.destroy=="function"&&e.destroy())}function c(s){if(d(),Vt.listenerCount(this,"error")===0)throw s}function d(){h.removeListener("data",n),e.removeListener("drain",i),h.removeListener("end",o),h.removeListener("close",a),h.removeListener("error",c),e.removeListener("error",c),h.removeListener("end",d),h.removeListener("close",d),e.removeListener("close",d)}var h=this;h.on("data",n),e.on("drain",i),e._isStdio||t&&t.end===!1||(h.on("end",o),h.on("close",a));var u=!1;return h.on("error",c),e.on("error",c),h.on("end",d),h.on("close",d),e.on("close",d),e.emit("pipe",h),e};var dh=Array.prototype.slice,fh={extend:function e(t,n){for(var i in n)t[i]=n[i];return 3>arguments.length?t:e.apply(null,[t].concat(dh.call(arguments,2)))}},qc=be(function(e,t){function n(a,c,d){return d===void 0&&(d=function(h){return h}),function(){for(var h=[],u=0;u<arguments.length;u++)h[u]=arguments[u];return new Promise(function(s,_){a[c].bind(a).apply(void 0,i(h,[function(L,g){return L?_(L):s(d(g))}]))})}}var i=ce&&ce.__spreadArrays||function(){for(var a=0,c=0,d=arguments.length;c<d;c++)a+=arguments[c].length;a=Array(a);var h=0;for(c=0;c<d;c++)for(var u=arguments[c],s=0,_=u.length;s<_;s++,h++)a[h]=u[s];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function a(c,d){this.vol=c,this.fd=d}return a.prototype.appendFile=function(c,d){return n(this.vol,"appendFile")(this.fd,c,d)},a.prototype.chmod=function(c){return n(this.vol,"fchmod")(this.fd,c)},a.prototype.chown=function(c,d){return n(this.vol,"fchown")(this.fd,c,d)},a.prototype.close=function(){return n(this.vol,"close")(this.fd)},a.prototype.datasync=function(){return n(this.vol,"fdatasync")(this.fd)},a.prototype.read=function(c,d,h,u){return n(this.vol,"read",function(s){return{bytesRead:s,buffer:c}})(this.fd,c,d,h,u)},a.prototype.readFile=function(c){return n(this.vol,"readFile")(this.fd,c)},a.prototype.stat=function(c){return n(this.vol,"fstat")(this.fd,c)},a.prototype.sync=function(){return n(this.vol,"fsync")(this.fd)},a.prototype.truncate=function(c){return n(this.vol,"ftruncate")(this.fd,c)},a.prototype.utimes=function(c,d){return n(this.vol,"futimes")(this.fd,c,d)},a.prototype.write=function(c,d,h,u){return n(this.vol,"write",function(s){return{bytesWritten:s,buffer:c}})(this.fd,c,d,h,u)},a.prototype.writeFile=function(c,d){return n(this.vol,"writeFile")(this.fd,c,d)},a}();t.FileHandle=o,t.default=function(a){return typeof Promise=="undefined"?null:{FileHandle:o,access:function(c,d){return n(a,"access")(c,d)},appendFile:function(c,d,h){return n(a,"appendFile")(c instanceof o?c.fd:c,d,h)},chmod:function(c,d){return n(a,"chmod")(c,d)},chown:function(c,d,h){return n(a,"chown")(c,d,h)},copyFile:function(c,d,h){return n(a,"copyFile")(c,d,h)},lchmod:function(c,d){return n(a,"lchmod")(c,d)},lchown:function(c,d,h){return n(a,"lchown")(c,d,h)},link:function(c,d){return n(a,"link")(c,d)},lstat:function(c,d){return n(a,"lstat")(c,d)},mkdir:function(c,d){return n(a,"mkdir")(c,d)},mkdtemp:function(c,d){return n(a,"mkdtemp")(c,d)},open:function(c,d,h){return n(a,"open",function(u){return new o(a,u)})(c,d,h)},readdir:function(c,d){return n(a,"readdir")(c,d)},readFile:function(c,d){return n(a,"readFile")(c instanceof o?c.fd:c,d)},readlink:function(c,d){return n(a,"readlink")(c,d)},realpath:function(c,d){return n(a,"realpath")(c,d)},rename:function(c,d){return n(a,"rename")(c,d)},rmdir:function(c){return n(a,"rmdir")(c)},stat:function(c,d){return n(a,"stat")(c,d)},symlink:function(c,d,h){return n(a,"symlink")(c,d,h)},truncate:function(c,d){return n(a,"truncate")(c,d)},unlink:function(c){return n(a,"unlink")(c)},utimes:function(c,d,h){return n(a,"utimes")(c,d,h)},writeFile:function(c,d,h){return n(a,"writeFile")(c instanceof o?c.fd:c,d,h)}}}});Se(qc);var hh=/[^\x20-\x7E]/,gh=/[\x2E\u3002\uFF0E\uFF61]/g,zc={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Li=Math.floor,za=String.fromCharCode;function ph(e,t){var n=e.split("@"),i="";1<n.length&&(i=n[0]+"@",e=n[1]),e=e.replace(gh,"."),e=e.split("."),n=e.length;for(var o=[];n--;)o[n]=t(e[n]);return t=o.join("."),i+t}function Dc(e,t){return e+22+75*(26>e)-((t!=0)<<5)}function _h(e){return ph(e,function(t){if(hh.test(t)){var n,i=[],o=[],a=0;for(n=t.length;a<n;){var c=t.charCodeAt(a++);if(55296<=c&&56319>=c&&a<n){var d=t.charCodeAt(a++);(d&64512)==56320?o.push(((c&1023)<<10)+(d&1023)+65536):(o.push(c),a--)}else o.push(c)}t=o,d=t.length,o=128;var h=0,u=72;for(c=0;c<d;++c){var s=t[c];128>s&&i.push(za(s))}for((a=n=i.length)&&i.push("-");a<d;){var _=2147483647;for(c=0;c<d;++c)s=t[c],s>=o&&s<_&&(_=s);var L=a+1;if(_-o>Li((2147483647-h)/L))throw new RangeError(zc.overflow);for(h+=(_-o)*L,o=_,c=0;c<d;++c){if(s=t[c],s<o&&2147483647<++h)throw new RangeError(zc.overflow);if(s==o){var g=h;for(_=36;s=_<=u?1:_>=u+26?26:_-u,!(g<s);_+=36){var F=g-s;g=36-s,i.push(za(Dc(s+F%g,0))),g=Li(F/g)}for(i.push(za(Dc(g,0))),u=L,_=0,h=a==n?Li(h/700):h>>1,h+=Li(h/u);455<h;_+=36)h=Li(h/35);u=Li(_+36*h/(h+38)),h=0,++a}}++h,++o}i="xn--"+i.join("")}else i=t;return i})}var kc=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function Qi(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function mh(e,t,n,i){return t=t||"&",n=n||"=",e===null&&(e=void 0),typeof e=="object"?Qc(Lh(e),function(o){var a=encodeURIComponent(Qi(o))+n;return kc(e[o])?Qc(e[o],function(c){return a+encodeURIComponent(Qi(c))}).join(t):a+encodeURIComponent(Qi(e[o]))}).join(t):i?encodeURIComponent(Qi(i))+n+encodeURIComponent(Qi(e)):""}function Qc(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var Lh=Object.keys||function(e){var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t};function Wc(e,t,n,i){n=n||"=";var o={};if(typeof e!="string"||e.length===0)return o;var a=/\+/g;for(e=e.split(t||"&"),t=1e3,i&&typeof i.maxKeys=="number"&&(t=i.maxKeys),i=e.length,0<t&&i>t&&(i=t),t=0;t<i;++t){var c=e[t].replace(a,"%20"),d=c.indexOf(n);if(0<=d){var h=c.substr(0,d);c=c.substr(d+1)}else h=c,c="";h=decodeURIComponent(h),c=decodeURIComponent(c),Object.prototype.hasOwnProperty.call(o,h)?kc(o[h])?o[h].push(c):o[h]=[o[h],c]:o[h]=c}return o}var yh={parse:Bo,resolve:Sh,resolveObject:Bh,format:Fh,Url:ln};function ln(){this.href=this.path=this.pathname=this.query=this.search=this.hash=this.hostname=this.port=this.host=this.auth=this.slashes=this.protocol=null}var Ah=/^([a-z0-9.+-]+:)/i,wh=/:[0-9]*$/,Ih=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,bh="{}|\\^`".split("").concat('<>"` \r\n	'.split("")),Da=["'"].concat(bh),$c=["%","/","?",";","#"].concat(Da),Hc=["/","?","#"],Eh=255,jc=/^[+a-z0-9A-Z_-]{0,63}$/,Ch=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,vh={javascript:!0,"javascript:":!0},ka={javascript:!0,"javascript:":!0},yi={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Bo(e,t,n){if(e&&Tn(e)&&e instanceof ln)return e;var i=new ln;return i.parse(e,t,n),i}ln.prototype.parse=function(e,t,n){return Vc(this,e,t,n)};function Vc(e,t,n,i){if(!Kn(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?");if(o=o!==-1&&o<t.indexOf("#")?"?":"#",t=t.split(o),t[0]=t[0].replace(/\\/g,"/"),t=t.join(o),o=t.trim(),!i&&t.split("#").length===1&&(t=Ih.exec(o)))return e.path=o,e.href=o,e.pathname=t[1],t[2]?(e.search=t[2],e.query=n?Wc(e.search.substr(1)):e.search.substr(1)):n&&(e.search="",e.query={}),e;if(t=Ah.exec(o)){t=t[0];var a=t.toLowerCase();e.protocol=a,o=o.substr(t.length)}if(i||t||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var c=o.substr(0,2)==="//";!c||t&&ka[t]||(o=o.substr(2),e.slashes=!0)}if(!ka[t]&&(c||t&&!yi[t])){for(t=-1,i=0;i<Hc.length;i++)c=o.indexOf(Hc[i]),c!==-1&&(t===-1||c<t)&&(t=c);for(c=t===-1?o.lastIndexOf("@"):o.lastIndexOf("@",t),c!==-1&&(i=o.slice(0,c),o=o.slice(c+1),e.auth=decodeURIComponent(i)),t=-1,i=0;i<$c.length;i++)c=o.indexOf($c[i]),c!==-1&&(t===-1||c<t)&&(t=c);if(t===-1&&(t=o.length),e.host=o.slice(0,t),o=o.slice(t),Kc(e),e.hostname=e.hostname||"",c=e.hostname[0]==="["&&e.hostname[e.hostname.length-1]==="]",!c){var d=e.hostname.split(/\./);for(i=0,t=d.length;i<t;i++){var h=d[i];if(h&&!h.match(jc)){for(var u="",s=0,_=h.length;s<_;s++)u=127<h.charCodeAt(s)?u+"x":u+h[s];if(!u.match(jc)){t=d.slice(0,i),i=d.slice(i+1),(h=h.match(Ch))&&(t.push(h[1]),i.unshift(h[2])),i.length&&(o="/"+i.join(".")+o),e.hostname=t.join(".");break}}}}e.hostname=e.hostname.length>Eh?"":e.hostname.toLowerCase(),c||(e.hostname=_h(e.hostname)),i=e.port?":"+e.port:"",e.host=(e.hostname||"")+i,e.href+=e.host,c&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),o[0]!=="/"&&(o="/"+o))}if(!vh[a])for(i=0,t=Da.length;i<t;i++)c=Da[i],o.indexOf(c)!==-1&&(h=encodeURIComponent(c),h===c&&(h=escape(c)),o=o.split(c).join(h));return i=o.indexOf("#"),i!==-1&&(e.hash=o.substr(i),o=o.slice(0,i)),i=o.indexOf("?"),i!==-1?(e.search=o.substr(i),e.query=o.substr(i+1),n&&(e.query=Wc(e.query)),o=o.slice(0,i)):n&&(e.search="",e.query={}),o&&(e.pathname=o),yi[a]&&e.hostname&&!e.pathname&&(e.pathname="/"),(e.pathname||e.search)&&(i=e.pathname||"",e.path=i+(e.search||"")),e.href=Qa(e),e}function Fh(e){return Kn(e)&&(e=Vc({},e)),Qa(e)}function Qa(e){var t=e.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var n=e.protocol||"",i=e.pathname||"",o=e.hash||"",a=!1,c="";return e.host?a=t+e.host:e.hostname&&(a=t+(e.hostname.indexOf(":")===-1?e.hostname:"["+this.hostname+"]"),e.port&&(a+=":"+e.port)),e.query&&Tn(e.query)&&Object.keys(e.query).length&&(c=mh(e.query)),t=e.search||c&&"?"+c||"",n&&n.substr(-1)!==":"&&(n+=":"),e.slashes||(!n||yi[n])&&a!==!1?(a="//"+(a||""),i&&i.charAt(0)!=="/"&&(i="/"+i)):a||(a=""),o&&o.charAt(0)!=="#"&&(o="#"+o),t&&t.charAt(0)!=="?"&&(t="?"+t),i=i.replace(/[?#]/g,function(d){return encodeURIComponent(d)}),t=t.replace("#","%23"),n+a+i+t+o}ln.prototype.format=function(){return Qa(this)};function Sh(e,t){return Bo(e,!1,!0).resolve(t)}ln.prototype.resolve=function(e){return this.resolveObject(Bo(e,!1,!0)).format()};function Bh(e,t){return e?Bo(e,!1,!0).resolveObject(t):t}ln.prototype.resolveObject=function(e){if(Kn(e)){var t=new ln;t.parse(e,!1,!0),e=t}t=new ln;for(var n=Object.keys(this),i=0;i<n.length;i++){var o=n[i];t[o]=this[o]}if(t.hash=e.hash,e.href==="")return t.href=t.format(),t;if(e.slashes&&!e.protocol){for(n=Object.keys(e),i=0;i<n.length;i++)o=n[i],o!=="protocol"&&(t[o]=e[o]);return yi[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t}var a;if(e.protocol&&e.protocol!==t.protocol){if(!yi[e.protocol]){for(n=Object.keys(e),i=0;i<n.length;i++)o=n[i],t[o]=e[o];return t.href=t.format(),t}if(t.protocol=e.protocol,e.host||ka[e.protocol])t.pathname=e.pathname;else{for(a=(e.pathname||"").split("/");a.length&&!(e.host=a.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),a[0]!==""&&a.unshift(""),2>a.length&&a.unshift(""),t.pathname=a.join("/")}return t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,(t.pathname||t.search)&&(t.path=(t.pathname||"")+(t.search||"")),t.slashes=t.slashes||e.slashes,t.href=t.format(),t}n=t.pathname&&t.pathname.charAt(0)==="/";var c=e.host||e.pathname&&e.pathname.charAt(0)==="/",d=n=c||n||t.host&&e.pathname;if(i=t.pathname&&t.pathname.split("/")||[],o=t.protocol&&!yi[t.protocol],a=e.pathname&&e.pathname.split("/")||[],o&&(t.hostname="",t.port=null,t.host&&(i[0]===""?i[0]=t.host:i.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(a[0]===""?a[0]=e.host:a.unshift(e.host)),e.host=null),n=n&&(a[0]===""||i[0]==="")),c)t.host=e.host||e.host===""?e.host:t.host,t.hostname=e.hostname||e.hostname===""?e.hostname:t.hostname,t.search=e.search,t.query=e.query,i=a;else if(a.length)i||(i=[]),i.pop(),i=i.concat(a),t.search=e.search,t.query=e.query;else if(e.search!=null)return o&&(t.hostname=t.host=i.shift(),o=t.host&&0<t.host.indexOf("@")?t.host.split("@"):!1)&&(t.auth=o.shift(),t.host=t.hostname=o.shift()),t.search=e.search,t.query=e.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t;if(!i.length)return t.pathname=null,t.path=t.search?"/"+t.search:null,t.href=t.format(),t;c=i.slice(-1)[0],a=(t.host||e.host||1<i.length)&&(c==="."||c==="..")||c==="";for(var h=0,u=i.length;0<=u;u--)c=i[u],c==="."?i.splice(u,1):c===".."?(i.splice(u,1),h++):h&&(i.splice(u,1),h--);if(!n&&!d)for(;h--;h)i.unshift("..");return!n||i[0]===""||i[0]&&i[0].charAt(0)==="/"||i.unshift(""),a&&i.join("/").substr(-1)!=="/"&&i.push(""),d=i[0]===""||i[0]&&i[0].charAt(0)==="/",o&&(t.hostname=t.host=d?"":i.length?i.shift():"",o=t.host&&0<t.host.indexOf("@")?t.host.split("@"):!1)&&(t.auth=o.shift(),t.host=t.hostname=o.shift()),(n=n||t.host&&i.length)&&!d&&i.unshift(""),i.length?t.pathname=i.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes,t.href=t.format(),t},ln.prototype.parseHost=function(){return Kc(this)};function Kc(e){var t=e.host,n=wh.exec(t);n&&(n=n[0],n!==":"&&(e.port=n.substr(1)),t=t.substr(0,t.length-n.length)),t&&(e.hostname=t)}var Yc=be(function(e,t){function n(a,c){return a=a[c],0<c&&(a==="/"||o&&a==="\\")}function i(a){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0;if(o){var d=a;if(typeof d!="string")throw new TypeError("expected a string");if(d=d.replace(/[\\\/]+/g,"/"),c!==!1)if(c=d,d=c.length-1,2>d)d=c;else{for(;n(c,d);)d--;d=c.substr(0,d+1)}return d.replace(/^([a-zA-Z]+:|\.\/)/,"")}return a}Object.defineProperty(t,"__esModule",{value:!0}),t.unixify=i,t.correctPath=function(a){return i(a.replace(/^\\\\\?\\.:\\/,"\\"))};var o=hi.platform==="win32"});Se(Yc);var Zn=be(function(e,t){function n(b,r){return r===void 0&&(r=Be.default.cwd()),tt(r,b)}function i(b,r){return typeof b=="function"?[o(),b]:[o(b),_(r)]}function o(b){return b===void 0&&(b={}),z({},M,b)}function a(b){return typeof b=="number"?z({},Pt,{mode:b}):z({},Pt,b)}function c(b,r,l,A){r===void 0&&(r=""),l===void 0&&(l=""),A===void 0&&(A="");var S="";switch(l&&(S=" '"+l+"'"),A&&(S+=" -> '"+A+"'"),b){case"ENOENT":return"ENOENT: no such file or directory, "+r+S;case"EBADF":return"EBADF: bad file descriptor, "+r+S;case"EINVAL":return"EINVAL: invalid argument, "+r+S;case"EPERM":return"EPERM: operation not permitted, "+r+S;case"EPROTO":return"EPROTO: protocol error, "+r+S;case"EEXIST":return"EEXIST: file already exists, "+r+S;case"ENOTDIR":return"ENOTDIR: not a directory, "+r+S;case"EISDIR":return"EISDIR: illegal operation on a directory, "+r+S;case"EACCES":return"EACCES: permission denied, "+r+S;case"ENOTEMPTY":return"ENOTEMPTY: directory not empty, "+r+S;case"EMFILE":return"EMFILE: too many open files, "+r+S;case"ENOSYS":return"ENOSYS: function not implemented, "+r+S;default:return b+": error occurred, "+r+S}}function d(b,r,l,A,S){return r===void 0&&(r=""),l===void 0&&(l=""),A===void 0&&(A=""),S===void 0&&(S=Error),r=new S(c(b,r,l,A)),r.code=b,r}function h(b){if(typeof b=="number")return b;if(typeof b=="string"){var r=J[b];if(typeof r!="undefined")return r}throw new Ni.TypeError("ERR_INVALID_OPT_VALUE","flags",b)}function u(b,r){if(r){var l=typeof r;switch(l){case"string":b=z({},b,{encoding:r});break;case"object":b=z({},b,r);break;default:throw TypeError("Expected options to be either an object or a string, but got "+l+" instead")}}else return b;return b.encoding!=="buffer"&&Ye.assertEncoding(b.encoding),b}function s(b){return function(r){return u(b,r)}}function _(b){if(typeof b!="function")throw TypeError(I.CB);return b}function L(b){return function(r,l){return typeof r=="function"?[b(),r]:[b(r),_(l)]}}function g(b){if(typeof b!="string"&&!ee.Buffer.isBuffer(b)){try{if(!(b instanceof yh.URL))throw new TypeError(I.PATH_STR)}catch{throw new TypeError(I.PATH_STR)}if(b.hostname!=="")throw new Ni.TypeError("ERR_INVALID_FILE_URL_HOST",Be.default.platform);b=b.pathname;for(var r=0;r<b.length;r++)if(b[r]==="%"){var l=b.codePointAt(r+2)|32;if(b[r+1]==="2"&&l===102)throw new Ni.TypeError("ERR_INVALID_FILE_URL_PATH","must not include encoded / characters")}b=decodeURIComponent(b)}return b=String(b),x(b),b}function F(b,r){return(b=n(b,r).substr(1))?b.split(p):[]}function T(b){return F(g(b))}function C(b,r){return r===void 0&&(r=Ye.ENCODING_UTF8),ee.Buffer.isBuffer(b)?b:b instanceof Uint8Array?ee.bufferFrom(b):ee.bufferFrom(String(b),r)}function U(b,r){return r&&r!=="buffer"?b.toString(r):b}function x(b,r){if((""+b).indexOf("\0")!==-1){if(b=Error("Path must be a string without null bytes"),b.code="ENOENT",typeof r!="function")throw b;return Be.default.nextTick(r,b),!1}return!0}function V(b,r){if(b=typeof b=="number"?b:typeof b=="string"?parseInt(b,8):r?V(r):void 0,typeof b!="number"||isNaN(b))throw new TypeError(I.MODE_INT);return b}function D(b){if(b>>>0!==b)throw TypeError(I.FD)}function $(b){if(typeof b=="string"&&+b==b)return+b;if(b instanceof Date)return b.getTime()/1e3;if(isFinite(b))return 0>b?Date.now()/1e3:b;throw Error("Cannot parse time: "+b)}function v(b){if(typeof b!="number")throw TypeError(I.UID)}function m(b){if(typeof b!="number")throw TypeError(I.GID)}function y(b){b.emit("stop")}function G(b,r,l){if(!(this instanceof G))return new G(b,r,l);if(this._vol=b,l=z({},u(l,{})),l.highWaterMark===void 0&&(l.highWaterMark=65536),ke.Readable.call(this,l),this.path=g(r),this.fd=l.fd===void 0?null:l.fd,this.flags=l.flags===void 0?"r":l.flags,this.mode=l.mode===void 0?438:l.mode,this.start=l.start,this.end=l.end,this.autoClose=l.autoClose===void 0?!0:l.autoClose,this.pos=void 0,this.bytesRead=0,this.start!==void 0){if(typeof this.start!="number")throw new TypeError('"start" option must be a Number');if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw new TypeError('"end" option must be a Number');if(this.start>this.end)throw Error('"start" option must be <= "end" option');this.pos=this.start}typeof this.fd!="number"&&this.open(),this.on("end",function(){this.autoClose&&this.destroy&&this.destroy()})}function k(){this.close()}function N(b,r,l){if(!(this instanceof N))return new N(b,r,l);if(this._vol=b,l=z({},u(l,{})),ke.Writable.call(this,l),this.path=g(r),this.fd=l.fd===void 0?null:l.fd,this.flags=l.flags===void 0?"w":l.flags,this.mode=l.mode===void 0?438:l.mode,this.start=l.start,this.autoClose=l.autoClose===void 0?!0:!!l.autoClose,this.pos=void 0,this.bytesWritten=0,this.start!==void 0){if(typeof this.start!="number")throw new TypeError('"start" option must be a Number');if(0>this.start)throw Error('"start" must be >= zero');this.pos=this.start}l.encoding&&this.setDefaultEncoding(l.encoding),typeof this.fd!="number"&&this.open(),this.once("finish",function(){this.autoClose&&this.close()})}var R=ce&&ce.__extends||function(){function b(r,l){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,S){A.__proto__=S}||function(A,S){for(var P in S)S.hasOwnProperty(P)&&(A[P]=S[P])},b(r,l)}return function(r,l){function A(){this.constructor=r}b(r,l),r.prototype=l===null?Object.create(l):(A.prototype=l.prototype,new A)}}(),E=ce&&ce.__spreadArrays||function(){for(var b=0,r=0,l=arguments.length;r<l;r++)b+=arguments[r].length;b=Array(b);var A=0;for(r=0;r<l;r++)for(var S=arguments[r],P=0,Q=S.length;P<Q;P++,A++)b[A]=S[P];return b};Object.defineProperty(t,"__esModule",{value:!0});var z=fh.extend,tt=Ta.resolve,at=jt.constants.O_RDONLY,it=jt.constants.O_WRONLY,Z=jt.constants.O_RDWR,ot=jt.constants.O_CREAT,nt=jt.constants.O_EXCL,gt=jt.constants.O_TRUNC,xt=jt.constants.O_APPEND,pt=jt.constants.O_SYNC,yt=jt.constants.O_DIRECTORY,w=jt.constants.F_OK,f=jt.constants.COPYFILE_EXCL,O=jt.constants.COPYFILE_FICLONE_FORCE,p=Ta.sep,W=Ta.relative,q=Be.default.platform==="win32",I={PATH_STR:"path must be a string or Buffer",FD:"fd must be a file descriptor",MODE_INT:"mode must be an int",CB:"callback must be a function",UID:"uid must be an unsigned int",GID:"gid must be an unsigned int",LEN:"len must be an integer",ATIME:"atime must be an integer",MTIME:"mtime must be an integer",PREFIX:"filename prefix is required",BUFFER:"buffer must be an instance of Buffer or StaticBuffer",OFFSET:"offset must be an integer",LENGTH:"length must be an integer",POSITION:"position must be an integer"},J;(function(b){b[b.r=at]="r",b[b["r+"]=Z]="r+",b[b.rs=at|pt]="rs",b[b.sr=b.rs]="sr",b[b["rs+"]=Z|pt]="rs+",b[b["sr+"]=b["rs+"]]="sr+",b[b.w=it|ot|gt]="w",b[b.wx=it|ot|gt|nt]="wx",b[b.xw=b.wx]="xw",b[b["w+"]=Z|ot|gt]="w+",b[b["wx+"]=Z|ot|gt|nt]="wx+",b[b["xw+"]=b["wx+"]]="xw+",b[b.a=it|xt|ot]="a",b[b.ax=it|xt|ot|nt]="ax",b[b.xa=b.ax]="xa",b[b["a+"]=Z|xt|ot]="a+",b[b["ax+"]=Z|xt|ot|nt]="ax+",b[b["xa+"]=b["ax+"]]="xa+"})(J=t.FLAGS||(t.FLAGS={})),t.flagsToNumber=h,e={encoding:"utf8"};var dt=s(e),lt=L(dt),It=s({flag:"r"}),Ut={encoding:"utf8",mode:438,flag:J[J.w]},Ot=s(Ut),Ft={encoding:"utf8",mode:438,flag:J[J.a]},Ct=s(Ft),Lt=L(Ct),Et=s(e),Bt=L(Et),Pt={mode:511,recursive:!1},vt={recursive:!1},Wt=s({encoding:"utf8",withFileTypes:!1}),B=L(Wt),M={bigint:!1};if(t.pathToFilename=g,q){var H=n,j=Yc.unixify;n=function(b,r){return j(H(b,r))}}t.filenameToSteps=F,t.pathToSteps=T,t.dataToStr=function(b,r){return r===void 0&&(r=Ye.ENCODING_UTF8),ee.Buffer.isBuffer(b)?b.toString(r):b instanceof Uint8Array?ee.bufferFrom(b).toString(r):String(b)},t.dataToBuffer=C,t.bufferToEncoding=U,t.toUnixTimestamp=$,e=function(){function b(r){r===void 0&&(r={}),this.ino=0,this.inodes={},this.releasedInos=[],this.fds={},this.releasedFds=[],this.maxFiles=1e4,this.openFiles=0,this.promisesApi=qc.default(this),this.statWatchers={},this.props=z({Node:zi.Node,Link:zi.Link,File:zi.File},r),r=this.createLink(),r.setNode(this.createNode(!0));var l=this;this.StatWatcher=function(A){function S(){return A.call(this,l)||this}return R(S,A),S}(rt),this.ReadStream=function(A){function S(){for(var P=[],Q=0;Q<arguments.length;Q++)P[Q]=arguments[Q];return A.apply(this,E([l],P))||this}return R(S,A),S}(G),this.WriteStream=function(A){function S(){for(var P=[],Q=0;Q<arguments.length;Q++)P[Q]=arguments[Q];return A.apply(this,E([l],P))||this}return R(S,A),S}(N),this.FSWatcher=function(A){function S(){return A.call(this,l)||this}return R(S,A),S}(ct),this.root=r}return b.fromJSON=function(r,l){var A=new b;return A.fromJSON(r,l),A},Object.defineProperty(b.prototype,"promises",{get:function(){if(this.promisesApi===null)throw Error("Promise is not supported in this environment.");return this.promisesApi},enumerable:!0,configurable:!0}),b.prototype.createLink=function(r,l,A,S){if(A===void 0&&(A=!1),!r)return new this.props.Link(this,null,"");if(!l)throw Error("createLink: name cannot be empty");return r.createChild(l,this.createNode(A,S))},b.prototype.deleteLink=function(r){var l=r.parent;return l?(l.deleteChild(r),!0):!1},b.prototype.newInoNumber=function(){var r=this.releasedInos.pop();return r||(this.ino=(this.ino+1)%4294967295)},b.prototype.newFdNumber=function(){var r=this.releasedFds.pop();return typeof r=="number"?r:b.fd--},b.prototype.createNode=function(r,l){return r===void 0&&(r=!1),l=new this.props.Node(this.newInoNumber(),l),r&&l.setIsDirectory(),this.inodes[l.ino]=l},b.prototype.getNode=function(r){return this.inodes[r]},b.prototype.deleteNode=function(r){r.del(),delete this.inodes[r.ino],this.releasedInos.push(r.ino)},b.prototype.genRndStr=function(){var r=(Math.random()+1).toString(36).substr(2,6);return r.length===6?r:this.genRndStr()},b.prototype.getLink=function(r){return this.root.walk(r)},b.prototype.getLinkOrThrow=function(r,l){var A=F(r);if(A=this.getLink(A),!A)throw d("ENOENT",l,r);return A},b.prototype.getResolvedLink=function(r){r=typeof r=="string"?F(r):r;for(var l=this.root,A=0;A<r.length;){if(l=l.getChild(r[A]),!l)return null;var S=l.getNode();S.isSymlink()?(r=S.symlink.concat(r.slice(A+1)),l=this.root,A=0):A++}return l},b.prototype.getResolvedLinkOrThrow=function(r,l){var A=this.getResolvedLink(r);if(!A)throw d("ENOENT",l,r);return A},b.prototype.resolveSymlinks=function(r){return this.getResolvedLink(r.steps.slice(1))},b.prototype.getLinkAsDirOrThrow=function(r,l){var A=this.getLinkOrThrow(r,l);if(!A.getNode().isDirectory())throw d("ENOTDIR",l,r);return A},b.prototype.getLinkParent=function(r){return this.root.walk(r,r.length-1)},b.prototype.getLinkParentAsDirOrThrow=function(r,l){r=r instanceof Array?r:F(r);var A=this.getLinkParent(r);if(!A)throw d("ENOENT",l,p+r.join(p));if(!A.getNode().isDirectory())throw d("ENOTDIR",l,p+r.join(p));return A},b.prototype.getFileByFd=function(r){return this.fds[String(r)]},b.prototype.getFileByFdOrThrow=function(r,l){if(r>>>0!==r)throw TypeError(I.FD);if(r=this.getFileByFd(r),!r)throw d("EBADF",l);return r},b.prototype.getNodeByIdOrCreate=function(r,l,A){if(typeof r=="number"){if(r=this.getFileByFd(r),!r)throw Error("File nto found");return r.node}var S=T(r),P=this.getLink(S);if(P)return P.getNode();if(l&ot&&(l=this.getLinkParent(S)))return P=this.createLink(l,S[S.length-1],!1,A),P.getNode();throw d("ENOENT","getNodeByIdOrCreate",g(r))},b.prototype.wrapAsync=function(r,l,A){var S=this;_(A),mi.default(function(){try{A(null,r.apply(S,l))}catch(P){A(P)}})},b.prototype._toJSON=function(r,l,A){var S;r===void 0&&(r=this.root),l===void 0&&(l={});var P=!0,Q=r.children;r.getNode().isFile()&&(Q=(S={},S[r.getName()]=r.parent.getChild(r.getName()),S),r=r.parent);for(var Y in Q){if(P=!1,Q=r.getChild(Y),!Q)throw Error("_toJSON: unexpected undefined");S=Q.getNode(),S.isFile()?(Q=Q.getPath(),A&&(Q=W(A,Q)),l[Q]=S.getString()):S.isDirectory()&&this._toJSON(Q,l,A)}return r=r.getPath(),A&&(r=W(A,r)),r&&P&&(l[r]=null),l},b.prototype.toJSON=function(r,l,A){l===void 0&&(l={}),A===void 0&&(A=!1);var S=[];if(r){r instanceof Array||(r=[r]);for(var P=0;P<r.length;P++){var Q=g(r[P]);(Q=this.getResolvedLink(Q))&&S.push(Q)}}else S.push(this.root);if(!S.length)return l;for(P=0;P<S.length;P++)Q=S[P],this._toJSON(Q,l,A?Q.getPath():"");return l},b.prototype.fromJSON=function(r,l){l===void 0&&(l=Be.default.cwd());for(var A in r){var S=r[A];if(typeof S=="string"){A=n(A,l);var P=F(A);1<P.length&&(P=p+P.slice(0,P.length-1).join(p),this.mkdirpBase(P,511)),this.writeFileSync(A,S)}else this.mkdirpBase(A,511)}},b.prototype.reset=function(){this.ino=0,this.inodes={},this.releasedInos=[],this.fds={},this.releasedFds=[],this.openFiles=0,this.root=this.createLink(),this.root.setNode(this.createNode(!0))},b.prototype.mountSync=function(r,l){this.fromJSON(l,r)},b.prototype.openLink=function(r,l,A){if(A===void 0&&(A=!0),this.openFiles>=this.maxFiles)throw d("EMFILE","open",r.getPath());var S=r;if(A&&(S=this.resolveSymlinks(r)),!S)throw d("ENOENT","open",r.getPath());if(A=S.getNode(),A.isDirectory()){if((l&(at|Z|it))!==at)throw d("EISDIR","open",r.getPath())}else if(l&yt)throw d("ENOTDIR","open",r.getPath());if(!(l&it||A.canRead()))throw d("EACCES","open",r.getPath());return r=new this.props.File(r,A,l,this.newFdNumber()),this.fds[r.fd]=r,this.openFiles++,l&gt&&r.truncate(),r},b.prototype.openFile=function(r,l,A,S){S===void 0&&(S=!0);var P=F(r),Q=S?this.getResolvedLink(P):this.getLink(P);if(!Q&&l&ot){var Y=this.getResolvedLink(P.slice(0,P.length-1));if(!Y)throw d("ENOENT","open",p+P.join(p));l&ot&&typeof A=="number"&&(Q=this.createLink(Y,P[P.length-1],!1,A))}if(Q)return this.openLink(Q,l,S);throw d("ENOENT","open",r)},b.prototype.openBase=function(r,l,A,S){if(S===void 0&&(S=!0),l=this.openFile(r,l,A,S),!l)throw d("ENOENT","open",r);return l.fd},b.prototype.openSync=function(r,l,A){return A===void 0&&(A=438),A=V(A),r=g(r),l=h(l),this.openBase(r,l,A)},b.prototype.open=function(r,l,A,S){var P=A;typeof A=="function"&&(P=438,S=A),A=V(P||438),r=g(r),l=h(l),this.wrapAsync(this.openBase,[r,l,A],S)},b.prototype.closeFile=function(r){this.fds[r.fd]&&(this.openFiles--,delete this.fds[r.fd],this.releasedFds.push(r.fd))},b.prototype.closeSync=function(r){D(r),r=this.getFileByFdOrThrow(r,"close"),this.closeFile(r)},b.prototype.close=function(r,l){D(r),this.wrapAsync(this.closeSync,[r],l)},b.prototype.openFileOrGetById=function(r,l,A){if(typeof r=="number"){if(r=this.fds[r],!r)throw d("ENOENT");return r}return this.openFile(g(r),l,A)},b.prototype.readBase=function(r,l,A,S,P){return this.getFileByFdOrThrow(r).read(l,Number(A),Number(S),P)},b.prototype.readSync=function(r,l,A,S,P){return D(r),this.readBase(r,l,A,S,P)},b.prototype.read=function(r,l,A,S,P,Q){var Y=this;if(_(Q),S===0)return Be.default.nextTick(function(){Q&&Q(null,0,l)});mi.default(function(){try{var st=Y.readBase(r,l,A,S,P);Q(null,st,l)}catch(ft){Q(ft)}})},b.prototype.readFileBase=function(r,l,A){var S=typeof r=="number"&&r>>>0===r;if(!S){var P=g(r);if(P=F(P),(P=this.getResolvedLink(P))&&P.getNode().isDirectory())throw d("EISDIR","open",P.getPath());r=this.openSync(r,l)}try{var Q=U(this.getFileByFdOrThrow(r).getBuffer(),A)}finally{S||this.closeSync(r)}return Q},b.prototype.readFileSync=function(r,l){l=It(l);var A=h(l.flag);return this.readFileBase(r,A,l.encoding)},b.prototype.readFile=function(r,l,A){A=L(It)(l,A),l=A[0],A=A[1];var S=h(l.flag);this.wrapAsync(this.readFileBase,[r,S,l.encoding],A)},b.prototype.writeBase=function(r,l,A,S,P){return this.getFileByFdOrThrow(r,"write").write(l,A,S,P)},b.prototype.writeSync=function(r,l,A,S,P){D(r);var Q=typeof l!="string";if(Q){var Y=(A||0)|0,st=S;A=P}else var ft=S;return l=C(l,ft),Q?typeof st=="undefined"&&(st=l.length):(Y=0,st=l.length),this.writeBase(r,l,Y,st,A)},b.prototype.write=function(r,l,A,S,P,Q){var Y=this;D(r);var st=typeof l,ft=typeof A,_t=typeof S,ut=typeof P;if(st!=="string")if(ft==="function")var wt=A;else if(_t==="function"){var Rt=A|0;wt=S}else if(ut==="function"){Rt=A|0;var Tt=S;wt=P}else{Rt=A|0,Tt=S;var St=P;wt=Q}else if(ft==="function")wt=A;else if(_t==="function")St=A,wt=S;else if(ut==="function"){St=A;var Gt=S;wt=P}var Nt=C(l,Gt);st!=="string"?typeof Tt=="undefined"&&(Tt=Nt.length):(Rt=0,Tt=Nt.length);var Ht=_(wt);mi.default(function(){try{var qt=Y.writeBase(r,Nt,Rt,Tt,St);st!=="string"?Ht(null,qt,Nt):Ht(null,qt,l)}catch(zt){Ht(zt)}})},b.prototype.writeFileBase=function(r,l,A,S){var P=typeof r=="number";r=P?r:this.openBase(g(r),A,S),S=0;var Q=l.length;A=A&xt?void 0:0;try{for(;0<Q;){var Y=this.writeSync(r,l,S,Q,A);S+=Y,Q-=Y,A!==void 0&&(A+=Y)}}finally{P||this.closeSync(r)}},b.prototype.writeFileSync=function(r,l,A){var S=Ot(A);A=h(S.flag);var P=V(S.mode);l=C(l,S.encoding),this.writeFileBase(r,l,A,P)},b.prototype.writeFile=function(r,l,A,S){var P=A;typeof A=="function"&&(P=Ut,S=A),A=_(S);var Q=Ot(P);P=h(Q.flag),S=V(Q.mode),l=C(l,Q.encoding),this.wrapAsync(this.writeFileBase,[r,l,P,S],A)},b.prototype.linkBase=function(r,l){var A=F(r),S=this.getLink(A);if(!S)throw d("ENOENT","link",r,l);var P=F(l);if(A=this.getLinkParent(P),!A)throw d("ENOENT","link",r,l);if(P=P[P.length-1],A.getChild(P))throw d("EEXIST","link",r,l);r=S.getNode(),r.nlink++,A.createChild(P,r)},b.prototype.copyFileBase=function(r,l,A){var S=this.readFileSync(r);if(A&f&&this.existsSync(l))throw d("EEXIST","copyFile",r,l);if(A&O)throw d("ENOSYS","copyFile",r,l);this.writeFileBase(l,S,J.w,438)},b.prototype.copyFileSync=function(r,l,A){return r=g(r),l=g(l),this.copyFileBase(r,l,(A||0)|0)},b.prototype.copyFile=function(r,l,A,S){if(r=g(r),l=g(l),typeof A=="function")var P=0;else P=A,A=S;_(A),this.wrapAsync(this.copyFileBase,[r,l,P],A)},b.prototype.linkSync=function(r,l){r=g(r),l=g(l),this.linkBase(r,l)},b.prototype.link=function(r,l,A){r=g(r),l=g(l),this.wrapAsync(this.linkBase,[r,l],A)},b.prototype.unlinkBase=function(r){var l=F(r);if(l=this.getLink(l),!l)throw d("ENOENT","unlink",r);if(l.length)throw Error("Dir not empty...");this.deleteLink(l),r=l.getNode(),r.nlink--,0>=r.nlink&&this.deleteNode(r)},b.prototype.unlinkSync=function(r){r=g(r),this.unlinkBase(r)},b.prototype.unlink=function(r,l){r=g(r),this.wrapAsync(this.unlinkBase,[r],l)},b.prototype.symlinkBase=function(r,l){var A=F(l),S=this.getLinkParent(A);if(!S)throw d("ENOENT","symlink",r,l);if(A=A[A.length-1],S.getChild(A))throw d("EEXIST","symlink",r,l);return l=S.createChild(A),l.getNode().makeSymlink(F(r)),l},b.prototype.symlinkSync=function(r,l){r=g(r),l=g(l),this.symlinkBase(r,l)},b.prototype.symlink=function(r,l,A,S){A=_(typeof A=="function"?A:S),r=g(r),l=g(l),this.wrapAsync(this.symlinkBase,[r,l],A)},b.prototype.realpathBase=function(r,l){var A=F(r);if(A=this.getResolvedLink(A),!A)throw d("ENOENT","realpath",r);return Ye.strToEncoding(A.getPath(),l)},b.prototype.realpathSync=function(r,l){return this.realpathBase(g(r),Et(l).encoding)},b.prototype.realpath=function(r,l,A){A=Bt(l,A),l=A[0],A=A[1],r=g(r),this.wrapAsync(this.realpathBase,[r,l.encoding],A)},b.prototype.lstatBase=function(r,l){l===void 0&&(l=!1);var A=this.getLink(F(r));if(!A)throw d("ENOENT","lstat",r);return ui.default.build(A.getNode(),l)},b.prototype.lstatSync=function(r,l){return this.lstatBase(g(r),o(l).bigint)},b.prototype.lstat=function(r,l,A){A=i(l,A),l=A[0],A=A[1],this.wrapAsync(this.lstatBase,[g(r),l.bigint],A)},b.prototype.statBase=function(r,l){l===void 0&&(l=!1);var A=this.getResolvedLink(F(r));if(!A)throw d("ENOENT","stat",r);return ui.default.build(A.getNode(),l)},b.prototype.statSync=function(r,l){return this.statBase(g(r),o(l).bigint)},b.prototype.stat=function(r,l,A){A=i(l,A),l=A[0],A=A[1],this.wrapAsync(this.statBase,[g(r),l.bigint],A)},b.prototype.fstatBase=function(r,l){if(l===void 0&&(l=!1),r=this.getFileByFd(r),!r)throw d("EBADF","fstat");return ui.default.build(r.node,l)},b.prototype.fstatSync=function(r,l){return this.fstatBase(r,o(l).bigint)},b.prototype.fstat=function(r,l,A){l=i(l,A),this.wrapAsync(this.fstatBase,[r,l[0].bigint],l[1])},b.prototype.renameBase=function(r,l){var A=this.getLink(F(r));if(!A)throw d("ENOENT","rename",r,l);var S=F(l),P=this.getLinkParent(S);if(!P)throw d("ENOENT","rename",r,l);(r=A.parent)&&r.deleteChild(A),A.steps=E(P.steps,[S[S.length-1]]),P.setChild(A.getName(),A)},b.prototype.renameSync=function(r,l){r=g(r),l=g(l),this.renameBase(r,l)},b.prototype.rename=function(r,l,A){r=g(r),l=g(l),this.wrapAsync(this.renameBase,[r,l],A)},b.prototype.existsBase=function(r){return!!this.statBase(r)},b.prototype.existsSync=function(r){try{return this.existsBase(g(r))}catch{return!1}},b.prototype.exists=function(r,l){var A=this,S=g(r);if(typeof l!="function")throw Error(I.CB);mi.default(function(){try{l(A.existsBase(S))}catch{l(!1)}})},b.prototype.accessBase=function(r){this.getLinkOrThrow(r,"access")},b.prototype.accessSync=function(r,l){l===void 0&&(l=w),r=g(r),this.accessBase(r,l|0)},b.prototype.access=function(r,l,A){var S=w;typeof l!="function"&&(S=l|0,l=_(A)),r=g(r),this.wrapAsync(this.accessBase,[r,S],l)},b.prototype.appendFileSync=function(r,l,A){A===void 0&&(A=Ft),A=Ct(A),A.flag&&r>>>0!==r||(A.flag="a"),this.writeFileSync(r,l,A)},b.prototype.appendFile=function(r,l,A,S){S=Lt(A,S),A=S[0],S=S[1],A.flag&&r>>>0!==r||(A.flag="a"),this.writeFile(r,l,A,S)},b.prototype.readdirBase=function(r,l){var A=F(r);if(A=this.getResolvedLink(A),!A)throw d("ENOENT","readdir",r);if(!A.getNode().isDirectory())throw d("ENOTDIR","scandir",r);if(l.withFileTypes){var S=[];for(P in A.children)(r=A.getChild(P))&&S.push(Sa.default.build(r,l.encoding));return q||l.encoding==="buffer"||S.sort(function(Q,Y){return Q.name<Y.name?-1:Q.name>Y.name?1:0}),S}var P=[];for(S in A.children)P.push(Ye.strToEncoding(S,l.encoding));return q||l.encoding==="buffer"||P.sort(),P},b.prototype.readdirSync=function(r,l){return l=Wt(l),r=g(r),this.readdirBase(r,l)},b.prototype.readdir=function(r,l,A){A=B(l,A),l=A[0],A=A[1],r=g(r),this.wrapAsync(this.readdirBase,[r,l],A)},b.prototype.readlinkBase=function(r,l){var A=this.getLinkOrThrow(r,"readlink").getNode();if(!A.isSymlink())throw d("EINVAL","readlink",r);return r=p+A.symlink.join(p),Ye.strToEncoding(r,l)},b.prototype.readlinkSync=function(r,l){return l=dt(l),r=g(r),this.readlinkBase(r,l.encoding)},b.prototype.readlink=function(r,l,A){A=lt(l,A),l=A[0],A=A[1],r=g(r),this.wrapAsync(this.readlinkBase,[r,l.encoding],A)},b.prototype.fsyncBase=function(r){this.getFileByFdOrThrow(r,"fsync")},b.prototype.fsyncSync=function(r){this.fsyncBase(r)},b.prototype.fsync=function(r,l){this.wrapAsync(this.fsyncBase,[r],l)},b.prototype.fdatasyncBase=function(r){this.getFileByFdOrThrow(r,"fdatasync")},b.prototype.fdatasyncSync=function(r){this.fdatasyncBase(r)},b.prototype.fdatasync=function(r,l){this.wrapAsync(this.fdatasyncBase,[r],l)},b.prototype.ftruncateBase=function(r,l){this.getFileByFdOrThrow(r,"ftruncate").truncate(l)},b.prototype.ftruncateSync=function(r,l){this.ftruncateBase(r,l)},b.prototype.ftruncate=function(r,l,A){var S=typeof l=="number"?l:0;l=_(typeof l=="number"?A:l),this.wrapAsync(this.ftruncateBase,[r,S],l)},b.prototype.truncateBase=function(r,l){r=this.openSync(r,"r+");try{this.ftruncateSync(r,l)}finally{this.closeSync(r)}},b.prototype.truncateSync=function(r,l){if(r>>>0===r)return this.ftruncateSync(r,l);this.truncateBase(r,l)},b.prototype.truncate=function(r,l,A){var S=typeof l=="number"?l:0;if(l=_(typeof l=="number"?A:l),r>>>0===r)return this.ftruncate(r,S,l);this.wrapAsync(this.truncateBase,[r,S],l)},b.prototype.futimesBase=function(r,l,A){r=this.getFileByFdOrThrow(r,"futimes").node,r.atime=new Date(1e3*l),r.mtime=new Date(1e3*A)},b.prototype.futimesSync=function(r,l,A){this.futimesBase(r,$(l),$(A))},b.prototype.futimes=function(r,l,A,S){this.wrapAsync(this.futimesBase,[r,$(l),$(A)],S)},b.prototype.utimesBase=function(r,l,A){r=this.openSync(r,"r+");try{this.futimesBase(r,l,A)}finally{this.closeSync(r)}},b.prototype.utimesSync=function(r,l,A){this.utimesBase(g(r),$(l),$(A))},b.prototype.utimes=function(r,l,A,S){this.wrapAsync(this.utimesBase,[g(r),$(l),$(A)],S)},b.prototype.mkdirBase=function(r,l){var A=F(r);if(!A.length)throw d("EISDIR","mkdir",r);var S=this.getLinkParentAsDirOrThrow(r,"mkdir");if(A=A[A.length-1],S.getChild(A))throw d("EEXIST","mkdir",r);S.createChild(A,this.createNode(!0,l))},b.prototype.mkdirpBase=function(r,l){r=F(r);for(var A=this.root,S=0;S<r.length;S++){var P=r[S];if(!A.getNode().isDirectory())throw d("ENOTDIR","mkdir",A.getPath());var Q=A.getChild(P);if(Q)if(Q.getNode().isDirectory())A=Q;else throw d("ENOTDIR","mkdir",Q.getPath());else A=A.createChild(P,this.createNode(!0,l))}},b.prototype.mkdirSync=function(r,l){l=a(l);var A=V(l.mode,511);r=g(r),l.recursive?this.mkdirpBase(r,A):this.mkdirBase(r,A)},b.prototype.mkdir=function(r,l,A){var S=a(l);l=_(typeof l=="function"?l:A),A=V(S.mode,511),r=g(r),S.recursive?this.wrapAsync(this.mkdirpBase,[r,A],l):this.wrapAsync(this.mkdirBase,[r,A],l)},b.prototype.mkdirpSync=function(r,l){this.mkdirSync(r,{mode:l,recursive:!0})},b.prototype.mkdirp=function(r,l,A){var S=typeof l=="function"?void 0:l;l=_(typeof l=="function"?l:A),this.mkdir(r,{mode:S,recursive:!0},l)},b.prototype.mkdtempBase=function(r,l,A){A===void 0&&(A=5);var S=r+this.genRndStr();try{return this.mkdirBase(S,511),Ye.strToEncoding(S,l)}catch(P){if(P.code==="EEXIST"){if(1<A)return this.mkdtempBase(r,l,A-1);throw Error("Could not create temp dir.")}throw P}},b.prototype.mkdtempSync=function(r,l){if(l=dt(l).encoding,!r||typeof r!="string")throw new TypeError("filename prefix is required");return x(r),this.mkdtempBase(r,l)},b.prototype.mkdtemp=function(r,l,A){if(A=lt(l,A),l=A[0].encoding,A=A[1],!r||typeof r!="string")throw new TypeError("filename prefix is required");x(r)&&this.wrapAsync(this.mkdtempBase,[r,l],A)},b.prototype.rmdirBase=function(r,l){l=z({},vt,l);var A=this.getLinkAsDirOrThrow(r,"rmdir");if(A.length&&!l.recursive)throw d("ENOTEMPTY","rmdir",r);this.deleteLink(A)},b.prototype.rmdirSync=function(r,l){this.rmdirBase(g(r),l)},b.prototype.rmdir=function(r,l,A){var S=z({},vt,l);l=_(typeof l=="function"?l:A),this.wrapAsync(this.rmdirBase,[g(r),S],l)},b.prototype.fchmodBase=function(r,l){this.getFileByFdOrThrow(r,"fchmod").chmod(l)},b.prototype.fchmodSync=function(r,l){this.fchmodBase(r,V(l))},b.prototype.fchmod=function(r,l,A){this.wrapAsync(this.fchmodBase,[r,V(l)],A)},b.prototype.chmodBase=function(r,l){r=this.openSync(r,"r+");try{this.fchmodBase(r,l)}finally{this.closeSync(r)}},b.prototype.chmodSync=function(r,l){l=V(l),r=g(r),this.chmodBase(r,l)},b.prototype.chmod=function(r,l,A){l=V(l),r=g(r),this.wrapAsync(this.chmodBase,[r,l],A)},b.prototype.lchmodBase=function(r,l){r=this.openBase(r,Z,0,!1);try{this.fchmodBase(r,l)}finally{this.closeSync(r)}},b.prototype.lchmodSync=function(r,l){l=V(l),r=g(r),this.lchmodBase(r,l)},b.prototype.lchmod=function(r,l,A){l=V(l),r=g(r),this.wrapAsync(this.lchmodBase,[r,l],A)},b.prototype.fchownBase=function(r,l,A){this.getFileByFdOrThrow(r,"fchown").chown(l,A)},b.prototype.fchownSync=function(r,l,A){v(l),m(A),this.fchownBase(r,l,A)},b.prototype.fchown=function(r,l,A,S){v(l),m(A),this.wrapAsync(this.fchownBase,[r,l,A],S)},b.prototype.chownBase=function(r,l,A){this.getResolvedLinkOrThrow(r,"chown").getNode().chown(l,A)},b.prototype.chownSync=function(r,l,A){v(l),m(A),this.chownBase(g(r),l,A)},b.prototype.chown=function(r,l,A,S){v(l),m(A),this.wrapAsync(this.chownBase,[g(r),l,A],S)},b.prototype.lchownBase=function(r,l,A){this.getLinkOrThrow(r,"lchown").getNode().chown(l,A)},b.prototype.lchownSync=function(r,l,A){v(l),m(A),this.lchownBase(g(r),l,A)},b.prototype.lchown=function(r,l,A,S){v(l),m(A),this.wrapAsync(this.lchownBase,[g(r),l,A],S)},b.prototype.watchFile=function(r,l,A){r=g(r);var S=l;if(typeof S=="function"&&(A=l,S=null),typeof A!="function")throw Error('"watchFile()" requires a listener function');l=5007;var P=!0;return S&&typeof S=="object"&&(typeof S.interval=="number"&&(l=S.interval),typeof S.persistent=="boolean"&&(P=S.persistent)),S=this.statWatchers[r],S||(S=new this.StatWatcher,S.start(r,P,l),this.statWatchers[r]=S),S.addListener("change",A),S},b.prototype.unwatchFile=function(r,l){r=g(r);var A=this.statWatchers[r];A&&(typeof l=="function"?A.removeListener("change",l):A.removeAllListeners("change"),A.listenerCount("change")===0&&(A.stop(),delete this.statWatchers[r]))},b.prototype.createReadStream=function(r,l){return new this.ReadStream(r,l)},b.prototype.createWriteStream=function(r,l){return new this.WriteStream(r,l)},b.prototype.watch=function(r,l,A){r=g(r);var S=l;typeof l=="function"&&(A=l,S=null);var P=dt(S);l=P.persistent,S=P.recursive,P=P.encoding,l===void 0&&(l=!0),S===void 0&&(S=!1);var Q=new this.FSWatcher;return Q.start(r,l,S,P),A&&Q.addListener("change",A),Q},b.fd=2147483647,b}(),t.Volume=e;var rt=function(b){function r(l){var A=b.call(this)||this;return A.onInterval=function(){try{var S=A.vol.statSync(A.filename);A.hasChanged(S)&&(A.emit("change",S,A.prev),A.prev=S)}finally{A.loop()}},A.vol=l,A}return R(r,b),r.prototype.loop=function(){this.timeoutRef=this.setTimeout(this.onInterval,this.interval)},r.prototype.hasChanged=function(l){return l.mtimeMs>this.prev.mtimeMs||l.nlink!==this.prev.nlink},r.prototype.start=function(l,A,S){A===void 0&&(A=!0),S===void 0&&(S=5007),this.filename=g(l),this.setTimeout=A?setTimeout:Cc.default,this.interval=S,this.prev=this.vol.statSync(this.filename),this.loop()},r.prototype.stop=function(){clearTimeout(this.timeoutRef),Be.default.nextTick(y,this)},r}(Vt.EventEmitter);t.StatWatcher=rt;var et;Gi.inherits(G,ke.Readable),t.ReadStream=G,G.prototype.open=function(){var b=this;this._vol.open(this.path,this.flags,this.mode,function(r,l){r?(b.autoClose&&b.destroy&&b.destroy(),b.emit("error",r)):(b.fd=l,b.emit("open",l),b.read())})},G.prototype._read=function(b){if(typeof this.fd!="number")return this.once("open",function(){this._read(b)});if(!this.destroyed){(!et||128>et.length-et.used)&&(et=ee.bufferAllocUnsafe(this._readableState.highWaterMark),et.used=0);var r=et,l=Math.min(et.length-et.used,b),A=et.used;if(this.pos!==void 0&&(l=Math.min(this.end-this.pos+1,l)),0>=l)return this.push(null);var S=this;this._vol.read(this.fd,et,et.used,l,this.pos,function(P,Q){P?(S.autoClose&&S.destroy&&S.destroy(),S.emit("error",P)):(P=null,0<Q&&(S.bytesRead+=Q,P=r.slice(A,A+Q)),S.push(P))}),this.pos!==void 0&&(this.pos+=l),et.used+=l}},G.prototype._destroy=function(b,r){this.close(function(l){r(b||l)})},G.prototype.close=function(b){var r=this;if(b&&this.once("close",b),this.closed||typeof this.fd!="number"){if(typeof this.fd!="number"){this.once("open",k);return}return Be.default.nextTick(function(){return r.emit("close")})}this.closed=!0,this._vol.close(this.fd,function(l){l?r.emit("error",l):r.emit("close")}),this.fd=null},Gi.inherits(N,ke.Writable),t.WriteStream=N,N.prototype.open=function(){this._vol.open(this.path,this.flags,this.mode,function(b,r){b?(this.autoClose&&this.destroy&&this.destroy(),this.emit("error",b)):(this.fd=r,this.emit("open",r))}.bind(this))},N.prototype._write=function(b,r,l){if(!(b instanceof ee.Buffer))return this.emit("error",Error("Invalid data"));if(typeof this.fd!="number")return this.once("open",function(){this._write(b,r,l)});var A=this;this._vol.write(this.fd,b,0,b.length,this.pos,function(S,P){if(S)return A.autoClose&&A.destroy&&A.destroy(),l(S);A.bytesWritten+=P,l()}),this.pos!==void 0&&(this.pos+=b.length)},N.prototype._writev=function(b,r){if(typeof this.fd!="number")return this.once("open",function(){this._writev(b,r)});for(var l=this,A=b.length,S=Array(A),P=0,Q=0;Q<A;Q++){var Y=b[Q].chunk;S[Q]=Y,P+=Y.length}A=ee.Buffer.concat(S),this._vol.write(this.fd,A,0,A.length,this.pos,function(st,ft){if(st)return l.destroy&&l.destroy(),r(st);l.bytesWritten+=ft,r()}),this.pos!==void 0&&(this.pos+=P)},N.prototype._destroy=G.prototype._destroy,N.prototype.close=G.prototype.close,N.prototype.destroySoon=N.prototype.end;var ct=function(b){function r(l){var A=b.call(this)||this;return A._filename="",A._filenameEncoded="",A._recursive=!1,A._encoding=Ye.ENCODING_UTF8,A._onNodeChange=function(){A._emit("change")},A._onParentChild=function(S){S.getName()===A._getName()&&A._emit("rename")},A._emit=function(S){A.emit("change",S,A._filenameEncoded)},A._persist=function(){A._timer=setTimeout(A._persist,1e6)},A._vol=l,A}return R(r,b),r.prototype._getName=function(){return this._steps[this._steps.length-1]},r.prototype.start=function(l,A,S,P){A===void 0&&(A=!0),S===void 0&&(S=!1),P===void 0&&(P=Ye.ENCODING_UTF8),this._filename=g(l),this._steps=F(this._filename),this._filenameEncoded=Ye.strToEncoding(this._filename),this._recursive=S,this._encoding=P;try{this._link=this._vol.getLinkOrThrow(this._filename,"FSWatcher")}catch(Q){throw A=Error("watch "+this._filename+" "+Q.code),A.code=Q.code,A.errno=Q.code,A}this._link.getNode().on("change",this._onNodeChange),this._link.on("child:add",this._onNodeChange),this._link.on("child:delete",this._onNodeChange),(l=this._link.parent)&&(l.setMaxListeners(l.getMaxListeners()+1),l.on("child:delete",this._onParentChild)),A&&this._persist()},r.prototype.close=function(){clearTimeout(this._timer),this._link.getNode().removeListener("change",this._onNodeChange);var l=this._link.parent;l&&l.removeListener("child:delete",this._onParentChild)},r}(Vt.EventEmitter);t.FSWatcher=ct});Se(Zn);var xh=Zn.pathToFilename,Oh=Zn.filenameToSteps,Zc=Zn.Volume,Wa=be(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fsProps="constants F_OK R_OK W_OK X_OK Stats".split(" "),t.fsSyncMethods="renameSync ftruncateSync truncateSync chownSync fchownSync lchownSync chmodSync fchmodSync lchmodSync statSync lstatSync fstatSync linkSync symlinkSync readlinkSync realpathSync unlinkSync rmdirSync mkdirSync mkdirpSync readdirSync closeSync openSync utimesSync futimesSync fsyncSync writeSync readSync readFileSync writeFileSync appendFileSync existsSync accessSync fdatasyncSync mkdtempSync copyFileSync createReadStream createWriteStream".split(" "),t.fsAsyncMethods="rename ftruncate truncate chown fchown lchown chmod fchmod lchmod stat lstat fstat link symlink readlink realpath unlink rmdir mkdir mkdirp readdir close open utimes futimes fsync write read readFile writeFile appendFile exists access fdatasync mkdtemp copyFile watchFile unwatchFile watch".split(" ")});Se(Wa);var Jc=be(function(e,t){function n(s){for(var _={F_OK:c,R_OK:d,W_OK:h,X_OK:u,constants:jt.constants,Stats:ui.default,Dirent:Sa.default},L=0,g=o;L<g.length;L++){var F=g[L];typeof s[F]=="function"&&(_[F]=s[F].bind(s))}for(L=0,g=a;L<g.length;L++)F=g[L],typeof s[F]=="function"&&(_[F]=s[F].bind(s));return _.StatWatcher=s.StatWatcher,_.FSWatcher=s.FSWatcher,_.WriteStream=s.WriteStream,_.ReadStream=s.ReadStream,_.promises=s.promises,_._toUnixTimestamp=Zn.toUnixTimestamp,_}var i=ce&&ce.__assign||function(){return i=Object.assign||function(s){for(var _,L=1,g=arguments.length;L<g;L++){_=arguments[L];for(var F in _)Object.prototype.hasOwnProperty.call(_,F)&&(s[F]=_[F])}return s},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=Wa.fsSyncMethods,a=Wa.fsAsyncMethods,c=jt.constants.F_OK,d=jt.constants.R_OK,h=jt.constants.W_OK,u=jt.constants.X_OK;t.Volume=Zn.Volume,t.vol=new Zn.Volume,t.createFsFromVolume=n,t.fs=n(t.vol),e.exports=i(i({},e.exports),t.fs),e.exports.semantic=!0});Se(Jc);var Xc=Jc.createFsFromVolume;Vf.prototype.emit=function(e){for(var t,n,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];o=this.listeners(e);try{for(var a=fa(o),c=a.next();!c.done;c=a.next()){var d=c.value;try{d.apply(void 0,yf(i))}catch(h){console.error(h)}}}catch(h){t={error:h}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return 0<o.length};var Th=function(){function e(){this.volume=new Zc,this.fs=Xc(this.volume),this.fromJSON({"/dev/stdin":"","/dev/stdout":"","/dev/stderr":""})}return e.prototype._toJSON=function(t,n,i){n===void 0&&(n={});var o=!0,a;for(a in t.children){o=!1;var c=t.getChild(a);if(c){var d=c.getNode();d&&d.isFile()?(c=c.getPath(),i&&(c=Oa(i,c)),n[c]=d.getBuffer()):d&&d.isDirectory()&&this._toJSON(c,n,i)}}return t=t.getPath(),i&&(t=Oa(i,t)),t&&o&&(n[t]=null),n},e.prototype.toJSON=function(t,n,i){var o,a;n===void 0&&(n={}),i===void 0&&(i=!1);var c=[];if(t){t instanceof Array||(t=[t]);try{for(var d=fa(t),h=d.next();!h.done;h=d.next()){var u=xh(h.value),s=this.volume.getResolvedLink(u);s&&c.push(s)}}catch(T){var _={error:T}}finally{try{h&&!h.done&&(o=d.return)&&o.call(d)}finally{if(_)throw _.error}}}else c.push(this.volume.root);if(!c.length)return n;try{for(var L=fa(c),g=L.next();!g.done;g=L.next())s=g.value,this._toJSON(s,n,i?s.getPath():"")}catch(T){var F={error:T}}finally{try{g&&!g.done&&(a=L.return)&&a.call(L)}finally{if(F)throw F.error}}return n},e.prototype.fromJSONFixed=function(t,n){for(var i in n){var o=n[i];if(o?Object.getPrototypeOf(o)!==null:o!==null){var a=Oh(i);1<a.length&&(a="/"+a.slice(0,a.length-1).join("/"),t.mkdirpBase(a,511)),t.writeFileSync(i,o||"")}else t.mkdirpBase(i,511)}},e.prototype.fromJSON=function(t){this.volume=new Zc,this.fromJSONFixed(this.volume,t),this.fs=Xc(this.volume),this.volume.releasedFds=[0,1,2],t=this.volume.openSync("/dev/stderr","w");var n=this.volume.openSync("/dev/stdout","w"),i=this.volume.openSync("/dev/stdin","r");if(t!==2)throw Error("invalid handle for stderr: "+t);if(n!==1)throw Error("invalid handle for stdout: "+n);if(i!==0)throw Error("invalid handle for stdin: "+i)},e.prototype.getStdOut=function(){return _f(this,void 0,void 0,function(){var t,n=this;return mf(this,function(){return t=new Promise(function(i){i(n.fs.readFileSync("/dev/stdout","utf8"))}),[2,t]})})},e}();function tl(e){return e.arrayBuffer?e.arrayBuffer():new Promise((t,n)=>{const i=new FileReader;i.addEventListener("loadend",()=>{t(i.result)}),i.addEventListener("error",n),i.readAsArrayBuffer(e)})}async function Ph(e){const t=await tl(e);return new Uint8Array(t)}function el(e){return typeof Blob!="undefined"&&e instanceof Blob}function Wi(e){return typeof SharedArrayBuffer!="undefined"&&e instanceof SharedArrayBuffer}const Rh=typeof process!="undefined"&&process.versions&&typeof process.versions.node!="undefined"&&typeof process.versions.electron=="undefined";function Uh(e){return e.byteOffset===0&&e.byteLength===e.buffer.byteLength}class nl{constructor(t){this.typedArray=t instanceof ArrayBuffer||Wi(t)?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}async getLength(){return this.typedArray.byteLength}async read(t,n){return new Uint8Array(this.typedArray.buffer,this.typedArray.byteOffset+t,n)}}class il{constructor(t){this.blob=t}async getLength(){return this.blob.size}async read(t,n){const i=this.blob.slice(t,t+n),o=await tl(i);return new Uint8Array(o)}async sliceAsBlob(t,n,i=""){return this.blob.slice(t,t+n,i)}}function Mh(e,t){var n=Uint8Array;if(e[0]==3&&e[1]==0)return t||new n(0);var i=Nh,o=rl,a=Gh,c=sl,d=t==null;d&&(t=new n(e.length>>>2<<3));for(var h=0,u=0,s=0,_=0,L=0,g=0,F=0,T=0,C=0,U,x;h==0;){if(h=i(e,C,1),u=i(e,C+1,2),C+=3,u==0){(C&7)!=0&&(C+=8-(C&7));var V=(C>>>3)+4,D=e[V-4]|e[V-3]<<8;d&&(t=$a(t,T+D)),t.set(new n(e.buffer,e.byteOffset+V,D),T),C=V+D<<3,T+=D;continue}if(d&&(t=$a(t,T+(1<<17))),u==1&&(U=kt.flmap,x=kt.fdmap,g=(1<<9)-1,F=(1<<5)-1),u==2){s=o(e,C,5)+257,_=o(e,C+5,5)+1,L=o(e,C+10,4)+4,C+=14;for(var $=0;$<38;$+=2)kt.itree[$]=0,kt.itree[$+1]=0;for(var v=1,$=0;$<L;$++){var m=o(e,C+$*3,3);kt.itree[(kt.ordr[$]<<1)+1]=m,m>v&&(v=m)}C+=3*L,$i(kt.itree,v),Hi(kt.itree,v,kt.imap),U=kt.lmap,x=kt.dmap,C=a(kt.imap,(1<<v)-1,s+_,e,C,kt.ttree);var y=ol(kt.ttree,0,s,kt.ltree);g=(1<<y)-1;var G=ol(kt.ttree,s,_,kt.dtree);F=(1<<G)-1,$i(kt.ltree,y),Hi(kt.ltree,y,U),$i(kt.dtree,G),Hi(kt.dtree,G,x)}for(;;){var k=U[c(e,C)&g];C+=k&15;var N=k>>>4;if(N>>>8==0)t[T++]=N;else{if(N==256)break;var R=T+N-254;if(N>264){var E=kt.ldef[N-257];R=T+(E>>>3)+o(e,C,E&7),C+=E&7}var z=x[c(e,C)&F];C+=z&15;var tt=z>>>4,at=kt.ddef[tt],it=(at>>>4)+i(e,C,at&15);for(C+=at&15,d&&(t=$a(t,T+(1<<17)));T<R;)t[T]=t[T++-it],t[T]=t[T++-it],t[T]=t[T++-it],t[T]=t[T++-it];T=R}}}return t.length==T?t:t.slice(0,T)}function $a(e,t){var n=e.length;if(t<=n)return e;var i=new Uint8Array(Math.max(n<<1,t));return i.set(e,0),i}function Gh(e,t,n,i,o,a){for(var c=rl,d=sl,h=0;h<n;){var u=e[d(i,o)&t];o+=u&15;var s=u>>>4;if(s<=15)a[h]=s,h++;else{var _=0,L=0;s==16?(L=3+c(i,o,2),o+=2,_=a[h-1]):s==17?(L=3+c(i,o,3),o+=3):s==18&&(L=11+c(i,o,7),o+=7);for(var g=h+L;h<g;)a[h]=_,h++}}return o}function ol(e,t,n,i){for(var o=0,a=0,c=i.length>>>1;a<n;){var d=e[a+t];i[a<<1]=0,i[(a<<1)+1]=d,d>o&&(o=d),a++}for(;a<c;)i[a<<1]=0,i[(a<<1)+1]=0,a++;return o}function $i(e,t){for(var n=e.length,i,o,a,c,d,h=kt.bl_count,c=0;c<=t;c++)h[c]=0;for(c=1;c<n;c+=2)h[e[c]]++;var u=kt.next_code;for(i=0,h[0]=0,o=1;o<=t;o++)i=i+h[o-1]<<1,u[o]=i;for(a=0;a<n;a+=2)d=e[a+1],d!=0&&(e[a]=u[d],u[d]++)}function Hi(e,t,n){for(var i=e.length,o=kt.rev15,a=0;a<i;a+=2)if(e[a+1]!=0)for(var c=a>>1,d=e[a+1],h=c<<4|d,u=t-d,s=e[a]<<u,_=s+(1<<u);s!=_;){var L=o[s]>>>15-t;n[L]=h,s++}}function al(e,t){for(var n=kt.rev15,i=15-t,o=0;o<e.length;o+=2){var a=e[o]<<t-e[o+1];e[o]=n[a]>>>i}}function rl(e,t,n){return(e[t>>>3]|e[(t>>>3)+1]<<8)>>>(t&7)&(1<<n)-1}function Nh(e,t,n){return(e[t>>>3]|e[(t>>>3)+1]<<8|e[(t>>>3)+2]<<16)>>>(t&7)&(1<<n)-1}function sl(e,t){return(e[t>>>3]|e[(t>>>3)+1]<<8|e[(t>>>3)+2]<<16)>>>(t&7)}const kt=function(){var e=Uint16Array,t=Uint32Array;return{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new t(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(1<<15),lhst:new t(286),dhst:new t(30),ihst:new t(19),lits:new t(15e3),strt:new e(1<<16),prev:new e(1<<15)}}();(function(){for(var e=1<<15,t=0;t<e;t++){var n=t;n=(n&2863311530)>>>1|(n&1431655765)<<1,n=(n&3435973836)>>>2|(n&858993459)<<2,n=(n&4042322160)>>>4|(n&252645135)<<4,n=(n&4278255360)>>>8|(n&16711935)<<8,kt.rev15[t]=(n>>>16|n<<16)>>>17}function i(o,a,c){for(;a--!=0;)o.push(0,c)}for(var t=0;t<32;t++)kt.ldef[t]=kt.of0[t]<<3|kt.exb[t],kt.ddef[t]=kt.df0[t]<<4|kt.dxb[t];i(kt.fltree,144,8),i(kt.fltree,255-143,9),i(kt.fltree,279-255,7),i(kt.fltree,287-279,8),$i(kt.fltree,9),Hi(kt.fltree,9,kt.flmap),al(kt.fltree,9),i(kt.fdtree,32,5),$i(kt.fdtree,5),Hi(kt.fdtree,5,kt.fdmap),al(kt.fdtree,5),i(kt.itree,19,0),i(kt.ltree,286,0),i(kt.dtree,30,0),i(kt.ttree,320,0)})();const cl={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var n=t,i=0;i<8;i++)n&1?n=3988292384^n>>>1:n=n>>>1;e[t]=n}return e}(),update:function(e,t,n,i){for(var o=0;o<i;o++)e=cl.table[(e^t[n+o])&255]^e>>>8;return e},crc:function(e,t,n){return cl.update(4294967295,e,t,n)^4294967295}};function qh(e,t){return Mh(e,t)}const ll={numWorkers:1,workerURL:"",useWorkers:!1};let zh=0;const xo=[];function Ha(e){return new Promise((t,n)=>{const i=new Worker(e);i.onmessage=o=>{o.data==="start"?(i.onerror=void 0,i.onmessage=void 0,t(i)):n(new Error(`unexpected message: ${o.data}`))},i.onerror=n})}function Dh(e,t){return e.require(t)}(function(){if(Rh){const{Worker:e}=Dh(module,"worker_threads");return{async createWorker(t){return new e(t)},addEventListener(t,n){t.on("message",i=>{n({target:t,data:i})})},async terminate(t){await t.terminate()}}}else return{async createWorker(e){try{return await Ha(e)}catch{console.warn("could not load worker:",e)}let t;try{const n=await fetch(e,{mode:"cors"});if(!n.ok)throw new Error(`could not load: ${e}`);t=await n.text(),e=URL.createObjectURL(new Blob([t],{type:"application/javascript"}));const i=await Ha(e);return ll.workerURL=e,i}catch{console.warn("could not load worker via fetch:",e)}if(t!==void 0)try{e=`data:application/javascript;base64,${btoa(t)}`;const n=await Ha(e);return ll.workerURL=e,n}catch{console.warn("could not load worker via dataURI")}throw console.warn("workers will not be used"),new Error("can not start workers")},addEventListener(e,t){e.addEventListener("message",t)},async terminate(e){e.terminate()}}})();function kh(e,t,n,i){const o=new Uint8Array(t);qh(e,o),i(n?new Blob([o],{type:n}):o.buffer)}async function Qh(){if(xo.length!==0)for(;xo.length;){const{src:e,uncompressedSize:t,type:n,resolve:i}=xo.shift();let o=e;el(e)&&(o=await Ph(e)),kh(o,t,n,i)}}function ul(e,t,n){return new Promise((i,o)=>{xo.push({src:e,uncompressedSize:t,type:n,resolve:i,reject:o,id:zh++}),Qh()})}function Wh(e,t){const n=e&31,i=(e>>5&15)-1,o=(e>>9&127)+1980,a=0,c=(t&31)*2,d=t>>5&63,h=t>>11&31;return new Date(o,i,n,h,d,c,a)}class $h{constructor(t,n){this._reader=t,this._rawEntry=n,this.name=n.name,this.nameBytes=n.nameBytes,this.size=n.uncompressedSize,this.compressedSize=n.compressedSize,this.comment=n.comment,this.commentBytes=n.commentBytes,this.compressionMethod=n.compressionMethod,this.lastModDate=Wh(n.lastModFileDate,n.lastModFileTime),this.isDirectory=n.uncompressedSize===0&&n.name.endsWith("/"),this.encrypted=!!(n.generalPurposeBitFlag&1),this.externalFileAttributes=n.externalFileAttributes,this.versionMadeBy=n.versionMadeBy}async blob(t="application/octet-stream"){return await n2(this._reader,this._rawEntry,t)}async arrayBuffer(){return await e2(this._reader,this._rawEntry)}async text(){const t=await this.arrayBuffer();return ji(new Uint8Array(t))}async json(){const t=await this.text();return JSON.parse(t)}}const ja=22,Hh=65535,jh=101010256,Vh=101075792;async function Ai(e,t,n){return await e.read(t,n)}async function Va(e,t,n,i){return e.sliceAsBlob?await e.sliceAsBlob(t,n,i):await e.read(t,n)}const Kh={unsigned(){return 0}};function ye(e,t){return e[t]+e[t+1]*256}function xe(e,t){return e[t]+e[t+1]*256+e[t+2]*65536+e[t+3]*16777216}function Jn(e,t){return xe(e,t)+xe(e,t+4)*4294967296}const Yh=new TextDecoder;function ji(e,t){return Wi(e.buffer)&&(e=new Uint8Array(e)),Yh.decode(e)}async function Zh(e,t){const n=Math.min(ja+Hh,t),i=t-n,o=await Ai(e,i,n);for(let a=n-ja;a>=0;--a){if(xe(o,a)!==jh)continue;const c=new Uint8Array(o.buffer,o.byteOffset+a,o.byteLength-a),d=ye(c,4);if(d!==0)throw new Error(`multi-volume zip files are not supported. This is volume: ${d}`);const h=ye(c,10),u=xe(c,12),s=xe(c,16),_=ye(c,20),L=c.length-ja;if(_!==L)throw new Error(`invalid comment length. expected: ${L}, actual: ${_}`);const g=new Uint8Array(c.buffer,c.byteOffset+22,_),F=ji(g);return h===65535||s===4294967295?await Xh(e,i+a,F,g):await dl(e,s,u,h,F,g)}throw new Error("could not find end of central directory. maybe not zip file")}const Jh=117853008;async function Xh(e,t,n,i){const o=t-20,a=await Ai(e,o,20);if(xe(a,0)!==Jh)throw new Error("invalid zip64 end of central directory locator signature");const c=Jn(a,8),d=await Ai(e,c,56);if(xe(d,0)!==Vh)throw new Error("invalid zip64 end of central directory record signature");const h=Jn(d,32),u=Jn(d,40),s=Jn(d,48);return dl(e,s,u,h,n,i)}const t2=33639248;async function dl(e,t,n,i,o,a){let c=0;const d=await Ai(e,t,n),h=[];for(let s=0;s<i;++s){const _=d.subarray(c,c+46),L=xe(_,0);if(L!==t2)throw new Error(`invalid central directory file header signature: 0x${L.toString(16)}`);const g={versionMadeBy:ye(_,4),versionNeededToExtract:ye(_,6),generalPurposeBitFlag:ye(_,8),compressionMethod:ye(_,10),lastModFileTime:ye(_,12),lastModFileDate:ye(_,14),crc32:xe(_,16),compressedSize:xe(_,20),uncompressedSize:xe(_,24),fileNameLength:ye(_,28),extraFieldLength:ye(_,30),fileCommentLength:ye(_,32),internalFileAttributes:ye(_,36),externalFileAttributes:xe(_,38),relativeOffsetOfLocalHeader:xe(_,42)};if(g.generalPurposeBitFlag&64)throw new Error("strong encryption is not supported");c+=46;const F=d.subarray(c,c+g.fileNameLength+g.extraFieldLength+g.fileCommentLength);g.nameBytes=F.slice(0,g.fileNameLength),g.name=ji(g.nameBytes);const T=g.fileNameLength+g.extraFieldLength,C=F.slice(g.fileNameLength,T);g.extraFields=[];let U=0;for(;U<C.length-3;){const V=ye(C,U+0),D=ye(C,U+2),$=U+4,v=$+D;if(v>C.length)throw new Error("extra field length exceeds extra field buffer size");g.extraFields.push({id:V,data:C.slice($,v)}),U=v}if(g.commentBytes=F.slice(T,T+g.fileCommentLength),g.comment=ji(g.commentBytes),c+=F.length,g.uncompressedSize===4294967295||g.compressedSize===4294967295||g.relativeOffsetOfLocalHeader===4294967295){const V=g.extraFields.find(v=>v.id===1);if(!V)throw new Error("expected zip64 extended information extra field");const D=V.data;let $=0;if(g.uncompressedSize===4294967295){if($+8>D.length)throw new Error("zip64 extended information extra field does not include uncompressed size");g.uncompressedSize=Jn(D,$),$+=8}if(g.compressedSize===4294967295){if($+8>D.length)throw new Error("zip64 extended information extra field does not include compressed size");g.compressedSize=Jn(D,$),$+=8}if(g.relativeOffsetOfLocalHeader===4294967295){if($+8>D.length)throw new Error("zip64 extended information extra field does not include relative header offset");g.relativeOffsetOfLocalHeader=Jn(D,$),$+=8}}const x=g.extraFields.find(V=>V.id===28789&&V.data.length>=6&&V.data[0]===1&&xe(V.data,1),Kh.unsigned(g.nameBytes));if(x&&(g.fileName=ji(x.data.slice(5))),g.compressionMethod===0){let V=g.uncompressedSize;if((g.generalPurposeBitFlag&1)!=0&&(V+=12),g.compressedSize!==V)throw new Error(`compressed size mismatch for stored file: ${g.compressedSize} != ${V}`)}h.push(g)}return{zip:{comment:o,commentBytes:a},entries:h.map(s=>new $h(e,s))}}async function fl(e,t){if(t.generalPurposeBitFlag&1)throw new Error("encrypted entries not supported");const n=await Ai(e,t.relativeOffsetOfLocalHeader,30),i=await e.getLength(),o=xe(n,0);if(o!==67324752)throw new Error(`invalid local file header signature: 0x${o.toString(16)}`);const a=ye(n,26),c=ye(n,28),d=t.relativeOffsetOfLocalHeader+n.length+a+c;let h;if(t.compressionMethod===0)h=!1;else if(t.compressionMethod===8)h=!0;else throw new Error(`unsupported compression method: ${t.compressionMethod}`);const u=d,s=u+t.compressedSize;if(t.compressedSize!==0&&s>i)throw new Error(`file data overflows file bounds: ${u} +  ${t.compressedSize}  > ${i}`);return{decompress:h,fileDataStart:u}}async function e2(e,t){const{decompress:n,fileDataStart:i}=await fl(e,t);if(!n){const c=await Ai(e,i,t.compressedSize);return Uh(c)?c.buffer:c.slice().buffer}const o=await Va(e,i,t.compressedSize);return await ul(o,t.uncompressedSize)}async function n2(e,t,n){const{decompress:i,fileDataStart:o}=await fl(e,t);if(!i){const d=await Va(e,o,t.compressedSize,n);return el(d)?d:new Blob([Wi(d.buffer)?new Uint8Array(d):d],{type:n})}const a=await Va(e,o,t.compressedSize);return await ul(a,t.uncompressedSize,n)}async function i2(e){let t;if(typeof Blob!="undefined"&&e instanceof Blob)t=new il(e);else if(e instanceof ArrayBuffer||e&&e.buffer&&e.buffer instanceof ArrayBuffer)t=new nl(e);else if(Wi(e)||Wi(e.buffer))t=new nl(e);else if(typeof e=="string"){const i=await fetch(e);if(!i.ok)throw new Error(`failed http request ${e}, status: ${i.status}: ${i.statusText}`);const o=await i.blob();t=new il(o)}else if(typeof e.getLength=="function"&&typeof e.read=="function")t=e;else throw new Error("unsupported source type");const n=await t.getLength();if(n>Number.MAX_SAFE_INTEGER)throw new Error(`file too large. size: ${n}. Only file sizes up 4503599627370496 bytes are supported`);return await Zh(t,n)}async function o2(e){const{zip:t,entries:n}=await i2(e);return{zip:t,entries:Object.fromEntries(n.map(i=>[i.name,i]))}}var a2="circomlib.acbc52cb.zip",r2="circom.c3210d00.wasm";globalThis.process={cwd(){return""}},globalThis.Buffer=bt;const s2=Math.floor((Date.now()-performance.now())*.001);function c2(){let e=performance.now()*.001,t=Math.floor(e)+s2,n=Math.floor(e%1*1e9);return t*1e9+n}function l2(e,t,n){if(e instanceof Uint8Array)for(let i=t;i<t+n;i++)e[i]=Math.floor(Math.random()*256);return e}const u2={hrtime:c2,exit:e=>{throw new df(e)},kill:e=>{throw new ff(e)},randomFillSync:l2,isTTY:()=>!0,path:pf,fs:null};async function d2(e){const t=await fetch(e),n=t.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&n.startsWith("application/wasm"))return await WebAssembly.compileStreaming(t);{const i=await t.arrayBuffer();return await WebAssembly.compile(i)}}async function f2(){const e=new Th,{entries:t}=await o2(a2);for(const[n,i]of Object.entries(t)){const o=await t[n].arrayBuffer();e.fs.writeFileSync(n.replace("circomlib-master/circuits/","circomlib/"),new Uint8Array(o)),e.fs.writeFileSync(n.replace("circomlib-master/circuits/","circomlib/circuits/"),new Uint8Array(o))}return e}const Vi=f2();function hl(e){return e.replace(/(include\s+")([^"]+)"/g,(t,n,i)=>i.startsWith("gist:")?n+i.replace("gist:","external/https/gist.github.com/")+'"':t.replace(/(include\s+")(\w+):\/\//,"$1external/$2/"))}async function h2(e="main.circom",t={nosym:!1,nowasm:!1,nor1cs:!1}){const n=await Vi;let i=10*1024*1024,o=new Uint8Array(i),a=-1,c=0,d=0,h;const u=ss(ta({},n.fs),{realpathSync(_){const L=_.replace(/.*circomlib\//,"circomlib/");return _.includes("circomlib/")&&n.fs.existsSync(L)?L:(_.startsWith("external/")&&!n.fs.existsSync(_)&&(h=_),n.fs.realpathSync(_))},writeSync(_,L,g,F,T){return a===_&&c+F<i&&T===d+c?(o.set(L,c),c+=F,F):(a>=0&&n.fs.writeSync(a,o,0,c,d),a=_,c=0,o.set(L,c),c+=F,d=T,F)},closeSync(_){if(a>=0&&(n.fs.writeSync(a,o,0,c,d),a=-1,c=0,d=0),_>=0)return n.fs.closeSync(_)}}),s=await d2(r2);for(;;){let _=new hf({args:["circom2",e,!t.nor1cs&&"--r1cs",!t.nowasm&&"--wasm",!t.nosym&&"--sym"].filter(g=>g!==!1),env:{RUST_BACKTRACE:"1"},preopens:{".":"."},bindings:ss(ta({},u2),{fs:u})});h=void 0,_.bindings.fs.writeFileSync("/dev/stderr",""),_.bindings.fs.writeFileSync("/dev/stdout","");let L=await WebAssembly.instantiate(s,ta({},_.getImports(s)));try{_.start(L)}catch(g){console.log(g)}if(_.bindings.fs.closeSync(-1),h){console.log("Fetching",h);const g=await p2(h),F=hl(g2(g));_.bindings.fs.mkdirSync(da.dirname(h),{recursive:!0}),_.bindings.fs.writeFileSync(h,F);continue}break}}function g2(e){return e.replace(/(component\s+main[^;]+;)/,"/* $1 */")}async function Ki(e){let t;try{t=await fetch(e)}catch{throw new Error(`Failed to fetch ${e}`)}if(t.status!==200)throw new Error(`Error ${t.status}: ${e}`);return await t.text()}async function gl(e){const n=await(await fetch(`https://api.github.com/gists/${e}`)).json();if(n.files["main.circom"])return n.files["main.circom"].content;const i=Object.keys(n.files).find(o=>o.endsWith(".circom"));return i?n.files[i].content:Object.values(n.files)[0].content}async function p2(e){let t=[];const n=i=>t=i.exec(e);if(n(/^external\/https\/gist\.github\.com\/([^/]+)\/([\da-f]{32})/))return gl(t[2]);if(n(/^external\/https\/gist\.github\.com\/([\da-f]{32})/))return gl(t[1]);if(n(/^external\/https\/github\.com\/([^/]+)\/([^/]+)\/blob\/([^/]+)\/(.*)/))return Ki(`https://raw.githubusercontent.com/${t[1]}/${t[2]}/${t[3]}/${t[4]}`);if(n(/^external\/ipfs\/(.*)$/))return Ki(`https://cloudflare-ipfs.com/ipfs/${t[1]}`);if(n(/^external\/dweb\/ipfs\/(.*)$/))return Ki(`https://cloudflare-ipfs.com/ipfs/${t[1]}`);if(n(/^external\/https\/(.*)$/))return Ki(`https://${t[1]}`);if(n(/^external\/http\/(.*)$/))return Ki(`http://${t[1]}`)}const _2=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function pl(e,t){if(!t||t==10)return BigInt(e);if(t==16)return e.slice(0,2)=="0x"?BigInt(e):BigInt("0x"+e)}const m2=pl;function L2(e,t){let n=BigInt(0);t=BigInt(t);for(let i=0;i<e.length;i++)n=n*t+BigInt(e[i]);return n}function y2(e){const t=e.toString(16);return(t.length-1)*4+_2[parseInt(t[0],16)]}function A2(e){return BigInt(e)<BigInt(0)}function w2(e){return!e}function _l(e,t){return BigInt(e)<<BigInt(t)}function ml(e,t){return BigInt(e)>>BigInt(t)}const I2=_l,b2=ml;function E2(e){return(BigInt(e)&BigInt(1))==BigInt(1)}function C2(e){let t=BigInt(e);const n=[];for(;t;){if(t&BigInt(1)){const i=2-Number(t%BigInt(4));n.push(i),t=t-BigInt(i)}else n.push(0);t=t>>BigInt(1)}return n}function v2(e){let t=BigInt(e);const n=[];for(;t;)t&BigInt(1)?n.push(1):n.push(0),t=t>>BigInt(1);return n}function F2(e){if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(e)}function S2(e,t){const n=[];let i=BigInt(e);for(t=BigInt(t);i;)n.unshift(Number(i%t)),i=i/t;return n}function B2(e,t){return BigInt(e)+BigInt(t)}function x2(e,t){return BigInt(e)-BigInt(t)}function O2(e){return-BigInt(e)}function T2(e,t){return BigInt(e)*BigInt(t)}function P2(e){return BigInt(e)*BigInt(e)}function R2(e,t){return BigInt(e)**BigInt(t)}function U2(e,t){return BigInt(e)**BigInt(t)}function M2(e){return BigInt(e)>=0?BigInt(e):-BigInt(e)}function G2(e,t){return BigInt(e)/BigInt(t)}function N2(e,t){return BigInt(e)%BigInt(t)}function q2(e,t){return BigInt(e)==BigInt(t)}function z2(e,t){return BigInt(e)!=BigInt(t)}function D2(e,t){return BigInt(e)<BigInt(t)}function k2(e,t){return BigInt(e)>BigInt(t)}function Q2(e,t){return BigInt(e)<=BigInt(t)}function W2(e,t){return BigInt(e)>=BigInt(t)}function $2(e,t){return BigInt(e)&BigInt(t)}function H2(e,t){return BigInt(e)|BigInt(t)}function j2(e,t){return BigInt(e)^BigInt(t)}function V2(e,t){return BigInt(e)&&BigInt(t)}function K2(e,t){return BigInt(e)||BigInt(t)}function Y2(e){return!BigInt(e)}var Z2=Object.freeze({__proto__:null,fromString:pl,e:m2,fromArray:L2,bitLength:y2,isNegative:A2,isZero:w2,shiftLeft:_l,shiftRight:ml,shl:I2,shr:b2,isOdd:E2,naf:C2,bits:v2,toNumber:F2,toArray:S2,add:B2,sub:x2,neg:O2,mul:T2,square:P2,pow:R2,exp:U2,abs:M2,div:G2,mod:N2,eq:q2,neq:z2,lt:D2,gt:k2,leq:Q2,geq:W2,band:$2,bor:H2,bxor:j2,land:V2,lor:K2,lnot:Y2}),un={exports:{}};(function(e){var t=function(n){var i=1e7,o=7,a=9007199254740992,c=F(a),d="0123456789abcdefghijklmnopqrstuvwxyz",h=typeof BigInt=="function";function u(B,M,H,j){return typeof B=="undefined"?u[0]:typeof M!="undefined"?+M==10&&!H?vt(B):Ot(B,M,H,j):vt(B)}function s(B,M){this.value=B,this.sign=M,this.isSmall=!1}s.prototype=Object.create(u.prototype);function _(B){this.value=B,this.sign=B<0,this.isSmall=!0}_.prototype=Object.create(u.prototype);function L(B){this.value=B}L.prototype=Object.create(u.prototype);function g(B){return-a<B&&B<a}function F(B){return B<1e7?[B]:B<1e14?[B%1e7,Math.floor(B/1e7)]:[B%1e7,Math.floor(B/1e7)%1e7,Math.floor(B/1e14)]}function T(B){C(B);var M=B.length;if(M<4&&nt(B,c)<0)switch(M){case 0:return 0;case 1:return B[0];case 2:return B[0]+B[1]*i;default:return B[0]+(B[1]+B[2]*i)*i}return B}function C(B){for(var M=B.length;B[--M]===0;);B.length=M+1}function U(B){for(var M=new Array(B),H=-1;++H<B;)M[H]=0;return M}function x(B){return B>0?Math.floor(B):Math.ceil(B)}function V(B,M){var H=B.length,j=M.length,rt=new Array(H),et=0,ct=i,b,r;for(r=0;r<j;r++)b=B[r]+M[r]+et,et=b>=ct?1:0,rt[r]=b-et*ct;for(;r<H;)b=B[r]+et,et=b===ct?1:0,rt[r++]=b-et*ct;return et>0&&rt.push(et),rt}function D(B,M){return B.length>=M.length?V(B,M):V(M,B)}function $(B,M){var H=B.length,j=new Array(H),rt=i,et,ct;for(ct=0;ct<H;ct++)et=B[ct]-rt+M,M=Math.floor(et/rt),j[ct]=et-M*rt,M+=1;for(;M>0;)j[ct++]=M%rt,M=Math.floor(M/rt);return j}s.prototype.add=function(B){var M=vt(B);if(this.sign!==M.sign)return this.subtract(M.negate());var H=this.value,j=M.value;return M.isSmall?new s($(H,Math.abs(j)),this.sign):new s(D(H,j),this.sign)},s.prototype.plus=s.prototype.add,_.prototype.add=function(B){var M=vt(B),H=this.value;if(H<0!==M.sign)return this.subtract(M.negate());var j=M.value;if(M.isSmall){if(g(H+j))return new _(H+j);j=F(Math.abs(j))}return new s($(j,Math.abs(H)),H<0)},_.prototype.plus=_.prototype.add,L.prototype.add=function(B){return new L(this.value+vt(B).value)},L.prototype.plus=L.prototype.add;function v(B,M){var H=B.length,j=M.length,rt=new Array(H),et=0,ct=i,b,r;for(b=0;b<j;b++)r=B[b]-et-M[b],r<0?(r+=ct,et=1):et=0,rt[b]=r;for(b=j;b<H;b++){if(r=B[b]-et,r<0)r+=ct;else{rt[b++]=r;break}rt[b]=r}for(;b<H;b++)rt[b]=B[b];return C(rt),rt}function m(B,M,H){var j;return nt(B,M)>=0?j=v(B,M):(j=v(M,B),H=!H),j=T(j),typeof j=="number"?(H&&(j=-j),new _(j)):new s(j,H)}function y(B,M,H){var j=B.length,rt=new Array(j),et=-M,ct=i,b,r;for(b=0;b<j;b++)r=B[b]+et,et=Math.floor(r/ct),r%=ct,rt[b]=r<0?r+ct:r;return rt=T(rt),typeof rt=="number"?(H&&(rt=-rt),new _(rt)):new s(rt,H)}s.prototype.subtract=function(B){var M=vt(B);if(this.sign!==M.sign)return this.add(M.negate());var H=this.value,j=M.value;return M.isSmall?y(H,Math.abs(j),this.sign):m(H,j,this.sign)},s.prototype.minus=s.prototype.subtract,_.prototype.subtract=function(B){var M=vt(B),H=this.value;if(H<0!==M.sign)return this.add(M.negate());var j=M.value;return M.isSmall?new _(H-j):y(j,Math.abs(H),H>=0)},_.prototype.minus=_.prototype.subtract,L.prototype.subtract=function(B){return new L(this.value-vt(B).value)},L.prototype.minus=L.prototype.subtract,s.prototype.negate=function(){return new s(this.value,!this.sign)},_.prototype.negate=function(){var B=this.sign,M=new _(-this.value);return M.sign=!B,M},L.prototype.negate=function(){return new L(-this.value)},s.prototype.abs=function(){return new s(this.value,!1)},_.prototype.abs=function(){return new _(Math.abs(this.value))},L.prototype.abs=function(){return new L(this.value>=0?this.value:-this.value)};function G(B,M){var H=B.length,j=M.length,rt=H+j,et=U(rt),ct=i,b,r,l,A,S;for(l=0;l<H;++l){A=B[l];for(var P=0;P<j;++P)S=M[P],b=A*S+et[l+P],r=Math.floor(b/ct),et[l+P]=b-r*ct,et[l+P+1]+=r}return C(et),et}function k(B,M){var H=B.length,j=new Array(H),rt=i,et=0,ct,b;for(b=0;b<H;b++)ct=B[b]*M+et,et=Math.floor(ct/rt),j[b]=ct-et*rt;for(;et>0;)j[b++]=et%rt,et=Math.floor(et/rt);return j}function N(B,M){for(var H=[];M-- >0;)H.push(0);return H.concat(B)}function R(B,M){var H=Math.max(B.length,M.length);if(H<=30)return G(B,M);H=Math.ceil(H/2);var j=B.slice(H),rt=B.slice(0,H),et=M.slice(H),ct=M.slice(0,H),b=R(rt,ct),r=R(j,et),l=R(D(rt,j),D(ct,et)),A=D(D(b,N(v(v(l,b),r),H)),N(r,2*H));return C(A),A}function E(B,M){return-.012*B-.012*M+15e-6*B*M>0}s.prototype.multiply=function(B){var M=vt(B),H=this.value,j=M.value,rt=this.sign!==M.sign,et;if(M.isSmall){if(j===0)return u[0];if(j===1)return this;if(j===-1)return this.negate();if(et=Math.abs(j),et<i)return new s(k(H,et),rt);j=F(et)}return E(H.length,j.length)?new s(R(H,j),rt):new s(G(H,j),rt)},s.prototype.times=s.prototype.multiply;function z(B,M,H){return B<i?new s(k(M,B),H):new s(G(M,F(B)),H)}_.prototype._multiplyBySmall=function(B){return g(B.value*this.value)?new _(B.value*this.value):z(Math.abs(B.value),F(Math.abs(this.value)),this.sign!==B.sign)},s.prototype._multiplyBySmall=function(B){return B.value===0?u[0]:B.value===1?this:B.value===-1?this.negate():z(Math.abs(B.value),this.value,this.sign!==B.sign)},_.prototype.multiply=function(B){return vt(B)._multiplyBySmall(this)},_.prototype.times=_.prototype.multiply,L.prototype.multiply=function(B){return new L(this.value*vt(B).value)},L.prototype.times=L.prototype.multiply;function tt(B){var M=B.length,H=U(M+M),j=i,rt,et,ct,b,r;for(ct=0;ct<M;ct++){b=B[ct],et=0-b*b;for(var l=ct;l<M;l++)r=B[l],rt=2*(b*r)+H[ct+l]+et,et=Math.floor(rt/j),H[ct+l]=rt-et*j;H[ct+M]=et}return C(H),H}s.prototype.square=function(){return new s(tt(this.value),!1)},_.prototype.square=function(){var B=this.value*this.value;return g(B)?new _(B):new s(tt(F(Math.abs(this.value))),!1)},L.prototype.square=function(B){return new L(this.value*this.value)};function at(B,M){var H=B.length,j=M.length,rt=i,et=U(M.length),ct=M[j-1],b=Math.ceil(rt/(2*ct)),r=k(B,b),l=k(M,b),A,S,P,Q,Y,st,ft;for(r.length<=H&&r.push(0),l.push(0),ct=l[j-1],S=H-j;S>=0;S--){for(A=rt-1,r[S+j]!==ct&&(A=Math.floor((r[S+j]*rt+r[S+j-1])/ct)),P=0,Q=0,st=l.length,Y=0;Y<st;Y++)P+=A*l[Y],ft=Math.floor(P/rt),Q+=r[S+Y]-(P-ft*rt),P=ft,Q<0?(r[S+Y]=Q+rt,Q=-1):(r[S+Y]=Q,Q=0);for(;Q!==0;){for(A-=1,P=0,Y=0;Y<st;Y++)P+=r[S+Y]-rt+l[Y],P<0?(r[S+Y]=P+rt,P=0):(r[S+Y]=P,P=1);Q+=P}et[S]=A}return r=Z(r,b)[0],[T(et),T(r)]}function it(B,M){for(var H=B.length,j=M.length,rt=[],et=[],ct=i,b,r,l,A,S;H;){if(et.unshift(B[--H]),C(et),nt(et,M)<0){rt.push(0);continue}r=et.length,l=et[r-1]*ct+et[r-2],A=M[j-1]*ct+M[j-2],r>j&&(l=(l+1)*ct),b=Math.ceil(l/A);do{if(S=k(M,b),nt(S,et)<=0)break;b--}while(b);rt.push(b),et=v(et,S)}return rt.reverse(),[T(rt),T(et)]}function Z(B,M){var H=B.length,j=U(H),rt=i,et,ct,b,r;for(b=0,et=H-1;et>=0;--et)r=b*rt+B[et],ct=x(r/M),b=r-ct*M,j[et]=ct|0;return[j,b|0]}function ot(B,M){var H,j=vt(M);if(h)return[new L(B.value/j.value),new L(B.value%j.value)];var rt=B.value,et=j.value,ct;if(et===0)throw new Error("Cannot divide by zero");if(B.isSmall)return j.isSmall?[new _(x(rt/et)),new _(rt%et)]:[u[0],B];if(j.isSmall){if(et===1)return[B,u[0]];if(et==-1)return[B.negate(),u[0]];var b=Math.abs(et);if(b<i){H=Z(rt,b),ct=T(H[0]);var r=H[1];return B.sign&&(r=-r),typeof ct=="number"?(B.sign!==j.sign&&(ct=-ct),[new _(ct),new _(r)]):[new s(ct,B.sign!==j.sign),new _(r)]}et=F(b)}var l=nt(rt,et);if(l===-1)return[u[0],B];if(l===0)return[u[B.sign===j.sign?1:-1],u[0]];rt.length+et.length<=200?H=at(rt,et):H=it(rt,et),ct=H[0];var A=B.sign!==j.sign,S=H[1],P=B.sign;return typeof ct=="number"?(A&&(ct=-ct),ct=new _(ct)):ct=new s(ct,A),typeof S=="number"?(P&&(S=-S),S=new _(S)):S=new s(S,P),[ct,S]}s.prototype.divmod=function(B){var M=ot(this,B);return{quotient:M[0],remainder:M[1]}},L.prototype.divmod=_.prototype.divmod=s.prototype.divmod,s.prototype.divide=function(B){return ot(this,B)[0]},L.prototype.over=L.prototype.divide=function(B){return new L(this.value/vt(B).value)},_.prototype.over=_.prototype.divide=s.prototype.over=s.prototype.divide,s.prototype.mod=function(B){return ot(this,B)[1]},L.prototype.mod=L.prototype.remainder=function(B){return new L(this.value%vt(B).value)},_.prototype.remainder=_.prototype.mod=s.prototype.remainder=s.prototype.mod,s.prototype.pow=function(B){var M=vt(B),H=this.value,j=M.value,rt,et,ct;if(j===0)return u[1];if(H===0)return u[0];if(H===1)return u[1];if(H===-1)return M.isEven()?u[1]:u[-1];if(M.sign)return u[0];if(!M.isSmall)throw new Error("The exponent "+M.toString()+" is too large.");if(this.isSmall&&g(rt=Math.pow(H,j)))return new _(x(rt));for(et=this,ct=u[1];j&!0&&(ct=ct.times(et),--j),j!==0;)j/=2,et=et.square();return ct},_.prototype.pow=s.prototype.pow,L.prototype.pow=function(B){var M=vt(B),H=this.value,j=M.value,rt=BigInt(0),et=BigInt(1),ct=BigInt(2);if(j===rt)return u[1];if(H===rt)return u[0];if(H===et)return u[1];if(H===BigInt(-1))return M.isEven()?u[1]:u[-1];if(M.isNegative())return new L(rt);for(var b=this,r=u[1];(j&et)===et&&(r=r.times(b),--j),j!==rt;)j/=ct,b=b.square();return r},s.prototype.modPow=function(B,M){if(B=vt(B),M=vt(M),M.isZero())throw new Error("Cannot take modPow with modulus 0");var H=u[1],j=this.mod(M);for(B.isNegative()&&(B=B.multiply(u[-1]),j=j.modInv(M));B.isPositive();){if(j.isZero())return u[0];B.isOdd()&&(H=H.multiply(j).mod(M)),B=B.divide(2),j=j.square().mod(M)}return H},L.prototype.modPow=_.prototype.modPow=s.prototype.modPow;function nt(B,M){if(B.length!==M.length)return B.length>M.length?1:-1;for(var H=B.length-1;H>=0;H--)if(B[H]!==M[H])return B[H]>M[H]?1:-1;return 0}s.prototype.compareAbs=function(B){var M=vt(B),H=this.value,j=M.value;return M.isSmall?1:nt(H,j)},_.prototype.compareAbs=function(B){var M=vt(B),H=Math.abs(this.value),j=M.value;return M.isSmall?(j=Math.abs(j),H===j?0:H>j?1:-1):-1},L.prototype.compareAbs=function(B){var M=this.value,H=vt(B).value;return M=M>=0?M:-M,H=H>=0?H:-H,M===H?0:M>H?1:-1},s.prototype.compare=function(B){if(B===1/0)return-1;if(B===-1/0)return 1;var M=vt(B),H=this.value,j=M.value;return this.sign!==M.sign?M.sign?1:-1:M.isSmall?this.sign?-1:1:nt(H,j)*(this.sign?-1:1)},s.prototype.compareTo=s.prototype.compare,_.prototype.compare=function(B){if(B===1/0)return-1;if(B===-1/0)return 1;var M=vt(B),H=this.value,j=M.value;return M.isSmall?H==j?0:H>j?1:-1:H<0!==M.sign?H<0?-1:1:H<0?1:-1},_.prototype.compareTo=_.prototype.compare,L.prototype.compare=function(B){if(B===1/0)return-1;if(B===-1/0)return 1;var M=this.value,H=vt(B).value;return M===H?0:M>H?1:-1},L.prototype.compareTo=L.prototype.compare,s.prototype.equals=function(B){return this.compare(B)===0},L.prototype.eq=L.prototype.equals=_.prototype.eq=_.prototype.equals=s.prototype.eq=s.prototype.equals,s.prototype.notEquals=function(B){return this.compare(B)!==0},L.prototype.neq=L.prototype.notEquals=_.prototype.neq=_.prototype.notEquals=s.prototype.neq=s.prototype.notEquals,s.prototype.greater=function(B){return this.compare(B)>0},L.prototype.gt=L.prototype.greater=_.prototype.gt=_.prototype.greater=s.prototype.gt=s.prototype.greater,s.prototype.lesser=function(B){return this.compare(B)<0},L.prototype.lt=L.prototype.lesser=_.prototype.lt=_.prototype.lesser=s.prototype.lt=s.prototype.lesser,s.prototype.greaterOrEquals=function(B){return this.compare(B)>=0},L.prototype.geq=L.prototype.greaterOrEquals=_.prototype.geq=_.prototype.greaterOrEquals=s.prototype.geq=s.prototype.greaterOrEquals,s.prototype.lesserOrEquals=function(B){return this.compare(B)<=0},L.prototype.leq=L.prototype.lesserOrEquals=_.prototype.leq=_.prototype.lesserOrEquals=s.prototype.leq=s.prototype.lesserOrEquals,s.prototype.isEven=function(){return(this.value[0]&1)==0},_.prototype.isEven=function(){return(this.value&1)==0},L.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},s.prototype.isOdd=function(){return(this.value[0]&1)==1},_.prototype.isOdd=function(){return(this.value&1)==1},L.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},s.prototype.isPositive=function(){return!this.sign},_.prototype.isPositive=function(){return this.value>0},L.prototype.isPositive=_.prototype.isPositive,s.prototype.isNegative=function(){return this.sign},_.prototype.isNegative=function(){return this.value<0},L.prototype.isNegative=_.prototype.isNegative,s.prototype.isUnit=function(){return!1},_.prototype.isUnit=function(){return Math.abs(this.value)===1},L.prototype.isUnit=function(){return this.abs().value===BigInt(1)},s.prototype.isZero=function(){return!1},_.prototype.isZero=function(){return this.value===0},L.prototype.isZero=function(){return this.value===BigInt(0)},s.prototype.isDivisibleBy=function(B){var M=vt(B);return M.isZero()?!1:M.isUnit()?!0:M.compareAbs(2)===0?this.isEven():this.mod(M).isZero()},L.prototype.isDivisibleBy=_.prototype.isDivisibleBy=s.prototype.isDivisibleBy;function gt(B){var M=B.abs();if(M.isUnit())return!1;if(M.equals(2)||M.equals(3)||M.equals(5))return!0;if(M.isEven()||M.isDivisibleBy(3)||M.isDivisibleBy(5))return!1;if(M.lesser(49))return!0}function xt(B,M){for(var H=B.prev(),j=H,rt=0,et,ct,b;j.isEven();)j=j.divide(2),rt++;t:for(ct=0;ct<M.length;ct++)if(!B.lesser(M[ct])&&(b=t(M[ct]).modPow(j,B),!(b.isUnit()||b.equals(H)))){for(et=rt-1;et!=0;et--){if(b=b.square().mod(B),b.isUnit())return!1;if(b.equals(H))continue t}return!1}return!0}s.prototype.isPrime=function(B){var M=gt(this);if(M!==n)return M;var H=this.abs(),j=H.bitLength();if(j<=64)return xt(H,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var rt=Math.log(2)*j.toJSNumber(),et=Math.ceil(B===!0?2*Math.pow(rt,2):rt),ct=[],b=0;b<et;b++)ct.push(t(b+2));return xt(H,ct)},L.prototype.isPrime=_.prototype.isPrime=s.prototype.isPrime,s.prototype.isProbablePrime=function(B,M){var H=gt(this);if(H!==n)return H;for(var j=this.abs(),rt=B===n?5:B,et=[],ct=0;ct<rt;ct++)et.push(t.randBetween(2,j.minus(2),M));return xt(j,et)},L.prototype.isProbablePrime=_.prototype.isProbablePrime=s.prototype.isProbablePrime,s.prototype.modInv=function(B){for(var M=t.zero,H=t.one,j=vt(B),rt=this.abs(),et,ct,b;!rt.isZero();)et=j.divide(rt),ct=M,b=j,M=H,j=rt,H=ct.subtract(et.multiply(H)),rt=b.subtract(et.multiply(rt));if(!j.isUnit())throw new Error(this.toString()+" and "+B.toString()+" are not co-prime");return M.compare(0)===-1&&(M=M.add(B)),this.isNegative()?M.negate():M},L.prototype.modInv=_.prototype.modInv=s.prototype.modInv,s.prototype.next=function(){var B=this.value;return this.sign?y(B,1,this.sign):new s($(B,1),this.sign)},_.prototype.next=function(){var B=this.value;return B+1<a?new _(B+1):new s(c,!1)},L.prototype.next=function(){return new L(this.value+BigInt(1))},s.prototype.prev=function(){var B=this.value;return this.sign?new s($(B,1),!0):y(B,1,this.sign)},_.prototype.prev=function(){var B=this.value;return B-1>-a?new _(B-1):new s(c,!0)},L.prototype.prev=function(){return new L(this.value-BigInt(1))};for(var pt=[1];2*pt[pt.length-1]<=i;)pt.push(2*pt[pt.length-1]);var yt=pt.length,w=pt[yt-1];function f(B){return Math.abs(B)<=i}s.prototype.shiftLeft=function(B){var M=vt(B).toJSNumber();if(!f(M))throw new Error(String(M)+" is too large for shifting.");if(M<0)return this.shiftRight(-M);var H=this;if(H.isZero())return H;for(;M>=yt;)H=H.multiply(w),M-=yt-1;return H.multiply(pt[M])},L.prototype.shiftLeft=_.prototype.shiftLeft=s.prototype.shiftLeft,s.prototype.shiftRight=function(B){var M,H=vt(B).toJSNumber();if(!f(H))throw new Error(String(H)+" is too large for shifting.");if(H<0)return this.shiftLeft(-H);for(var j=this;H>=yt;){if(j.isZero()||j.isNegative()&&j.isUnit())return j;M=ot(j,w),j=M[1].isNegative()?M[0].prev():M[0],H-=yt-1}return M=ot(j,pt[H]),M[1].isNegative()?M[0].prev():M[0]},L.prototype.shiftRight=_.prototype.shiftRight=s.prototype.shiftRight;function O(B,M,H){M=vt(M);for(var j=B.isNegative(),rt=M.isNegative(),et=j?B.not():B,ct=rt?M.not():M,b=0,r=0,l=null,A=null,S=[];!et.isZero()||!ct.isZero();)l=ot(et,w),b=l[1].toJSNumber(),j&&(b=w-1-b),A=ot(ct,w),r=A[1].toJSNumber(),rt&&(r=w-1-r),et=l[0],ct=A[0],S.push(H(b,r));for(var P=H(j?1:0,rt?1:0)!==0?t(-1):t(0),Q=S.length-1;Q>=0;Q-=1)P=P.multiply(w).add(t(S[Q]));return P}s.prototype.not=function(){return this.negate().prev()},L.prototype.not=_.prototype.not=s.prototype.not,s.prototype.and=function(B){return O(this,B,function(M,H){return M&H})},L.prototype.and=_.prototype.and=s.prototype.and,s.prototype.or=function(B){return O(this,B,function(M,H){return M|H})},L.prototype.or=_.prototype.or=s.prototype.or,s.prototype.xor=function(B){return O(this,B,function(M,H){return M^H})},L.prototype.xor=_.prototype.xor=s.prototype.xor;var p=1<<30,W=(i&-i)*(i&-i)|p;function q(B){var M=B.value,H=typeof M=="number"?M|p:typeof M=="bigint"?M|BigInt(p):M[0]+M[1]*i|W;return H&-H}function I(B,M){if(M.compareTo(B)<=0){var H=I(B,M.square(M)),j=H.p,rt=H.e,et=j.multiply(M);return et.compareTo(B)<=0?{p:et,e:rt*2+1}:{p:j,e:rt*2}}return{p:t(1),e:0}}s.prototype.bitLength=function(){var B=this;return B.compareTo(t(0))<0&&(B=B.negate().subtract(t(1))),B.compareTo(t(0))===0?t(0):t(I(B,t(2)).e).add(t(1))},L.prototype.bitLength=_.prototype.bitLength=s.prototype.bitLength;function J(B,M){return B=vt(B),M=vt(M),B.greater(M)?B:M}function dt(B,M){return B=vt(B),M=vt(M),B.lesser(M)?B:M}function lt(B,M){if(B=vt(B).abs(),M=vt(M).abs(),B.equals(M))return B;if(B.isZero())return M;if(M.isZero())return B;for(var H=u[1],j,rt;B.isEven()&&M.isEven();)j=dt(q(B),q(M)),B=B.divide(j),M=M.divide(j),H=H.multiply(j);for(;B.isEven();)B=B.divide(q(B));do{for(;M.isEven();)M=M.divide(q(M));B.greater(M)&&(rt=M,M=B,B=rt),M=M.subtract(B)}while(!M.isZero());return H.isUnit()?B:B.multiply(H)}function It(B,M){return B=vt(B).abs(),M=vt(M).abs(),B.divide(lt(B,M)).multiply(M)}function Ut(B,M,H){B=vt(B),M=vt(M);var j=H||Math.random,rt=dt(B,M),et=J(B,M),ct=et.subtract(rt).add(1);if(ct.isSmall)return rt.add(Math.floor(j()*ct));for(var b=Lt(ct,i).value,r=[],l=!0,A=0;A<b.length;A++){var S=l?b[A]+(A+1<b.length?b[A+1]/i:0):i,P=x(j()*S);r.push(P),P<b[A]&&(l=!1)}return rt.add(u.fromArray(r,i,!1))}var Ot=function(B,M,H,j){H=H||d,B=String(B),j||(B=B.toLowerCase(),H=H.toLowerCase());var rt=B.length,et,ct=Math.abs(M),b={};for(et=0;et<H.length;et++)b[H[et]]=et;for(et=0;et<rt;et++){var r=B[et];if(r!=="-"&&r in b&&b[r]>=ct){if(r==="1"&&ct===1)continue;throw new Error(r+" is not a valid digit in base "+M+".")}}M=vt(M);var l=[],A=B[0]==="-";for(et=A?1:0;et<B.length;et++){var r=B[et];if(r in b)l.push(vt(b[r]));else if(r==="<"){var S=et;do et++;while(B[et]!==">"&&et<B.length);l.push(vt(B.slice(S+1,et)))}else throw new Error(r+" is not a valid character")}return Ft(l,M,A)};function Ft(B,M,H){var j=u[0],rt=u[1],et;for(et=B.length-1;et>=0;et--)j=j.add(B[et].times(rt)),rt=rt.times(M);return H?j.negate():j}function Ct(B,M){return M=M||d,B<M.length?M[B]:"<"+B+">"}function Lt(B,M){if(M=t(M),M.isZero()){if(B.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(M.equals(-1)){if(B.isZero())return{value:[0],isNegative:!1};if(B.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-B.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var H=Array.apply(null,Array(B.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return H.unshift([1]),{value:[].concat.apply([],H),isNegative:!1}}var j=!1;if(B.isNegative()&&M.isPositive()&&(j=!0,B=B.abs()),M.isUnit())return B.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(B.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:j};for(var rt=[],et=B,ct;et.isNegative()||et.compareAbs(M)>=0;){ct=et.divmod(M),et=ct.quotient;var b=ct.remainder;b.isNegative()&&(b=M.minus(b).abs(),et=et.next()),rt.push(b.toJSNumber())}return rt.push(et.toJSNumber()),{value:rt.reverse(),isNegative:j}}function Et(B,M,H){var j=Lt(B,M);return(j.isNegative?"-":"")+j.value.map(function(rt){return Ct(rt,H)}).join("")}s.prototype.toArray=function(B){return Lt(this,B)},_.prototype.toArray=function(B){return Lt(this,B)},L.prototype.toArray=function(B){return Lt(this,B)},s.prototype.toString=function(B,M){if(B===n&&(B=10),B!==10)return Et(this,B,M);for(var H=this.value,j=H.length,rt=String(H[--j]),et="0000000",ct;--j>=0;)ct=String(H[j]),rt+=et.slice(ct.length)+ct;var b=this.sign?"-":"";return b+rt},_.prototype.toString=function(B,M){return B===n&&(B=10),B!=10?Et(this,B,M):String(this.value)},L.prototype.toString=_.prototype.toString,L.prototype.toJSON=s.prototype.toJSON=_.prototype.toJSON=function(){return this.toString()},s.prototype.valueOf=function(){return parseInt(this.toString(),10)},s.prototype.toJSNumber=s.prototype.valueOf,_.prototype.valueOf=function(){return this.value},_.prototype.toJSNumber=_.prototype.valueOf,L.prototype.valueOf=L.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Bt(B){if(g(+B)){var M=+B;if(M===x(M))return h?new L(BigInt(M)):new _(M);throw new Error("Invalid integer: "+B)}var H=B[0]==="-";H&&(B=B.slice(1));var j=B.split(/e/i);if(j.length>2)throw new Error("Invalid integer: "+j.join("e"));if(j.length===2){var rt=j[1];if(rt[0]==="+"&&(rt=rt.slice(1)),rt=+rt,rt!==x(rt)||!g(rt))throw new Error("Invalid integer: "+rt+" is not a valid exponent.");var et=j[0],ct=et.indexOf(".");if(ct>=0&&(rt-=et.length-ct-1,et=et.slice(0,ct)+et.slice(ct+1)),rt<0)throw new Error("Cannot include negative exponent part for integers");et+=new Array(rt+1).join("0"),B=et}var b=/^([0-9][0-9]*)$/.test(B);if(!b)throw new Error("Invalid integer: "+B);if(h)return new L(BigInt(H?"-"+B:B));for(var r=[],l=B.length,A=o,S=l-A;l>0;)r.push(+B.slice(S,l)),S-=A,S<0&&(S=0),l-=A;return C(r),new s(r,H)}function Pt(B){if(h)return new L(BigInt(B));if(g(B)){if(B!==x(B))throw new Error(B+" is not an integer.");return new _(B)}return Bt(B.toString())}function vt(B){return typeof B=="number"?Pt(B):typeof B=="string"?Bt(B):typeof B=="bigint"?new L(B):B}for(var Wt=0;Wt<1e3;Wt++)u[Wt]=vt(Wt),Wt>0&&(u[-Wt]=vt(-Wt));return u.one=u[1],u.zero=u[0],u.minusOne=u[-1],u.max=J,u.min=dt,u.gcd=lt,u.lcm=It,u.isInstance=function(B){return B instanceof s||B instanceof _||B instanceof L},u.randBetween=Ut,u.fromArray=function(B,M,H){return Ft(B.map(vt),vt(M||10),H)},u}();e.hasOwnProperty("exports")&&(e.exports=t)})(un);var X=un.exports;function Ll(e,t){return typeof e=="string"&&e.slice(0,2)=="0x"?X(e.slice(2),16):X(e,t)}const J2=Ll;function X2(e,t){return X.fromArray(e,t)}function tg(e){return X(e).bitLength()}function eg(e){return X(e).isNegative()}function ng(e){return X(e).isZero()}function yl(e,t){return X(e).shiftLeft(t)}function Al(e,t){return X(e).shiftRight(t)}const ig=yl,og=Al;function ag(e){return X(e).isOdd()}function rg(e){let t=X(e);const n=[];for(;t.gt(X.zero);){if(t.isOdd()){const i=2-t.mod(4).toJSNumber();n.push(i),t=t.minus(i)}else n.push(0);t=t.shiftRight(1)}return n}function sg(e){let t=X(e);const n=[];for(;t.gt(X.zero);)t.isOdd()?n.push(1):n.push(0),t=t.shiftRight(1);return n}function cg(e){if(!e.lt(X("9007199254740992",10)))throw new Error("Number too big");return e.toJSNumber()}function lg(e,t){return X(e).toArray(t)}function ug(e,t){return X(e).add(X(t))}function dg(e,t){return X(e).minus(X(t))}function fg(e){return X.zero.minus(X(e))}function hg(e,t){return X(e).times(X(t))}function gg(e){return X(e).square()}function pg(e,t){return X(e).pow(X(t))}function _g(e,t){return X(e).pow(X(t))}function mg(e){return X(e).abs()}function Lg(e,t){return X(e).divide(X(t))}function yg(e,t){return X(e).mod(X(t))}function Ag(e,t){return X(e).eq(X(t))}function wg(e,t){return X(e).neq(X(t))}function Ig(e,t){return X(e).lt(X(t))}function bg(e,t){return X(e).gt(X(t))}function Eg(e,t){return X(e).leq(X(t))}function Cg(e,t){return X(e).geq(X(t))}function vg(e,t){return X(e).and(X(t))}function Fg(e,t){return X(e).or(X(t))}function Sg(e,t){return X(e).xor(X(t))}function Bg(e,t){return!X(e).isZero()&&!X(t).isZero()}function xg(e,t){return!X(e).isZero()||!X(t).isZero()}function Og(e){return X(e).isZero()}var Tg=Object.freeze({__proto__:null,fromString:Ll,e:J2,fromArray:X2,bitLength:tg,isNegative:eg,isZero:ng,shiftLeft:yl,shiftRight:Al,shl:ig,shr:og,isOdd:ag,naf:rg,bits:sg,toNumber:cg,toArray:lg,add:ug,sub:dg,neg:fg,mul:hg,square:gg,pow:pg,exp:_g,abs:mg,div:Lg,mod:yg,eq:Ag,neq:wg,lt:Ig,gt:bg,leq:Eg,geq:Cg,band:vg,bor:Fg,bxor:Sg,land:Bg,lor:xg,lnot:Og});const Pg=typeof BigInt=="function";let le={};Pg?Object.assign(le,Z2):Object.assign(le,Tg),le.toRprLE=function(t,n,i,o){const a="0000000"+i.toString(16),c=new Uint32Array(t.buffer,n,o/4),d=((a.length-7)*4-1>>5)+1;for(let h=0;h<d;h++)c[h]=parseInt(a.substring(a.length-8*h-8,a.length-8*h),16);for(let h=d;h<c.length;h++)c[h]=0;for(let h=c.length*4;h<o;h++)t[h]=le.toNumber(le.band(le.shiftRight(i,h*8),255))},le.toRprBE=function(t,n,i,o){const a="0000000"+i.toString(16),c=new DataView(t.buffer,t.byteOffset+n,o),d=((a.length-7)*4-1>>5)+1;for(let h=0;h<d;h++)c.setUint32(o-h*4-4,parseInt(a.substring(a.length-8*h-8,a.length-8*h),16),!1);for(let h=0;h<o/4-d;h++)c[h]=0},le.fromRprLE=function(t,n,i){i=i||t.byteLength,n=n||0;const o=new Uint32Array(t.buffer,n,i/4),a=new Array(i/4);return o.forEach((c,d)=>a[a.length-d-1]=c.toString(16).padStart(8,"0")),le.fromString(a.join(""),16)},le.fromRprBE=function(t,n,i){i=i||t.byteLength,n=n||0;const o=new DataView(t.buffer,t.byteOffset+n,i),a=new Array(i/4);for(let c=0;c<i/4;c++)a[c]=o.getUint32(c*4,!1).toString(16).padStart(8,"0");return le.fromString(a.join(""),16)},le.toString=function(t,n){return t.toString(n)},le.toLEBuff=function(t){const n=new Uint8Array(Math.floor((le.bitLength(t)-1)/8)+1);return le.toRprLE(n,0,t,n.byteLength),n},le.zero=le.e(0),le.one=le.e(1);let{toRprLE:Rg,toRprBE:Ug,fromRprLE:wl,fromRprBE:Mg,toString:Gg,toLEBuff:Ng,zero:qg,one:zg,fromString:Dg,e:Yi,fromArray:kg,bitLength:Il,isNegative:Qg,isZero:Wg,shiftLeft:$g,shiftRight:Hg,shl:jg,shr:Vg,isOdd:Kg,naf:Yg,bits:Zg,toNumber:Jg,toArray:Xg,add:tp,sub:ep,neg:np,mul:ip,square:op,pow:ap,exp:rp,abs:sp,div:cp,mod:lp,eq:up,neq:dp,lt:fp,gt:hp,leq:gp,geq:pp,band:_p,bor:mp,bxor:Lp,land:yp,lor:Ap,lnot:wp}=le;var Ip=Object.freeze({__proto__:null,toRprLE:Rg,toRprBE:Ug,fromRprLE:wl,fromRprBE:Mg,toString:Gg,toLEBuff:Ng,zero:qg,one:zg,fromString:Dg,e:Yi,fromArray:kg,bitLength:Il,isNegative:Qg,isZero:Wg,shiftLeft:$g,shiftRight:Hg,shl:jg,shr:Vg,isOdd:Kg,naf:Yg,bits:Zg,toNumber:Jg,toArray:Xg,add:tp,sub:ep,neg:np,mul:ip,square:op,pow:ap,exp:rp,abs:sp,div:cp,mod:lp,eq:up,neq:dp,lt:fp,gt:hp,leq:gp,geq:pp,band:_p,bor:mp,bxor:Lp,land:yp,lor:Ap,lnot:wp});function bp(e){return Buffer.from(crypto.getRandomValues(new Uint8Array(e)))}function Ep(e){return crypto.getRandomValues(e)}var Oo={randomBytes:bp,randomFillSync:Ep},In={};const bl=un.exports;In.bigInt2BytesLE=function(t,n){const i=Array(n);let o=bl(t);for(let a=0;a<n;a++)i[a]=o.and(255).toJSNumber(),o=o.shiftRight(8);return i},In.bigInt2U32LE=function(t,n){const i=Array(n);let o=bl(t);for(let a=0;a<n;a++)i[a]=o.and(4294967295).toJSNumber(),o=o.shiftRight(32);return i},In.isOcamNum=function(e){return!(!Array.isArray(e)||e.length!=3||typeof e[0]!="number"||typeof e[1]!="number"||!Array.isArray(e[2]))};const Cp=In;var vp=function(t,n,i){const o=i||"int";if(t.modules[o])return o;t.modules[o]={};const a=n*2,c=n*8;t.alloc(c,Cp.bigInt2BytesLE(1,c));function d(){const v=t.addFunction(o+"_copy");v.addParam("px","i32"),v.addParam("pr","i32");const m=v.getCodeBuilder();for(let y=0;y<n;y++)v.addCode(m.i64_store(m.getLocal("pr"),y*8,m.i64_load(m.getLocal("px"),y*8)))}function h(){const v=t.addFunction(o+"_zero");v.addParam("pr","i32");const m=v.getCodeBuilder();for(let y=0;y<n;y++)v.addCode(m.i64_store(m.getLocal("pr"),y*8,m.i64_const(0)))}function u(){const v=t.addFunction(o+"_one");v.addParam("pr","i32");const m=v.getCodeBuilder();v.addCode(m.i64_store(m.getLocal("pr"),0,m.i64_const(1)));for(let y=1;y<n;y++)v.addCode(m.i64_store(m.getLocal("pr"),y*8,m.i64_const(0)))}function s(){const v=t.addFunction(o+"_isZero");v.addParam("px","i32"),v.setReturnType("i32");const m=v.getCodeBuilder();function y(G){return G==0?m.ret(m.i64_eqz(m.i64_load(m.getLocal("px")))):m.if(m.i64_eqz(m.i64_load(m.getLocal("px"),G*8)),y(G-1),m.ret(m.i32_const(0)))}v.addCode(y(n-1)),v.addCode(m.ret(m.i32_const(0)))}function _(){const v=t.addFunction(o+"_eq");v.addParam("px","i32"),v.addParam("py","i32"),v.setReturnType("i32");const m=v.getCodeBuilder();function y(G){return G==0?m.ret(m.i64_eq(m.i64_load(m.getLocal("px")),m.i64_load(m.getLocal("py")))):m.if(m.i64_eq(m.i64_load(m.getLocal("px"),G*8),m.i64_load(m.getLocal("py"),G*8)),y(G-1),m.ret(m.i32_const(0)))}v.addCode(y(n-1)),v.addCode(m.ret(m.i32_const(0)))}function L(){const v=t.addFunction(o+"_gte");v.addParam("px","i32"),v.addParam("py","i32"),v.setReturnType("i32");const m=v.getCodeBuilder();function y(G){return G==0?m.ret(m.i64_ge_u(m.i64_load(m.getLocal("px")),m.i64_load(m.getLocal("py")))):m.if(m.i64_lt_u(m.i64_load(m.getLocal("px"),G*8),m.i64_load(m.getLocal("py"),G*8)),m.ret(m.i32_const(0)),m.if(m.i64_gt_u(m.i64_load(m.getLocal("px"),G*8),m.i64_load(m.getLocal("py"),G*8)),m.ret(m.i32_const(1)),y(G-1)))}v.addCode(y(n-1)),v.addCode(m.ret(m.i32_const(0)))}function g(){const v=t.addFunction(o+"_add");v.addParam("x","i32"),v.addParam("y","i32"),v.addParam("r","i32"),v.setReturnType("i32"),v.addLocal("c","i64");const m=v.getCodeBuilder();v.addCode(m.setLocal("c",m.i64_add(m.i64_load32_u(m.getLocal("x")),m.i64_load32_u(m.getLocal("y"))))),v.addCode(m.i64_store32(m.getLocal("r"),m.getLocal("c")));for(let y=1;y<a;y++)v.addCode(m.setLocal("c",m.i64_add(m.i64_add(m.i64_load32_u(m.getLocal("x"),4*y),m.i64_load32_u(m.getLocal("y"),4*y)),m.i64_shr_u(m.getLocal("c"),m.i64_const(32))))),v.addCode(m.i64_store32(m.getLocal("r"),y*4,m.getLocal("c")));v.addCode(m.i32_wrap_i64(m.i64_shr_u(m.getLocal("c"),m.i64_const(32))))}function F(){const v=t.addFunction(o+"_sub");v.addParam("x","i32"),v.addParam("y","i32"),v.addParam("r","i32"),v.setReturnType("i32"),v.addLocal("c","i64");const m=v.getCodeBuilder();v.addCode(m.setLocal("c",m.i64_sub(m.i64_load32_u(m.getLocal("x")),m.i64_load32_u(m.getLocal("y"))))),v.addCode(m.i64_store32(m.getLocal("r"),m.i64_and(m.getLocal("c"),m.i64_const("0xFFFFFFFF"))));for(let y=1;y<a;y++)v.addCode(m.setLocal("c",m.i64_add(m.i64_sub(m.i64_load32_u(m.getLocal("x"),4*y),m.i64_load32_u(m.getLocal("y"),4*y)),m.i64_shr_s(m.getLocal("c"),m.i64_const(32))))),v.addCode(m.i64_store32(m.getLocal("r"),y*4,m.i64_and(m.getLocal("c"),m.i64_const("0xFFFFFFFF"))));v.addCode(m.i32_wrap_i64(m.i64_shr_s(m.getLocal("c"),m.i64_const(32))))}function T(){const v=t.addFunction(o+"_mul");v.addParam("x","i32"),v.addParam("y","i32"),v.addParam("r","i32"),v.addLocal("c0","i64"),v.addLocal("c1","i64");for(let E=0;E<a;E++)v.addLocal("x"+E,"i64"),v.addLocal("y"+E,"i64");const m=v.getCodeBuilder(),y=[],G=[];function k(E,z){let tt,at;return y[E]?tt=m.getLocal("x"+E):(tt=m.teeLocal("x"+E,m.i64_load32_u(m.getLocal("x"),E*4)),y[E]=!0),G[z]?at=m.getLocal("y"+z):(at=m.teeLocal("y"+z,m.i64_load32_u(m.getLocal("y"),z*4)),G[z]=!0),m.i64_mul(tt,at)}let N="c0",R="c1";for(let E=0;E<a*2-1;E++){for(let z=Math.max(0,E-a+1);z<=E&&z<a;z++){const tt=E-z;v.addCode(m.setLocal(N,m.i64_add(m.i64_and(m.getLocal(N),m.i64_const(4294967295)),k(z,tt)))),v.addCode(m.setLocal(R,m.i64_add(m.getLocal(R),m.i64_shr_u(m.getLocal(N),m.i64_const(32)))))}v.addCode(m.i64_store32(m.getLocal("r"),E*4,m.getLocal(N))),[N,R]=[R,N],v.addCode(m.setLocal(R,m.i64_shr_u(m.getLocal(N),m.i64_const(32))))}v.addCode(m.i64_store32(m.getLocal("r"),a*4*2-4,m.getLocal(N)))}function C(){const v=t.addFunction(o+"_square");v.addParam("x","i32"),v.addParam("r","i32"),v.addLocal("c0","i64"),v.addLocal("c1","i64"),v.addLocal("c0_old","i64"),v.addLocal("c1_old","i64");for(let z=0;z<a;z++)v.addLocal("x"+z,"i64");const m=v.getCodeBuilder(),y=[];function G(z,tt){let at,it;return y[z]?at=m.getLocal("x"+z):(at=m.teeLocal("x"+z,m.i64_load32_u(m.getLocal("x"),z*4)),y[z]=!0),y[tt]?it=m.getLocal("x"+tt):(it=m.teeLocal("x"+tt,m.i64_load32_u(m.getLocal("x"),tt*4)),y[tt]=!0),m.i64_mul(at,it)}let k="c0",N="c1",R="c0_old",E="c1_old";for(let z=0;z<a*2-1;z++){v.addCode(m.setLocal(k,m.i64_const(0)),m.setLocal(N,m.i64_const(0)));for(let tt=Math.max(0,z-a+1);tt<z+1>>1&&tt<a;tt++){const at=z-tt;v.addCode(m.setLocal(k,m.i64_add(m.i64_and(m.getLocal(k),m.i64_const(4294967295)),G(tt,at)))),v.addCode(m.setLocal(N,m.i64_add(m.getLocal(N),m.i64_shr_u(m.getLocal(k),m.i64_const(32)))))}v.addCode(m.setLocal(k,m.i64_shl(m.i64_and(m.getLocal(k),m.i64_const(4294967295)),m.i64_const(1)))),v.addCode(m.setLocal(N,m.i64_add(m.i64_shl(m.getLocal(N),m.i64_const(1)),m.i64_shr_u(m.getLocal(k),m.i64_const(32))))),z%2==0&&(v.addCode(m.setLocal(k,m.i64_add(m.i64_and(m.getLocal(k),m.i64_const(4294967295)),G(z>>1,z>>1)))),v.addCode(m.setLocal(N,m.i64_add(m.getLocal(N),m.i64_shr_u(m.getLocal(k),m.i64_const(32)))))),z>0&&(v.addCode(m.setLocal(k,m.i64_add(m.i64_and(m.getLocal(k),m.i64_const(4294967295)),m.i64_and(m.getLocal(R),m.i64_const(4294967295))))),v.addCode(m.setLocal(N,m.i64_add(m.i64_add(m.getLocal(N),m.i64_shr_u(m.getLocal(k),m.i64_const(32))),m.getLocal(E))))),v.addCode(m.i64_store32(m.getLocal("r"),z*4,m.getLocal(k))),v.addCode(m.setLocal(R,m.getLocal(N)),m.setLocal(E,m.i64_shr_u(m.getLocal(R),m.i64_const(32))))}v.addCode(m.i64_store32(m.getLocal("r"),a*4*2-4,m.getLocal(R)))}function U(){const v=t.addFunction(o+"_squareOld");v.addParam("x","i32"),v.addParam("r","i32");const m=v.getCodeBuilder();v.addCode(m.call(o+"_mul",m.getLocal("x"),m.getLocal("x"),m.getLocal("r")))}function x(){const v=t.addFunction(o+"__mul1");v.addParam("px","i32"),v.addParam("y","i64"),v.addParam("pr","i32"),v.addLocal("c","i64");const m=v.getCodeBuilder();v.addCode(m.setLocal("c",m.i64_mul(m.i64_load32_u(m.getLocal("px"),0,0),m.getLocal("y")))),v.addCode(m.i64_store32(m.getLocal("pr"),0,0,m.getLocal("c")));for(let y=1;y<a;y++)v.addCode(m.setLocal("c",m.i64_add(m.i64_mul(m.i64_load32_u(m.getLocal("px"),4*y,0),m.getLocal("y")),m.i64_shr_u(m.getLocal("c"),m.i64_const(32))))),v.addCode(m.i64_store32(m.getLocal("pr"),y*4,0,m.getLocal("c")))}function V(){const v=t.addFunction(o+"__add1");v.addParam("x","i32"),v.addParam("y","i64"),v.addLocal("c","i64"),v.addLocal("px","i32");const m=v.getCodeBuilder();v.addCode(m.setLocal("px",m.getLocal("x"))),v.addCode(m.setLocal("c",m.i64_add(m.i64_load32_u(m.getLocal("px"),0,0),m.getLocal("y")))),v.addCode(m.i64_store32(m.getLocal("px"),0,0,m.getLocal("c"))),v.addCode(m.setLocal("c",m.i64_shr_u(m.getLocal("c"),m.i64_const(32)))),v.addCode(m.block(m.loop(m.br_if(1,m.i64_eqz(m.getLocal("c"))),m.setLocal("px",m.i32_add(m.getLocal("px"),m.i32_const(4))),m.setLocal("c",m.i64_add(m.i64_load32_u(m.getLocal("px"),0,0),m.getLocal("c"))),m.i64_store32(m.getLocal("px"),0,0,m.getLocal("c")),m.setLocal("c",m.i64_shr_u(m.getLocal("c"),m.i64_const(32))),m.br(0))))}function D(){x(),V();const v=t.addFunction(o+"_div");v.addParam("x","i32"),v.addParam("y","i32"),v.addParam("c","i32"),v.addParam("r","i32"),v.addLocal("rr","i32"),v.addLocal("cc","i32"),v.addLocal("eX","i32"),v.addLocal("eY","i32"),v.addLocal("sy","i64"),v.addLocal("sx","i64"),v.addLocal("ec","i32");const m=v.getCodeBuilder(),y=m.i32_const(t.alloc(c)),G=m.i32_const(t.alloc(c)),k=m.i32_const(t.alloc(c)),N=m.getLocal("cc"),R=m.getLocal("rr"),E=t.alloc(c*2),z=m.i32_const(E),tt=m.i32_const(E+c);v.addCode(m.if(m.getLocal("c"),m.setLocal("cc",m.getLocal("c")),m.setLocal("cc",G))),v.addCode(m.if(m.getLocal("r"),m.setLocal("rr",m.getLocal("r")),m.setLocal("rr",k))),v.addCode(m.call(o+"_copy",m.getLocal("x"),R)),v.addCode(m.call(o+"_copy",m.getLocal("y"),y)),v.addCode(m.call(o+"_zero",N)),v.addCode(m.call(o+"_zero",z)),v.addCode(m.setLocal("eX",m.i32_const(c-1))),v.addCode(m.setLocal("eY",m.i32_const(c-1))),v.addCode(m.block(m.loop(m.br_if(1,m.i32_or(m.i32_load8_u(m.i32_add(y,m.getLocal("eY")),0,0),m.i32_eq(m.getLocal("eY"),m.i32_const(3)))),m.setLocal("eY",m.i32_sub(m.getLocal("eY"),m.i32_const(1))),m.br(0)))),v.addCode(m.setLocal("sy",m.i64_add(m.i64_load32_u(m.i32_sub(m.i32_add(y,m.getLocal("eY")),m.i32_const(3)),0,0),m.i64_const(1)))),v.addCode(m.if(m.i64_eq(m.getLocal("sy"),m.i64_const(1)),m.drop(m.i64_div_u(m.i64_const(0),m.i64_const(0))))),v.addCode(m.block(m.loop(m.block(m.loop(m.br_if(1,m.i32_or(m.i32_load8_u(m.i32_add(R,m.getLocal("eX")),0,0),m.i32_eq(m.getLocal("eX"),m.i32_const(7)))),m.setLocal("eX",m.i32_sub(m.getLocal("eX"),m.i32_const(1))),m.br(0))),m.setLocal("sx",m.i64_load(m.i32_sub(m.i32_add(R,m.getLocal("eX")),m.i32_const(7)),0,0)),m.setLocal("sx",m.i64_div_u(m.getLocal("sx"),m.getLocal("sy"))),m.setLocal("ec",m.i32_sub(m.i32_sub(m.getLocal("eX"),m.getLocal("eY")),m.i32_const(4))),m.block(m.loop(m.br_if(1,m.i32_and(m.i64_eqz(m.i64_and(m.getLocal("sx"),m.i64_const("0xFFFFFFFF00000000"))),m.i32_ge_s(m.getLocal("ec"),m.i32_const(0)))),m.setLocal("sx",m.i64_shr_u(m.getLocal("sx"),m.i64_const(8))),m.setLocal("ec",m.i32_add(m.getLocal("ec"),m.i32_const(1))),m.br(0))),m.if(m.i64_eqz(m.getLocal("sx")),[...m.br_if(2,m.i32_eqz(m.call(o+"_gte",R,y))),...m.setLocal("sx",m.i64_const(1)),...m.setLocal("ec",m.i32_const(0))]),m.call(o+"__mul1",y,m.getLocal("sx"),tt),m.drop(m.call(o+"_sub",R,m.i32_sub(tt,m.getLocal("ec")),R)),m.call(o+"__add1",m.i32_add(N,m.getLocal("ec")),m.getLocal("sx")),m.br(0))))}function $(){const v=t.addFunction(o+"_inverseMod");v.addParam("px","i32"),v.addParam("pm","i32"),v.addParam("pr","i32"),v.addLocal("t","i32"),v.addLocal("newt","i32"),v.addLocal("r","i32"),v.addLocal("qq","i32"),v.addLocal("qr","i32"),v.addLocal("newr","i32"),v.addLocal("swp","i32"),v.addLocal("x","i32"),v.addLocal("signt","i32"),v.addLocal("signnewt","i32"),v.addLocal("signx","i32");const m=v.getCodeBuilder(),y=m.i32_const(t.alloc(c)),G=m.i32_const(t.alloc(c)),k=m.i32_const(t.alloc(c)),N=m.i32_const(t.alloc(c)),R=m.i32_const(t.alloc(c)),E=m.i32_const(t.alloc(c)),z=m.i32_const(t.alloc(c*2)),tt=m.i32_const(t.alloc(c));v.addCode(m.setLocal("t",y),m.call(o+"_zero",y),m.setLocal("signt",m.i32_const(0))),v.addCode(m.setLocal("r",G),m.call(o+"_copy",m.getLocal("pm"),G)),v.addCode(m.setLocal("newt",k),m.call(o+"_one",k),m.setLocal("signnewt",m.i32_const(0))),v.addCode(m.setLocal("newr",N),m.call(o+"_copy",m.getLocal("px"),N)),v.addCode(m.setLocal("qq",R)),v.addCode(m.setLocal("qr",E)),v.addCode(m.setLocal("x",tt)),v.addCode(m.block(m.loop(m.br_if(1,m.call(o+"_isZero",m.getLocal("newr"))),m.call(o+"_div",m.getLocal("r"),m.getLocal("newr"),m.getLocal("qq"),m.getLocal("qr")),m.call(o+"_mul",m.getLocal("qq"),m.getLocal("newt"),z),m.if(m.getLocal("signt"),m.if(m.getLocal("signnewt"),m.if(m.call(o+"_gte",z,m.getLocal("t")),[...m.drop(m.call(o+"_sub",z,m.getLocal("t"),m.getLocal("x"))),...m.setLocal("signx",m.i32_const(0))],[...m.drop(m.call(o+"_sub",m.getLocal("t"),z,m.getLocal("x"))),...m.setLocal("signx",m.i32_const(1))]),[...m.drop(m.call(o+"_add",z,m.getLocal("t"),m.getLocal("x"))),...m.setLocal("signx",m.i32_const(1))]),m.if(m.getLocal("signnewt"),[...m.drop(m.call(o+"_add",z,m.getLocal("t"),m.getLocal("x"))),...m.setLocal("signx",m.i32_const(0))],m.if(m.call(o+"_gte",m.getLocal("t"),z),[...m.drop(m.call(o+"_sub",m.getLocal("t"),z,m.getLocal("x"))),...m.setLocal("signx",m.i32_const(0))],[...m.drop(m.call(o+"_sub",z,m.getLocal("t"),m.getLocal("x"))),...m.setLocal("signx",m.i32_const(1))]))),m.setLocal("swp",m.getLocal("t")),m.setLocal("t",m.getLocal("newt")),m.setLocal("newt",m.getLocal("x")),m.setLocal("x",m.getLocal("swp")),m.setLocal("signt",m.getLocal("signnewt")),m.setLocal("signnewt",m.getLocal("signx")),m.setLocal("swp",m.getLocal("r")),m.setLocal("r",m.getLocal("newr")),m.setLocal("newr",m.getLocal("qr")),m.setLocal("qr",m.getLocal("swp")),m.br(0)))),v.addCode(m.if(m.getLocal("signt"),m.drop(m.call(o+"_sub",m.getLocal("pm"),m.getLocal("t"),m.getLocal("pr"))),m.call(o+"_copy",m.getLocal("t"),m.getLocal("pr"))))}return d(),h(),s(),u(),_(),L(),g(),F(),T(),C(),U(),D(),$(),t.exportFunction(o+"_copy"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_gte"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_square"),t.exportFunction(o+"_squareOld"),t.exportFunction(o+"_div"),t.exportFunction(o+"_inverseMod"),o},Ka=function(t,n,i,o,a,c,d){const h=t.addFunction(n);h.addParam("base","i32"),h.addParam("scalar","i32"),h.addParam("scalarLength","i32"),h.addParam("r","i32"),h.addLocal("i","i32"),h.addLocal("b","i32");const u=h.getCodeBuilder(),s=u.i32_const(t.alloc(i));h.addCode(u.if(u.i32_eqz(u.getLocal("scalarLength")),[...u.call(d,u.getLocal("r")),...u.ret([])])),h.addCode(u.call(c,u.getLocal("base"),s)),h.addCode(u.call(d,u.getLocal("r"))),h.addCode(u.setLocal("i",u.getLocal("scalarLength"))),h.addCode(u.block(u.loop(u.setLocal("i",u.i32_sub(u.getLocal("i"),u.i32_const(1))),u.setLocal("b",u.i32_load8_u(u.i32_add(u.getLocal("scalar"),u.getLocal("i")))),..._(),u.br_if(1,u.i32_eqz(u.getLocal("i"))),u.br(0))));function _(){const L=[];for(let g=0;g<8;g++)L.push(...u.call(a,u.getLocal("r"),u.getLocal("r")),...u.if(u.i32_ge_u(u.getLocal("b"),u.i32_const(128>>g)),[...u.setLocal("b",u.i32_sub(u.getLocal("b"),u.i32_const(128>>g))),...u.call(o,u.getLocal("r"),s,u.getLocal("r"))]));return L}},Ya=Fp;function Fp(e,t){const n=e.modules[t].n64*8,i=e.addFunction(t+"_batchInverse");i.addParam("pIn","i32"),i.addParam("inStep","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addParam("outStep","i32"),i.addLocal("itAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");const o=i.getCodeBuilder(),a=o.i32_const(e.alloc(n));i.addCode(o.setLocal("itAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("itAux"),o.i32_mul(o.i32_add(o.getLocal("n"),o.i32_const(1)),o.i32_const(n))))),i.addCode(o.call(t+"_one",o.getLocal("itAux")),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(t+"_isZero",o.getLocal("itIn")),o.call(t+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),o.getLocal("itAux")),o.call(t+"_mul",o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),o.getLocal("itAux"))),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("itOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("outStep")))),o.call(t+"_inverse",o.getLocal("itAux"),o.getLocal("itAux")),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.if(o.call(t+"_isZero",o.getLocal("itIn")),[...o.call(t+"_copy",o.getLocal("itAux"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),...o.call(t+"_zero",o.getLocal("itOut"))],[...o.call(t+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),a),...o.call(t+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),...o.call(t+"_mul",o.getLocal("itAux"),a,o.getLocal("itOut"))]),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itOut",o.i32_sub(o.getLocal("itOut"),o.getLocal("outStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),i.addCode(o.i32_store(o.i32_const(0),o.getLocal("itAux")))}var El=Sp;function Sp(e,t,n,i,o,a){typeof a=="undefined"&&(i<o?a=!0:a=!1);const c=e.addFunction(t);c.addParam("pIn","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn","i32"),c.addLocal("itOut","i32");const d=c.getCodeBuilder();a?c.addCode(d.setLocal("itIn",d.i32_add(d.getLocal("pIn"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(i)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(o)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_sub(d.getLocal("itIn"),d.i32_const(i))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):c.addCode(d.setLocal("itIn",d.getLocal("pIn")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_add(d.getLocal("itIn"),d.i32_const(i))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}var Bp=xp;function xp(e,t,n,i,o,a){typeof a=="undefined"&&(i<o?a=!0:a=!1);const c=e.addFunction(t);c.addParam("pIn1","i32"),c.addParam("pIn2","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn1","i32"),c.addLocal("itIn2","i32"),c.addLocal("itOut","i32");const d=c.getCodeBuilder();a?c.addCode(d.setLocal("itIn1",d.i32_add(d.getLocal("pIn1"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(i)))),d.setLocal("itIn2",d.i32_add(d.getLocal("pIn2"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(i)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(o)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_sub(d.getLocal("itIn1"),d.i32_const(i))),d.setLocal("itIn2",d.i32_sub(d.getLocal("itIn2"),d.i32_const(i))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):c.addCode(d.setLocal("itIn1",d.getLocal("pIn1")),d.setLocal("itIn2",d.getLocal("pIn2")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_add(d.getLocal("itIn1"),d.i32_const(i))),d.setLocal("itIn2",d.i32_add(d.getLocal("itIn2"),d.i32_const(i))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}const Oe=un.exports,Op=vp,Xe=In,Tp=Ka,Pp=Ya,Za=El,Ja=Bp;var Xa=function(t,n,i,o){const a=Oe(n),c=Math.floor((a.minus(1).bitLength()-1)/64)+1,d=c*2,h=c*8,u=i||"f1m";if(t.modules[u])return u;const s=Op(t,c,o),_=t.alloc(h,Xe.bigInt2BytesLE(a,h));t.alloc(Xe.bigInt2BytesLE(Oe.one.shiftLeft(c*64).mod(a),h));const L=t.alloc(Xe.bigInt2BytesLE(Oe.one.shiftLeft(c*64).square().mod(a),h)),g=t.alloc(Xe.bigInt2BytesLE(Oe.one.shiftLeft(c*64).mod(a),h)),F=t.alloc(Xe.bigInt2BytesLE(Oe.zero,h)),T=a.minus(Oe.one),C=T.shiftRight(1),U=t.alloc(h,Xe.bigInt2BytesLE(C,h)),x=C.add(Oe.one),V=t.alloc(h,Xe.bigInt2BytesLE(x,h));t.modules[u]={pq:_,pR2:L,n64:c,q:a,pOne:g,pZero:F,pePlusOne:V};function D(){const q=t.addFunction(u+"_one");q.addParam("pr","i32");const I=q.getCodeBuilder();q.addCode(I.call(s+"_copy",I.i32_const(g),I.getLocal("pr")))}function $(){const q=t.addFunction(u+"_add");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");const I=q.getCodeBuilder();q.addCode(I.if(I.call(s+"_add",I.getLocal("x"),I.getLocal("y"),I.getLocal("r")),I.drop(I.call(s+"_sub",I.getLocal("r"),I.i32_const(_),I.getLocal("r"))),I.if(I.call(s+"_gte",I.getLocal("r"),I.i32_const(_)),I.drop(I.call(s+"_sub",I.getLocal("r"),I.i32_const(_),I.getLocal("r"))))))}function v(){const q=t.addFunction(u+"_sub");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");const I=q.getCodeBuilder();q.addCode(I.if(I.call(s+"_sub",I.getLocal("x"),I.getLocal("y"),I.getLocal("r")),I.drop(I.call(s+"_add",I.getLocal("r"),I.i32_const(_),I.getLocal("r")))))}function m(){const q=t.addFunction(u+"_neg");q.addParam("x","i32"),q.addParam("r","i32");const I=q.getCodeBuilder();q.addCode(I.call(u+"_sub",I.i32_const(F),I.getLocal("x"),I.getLocal("r")))}function y(){const q=t.addFunction(u+"_isNegative");q.addParam("x","i32"),q.setReturnType("i32");const I=q.getCodeBuilder(),J=I.i32_const(t.alloc(h));q.addCode(I.call(u+"_fromMontgomery",I.getLocal("x"),J),I.call(s+"_gte",J,I.i32_const(V)))}function G(){const q=t.addFunction(u+"_sign");q.addParam("x","i32"),q.setReturnType("i32");const I=q.getCodeBuilder(),J=I.i32_const(t.alloc(h));q.addCode(I.if(I.call(s+"_isZero",I.getLocal("x")),I.ret(I.i32_const(0))),I.call(u+"_fromMontgomery",I.getLocal("x"),J),I.if(I.call(s+"_gte",J,I.i32_const(V)),I.ret(I.i32_const(-1))),I.ret(I.i32_const(1)))}function k(){const q=t.alloc(d*d*8),I=t.addFunction(u+"_mReduct");I.addParam("t","i32"),I.addParam("r","i32"),I.addLocal("np32","i64"),I.addLocal("c","i64"),I.addLocal("m","i64");const J=I.getCodeBuilder(),dt=Oe("100000000",16).minus(a.modInv(Oe("100000000",16))).toJSNumber();I.addCode(J.setLocal("np32",J.i64_const(dt)));for(let lt=0;lt<d;lt++){I.addCode(J.setLocal("c",J.i64_const(0))),I.addCode(J.setLocal("m",J.i64_and(J.i64_mul(J.i64_load32_u(J.getLocal("t"),lt*4),J.getLocal("np32")),J.i64_const("0xFFFFFFFF"))));for(let It=0;It<d;It++)I.addCode(J.setLocal("c",J.i64_add(J.i64_add(J.i64_load32_u(J.getLocal("t"),(lt+It)*4),J.i64_shr_u(J.getLocal("c"),J.i64_const(32))),J.i64_mul(J.i64_load32_u(J.i32_const(_),It*4),J.getLocal("m"))))),I.addCode(J.i64_store32(J.getLocal("t"),(lt+It)*4,J.getLocal("c")));I.addCode(J.i64_store32(J.i32_const(q),lt*4,J.i64_shr_u(J.getLocal("c"),J.i64_const(32))))}I.addCode(J.call(u+"_add",J.i32_const(q),J.i32_add(J.getLocal("t"),J.i32_const(d*4)),J.getLocal("r")))}function N(){const q=t.addFunction(u+"_mul");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32"),q.addLocal("c0","i64"),q.addLocal("c1","i64"),q.addLocal("np32","i64");for(let Lt=0;Lt<d;Lt++)q.addLocal("x"+Lt,"i64"),q.addLocal("y"+Lt,"i64"),q.addLocal("m"+Lt,"i64"),q.addLocal("q"+Lt,"i64");const I=q.getCodeBuilder(),J=Oe("100000000",16).minus(a.modInv(Oe("100000000",16))).toJSNumber();q.addCode(I.setLocal("np32",I.i64_const(J)));const dt=[],lt=[],It=[];function Ut(Lt,Et){let Bt,Pt;return dt[Lt]?Bt=I.getLocal("x"+Lt):(Bt=I.teeLocal("x"+Lt,I.i64_load32_u(I.getLocal("x"),Lt*4)),dt[Lt]=!0),lt[Et]?Pt=I.getLocal("y"+Et):(Pt=I.teeLocal("y"+Et,I.i64_load32_u(I.getLocal("y"),Et*4)),lt[Et]=!0),I.i64_mul(Bt,Pt)}function Ot(Lt,Et){let Bt,Pt;return It[Lt]?Bt=I.getLocal("q"+Lt):(Bt=I.teeLocal("q"+Lt,I.i64_load32_u(I.i32_const(0),_+Lt*4)),It[Lt]=!0),Pt=I.getLocal("m"+Et),I.i64_mul(Bt,Pt)}let Ft="c0",Ct="c1";for(let Lt=0;Lt<d*2-1;Lt++){for(let Et=Math.max(0,Lt-d+1);Et<=Lt&&Et<d;Et++){const Bt=Lt-Et;q.addCode(I.setLocal(Ft,I.i64_add(I.i64_and(I.getLocal(Ft),I.i64_const(4294967295)),Ut(Et,Bt)))),q.addCode(I.setLocal(Ct,I.i64_add(I.getLocal(Ct),I.i64_shr_u(I.getLocal(Ft),I.i64_const(32)))))}for(let Et=Math.max(1,Lt-d+1);Et<=Lt&&Et<d;Et++){const Bt=Lt-Et;q.addCode(I.setLocal(Ft,I.i64_add(I.i64_and(I.getLocal(Ft),I.i64_const(4294967295)),Ot(Et,Bt)))),q.addCode(I.setLocal(Ct,I.i64_add(I.getLocal(Ct),I.i64_shr_u(I.getLocal(Ft),I.i64_const(32)))))}Lt<d&&(q.addCode(I.setLocal("m"+Lt,I.i64_and(I.i64_mul(I.i64_and(I.getLocal(Ft),I.i64_const(4294967295)),I.getLocal("np32")),I.i64_const("0xFFFFFFFF")))),q.addCode(I.setLocal(Ft,I.i64_add(I.i64_and(I.getLocal(Ft),I.i64_const(4294967295)),Ot(0,Lt)))),q.addCode(I.setLocal(Ct,I.i64_add(I.getLocal(Ct),I.i64_shr_u(I.getLocal(Ft),I.i64_const(32)))))),Lt>=d&&q.addCode(I.i64_store32(I.getLocal("r"),(Lt-d)*4,I.getLocal(Ft))),[Ft,Ct]=[Ct,Ft],q.addCode(I.setLocal(Ct,I.i64_shr_u(I.getLocal(Ft),I.i64_const(32))))}q.addCode(I.i64_store32(I.getLocal("r"),d*4-4,I.getLocal(Ft))),q.addCode(I.if(I.i32_wrap_i64(I.getLocal(Ct)),I.drop(I.call(s+"_sub",I.getLocal("r"),I.i32_const(_),I.getLocal("r"))),I.if(I.call(s+"_gte",I.getLocal("r"),I.i32_const(_)),I.drop(I.call(s+"_sub",I.getLocal("r"),I.i32_const(_),I.getLocal("r"))))))}function R(){const q=t.addFunction(u+"_square");q.addParam("x","i32"),q.addParam("r","i32"),q.addLocal("c0","i64"),q.addLocal("c1","i64"),q.addLocal("c0_old","i64"),q.addLocal("c1_old","i64"),q.addLocal("np32","i64");for(let Et=0;Et<d;Et++)q.addLocal("x"+Et,"i64"),q.addLocal("m"+Et,"i64"),q.addLocal("q"+Et,"i64");const I=q.getCodeBuilder(),J=Oe("100000000",16).minus(a.modInv(Oe("100000000",16))).toJSNumber();q.addCode(I.setLocal("np32",I.i64_const(J)));const dt=[],lt=[];function It(Et,Bt){let Pt,vt;return dt[Et]?Pt=I.getLocal("x"+Et):(Pt=I.teeLocal("x"+Et,I.i64_load32_u(I.getLocal("x"),Et*4)),dt[Et]=!0),dt[Bt]?vt=I.getLocal("x"+Bt):(vt=I.teeLocal("x"+Bt,I.i64_load32_u(I.getLocal("x"),Bt*4)),dt[Bt]=!0),I.i64_mul(Pt,vt)}function Ut(Et,Bt){let Pt,vt;return lt[Et]?Pt=I.getLocal("q"+Et):(Pt=I.teeLocal("q"+Et,I.i64_load32_u(I.i32_const(0),_+Et*4)),lt[Et]=!0),vt=I.getLocal("m"+Bt),I.i64_mul(Pt,vt)}let Ot="c0",Ft="c1",Ct="c0_old",Lt="c1_old";for(let Et=0;Et<d*2-1;Et++){q.addCode(I.setLocal(Ot,I.i64_const(0)),I.setLocal(Ft,I.i64_const(0)));for(let Bt=Math.max(0,Et-d+1);Bt<Et+1>>1&&Bt<d;Bt++){const Pt=Et-Bt;q.addCode(I.setLocal(Ot,I.i64_add(I.i64_and(I.getLocal(Ot),I.i64_const(4294967295)),It(Bt,Pt)))),q.addCode(I.setLocal(Ft,I.i64_add(I.getLocal(Ft),I.i64_shr_u(I.getLocal(Ot),I.i64_const(32)))))}q.addCode(I.setLocal(Ot,I.i64_shl(I.i64_and(I.getLocal(Ot),I.i64_const(4294967295)),I.i64_const(1)))),q.addCode(I.setLocal(Ft,I.i64_add(I.i64_shl(I.getLocal(Ft),I.i64_const(1)),I.i64_shr_u(I.getLocal(Ot),I.i64_const(32))))),Et%2==0&&(q.addCode(I.setLocal(Ot,I.i64_add(I.i64_and(I.getLocal(Ot),I.i64_const(4294967295)),It(Et>>1,Et>>1)))),q.addCode(I.setLocal(Ft,I.i64_add(I.getLocal(Ft),I.i64_shr_u(I.getLocal(Ot),I.i64_const(32)))))),Et>0&&(q.addCode(I.setLocal(Ot,I.i64_add(I.i64_and(I.getLocal(Ot),I.i64_const(4294967295)),I.i64_and(I.getLocal(Ct),I.i64_const(4294967295))))),q.addCode(I.setLocal(Ft,I.i64_add(I.i64_add(I.getLocal(Ft),I.i64_shr_u(I.getLocal(Ot),I.i64_const(32))),I.getLocal(Lt)))));for(let Bt=Math.max(1,Et-d+1);Bt<=Et&&Bt<d;Bt++){const Pt=Et-Bt;q.addCode(I.setLocal(Ot,I.i64_add(I.i64_and(I.getLocal(Ot),I.i64_const(4294967295)),Ut(Bt,Pt)))),q.addCode(I.setLocal(Ft,I.i64_add(I.getLocal(Ft),I.i64_shr_u(I.getLocal(Ot),I.i64_const(32)))))}Et<d&&(q.addCode(I.setLocal("m"+Et,I.i64_and(I.i64_mul(I.i64_and(I.getLocal(Ot),I.i64_const(4294967295)),I.getLocal("np32")),I.i64_const("0xFFFFFFFF")))),q.addCode(I.setLocal(Ot,I.i64_add(I.i64_and(I.getLocal(Ot),I.i64_const(4294967295)),Ut(0,Et)))),q.addCode(I.setLocal(Ft,I.i64_add(I.getLocal(Ft),I.i64_shr_u(I.getLocal(Ot),I.i64_const(32)))))),Et>=d&&q.addCode(I.i64_store32(I.getLocal("r"),(Et-d)*4,I.getLocal(Ot))),q.addCode(I.setLocal(Ct,I.getLocal(Ft)),I.setLocal(Lt,I.i64_shr_u(I.getLocal(Ct),I.i64_const(32))))}q.addCode(I.i64_store32(I.getLocal("r"),d*4-4,I.getLocal(Ct))),q.addCode(I.if(I.i32_wrap_i64(I.getLocal(Lt)),I.drop(I.call(s+"_sub",I.getLocal("r"),I.i32_const(_),I.getLocal("r"))),I.if(I.call(s+"_gte",I.getLocal("r"),I.i32_const(_)),I.drop(I.call(s+"_sub",I.getLocal("r"),I.i32_const(_),I.getLocal("r"))))))}function E(){const q=t.addFunction(u+"_squareOld");q.addParam("x","i32"),q.addParam("r","i32");const I=q.getCodeBuilder();q.addCode(I.call(u+"_mul",I.getLocal("x"),I.getLocal("x"),I.getLocal("r")))}function z(){const q=t.addFunction(u+"_toMontgomery");q.addParam("x","i32"),q.addParam("r","i32");const I=q.getCodeBuilder();q.addCode(I.call(u+"_mul",I.getLocal("x"),I.i32_const(L),I.getLocal("r")))}function tt(){const q=t.alloc(h*2),I=t.addFunction(u+"_fromMontgomery");I.addParam("x","i32"),I.addParam("r","i32");const J=I.getCodeBuilder();I.addCode(J.call(s+"_copy",J.getLocal("x"),J.i32_const(q))),I.addCode(J.call(s+"_zero",J.i32_const(q+h))),I.addCode(J.call(u+"_mReduct",J.i32_const(q),J.getLocal("r")))}function at(){const q=t.addFunction(u+"_inverse");q.addParam("x","i32"),q.addParam("r","i32");const I=q.getCodeBuilder();q.addCode(I.call(u+"_fromMontgomery",I.getLocal("x"),I.getLocal("r"))),q.addCode(I.call(s+"_inverseMod",I.getLocal("r"),I.i32_const(_),I.getLocal("r"))),q.addCode(I.call(u+"_toMontgomery",I.getLocal("r"),I.getLocal("r")))}let it=Oe(2);if(a.isPrime())for(;!it.modPow(C,a).equals(T);)it=it.add(Oe.one);t.alloc(Xe.bigInt2BytesLE(it.shiftLeft(c*64).mod(a),h));let Z=0,ot=T;for(;!ot.isOdd()&&!ot.isZero();)Z++,ot=ot.shiftRight(1);const nt=t.alloc(h,Xe.bigInt2BytesLE(ot,h)),gt=it.modPow(ot,a),xt=t.alloc(Xe.bigInt2BytesLE(gt.shiftLeft(c*64).mod(a),h)),pt=ot.add(1).shiftRight(1),yt=t.alloc(h,Xe.bigInt2BytesLE(pt,h));function w(){const q=t.addFunction(u+"_sqrt");q.addParam("n","i32"),q.addParam("r","i32"),q.addLocal("m","i32"),q.addLocal("i","i32"),q.addLocal("j","i32");const I=q.getCodeBuilder(),J=I.i32_const(g),dt=I.i32_const(t.alloc(h)),lt=I.i32_const(t.alloc(h)),It=I.i32_const(t.alloc(h)),Ut=I.i32_const(t.alloc(h)),Ot=I.i32_const(t.alloc(h));q.addCode(I.if(I.call(u+"_isZero",I.getLocal("n")),I.ret(I.call(u+"_zero",I.getLocal("r")))),I.setLocal("m",I.i32_const(Z)),I.call(u+"_copy",I.i32_const(xt),dt),I.call(u+"_exp",I.getLocal("n"),I.i32_const(nt),I.i32_const(h),lt),I.call(u+"_exp",I.getLocal("n"),I.i32_const(yt),I.i32_const(h),It),I.block(I.loop(I.br_if(1,I.call(u+"_eq",lt,J)),I.call(u+"_square",lt,Ut),I.setLocal("i",I.i32_const(1)),I.block(I.loop(I.br_if(1,I.call(u+"_eq",Ut,J)),I.call(u+"_square",Ut,Ut),I.setLocal("i",I.i32_add(I.getLocal("i"),I.i32_const(1))),I.br(0))),I.call(u+"_copy",dt,Ot),I.setLocal("j",I.i32_sub(I.i32_sub(I.getLocal("m"),I.getLocal("i")),I.i32_const(1))),I.block(I.loop(I.br_if(1,I.i32_eqz(I.getLocal("j"))),I.call(u+"_square",Ot,Ot),I.setLocal("j",I.i32_sub(I.getLocal("j"),I.i32_const(1))),I.br(0))),I.setLocal("m",I.getLocal("i")),I.call(u+"_square",Ot,dt),I.call(u+"_mul",lt,dt,lt),I.call(u+"_mul",It,Ot,It),I.br(0))),I.if(I.call(u+"_isNegative",It),I.call(u+"_neg",It,I.getLocal("r")),I.call(u+"_copy",It,I.getLocal("r"))))}function f(){const q=t.addFunction(u+"_isSquare");q.addParam("n","i32"),q.setReturnType("i32");const I=q.getCodeBuilder(),J=I.i32_const(g),dt=I.i32_const(t.alloc(h));q.addCode(I.if(I.call(u+"_isZero",I.getLocal("n")),I.ret(I.i32_const(1))),I.call(u+"_exp",I.getLocal("n"),I.i32_const(U),I.i32_const(h),dt),I.call(u+"_eq",dt,J))}function O(){const q=t.addFunction(u+"_load");q.addParam("scalar","i32"),q.addParam("scalarLen","i32"),q.addParam("r","i32"),q.addLocal("p","i32"),q.addLocal("l","i32"),q.addLocal("i","i32"),q.addLocal("j","i32");const I=q.getCodeBuilder(),J=I.i32_const(t.alloc(h)),dt=t.alloc(h),lt=I.i32_const(dt);q.addCode(I.call(s+"_zero",I.getLocal("r")),I.setLocal("i",I.i32_const(h)),I.setLocal("p",I.getLocal("scalar")),I.block(I.loop(I.br_if(1,I.i32_gt_u(I.getLocal("i"),I.getLocal("scalarLen"))),I.if(I.i32_eq(I.getLocal("i"),I.i32_const(h)),I.call(u+"_one",J),I.call(u+"_mul",J,I.i32_const(L),J)),I.call(u+"_mul",I.getLocal("p"),J,lt),I.call(u+"_add",I.getLocal("r"),lt,I.getLocal("r")),I.setLocal("p",I.i32_add(I.getLocal("p"),I.i32_const(h))),I.setLocal("i",I.i32_add(I.getLocal("i"),I.i32_const(h))),I.br(0))),I.setLocal("l",I.i32_rem_u(I.getLocal("scalarLen"),I.i32_const(h))),I.if(I.i32_eqz(I.getLocal("l")),I.ret([])),I.call(s+"_zero",lt),I.setLocal("j",I.i32_const(0)),I.block(I.loop(I.br_if(1,I.i32_eq(I.getLocal("j"),I.getLocal("l"))),I.i32_store8(I.getLocal("j"),dt,I.i32_load8_u(I.getLocal("p"))),I.setLocal("p",I.i32_add(I.getLocal("p"),I.i32_const(1))),I.setLocal("j",I.i32_add(I.getLocal("j"),I.i32_const(1))),I.br(0))),I.if(I.i32_eq(I.getLocal("i"),I.i32_const(h)),I.call(u+"_one",J),I.call(u+"_mul",J,I.i32_const(L),J)),I.call(u+"_mul",lt,J,lt),I.call(u+"_add",I.getLocal("r"),lt,I.getLocal("r")))}function p(){const q=t.addFunction(u+"_timesScalar");q.addParam("x","i32"),q.addParam("scalar","i32"),q.addParam("scalarLen","i32"),q.addParam("r","i32");const I=q.getCodeBuilder(),J=I.i32_const(t.alloc(h));q.addCode(I.call(u+"_load",I.getLocal("scalar"),I.getLocal("scalarLen"),J),I.call(u+"_toMontgomery",J,J),I.call(u+"_mul",I.getLocal("x"),J,I.getLocal("r")))}function W(){const q=t.addFunction(u+"_isOne");q.addParam("x","i32"),q.setReturnType("i32");const I=q.getCodeBuilder();q.addCode(I.ret(I.call(s+"_eq",I.getLocal("x"),I.i32_const(g))))}return t.exportFunction(s+"_copy",u+"_copy"),t.exportFunction(s+"_zero",u+"_zero"),t.exportFunction(s+"_isZero",u+"_isZero"),t.exportFunction(s+"_eq",u+"_eq"),W(),$(),v(),m(),k(),N(),R(),E(),z(),tt(),y(),G(),at(),D(),O(),p(),Pp(t,u),Za(t,u+"_batchToMontgomery",u+"_toMontgomery",h,h),Za(t,u+"_batchFromMontgomery",u+"_fromMontgomery",h,h),Za(t,u+"_batchNeg",u+"_neg",h,h),Ja(t,u+"_batchAdd",u+"_add",h,h),Ja(t,u+"_batchSub",u+"_sub",h,h),Ja(t,u+"_batchMul",u+"_mul",h,h),t.exportFunction(u+"_add"),t.exportFunction(u+"_sub"),t.exportFunction(u+"_neg"),t.exportFunction(u+"_isNegative"),t.exportFunction(u+"_isOne"),t.exportFunction(u+"_sign"),t.exportFunction(u+"_mReduct"),t.exportFunction(u+"_mul"),t.exportFunction(u+"_square"),t.exportFunction(u+"_squareOld"),t.exportFunction(u+"_fromMontgomery"),t.exportFunction(u+"_toMontgomery"),t.exportFunction(u+"_inverse"),t.exportFunction(u+"_one"),t.exportFunction(u+"_load"),t.exportFunction(u+"_timesScalar"),Tp(t,u+"_exp",h,u+"_mul",u+"_square",s+"_copy",u+"_one"),t.exportFunction(u+"_exp"),t.exportFunction(u+"_batchInverse"),a.isPrime()&&(w(),f(),t.exportFunction(u+"_sqrt"),t.exportFunction(u+"_isSquare")),t.exportFunction(u+"_batchToMontgomery"),t.exportFunction(u+"_batchFromMontgomery"),u};const Rp=un.exports,Up=Xa;var Cl=function(t,n,i,o,a){const c=Rp(n),d=Math.floor((c.minus(1).bitLength()-1)/64)+1,h=d*8,u=i||"f1";if(t.modules[u])return u;t.modules[u]={n64:d};const s=a||"int",_=Up(t,c,o,s),L=t.modules[_].pR2,g=t.modules[_].pq,F=t.modules[_].pePlusOne;function T(){const V=t.alloc(h),D=t.addFunction(u+"_mul");D.addParam("x","i32"),D.addParam("y","i32"),D.addParam("r","i32");const $=D.getCodeBuilder();D.addCode($.call(_+"_mul",$.getLocal("x"),$.getLocal("y"),$.i32_const(V))),D.addCode($.call(_+"_mul",$.i32_const(V),$.i32_const(L),$.getLocal("r")))}function C(){const V=t.addFunction(u+"_square");V.addParam("x","i32"),V.addParam("r","i32");const D=V.getCodeBuilder();V.addCode(D.call(u+"_mul",D.getLocal("x"),D.getLocal("x"),D.getLocal("r")))}function U(){const V=t.addFunction(u+"_inverse");V.addParam("x","i32"),V.addParam("r","i32");const D=V.getCodeBuilder();V.addCode(D.call(s+"_inverseMod",D.getLocal("x"),D.i32_const(g),D.getLocal("r")))}function x(){const V=t.addFunction(u+"_isNegative");V.addParam("x","i32"),V.setReturnType("i32");const D=V.getCodeBuilder();V.addCode(D.call(s+"_gte",D.getLocal("x"),D.i32_const(F)))}return T(),C(),U(),x(),t.exportFunction(_+"_add",u+"_add"),t.exportFunction(_+"_sub",u+"_sub"),t.exportFunction(_+"_neg",u+"_neg"),t.exportFunction(u+"_mul"),t.exportFunction(u+"_square"),t.exportFunction(u+"_inverse"),t.exportFunction(u+"_isNegative"),t.exportFunction(_+"_copy",u+"_copy"),t.exportFunction(_+"_zero",u+"_zero"),t.exportFunction(_+"_one",u+"_one"),t.exportFunction(_+"_isZero",u+"_isZero"),t.exportFunction(_+"_eq",u+"_eq"),u};const Mp=Ka,Gp=Ya,wi=un.exports,tr=In;var vl=function(t,n,i,o){if(t.modules[i])return i;const a=t.modules[o].n64*8,c=t.modules[o].q;t.modules[i]={n64:t.modules[o].n64*2};function d(){const R=t.addFunction(i+"_add");R.addParam("x","i32"),R.addParam("y","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("y"),it=E.i32_add(E.getLocal("y"),E.i32_const(a)),Z=E.getLocal("r"),ot=E.i32_add(E.getLocal("r"),E.i32_const(a));R.addCode(E.call(o+"_add",z,at,Z),E.call(o+"_add",tt,it,ot))}function h(){const R=t.addFunction(i+"_timesScalar");R.addParam("x","i32"),R.addParam("scalar","i32"),R.addParam("scalarLen","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("r"),it=E.i32_add(E.getLocal("r"),E.i32_const(a));R.addCode(E.call(o+"_timesScalar",z,E.getLocal("scalar"),E.getLocal("scalarLen"),at),E.call(o+"_timesScalar",tt,E.getLocal("scalar"),E.getLocal("scalarLen"),it))}function u(){const R=t.addFunction(i+"_sub");R.addParam("x","i32"),R.addParam("y","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("y"),it=E.i32_add(E.getLocal("y"),E.i32_const(a)),Z=E.getLocal("r"),ot=E.i32_add(E.getLocal("r"),E.i32_const(a));R.addCode(E.call(o+"_sub",z,at,Z),E.call(o+"_sub",tt,it,ot))}function s(){const R=t.addFunction(i+"_neg");R.addParam("x","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("r"),it=E.i32_add(E.getLocal("r"),E.i32_const(a));R.addCode(E.call(o+"_neg",z,at),E.call(o+"_neg",tt,it))}function _(){const R=t.addFunction(i+"_conjugate");R.addParam("x","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("r"),it=E.i32_add(E.getLocal("r"),E.i32_const(a));R.addCode(E.call(o+"_copy",z,at),E.call(o+"_neg",tt,it))}function L(){const R=t.addFunction(i+"_isNegative");R.addParam("x","i32"),R.setReturnType("i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a));R.addCode(E.if(E.call(o+"_isZero",tt),E.ret(E.call(o+"_isNegative",z))),E.ret(E.call(o+"_isNegative",tt)))}function g(){const R=t.addFunction(i+"_mul");R.addParam("x","i32"),R.addParam("y","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("y"),it=E.i32_add(E.getLocal("y"),E.i32_const(a)),Z=E.getLocal("r"),ot=E.i32_add(E.getLocal("r"),E.i32_const(a)),nt=E.i32_const(t.alloc(a)),gt=E.i32_const(t.alloc(a)),xt=E.i32_const(t.alloc(a)),pt=E.i32_const(t.alloc(a));R.addCode(E.call(o+"_mul",z,at,nt),E.call(o+"_mul",tt,it,gt),E.call(o+"_add",z,tt,xt),E.call(o+"_add",at,it,pt),E.call(o+"_mul",xt,pt,xt),E.call(n,gt,Z),E.call(o+"_add",nt,Z,Z),E.call(o+"_add",nt,gt,ot),E.call(o+"_sub",xt,ot,ot))}function F(){const R=t.addFunction(i+"_mul1");R.addParam("x","i32"),R.addParam("y","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("y"),it=E.getLocal("r"),Z=E.i32_add(E.getLocal("r"),E.i32_const(a));R.addCode(E.call(o+"_mul",z,at,it),E.call(o+"_mul",tt,at,Z))}function T(){const R=t.addFunction(i+"_square");R.addParam("x","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("r"),it=E.i32_add(E.getLocal("r"),E.i32_const(a)),Z=E.i32_const(t.alloc(a)),ot=E.i32_const(t.alloc(a)),nt=E.i32_const(t.alloc(a)),gt=E.i32_const(t.alloc(a));R.addCode(E.call(o+"_mul",z,tt,Z),E.call(o+"_add",z,tt,ot),E.call(n,tt,nt),E.call(o+"_add",z,nt,nt),E.call(n,Z,gt),E.call(o+"_add",gt,Z,gt),E.call(o+"_mul",ot,nt,at),E.call(o+"_sub",at,gt,at),E.call(o+"_add",Z,Z,it))}function C(){const R=t.addFunction(i+"_toMontgomery");R.addParam("x","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("r"),it=E.i32_add(E.getLocal("r"),E.i32_const(a));R.addCode(E.call(o+"_toMontgomery",z,at),E.call(o+"_toMontgomery",tt,it))}function U(){const R=t.addFunction(i+"_fromMontgomery");R.addParam("x","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("r"),it=E.i32_add(E.getLocal("r"),E.i32_const(a));R.addCode(E.call(o+"_fromMontgomery",z,at),E.call(o+"_fromMontgomery",tt,it))}function x(){const R=t.addFunction(i+"_copy");R.addParam("x","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("r"),it=E.i32_add(E.getLocal("r"),E.i32_const(a));R.addCode(E.call(o+"_copy",z,at),E.call(o+"_copy",tt,it))}function V(){const R=t.addFunction(i+"_zero");R.addParam("x","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a));R.addCode(E.call(o+"_zero",z),E.call(o+"_zero",tt))}function D(){const R=t.addFunction(i+"_one");R.addParam("x","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a));R.addCode(E.call(o+"_one",z),E.call(o+"_zero",tt))}function $(){const R=t.addFunction(i+"_eq");R.addParam("x","i32"),R.addParam("y","i32"),R.setReturnType("i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("y"),it=E.i32_add(E.getLocal("y"),E.i32_const(a));R.addCode(E.i32_and(E.call(o+"_eq",z,at),E.call(o+"_eq",tt,it)))}function v(){const R=t.addFunction(i+"_isZero");R.addParam("x","i32"),R.setReturnType("i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a));R.addCode(E.i32_and(E.call(o+"_isZero",z),E.call(o+"_isZero",tt)))}function m(){const R=t.addFunction(i+"_inverse");R.addParam("x","i32"),R.addParam("r","i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a)),at=E.getLocal("r"),it=E.i32_add(E.getLocal("r"),E.i32_const(a)),Z=E.i32_const(t.alloc(a)),ot=E.i32_const(t.alloc(a)),nt=E.i32_const(t.alloc(a)),gt=E.i32_const(t.alloc(a));R.addCode(E.call(o+"_square",z,Z),E.call(o+"_square",tt,ot),E.call(n,ot,nt),E.call(o+"_sub",Z,nt,nt),E.call(o+"_inverse",nt,gt),E.call(o+"_mul",z,gt,at),E.call(o+"_mul",tt,gt,it),E.call(o+"_neg",it,it))}function y(){const R=t.addFunction(i+"_sign");R.addParam("x","i32"),R.addLocal("s","i32"),R.setReturnType("i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a));R.addCode(E.setLocal("s",E.call(o+"_sign",tt)),E.if(E.getLocal("s"),E.ret(E.getLocal("s"))),E.ret(E.call(o+"_sign",z)))}function G(){const R=t.addFunction(i+"_isOne");R.addParam("x","i32"),R.setReturnType("i32");const E=R.getCodeBuilder(),z=E.getLocal("x"),tt=E.i32_add(E.getLocal("x"),E.i32_const(a));R.addCode(E.ret(E.i32_and(E.call(o+"_isOne",z),E.call(o+"_isZero",tt))))}function k(){const R=t.addFunction(i+"_sqrt");R.addParam("a","i32"),R.addParam("pr","i32");const E=R.getCodeBuilder(),z=E.i32_const(t.alloc(tr.bigInt2BytesLE(wi(c).minus(wi(3)).divide(4),a))),tt=E.i32_const(t.alloc(tr.bigInt2BytesLE(wi(c).minus(wi(1)).divide(2),a))),at=E.getLocal("a"),it=E.i32_const(t.alloc(a*2)),Z=E.i32_const(t.alloc(a*2)),ot=E.i32_const(t.alloc(a*2)),nt=t.alloc(a*2),gt=E.i32_const(nt),xt=E.i32_const(nt),pt=E.i32_const(nt+a),yt=E.i32_const(t.alloc(a*2)),w=E.i32_const(t.alloc(a*2));R.addCode(E.call(i+"_one",gt),E.call(i+"_neg",gt,gt),E.call(i+"_exp",at,z,E.i32_const(a),it),E.call(i+"_square",it,Z),E.call(i+"_mul",at,Z,Z),E.call(i+"_conjugate",Z,ot),E.call(i+"_mul",ot,Z,ot),E.if(E.call(i+"_eq",ot,gt),E.unreachable()),E.call(i+"_mul",it,at,yt),E.if(E.call(i+"_eq",Z,gt),[...E.call(o+"_zero",xt),...E.call(o+"_one",pt),...E.call(i+"_mul",gt,yt,E.getLocal("pr"))],[...E.call(i+"_one",w),...E.call(i+"_add",w,Z,w),...E.call(i+"_exp",w,tt,E.i32_const(a),w),...E.call(i+"_mul",w,yt,E.getLocal("pr"))]))}function N(){const R=t.addFunction(i+"_isSquare");R.addParam("a","i32"),R.setReturnType("i32");const E=R.getCodeBuilder(),z=E.i32_const(t.alloc(tr.bigInt2BytesLE(wi(c).minus(wi(3)).divide(4),a))),tt=E.getLocal("a"),at=E.i32_const(t.alloc(a*2)),it=E.i32_const(t.alloc(a*2)),Z=E.i32_const(t.alloc(a*2)),ot=t.alloc(a*2),nt=E.i32_const(ot);R.addCode(E.call(i+"_one",nt),E.call(i+"_neg",nt,nt),E.call(i+"_exp",tt,z,E.i32_const(a),at),E.call(i+"_square",at,it),E.call(i+"_mul",tt,it,it),E.call(i+"_conjugate",it,Z),E.call(i+"_mul",Z,it,Z),E.if(E.call(i+"_eq",Z,nt),E.ret(E.i32_const(0))),E.ret(E.i32_const(1)))}return v(),G(),V(),D(),x(),g(),F(),T(),d(),u(),s(),_(),C(),U(),$(),m(),h(),y(),L(),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_isOne"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_copy"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_mul1"),t.exportFunction(i+"_square"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_neg"),t.exportFunction(i+"_sign"),t.exportFunction(i+"_conjugate"),t.exportFunction(i+"_fromMontgomery"),t.exportFunction(i+"_toMontgomery"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_inverse"),Gp(t,i),Mp(t,i+"_exp",a*2,i+"_mul",i+"_square",i+"_copy",i+"_one"),k(),N(),t.exportFunction(i+"_exp"),t.exportFunction(i+"_timesScalar"),t.exportFunction(i+"_batchInverse"),t.exportFunction(i+"_sqrt"),t.exportFunction(i+"_isSquare"),t.exportFunction(i+"_isNegative"),i};const Np=Ka,qp=Ya;var Fl=function(t,n,i,o){if(t.modules[i])return i;const a=t.modules[o].n64*8;t.modules[i]={n64:t.modules[o].n64*3};function c(){const m=t.addFunction(i+"_add");m.addParam("x","i32"),m.addParam("y","i32"),m.addParam("r","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("y"),E=y.i32_add(y.getLocal("y"),y.i32_const(a)),z=y.i32_add(y.getLocal("y"),y.i32_const(2*a)),tt=y.getLocal("r"),at=y.i32_add(y.getLocal("r"),y.i32_const(a)),it=y.i32_add(y.getLocal("r"),y.i32_const(2*a));m.addCode(y.call(o+"_add",G,R,tt),y.call(o+"_add",k,E,at),y.call(o+"_add",N,z,it))}function d(){const m=t.addFunction(i+"_timesScalar");m.addParam("x","i32"),m.addParam("scalar","i32"),m.addParam("scalarLen","i32"),m.addParam("r","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("r"),E=y.i32_add(y.getLocal("r"),y.i32_const(a)),z=y.i32_add(y.getLocal("r"),y.i32_const(2*a));m.addCode(y.call(o+"_timesScalar",G,y.getLocal("scalar"),y.getLocal("scalarLen"),R),y.call(o+"_timesScalar",k,y.getLocal("scalar"),y.getLocal("scalarLen"),E),y.call(o+"_timesScalar",N,y.getLocal("scalar"),y.getLocal("scalarLen"),z))}function h(){const m=t.addFunction(i+"_sub");m.addParam("x","i32"),m.addParam("y","i32"),m.addParam("r","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("y"),E=y.i32_add(y.getLocal("y"),y.i32_const(a)),z=y.i32_add(y.getLocal("y"),y.i32_const(2*a)),tt=y.getLocal("r"),at=y.i32_add(y.getLocal("r"),y.i32_const(a)),it=y.i32_add(y.getLocal("r"),y.i32_const(2*a));m.addCode(y.call(o+"_sub",G,R,tt),y.call(o+"_sub",k,E,at),y.call(o+"_sub",N,z,it))}function u(){const m=t.addFunction(i+"_neg");m.addParam("x","i32"),m.addParam("r","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("r"),E=y.i32_add(y.getLocal("r"),y.i32_const(a)),z=y.i32_add(y.getLocal("r"),y.i32_const(2*a));m.addCode(y.call(o+"_neg",G,R),y.call(o+"_neg",k,E),y.call(o+"_neg",N,z))}function s(){const m=t.addFunction(i+"_isNegative");m.addParam("x","i32"),m.setReturnType("i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a));m.addCode(y.if(y.call(o+"_isZero",N),y.if(y.call(o+"_isZero",k),y.ret(y.call(o+"_isNegative",G)),y.ret(y.call(o+"_isNegative",k)))),y.ret(y.call(o+"_isNegative",N)))}function _(){const m=t.addFunction(i+"_mul");m.addParam("x","i32"),m.addParam("y","i32"),m.addParam("r","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("y"),E=y.i32_add(y.getLocal("y"),y.i32_const(a)),z=y.i32_add(y.getLocal("y"),y.i32_const(2*a)),tt=y.getLocal("r"),at=y.i32_add(y.getLocal("r"),y.i32_const(a)),it=y.i32_add(y.getLocal("r"),y.i32_const(2*a)),Z=y.i32_const(t.alloc(a)),ot=y.i32_const(t.alloc(a)),nt=y.i32_const(t.alloc(a)),gt=y.i32_const(t.alloc(a)),xt=y.i32_const(t.alloc(a)),pt=y.i32_const(t.alloc(a)),yt=y.i32_const(t.alloc(a)),w=y.i32_const(t.alloc(a)),f=y.i32_const(t.alloc(a)),O=y.i32_const(t.alloc(a)),p=y.i32_const(t.alloc(a)),W=y.i32_const(t.alloc(a)),q=y.i32_const(t.alloc(a));m.addCode(y.call(o+"_mul",G,R,Z),y.call(o+"_mul",k,E,ot),y.call(o+"_mul",N,z,nt),y.call(o+"_add",G,k,gt),y.call(o+"_add",R,E,xt),y.call(o+"_add",G,N,pt),y.call(o+"_add",R,z,yt),y.call(o+"_add",k,N,w),y.call(o+"_add",E,z,f),y.call(o+"_add",Z,ot,O),y.call(o+"_add",Z,nt,p),y.call(o+"_add",ot,nt,W),y.call(o+"_mul",w,f,tt),y.call(o+"_sub",tt,W,tt),y.call(n,tt,tt),y.call(o+"_add",Z,tt,tt),y.call(o+"_mul",gt,xt,at),y.call(o+"_sub",at,O,at),y.call(n,nt,q),y.call(o+"_add",at,q,at),y.call(o+"_mul",pt,yt,it),y.call(o+"_sub",it,p,it),y.call(o+"_add",it,ot,it))}function L(){const m=t.addFunction(i+"_square");m.addParam("x","i32"),m.addParam("r","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("r"),E=y.i32_add(y.getLocal("r"),y.i32_const(a)),z=y.i32_add(y.getLocal("r"),y.i32_const(2*a)),tt=y.i32_const(t.alloc(a)),at=y.i32_const(t.alloc(a)),it=y.i32_const(t.alloc(a)),Z=y.i32_const(t.alloc(a)),ot=y.i32_const(t.alloc(a)),nt=y.i32_const(t.alloc(a)),gt=y.i32_const(t.alloc(a));m.addCode(y.call(o+"_square",G,tt),y.call(o+"_mul",G,k,at),y.call(o+"_add",at,at,it),y.call(o+"_sub",G,k,Z),y.call(o+"_add",Z,N,Z),y.call(o+"_square",Z,Z),y.call(o+"_mul",k,N,ot),y.call(o+"_add",ot,ot,nt),y.call(o+"_square",N,gt),y.call(n,nt,R),y.call(o+"_add",tt,R,R),y.call(n,gt,E),y.call(o+"_add",it,E,E),y.call(o+"_add",tt,gt,z),y.call(o+"_sub",nt,z,z),y.call(o+"_add",Z,z,z),y.call(o+"_add",it,z,z))}function g(){const m=t.addFunction(i+"_toMontgomery");m.addParam("x","i32"),m.addParam("r","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("r"),E=y.i32_add(y.getLocal("r"),y.i32_const(a)),z=y.i32_add(y.getLocal("r"),y.i32_const(2*a));m.addCode(y.call(o+"_toMontgomery",G,R),y.call(o+"_toMontgomery",k,E),y.call(o+"_toMontgomery",N,z))}function F(){const m=t.addFunction(i+"_fromMontgomery");m.addParam("x","i32"),m.addParam("r","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("r"),E=y.i32_add(y.getLocal("r"),y.i32_const(a)),z=y.i32_add(y.getLocal("r"),y.i32_const(2*a));m.addCode(y.call(o+"_fromMontgomery",G,R),y.call(o+"_fromMontgomery",k,E),y.call(o+"_fromMontgomery",N,z))}function T(){const m=t.addFunction(i+"_copy");m.addParam("x","i32"),m.addParam("r","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("r"),E=y.i32_add(y.getLocal("r"),y.i32_const(a)),z=y.i32_add(y.getLocal("r"),y.i32_const(2*a));m.addCode(y.call(o+"_copy",G,R),y.call(o+"_copy",k,E),y.call(o+"_copy",N,z))}function C(){const m=t.addFunction(i+"_zero");m.addParam("x","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a));m.addCode(y.call(o+"_zero",G),y.call(o+"_zero",k),y.call(o+"_zero",N))}function U(){const m=t.addFunction(i+"_one");m.addParam("x","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a));m.addCode(y.call(o+"_one",G),y.call(o+"_zero",k),y.call(o+"_zero",N))}function x(){const m=t.addFunction(i+"_eq");m.addParam("x","i32"),m.addParam("y","i32"),m.setReturnType("i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("y"),E=y.i32_add(y.getLocal("y"),y.i32_const(a)),z=y.i32_add(y.getLocal("y"),y.i32_const(2*a));m.addCode(y.i32_and(y.i32_and(y.call(o+"_eq",G,R),y.call(o+"_eq",k,E)),y.call(o+"_eq",N,z)))}function V(){const m=t.addFunction(i+"_isZero");m.addParam("x","i32"),m.setReturnType("i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a));m.addCode(y.i32_and(y.i32_and(y.call(o+"_isZero",G),y.call(o+"_isZero",k)),y.call(o+"_isZero",N)))}function D(){const m=t.addFunction(i+"_inverse");m.addParam("x","i32"),m.addParam("r","i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a)),R=y.getLocal("r"),E=y.i32_add(y.getLocal("r"),y.i32_const(a)),z=y.i32_add(y.getLocal("r"),y.i32_const(2*a)),tt=y.i32_const(t.alloc(a)),at=y.i32_const(t.alloc(a)),it=y.i32_const(t.alloc(a)),Z=y.i32_const(t.alloc(a)),ot=y.i32_const(t.alloc(a)),nt=y.i32_const(t.alloc(a)),gt=y.i32_const(t.alloc(a)),xt=y.i32_const(t.alloc(a)),pt=y.i32_const(t.alloc(a)),yt=y.i32_const(t.alloc(a)),w=y.i32_const(t.alloc(a));m.addCode(y.call(o+"_square",G,tt),y.call(o+"_square",k,at),y.call(o+"_square",N,it),y.call(o+"_mul",G,k,Z),y.call(o+"_mul",G,N,ot),y.call(o+"_mul",k,N,nt),y.call(n,nt,gt),y.call(o+"_sub",tt,gt,gt),y.call(n,it,xt),y.call(o+"_sub",xt,Z,xt),y.call(o+"_sub",at,ot,pt),y.call(o+"_mul",N,xt,yt),y.call(o+"_mul",k,pt,w),y.call(o+"_add",yt,w,yt),y.call(n,yt,yt),y.call(o+"_mul",G,gt,w),y.call(o+"_add",w,yt,yt),y.call(o+"_inverse",yt,yt),y.call(o+"_mul",yt,gt,R),y.call(o+"_mul",yt,xt,E),y.call(o+"_mul",yt,pt,z))}function $(){const m=t.addFunction(i+"_sign");m.addParam("x","i32"),m.addLocal("s","i32"),m.setReturnType("i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(2*a));m.addCode(y.setLocal("s",y.call(o+"_sign",N)),y.if(y.getLocal("s"),y.ret(y.getLocal("s"))),y.setLocal("s",y.call(o+"_sign",k)),y.if(y.getLocal("s"),y.ret(y.getLocal("s"))),y.ret(y.call(o+"_sign",G)))}function v(){const m=t.addFunction(i+"_isOne");m.addParam("x","i32"),m.setReturnType("i32");const y=m.getCodeBuilder(),G=y.getLocal("x"),k=y.i32_add(y.getLocal("x"),y.i32_const(a)),N=y.i32_add(y.getLocal("x"),y.i32_const(a*2));m.addCode(y.ret(y.i32_and(y.i32_and(y.call(o+"_isOne",G),y.call(o+"_isZero",k)),y.call(o+"_isZero",N))))}return V(),v(),C(),U(),T(),_(),L(),c(),h(),u(),$(),g(),F(),x(),D(),d(),s(),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_isOne"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_copy"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_square"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_neg"),t.exportFunction(i+"_sign"),t.exportFunction(i+"_fromMontgomery"),t.exportFunction(i+"_toMontgomery"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_inverse"),qp(t,i),Np(t,i+"_exp",a*3,i+"_mul",i+"_square",i+"_copy",i+"_one"),t.exportFunction(i+"_exp"),t.exportFunction(i+"_timesScalar"),t.exportFunction(i+"_batchInverse"),t.exportFunction(i+"_isNegative"),i},zp=function(t,n,i,o,a,c,d,h){const u=t.addFunction(n);u.addParam("base","i32"),u.addParam("scalar","i32"),u.addParam("scalarLength","i32"),u.addParam("r","i32"),u.addLocal("old0","i32"),u.addLocal("nbits","i32"),u.addLocal("i","i32"),u.addLocal("last","i32"),u.addLocal("cur","i32"),u.addLocal("carry","i32"),u.addLocal("p","i32");const s=u.getCodeBuilder(),_=s.i32_const(t.alloc(i));function L(F){return s.i32_and(s.i32_shr_u(s.i32_load(s.i32_add(s.getLocal("scalar"),s.i32_and(s.i32_shr_u(F,s.i32_const(3)),s.i32_const(4294967292)))),s.i32_and(F,s.i32_const(31))),s.i32_const(1))}function g(F){return[...s.i32_store8(s.getLocal("p"),s.i32_const(F)),...s.setLocal("p",s.i32_add(s.getLocal("p"),s.i32_const(1)))]}u.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(h,s.getLocal("r")),...s.ret([])]),s.setLocal("nbits",s.i32_shl(s.getLocal("scalarLength"),s.i32_const(3))),s.setLocal("old0",s.i32_load(s.i32_const(0))),s.setLocal("p",s.getLocal("old0")),s.i32_store(s.i32_const(0),s.i32_and(s.i32_add(s.i32_add(s.getLocal("old0"),s.i32_const(32)),s.getLocal("nbits")),s.i32_const(4294967288))),s.setLocal("i",s.i32_const(1)),s.setLocal("last",L(s.i32_const(0))),s.setLocal("carry",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("nbits"))),s.setLocal("cur",L(s.getLocal("i"))),s.if(s.getLocal("last"),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(1)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(255)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(255)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...g(1)])),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(0)],[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...g(0)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...g(0)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...g(0)]))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.getLocal("last"),s.if(s.getLocal("carry"),[...g(255),...g(0),...g(1)],[...g(1)]),s.if(s.getLocal("carry"),[...g(0),...g(1)])),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.call(d,s.getLocal("base"),_),s.call(h,s.getLocal("r")),s.block(s.loop(s.call(a,s.getLocal("r"),s.getLocal("r")),s.setLocal("cur",s.i32_load8_u(s.getLocal("p"))),s.if(s.getLocal("cur"),s.if(s.i32_eq(s.getLocal("cur"),s.i32_const(1)),s.call(o,s.getLocal("r"),_,s.getLocal("r")),s.call(c,s.getLocal("r"),_,s.getLocal("r")))),s.br_if(1,s.i32_eq(s.getLocal("old0"),s.getLocal("p"))),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.br(0))),s.i32_store(s.i32_const(0),s.getLocal("old0")))},Dp=function(t,n,i,o,a){const d=t.modules[n].n64*8;function h(){const L=t.addFunction(i+"_getChunk");L.addParam("pScalar","i32"),L.addParam("scalarSize","i32"),L.addParam("startBit","i32"),L.addParam("chunkSize","i32"),L.addLocal("bitsToEnd","i32"),L.addLocal("mask","i32"),L.setReturnType("i32");const g=L.getCodeBuilder();L.addCode(g.setLocal("bitsToEnd",g.i32_sub(g.i32_mul(g.getLocal("scalarSize"),g.i32_const(8)),g.getLocal("startBit"))),g.if(g.i32_gt_s(g.getLocal("chunkSize"),g.getLocal("bitsToEnd")),g.setLocal("mask",g.i32_sub(g.i32_shl(g.i32_const(1),g.getLocal("bitsToEnd")),g.i32_const(1))),g.setLocal("mask",g.i32_sub(g.i32_shl(g.i32_const(1),g.getLocal("chunkSize")),g.i32_const(1)))),g.i32_and(g.i32_shr_u(g.i32_load(g.i32_add(g.getLocal("pScalar"),g.i32_shr_u(g.getLocal("startBit"),g.i32_const(3))),0,0),g.i32_and(g.getLocal("startBit"),g.i32_const(7))),g.getLocal("mask")))}function u(){const L=t.addFunction(i+"_chunk");L.addParam("pBases","i32"),L.addParam("pScalars","i32"),L.addParam("scalarSize","i32"),L.addParam("n","i32"),L.addParam("startBit","i32"),L.addParam("chunkSize","i32"),L.addParam("pr","i32"),L.addLocal("nChunks","i32"),L.addLocal("itScalar","i32"),L.addLocal("endScalar","i32"),L.addLocal("itBase","i32"),L.addLocal("i","i32"),L.addLocal("j","i32"),L.addLocal("nTable","i32"),L.addLocal("pTable","i32"),L.addLocal("idx","i32"),L.addLocal("pIdxTable","i32");const g=L.getCodeBuilder();L.addCode(g.if(g.i32_eqz(g.getLocal("n")),[...g.call(n+"_zero",g.getLocal("pr")),...g.ret([])]),g.setLocal("nTable",g.i32_shl(g.i32_const(1),g.getLocal("chunkSize"))),g.setLocal("pTable",g.i32_load(g.i32_const(0))),g.i32_store(g.i32_const(0),g.i32_add(g.getLocal("pTable"),g.i32_mul(g.getLocal("nTable"),g.i32_const(d)))),g.setLocal("j",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("j"),g.getLocal("nTable"))),g.call(n+"_zero",g.i32_add(g.getLocal("pTable"),g.i32_mul(g.getLocal("j"),g.i32_const(d)))),g.setLocal("j",g.i32_add(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.setLocal("itBase",g.getLocal("pBases")),g.setLocal("itScalar",g.getLocal("pScalars")),g.setLocal("endScalar",g.i32_add(g.getLocal("pScalars"),g.i32_mul(g.getLocal("n"),g.getLocal("scalarSize")))),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("itScalar"),g.getLocal("endScalar"))),g.setLocal("idx",g.call(i+"_getChunk",g.getLocal("itScalar"),g.getLocal("scalarSize"),g.getLocal("startBit"),g.getLocal("chunkSize"))),g.if(g.getLocal("idx"),[...g.setLocal("pIdxTable",g.i32_add(g.getLocal("pTable"),g.i32_mul(g.i32_sub(g.getLocal("idx"),g.i32_const(1)),g.i32_const(d)))),...g.call(o,g.getLocal("pIdxTable"),g.getLocal("itBase"),g.getLocal("pIdxTable"))]),g.setLocal("itScalar",g.i32_add(g.getLocal("itScalar"),g.getLocal("scalarSize"))),g.setLocal("itBase",g.i32_add(g.getLocal("itBase"),g.i32_const(a))),g.br(0))),g.call(i+"_reduceTable",g.getLocal("pTable"),g.getLocal("chunkSize")),g.call(n+"_copy",g.getLocal("pTable"),g.getLocal("pr")),g.i32_store(g.i32_const(0),g.getLocal("pTable")))}function s(){const L=t.addFunction(i);L.addParam("pBases","i32"),L.addParam("pScalars","i32"),L.addParam("scalarSize","i32"),L.addParam("n","i32"),L.addParam("pr","i32"),L.addLocal("chunkSize","i32"),L.addLocal("nChunks","i32"),L.addLocal("itScalar","i32"),L.addLocal("endScalar","i32"),L.addLocal("itBase","i32"),L.addLocal("itBit","i32"),L.addLocal("i","i32"),L.addLocal("j","i32"),L.addLocal("nTable","i32"),L.addLocal("pTable","i32"),L.addLocal("idx","i32"),L.addLocal("pIdxTable","i32");const g=L.getCodeBuilder(),F=g.i32_const(t.alloc(d)),T=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);L.addCode(g.call(n+"_zero",g.getLocal("pr")),g.if(g.i32_eqz(g.getLocal("n")),g.ret([])),g.setLocal("chunkSize",g.i32_load8_u(g.i32_clz(g.getLocal("n")),T)),g.setLocal("nChunks",g.i32_add(g.i32_div_u(g.i32_sub(g.i32_shl(g.getLocal("scalarSize"),g.i32_const(3)),g.i32_const(1)),g.getLocal("chunkSize")),g.i32_const(1))),g.setLocal("itBit",g.i32_mul(g.i32_sub(g.getLocal("nChunks"),g.i32_const(1)),g.getLocal("chunkSize"))),g.block(g.loop(g.br_if(1,g.i32_lt_s(g.getLocal("itBit"),g.i32_const(0))),g.if(g.i32_eqz(g.call(n+"_isZero",g.getLocal("pr"))),[...g.setLocal("j",g.i32_const(0)),...g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("j"),g.getLocal("chunkSize"))),g.call(n+"_double",g.getLocal("pr"),g.getLocal("pr")),g.setLocal("j",g.i32_add(g.getLocal("j"),g.i32_const(1))),g.br(0)))]),g.call(i+"_chunk",g.getLocal("pBases"),g.getLocal("pScalars"),g.getLocal("scalarSize"),g.getLocal("n"),g.getLocal("itBit"),g.getLocal("chunkSize"),F),g.call(n+"_add",g.getLocal("pr"),F,g.getLocal("pr")),g.setLocal("itBit",g.i32_sub(g.getLocal("itBit"),g.getLocal("chunkSize"))),g.br(0))))}function _(){const L=t.addFunction(i+"_reduceTable");L.addParam("pTable","i32"),L.addParam("p","i32"),L.addLocal("half","i32"),L.addLocal("it1","i32"),L.addLocal("it2","i32"),L.addLocal("pAcc","i32");const g=L.getCodeBuilder();L.addCode(g.if(g.i32_eq(g.getLocal("p"),g.i32_const(1)),g.ret([])),g.setLocal("half",g.i32_shl(g.i32_const(1),g.i32_sub(g.getLocal("p"),g.i32_const(1)))),g.setLocal("it1",g.getLocal("pTable")),g.setLocal("it2",g.i32_add(g.getLocal("pTable"),g.i32_mul(g.getLocal("half"),g.i32_const(d)))),g.setLocal("pAcc",g.i32_sub(g.getLocal("it2"),g.i32_const(d))),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("it1"),g.getLocal("pAcc"))),g.call(n+"_add",g.getLocal("it1"),g.getLocal("it2"),g.getLocal("it1")),g.call(n+"_add",g.getLocal("pAcc"),g.getLocal("it2"),g.getLocal("pAcc")),g.setLocal("it1",g.i32_add(g.getLocal("it1"),g.i32_const(d))),g.setLocal("it2",g.i32_add(g.getLocal("it2"),g.i32_const(d))),g.br(0))),g.call(i+"_reduceTable",g.getLocal("pTable"),g.i32_sub(g.getLocal("p"),g.i32_const(1))),g.setLocal("p",g.i32_sub(g.getLocal("p"),g.i32_const(1))),g.block(g.loop(g.br_if(1,g.i32_eqz(g.getLocal("p"))),g.call(n+"_double",g.getLocal("pAcc"),g.getLocal("pAcc")),g.setLocal("p",g.i32_sub(g.getLocal("p"),g.i32_const(1))),g.br(0))),g.call(n+"_add",g.getLocal("pTable"),g.getLocal("pAcc"),g.getLocal("pTable")))}h(),_(),u(),s(),t.exportFunction(i),t.exportFunction(i+"_chunk")};const Sl=zp,Zi=El,Bl=Dp;var xl=function(t,n,i,o){const a=t.modules[i].n64,c=a*8;if(t.modules[n])return n;t.modules[n]={n64:a*3};function d(){const w=t.addFunction(n+"_isZero");w.addParam("p1","i32"),w.setReturnType("i32");const f=w.getCodeBuilder();w.addCode(f.call(i+"_isZero",f.i32_add(f.getLocal("p1"),f.i32_const(c*2))))}function h(){const w=t.addFunction(n+"_isZeroAffine");w.addParam("p1","i32"),w.setReturnType("i32");const f=w.getCodeBuilder();w.addCode(f.i32_and(f.call(i+"_isZero",f.getLocal("p1")),f.call(i+"_isZero",f.i32_add(f.getLocal("p1"),f.i32_const(c)))))}function u(){const w=t.addFunction(n+"_copy");w.addParam("ps","i32"),w.addParam("pd","i32");const f=w.getCodeBuilder();for(let O=0;O<a*3;O++)w.addCode(f.i64_store(f.getLocal("pd"),O*8,f.i64_load(f.getLocal("ps"),O*8)))}function s(){const w=t.addFunction(n+"_copyAffine");w.addParam("ps","i32"),w.addParam("pd","i32");const f=w.getCodeBuilder();for(let O=0;O<a*2;O++)w.addCode(f.i64_store(f.getLocal("pd"),O*8,f.i64_load(f.getLocal("ps"),O*8)))}function _(){const w=t.addFunction(n+"_zero");w.addParam("pr","i32");const f=w.getCodeBuilder();w.addCode(f.call(i+"_zero",f.getLocal("pr"))),w.addCode(f.call(i+"_one",f.i32_add(f.getLocal("pr"),f.i32_const(c)))),w.addCode(f.call(i+"_zero",f.i32_add(f.getLocal("pr"),f.i32_const(c*2))))}function L(){const w=t.addFunction(n+"_zeroAffine");w.addParam("pr","i32");const f=w.getCodeBuilder();w.addCode(f.call(i+"_zero",f.getLocal("pr"))),w.addCode(f.call(i+"_zero",f.i32_add(f.getLocal("pr"),f.i32_const(c))))}function g(){const w=t.addFunction(n+"_eq");w.addParam("p1","i32"),w.addParam("p2","i32"),w.setReturnType("i32"),w.addLocal("z1","i32"),w.addLocal("z2","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c));w.addCode(f.setLocal("z1",f.i32_add(f.getLocal("p1"),f.i32_const(c*2))));const W=f.getLocal("z1"),q=f.getLocal("p2"),I=f.i32_add(f.getLocal("p2"),f.i32_const(c));w.addCode(f.setLocal("z2",f.i32_add(f.getLocal("p2"),f.i32_const(c*2))));const J=f.getLocal("z2"),dt=f.i32_const(t.alloc(c)),lt=f.i32_const(t.alloc(c)),It=f.i32_const(t.alloc(c)),Ut=f.i32_const(t.alloc(c)),Ot=f.i32_const(t.alloc(c)),Ft=f.i32_const(t.alloc(c)),Ct=f.i32_const(t.alloc(c)),Lt=f.i32_const(t.alloc(c));w.addCode(f.if(f.call(n+"_isZero",f.getLocal("p1")),f.ret(f.call(n+"_isZero",f.getLocal("p2")))),f.if(f.call(n+"_isZero",f.getLocal("p2")),f.ret(f.i32_const(0))),f.if(f.call(i+"_isOne",W),f.ret(f.call(n+"_eqMixed",f.getLocal("p2"),f.getLocal("p1")))),f.if(f.call(i+"_isOne",J),f.ret(f.call(n+"_eqMixed",f.getLocal("p1"),f.getLocal("p2")))),f.call(i+"_square",W,dt),f.call(i+"_square",J,lt),f.call(i+"_mul",O,lt,It),f.call(i+"_mul",q,dt,Ut),f.call(i+"_mul",W,dt,Ot),f.call(i+"_mul",J,lt,Ft),f.call(i+"_mul",p,Ft,Ct),f.call(i+"_mul",I,Ot,Lt),f.if(f.call(i+"_eq",It,Ut),f.if(f.call(i+"_eq",Ct,Lt),f.ret(f.i32_const(1)))),f.ret(f.i32_const(0)))}function F(){const w=t.addFunction(n+"_eqMixed");w.addParam("p1","i32"),w.addParam("p2","i32"),w.setReturnType("i32"),w.addLocal("z1","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c));w.addCode(f.setLocal("z1",f.i32_add(f.getLocal("p1"),f.i32_const(c*2))));const W=f.getLocal("z1"),q=f.getLocal("p2"),I=f.i32_add(f.getLocal("p2"),f.i32_const(c)),J=f.i32_const(t.alloc(c)),dt=f.i32_const(t.alloc(c)),lt=f.i32_const(t.alloc(c)),It=f.i32_const(t.alloc(c));w.addCode(f.if(f.call(n+"_isZero",f.getLocal("p1")),f.ret(f.call(n+"_isZeroAffine",f.getLocal("p2")))),f.if(f.call(n+"_isZeroAffine",f.getLocal("p2")),f.ret(f.i32_const(0))),f.if(f.call(i+"_isOne",W),f.ret(f.call(n+"_eqAffine",f.getLocal("p1"),f.getLocal("p2")))),f.call(i+"_square",W,J),f.call(i+"_mul",q,J,dt),f.call(i+"_mul",W,J,lt),f.call(i+"_mul",I,lt,It),f.if(f.call(i+"_eq",O,dt),f.if(f.call(i+"_eq",p,It),f.ret(f.i32_const(1)))),f.ret(f.i32_const(0)))}function T(){const w=t.addFunction(n+"_double");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c)),W=f.i32_add(f.getLocal("p1"),f.i32_const(c*2)),q=f.getLocal("pr"),I=f.i32_add(f.getLocal("pr"),f.i32_const(c)),J=f.i32_add(f.getLocal("pr"),f.i32_const(c*2)),dt=f.i32_const(t.alloc(c)),lt=f.i32_const(t.alloc(c)),It=f.i32_const(t.alloc(c)),Ut=f.i32_const(t.alloc(c)),Ot=f.i32_const(t.alloc(c)),Ft=f.i32_const(t.alloc(c)),Ct=f.i32_const(t.alloc(c)),Lt=f.i32_const(t.alloc(c));w.addCode(f.if(f.call(n+"_isZero",f.getLocal("p1")),[...f.call(n+"_copy",f.getLocal("p1"),f.getLocal("pr")),...f.ret([])]),f.if(f.call(i+"_isOne",W),[...f.ret(f.call(n+"_doubleAffine",f.getLocal("p1"),f.getLocal("pr"))),...f.ret([])]),f.call(i+"_square",O,dt),f.call(i+"_square",p,lt),f.call(i+"_square",lt,It),f.call(i+"_add",O,lt,Ut),f.call(i+"_square",Ut,Ut),f.call(i+"_sub",Ut,dt,Ut),f.call(i+"_sub",Ut,It,Ut),f.call(i+"_add",Ut,Ut,Ut),f.call(i+"_add",dt,dt,Ot),f.call(i+"_add",Ot,dt,Ot),f.call(i+"_square",Ot,Ft),f.call(i+"_mul",p,W,Ct),f.call(i+"_add",Ut,Ut,q),f.call(i+"_sub",Ft,q,q),f.call(i+"_add",It,It,Lt),f.call(i+"_add",Lt,Lt,Lt),f.call(i+"_add",Lt,Lt,Lt),f.call(i+"_sub",Ut,q,I),f.call(i+"_mul",I,Ot,I),f.call(i+"_sub",I,Lt,I),f.call(i+"_add",Ct,Ct,J))}function C(){const w=t.addFunction(n+"_doubleAffine");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c)),W=f.getLocal("pr"),q=f.i32_add(f.getLocal("pr"),f.i32_const(c)),I=f.i32_add(f.getLocal("pr"),f.i32_const(c*2)),J=f.i32_const(t.alloc(c)),dt=f.i32_const(t.alloc(c)),lt=f.i32_const(t.alloc(c)),It=f.i32_const(t.alloc(c)),Ut=f.i32_const(t.alloc(c)),Ot=f.i32_const(t.alloc(c));w.addCode(f.if(f.call(n+"_isZeroAffine",f.getLocal("p1")),[...f.call(n+"_toJacobian",f.getLocal("p1"),f.getLocal("pr")),...f.ret([])]),f.call(i+"_square",O,J),f.call(i+"_square",p,dt),f.call(i+"_square",dt,lt),f.call(i+"_add",O,dt,It),f.call(i+"_square",It,It),f.call(i+"_sub",It,J,It),f.call(i+"_sub",It,lt,It),f.call(i+"_add",It,It,It),f.call(i+"_add",J,J,Ut),f.call(i+"_add",Ut,J,Ut),f.call(i+"_add",p,p,I),f.call(i+"_square",Ut,W),f.call(i+"_sub",W,It,W),f.call(i+"_sub",W,It,W),f.call(i+"_add",lt,lt,Ot),f.call(i+"_add",Ot,Ot,Ot),f.call(i+"_add",Ot,Ot,Ot),f.call(i+"_sub",It,W,q),f.call(i+"_mul",q,Ut,q),f.call(i+"_sub",q,Ot,q))}function U(){const w=t.addFunction(n+"_eqAffine");w.addParam("p1","i32"),w.addParam("p2","i32"),w.setReturnType("i32"),w.addLocal("z1","i32");const f=w.getCodeBuilder();w.addCode(f.ret(f.i32_and(f.call(i+"_eq",f.getLocal("p1"),f.getLocal("p2")),f.call(i+"_eq",f.i32_add(f.getLocal("p1"),f.i32_const(c)),f.i32_add(f.getLocal("p2"),f.i32_const(c))))))}function x(){const w=t.addFunction(n+"_toMontgomery");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder();w.addCode(f.call(i+"_toMontgomery",f.getLocal("p1"),f.getLocal("pr")));for(let O=1;O<3;O++)w.addCode(f.call(i+"_toMontgomery",f.i32_add(f.getLocal("p1"),f.i32_const(O*c)),f.i32_add(f.getLocal("pr"),f.i32_const(O*c))))}function V(){const w=t.addFunction(n+"_toMontgomeryAffine");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder();w.addCode(f.call(i+"_toMontgomery",f.getLocal("p1"),f.getLocal("pr")));for(let O=1;O<2;O++)w.addCode(f.call(i+"_toMontgomery",f.i32_add(f.getLocal("p1"),f.i32_const(O*c)),f.i32_add(f.getLocal("pr"),f.i32_const(O*c))))}function D(){const w=t.addFunction(n+"_fromMontgomery");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder();w.addCode(f.call(i+"_fromMontgomery",f.getLocal("p1"),f.getLocal("pr")));for(let O=1;O<3;O++)w.addCode(f.call(i+"_fromMontgomery",f.i32_add(f.getLocal("p1"),f.i32_const(O*c)),f.i32_add(f.getLocal("pr"),f.i32_const(O*c))))}function $(){const w=t.addFunction(n+"_fromMontgomeryAffine");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder();w.addCode(f.call(i+"_fromMontgomery",f.getLocal("p1"),f.getLocal("pr")));for(let O=1;O<2;O++)w.addCode(f.call(i+"_fromMontgomery",f.i32_add(f.getLocal("p1"),f.i32_const(O*c)),f.i32_add(f.getLocal("pr"),f.i32_const(O*c))))}function v(){const w=t.addFunction(n+"_add");w.addParam("p1","i32"),w.addParam("p2","i32"),w.addParam("pr","i32"),w.addLocal("z1","i32"),w.addLocal("z2","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c));w.addCode(f.setLocal("z1",f.i32_add(f.getLocal("p1"),f.i32_const(c*2))));const W=f.getLocal("z1"),q=f.getLocal("p2"),I=f.i32_add(f.getLocal("p2"),f.i32_const(c));w.addCode(f.setLocal("z2",f.i32_add(f.getLocal("p2"),f.i32_const(c*2))));const J=f.getLocal("z2"),dt=f.getLocal("pr"),lt=f.i32_add(f.getLocal("pr"),f.i32_const(c)),It=f.i32_add(f.getLocal("pr"),f.i32_const(c*2)),Ut=f.i32_const(t.alloc(c)),Ot=f.i32_const(t.alloc(c)),Ft=f.i32_const(t.alloc(c)),Ct=f.i32_const(t.alloc(c)),Lt=f.i32_const(t.alloc(c)),Et=f.i32_const(t.alloc(c)),Bt=f.i32_const(t.alloc(c)),Pt=f.i32_const(t.alloc(c)),vt=f.i32_const(t.alloc(c)),Wt=f.i32_const(t.alloc(c)),B=f.i32_const(t.alloc(c)),M=f.i32_const(t.alloc(c)),H=f.i32_const(t.alloc(c)),j=f.i32_const(t.alloc(c)),rt=f.i32_const(t.alloc(c)),et=f.i32_const(t.alloc(c)),ct=f.i32_const(t.alloc(c));w.addCode(f.if(f.call(n+"_isZero",f.getLocal("p1")),[...f.call(n+"_copy",f.getLocal("p2"),f.getLocal("pr")),...f.ret([])]),f.if(f.call(n+"_isZero",f.getLocal("p2")),[...f.call(n+"_copy",f.getLocal("p1"),f.getLocal("pr")),...f.ret([])]),f.if(f.call(i+"_isOne",W),[...f.call(n+"_addMixed",q,O,dt),...f.ret([])]),f.if(f.call(i+"_isOne",J),[...f.call(n+"_addMixed",O,q,dt),...f.ret([])]),f.call(i+"_square",W,Ut),f.call(i+"_square",J,Ot),f.call(i+"_mul",O,Ot,Ft),f.call(i+"_mul",q,Ut,Ct),f.call(i+"_mul",W,Ut,Lt),f.call(i+"_mul",J,Ot,Et),f.call(i+"_mul",p,Et,Bt),f.call(i+"_mul",I,Lt,Pt),f.if(f.call(i+"_eq",Ft,Ct),f.if(f.call(i+"_eq",Bt,Pt),[...f.call(n+"_double",f.getLocal("p1"),f.getLocal("pr")),...f.ret([])])),f.call(i+"_sub",Ct,Ft,vt),f.call(i+"_sub",Pt,Bt,Wt),f.call(i+"_add",vt,vt,B),f.call(i+"_square",B,B),f.call(i+"_mul",vt,B,M),f.call(i+"_add",Wt,Wt,H),f.call(i+"_mul",Ft,B,rt),f.call(i+"_square",H,j),f.call(i+"_add",rt,rt,et),f.call(i+"_sub",j,M,dt),f.call(i+"_sub",dt,et,dt),f.call(i+"_mul",Bt,M,ct),f.call(i+"_add",ct,ct,ct),f.call(i+"_sub",rt,dt,lt),f.call(i+"_mul",lt,H,lt),f.call(i+"_sub",lt,ct,lt),f.call(i+"_add",W,J,It),f.call(i+"_square",It,It),f.call(i+"_sub",It,Ut,It),f.call(i+"_sub",It,Ot,It),f.call(i+"_mul",It,vt,It))}function m(){const w=t.addFunction(n+"_addMixed");w.addParam("p1","i32"),w.addParam("p2","i32"),w.addParam("pr","i32"),w.addLocal("z1","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c));w.addCode(f.setLocal("z1",f.i32_add(f.getLocal("p1"),f.i32_const(c*2))));const W=f.getLocal("z1"),q=f.getLocal("p2"),I=f.i32_add(f.getLocal("p2"),f.i32_const(c)),J=f.getLocal("pr"),dt=f.i32_add(f.getLocal("pr"),f.i32_const(c)),lt=f.i32_add(f.getLocal("pr"),f.i32_const(c*2)),It=f.i32_const(t.alloc(c)),Ut=f.i32_const(t.alloc(c)),Ot=f.i32_const(t.alloc(c)),Ft=f.i32_const(t.alloc(c)),Ct=f.i32_const(t.alloc(c)),Lt=f.i32_const(t.alloc(c)),Et=f.i32_const(t.alloc(c)),Bt=f.i32_const(t.alloc(c)),Pt=f.i32_const(t.alloc(c)),vt=f.i32_const(t.alloc(c)),Wt=f.i32_const(t.alloc(c)),B=f.i32_const(t.alloc(c)),M=f.i32_const(t.alloc(c)),H=f.i32_const(t.alloc(c));w.addCode(f.if(f.call(n+"_isZero",f.getLocal("p1")),[...f.call(n+"_copyAffine",f.getLocal("p2"),f.getLocal("pr")),...f.call(i+"_one",f.i32_add(f.getLocal("pr"),f.i32_const(c*2))),...f.ret([])]),f.if(f.call(n+"_isZeroAffine",f.getLocal("p2")),[...f.call(n+"_copy",f.getLocal("p1"),f.getLocal("pr")),...f.ret([])]),f.if(f.call(i+"_isOne",W),[...f.call(n+"_addAffine",O,q,J),...f.ret([])]),f.call(i+"_square",W,It),f.call(i+"_mul",q,It,Ut),f.call(i+"_mul",W,It,Ot),f.call(i+"_mul",I,Ot,Ft),f.if(f.call(i+"_eq",O,Ut),f.if(f.call(i+"_eq",p,Ft),[...f.call(n+"_doubleAffine",f.getLocal("p2"),f.getLocal("pr")),...f.ret([])])),f.call(i+"_sub",Ut,O,Ct),f.call(i+"_sub",Ft,p,Et),f.call(i+"_square",Ct,Lt),f.call(i+"_add",Lt,Lt,Bt),f.call(i+"_add",Bt,Bt,Bt),f.call(i+"_mul",Ct,Bt,Pt),f.call(i+"_add",Et,Et,vt),f.call(i+"_mul",O,Bt,B),f.call(i+"_square",vt,Wt),f.call(i+"_add",B,B,M),f.call(i+"_sub",Wt,Pt,J),f.call(i+"_sub",J,M,J),f.call(i+"_mul",p,Pt,H),f.call(i+"_add",H,H,H),f.call(i+"_sub",B,J,dt),f.call(i+"_mul",dt,vt,dt),f.call(i+"_sub",dt,H,dt),f.call(i+"_add",W,Ct,lt),f.call(i+"_square",lt,lt),f.call(i+"_sub",lt,It,lt),f.call(i+"_sub",lt,Lt,lt))}function y(){const w=t.addFunction(n+"_addAffine");w.addParam("p1","i32"),w.addParam("p2","i32"),w.addParam("pr","i32"),w.addLocal("z1","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c));w.addCode(f.setLocal("z1",f.i32_add(f.getLocal("p1"),f.i32_const(c*2))));const W=f.getLocal("p2"),q=f.i32_add(f.getLocal("p2"),f.i32_const(c)),I=f.getLocal("pr"),J=f.i32_add(f.getLocal("pr"),f.i32_const(c)),dt=f.i32_add(f.getLocal("pr"),f.i32_const(c*2)),lt=f.i32_const(t.alloc(c)),It=f.i32_const(t.alloc(c)),Ut=f.i32_const(t.alloc(c)),Ot=f.i32_const(t.alloc(c)),Ft=f.i32_const(t.alloc(c)),Ct=f.i32_const(t.alloc(c)),Lt=f.i32_const(t.alloc(c)),Et=f.i32_const(t.alloc(c)),Bt=f.i32_const(t.alloc(c)),Pt=f.i32_const(t.alloc(c));w.addCode(f.if(f.call(n+"_isZeroAffine",f.getLocal("p1")),[...f.call(n+"_copyAffine",f.getLocal("p2"),f.getLocal("pr")),...f.call(i+"_one",f.i32_add(f.getLocal("pr"),f.i32_const(c*2))),...f.ret([])]),f.if(f.call(n+"_isZeroAffine",f.getLocal("p2")),[...f.call(n+"_copyAffine",f.getLocal("p1"),f.getLocal("pr")),...f.call(i+"_one",f.i32_add(f.getLocal("pr"),f.i32_const(c*2))),...f.ret([])]),f.if(f.call(i+"_eq",O,W),f.if(f.call(i+"_eq",p,q),[...f.call(n+"_doubleAffine",f.getLocal("p2"),f.getLocal("pr")),...f.ret([])])),f.call(i+"_sub",W,O,lt),f.call(i+"_sub",q,p,Ut),f.call(i+"_square",lt,It),f.call(i+"_add",It,It,Ot),f.call(i+"_add",Ot,Ot,Ot),f.call(i+"_mul",lt,Ot,Ft),f.call(i+"_add",Ut,Ut,Ct),f.call(i+"_mul",O,Ot,Et),f.call(i+"_square",Ct,Lt),f.call(i+"_add",Et,Et,Bt),f.call(i+"_sub",Lt,Ft,I),f.call(i+"_sub",I,Bt,I),f.call(i+"_mul",p,Ft,Pt),f.call(i+"_add",Pt,Pt,Pt),f.call(i+"_sub",Et,I,J),f.call(i+"_mul",J,Ct,J),f.call(i+"_sub",J,Pt,J),f.call(i+"_add",lt,lt,dt))}function G(){const w=t.addFunction(n+"_neg");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c)),W=f.i32_add(f.getLocal("p1"),f.i32_const(c*2)),q=f.getLocal("pr"),I=f.i32_add(f.getLocal("pr"),f.i32_const(c)),J=f.i32_add(f.getLocal("pr"),f.i32_const(c*2));w.addCode(f.call(i+"_copy",O,q),f.call(i+"_neg",p,I),f.call(i+"_copy",W,J))}function k(){const w=t.addFunction(n+"_negAffine");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c)),W=f.getLocal("pr"),q=f.i32_add(f.getLocal("pr"),f.i32_const(c));w.addCode(f.call(i+"_copy",O,W),f.call(i+"_neg",p,q))}function N(){const w=t.addFunction(n+"_sub");w.addParam("p1","i32"),w.addParam("p2","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder(),O=f.i32_const(t.alloc(c*3));w.addCode(f.call(n+"_neg",f.getLocal("p2"),O),f.call(n+"_add",f.getLocal("p1"),O,f.getLocal("pr")))}function R(){const w=t.addFunction(n+"_subMixed");w.addParam("p1","i32"),w.addParam("p2","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder(),O=f.i32_const(t.alloc(c*3));w.addCode(f.call(n+"_negAffine",f.getLocal("p2"),O),f.call(n+"_addMixed",f.getLocal("p1"),O,f.getLocal("pr")))}function E(){const w=t.addFunction(n+"_subAffine");w.addParam("p1","i32"),w.addParam("p2","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder(),O=f.i32_const(t.alloc(c*3));w.addCode(f.call(n+"_negAffine",f.getLocal("p2"),O),f.call(n+"_addAffine",f.getLocal("p1"),O,f.getLocal("pr")))}function z(){const w=t.addFunction(n+"_normalize");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c)),W=f.i32_add(f.getLocal("p1"),f.i32_const(c*2)),q=f.getLocal("pr"),I=f.i32_add(f.getLocal("pr"),f.i32_const(c)),J=f.i32_add(f.getLocal("pr"),f.i32_const(c*2)),dt=f.i32_const(t.alloc(c)),lt=f.i32_const(t.alloc(c)),It=f.i32_const(t.alloc(c));w.addCode(f.if(f.call(n+"_isZero",f.getLocal("p1")),f.call(n+"_zero",f.getLocal("pr")),[...f.call(i+"_inverse",W,dt),...f.call(i+"_square",dt,lt),...f.call(i+"_mul",dt,lt,It),...f.call(i+"_mul",O,lt,q),...f.call(i+"_mul",p,It,I),...f.call(i+"_one",J)]))}function tt(){const w=t.addFunction(n+"_toAffine");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c)),W=f.i32_add(f.getLocal("p1"),f.i32_const(c*2)),q=f.getLocal("pr"),I=f.i32_add(f.getLocal("pr"),f.i32_const(c)),J=f.i32_const(t.alloc(c)),dt=f.i32_const(t.alloc(c)),lt=f.i32_const(t.alloc(c));w.addCode(f.if(f.call(n+"_isZero",f.getLocal("p1")),[...f.call(i+"_zero",q),...f.call(i+"_zero",I)],[...f.call(i+"_inverse",W,J),...f.call(i+"_square",J,dt),...f.call(i+"_mul",J,dt,lt),...f.call(i+"_mul",O,dt,q),...f.call(i+"_mul",p,lt,I)]))}function at(){const w=t.addFunction(n+"_toJacobian");w.addParam("p1","i32"),w.addParam("pr","i32");const f=w.getCodeBuilder(),O=f.getLocal("p1"),p=f.i32_add(f.getLocal("p1"),f.i32_const(c)),W=f.getLocal("pr"),q=f.i32_add(f.getLocal("pr"),f.i32_const(c)),I=f.i32_add(f.getLocal("pr"),f.i32_const(c*2));w.addCode(f.if(f.call(n+"_isZeroAffine",f.getLocal("p1")),f.call(n+"_zero",f.getLocal("pr")),[...f.call(i+"_one",I),...f.call(i+"_copy",p,q),...f.call(i+"_copy",O,W)]))}function it(){const w=t.addFunction(n+"_batchToAffine");w.addParam("pIn","i32"),w.addParam("n","i32"),w.addParam("pOut","i32"),w.addLocal("pAux","i32"),w.addLocal("itIn","i32"),w.addLocal("itAux","i32"),w.addLocal("itOut","i32"),w.addLocal("i","i32");const f=w.getCodeBuilder(),O=f.i32_const(t.alloc(c));w.addCode(f.setLocal("pAux",f.i32_load(f.i32_const(0))),f.i32_store(f.i32_const(0),f.i32_add(f.getLocal("pAux"),f.i32_mul(f.getLocal("n"),f.i32_const(c)))),f.call(i+"_batchInverse",f.i32_add(f.getLocal("pIn"),f.i32_const(c*2)),f.i32_const(c*3),f.getLocal("n"),f.getLocal("pAux"),f.i32_const(c)),f.setLocal("itIn",f.getLocal("pIn")),f.setLocal("itAux",f.getLocal("pAux")),f.setLocal("itOut",f.getLocal("pOut")),f.setLocal("i",f.i32_const(0)),f.block(f.loop(f.br_if(1,f.i32_eq(f.getLocal("i"),f.getLocal("n"))),f.if(f.call(i+"_isZero",f.getLocal("itAux")),[...f.call(i+"_zero",f.getLocal("itOut")),...f.call(i+"_zero",f.i32_add(f.getLocal("itOut"),f.i32_const(c)))],[...f.call(i+"_mul",f.getLocal("itAux"),f.i32_add(f.getLocal("itIn"),f.i32_const(c)),O),...f.call(i+"_square",f.getLocal("itAux"),f.getLocal("itAux")),...f.call(i+"_mul",f.getLocal("itAux"),f.getLocal("itIn"),f.getLocal("itOut")),...f.call(i+"_mul",f.getLocal("itAux"),O,f.i32_add(f.getLocal("itOut"),f.i32_const(c)))]),f.setLocal("itIn",f.i32_add(f.getLocal("itIn"),f.i32_const(c*3))),f.setLocal("itOut",f.i32_add(f.getLocal("itOut"),f.i32_const(c*2))),f.setLocal("itAux",f.i32_add(f.getLocal("itAux"),f.i32_const(c))),f.setLocal("i",f.i32_add(f.getLocal("i"),f.i32_const(1))),f.br(0))),f.i32_store(f.i32_const(0),f.getLocal("pAux")))}function Z(){const w=t.addFunction(n+"__reverseBytes");w.addParam("pIn","i32"),w.addParam("n","i32"),w.addParam("pOut","i32"),w.addLocal("itOut","i32"),w.addLocal("itIn","i32");const f=w.getCodeBuilder();w.addCode(f.setLocal("itOut",f.i32_sub(f.i32_add(f.getLocal("pOut"),f.getLocal("n")),f.i32_const(1))),f.setLocal("itIn",f.getLocal("pIn")),f.block(f.loop(f.br_if(1,f.i32_lt_s(f.getLocal("itOut"),f.getLocal("pOut"))),f.i32_store8(f.getLocal("itOut"),f.i32_load8_u(f.getLocal("itIn"))),f.setLocal("itOut",f.i32_sub(f.getLocal("itOut"),f.i32_const(1))),f.setLocal("itIn",f.i32_add(f.getLocal("itIn"),f.i32_const(1))),f.br(0))))}function ot(){const w=t.addFunction(n+"_LEMtoC");w.addParam("pIn","i32"),w.addParam("pOut","i32");const f=w.getCodeBuilder(),O=f.i32_const(t.alloc(c));w.addCode(f.if(f.call(n+"_isZero",f.getLocal("pIn")),[...f.call(i+"_zero",f.getLocal("pOut")),...f.i32_store8(f.getLocal("pOut"),f.i32_const(64)),...f.ret([])]),f.call(i+"_fromMontgomery",f.getLocal("pIn"),O),f.call(n+"__reverseBytes",O,f.i32_const(c),f.getLocal("pOut")),f.if(f.i32_eq(f.call(i+"_sign",f.i32_add(f.getLocal("pIn"),f.i32_const(c))),f.i32_const(-1)),f.i32_store8(f.getLocal("pOut"),f.i32_or(f.i32_load8_u(f.getLocal("pOut")),f.i32_const(128)))))}function nt(){const w=t.addFunction(n+"_LEMtoU");w.addParam("pIn","i32"),w.addParam("pOut","i32");const f=w.getCodeBuilder(),O=t.alloc(c*2),p=f.i32_const(O),W=f.i32_const(O),q=f.i32_const(O+c);w.addCode(f.if(f.call(n+"_isZeroAffine",f.getLocal("pIn")),[...f.call(n+"_zeroAffine",f.getLocal("pOut")),...f.i32_store8(f.getLocal("pOut"),f.i32_const(64)),...f.ret([])]),f.call(n+"_fromMontgomeryAffine",f.getLocal("pIn"),p),f.call(n+"__reverseBytes",W,f.i32_const(c),f.getLocal("pOut")),f.call(n+"__reverseBytes",q,f.i32_const(c),f.i32_add(f.getLocal("pOut"),f.i32_const(c))))}function gt(){const w=t.addFunction(n+"_UtoLEM");w.addParam("pIn","i32"),w.addParam("pOut","i32");const f=w.getCodeBuilder(),O=t.alloc(c*2),p=f.i32_const(O),W=f.i32_const(O),q=f.i32_const(O+c);w.addCode(f.if(f.i32_and(f.i32_load8_u(f.getLocal("pIn")),f.i32_const(64)),[...f.call(n+"_zeroAffine",f.getLocal("pOut")),...f.ret([])]),f.call(n+"__reverseBytes",f.getLocal("pIn"),f.i32_const(c),W),f.call(n+"__reverseBytes",f.i32_add(f.getLocal("pIn"),f.i32_const(c)),f.i32_const(c),q),f.call(n+"_toMontgomeryAffine",p,f.getLocal("pOut")))}function xt(){const w=t.addFunction(n+"_CtoLEM");w.addParam("pIn","i32"),w.addParam("pOut","i32"),w.addLocal("firstByte","i32"),w.addLocal("greatest","i32");const f=w.getCodeBuilder(),O=t.alloc(c*2),p=f.i32_const(O),W=f.i32_const(O+c);w.addCode(f.setLocal("firstByte",f.i32_load8_u(f.getLocal("pIn"))),f.if(f.i32_and(f.getLocal("firstByte"),f.i32_const(64)),[...f.call(n+"_zeroAffine",f.getLocal("pOut")),...f.ret([])]),f.setLocal("greatest",f.i32_and(f.getLocal("firstByte"),f.i32_const(128))),f.call(i+"_copy",f.getLocal("pIn"),W),f.i32_store8(W,f.i32_and(f.getLocal("firstByte"),f.i32_const(63))),f.call(n+"__reverseBytes",W,f.i32_const(c),p),f.call(i+"_toMontgomery",p,f.getLocal("pOut")),f.call(i+"_square",f.getLocal("pOut"),W),f.call(i+"_mul",f.getLocal("pOut"),W,W),f.call(i+"_add",W,f.i32_const(o),W),f.call(i+"_sqrt",W,W),f.call(i+"_neg",W,p),f.if(f.i32_eq(f.call(i+"_sign",W),f.i32_const(-1)),f.if(f.getLocal("greatest"),f.call(i+"_copy",W,f.i32_add(f.getLocal("pOut"),f.i32_const(c))),f.call(i+"_neg",W,f.i32_add(f.getLocal("pOut"),f.i32_const(c)))),f.if(f.getLocal("greatest"),f.call(i+"_neg",W,f.i32_add(f.getLocal("pOut"),f.i32_const(c))),f.call(i+"_copy",W,f.i32_add(f.getLocal("pOut"),f.i32_const(c))))))}function pt(){const w=t.addFunction(n+"_inCurveAffine");w.addParam("pIn","i32"),w.setReturnType("i32");const f=w.getCodeBuilder(),O=f.getLocal("pIn"),p=f.i32_add(f.getLocal("pIn"),c),W=t.alloc(c*2),q=t.alloc(c*2);w.addCode(f.call(i+"_square",p,W),f.call(i+"_square",O,q),f.call(i+"_mul",O,q,q),f.call(i+"_add",q,f.i32_const(o),q),f.ret(f.call(i+"_eq",W,q)))}function pt(){const w=t.addFunction(n+"_inCurveAffine");w.addParam("pIn","i32"),w.setReturnType("i32");const f=w.getCodeBuilder(),O=f.getLocal("pIn"),p=f.i32_add(f.getLocal("pIn"),f.i32_const(c)),W=f.i32_const(t.alloc(c)),q=f.i32_const(t.alloc(c));w.addCode(f.call(i+"_square",p,W),f.call(i+"_square",O,q),f.call(i+"_mul",O,q,q),f.call(i+"_add",q,f.i32_const(o),q),f.ret(f.call(i+"_eq",W,q)))}function yt(){const w=t.addFunction(n+"_inCurve");w.addParam("pIn","i32"),w.setReturnType("i32");const f=w.getCodeBuilder(),O=f.i32_const(t.alloc(c*2));w.addCode(f.call(n+"_toAffine",f.getLocal("pIn"),O),f.ret(f.call(n+"_inCurveAffine",O)))}return h(),d(),L(),_(),s(),u(),at(),U(),F(),g(),C(),T(),y(),m(),v(),k(),G(),E(),R(),N(),$(),D(),V(),x(),tt(),pt(),yt(),it(),z(),Z(),nt(),ot(),gt(),xt(),Zi(t,n+"_batchLEMtoU",n+"_LEMtoU",c*2,c*2),Zi(t,n+"_batchLEMtoC",n+"_LEMtoC",c*2,c),Zi(t,n+"_batchUtoLEM",n+"_UtoLEM",c*2,c*2),Zi(t,n+"_batchCtoLEM",n+"_CtoLEM",c,c*2,!0),Zi(t,n+"_batchToJacobian",n+"_toJacobian",c*2,c*3,!0),Bl(t,n,n+"_multiexp",n+"_add",c*3),Bl(t,n,n+"_multiexpAffine",n+"_addMixed",c*2),Sl(t,n+"_timesScalar",c*3,n+"_add",n+"_double",n+"_sub",n+"_copy",n+"_zero"),Sl(t,n+"_timesScalarAffine",c*2,n+"_addMixed",n+"_double",n+"_subMixed",n+"_copyAffine",n+"_zero"),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_isZeroAffine"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_eqMixed"),t.exportFunction(n+"_eqAffine"),t.exportFunction(n+"_copy"),t.exportFunction(n+"_copyAffine"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_zeroAffine"),t.exportFunction(n+"_double"),t.exportFunction(n+"_doubleAffine"),t.exportFunction(n+"_add"),t.exportFunction(n+"_addMixed"),t.exportFunction(n+"_addAffine"),t.exportFunction(n+"_neg"),t.exportFunction(n+"_negAffine"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_subMixed"),t.exportFunction(n+"_subAffine"),t.exportFunction(n+"_fromMontgomery"),t.exportFunction(n+"_fromMontgomeryAffine"),t.exportFunction(n+"_toMontgomery"),t.exportFunction(n+"_toMontgomeryAffine"),t.exportFunction(n+"_timesScalar"),t.exportFunction(n+"_timesScalarAffine"),t.exportFunction(n+"_normalize"),t.exportFunction(n+"_LEMtoU"),t.exportFunction(n+"_LEMtoC"),t.exportFunction(n+"_UtoLEM"),t.exportFunction(n+"_CtoLEM"),t.exportFunction(n+"_batchLEMtoU"),t.exportFunction(n+"_batchLEMtoC"),t.exportFunction(n+"_batchUtoLEM"),t.exportFunction(n+"_batchCtoLEM"),t.exportFunction(n+"_toAffine"),t.exportFunction(n+"_toJacobian"),t.exportFunction(n+"_batchToAffine"),t.exportFunction(n+"_batchToJacobian"),t.exportFunction(n+"_inCurve"),t.exportFunction(n+"_inCurveAffine"),n};const Ii=un.exports,To=In;var Ol=function(t,n,i,o,a){const d=t.modules[o].n64*8,u=t.modules[i].n64*8,s=t.modules[o].q;let _=s.minus(Ii(1)),L=0;for(;!_.isOdd();)L++,_=_.shiftRight(1);let g=Ii(2);for(;g.modPow(s.shiftRight(1),s).equals(1);)g=g.add(1);const F=new Array(L+1);F[L]=g.modPow(_,s);let T=L-1;for(;T>=0;)F[T]=F[T+1].modPow(2,s),T--;const C=[],U=Ii(1).shiftLeft(d*8).mod(s);for(let O=0;O<F.length;O++){const p=F[O].times(U).mod(s);C.push(...To.bigInt2BytesLE(p,d))}const x=t.alloc(C),V=new Array(L+1);V[0]=Ii(1);for(let O=1;O<=L;O++)V[O]=V[O-1].times(2);const D=[];for(let O=0;O<=L;O++){const p=V[O].modInv(s).times(U).mod(s);D.push(...To.bigInt2BytesLE(p,d))}const $=t.alloc(D),v=g.modPow(2,s),m=[],y=[];for(let O=0;O<=L;O++){const p=v.modPow(Ii(2).pow(O),s),W=s.add(Ii.one).minus(p).modInv(s);m.push(...To.bigInt2BytesLE(p.times(U).mod(s),d)),y.push(...To.bigInt2BytesLE(W.times(U).mod(s),d))}const G=t.alloc(m),k=t.alloc(y);function N(O){let p=0;for(let W=0;W<8;W++)O&1<<W&&(p=p|128>>W);return p}const R=Array(256);for(let O=0;O<256;O++)R[O]=N(O);const E=t.alloc(R);function z(){const O=t.addFunction(n+"__log2");O.addParam("n","i32"),O.setReturnType("i32"),O.addLocal("bits","i32"),O.addLocal("aux","i32");const p=O.getCodeBuilder();O.addCode(p.setLocal("aux",p.i32_shr_u(p.getLocal("n"),p.i32_const(1)))),O.addCode(p.setLocal("bits",p.i32_const(0))),O.addCode(p.block(p.loop(p.br_if(1,p.i32_eqz(p.getLocal("aux"))),p.setLocal("aux",p.i32_shr_u(p.getLocal("aux"),p.i32_const(1))),p.setLocal("bits",p.i32_add(p.getLocal("bits"),p.i32_const(1))),p.br(0)))),O.addCode(p.if(p.i32_ne(p.getLocal("n"),p.i32_shl(p.i32_const(1),p.getLocal("bits"))),p.unreachable())),O.addCode(p.if(p.i32_gt_u(p.getLocal("bits"),p.i32_const(L)),p.unreachable())),O.addCode(p.getLocal("bits"))}function tt(){const O=t.addFunction(n+"_fft");O.addParam("px","i32"),O.addParam("n","i32"),O.addLocal("bits","i32");const p=O.getCodeBuilder(),W=p.i32_const(t.alloc(d));O.addCode(p.setLocal("bits",p.call(n+"__log2",p.getLocal("n"))),p.call(o+"_one",W),p.call(n+"_rawfft",p.getLocal("px"),p.getLocal("bits"),p.i32_const(0),W))}function at(){const O=t.addFunction(n+"_ifft");O.addParam("px","i32"),O.addParam("n","i32"),O.addLocal("bits","i32"),O.addLocal("pInv2","i32");const p=O.getCodeBuilder();O.addCode(p.setLocal("bits",p.call(n+"__log2",p.getLocal("n"))),p.setLocal("pInv2",p.i32_add(p.i32_const($),p.i32_mul(p.getLocal("bits"),p.i32_const(d)))),p.call(n+"_rawfft",p.getLocal("px"),p.getLocal("bits"),p.i32_const(1),p.getLocal("pInv2")))}function it(){const O=t.addFunction(n+"_rawfft");O.addParam("px","i32"),O.addParam("bits","i32"),O.addParam("reverse","i32"),O.addParam("mulFactor","i32"),O.addLocal("s","i32"),O.addLocal("k","i32"),O.addLocal("j","i32"),O.addLocal("m","i32"),O.addLocal("mdiv2","i32"),O.addLocal("n","i32"),O.addLocal("pwm","i32"),O.addLocal("idx1","i32"),O.addLocal("idx2","i32");const p=O.getCodeBuilder(),W=p.i32_const(t.alloc(d)),q=p.i32_const(t.alloc(u)),I=p.i32_const(t.alloc(u));O.addCode(p.call(n+"__reversePermutation",p.getLocal("px"),p.getLocal("bits")),p.setLocal("n",p.i32_shl(p.i32_const(1),p.getLocal("bits"))),p.setLocal("s",p.i32_const(1)),p.block(p.loop(p.br_if(1,p.i32_gt_u(p.getLocal("s"),p.getLocal("bits"))),p.setLocal("m",p.i32_shl(p.i32_const(1),p.getLocal("s"))),p.setLocal("pwm",p.i32_add(p.i32_const(x),p.i32_mul(p.getLocal("s"),p.i32_const(d)))),p.setLocal("k",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_ge_u(p.getLocal("k"),p.getLocal("n"))),p.call(o+"_one",W),p.setLocal("mdiv2",p.i32_shr_u(p.getLocal("m"),p.i32_const(1))),p.setLocal("j",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_ge_u(p.getLocal("j"),p.getLocal("mdiv2"))),p.setLocal("idx1",p.i32_add(p.getLocal("px"),p.i32_mul(p.i32_add(p.getLocal("k"),p.getLocal("j")),p.i32_const(u)))),p.setLocal("idx2",p.i32_add(p.getLocal("idx1"),p.i32_mul(p.getLocal("mdiv2"),p.i32_const(u)))),p.call(a,p.getLocal("idx2"),W,q),p.call(i+"_copy",p.getLocal("idx1"),I),p.call(i+"_add",I,q,p.getLocal("idx1")),p.call(i+"_sub",I,q,p.getLocal("idx2")),p.call(o+"_mul",W,p.getLocal("pwm"),W),p.setLocal("j",p.i32_add(p.getLocal("j"),p.i32_const(1))),p.br(0))),p.setLocal("k",p.i32_add(p.getLocal("k"),p.getLocal("m"))),p.br(0))),p.setLocal("s",p.i32_add(p.getLocal("s"),p.i32_const(1))),p.br(0))),p.call(n+"__fftFinal",p.getLocal("px"),p.getLocal("bits"),p.getLocal("reverse"),p.getLocal("mulFactor")))}function Z(){const O=t.addFunction(n+"__fftFinal");O.addParam("px","i32"),O.addParam("bits","i32"),O.addParam("reverse","i32"),O.addParam("mulFactor","i32"),O.addLocal("n","i32"),O.addLocal("ndiv2","i32"),O.addLocal("pInv2","i32"),O.addLocal("i","i32"),O.addLocal("mask","i32"),O.addLocal("idx1","i32"),O.addLocal("idx2","i32");const p=O.getCodeBuilder(),W=p.i32_const(t.alloc(u));O.addCode(p.if(p.i32_and(p.i32_eqz(p.getLocal("reverse")),p.call(o+"_isOne",p.getLocal("mulFactor"))),p.ret([])),p.setLocal("n",p.i32_shl(p.i32_const(1),p.getLocal("bits"))),p.setLocal("mask",p.i32_sub(p.getLocal("n"),p.i32_const(1))),p.setLocal("i",p.i32_const(1)),p.setLocal("ndiv2",p.i32_shr_u(p.getLocal("n"),p.i32_const(1))),p.block(p.loop(p.br_if(1,p.i32_ge_u(p.getLocal("i"),p.getLocal("ndiv2"))),p.setLocal("idx1",p.i32_add(p.getLocal("px"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.setLocal("idx2",p.i32_add(p.getLocal("px"),p.i32_mul(p.i32_sub(p.getLocal("n"),p.getLocal("i")),p.i32_const(u)))),p.if(p.getLocal("reverse"),p.if(p.call(o+"_isOne",p.getLocal("mulFactor")),[...p.call(i+"_copy",p.getLocal("idx1"),W),...p.call(i+"_copy",p.getLocal("idx2"),p.getLocal("idx1")),...p.call(i+"_copy",W,p.getLocal("idx2"))],[...p.call(i+"_copy",p.getLocal("idx1"),W),...p.call(a,p.getLocal("idx2"),p.getLocal("mulFactor"),p.getLocal("idx1")),...p.call(a,W,p.getLocal("mulFactor"),p.getLocal("idx2"))]),p.if(p.call(o+"_isOne",p.getLocal("mulFactor")),[],[...p.call(a,p.getLocal("idx1"),p.getLocal("mulFactor"),p.getLocal("idx1")),...p.call(a,p.getLocal("idx2"),p.getLocal("mulFactor"),p.getLocal("idx2"))])),p.setLocal("i",p.i32_add(p.getLocal("i"),p.i32_const(1))),p.br(0))),p.if(p.call(o+"_isOne",p.getLocal("mulFactor")),[],[...p.call(a,p.getLocal("px"),p.getLocal("mulFactor"),p.getLocal("px")),...p.setLocal("idx2",p.i32_add(p.getLocal("px"),p.i32_mul(p.getLocal("ndiv2"),p.i32_const(u)))),...p.call(a,p.getLocal("idx2"),p.getLocal("mulFactor"),p.getLocal("idx2"))]))}function ot(){const O=t.addFunction(n+"__reversePermutation");O.addParam("px","i32"),O.addParam("bits","i32"),O.addLocal("n","i32"),O.addLocal("i","i32"),O.addLocal("ri","i32"),O.addLocal("idx1","i32"),O.addLocal("idx2","i32");const p=O.getCodeBuilder(),W=p.i32_const(t.alloc(u));O.addCode(p.setLocal("n",p.i32_shl(p.i32_const(1),p.getLocal("bits"))),p.setLocal("i",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("i"),p.getLocal("n"))),p.setLocal("idx1",p.i32_add(p.getLocal("px"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.setLocal("ri",p.call(n+"__rev",p.getLocal("i"),p.getLocal("bits"))),p.setLocal("idx2",p.i32_add(p.getLocal("px"),p.i32_mul(p.getLocal("ri"),p.i32_const(u)))),p.if(p.i32_lt_u(p.getLocal("i"),p.getLocal("ri")),[...p.call(i+"_copy",p.getLocal("idx1"),W),...p.call(i+"_copy",p.getLocal("idx2"),p.getLocal("idx1")),...p.call(i+"_copy",W,p.getLocal("idx2"))]),p.setLocal("i",p.i32_add(p.getLocal("i"),p.i32_const(1))),p.br(0))))}function nt(){const O=t.addFunction(n+"__rev");O.addParam("x","i32"),O.addParam("bits","i32"),O.setReturnType("i32");const p=O.getCodeBuilder();O.addCode(p.i32_rotl(p.i32_add(p.i32_add(p.i32_shl(p.i32_load8_u(p.i32_and(p.getLocal("x"),p.i32_const(255)),E,0),p.i32_const(24)),p.i32_shl(p.i32_load8_u(p.i32_and(p.i32_shr_u(p.getLocal("x"),p.i32_const(8)),p.i32_const(255)),E,0),p.i32_const(16))),p.i32_add(p.i32_shl(p.i32_load8_u(p.i32_and(p.i32_shr_u(p.getLocal("x"),p.i32_const(16)),p.i32_const(255)),E,0),p.i32_const(8)),p.i32_load8_u(p.i32_and(p.i32_shr_u(p.getLocal("x"),p.i32_const(24)),p.i32_const(255)),E,0))),p.getLocal("bits")))}function gt(){const O=t.addFunction(n+"_fftJoin");O.addParam("pBuff1","i32"),O.addParam("pBuff2","i32"),O.addParam("n","i32"),O.addParam("first","i32"),O.addParam("inc","i32"),O.addLocal("idx1","i32"),O.addLocal("idx2","i32"),O.addLocal("i","i32");const p=O.getCodeBuilder(),W=p.i32_const(t.alloc(d)),q=p.i32_const(t.alloc(u)),I=p.i32_const(t.alloc(u));O.addCode(p.call(o+"_copy",p.getLocal("first"),W),p.setLocal("i",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("i"),p.getLocal("n"))),p.setLocal("idx1",p.i32_add(p.getLocal("pBuff1"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.setLocal("idx2",p.i32_add(p.getLocal("pBuff2"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.call(a,p.getLocal("idx2"),W,q),p.call(i+"_copy",p.getLocal("idx1"),I),p.call(i+"_add",I,q,p.getLocal("idx1")),p.call(i+"_sub",I,q,p.getLocal("idx2")),p.call(o+"_mul",W,p.getLocal("inc"),W),p.setLocal("i",p.i32_add(p.getLocal("i"),p.i32_const(1))),p.br(0))))}function xt(){const O=t.addFunction(n+"_fftJoinExt");O.addParam("pBuff1","i32"),O.addParam("pBuff2","i32"),O.addParam("n","i32"),O.addParam("first","i32"),O.addParam("inc","i32"),O.addParam("totalBits","i32"),O.addLocal("idx1","i32"),O.addLocal("idx2","i32"),O.addLocal("i","i32"),O.addLocal("pShiftToM","i32");const p=O.getCodeBuilder(),W=p.i32_const(t.alloc(d)),q=p.i32_const(t.alloc(u));O.addCode(p.setLocal("pShiftToM",p.i32_add(p.i32_const(G),p.i32_mul(p.getLocal("totalBits"),p.i32_const(d)))),p.call(o+"_copy",p.getLocal("first"),W),p.setLocal("i",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("i"),p.getLocal("n"))),p.setLocal("idx1",p.i32_add(p.getLocal("pBuff1"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.setLocal("idx2",p.i32_add(p.getLocal("pBuff2"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.call(i+"_add",p.getLocal("idx1"),p.getLocal("idx2"),q),p.call(a,p.getLocal("idx2"),p.getLocal("pShiftToM"),p.getLocal("idx2")),p.call(i+"_add",p.getLocal("idx1"),p.getLocal("idx2"),p.getLocal("idx2")),p.call(a,p.getLocal("idx2"),W,p.getLocal("idx2")),p.call(i+"_copy",q,p.getLocal("idx1")),p.call(o+"_mul",W,p.getLocal("inc"),W),p.setLocal("i",p.i32_add(p.getLocal("i"),p.i32_const(1))),p.br(0))))}function pt(){const O=t.addFunction(n+"_fftJoinExtInv");O.addParam("pBuff1","i32"),O.addParam("pBuff2","i32"),O.addParam("n","i32"),O.addParam("first","i32"),O.addParam("inc","i32"),O.addParam("totalBits","i32"),O.addLocal("idx1","i32"),O.addLocal("idx2","i32"),O.addLocal("i","i32"),O.addLocal("pShiftToM","i32"),O.addLocal("pSConst","i32");const p=O.getCodeBuilder(),W=p.i32_const(t.alloc(d)),q=p.i32_const(t.alloc(u));O.addCode(p.setLocal("pShiftToM",p.i32_add(p.i32_const(G),p.i32_mul(p.getLocal("totalBits"),p.i32_const(d)))),p.setLocal("pSConst",p.i32_add(p.i32_const(k),p.i32_mul(p.getLocal("totalBits"),p.i32_const(d)))),p.call(o+"_copy",p.getLocal("first"),W),p.setLocal("i",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("i"),p.getLocal("n"))),p.setLocal("idx1",p.i32_add(p.getLocal("pBuff1"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.setLocal("idx2",p.i32_add(p.getLocal("pBuff2"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.call(a,p.getLocal("idx2"),W,q),p.call(i+"_sub",p.getLocal("idx1"),q,p.getLocal("idx2")),p.call(a,p.getLocal("idx2"),p.getLocal("pSConst"),p.getLocal("idx2")),p.call(a,p.getLocal("idx1"),p.getLocal("pShiftToM"),p.getLocal("idx1")),p.call(i+"_sub",q,p.getLocal("idx1"),p.getLocal("idx1")),p.call(a,p.getLocal("idx1"),p.getLocal("pSConst"),p.getLocal("idx1")),p.call(o+"_mul",W,p.getLocal("inc"),W),p.setLocal("i",p.i32_add(p.getLocal("i"),p.i32_const(1))),p.br(0))))}function yt(){const O=t.addFunction(n+"_prepareLagrangeEvaluation");O.addParam("pBuff1","i32"),O.addParam("pBuff2","i32"),O.addParam("n","i32"),O.addParam("first","i32"),O.addParam("inc","i32"),O.addParam("totalBits","i32"),O.addLocal("idx1","i32"),O.addLocal("idx2","i32"),O.addLocal("i","i32"),O.addLocal("pShiftToM","i32"),O.addLocal("pSConst","i32");const p=O.getCodeBuilder(),W=p.i32_const(t.alloc(d)),q=p.i32_const(t.alloc(u));O.addCode(p.setLocal("pShiftToM",p.i32_add(p.i32_const(G),p.i32_mul(p.getLocal("totalBits"),p.i32_const(d)))),p.setLocal("pSConst",p.i32_add(p.i32_const(k),p.i32_mul(p.getLocal("totalBits"),p.i32_const(d)))),p.call(o+"_copy",p.getLocal("first"),W),p.setLocal("i",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("i"),p.getLocal("n"))),p.setLocal("idx1",p.i32_add(p.getLocal("pBuff1"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.setLocal("idx2",p.i32_add(p.getLocal("pBuff2"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.call(a,p.getLocal("idx1"),p.getLocal("pShiftToM"),q),p.call(i+"_sub",p.getLocal("idx2"),q,q),p.call(i+"_sub",p.getLocal("idx1"),p.getLocal("idx2"),p.getLocal("idx2")),p.call(a,q,p.getLocal("pSConst"),p.getLocal("idx1")),p.call(a,p.getLocal("idx2"),W,p.getLocal("idx2")),p.call(o+"_mul",W,p.getLocal("inc"),W),p.setLocal("i",p.i32_add(p.getLocal("i"),p.i32_const(1))),p.br(0))))}function w(){const O=t.addFunction(n+"_fftMix");O.addParam("pBuff","i32"),O.addParam("n","i32"),O.addParam("exp","i32"),O.addLocal("nGroups","i32"),O.addLocal("nPerGroup","i32"),O.addLocal("nPerGroupDiv2","i32"),O.addLocal("pairOffset","i32"),O.addLocal("idx1","i32"),O.addLocal("idx2","i32"),O.addLocal("i","i32"),O.addLocal("j","i32"),O.addLocal("pwm","i32");const p=O.getCodeBuilder(),W=p.i32_const(t.alloc(d)),q=p.i32_const(t.alloc(u)),I=p.i32_const(t.alloc(u));O.addCode(p.setLocal("nPerGroup",p.i32_shl(p.i32_const(1),p.getLocal("exp"))),p.setLocal("nPerGroupDiv2",p.i32_shr_u(p.getLocal("nPerGroup"),p.i32_const(1))),p.setLocal("nGroups",p.i32_shr_u(p.getLocal("n"),p.getLocal("exp"))),p.setLocal("pairOffset",p.i32_mul(p.getLocal("nPerGroupDiv2"),p.i32_const(u))),p.setLocal("pwm",p.i32_add(p.i32_const(x),p.i32_mul(p.getLocal("exp"),p.i32_const(d)))),p.setLocal("i",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("i"),p.getLocal("nGroups"))),p.call(o+"_one",W),p.setLocal("j",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("j"),p.getLocal("nPerGroupDiv2"))),p.setLocal("idx1",p.i32_add(p.getLocal("pBuff"),p.i32_mul(p.i32_add(p.i32_mul(p.getLocal("i"),p.getLocal("nPerGroup")),p.getLocal("j")),p.i32_const(u)))),p.setLocal("idx2",p.i32_add(p.getLocal("idx1"),p.getLocal("pairOffset"))),p.call(a,p.getLocal("idx2"),W,q),p.call(i+"_copy",p.getLocal("idx1"),I),p.call(i+"_add",I,q,p.getLocal("idx1")),p.call(i+"_sub",I,q,p.getLocal("idx2")),p.call(o+"_mul",W,p.getLocal("pwm"),W),p.setLocal("j",p.i32_add(p.getLocal("j"),p.i32_const(1))),p.br(0))),p.setLocal("i",p.i32_add(p.getLocal("i"),p.i32_const(1))),p.br(0))))}function f(){const O=t.addFunction(n+"_fftFinal");O.addParam("pBuff","i32"),O.addParam("n","i32"),O.addParam("factor","i32"),O.addLocal("idx1","i32"),O.addLocal("idx2","i32"),O.addLocal("i","i32"),O.addLocal("ndiv2","i32");const p=O.getCodeBuilder(),W=p.i32_const(t.alloc(u));O.addCode(p.setLocal("ndiv2",p.i32_shr_u(p.getLocal("n"),p.i32_const(1))),p.if(p.i32_and(p.getLocal("n"),p.i32_const(1)),p.call(a,p.i32_add(p.getLocal("pBuff"),p.i32_mul(p.getLocal("ndiv2"),p.i32_const(u))),p.getLocal("factor"),p.i32_add(p.getLocal("pBuff"),p.i32_mul(p.getLocal("ndiv2"),p.i32_const(u))))),p.setLocal("i",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_ge_u(p.getLocal("i"),p.getLocal("ndiv2"))),p.setLocal("idx1",p.i32_add(p.getLocal("pBuff"),p.i32_mul(p.getLocal("i"),p.i32_const(u)))),p.setLocal("idx2",p.i32_add(p.getLocal("pBuff"),p.i32_mul(p.i32_sub(p.i32_sub(p.getLocal("n"),p.i32_const(1)),p.getLocal("i")),p.i32_const(u)))),p.call(a,p.getLocal("idx2"),p.getLocal("factor"),W),p.call(a,p.getLocal("idx1"),p.getLocal("factor"),p.getLocal("idx2")),p.call(i+"_copy",W,p.getLocal("idx1")),p.setLocal("i",p.i32_add(p.getLocal("i"),p.i32_const(1))),p.br(0))))}nt(),ot(),Z(),it(),z(),tt(),at(),gt(),xt(),pt(),w(),f(),yt(),t.exportFunction(n+"_fft"),t.exportFunction(n+"_ifft"),t.exportFunction(n+"_rawfft"),t.exportFunction(n+"_fftJoin"),t.exportFunction(n+"_fftJoinExt"),t.exportFunction(n+"_fftJoinExtInv"),t.exportFunction(n+"_fftMix"),t.exportFunction(n+"_fftFinal"),t.exportFunction(n+"_prepareLagrangeEvaluation")},Tl=function(t,n,i){const a=t.modules[i].n64*8;function c(){const h=t.addFunction(n+"_zero");h.addParam("px","i32"),h.addParam("n","i32"),h.addLocal("lastp","i32"),h.addLocal("p","i32");const u=h.getCodeBuilder();h.addCode(u.setLocal("p",u.getLocal("px")),u.setLocal("lastp",u.i32_add(u.getLocal("px"),u.i32_mul(u.getLocal("n"),u.i32_const(a)))),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("p"),u.getLocal("lastp"))),u.call(i+"_zero",u.getLocal("p")),u.setLocal("p",u.i32_add(u.getLocal("p"),u.i32_const(a))),u.br(0))))}function d(){const h=t.addFunction(n+"_constructLC");h.addParam("ppolynomials","i32"),h.addParam("psignals","i32"),h.addParam("nSignals","i32"),h.addParam("pres","i32"),h.addLocal("i","i32"),h.addLocal("j","i32"),h.addLocal("pp","i32"),h.addLocal("ps","i32"),h.addLocal("pd","i32"),h.addLocal("ncoefs","i32");const u=h.getCodeBuilder(),s=u.i32_const(t.alloc(a));h.addCode(u.setLocal("i",u.i32_const(0)),u.setLocal("pp",u.getLocal("ppolynomials")),u.setLocal("ps",u.getLocal("psignals")),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("i"),u.getLocal("nSignals"))),u.setLocal("ncoefs",u.i32_load(u.getLocal("pp"))),u.setLocal("pp",u.i32_add(u.getLocal("pp"),u.i32_const(4))),u.setLocal("j",u.i32_const(0)),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("j"),u.getLocal("ncoefs"))),u.setLocal("pd",u.i32_add(u.getLocal("pres"),u.i32_mul(u.i32_load(u.getLocal("pp")),u.i32_const(a)))),u.setLocal("pp",u.i32_add(u.getLocal("pp"),u.i32_const(4))),u.call(i+"_mul",u.getLocal("ps"),u.getLocal("pp"),s),u.call(i+"_add",s,u.getLocal("pd"),u.getLocal("pd")),u.setLocal("pp",u.i32_add(u.getLocal("pp"),u.i32_const(a))),u.setLocal("j",u.i32_add(u.getLocal("j"),u.i32_const(1))),u.br(0))),u.setLocal("ps",u.i32_add(u.getLocal("ps"),u.i32_const(a))),u.setLocal("i",u.i32_add(u.getLocal("i"),u.i32_const(1))),u.br(0))))}return c(),d(),t.exportFunction(n+"_zero"),t.exportFunction(n+"_constructLC"),n},Pl=function(t,n,i){const a=t.modules[i].n64*8;function c(){const u=t.addFunction(n+"_buildABC");u.addParam("pCoefs","i32"),u.addParam("nCoefs","i32"),u.addParam("pWitness","i32"),u.addParam("pA","i32"),u.addParam("pB","i32"),u.addParam("pC","i32"),u.addParam("offsetOut","i32"),u.addParam("nOut","i32"),u.addParam("offsetWitness","i32"),u.addParam("nWitness","i32"),u.addLocal("it","i32"),u.addLocal("ita","i32"),u.addLocal("itb","i32"),u.addLocal("last","i32"),u.addLocal("m","i32"),u.addLocal("c","i32"),u.addLocal("s","i32"),u.addLocal("pOut","i32");const s=u.getCodeBuilder(),_=s.i32_const(t.alloc(a));u.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(a)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(i+"_zero",s.getLocal("ita")),s.call(i+"_zero",s.getLocal("itb")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(a))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(a))),s.br(0))),s.setLocal("it",s.getLocal("pCoefs")),s.setLocal("last",s.i32_add(s.getLocal("pCoefs"),s.i32_mul(s.getLocal("nCoefs"),s.i32_const(a+12)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("it"),s.getLocal("last"))),s.setLocal("s",s.i32_load(s.getLocal("it"),8)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_ge_u(s.getLocal("s"),s.i32_add(s.getLocal("offsetWitness"),s.getLocal("nWitness")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(a+12))),...s.br(1)]),s.setLocal("m",s.i32_load(s.getLocal("it"))),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(0)),s.setLocal("pOut",s.getLocal("pA")),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(1)),s.setLocal("pOut",s.getLocal("pB")),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(a+12))),...s.br(1)])),s.setLocal("c",s.i32_load(s.getLocal("it"),4)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_ge_u(s.getLocal("c"),s.i32_add(s.getLocal("offsetOut"),s.getLocal("nOut")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(a+12))),...s.br(1)]),s.setLocal("pOut",s.i32_add(s.getLocal("pOut"),s.i32_mul(s.i32_sub(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_const(a)))),s.call(i+"_mul",s.i32_add(s.getLocal("pWitness"),s.i32_mul(s.i32_sub(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_const(a))),s.i32_add(s.getLocal("it"),s.i32_const(12)),_),s.call(i+"_add",s.getLocal("pOut"),_,s.getLocal("pOut")),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(a+12))),s.br(0))),s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("it",s.getLocal("pC")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(a)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(i+"_mul",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("it")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(a))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(a))),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(a))),s.br(0))))}function d(){const u=t.addFunction(n+"_joinABC");u.addParam("pA","i32"),u.addParam("pB","i32"),u.addParam("pC","i32"),u.addParam("n","i32"),u.addParam("pP","i32"),u.addLocal("ita","i32"),u.addLocal("itb","i32"),u.addLocal("itc","i32"),u.addLocal("itp","i32"),u.addLocal("last","i32");const s=u.getCodeBuilder(),_=s.i32_const(t.alloc(a));u.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("itc",s.getLocal("pC")),s.setLocal("itp",s.getLocal("pP")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("n"),s.i32_const(a)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(i+"_mul",s.getLocal("ita"),s.getLocal("itb"),_),s.call(i+"_sub",_,s.getLocal("itc"),s.getLocal("itp")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(a))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(a))),s.setLocal("itc",s.i32_add(s.getLocal("itc"),s.i32_const(a))),s.setLocal("itp",s.i32_add(s.getLocal("itp"),s.i32_const(a))),s.br(0))))}function h(){const u=t.addFunction(n+"_batchAdd");u.addParam("pa","i32"),u.addParam("pb","i32"),u.addParam("n","i32"),u.addParam("pr","i32"),u.addLocal("ita","i32"),u.addLocal("itb","i32"),u.addLocal("itr","i32"),u.addLocal("last","i32");const s=u.getCodeBuilder();u.addCode(s.setLocal("ita",s.getLocal("pa")),s.setLocal("itb",s.getLocal("pb")),s.setLocal("itr",s.getLocal("pr")),s.setLocal("last",s.i32_add(s.getLocal("pa"),s.i32_mul(s.getLocal("n"),s.i32_const(a)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(i+"_add",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("itr")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(a))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(a))),s.setLocal("itr",s.i32_add(s.getLocal("itr"),s.i32_const(a))),s.br(0))))}return c(),d(),h(),t.exportFunction(n+"_buildABC"),t.exportFunction(n+"_joinABC"),t.exportFunction(n+"_batchAdd"),n},Rl=function(t,n,i,o,a,c,d,h){const u=t.addFunction(n);u.addParam("pIn","i32"),u.addParam("n","i32"),u.addParam("pFirst","i32"),u.addParam("pInc","i32"),u.addParam("pOut","i32"),u.addLocal("pOldFree","i32"),u.addLocal("i","i32"),u.addLocal("pFrom","i32"),u.addLocal("pTo","i32");const s=u.getCodeBuilder(),_=s.i32_const(t.alloc(d));u.addCode(s.setLocal("pFrom",s.getLocal("pIn")),s.setLocal("pTo",s.getLocal("pOut"))),u.addCode(s.call(o+"_copy",s.getLocal("pFirst"),_)),u.addCode(s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(h,s.getLocal("pFrom"),_,s.getLocal("pTo")),s.setLocal("pFrom",s.i32_add(s.getLocal("pFrom"),s.i32_const(a))),s.setLocal("pTo",s.i32_add(s.getLocal("pTo"),s.i32_const(c))),s.call(o+"_mul",_,s.getLocal("pInc"),_),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))),t.exportFunction(n)};const mt=un.exports,$t=In,kp=Xa,Qp=Cl,Ul=vl,Wp=Fl,Ml=xl,er=Ol,$p=Tl,Hp=Pl,Ji=Rl;var jp=function(t,n){const i=n||"bn128";if(t.modules[i])return i;const o=mt("21888242871839275222246405745257275088696311157297823662689037894645226208583"),a=mt("21888242871839275222246405745257275088548364400416034343698204186575808495617"),c=Math.floor((o.minus(1).bitLength()-1)/64)+1,d=c*8,h=d,u=d,s=u*2,_=u*12,L=t.alloc($t.bigInt2BytesLE(a,h)),g=kp(t,o,"f1m");Qp(t,a,"fr","frm");const F=t.alloc($t.bigInt2BytesLE(D(mt(3)),u)),T=Ml(t,"g1m","f1m",F);er(t,"frm","frm","frm","frm_mul"),$p(t,"pol","frm"),Hp(t,"qap","frm");const C=Ul(t,"f1m_neg","f2m","f1m"),U=t.alloc([...$t.bigInt2BytesLE(D(mt("19485874751759354771024239261021720505790618469301721065564631296452457478373")),u),...$t.bigInt2BytesLE(D(mt("266929791119991161246907387137283842545076965332900288569378510910307636690")),u)]),x=Ml(t,"g2m","f2m",U);function V(b,r){const l=t.addFunction(b);l.addParam("pG","i32"),l.addParam("pFr","i32"),l.addParam("pr","i32");const A=l.getCodeBuilder(),S=A.i32_const(t.alloc(d));l.addCode(A.call("frm_fromMontgomery",A.getLocal("pFr"),S),A.call(r,A.getLocal("pG"),S,A.i32_const(d),A.getLocal("pr"))),t.exportFunction(b)}V("g1m_timesFr","g1m_timesScalar"),er(t,"g1m","g1m","frm","g1m_timesFr"),V("g2m_timesFr","g2m_timesScalar"),er(t,"g2m","g2m","frm","g2m_timesFr"),V("g1m_timesFrAffine","g1m_timesScalarAffine"),V("g2m_timesFrAffine","g2m_timesScalarAffine"),Ji(t,"frm_batchApplyKey","fmr","frm",d,d,d,"frm_mul"),Ji(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,d,"g1m_timesFr"),Ji(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,d,"g1m_timesFrAffine"),Ji(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,d,"g2m_timesFr"),Ji(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,d,"g2m_timesFrAffine");function D(b){return mt(b).times(mt.one.shiftLeft(u*8)).mod(o)}const $=[mt("1"),mt("2"),mt.one],v=t.alloc([...$t.bigInt2BytesLE(D($[0]),u),...$t.bigInt2BytesLE(D($[1]),u),...$t.bigInt2BytesLE(D($[2]),u)]),m=[mt.zero,mt.one,mt.zero],y=t.alloc([...$t.bigInt2BytesLE(D(m[0]),u),...$t.bigInt2BytesLE(D(m[1]),u),...$t.bigInt2BytesLE(D(m[2]),u)]),G=[[mt("10857046999023057135944570762232829481370756359578518086990519993285655852781"),mt("11559732032986387107991004021392285783925812861821192530917403151452391805634")],[mt("8495653923123431417604973247489272438418190587263600148770280649306958101930"),mt("4082367875863433681332203403145435568316851327593401208105741076214120093531")],[mt.one,mt.zero]],k=t.alloc([...$t.bigInt2BytesLE(D(G[0][0]),u),...$t.bigInt2BytesLE(D(G[0][1]),u),...$t.bigInt2BytesLE(D(G[1][0]),u),...$t.bigInt2BytesLE(D(G[1][1]),u),...$t.bigInt2BytesLE(D(G[2][0]),u),...$t.bigInt2BytesLE(D(G[2][1]),u)]),N=[[mt.zero,mt.zero],[mt.one,mt.zero],[mt.zero,mt.zero]],R=t.alloc([...$t.bigInt2BytesLE(D(N[0][0]),u),...$t.bigInt2BytesLE(D(N[0][1]),u),...$t.bigInt2BytesLE(D(N[1][0]),u),...$t.bigInt2BytesLE(D(N[1][1]),u),...$t.bigInt2BytesLE(D(N[2][0]),u),...$t.bigInt2BytesLE(D(N[2][1]),u)]),E=t.alloc([...$t.bigInt2BytesLE(D(1),u),...$t.bigInt2BytesLE(D(0),u),...$t.bigInt2BytesLE(D(0),u),...$t.bigInt2BytesLE(D(0),u),...$t.bigInt2BytesLE(D(0),u),...$t.bigInt2BytesLE(D(0),u),...$t.bigInt2BytesLE(D(0),u),...$t.bigInt2BytesLE(D(0),u),...$t.bigInt2BytesLE(D(0),u),...$t.bigInt2BytesLE(D(0),u),...$t.bigInt2BytesLE(D(0),u),...$t.bigInt2BytesLE(D(0),u)]),z=t.alloc([...$t.bigInt2BytesLE(D(9),u),...$t.bigInt2BytesLE(D(1),u)]),tt=t.alloc([...$t.bigInt2BytesLE(D(mt(2).modInv(o)),u),...$t.bigInt2BytesLE(mt(0),u)]),at=z,it=t.alloc([...$t.bigInt2BytesLE(D("19485874751759354771024239261021720505790618469301721065564631296452457478373"),u),...$t.bigInt2BytesLE(D("266929791119991161246907387137283842545076965332900288569378510910307636690"),u)]);function Z(){const b=t.addFunction(i+"_mulNR6");b.addParam("x","i32"),b.addParam("pr","i32");const r=b.getCodeBuilder();b.addCode(r.call(C+"_mul",r.i32_const(z),r.getLocal("x"),r.getLocal("pr")))}Z();const ot=Wp(t,i+"_mulNR6","f6m","f2m");function nt(){const b=t.addFunction(i+"_mulNR12");b.addParam("x","i32"),b.addParam("pr","i32");const r=b.getCodeBuilder();b.addCode(r.call(C+"_mul",r.i32_const(z),r.i32_add(r.getLocal("x"),r.i32_const(d*4)),r.getLocal("pr")),r.call(C+"_copy",r.getLocal("x"),r.i32_add(r.getLocal("pr"),r.i32_const(d*2))),r.call(C+"_copy",r.i32_add(r.getLocal("x"),r.i32_const(d*2)),r.i32_add(r.getLocal("pr"),r.i32_const(d*4))))}nt();const gt=Ul(t,i+"_mulNR12","ftm",ot),xt=mt("29793968203157093288"),pt=dt(xt),yt=t.alloc(pt),w=3*s,f=pt.length-1,p=pt.reduce((b,r)=>b+(r!=0?1:0),0)+f+1,W=3*2*d,q=3*d*2+p*w;t.modules[i]={n64:c,pG1gen:v,pG1zero:y,pG1b:F,pG2gen:k,pG2zero:R,pG2b:U,pq:t.modules.f1m.pq,pr:L,pOneT:E,prePSize:W,preQSize:q,r:a.toString(),q:o.toString()};const I=mt("4965661367192848881");function J(b){let r=b;const l=[];for(;r.gt(mt.zero);){if(r.isOdd()){const A=2-r.mod(4).toJSNumber();l.push(A),r=r.minus(A)}else l.push(0);r=r.shiftRight(1)}return l}function dt(b){let r=b;const l=[];for(;r.gt(mt.zero);)r.isOdd()?l.push(1):l.push(0),r=r.shiftRight(1);return l}function lt(){const b=t.addFunction(i+"_prepareG1");b.addParam("pP","i32"),b.addParam("ppreP","i32");const r=b.getCodeBuilder();b.addCode(r.call(T+"_normalize",r.getLocal("pP"),r.getLocal("ppreP")))}function It(){const b=t.addFunction(i+"_prepAddStep");b.addParam("pQ","i32"),b.addParam("pR","i32"),b.addParam("pCoef","i32");const r=b.getCodeBuilder(),l=r.getLocal("pQ"),A=r.i32_add(r.getLocal("pQ"),r.i32_const(s)),S=r.getLocal("pR"),P=r.i32_add(r.getLocal("pR"),r.i32_const(s)),Q=r.i32_add(r.getLocal("pR"),r.i32_const(2*s)),Y=r.getLocal("pCoef"),st=r.i32_add(r.getLocal("pCoef"),r.i32_const(s)),ft=r.i32_add(r.getLocal("pCoef"),r.i32_const(2*s)),_t=st,ut=r.i32_const(t.alloc(s)),wt=r.i32_const(t.alloc(s)),Rt=r.i32_const(t.alloc(s)),Tt=r.i32_const(t.alloc(s)),St=r.i32_const(t.alloc(s)),Gt=r.i32_const(t.alloc(s)),Nt=r.i32_const(t.alloc(s));b.addCode(r.call(C+"_mul",l,Q,_t),r.call(C+"_sub",S,_t,_t),r.call(C+"_mul",A,Q,ut),r.call(C+"_sub",P,ut,ut),r.call(C+"_square",_t,wt),r.call(C+"_square",ut,Rt),r.call(C+"_mul",_t,wt,Tt),r.call(C+"_mul",S,wt,St),r.call(C+"_add",St,St,Nt),r.call(C+"_mul",Q,Rt,Gt),r.call(C+"_add",Tt,Gt,Gt),r.call(C+"_sub",Gt,Nt,Gt),r.call(C+"_mul",_t,Gt,S),r.call(C+"_mul",Tt,P,P),r.call(C+"_sub",St,Gt,Nt),r.call(C+"_mul",ut,Nt,Nt),r.call(C+"_sub",Nt,P,P),r.call(C+"_mul",Q,Tt,Q),r.call(C+"_mul",_t,A,Nt),r.call(C+"_mul",ut,l,Y),r.call(C+"_sub",Y,Nt,Y),r.call(C+"_mul",Y,r.i32_const(at),Y),r.call(C+"_neg",ut,ft))}function Ut(){const b=t.addFunction(i+"_prepDblStep");b.addParam("pR","i32"),b.addParam("pCoef","i32");const r=b.getCodeBuilder(),l=r.getLocal("pR"),A=r.i32_add(r.getLocal("pR"),r.i32_const(s)),S=r.i32_add(r.getLocal("pR"),r.i32_const(2*s)),P=r.getLocal("pCoef"),Q=r.i32_add(r.getLocal("pCoef"),r.i32_const(s)),Y=r.i32_add(r.getLocal("pCoef"),r.i32_const(2*s)),st=r.i32_const(t.alloc(s)),ft=r.i32_const(t.alloc(s)),_t=r.i32_const(t.alloc(s)),ut=r.i32_const(t.alloc(s)),wt=r.i32_const(t.alloc(s)),Rt=r.i32_const(t.alloc(s)),Tt=r.i32_const(t.alloc(s)),St=r.i32_const(t.alloc(s)),Gt=r.i32_const(t.alloc(s)),Nt=r.i32_const(t.alloc(s)),Ht=r.i32_const(t.alloc(s)),qt=r.i32_const(t.alloc(s));b.addCode(r.call(C+"_mul",A,r.i32_const(tt),st),r.call(C+"_mul",l,st,st),r.call(C+"_square",A,ft),r.call(C+"_square",S,_t),r.call(C+"_add",_t,_t,ut),r.call(C+"_add",ut,_t,ut),r.call(C+"_mul",r.i32_const(it),ut,wt),r.call(C+"_add",wt,wt,Rt),r.call(C+"_add",wt,Rt,Rt),r.call(C+"_add",ft,Rt,Tt),r.call(C+"_mul",Tt,r.i32_const(tt),Tt),r.call(C+"_add",ft,_t,qt),r.call(C+"_add",A,S,St),r.call(C+"_square",St,St),r.call(C+"_sub",St,qt,St),r.call(C+"_sub",wt,ft,Gt),r.call(C+"_square",l,Nt),r.call(C+"_square",wt,Ht),r.call(C+"_sub",ft,Rt,qt),r.call(C+"_mul",st,qt,l),r.call(C+"_add",Ht,Ht,qt),r.call(C+"_add",Ht,qt,qt),r.call(C+"_square",Tt,A),r.call(C+"_sub",A,qt,A),r.call(C+"_mul",ft,St,S),r.call(C+"_mul",r.i32_const(at),Gt,P),r.call(C+"_neg",St,Q),r.call(C+"_add",Nt,Nt,Y),r.call(C+"_add",Nt,Y,Y))}function Ot(){const b=t.addFunction(i+"_mulByQ");b.addParam("p1","i32"),b.addParam("pr","i32");const r=b.getCodeBuilder(),l=r.getLocal("p1"),A=r.i32_add(r.getLocal("p1"),r.i32_const(s)),S=r.i32_add(r.getLocal("p1"),r.i32_const(s*2)),P=r.getLocal("pr"),Q=r.i32_add(r.getLocal("pr"),r.i32_const(s)),Y=r.i32_add(r.getLocal("pr"),r.i32_const(s*2)),st=r.i32_const(t.alloc([...$t.bigInt2BytesLE(D("21575463638280843010398324269430826099269044274347216827212613867836435027261"),u),...$t.bigInt2BytesLE(D("10307601595873709700152284273816112264069230130616436755625194854815875713954"),u)])),ft=r.i32_const(t.alloc([...$t.bigInt2BytesLE(D("2821565182194536844548159561693502659359617185244120367078079554186484126554"),u),...$t.bigInt2BytesLE(D("3505843767911556378687030309984248845540243509899259641013678093033130930403"),u)]));b.addCode(r.call(C+"_conjugate",l,P),r.call(C+"_mul",st,P,P),r.call(C+"_conjugate",A,Q),r.call(C+"_mul",ft,Q,Q),r.call(C+"_conjugate",S,Y))}function Ft(){Ot();const b=t.addFunction(i+"_prepareG2");b.addParam("pQ","i32"),b.addParam("ppreQ","i32"),b.addLocal("pCoef","i32"),b.addLocal("i","i32");const r=b.getCodeBuilder(),l=r.getLocal("pQ");r.i32_add(r.getLocal("pQ"),r.i32_const(s)),r.i32_add(r.getLocal("pQ"),r.i32_const(s*2));const A=t.alloc(s*3),S=r.i32_const(A),P=r.i32_const(A),Q=r.i32_const(A+s),Y=r.i32_const(A+2*s),st=r.i32_add(r.getLocal("ppreQ"),r.i32_const(0)),ft=r.i32_add(r.getLocal("ppreQ"),r.i32_const(s));r.i32_add(r.getLocal("ppreQ"),r.i32_const(s*2));const _t=t.alloc(s*3),ut=r.i32_const(_t),wt=t.alloc(s*3),Rt=r.i32_const(wt);r.i32_const(wt);const Tt=r.i32_const(wt+s);r.i32_const(wt+s*2),b.addCode(r.call(x+"_normalize",l,st),r.call(C+"_copy",st,P),r.call(C+"_copy",ft,Q),r.call(C+"_one",Y)),b.addCode(r.setLocal("pCoef",r.i32_add(r.getLocal("ppreQ"),r.i32_const(s*3))),r.setLocal("i",r.i32_const(pt.length-2)),r.block(r.loop(r.call(i+"_prepDblStep",S,r.getLocal("pCoef")),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(w))),r.if(r.i32_load8_s(r.getLocal("i"),yt),[...r.call(i+"_prepAddStep",st,S,r.getLocal("pCoef")),...r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(w)))]),r.br_if(1,r.i32_eqz(r.getLocal("i"))),r.setLocal("i",r.i32_sub(r.getLocal("i"),r.i32_const(1))),r.br(0)))),b.addCode(r.call(i+"_mulByQ",st,ut),r.call(i+"_mulByQ",ut,Rt)),b.addCode(r.call(C+"_neg",Tt,Tt),r.call(i+"_prepAddStep",ut,S,r.getLocal("pCoef")),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(w))),r.call(i+"_prepAddStep",Rt,S,r.getLocal("pCoef")),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(w))))}function Ct(){const b=t.addFunction(i+"__mulBy024Old");b.addParam("pEll0","i32"),b.addParam("pEllVW","i32"),b.addParam("pEllVV","i32"),b.addParam("pR","i32");const r=b.getCodeBuilder(),l=r.getLocal("pEll0"),A=r.getLocal("pEllVV"),S=r.getLocal("pEllVW"),P=r.getLocal("pR"),Q=t.alloc(_),Y=r.i32_const(Q),st=r.i32_const(Q),ft=r.i32_const(Q+s),_t=r.i32_const(Q+s*2),ut=r.i32_const(Q+s*3),wt=r.i32_const(Q+s*4),Rt=r.i32_const(Q+s*5);b.addCode(r.call(C+"_copy",l,st),r.call(C+"_zero",ft),r.call(C+"_copy",A,_t),r.call(C+"_zero",ut),r.call(C+"_copy",S,wt),r.call(C+"_zero",Rt),r.call(gt+"_mul",Y,P,P))}function Lt(){const b=t.addFunction(i+"__mulBy024");b.addParam("pEll0","i32"),b.addParam("pEllVW","i32"),b.addParam("pEllVV","i32"),b.addParam("pR","i32");const r=b.getCodeBuilder(),l=r.getLocal("pEll0"),A=r.getLocal("pEllVV"),S=r.getLocal("pEllVW"),P=r.getLocal("pR"),Q=r.i32_add(r.getLocal("pR"),r.i32_const(2*d)),Y=r.i32_add(r.getLocal("pR"),r.i32_const(4*d)),st=r.i32_add(r.getLocal("pR"),r.i32_const(6*d)),ft=r.i32_add(r.getLocal("pR"),r.i32_const(8*d)),_t=r.i32_add(r.getLocal("pR"),r.i32_const(10*d)),ut=r.i32_const(t.alloc(s)),wt=r.i32_const(t.alloc(s)),Rt=r.i32_const(t.alloc(s)),Tt=r.i32_const(t.alloc(s)),St=r.i32_const(t.alloc(s)),Gt=r.i32_const(t.alloc(s)),Nt=r.i32_const(t.alloc(s)),Ht=r.i32_const(t.alloc(s)),qt=r.i32_const(t.alloc(s)),zt=r.i32_const(t.alloc(s)),Mt=r.i32_const(t.alloc(s));b.addCode(r.call(C+"_mul",P,l,Nt),r.call(C+"_mul",Y,A,Ht),r.call(C+"_mul",ft,S,qt),r.call(C+"_add",P,ft,Rt),r.call(C+"_add",P,Y,wt),r.call(C+"_add",Q,st,Tt),r.call(C+"_add",Tt,_t,Tt),r.call(C+"_mul",Q,A,zt),r.call(C+"_add",zt,qt,St),r.call(C+"_mul",r.i32_const(z),St,Gt),r.call(C+"_add",Gt,Nt,P),r.call(C+"_mul",_t,S,St),r.call(C+"_add",zt,St,zt),r.call(C+"_add",St,Ht,St),r.call(C+"_mul",r.i32_const(z),St,Gt),r.call(C+"_mul",Q,l,St),r.call(C+"_add",zt,St,zt),r.call(C+"_add",Gt,St,Q),r.call(C+"_add",l,A,ut),r.call(C+"_mul",wt,ut,St),r.call(C+"_add",Nt,Ht,Mt),r.call(C+"_sub",St,Mt,St),r.call(C+"_mul",st,S,Gt),r.call(C+"_add",zt,Gt,zt),r.call(C+"_add",Y,ft,ut),r.call(C+"_add",St,Gt,Y),r.call(C+"_add",A,S,wt),r.call(C+"_mul",wt,ut,St),r.call(C+"_add",Ht,qt,Mt),r.call(C+"_sub",St,Mt,St),r.call(C+"_mul",r.i32_const(z),St,Gt),r.call(C+"_mul",st,l,St),r.call(C+"_add",zt,St,zt),r.call(C+"_add",Gt,St,st),r.call(C+"_mul",_t,A,St),r.call(C+"_add",zt,St,zt),r.call(C+"_mul",r.i32_const(z),St,Gt),r.call(C+"_add",l,S,ut),r.call(C+"_mul",Rt,ut,St),r.call(C+"_add",Nt,qt,Mt),r.call(C+"_sub",St,Mt,St),r.call(C+"_add",Gt,St,ft),r.call(C+"_add",l,A,ut),r.call(C+"_add",ut,S,ut),r.call(C+"_mul",Tt,ut,St),r.call(C+"_sub",St,zt,_t))}function Et(){const b=t.addFunction(i+"_millerLoop");b.addParam("ppreP","i32"),b.addParam("ppreQ","i32"),b.addParam("r","i32"),b.addLocal("pCoef","i32"),b.addLocal("i","i32");const r=b.getCodeBuilder(),l=r.getLocal("ppreP"),A=r.i32_add(r.getLocal("ppreP"),r.i32_const(u)),S=r.getLocal("pCoef"),P=r.i32_add(r.getLocal("pCoef"),r.i32_const(s)),Q=r.i32_add(r.getLocal("pCoef"),r.i32_const(2*s)),Y=t.alloc(s),st=r.i32_const(Y),ft=t.alloc(s),_t=r.i32_const(ft),ut=r.getLocal("r");b.addCode(r.call(gt+"_one",ut),r.setLocal("pCoef",r.i32_add(r.getLocal("ppreQ"),r.i32_const(s*3))),r.setLocal("i",r.i32_const(pt.length-2)),r.block(r.loop(r.call(gt+"_square",ut,ut),r.call(C+"_mul1",P,A,st),r.call(C+"_mul1",Q,l,_t),r.call(i+"__mulBy024",S,st,_t,ut),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(w))),r.if(r.i32_load8_s(r.getLocal("i"),yt),[...r.call(C+"_mul1",P,A,st),...r.call(C+"_mul1",Q,l,_t),...r.call(i+"__mulBy024",S,st,_t,ut),...r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(w)))]),r.br_if(1,r.i32_eqz(r.getLocal("i"))),r.setLocal("i",r.i32_sub(r.getLocal("i"),r.i32_const(1))),r.br(0)))),b.addCode(r.call(C+"_mul1",P,A,st),r.call(C+"_mul1",Q,l,_t),r.call(i+"__mulBy024",S,st,_t,ut),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(w))),r.call(C+"_mul1",P,A,st),r.call(C+"_mul1",Q,l,_t),r.call(i+"__mulBy024",S,st,_t,ut),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(w))))}function Bt(b){const r=[[[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")]],[[mt("1"),mt("0")],[mt("8376118865763821496583973867626364092589906065868298776909617916018768340080"),mt("16469823323077808223889137241176536799009286646108169935659301613961712198316")],[mt("21888242871839275220042445260109153167277707414472061641714758635765020556617"),mt("0")],[mt("11697423496358154304825782922584725312912383441159505038794027105778954184319"),mt("303847389135065887422783454877609941456349188919719272345083954437860409601")],[mt("21888242871839275220042445260109153167277707414472061641714758635765020556616"),mt("0")],[mt("3321304630594332808241809054958361220322477375291206261884409189760185844239"),mt("5722266937896532885780051958958348231143373700109372999374820235121374419868")],[mt("21888242871839275222246405745257275088696311157297823662689037894645226208582"),mt("0")],[mt("13512124006075453725662431877630910996106405091429524885779419978626457868503"),mt("5418419548761466998357268504080738289687024511189653727029736280683514010267")],[mt("2203960485148121921418603742825762020974279258880205651966"),mt("0")],[mt("10190819375481120917420622822672549775783927716138318623895010788866272024264"),mt("21584395482704209334823622290379665147239961968378104390343953940207365798982")],[mt("2203960485148121921418603742825762020974279258880205651967"),mt("0")],[mt("18566938241244942414004596690298913868373833782006617400804628704885040364344"),mt("16165975933942742336466353786298926857552937457188450663314217659523851788715")]]],l=[[[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")],[mt("1"),mt("0")]],[[mt("1"),mt("0")],[mt("21575463638280843010398324269430826099269044274347216827212613867836435027261"),mt("10307601595873709700152284273816112264069230130616436755625194854815875713954")],[mt("21888242871839275220042445260109153167277707414472061641714758635765020556616"),mt("0")],[mt("3772000881919853776433695186713858239009073593817195771773381919316419345261"),mt("2236595495967245188281701248203181795121068902605861227855261137820944008926")],[mt("2203960485148121921418603742825762020974279258880205651966"),mt("0")],[mt("18429021223477853657660792034369865839114504446431234726392080002137598044644"),mt("9344045779998320333812420223237981029506012124075525679208581902008406485703")]],[[mt("1"),mt("0")],[mt("2581911344467009335267311115468803099551665605076196740867805258568234346338"),mt("19937756971775647987995932169929341994314640652964949448313374472400716661030")],[mt("2203960485148121921418603742825762020974279258880205651966"),mt("0")],[mt("5324479202449903542726783395506214481928257762400643279780343368557297135718"),mt("16208900380737693084919495127334387981393726419856888799917914180988844123039")],[mt("21888242871839275220042445260109153167277707414472061641714758635765020556616"),mt("0")],[mt("13981852324922362344252311234282257507216387789820983642040889267519694726527"),mt("7629828391165209371577384193250820201684255241773809077146787135900891633097")]]],A=t.addFunction(i+"__frobeniusMap"+b);A.addParam("x","i32"),A.addParam("r","i32");const S=A.getCodeBuilder();for(let Q=0;Q<6;Q++){const Y=Q==0?S.getLocal("x"):S.i32_add(S.getLocal("x"),S.i32_const(Q*s)),st=Y,ft=S.i32_add(S.getLocal("x"),S.i32_const(Q*s+u)),_t=Q==0?S.getLocal("r"):S.i32_add(S.getLocal("r"),S.i32_const(Q*s)),ut=_t,wt=S.i32_add(S.getLocal("r"),S.i32_const(Q*s+u)),Rt=P(r[Math.floor(Q/3)][b%12],l[Q%3][b%6]),Tt=t.alloc([...$t.bigInt2BytesLE(D(Rt[0]),32),...$t.bigInt2BytesLE(D(Rt[1]),32)]);b%2==1?A.addCode(S.call(g+"_copy",st,ut),S.call(g+"_neg",ft,wt),S.call(C+"_mul",_t,S.i32_const(Tt),_t)):A.addCode(S.call(C+"_mul",Y,S.i32_const(Tt),_t))}function P(Q,Y){const st=mt(Q[0]),ft=mt(Q[1]),_t=mt(Y[0]),ut=mt(Y[1]),wt=[st.times(_t).minus(ft.times(ut)).mod(o),st.times(ut).add(ft.times(_t)).mod(o)];return wt[0].isNegative()&&(wt[0]=wt[0].add(o)),wt}}function Pt(){const b=t.addFunction(i+"__finalExponentiationFirstChunk");b.addParam("x","i32"),b.addParam("r","i32");const r=b.getCodeBuilder(),l=r.getLocal("x"),A=l,S=r.i32_add(l,r.i32_const(d*6)),P=r.getLocal("r"),Q=t.alloc(_),Y=r.i32_const(Q),st=Y,ft=r.i32_const(Q+d*6),_t=r.i32_const(t.alloc(_)),ut=r.i32_const(t.alloc(_)),wt=r.i32_const(t.alloc(_));b.addCode(r.call(ot+"_copy",A,st),r.call(ot+"_neg",S,ft),r.call(gt+"_inverse",l,_t),r.call(gt+"_mul",Y,_t,ut),r.call(i+"__frobeniusMap2",ut,wt),r.call(gt+"_mul",ut,wt,P))}function vt(){const b=t.addFunction(i+"__cyclotomicSquare");b.addParam("x","i32"),b.addParam("r","i32");const r=b.getCodeBuilder(),l=r.getLocal("x"),A=r.i32_add(r.getLocal("x"),r.i32_const(s)),S=r.i32_add(r.getLocal("x"),r.i32_const(2*s)),P=r.i32_add(r.getLocal("x"),r.i32_const(3*s)),Q=r.i32_add(r.getLocal("x"),r.i32_const(4*s)),Y=r.i32_add(r.getLocal("x"),r.i32_const(5*s)),st=r.getLocal("r"),ft=r.i32_add(r.getLocal("r"),r.i32_const(s)),_t=r.i32_add(r.getLocal("r"),r.i32_const(2*s)),ut=r.i32_add(r.getLocal("r"),r.i32_const(3*s)),wt=r.i32_add(r.getLocal("r"),r.i32_const(4*s)),Rt=r.i32_add(r.getLocal("r"),r.i32_const(5*s)),Tt=r.i32_const(t.alloc(s)),St=r.i32_const(t.alloc(s)),Gt=r.i32_const(t.alloc(s)),Nt=r.i32_const(t.alloc(s)),Ht=r.i32_const(t.alloc(s)),qt=r.i32_const(t.alloc(s)),zt=r.i32_const(t.alloc(s)),Mt=r.i32_const(t.alloc(s));b.addCode(r.call(C+"_mul",l,Q,zt),r.call(C+"_mul",Q,r.i32_const(z),Tt),r.call(C+"_add",l,Tt,Tt),r.call(C+"_add",l,Q,Mt),r.call(C+"_mul",Mt,Tt,Tt),r.call(C+"_mul",r.i32_const(z),zt,Mt),r.call(C+"_add",zt,Mt,Mt),r.call(C+"_sub",Tt,Mt,Tt),r.call(C+"_add",zt,zt,St),r.call(C+"_mul",P,S,zt),r.call(C+"_mul",S,r.i32_const(z),Gt),r.call(C+"_add",P,Gt,Gt),r.call(C+"_add",P,S,Mt),r.call(C+"_mul",Mt,Gt,Gt),r.call(C+"_mul",r.i32_const(z),zt,Mt),r.call(C+"_add",zt,Mt,Mt),r.call(C+"_sub",Gt,Mt,Gt),r.call(C+"_add",zt,zt,Nt),r.call(C+"_mul",A,Y,zt),r.call(C+"_mul",Y,r.i32_const(z),Ht),r.call(C+"_add",A,Ht,Ht),r.call(C+"_add",A,Y,Mt),r.call(C+"_mul",Mt,Ht,Ht),r.call(C+"_mul",r.i32_const(z),zt,Mt),r.call(C+"_add",zt,Mt,Mt),r.call(C+"_sub",Ht,Mt,Ht),r.call(C+"_add",zt,zt,qt),r.call(C+"_sub",Tt,l,st),r.call(C+"_add",st,st,st),r.call(C+"_add",Tt,st,st),r.call(C+"_add",St,Q,wt),r.call(C+"_add",wt,wt,wt),r.call(C+"_add",St,wt,wt),r.call(C+"_mul",qt,r.i32_const(at),Mt),r.call(C+"_add",Mt,P,ut),r.call(C+"_add",ut,ut,ut),r.call(C+"_add",Mt,ut,ut),r.call(C+"_sub",Ht,S,_t),r.call(C+"_add",_t,_t,_t),r.call(C+"_add",Ht,_t,_t),r.call(C+"_sub",Gt,A,ft),r.call(C+"_add",ft,ft,ft),r.call(C+"_add",Gt,ft,ft),r.call(C+"_add",Nt,Y,Rt),r.call(C+"_add",Rt,Rt,Rt),r.call(C+"_add",Nt,Rt,Rt))}function Wt(b,r){const l=J(b).map(ft=>ft==-1?255:ft),A=t.alloc(l);t.alloc($t.bigInt2BytesLE(b,32));const S=t.addFunction(i+"__cyclotomicExp_"+r);S.addParam("x","i32"),S.addParam("r","i32"),S.addLocal("bit","i32"),S.addLocal("i","i32");const P=S.getCodeBuilder(),Q=P.getLocal("x"),Y=P.getLocal("r"),st=P.i32_const(t.alloc(_));S.addCode(P.call(gt+"_conjugate",Q,st),P.call(gt+"_one",Y),P.if(P.teeLocal("bit",P.i32_load8_s(P.i32_const(l.length-1),A)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(gt+"_mul",Y,Q,Y),P.call(gt+"_mul",Y,st,Y))),P.setLocal("i",P.i32_const(l.length-2)),P.block(P.loop(P.call(i+"__cyclotomicSquare",Y,Y),P.if(P.teeLocal("bit",P.i32_load8_s(P.getLocal("i"),A)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(gt+"_mul",Y,Q,Y),P.call(gt+"_mul",Y,st,Y))),P.br_if(1,P.i32_eqz(P.getLocal("i"))),P.setLocal("i",P.i32_sub(P.getLocal("i"),P.i32_const(1))),P.br(0))))}function B(){vt(),Wt(I,"w0");const b=t.addFunction(i+"__finalExponentiationLastChunk");b.addParam("x","i32"),b.addParam("r","i32");const r=b.getCodeBuilder(),l=r.getLocal("x"),A=r.getLocal("r"),S=r.i32_const(t.alloc(_)),P=r.i32_const(t.alloc(_)),Q=r.i32_const(t.alloc(_)),Y=r.i32_const(t.alloc(_)),st=r.i32_const(t.alloc(_)),ft=r.i32_const(t.alloc(_)),_t=r.i32_const(t.alloc(_)),ut=r.i32_const(t.alloc(_)),wt=r.i32_const(t.alloc(_)),Rt=r.i32_const(t.alloc(_)),Tt=r.i32_const(t.alloc(_)),St=r.i32_const(t.alloc(_)),Gt=r.i32_const(t.alloc(_)),Nt=r.i32_const(t.alloc(_)),Ht=r.i32_const(t.alloc(_)),qt=r.i32_const(t.alloc(_)),zt=r.i32_const(t.alloc(_)),Mt=r.i32_const(t.alloc(_)),Yt=r.i32_const(t.alloc(_)),Ce=r.i32_const(t.alloc(_)),je=r.i32_const(t.alloc(_));b.addCode(r.call(i+"__cyclotomicExp_w0",l,S),r.call(gt+"_conjugate",S,S),r.call(i+"__cyclotomicSquare",S,P),r.call(i+"__cyclotomicSquare",P,Q),r.call(gt+"_mul",Q,P,Y),r.call(i+"__cyclotomicExp_w0",Y,st),r.call(gt+"_conjugate",st,st),r.call(i+"__cyclotomicSquare",st,ft),r.call(i+"__cyclotomicExp_w0",ft,_t),r.call(gt+"_conjugate",_t,_t),r.call(gt+"_conjugate",Y,ut),r.call(gt+"_conjugate",_t,wt),r.call(gt+"_mul",wt,st,Rt),r.call(gt+"_mul",Rt,ut,Tt),r.call(gt+"_mul",Tt,P,St),r.call(gt+"_mul",Tt,st,Gt),r.call(gt+"_mul",Gt,l,Nt),r.call(i+"__frobeniusMap1",St,Ht),r.call(gt+"_mul",Ht,Nt,qt),r.call(i+"__frobeniusMap2",Tt,zt),r.call(gt+"_mul",zt,qt,Mt),r.call(gt+"_conjugate",l,Yt),r.call(gt+"_mul",Yt,St,Ce),r.call(i+"__frobeniusMap3",Ce,je),r.call(gt+"_mul",je,Mt,A))}function M(){Pt(),B();const b=t.addFunction(i+"_finalExponentiation");b.addParam("x","i32"),b.addParam("r","i32");const r=b.getCodeBuilder(),l=r.getLocal("x"),A=r.getLocal("r"),S=r.i32_const(t.alloc(_));b.addCode(r.call(i+"__finalExponentiationFirstChunk",l,S),r.call(i+"__finalExponentiationLastChunk",S,A))}function H(){const b=t.addFunction(i+"_finalExponentiationOld");b.addParam("x","i32"),b.addParam("r","i32");const r=mt("552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480"),l=t.alloc($t.bigInt2BytesLE(r,352)),A=b.getCodeBuilder();b.addCode(A.call(gt+"_exp",A.getLocal("x"),A.i32_const(l),A.i32_const(352),A.getLocal("r")))}const j=t.alloc(W),rt=t.alloc(q);function et(b){const r=t.addFunction(i+"_pairingEq"+b);for(let P=0;P<b;P++)r.addParam("p_"+P,"i32"),r.addParam("q_"+P,"i32");r.addParam("c","i32"),r.setReturnType("i32");const l=r.getCodeBuilder(),A=l.i32_const(t.alloc(_)),S=l.i32_const(t.alloc(_));r.addCode(l.call(gt+"_one",A));for(let P=0;P<b;P++)r.addCode(l.call(i+"_prepareG1",l.getLocal("p_"+P),l.i32_const(j))),r.addCode(l.call(i+"_prepareG2",l.getLocal("q_"+P),l.i32_const(rt))),r.addCode(l.call(i+"_millerLoop",l.i32_const(j),l.i32_const(rt),S)),r.addCode(l.call(gt+"_mul",A,S,A));r.addCode(l.call(i+"_finalExponentiation",A,A)),r.addCode(l.call(gt+"_eq",A,l.getLocal("c")))}function ct(){const b=t.addFunction(i+"_pairing");b.addParam("p","i32"),b.addParam("q","i32"),b.addParam("r","i32");const r=b.getCodeBuilder(),l=r.i32_const(t.alloc(_));b.addCode(r.call(i+"_prepareG1",r.getLocal("p"),r.i32_const(j))),b.addCode(r.call(i+"_prepareG2",r.getLocal("q"),r.i32_const(rt))),b.addCode(r.call(i+"_millerLoop",r.i32_const(j),r.i32_const(rt),l)),b.addCode(r.call(i+"_finalExponentiation",l,r.getLocal("r")))}It(),Ut(),lt(),Ft(),Lt(),Ct(),Et();for(let b=0;b<10;b++)Bt(b),t.exportFunction(i+"__frobeniusMap"+b);H(),M();for(let b=1;b<=5;b++)et(b),t.exportFunction(i+"_pairingEq"+b);ct(),t.exportFunction(i+"_pairing"),t.exportFunction(i+"_prepareG1"),t.exportFunction(i+"_prepareG2"),t.exportFunction(i+"_millerLoop"),t.exportFunction(i+"_finalExponentiation"),t.exportFunction(i+"_finalExponentiationOld"),t.exportFunction(i+"__mulBy024"),t.exportFunction(i+"__mulBy024Old"),t.exportFunction(i+"__cyclotomicSquare"),t.exportFunction(i+"__cyclotomicExp_w0")};const ht=un.exports,Dt=In,Vp=Xa,Kp=Cl,Gl=vl,Yp=Fl,Nl=xl,nr=Ol,Zp=Tl,Jp=Pl,Xi=Rl;var Xp=function(t,n){const i=n||"bls12381";if(t.modules[i])return i;const o=ht("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),a=ht("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),c=Math.floor((o.minus(1).bitLength()-1)/64)+1,d=c*8,h=d,u=h*2,s=h*12,_=Math.floor((a.minus(1).bitLength()-1)/64)+1,L=_*8,g=L,F=t.alloc(Dt.bigInt2BytesLE(a,g)),T=Vp(t,o,"f1m","intq");Kp(t,a,"fr","frm","intr");const C=t.alloc(Dt.bigInt2BytesLE(v(ht(4)),h)),U=Nl(t,"g1m","f1m",C);nr(t,"frm","frm","frm","frm_mul"),Zp(t,"pol","frm"),Jp(t,"qap","frm");const x=Gl(t,"f1m_neg","f2m","f1m"),V=t.alloc([...Dt.bigInt2BytesLE(v(ht("4")),h),...Dt.bigInt2BytesLE(v(ht("4")),h)]),D=Nl(t,"g2m","f2m",V);function $(r,l){const A=t.addFunction(r);A.addParam("pG","i32"),A.addParam("pFr","i32"),A.addParam("pr","i32");const S=A.getCodeBuilder(),P=S.i32_const(t.alloc(L));A.addCode(S.call("frm_fromMontgomery",S.getLocal("pFr"),P),S.call(l,S.getLocal("pG"),P,S.i32_const(L),S.getLocal("pr"))),t.exportFunction(r)}$("g1m_timesFr","g1m_timesScalar"),nr(t,"g1m","g1m","frm","g1m_timesFr"),$("g2m_timesFr","g2m_timesScalar"),nr(t,"g2m","g2m","frm","g2m_timesFr"),$("g1m_timesFrAffine","g1m_timesScalarAffine"),$("g2m_timesFrAffine","g2m_timesScalarAffine"),Xi(t,"frm_batchApplyKey","fmr","frm",L,L,L,"frm_mul"),Xi(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,L,"g1m_timesFr"),Xi(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,L,"g1m_timesFrAffine"),Xi(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,L,"g2m_timesFr"),Xi(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,L,"g2m_timesFrAffine");function v(r){return ht(r).times(ht.one.shiftLeft(h*8)).mod(o)}const m=[ht("3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507"),ht("1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569"),ht.one],y=t.alloc([...Dt.bigInt2BytesLE(v(m[0]),h),...Dt.bigInt2BytesLE(v(m[1]),h),...Dt.bigInt2BytesLE(v(m[2]),h)]),G=[ht.zero,ht.one,ht.zero],k=t.alloc([...Dt.bigInt2BytesLE(v(G[0]),h),...Dt.bigInt2BytesLE(v(G[1]),h),...Dt.bigInt2BytesLE(v(G[2]),h)]),N=[[ht("352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160"),ht("3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758")],[ht("1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905"),ht("927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582")],[ht.one,ht.zero]],R=t.alloc([...Dt.bigInt2BytesLE(v(N[0][0]),h),...Dt.bigInt2BytesLE(v(N[0][1]),h),...Dt.bigInt2BytesLE(v(N[1][0]),h),...Dt.bigInt2BytesLE(v(N[1][1]),h),...Dt.bigInt2BytesLE(v(N[2][0]),h),...Dt.bigInt2BytesLE(v(N[2][1]),h)]),E=[[ht.zero,ht.zero],[ht.one,ht.zero],[ht.zero,ht.zero]],z=t.alloc([...Dt.bigInt2BytesLE(v(E[0][0]),h),...Dt.bigInt2BytesLE(v(E[0][1]),h),...Dt.bigInt2BytesLE(v(E[1][0]),h),...Dt.bigInt2BytesLE(v(E[1][1]),h),...Dt.bigInt2BytesLE(v(E[2][0]),h),...Dt.bigInt2BytesLE(v(E[2][1]),h)]),tt=t.alloc([...Dt.bigInt2BytesLE(v(1),h),...Dt.bigInt2BytesLE(v(0),h),...Dt.bigInt2BytesLE(v(0),h),...Dt.bigInt2BytesLE(v(0),h),...Dt.bigInt2BytesLE(v(0),h),...Dt.bigInt2BytesLE(v(0),h),...Dt.bigInt2BytesLE(v(0),h),...Dt.bigInt2BytesLE(v(0),h),...Dt.bigInt2BytesLE(v(0),h),...Dt.bigInt2BytesLE(v(0),h),...Dt.bigInt2BytesLE(v(0),h),...Dt.bigInt2BytesLE(v(0),h)]);t.alloc([...Dt.bigInt2BytesLE(v(ht(2).modInv(o)),h),...Dt.bigInt2BytesLE(ht(0),h)]);const at=t.alloc([...Dt.bigInt2BytesLE(v(1),h),...Dt.bigInt2BytesLE(v(1),h)]);t.alloc([...Dt.bigInt2BytesLE(v("4"),h),...Dt.bigInt2BytesLE(v("4"),h)]);function it(){const r=t.addFunction(x+"_mulNR");r.addParam("x","i32"),r.addParam("pr","i32");const l=r.getCodeBuilder(),A=l.i32_const(t.alloc(h)),S=l.getLocal("x"),P=l.i32_add(l.getLocal("x"),l.i32_const(h)),Q=l.getLocal("pr"),Y=l.i32_add(l.getLocal("pr"),l.i32_const(h));r.addCode(l.call(T+"_copy",S,A),l.call(T+"_sub",S,P,Q),l.call(T+"_add",A,P,Y))}it();const Z=Yp(t,x+"_mulNR","f6m","f2m");function ot(){const r=t.addFunction(Z+"_mulNR");r.addParam("x","i32"),r.addParam("pr","i32");const l=r.getCodeBuilder(),A=l.i32_const(t.alloc(h*2));r.addCode(l.call(x+"_copy",l.getLocal("x"),A),l.call(x+"_mulNR",l.i32_add(l.getLocal("x"),l.i32_const(d*4)),l.getLocal("pr")),l.call(x+"_copy",l.i32_add(l.getLocal("x"),l.i32_const(d*2)),l.i32_add(l.getLocal("pr"),l.i32_const(d*4))),l.call(x+"_copy",A,l.i32_add(l.getLocal("pr"),l.i32_const(d*2))))}ot();const nt=Gl(t,Z+"_mulNR","ftm",Z),gt=ht("d201000000010000",16),xt=dt(gt),pt=t.alloc(xt),yt=3*u,w=xt.length-1,O=xt.reduce((r,l)=>r+(l!=0?1:0),0)+w+1,p=3*2*d,W=3*d*2+O*yt,q=!0,I=ht("15132376222941642752");t.modules[i]={n64q:c,n64r:_,n8q:d,n8r:L,pG1gen:y,pG1zero:k,pG1b:C,pG2gen:R,pG2zero:z,pG2b:V,pq:t.modules.f1m.pq,pr:F,pOneT:tt,r:a,q:o,prePSize:p,preQSize:W};function J(r){let l=r;const A=[];for(;l.gt(ht.zero);){if(l.isOdd()){const S=2-l.mod(4).toJSNumber();A.push(S),l=l.minus(S)}else A.push(0);l=l.shiftRight(1)}return A}function dt(r){let l=r;const A=[];for(;l.gt(ht.zero);)l.isOdd()?A.push(1):A.push(0),l=l.shiftRight(1);return A}function lt(){const r=t.addFunction(i+"_prepareG1");r.addParam("pP","i32"),r.addParam("ppreP","i32");const l=r.getCodeBuilder();r.addCode(l.call(U+"_normalize",l.getLocal("pP"),l.getLocal("ppreP")))}function It(){const r=t.addFunction(i+"_prepDblStep");r.addParam("R","i32"),r.addParam("r","i32");const l=r.getCodeBuilder(),A=l.getLocal("R"),S=l.i32_add(l.getLocal("R"),l.i32_const(2*d)),P=l.i32_add(l.getLocal("R"),l.i32_const(4*d)),Q=l.getLocal("r"),Y=l.i32_add(l.getLocal("r"),l.i32_const(2*d)),st=l.i32_add(l.getLocal("r"),l.i32_const(4*d)),ft=l.i32_const(t.alloc(u)),_t=l.i32_const(t.alloc(u)),ut=l.i32_const(t.alloc(u)),wt=l.i32_const(t.alloc(u)),Rt=l.i32_const(t.alloc(u));r.addCode(l.call(x+"_square",A,Q),l.call(x+"_square",S,_t),l.call(x+"_square",_t,ut),l.call(x+"_add",_t,A,Y),l.call(x+"_square",Y,Y),l.call(x+"_sub",Y,Q,Y),l.call(x+"_sub",Y,ut,Y),l.call(x+"_add",Y,Y,Y),l.call(x+"_add",Q,Q,wt),l.call(x+"_add",wt,Q,wt),l.call(x+"_add",A,wt,st),l.call(x+"_square",wt,Rt),l.call(x+"_square",P,ft),l.call(x+"_sub",Rt,Y,A),l.call(x+"_sub",A,Y,A),l.call(x+"_add",P,S,P),l.call(x+"_square",P,P),l.call(x+"_sub",P,_t,P),l.call(x+"_sub",P,ft,P),l.call(x+"_sub",Y,A,S),l.call(x+"_mul",S,wt,S),l.call(x+"_add",ut,ut,ut),l.call(x+"_add",ut,ut,ut),l.call(x+"_add",ut,ut,ut),l.call(x+"_sub",S,ut,S),l.call(x+"_mul",wt,ft,Y),l.call(x+"_add",Y,Y,Y),l.call(x+"_neg",Y,Y),l.call(x+"_square",st,st),l.call(x+"_sub",st,Q,st),l.call(x+"_sub",st,Rt,st),l.call(x+"_add",_t,_t,_t),l.call(x+"_add",_t,_t,_t),l.call(x+"_sub",st,_t,st),l.call(x+"_mul",P,ft,Q),l.call(x+"_add",Q,Q,Q))}function Ut(){const r=t.addFunction(i+"_prepAddStep");r.addParam("R","i32"),r.addParam("Q","i32"),r.addParam("r","i32");const l=r.getCodeBuilder(),A=l.getLocal("R"),S=l.i32_add(l.getLocal("R"),l.i32_const(2*d)),P=l.i32_add(l.getLocal("R"),l.i32_const(4*d)),Q=l.getLocal("Q"),Y=l.i32_add(l.getLocal("Q"),l.i32_const(2*d)),st=l.getLocal("r"),ft=l.i32_add(l.getLocal("r"),l.i32_const(2*d)),_t=l.i32_add(l.getLocal("r"),l.i32_const(4*d)),ut=l.i32_const(t.alloc(u)),wt=l.i32_const(t.alloc(u)),Rt=l.i32_const(t.alloc(u)),Tt=l.i32_const(t.alloc(u)),St=l.i32_const(t.alloc(u)),Gt=l.i32_const(t.alloc(u)),Nt=l.i32_const(t.alloc(u)),Ht=l.i32_const(t.alloc(u)),qt=l.i32_const(t.alloc(u)),zt=l.i32_const(t.alloc(u)),Mt=l.i32_const(t.alloc(u));r.addCode(l.call(x+"_square",P,ut),l.call(x+"_square",Y,wt),l.call(x+"_mul",ut,Q,Tt),l.call(x+"_add",Y,P,ft),l.call(x+"_square",ft,ft),l.call(x+"_sub",ft,wt,ft),l.call(x+"_sub",ft,ut,ft),l.call(x+"_mul",ft,ut,ft),l.call(x+"_sub",Tt,A,St),l.call(x+"_square",St,Gt),l.call(x+"_add",Gt,Gt,Nt),l.call(x+"_add",Nt,Nt,Nt),l.call(x+"_mul",Nt,St,Ht),l.call(x+"_sub",ft,S,qt),l.call(x+"_sub",qt,S,qt),l.call(x+"_mul",qt,Q,_t),l.call(x+"_mul",Nt,A,zt),l.call(x+"_square",qt,A),l.call(x+"_sub",A,Ht,A),l.call(x+"_sub",A,zt,A),l.call(x+"_sub",A,zt,A),l.call(x+"_add",P,St,P),l.call(x+"_square",P,P),l.call(x+"_sub",P,ut,P),l.call(x+"_sub",P,Gt,P),l.call(x+"_add",Y,P,st),l.call(x+"_sub",zt,A,Mt),l.call(x+"_mul",Mt,qt,Mt),l.call(x+"_mul",S,Ht,Tt),l.call(x+"_add",Tt,Tt,Tt),l.call(x+"_sub",Mt,Tt,S),l.call(x+"_square",st,st),l.call(x+"_sub",st,wt,st),l.call(x+"_square",P,Rt),l.call(x+"_sub",st,Rt,st),l.call(x+"_add",_t,_t,_t),l.call(x+"_sub",_t,st,_t),l.call(x+"_add",P,P,st),l.call(x+"_neg",qt,qt),l.call(x+"_add",qt,qt,ft))}function Ot(){const r=t.addFunction(i+"_prepareG2");r.addParam("pQ","i32"),r.addParam("ppreQ","i32"),r.addLocal("pCoef","i32"),r.addLocal("i","i32");const l=r.getCodeBuilder(),A=l.getLocal("pQ"),S=t.alloc(u*3),P=l.i32_const(S),Q=l.getLocal("ppreQ");r.addCode(l.call(D+"_normalize",A,Q),l.if(l.call(D+"_isZero",Q),l.ret([])),l.call(D+"_copy",Q,P),l.setLocal("pCoef",l.i32_add(l.getLocal("ppreQ"),l.i32_const(u*3)))),r.addCode(l.setLocal("i",l.i32_const(xt.length-2)),l.block(l.loop(l.call(i+"_prepDblStep",P,l.getLocal("pCoef")),l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(yt))),l.if(l.i32_load8_s(l.getLocal("i"),pt),[...l.call(i+"_prepAddStep",P,Q,l.getLocal("pCoef")),...l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(yt)))]),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.br(0))))}function Ft(){const r=t.addFunction(Z+"_mul1");r.addParam("pA","i32"),r.addParam("pC1","i32"),r.addParam("pR","i32");const l=r.getCodeBuilder(),A=l.getLocal("pA"),S=l.i32_add(l.getLocal("pA"),l.i32_const(h*2)),P=l.i32_add(l.getLocal("pA"),l.i32_const(h*4)),Q=l.getLocal("pC1"),Y=l.getLocal("pR"),st=l.i32_add(l.getLocal("pR"),l.i32_const(h*2)),ft=l.i32_add(l.getLocal("pR"),l.i32_const(h*4)),_t=l.i32_const(t.alloc(h*2)),ut=l.i32_const(t.alloc(h*2));r.addCode(l.call(x+"_add",A,S,_t),l.call(x+"_add",S,P,ut),l.call(x+"_mul",S,Q,ft),l.call(x+"_mul",ut,Q,Y),l.call(x+"_sub",Y,ft,Y),l.call(x+"_mulNR",Y,Y),l.call(x+"_mul",_t,Q,st),l.call(x+"_sub",st,ft,st))}Ft();function Ct(){const r=t.addFunction(Z+"_mul01");r.addParam("pA","i32"),r.addParam("pC0","i32"),r.addParam("pC1","i32"),r.addParam("pR","i32");const l=r.getCodeBuilder(),A=l.getLocal("pA"),S=l.i32_add(l.getLocal("pA"),l.i32_const(h*2)),P=l.i32_add(l.getLocal("pA"),l.i32_const(h*4)),Q=l.getLocal("pC0"),Y=l.getLocal("pC1"),st=l.getLocal("pR"),ft=l.i32_add(l.getLocal("pR"),l.i32_const(h*2)),_t=l.i32_add(l.getLocal("pR"),l.i32_const(h*4)),ut=l.i32_const(t.alloc(h*2)),wt=l.i32_const(t.alloc(h*2)),Rt=l.i32_const(t.alloc(h*2)),Tt=l.i32_const(t.alloc(h*2));r.addCode(l.call(x+"_mul",A,Q,ut),l.call(x+"_mul",S,Y,wt),l.call(x+"_add",A,S,Rt),l.call(x+"_add",A,P,Tt),l.call(x+"_add",S,P,st),l.call(x+"_mul",st,Y,st),l.call(x+"_sub",st,wt,st),l.call(x+"_mulNR",st,st),l.call(x+"_add",st,ut,st),l.call(x+"_add",Q,Y,ft),l.call(x+"_mul",ft,Rt,ft),l.call(x+"_sub",ft,ut,ft),l.call(x+"_sub",ft,wt,ft),l.call(x+"_mul",Tt,Q,_t),l.call(x+"_sub",_t,ut,_t),l.call(x+"_add",_t,wt,_t))}Ct();function Lt(){const r=t.addFunction(nt+"_mul014");r.addParam("pA","i32"),r.addParam("pC0","i32"),r.addParam("pC1","i32"),r.addParam("pC4","i32"),r.addParam("pR","i32");const l=r.getCodeBuilder(),A=l.getLocal("pA"),S=l.i32_add(l.getLocal("pA"),l.i32_const(h*6)),P=l.getLocal("pC0"),Q=l.getLocal("pC1"),Y=l.getLocal("pC4"),st=l.i32_const(t.alloc(h*6)),ft=l.i32_const(t.alloc(h*6)),_t=l.i32_const(t.alloc(h*2)),ut=l.getLocal("pR"),wt=l.i32_add(l.getLocal("pR"),l.i32_const(h*6));r.addCode(l.call(Z+"_mul01",A,P,Q,st),l.call(Z+"_mul1",S,Y,ft),l.call(x+"_add",Q,Y,_t),l.call(Z+"_add",S,A,wt),l.call(Z+"_mul01",wt,P,_t,wt),l.call(Z+"_sub",wt,st,wt),l.call(Z+"_sub",wt,ft,wt),l.call(Z+"_copy",ft,ut),l.call(Z+"_mulNR",ut,ut),l.call(Z+"_add",ut,st,ut))}Lt();function Et(){const r=t.addFunction(i+"_ell");r.addParam("pP","i32"),r.addParam("pCoefs","i32"),r.addParam("pF","i32");const l=r.getCodeBuilder(),A=l.getLocal("pP"),S=l.i32_add(l.getLocal("pP"),l.i32_const(d)),P=l.getLocal("pF"),Q=l.getLocal("pCoefs"),Y=l.i32_add(l.getLocal("pCoefs"),l.i32_const(h)),st=l.i32_add(l.getLocal("pCoefs"),l.i32_const(h*2)),ft=l.i32_add(l.getLocal("pCoefs"),l.i32_const(h*3)),_t=l.i32_add(l.getLocal("pCoefs"),l.i32_const(h*4)),ut=t.alloc(h*2),wt=l.i32_const(ut),Rt=l.i32_const(ut),Tt=l.i32_const(ut+h),St=t.alloc(h*2),Gt=l.i32_const(St),Nt=l.i32_const(St),Ht=l.i32_const(St+h);r.addCode(l.call(T+"_mul",Q,S,Rt),l.call(T+"_mul",Y,S,Tt),l.call(T+"_mul",st,A,Nt),l.call(T+"_mul",ft,A,Ht),l.call(nt+"_mul014",P,_t,Gt,wt,P))}Et();function Bt(){const r=t.addFunction(i+"_millerLoop");r.addParam("ppreP","i32"),r.addParam("ppreQ","i32"),r.addParam("r","i32"),r.addLocal("pCoef","i32"),r.addLocal("i","i32");const l=r.getCodeBuilder(),A=l.getLocal("ppreP");l.getLocal("ppreQ");const S=l.getLocal("pCoef"),P=l.getLocal("r");r.addCode(l.call(nt+"_one",P),l.if(l.call(U+"_isZero",A),l.ret([])),l.if(l.call(U+"_isZero",l.getLocal("ppreQ")),l.ret([])),l.setLocal("pCoef",l.i32_add(l.getLocal("ppreQ"),l.i32_const(u*3))),l.setLocal("i",l.i32_const(xt.length-2)),l.block(l.loop(l.call(i+"_ell",A,S,P),l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(yt))),l.if(l.i32_load8_s(l.getLocal("i"),pt),[...l.call(i+"_ell",A,S,P),...l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(yt)))]),l.call(nt+"_square",P,P),l.br_if(1,l.i32_eq(l.getLocal("i"),l.i32_const(1))),l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.br(0))),l.call(i+"_ell",A,S,P)),r.addCode(l.call(nt+"_conjugate",P,P))}function Pt(r){const l=[[[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")]],[[ht("1"),ht("0")],[ht("3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760"),ht("151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027")],[ht("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351"),ht("0")],[ht("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530"),ht("1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257")],[ht("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),ht("0")],[ht("3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557"),ht("877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230")],[ht("4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786"),ht("0")],[ht("151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027"),ht("3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760")],[ht("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),ht("0")],[ht("1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257"),ht("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530")],[ht("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437"),ht("0")],[ht("877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230"),ht("3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557")]]],A=[[[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")],[ht("1"),ht("0")]],[[ht("1"),ht("0")],[ht("0"),ht("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436")],[ht("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),ht("0")],[ht("0"),ht("1")],[ht("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),ht("0")],[ht("0"),ht("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350")]],[[ht("1"),ht("0")],[ht("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437"),ht("0")],[ht("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),ht("0")],[ht("4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786"),ht("0")],[ht("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),ht("0")],[ht("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351"),ht("0")]]],S=t.addFunction(nt+"_frobeniusMap"+r);S.addParam("x","i32"),S.addParam("r","i32");const P=S.getCodeBuilder();for(let Y=0;Y<6;Y++){const st=Y==0?P.getLocal("x"):P.i32_add(P.getLocal("x"),P.i32_const(Y*u)),ft=st,_t=P.i32_add(P.getLocal("x"),P.i32_const(Y*u+h)),ut=Y==0?P.getLocal("r"):P.i32_add(P.getLocal("r"),P.i32_const(Y*u)),wt=ut,Rt=P.i32_add(P.getLocal("r"),P.i32_const(Y*u+h)),Tt=Q(l[Math.floor(Y/3)][r%12],A[Y%3][r%6]),St=t.alloc([...Dt.bigInt2BytesLE(v(Tt[0]),d),...Dt.bigInt2BytesLE(v(Tt[1]),d)]);r%2==1?S.addCode(P.call(T+"_copy",ft,wt),P.call(T+"_neg",_t,Rt),P.call(x+"_mul",ut,P.i32_const(St),ut)):S.addCode(P.call(x+"_mul",st,P.i32_const(St),ut))}function Q(Y,st){const ft=ht(Y[0]),_t=ht(Y[1]),ut=ht(st[0]),wt=ht(st[1]),Rt=[ft.times(ut).minus(_t.times(wt)).mod(o),ft.times(wt).add(_t.times(ut)).mod(o)];return Rt[0].isNegative()&&(Rt[0]=Rt[0].add(o)),Rt}}function vt(){const r=t.addFunction(i+"__cyclotomicSquare");r.addParam("x","i32"),r.addParam("r","i32");const l=r.getCodeBuilder(),A=l.getLocal("x"),S=l.i32_add(l.getLocal("x"),l.i32_const(u)),P=l.i32_add(l.getLocal("x"),l.i32_const(2*u)),Q=l.i32_add(l.getLocal("x"),l.i32_const(3*u)),Y=l.i32_add(l.getLocal("x"),l.i32_const(4*u)),st=l.i32_add(l.getLocal("x"),l.i32_const(5*u)),ft=l.getLocal("r"),_t=l.i32_add(l.getLocal("r"),l.i32_const(u)),ut=l.i32_add(l.getLocal("r"),l.i32_const(2*u)),wt=l.i32_add(l.getLocal("r"),l.i32_const(3*u)),Rt=l.i32_add(l.getLocal("r"),l.i32_const(4*u)),Tt=l.i32_add(l.getLocal("r"),l.i32_const(5*u)),St=l.i32_const(t.alloc(u)),Gt=l.i32_const(t.alloc(u)),Nt=l.i32_const(t.alloc(u)),Ht=l.i32_const(t.alloc(u)),qt=l.i32_const(t.alloc(u)),zt=l.i32_const(t.alloc(u)),Mt=l.i32_const(t.alloc(u)),Yt=l.i32_const(t.alloc(u));r.addCode(l.call(x+"_mul",A,Y,Mt),l.call(x+"_mulNR",Y,St),l.call(x+"_add",A,St,St),l.call(x+"_add",A,Y,Yt),l.call(x+"_mul",Yt,St,St),l.call(x+"_mulNR",Mt,Yt),l.call(x+"_add",Mt,Yt,Yt),l.call(x+"_sub",St,Yt,St),l.call(x+"_add",Mt,Mt,Gt),l.call(x+"_mul",Q,P,Mt),l.call(x+"_mulNR",P,Nt),l.call(x+"_add",Q,Nt,Nt),l.call(x+"_add",Q,P,Yt),l.call(x+"_mul",Yt,Nt,Nt),l.call(x+"_mulNR",Mt,Yt),l.call(x+"_add",Mt,Yt,Yt),l.call(x+"_sub",Nt,Yt,Nt),l.call(x+"_add",Mt,Mt,Ht),l.call(x+"_mul",S,st,Mt),l.call(x+"_mulNR",st,qt),l.call(x+"_add",S,qt,qt),l.call(x+"_add",S,st,Yt),l.call(x+"_mul",Yt,qt,qt),l.call(x+"_mulNR",Mt,Yt),l.call(x+"_add",Mt,Yt,Yt),l.call(x+"_sub",qt,Yt,qt),l.call(x+"_add",Mt,Mt,zt),l.call(x+"_sub",St,A,ft),l.call(x+"_add",ft,ft,ft),l.call(x+"_add",St,ft,ft),l.call(x+"_add",Gt,Y,Rt),l.call(x+"_add",Rt,Rt,Rt),l.call(x+"_add",Gt,Rt,Rt),l.call(x+"_mul",zt,l.i32_const(at),Yt),l.call(x+"_add",Yt,Q,wt),l.call(x+"_add",wt,wt,wt),l.call(x+"_add",Yt,wt,wt),l.call(x+"_sub",qt,P,ut),l.call(x+"_add",ut,ut,ut),l.call(x+"_add",qt,ut,ut),l.call(x+"_sub",Nt,S,_t),l.call(x+"_add",_t,_t,_t),l.call(x+"_add",Nt,_t,_t),l.call(x+"_add",Ht,st,Tt),l.call(x+"_add",Tt,Tt,Tt),l.call(x+"_add",Ht,Tt,Tt))}function Wt(r,l,A){const S=J(r).map(ut=>ut==-1?255:ut),P=t.alloc(S),Q=t.addFunction(i+"__cyclotomicExp_"+A);Q.addParam("x","i32"),Q.addParam("r","i32"),Q.addLocal("bit","i32"),Q.addLocal("i","i32");const Y=Q.getCodeBuilder(),st=Y.getLocal("x"),ft=Y.getLocal("r"),_t=Y.i32_const(t.alloc(s));Q.addCode(Y.call(nt+"_conjugate",st,_t),Y.call(nt+"_one",ft),Y.if(Y.teeLocal("bit",Y.i32_load8_s(Y.i32_const(S.length-1),P)),Y.if(Y.i32_eq(Y.getLocal("bit"),Y.i32_const(1)),Y.call(nt+"_mul",ft,st,ft),Y.call(nt+"_mul",ft,_t,ft))),Y.setLocal("i",Y.i32_const(S.length-2)),Y.block(Y.loop(Y.call(i+"__cyclotomicSquare",ft,ft),Y.if(Y.teeLocal("bit",Y.i32_load8_s(Y.getLocal("i"),P)),Y.if(Y.i32_eq(Y.getLocal("bit"),Y.i32_const(1)),Y.call(nt+"_mul",ft,st,ft),Y.call(nt+"_mul",ft,_t,ft))),Y.br_if(1,Y.i32_eqz(Y.getLocal("i"))),Y.setLocal("i",Y.i32_sub(Y.getLocal("i"),Y.i32_const(1))),Y.br(0)))),l&&Q.addCode(Y.call(nt+"_conjugate",ft,ft))}function B(){vt(),Wt(I,q,"w0");const r=t.addFunction(i+"_finalExponentiation");r.addParam("x","i32"),r.addParam("r","i32");const l=r.getCodeBuilder(),A=l.getLocal("x"),S=l.getLocal("r"),P=l.i32_const(t.alloc(s)),Q=l.i32_const(t.alloc(s)),Y=l.i32_const(t.alloc(s)),st=l.i32_const(t.alloc(s)),ft=l.i32_const(t.alloc(s)),_t=l.i32_const(t.alloc(s)),ut=l.i32_const(t.alloc(s));r.addCode(l.call(nt+"_frobeniusMap6",A,P),l.call(nt+"_inverse",A,Q),l.call(nt+"_mul",P,Q,Y),l.call(nt+"_copy",Y,Q),l.call(nt+"_frobeniusMap2",Y,Y),l.call(nt+"_mul",Y,Q,Y),l.call(i+"__cyclotomicSquare",Y,Q),l.call(nt+"_conjugate",Q,Q),l.call(i+"__cyclotomicExp_w0",Y,st),l.call(i+"__cyclotomicSquare",st,ft),l.call(nt+"_mul",Q,st,_t),l.call(i+"__cyclotomicExp_w0",_t,Q),l.call(i+"__cyclotomicExp_w0",Q,P),l.call(i+"__cyclotomicExp_w0",P,ut),l.call(nt+"_mul",ut,ft,ut),l.call(i+"__cyclotomicExp_w0",ut,ft),l.call(nt+"_conjugate",_t,_t),l.call(nt+"_mul",ft,_t,ft),l.call(nt+"_mul",ft,Y,ft),l.call(nt+"_conjugate",Y,_t),l.call(nt+"_mul",Q,Y,Q),l.call(nt+"_frobeniusMap3",Q,Q),l.call(nt+"_mul",ut,_t,ut),l.call(nt+"_frobeniusMap1",ut,ut),l.call(nt+"_mul",st,P,st),l.call(nt+"_frobeniusMap2",st,st),l.call(nt+"_mul",st,Q,st),l.call(nt+"_mul",st,ut,st),l.call(nt+"_mul",st,ft,S))}function M(){const r=t.addFunction(i+"_finalExponentiationOld");r.addParam("x","i32"),r.addParam("r","i32");const l=ht("322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560"),A=t.alloc(Dt.bigInt2BytesLE(l,544)),S=r.getCodeBuilder();r.addCode(S.call(nt+"_exp",S.getLocal("x"),S.i32_const(A),S.i32_const(544),S.getLocal("r")))}const H=t.alloc(p),j=t.alloc(W);function rt(r){const l=t.addFunction(i+"_pairingEq"+r);for(let Q=0;Q<r;Q++)l.addParam("p_"+Q,"i32"),l.addParam("q_"+Q,"i32");l.addParam("c","i32"),l.setReturnType("i32");const A=l.getCodeBuilder(),S=A.i32_const(t.alloc(s)),P=A.i32_const(t.alloc(s));l.addCode(A.call(nt+"_one",S));for(let Q=0;Q<r;Q++)l.addCode(A.call(i+"_prepareG1",A.getLocal("p_"+Q),A.i32_const(H))),l.addCode(A.call(i+"_prepareG2",A.getLocal("q_"+Q),A.i32_const(j))),l.addCode(A.if(A.i32_eqz(A.call(U+"_inGroupAffine",A.i32_const(H))),A.ret(A.i32_const(0))),A.if(A.i32_eqz(A.call(D+"_inGroupAffine",A.i32_const(j))),A.ret(A.i32_const(0)))),l.addCode(A.call(i+"_millerLoop",A.i32_const(H),A.i32_const(j),P)),l.addCode(A.call(nt+"_mul",S,P,S));l.addCode(A.call(i+"_finalExponentiation",S,S)),l.addCode(A.call(nt+"_eq",S,A.getLocal("c")))}function et(){const r=t.addFunction(i+"_pairing");r.addParam("p","i32"),r.addParam("q","i32"),r.addParam("r","i32");const l=r.getCodeBuilder(),A=l.i32_const(t.alloc(s));r.addCode(l.call(i+"_prepareG1",l.getLocal("p"),l.i32_const(H))),r.addCode(l.call(i+"_prepareG2",l.getLocal("q"),l.i32_const(j))),r.addCode(l.call(i+"_millerLoop",l.i32_const(H),l.i32_const(j),A)),r.addCode(l.call(i+"_finalExponentiation",A,l.getLocal("r")))}function ct(){const r=t.addFunction(D+"_inGroupAffine");r.addParam("p","i32"),r.setReturnType("i32");const l=r.getCodeBuilder(),A=[ht("2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894"),ht("2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893")],S=ht("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),P=[ht("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530"),ht("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530")],Q=l.i32_const(t.alloc([...Dt.bigInt2BytesLE(v(A[0]),d),...Dt.bigInt2BytesLE(v(A[1]),d)])),Y=l.i32_const(t.alloc(Dt.bigInt2BytesLE(v(S),d))),st=l.i32_const(t.alloc([...Dt.bigInt2BytesLE(v(P[0]),d),...Dt.bigInt2BytesLE(v(P[1]),d)])),ft=l.i32_const(t.alloc(Dt.bigInt2BytesLE(I,8))),_t=l.getLocal("p"),ut=l.i32_add(l.getLocal("p"),l.i32_const(u)),wt=l.i32_const(t.alloc(h)),Rt=l.i32_const(t.alloc(u)),Tt=l.i32_const(t.alloc(u)),St=t.alloc(u*2),Gt=l.i32_const(St),Nt=l.i32_const(St),Ht=l.i32_const(St),qt=l.i32_const(St+h),zt=l.i32_const(St+u),Mt=l.i32_const(St+u),Yt=l.i32_const(St+u+h),Ce=t.alloc(u*3),je=l.i32_const(Ce),Bi=l.i32_const(Ce),qn=l.i32_const(Ce),zn=l.i32_const(Ce+h),xi=l.i32_const(Ce+u),Dn=l.i32_const(Ce+u),kn=l.i32_const(Ce+u+h),Oi=l.i32_const(Ce+u*2);r.addCode(l.if(l.call(D+"_isZeroAffine",l.getLocal("p")),l.ret(l.i32_const(1))),l.if(l.i32_eqz(l.call(D+"_inCurveAffine",l.getLocal("p"))),l.ret(l.i32_const(0))),l.call(x+"_mul",_t,Q,Rt),l.call(x+"_mul",ut,Q,Tt),l.call(x+"_mul1",Rt,Y,Nt),l.call(x+"_neg",Tt,zt),l.call(x+"_neg",Rt,Bi),l.call(x+"_mul",Tt,st,xi),l.call(T+"_sub",Ht,qt,wt),l.call(T+"_add",Ht,qt,qt),l.call(T+"_copy",wt,Ht),l.call(T+"_sub",Mt,Yt,wt),l.call(T+"_add",Mt,Yt,Yt),l.call(T+"_copy",wt,Mt),l.call(T+"_add",qn,zn,wt),l.call(T+"_sub",qn,zn,zn),l.call(T+"_copy",wt,qn),l.call(T+"_sub",kn,Dn,wt),l.call(T+"_add",Dn,kn,kn),l.call(T+"_copy",wt,Dn),l.call(x+"_one",Oi),l.call(D+"_timesScalar",je,ft,l.i32_const(8),je),l.call(D+"_addMixed",je,Gt,je),l.ret(l.call(D+"_eqMixed",je,l.getLocal("p"))));const Sn=t.addFunction(D+"_inGroup");Sn.addParam("pIn","i32"),Sn.setReturnType("i32");const _n=Sn.getCodeBuilder(),oi=_n.i32_const(t.alloc(u*2));Sn.addCode(_n.call(D+"_toAffine",_n.getLocal("pIn"),oi),_n.ret(_n.call(D+"_inGroupAffine",oi)))}function b(){const r=t.addFunction(U+"_inGroupAffine");r.addParam("p","i32"),r.setReturnType("i32");const l=r.getCodeBuilder(),A=ht("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),S=ht("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),P=I.times(I).minus(ht.one).divide(ht(3)),Q=l.i32_const(t.alloc(Dt.bigInt2BytesLE(v(A),d))),Y=l.i32_const(t.alloc(Dt.bigInt2BytesLE(v(S),d))),st=l.i32_const(t.alloc(Dt.bigInt2BytesLE(P,16))),ft=l.getLocal("p"),_t=l.i32_add(l.getLocal("p"),l.i32_const(h)),ut=t.alloc(h*3),wt=l.i32_const(ut),Rt=l.i32_const(ut),Tt=l.i32_const(ut+h);l.i32_const(ut+2*h);const St=t.alloc(h*2),Gt=l.i32_const(St),Nt=l.i32_const(St),Ht=l.i32_const(St+h);r.addCode(l.if(l.call(U+"_isZeroAffine",l.getLocal("p")),l.ret(l.i32_const(1))),l.if(l.i32_eqz(l.call(U+"_inCurveAffine",l.getLocal("p"))),l.ret(l.i32_const(0))),l.call(T+"_mul",ft,Q,Rt),l.call(T+"_copy",_t,Tt),l.call(T+"_mul",ft,Y,Nt),l.call(T+"_copy",_t,Ht),l.call(U+"_doubleAffine",wt,wt),l.call(U+"_subMixed",wt,l.getLocal("p"),wt),l.call(U+"_subMixed",wt,Gt,wt),l.call(U+"_timesScalar",wt,st,l.i32_const(16),wt),l.ret(l.call(U+"_eqMixed",wt,Gt)));const qt=t.addFunction(U+"_inGroup");qt.addParam("pIn","i32"),qt.setReturnType("i32");const zt=qt.getCodeBuilder(),Mt=zt.i32_const(t.alloc(h*2));qt.addCode(zt.call(U+"_toAffine",zt.getLocal("pIn"),Mt),zt.ret(zt.call(U+"_inGroupAffine",Mt)))}for(let r=0;r<10;r++)Pt(r),t.exportFunction(nt+"_frobeniusMap"+r);b(),ct(),Ut(),It(),lt(),Ot(),Bt(),M(),B();for(let r=1;r<=5;r++)rt(r),t.exportFunction(i+"_pairingEq"+r);et(),t.exportFunction(i+"_pairing"),t.exportFunction(i+"_prepareG1"),t.exportFunction(i+"_prepareG2"),t.exportFunction(i+"_millerLoop"),t.exportFunction(i+"_finalExponentiation"),t.exportFunction(i+"_finalExponentiationOld"),t.exportFunction(i+"__cyclotomicSquare"),t.exportFunction(i+"__cyclotomicExp_w0"),t.exportFunction(Z+"_mul1"),t.exportFunction(Z+"_mul01"),t.exportFunction(nt+"_mul014"),t.exportFunction(U+"_inGroupAffine"),t.exportFunction(U+"_inGroup"),t.exportFunction(D+"_inGroupAffine"),t.exportFunction(D+"_inGroup")},ql=jp,zl=Xp;function ir(e){if(typeof e=="bigint"||e.eq!==void 0)return e.toString(10);if(e instanceof Uint8Array)return wl(e,0);if(Array.isArray(e))return e.map(ir);if(typeof e=="object"){const t={};return Object.keys(e).forEach(i=>{t[i]=ir(e[i])}),t}else return e}function or(e){if(typeof e=="string"&&/^[0-9]+$/.test(e))return BigInt(e);if(typeof e=="string"&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(or);if(typeof e=="object"){if(e===null)return null;const t={};return Object.keys(e).forEach(i=>{t[i]=or(e[i])}),t}else return e}function t_(e){let t=BigInt(0),n=e.length,i=0;const o=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n>0;)n>=4?(n-=4,t+=BigInt(o.getUint32(n))<<BigInt(i*8),i+=4):n>=2?(n-=2,t+=BigInt(o.getUint16(n))<<BigInt(i*8),i+=2):(n-=1,t+=BigInt(o.getUint8(n))<<BigInt(i*8),i+=1);return t}function e_(e,t){let n=e;const i=new Uint8Array(t),o=new DataView(i.buffer);let a=t;for(;a>0;)a-4>=0?(a-=4,o.setUint32(a,Number(n&BigInt(4294967295))),n=n>>BigInt(32)):a-2>=0?(a-=2,o.setUint16(a,Number(n&BigInt(65535))),n=n>>BigInt(16)):(a-=1,o.setUint8(a,Number(n&BigInt(255))),n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function n_(e){let t=BigInt(0),n=0;const i=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n<e.length;)n+4<=e.length?(t+=BigInt(i.getUint32(n,!0))<<BigInt(n*8),n+=4):n+4<=e.length?(t+=BigInt(i.getUint16(n,!0))<<BigInt(n*8),n+=2):(t+=BigInt(i.getUint8(n,!0))<<BigInt(n*8),n+=1);return t}function i_(e,t){let n=e;typeof t=="undefined"&&(t=Math.floor((Il(e)-1)/8)+1,t==0&&(t=1));const i=new Uint8Array(t),o=new DataView(i.buffer);let a=0;for(;a<t;)a+4<=t?(o.setUint32(a,Number(n&BigInt(4294967295)),!0),a+=4,n=n>>BigInt(32)):a+2<=t?(o.setUint16(Number(a,n&BigInt(65535)),!0),a+=2,n=n>>BigInt(16)):(o.setUint8(Number(a,n&BigInt(255)),!0),a+=1,n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function ar(e,t){if(typeof t=="bigint"||t.eq!==void 0)return t.toString(10);if(t instanceof Uint8Array)return e.toString(e.e(t));if(Array.isArray(t))return t.map(ar.bind(this,e));if(typeof t=="object"){const n={};return Object.keys(t).forEach(o=>{n[o]=ar(e,t[o])}),n}else return t}function rr(e,t){if(typeof t=="string"&&/^[0-9]+$/.test(t))return e.e(t);if(typeof t=="string"&&/^0x[0-9a-fA-F]+$/.test(t))return e.e(t);if(Array.isArray(t))return t.map(rr.bind(this,e));if(typeof t=="object"){if(t===null)return null;const n={};return Object.keys(t).forEach(o=>{n[o]=rr(e,t[o])}),n}else return t}var o_=Object.freeze({__proto__:null,stringifyBigInts:ir,unstringifyBigInts:or,beBuff2int:t_,beInt2Buff:e_,leBuff2int:n_,leInt2Buff:i_,stringifyFElements:ar,unstringifyFElements:rr});function sr(e){if(typeof e=="bigint"||e.eq!==void 0)return e.toString(10);if(Array.isArray(e))return e.map(sr);if(typeof e=="object"){const t={};return Object.keys(e).forEach(i=>{t[i]=sr(e[i])}),t}else return e}function cr(e){if(typeof e=="string"&&/^[0-9]+$/.test(e))return X(e);if(typeof e=="string"&&/^0x[0-9a-fA-F]+$/.test(e))return X(e);if(Array.isArray(e))return e.map(cr);if(typeof e=="object"){const t={};return Object.keys(e).forEach(i=>{t[i]=cr(e[i])}),t}else return e}function a_(e){let t=X.zero;for(let n=0;n<e.length;n++){const i=X(e[e.length-n-1]);t=t.add(i.shiftLeft(n*8))}return t}function r_(e,t){let n=e,i=t-1;const o=new Uint8Array(t);for(;n.gt(X.zero)&&i>=0;){let a=Number(n.and(X("255")));o[i]=a,i--,n=n.shiftRight(8)}if(!n.eq(X.zero))throw new Error("Number does not fit in this length");return o}function s_(e){let t=X.zero;for(let n=0;n<e.length;n++){const i=X(e[n]);t=t.add(i.shiftLeft(n*8))}return t}function c_(e,t){let n=e,i=0;const o=new Uint8Array(t);for(;n.gt(X.zero)&&i<o.length;){let a=Number(n.and(X(255)));o[i]=a,i++,n=n.shiftRight(8)}if(!n.eq(X.zero))throw new Error("Number does not fit in this length");return o}var l_=Object.freeze({__proto__:null,stringifyBigInts:sr,unstringifyBigInts:cr,beBuff2int:a_,beInt2Buff:r_,leBuff2int:s_,leInt2Buff:c_});let bn={};typeof BigInt=="function"?Object.assign(bn,o_):Object.assign(bn,l_);const to=[];for(let e=0;e<256;e++)to[e]=u_(e,8);function u_(e,t){let n=0,i=e;for(let o=0;o<t;o++)n<<=1,n=n|i&1,i>>=1;return n}bn.bitReverse=function(t,n){return(to[t>>>24]|to[t>>>16&255]<<8|to[t>>>8&255]<<16|to[t&255]<<24)>>>32-n},bn.log2=function(t){return((t&4294901760)!=0?(t&=4294901760,16):0)|((t&4278255360)!=0?(t&=4278255360,8):0)|((t&4042322160)!=0?(t&=4042322160,4):0)|((t&3435973836)!=0?(t&=3435973836,2):0)|(t&2863311530)!=0},bn.buffReverseBits=function(t,n){const i=t.byteLength/n,o=bn.log2(i);if(i!=1<<o)throw new Error("Invalid number of pointers");for(let a=0;a<i;a++){const c=bn.bitReverse(a,o);if(a>c){const d=t.slice(a*n,(a+1)*n);t.set(t.slice(c*n,(c+1)*n),a*n),t.set(d,c*n)}}},bn.array2buffer=function(e,t){const n=new Uint8Array(t*e.length);for(let i=0;i<e.length;i++)n.set(e[i],i*t);return n},bn.buffer2array=function(e,t){const n=e.byteLength/t,i=new Array(n);for(let o=0;o<n;o++)i[o]=e.slice(o*t,o*t+t);return i};const Ae=1<<30;class Po{constructor(t){this.buffers=[],this.byteLength=t;for(let n=0;n<t;n+=Ae){const i=Math.min(t-n,Ae);this.buffers.push(new Uint8Array(i))}}slice(t,n){n===void 0&&(n=this.byteLength),t===void 0&&(t=0);const i=n-t,o=Math.floor(t/Ae),a=Math.floor((t+i-1)/Ae);if(o==a||i==0)return this.buffers[o].slice(t%Ae,t%Ae+i);let c,d=o,h=t%Ae,u=i;for(;u>0;){const s=h+u>Ae?Ae-h:u,_=new Uint8Array(this.buffers[d].buffer,this.buffers[d].byteOffset+h,s);if(s==i)return _.slice();c||(i<=Ae?c=new Uint8Array(i):c=new Po(i)),c.set(_,i-u),u=u-s,d++,h=0}return c}set(t,n){n===void 0&&(n=0);const i=t.byteLength;if(i==0)return;const o=Math.floor(n/Ae),a=Math.floor((n+i-1)/Ae);if(o==a)return t instanceof Po&&t.buffers.length==1?this.buffers[o].set(t.buffers[0],n%Ae):this.buffers[o].set(t,n%Ae);let c=o,d=n%Ae,h=i;for(;h>0;){const u=d+h>Ae?Ae-d:h,s=t.slice(i-h,i-h+u);new Uint8Array(this.buffers[c].buffer,this.buffers[c].byteOffset+d,u).set(s),h=h-u,c++,d=0}}}function d_(e){const t=32767;let n,i;e&&(e.onmessage=function(s){let _;if(s.data?_=s.data:_=s,_[0].cmd=="INIT")o(_[0]).then(function(){e.postMessage(_.result)});else if(_[0].cmd=="TERMINATE")e.close();else{const L=u(_);e.postMessage(L)}});async function o(s){const _=new Uint8Array(s.code),L=await WebAssembly.compile(_);i=new WebAssembly.Memory({initial:s.init,maximum:t}),n=await WebAssembly.instantiate(L,{env:{memory:i}})}function a(s){const _=new Uint32Array(i.buffer,0,1);for(;_[0]&3;)_[0]++;const L=_[0];if(_[0]+=s,_[0]+s>i.buffer.byteLength){const g=i.buffer.byteLength/65536;let F=Math.floor((_[0]+s)/65536)+1;F>t&&(F=t),i.grow(F-g)}return L}function c(s){const _=a(s.byteLength);return h(_,s),_}function d(s,_){const L=new Uint8Array(i.buffer);return new Uint8Array(L.buffer,L.byteOffset+s,_)}function h(s,_){new Uint8Array(i.buffer).set(new Uint8Array(_),s)}function u(s){if(s[0].cmd=="INIT")return o(s[0]);const _={vars:[],out:[]},g=new Uint32Array(i.buffer,0,1)[0];for(let T=0;T<s.length;T++)switch(s[T].cmd){case"ALLOCSET":_.vars[s[T].var]=c(s[T].buff);break;case"ALLOC":_.vars[s[T].var]=a(s[T].len);break;case"SET":h(_.vars[s[T].var],s[T].buff);break;case"CALL":{const C=[];for(let U=0;U<s[T].params.length;U++){const x=s[T].params[U];typeof x.var!="undefined"?C.push(_.vars[x.var]+(x.offset||0)):typeof x.val!="undefined"&&C.push(x.val)}n.exports[s[T].fnName](...C);break}case"GET":_.out[s[T].out]=d(_.vars[s[T].var],s[T].len).slice();break;default:throw new Error("Invalid cmd")}const F=new Uint32Array(i.buffer,0,1);return F[0]=g,_.out}return u}var eo={},f_=Object.freeze({__proto__:null,default:eo});function h_(e){return globalThis.btoa(e)}h_("("+d_.toString()+")(self)");var Qe={};const Te=un.exports;function En(e){let t;return typeof e=="string"&&e.slice(0,2).toLowerCase()=="0x"?t=Te(e.slice(2),16):t=Te(e),t}function g_(e){const t=[],n=En(e);return t.push(n.and(255).toJSNumber()),t.push(n.shiftRight(8).and(255).toJSNumber()),t.push(n.shiftRight(16).and(255).toJSNumber()),t.push(n.shiftRight(24).and(255).toJSNumber()),t}function p_(e){const t=[],n=En(e);return t.push(n.and(255).toJSNumber()),t.push(n.shiftRight(8).and(255).toJSNumber()),t.push(n.shiftRight(16).and(255).toJSNumber()),t.push(n.shiftRight(24).and(255).toJSNumber()),t.push(n.shiftRight(32).and(255).toJSNumber()),t.push(n.shiftRight(40).and(255).toJSNumber()),t.push(n.shiftRight(48).and(255).toJSNumber()),t.push(n.shiftRight(56).and(255).toJSNumber()),t}function __(e){for(var t=[],n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|i&63):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|i&63):(n++,i=65536+((i&1023)<<10|e.charCodeAt(n)&1023),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63))}return t}function m_(e){const t=__(e);return[...kl(t.length),...t]}function lr(e){const t=[];let n=En(e);if(n.isNegative())throw new Error("Number cannot be negative");for(;!n.isZero();)t.push(n.and(127).toJSNumber()),n=n.shiftRight(7);t.length==0&&t.push(0);for(let i=0;i<t.length-1;i++)t[i]=t[i]|128;return t}function Dl(e){let t,n;const i=e.bitLength().toJSNumber();e<0?(n=!0,t=Te.one.shiftLeft(i).add(e)):(n=!1,t=En(e));const o=7-i%7,a=Te.one.shiftLeft(o).minus(1).shiftLeft(i),c=(1<<7-o)-1|128,d=lr(t.add(a));return n||(d[d.length-1]=d[d.length-1]&c),d}function L_(e){let t=En(e);if(t.greater(Te("FFFFFFFF",16)))throw new Error("Number too big");if(t.greater(Te("7FFFFFFF",16))&&(t=t.minus(Te("100000000",16))),t.lesser(Te("-80000000",16)))throw new Error("Number too small");return Dl(t)}function y_(e){let t=En(e);if(t.greater(Te("FFFFFFFFFFFFFFFF",16)))throw new Error("Number too big");if(t.greater(Te("7FFFFFFFFFFFFFFF",16))&&(t=t.minus(Te("10000000000000000",16))),t.lesser(Te("-8000000000000000",16)))throw new Error("Number too small");return Dl(t)}function kl(e){let t=En(e);if(t.greater(Te("FFFFFFFF",16)))throw new Error("Number too big");return lr(t)}function A_(e){let t=En(e);if(t.greater(Te("FFFFFFFFFFFFFFFF",16)))throw new Error("Number too big");return lr(t)}function w_(e){return Array.from(e,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}function Ql(e){if(typeof e=="string"){let t=e.split(`
`);for(let n=0;n<t.length;n++)t[n]&&(t[n]="    "+t[n]);return t.join(`
`)}else if(Array.isArray(e)){for(let t=0;t<e.length;t++)e[t]=Ql(e[t]);return e}}Qe.toNumber=En,Qe.u32=g_,Qe.u64=p_,Qe.varuint32=kl,Qe.varuint64=A_,Qe.varint32=L_,Qe.varint64=y_,Qe.string=m_,Qe.toHexString=w_,Qe.ident=Ql;const te=Qe;class I_{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,n){const i=this.func.localIdxByName[t];if(i===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,33,...te.varuint32(i)]}teeLocal(t,n){const i=this.func.localIdxByName[t];if(i===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,34,...te.varuint32(i)]}getLocal(t){const n=this.func.localIdxByName[t];if(n===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...te.varuint32(n)]}i64_load8_s(t,n,i){const o=n||0,a=i===void 0?0:i;return[...t,48,a,...te.varuint32(o)]}i64_load8_u(t,n,i){const o=n||0,a=i===void 0?0:i;return[...t,49,a,...te.varuint32(o)]}i64_load16_s(t,n,i){const o=n||0,a=i===void 0?1:i;return[...t,50,a,...te.varuint32(o)]}i64_load16_u(t,n,i){const o=n||0,a=i===void 0?1:i;return[...t,51,a,...te.varuint32(o)]}i64_load32_s(t,n,i){const o=n||0,a=i===void 0?2:i;return[...t,52,a,...te.varuint32(o)]}i64_load32_u(t,n,i){const o=n||0,a=i===void 0?2:i;return[...t,53,a,...te.varuint32(o)]}i64_load(t,n,i){const o=n||0,a=i===void 0?3:i;return[...t,41,a,...te.varuint32(o)]}i64_store(t,n,i,o){let a,c,d;return Array.isArray(n)?(a=0,c=3,d=n):Array.isArray(i)?(a=n,c=3,d=i):Array.isArray(o)&&(a=n,c=i,d=o),[...t,...d,55,c,...te.varuint32(a)]}i64_store32(t,n,i,o){let a,c,d;return Array.isArray(n)?(a=0,c=2,d=n):Array.isArray(i)?(a=n,c=2,d=i):Array.isArray(o)&&(a=n,c=i,d=o),[...t,...d,62,c,...te.varuint32(a)]}i64_store16(t,n,i,o){let a,c,d;return Array.isArray(n)?(a=0,c=1,d=n):Array.isArray(i)?(a=n,c=1,d=i):Array.isArray(o)&&(a=n,c=i,d=o),[...t,...d,61,c,...te.varuint32(a)]}i64_store8(t,n,i,o){let a,c,d;return Array.isArray(n)?(a=0,c=0,d=n):Array.isArray(i)?(a=n,c=0,d=i):Array.isArray(o)&&(a=n,c=i,d=o),[...t,...d,60,c,...te.varuint32(a)]}i32_load8_s(t,n,i){const o=n||0,a=i===void 0?0:i;return[...t,44,a,...te.varuint32(o)]}i32_load8_u(t,n,i){const o=n||0,a=i===void 0?0:i;return[...t,45,a,...te.varuint32(o)]}i32_load16_s(t,n,i){const o=n||0,a=i===void 0?1:i;return[...t,46,a,...te.varuint32(o)]}i32_load16_u(t,n,i){const o=n||0,a=i===void 0?1:i;return[...t,47,a,...te.varuint32(o)]}i32_load(t,n,i){const o=n||0,a=i===void 0?2:i;return[...t,40,a,...te.varuint32(o)]}i32_store(t,n,i,o){let a,c,d;return Array.isArray(n)?(a=0,c=2,d=n):Array.isArray(i)?(a=n,c=2,d=i):Array.isArray(o)&&(a=n,c=i,d=o),[...t,...d,54,c,...te.varuint32(a)]}i32_store16(t,n,i,o){let a,c,d;return Array.isArray(n)?(a=0,c=1,d=n):Array.isArray(i)?(a=n,c=1,d=i):Array.isArray(o)&&(a=n,c=i,d=o),[...t,...d,59,c,...te.varuint32(a)]}i32_store8(t,n,i,o){let a,c,d;return Array.isArray(n)?(a=0,c=0,d=n):Array.isArray(i)?(a=n,c=0,d=i):Array.isArray(o)&&(a=n,c=i,d=o),[...t,...d,58,c,...te.varuint32(a)]}call(t,...n){const i=this.module.functionIdxByName[t];if(i===void 0)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...n),16,...te.varuint32(i)]}call_indirect(t,...n){return[...[].concat(...n),...t,17,0,0]}if(t,n,i){return i?[...t,4,64,...n,5,...i,11]:[...t,4,64,...n,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,n){return[...n,13,...te.varuint32(t)]}br(t){return[12,...te.varuint32(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...te.varint64(t)]}i32_const(t){return[65,...te.varint32(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,n){return[...t,...n,81]}i64_ne(t,n){return[...t,...n,82]}i64_lt_s(t,n){return[...t,...n,83]}i64_lt_u(t,n){return[...t,...n,84]}i64_gt_s(t,n){return[...t,...n,85]}i64_gt_u(t,n){return[...t,...n,86]}i64_le_s(t,n){return[...t,...n,87]}i64_le_u(t,n){return[...t,...n,88]}i64_ge_s(t,n){return[...t,...n,89]}i64_ge_u(t,n){return[...t,...n,90]}i64_add(t,n){return[...t,...n,124]}i64_sub(t,n){return[...t,...n,125]}i64_mul(t,n){return[...t,...n,126]}i64_div_s(t,n){return[...t,...n,127]}i64_div_u(t,n){return[...t,...n,128]}i64_rem_s(t,n){return[...t,...n,129]}i64_rem_u(t,n){return[...t,...n,130]}i64_and(t,n){return[...t,...n,131]}i64_or(t,n){return[...t,...n,132]}i64_xor(t,n){return[...t,...n,133]}i64_shl(t,n){return[...t,...n,134]}i64_shr_s(t,n){return[...t,...n,135]}i64_shr_u(t,n){return[...t,...n,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,n){return[...t,...n,70]}i32_ne(t,n){return[...t,...n,71]}i32_lt_s(t,n){return[...t,...n,72]}i32_lt_u(t,n){return[...t,...n,73]}i32_gt_s(t,n){return[...t,...n,74]}i32_gt_u(t,n){return[...t,...n,75]}i32_le_s(t,n){return[...t,...n,76]}i32_le_u(t,n){return[...t,...n,77]}i32_ge_s(t,n){return[...t,...n,78]}i32_ge_u(t,n){return[...t,...n,79]}i32_add(t,n){return[...t,...n,106]}i32_sub(t,n){return[...t,...n,107]}i32_mul(t,n){return[...t,...n,108]}i32_div_s(t,n){return[...t,...n,109]}i32_div_u(t,n){return[...t,...n,110]}i32_rem_s(t,n){return[...t,...n,111]}i32_rem_u(t,n){return[...t,...n,112]}i32_and(t,n){return[...t,...n,113]}i32_or(t,n){return[...t,...n,114]}i32_xor(t,n){return[...t,...n,115]}i32_shl(t,n){return[...t,...n,116]}i32_shr_s(t,n){return[...t,...n,117]}i32_shr_u(t,n){return[...t,...n,118]}i32_rotl(t,n){return[...t,...n,119]}i32_rotr(t,n){return[...t,...n,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}var b_=I_;const E_=b_,Ro=Qe,ur={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class C_{constructor(t,n,i,o,a){if(i=="import")this.fnType="import",this.moduleName=o,this.fieldName=a;else if(i=="internal")this.fnType="internal";else throw new Error("Invalid function fnType: "+i);this.module=t,this.fnName=n,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,n){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);const i=this.nextLocal++;this.localIdxByName[t]=i,this.params.push({type:n})}addLocal(t,n,i){const o=i||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);const a=this.nextLocal++;this.localIdxByName[t]=a,this.locals.push({type:n,length:o})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){const t=[...Ro.varuint32(this.params.length),...this.params.map(i=>ur[i.type])],n=this.returnType?[1,ur[this.returnType]]:[0];return[96,...t,...n]}getBody(){const t=this.locals.map(i=>[...Ro.varuint32(i.length),ur[i.type]]),n=[...Ro.varuint32(this.locals.length),...[].concat(...t),...this.code,11];return[...Ro.varuint32(n.length),...n]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new E_(this)}}var v_=C_;const Wl=v_,Jt=Qe;class F_{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Jt.u32(1836278016),...Jt.u32(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(typeof this.functionIdxByName[t]!="undefined")throw new Error(`Function already defined: ${t}`);const n=this.functions.length;return this.functionIdxByName[t]=n,this.functions.push(new Wl(this,t,"internal")),this.nInternalFunctions++,this.functions[n]}addIimportFunction(t,n,i){if(typeof this.functionIdxByName[t]!="undefined")throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&this.functions[this.functions.length-1].type=="internal")throw new Error(`Import functions must be declared before internal: ${t}`);let o=i||t;const a=this.functions.length;return this.functionIdxByName[t]=a,this.functions.push(new Wl(this,t,"import",n,o)),this.nImportFunctions++,this.functions[a]}setMemory(t,n,i){this.memory={pagesSize:t,moduleName:n||"env",fieldName:i||"memory"}}exportFunction(t,n){const i=n||t;if(typeof this.functionIdxByName[t]=="undefined")throw new Error(`Function not defined: ${t}`);const o=this.functionIdxByName[t];i!=t&&(this.functionIdxByName[i]=o),this.exports.push({exportName:i,idx:o})}addFunctionToTable(t){const n=this.functionIdxByName[t];this.functionsTable.push(n)}addData(t,n){this.datas.push({offset:t,bytes:n})}alloc(t,n){let i,o;(Array.isArray(t)||ArrayBuffer.isView(t))&&typeof n=="undefined"?(i=t.length,o=t):(i=t,o=n),i=(i-1>>3)+1<<3;const a=this.free;return this.free+=i,o&&this.addData(a,o),a}allocString(t){const i=new globalThis.TextEncoder().encode(t);return this.alloc([...i,0])}_setSignatures(){this.signatures=[];const t={};if(this.functionsTable.length>0){const n=this.functions[this.functionsTable[0]].getSignature(),i="s_"+Jt.toHexString(n);t[i]=0,this.signatures.push(n)}for(let n=0;n<this.functions.length;n++){const i=this.functions[n].getSignature(),o="s_"+Jt.toHexString(i);typeof t[o]=="undefined"&&(t[o]=this.signatures.length,this.signatures.push(i)),this.functions[n].signatureIdx=t[o]}}_buildSection(t,n){return[t,...Jt.varuint32(n.length),...n]}_buildType(){return this._buildSection(1,[...Jt.varuint32(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const t=[];t.push([...Jt.string(this.memory.moduleName),...Jt.string(this.memory.fieldName),2,0,...Jt.varuint32(this.memory.pagesSize)]);for(let n=0;n<this.nImportFunctions;n++)t.push([...Jt.string(this.functions[n].moduleName),...Jt.string(this.functions[n].fieldName),0,...Jt.varuint32(this.functions[n].signatureIdx)]);return this._buildSection(2,Jt.varuint32(t.length).concat(...t))}_buildFunctionDeclarations(){const t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(...Jt.varuint32(this.functions[n].signatureIdx));return this._buildSection(3,[...Jt.varuint32(t.length),...t])}_buildFunctionsTable(){return this.functionsTable.length==0?[]:this._buildSection(4,[...Jt.varuint32(1),112,0,...Jt.varuint32(this.functionsTable.length)])}_buildElements(){if(this.functionsTable.length==0)return[];const t=[];for(let n=0;n<this.functionsTable.length;n++)t.push(...Jt.varuint32(this.functionsTable[n]));return this._buildSection(9,[...Jt.varuint32(1),...Jt.varuint32(0),65,...Jt.varint32(0),11,...Jt.varuint32(this.functionsTable.length),...t])}_buildExports(){const t=[];for(let n=0;n<this.exports.length;n++)t.push([...Jt.string(this.exports[n].exportName),0,...Jt.varuint32(this.exports[n].idx)]);return this._buildSection(7,Jt.varuint32(t.length).concat(...t))}_buildCode(){const t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(this.functions[n].getBody());return this._buildSection(10,Jt.varuint32(t.length).concat(...t))}_buildData(){const t=[];t.push([0,65,0,11,4,...Jt.u32(this.free)]);for(let n=0;n<this.datas.length;n++)t.push([0,65,...Jt.varint32(this.datas[n].offset),11,...Jt.varuint32(this.datas[n].bytes.length),...this.datas[n].bytes]);return this._buildSection(11,Jt.varuint32(t.length).concat(...t))}}var S_=F_,Uo=S_;globalThis.curve_bn128=null,globalThis.curve_bls12381=null,Yi("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),Yi("21888242871839275222246405745257275088548364400416034343698204186575808495617"),Yi("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),Yi("21888242871839275222246405745257275088696311157297823662689037894645226208583");const $l=Ip;async function Hl(e,t,n,i){if(n=n||4096*64,["w+","wx+","r","ax+","a+"].indexOf(t)<0)throw new Error("Invalid open option");const o=await eo.promises.open(e,t),a=await o.stat();return new B_(o,a,n,i,e)}class B_{constructor(t,n,i,o,a){for(this.fileName=a,this.fd=t,this.pos=0,this.pageSize=o||1<<8;this.pageSize<n.blksize;)this.pageSize*=2;this.totalSize=n.size,this.totalPages=Math.floor((n.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(i/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){const n=this,i=new Promise((o,a)=>{n.pendingLoads.push({page:t,resolve:o,reject:a})});return n.__statusPage("After Load request: ",t),i}__statusPage(t,n){const i=[],o=this;if(!o.logHistory)return;i.push("=="+t+" "+n);let a="";for(let c=0;c<o.pendingLoads.length;c++)o.pendingLoads[c].page==n&&(a=a+" "+c);if(a&&i.push("Pending loads:"+a),typeof o.pages[n]!="undefined"){const c=o.pages[n];i.push("Loaded"),i.push("pendingOps: "+c.pendingOps),c.loading&&i.push("loading: "+c.loading),c.writing&&i.push("writing"),c.dirty&&i.push("dirty")}i.push("=="),o.history[n]||(o.history[n]=[]),o.history[n].push(i)}__printHistory(t){const n=this;n.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let i=0;i<n.history[t].length;i++)for(let o=0;o<n.history[t][i].length;o++)console.log("-> "+n.history[t][i][o])}_triggerLoad(){const t=this;if(t.reading||t.pendingLoads.length==0)return;const n=Object.keys(t.pages),i=[];for(let d=0;d<n.length;d++){const h=t.pages[parseInt(n[d])];h.dirty==!1&&h.pendingOps==0&&!h.writing&&!h.loading&&i.push(parseInt(n[d]))}let o=t.maxPagesLoaded-n.length;const a=[];for(;t.pendingLoads.length>0&&(typeof t.pages[t.pendingLoads[0].page]!="undefined"||o>0||i.length>0);){const d=t.pendingLoads.shift();if(typeof t.pages[d.page]!="undefined"){t.pages[d.page].pendingOps++;const h=i.indexOf(d.page);h>=0&&i.splice(h,1),t.pages[d.page].loading?t.pages[d.page].loading.push(d):d.resolve(),t.__statusPage("After Load (cached): ",d.page)}else{if(o)o--;else{const h=i.shift();t.__statusPage("Before Unload: ",h),t.avBuffs.unshift(t.pages[h]),delete t.pages[h],t.__statusPage("After Unload: ",h)}d.page>=t.totalPages?(t.pages[d.page]=c(),d.resolve(),t.__statusPage("After Load (new): ",d.page)):(t.reading=!0,t.pages[d.page]=c(),t.pages[d.page].loading=[d],a.push(t.fd.read(t.pages[d.page].buff,0,t.pageSize,d.page*t.pageSize).then(h=>{t.pages[d.page].size=h.bytesRead;const u=t.pages[d.page].loading;delete t.pages[d.page].loading;for(let s=0;s<u.length;s++)u[s].resolve();return t.__statusPage("After Load (loaded): ",d.page),h},h=>{d.reject(h)})),t.__statusPage("After Load (loading): ",d.page))}}Promise.all(a).then(()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()});function c(){if(t.avBuffs.length>0){const d=t.avBuffs.shift();return d.dirty=!1,d.pendingOps=1,d.size=0,d}else return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}}_triggerWrite(){const t=this;if(t.writing)return;const n=Object.keys(t.pages),i=[];for(let o=0;o<n.length;o++){const a=t.pages[parseInt(n[o])];a.dirty&&(a.dirty=!1,a.writing=!0,t.writing=!0,i.push(t.fd.write(a.buff,0,a.size,parseInt(n[o])*t.pageSize).then(()=>{a.writing=!1},c=>{console.log("ERROR Writing: "+c),t.error=c,t._tryClose()})))}t.writing&&Promise.all(i).then(()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))})}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,n){if(t.byteLength==0)return;const i=this;if(typeof n=="undefined"&&(n=i.pos),i.pos=n+t.byteLength,i.totalSize<n+t.byteLength&&(i.totalSize=n+t.byteLength),i.pendingClose)throw new Error("Writing a closing file");const o=Math.floor(n/i.pageSize),a=Math.floor((n+t.byteLength-1)/i.pageSize),c=[];for(let s=o;s<=a;s++)c.push(i._loadPage(s));i._triggerLoad();let d=o,h=n%i.pageSize,u=t.byteLength;for(;u>0;){await c[d-o];const s=h+u>i.pageSize?i.pageSize-h:u,_=t.slice(t.byteLength-u,t.byteLength-u+s);new Uint8Array(i.pages[d].buff.buffer,h,s).set(_),i.pages[d].dirty=!0,i.pages[d].pendingOps--,i.pages[d].size=Math.max(h+s,i.pages[d].size),d>=i.totalPages&&(i.totalPages=d+1),u=u-s,d++,h=0,i.writing||setImmediate(i._triggerWrite.bind(i))}}async read(t,n){const i=this;let o=new Uint8Array(t);return await i.readToBuffer(o,0,t,n),o}async readToBuffer(t,n,i,o){if(i==0)return;const a=this;if(i>a.pageSize*a.maxPagesLoaded*.8){const L=Math.floor(i*1.1);this.maxPagesLoaded=Math.floor(L/a.pageSize)+1}if(typeof o=="undefined"&&(o=a.pos),a.pos=o+i,a.pendingClose)throw new Error("Reading a closing file");const c=Math.floor(o/a.pageSize),d=Math.floor((o+i-1)/a.pageSize),h=[];for(let L=c;L<=d;L++)h.push(a._loadPage(L));a._triggerLoad();let u=c,s=o%a.pageSize,_=o+i>a.totalSize?i-(o+i-a.totalSize):i;for(;_>0;){await h[u-c],a.__statusPage("After Await (read): ",u);const L=s+_>a.pageSize?a.pageSize-s:_,g=new Uint8Array(a.pages[u].buff.buffer,a.pages[u].buff.byteOffset+s,L);t.set(g,n+i-_),a.pages[u].pendingOps--,a.__statusPage("After Op done: ",u),_=_-L,u++,s=0,a.pendingLoads.length>0&&setImmediate(a._triggerLoad.bind(a))}this.pos=o+i}_tryClose(){const t=this;!t.pendingClose||(t.error&&t.pendingCloseReject(t.error),t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0)||t.pendingClose()}close(){const t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise((n,i)=>{t.pendingClose=n,t.pendingCloseReject=i,t._tryClose()}).then(()=>{t.fd.close()},n=>{throw t.fd.close(),n})}async discard(){await this.close(),await eo.promises.unlink(this.fileName)}async writeULE32(t,n){const i=this,o=new Uint8Array(4);new DataView(o.buffer).setUint32(0,t,!0),await i.write(o,n)}async writeUBE32(t,n){const i=this,o=new Uint8Array(4);new DataView(o.buffer).setUint32(0,t,!1),await i.write(o,n)}async writeULE64(t,n){const i=this,o=new Uint8Array(8),a=new DataView(o.buffer);a.setUint32(0,t&4294967295,!0),a.setUint32(4,Math.floor(t/4294967296),!0),await i.write(o,n)}async readULE32(t){const i=await this.read(4,t);return new Uint32Array(i.buffer)[0]}async readUBE32(t){const i=await this.read(4,t);return new DataView(i.buffer).getUint32(0,!1)}async readULE64(t){const i=await this.read(8,t),o=new Uint32Array(i.buffer);return o[1]*4294967296+o[0]}}function x_(e){const t=e.initialSize||1<<20,n=new Yl;return n.o=e,n.o.data=new Uint8Array(t),n.allocSize=t,n.totalSize=0,n.readOnly=!1,n.pos=0,n}function O_(e){const t=new Yl;return t.o=e,t.allocSize=e.data.byteLength,t.totalSize=e.data.byteLength,t.readOnly=!0,t.pos=0,t}const dr=new Uint8Array(4),jl=new DataView(dr.buffer),Vl=new Uint8Array(8),Kl=new DataView(Vl.buffer);class Yl{constructor(){this.pageSize=1<<14}_resizeIfNeeded(t){if(t>this.allocSize){const n=Math.max(this.allocSize+(1<<20),Math.floor(this.allocSize*1.1),t),i=new Uint8Array(n);i.set(this.o.data),this.o.data=i,this.allocSize=n}}async write(t,n){if(typeof n=="undefined"&&(n=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(n+t.byteLength),this.o.data.set(t.slice(),n),n+t.byteLength>this.totalSize&&(this.totalSize=n+t.byteLength),this.pos=n+t.byteLength}async readToBuffer(t,n,i,o){if(typeof o=="undefined"&&(o=this.pos),this.readOnly&&o+i>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(o+i);const c=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+o,i);t.set(c,n),this.pos=o+i}async read(t,n){const i=this,o=new Uint8Array(t);return await i.readToBuffer(o,0,t,n),o}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,n){const i=this;jl.setUint32(0,t,!0),await i.write(dr,n)}async writeUBE32(t,n){const i=this;jl.setUint32(0,t,!1),await i.write(dr,n)}async writeULE64(t,n){const i=this;Kl.setUint32(0,t&4294967295,!0),Kl.setUint32(4,Math.floor(t/4294967296),!0),await i.write(Vl,n)}async readULE32(t){const i=await this.read(4,t);return new Uint32Array(i.buffer)[0]}async readUBE32(t){const i=await this.read(4,t);return new DataView(i.buffer).getUint32(0,!1)}async readULE64(t){const i=await this.read(8,t),o=new Uint32Array(i.buffer);return o[1]*4294967296+o[0]}}const Pe=1<<22;function T_(e){const t=e.initialSize||0,n=new tu;n.o=e;const i=t?Math.floor((t-1)/Pe)+1:0;n.o.data=[];for(let o=0;o<i-1;o++)n.o.data.push(new Uint8Array(Pe));return i&&n.o.data.push(new Uint8Array(t-Pe*(i-1))),n.totalSize=0,n.readOnly=!1,n.pos=0,n}function P_(e){const t=new tu;return t.o=e,t.totalSize=(e.data.length-1)*Pe+e.data[e.data.length-1].byteLength,t.readOnly=!0,t.pos=0,t}const fr=new Uint8Array(4),Zl=new DataView(fr.buffer),Jl=new Uint8Array(8),Xl=new DataView(Jl.buffer);class tu{constructor(){this.pageSize=1<<14}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const n=Math.floor((t-1)/Pe)+1;for(let i=Math.max(this.o.data.length-1,0);i<n;i++){const o=i<n-1?Pe:t-(n-1)*Pe,a=new Uint8Array(o);i==this.o.data.length-1&&a.set(this.o.data[i]),this.o.data[i]=a}this.totalSize=t}async write(t,n){const i=this;if(typeof n=="undefined"&&(n=i.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(n+t.byteLength);let a=Math.floor(n/Pe),c=n%Pe,d=t.byteLength;for(;d>0;){const h=c+d>Pe?Pe-c:d,u=t.slice(t.byteLength-d,t.byteLength-d+h);new Uint8Array(i.o.data[a].buffer,c,h).set(u),d=d-h,a++,c=0}this.pos=n+t.byteLength}async readToBuffer(t,n,i,o){const a=this;if(typeof o=="undefined"&&(o=a.pos),this.readOnly&&o+i>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(o+i);let d=Math.floor(o/Pe),h=o%Pe,u=i;for(;u>0;){const s=h+u>Pe?Pe-h:u,_=new Uint8Array(a.o.data[d].buffer,h,s);t.set(_,n+i-u),u=u-s,d++,h=0}this.pos=o+i}async read(t,n){const i=this,o=new Uint8Array(t);return await i.readToBuffer(o,0,t,n),o}close(){}async discard(){}async writeULE32(t,n){const i=this;Zl.setUint32(0,t,!0),await i.write(fr,n)}async writeUBE32(t,n){const i=this;Zl.setUint32(0,t,!1),await i.write(fr,n)}async writeULE64(t,n){const i=this;Xl.setUint32(0,t&4294967295,!0),Xl.setUint32(4,Math.floor(t/4294967296),!0),await i.write(Jl,n)}async readULE32(t){const i=await this.read(4,t);return new Uint32Array(i.buffer)[0]}async readUBE32(t){const i=await this.read(4,t);return new DataView(i.buffer).getUint32(0,!1)}async readULE64(t){const i=await this.read(8,t),o=new Uint32Array(i.buffer);return o[1]*4294967296+o[0]}}const R_=1<<16,U_=1<<13;async function M_(e,t,n){if(typeof e=="string"&&(e={type:"file",fileName:e,cacheSize:t||R_,pageSize:n||U_}),e.type=="file")return await Hl(e.fileName,"w+",e.cacheSize,e.pageSize);if(e.type=="mem")return x_(e);if(e.type=="bigMem")return T_(e);throw new Error("Invalid FastFile type: "+e.type)}async function G_(e,t,n){if(e instanceof Uint8Array&&(e={type:"mem",data:e}),typeof e=="string"){const i=await fetch(e).then(function(o){return o.arrayBuffer()}).then(function(o){return new Uint8Array(o)});e={type:"mem",data:i}}if(e.type=="file")return await Hl(e.fileName,"r",e.cacheSize,e.pageSize);if(e.type=="mem")return await O_(e);if(e.type=="bigMem")return await P_(e);throw new Error("Invalid FastFile type: "+e.type)}async function We(e,t,n,i,o){const a=await G_(e),c=await a.read(4);let d="";for(let _=0;_<4;_++)d+=String.fromCharCode(c[_]);if(d!=t)throw new Error(e+": Invalid File format");if(await a.readULE32()>n)throw new Error("Version not supported");const u=await a.readULE32();let s=[];for(let _=0;_<u;_++){let L=await a.readULE32(),g=await a.readULE64();typeof s[L]=="undefined"&&(s[L]=[]),s[L].push({p:a.pos,size:g}),a.pos+=g}return{fd:a,sections:s}}async function hr(e,t,n,i,o,a){const c=await M_(e,o,a),d=new Uint8Array(4);for(let h=0;h<4;h++)d[h]=t.charCodeAt(h);return await c.write(d,0),await c.writeULE32(n),await c.writeULE32(i),c}async function fe(e,t){if(typeof e.writingSection!="undefined")throw new Error("Already writing a section");await e.writeULE32(t),e.writingSection={pSectionSize:e.pos},await e.writeULE64(0)}async function he(e){if(typeof e.writingSection=="undefined")throw new Error("Not writing a section");const t=e.pos-e.writingSection.pSectionSize-8,n=e.pos;e.pos=e.writingSection.pSectionSize,await e.writeULE64(t),e.pos=n,delete e.writingSection}async function Ne(e,t,n){if(typeof e.readingSection!="undefined")throw new Error("Already reading a section");if(!t[n])throw new Error(e.fileName+": Missing section "+n);if(t[n].length>1)throw new Error(e.fileName+": Section Duplicated "+n);e.pos=t[n][0].p,e.readingSection=t[n][0]}async function qe(e,t){if(typeof e.readingSection=="undefined")throw new Error("Not reading a section");if(!t&&e.pos-e.readingSection.p!=e.readingSection.size)throw new Error("Invalid section size reading");delete e.readingSection}async function bi(e,t,n,i){const o=new Uint8Array(n);$l.toRprLE(o,0,t,n),await e.write(o,i)}async function Ei(e,t,n){const i=await e.read(t,n);return $l.fromRprLE(i,0,t)}async function no(e,t,n,i,o){typeof o=="undefined"&&(o=t[i][0].size);const a=e.pageSize;await Ne(e,t,i),await fe(n,i);for(let c=0;c<o;c+=a){const d=Math.min(o-c,a),h=await e.read(d);await n.write(h)}await he(n),await qe(e,o!=t[i][0].size)}async function Cn(e,t,n,i,o){if(i=typeof i=="undefined"?0:i,o=typeof o=="undefined"?t[n][0].size-i:o,i+o>t[n][0].size)throw new Error("Reading out of the range of the section");let a;return o<1<<30?a=new Uint8Array(o):a=new Po(o),await e.readToBuffer(a,0,o,t[n][0].p+i),a}async function io(e,t,n,i,o){const a=e.pageSize*16;if(await Ne(e,t,o),await Ne(n,i,o),t[o][0].size!=i[o][0].size)return!1;const c=t[o][0].size;for(let d=0;d<c;d+=a){const h=Math.min(c-d,a),u=await e.read(h),s=await n.read(h);for(let _=0;_<h;_++)if(u[_]!=s[_])return!1}return await qe(e),await qe(n),!0}const N_=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function eu(e,t){if(!t||t==10)return BigInt(e);if(t==16)return e.slice(0,2)=="0x"?BigInt(e):BigInt("0x"+e)}const q_=eu;function z_(e,t){let n=BigInt(0);t=BigInt(t);for(let i=0;i<e.length;i++)n=n*t+BigInt(e[i]);return n}function D_(e){const t=e.toString(16);return(t.length-1)*4+N_[parseInt(t[0],16)]}function k_(e){return BigInt(e)<BigInt(0)}function Q_(e){return!e}function nu(e,t){return BigInt(e)<<BigInt(t)}function iu(e,t){return BigInt(e)>>BigInt(t)}const W_=nu,$_=iu;function H_(e){return(BigInt(e)&BigInt(1))==BigInt(1)}function j_(e){let t=BigInt(e);const n=[];for(;t;){if(t&BigInt(1)){const i=2-Number(t%BigInt(4));n.push(i),t=t-BigInt(i)}else n.push(0);t=t>>BigInt(1)}return n}function V_(e){let t=BigInt(e);const n=[];for(;t;)t&BigInt(1)?n.push(1):n.push(0),t=t>>BigInt(1);return n}function K_(e){if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(e)}function Y_(e,t){const n=[];let i=BigInt(e);for(t=BigInt(t);i;)n.unshift(Number(i%t)),i=i/t;return n}function Z_(e,t){return BigInt(e)+BigInt(t)}function J_(e,t){return BigInt(e)-BigInt(t)}function X_(e){return-BigInt(e)}function t0(e,t){return BigInt(e)*BigInt(t)}function e0(e){return BigInt(e)*BigInt(e)}function n0(e,t){return BigInt(e)**BigInt(t)}function i0(e,t){return BigInt(e)**BigInt(t)}function o0(e){return BigInt(e)>=0?BigInt(e):-BigInt(e)}function a0(e,t){return BigInt(e)/BigInt(t)}function r0(e,t){return BigInt(e)%BigInt(t)}function s0(e,t){return BigInt(e)==BigInt(t)}function c0(e,t){return BigInt(e)!=BigInt(t)}function l0(e,t){return BigInt(e)<BigInt(t)}function u0(e,t){return BigInt(e)>BigInt(t)}function d0(e,t){return BigInt(e)<=BigInt(t)}function f0(e,t){return BigInt(e)>=BigInt(t)}function h0(e,t){return BigInt(e)&BigInt(t)}function g0(e,t){return BigInt(e)|BigInt(t)}function p0(e,t){return BigInt(e)^BigInt(t)}function _0(e,t){return BigInt(e)&&BigInt(t)}function m0(e,t){return BigInt(e)||BigInt(t)}function L0(e){return!BigInt(e)}var y0=Object.freeze({__proto__:null,fromString:eu,e:q_,fromArray:z_,bitLength:D_,isNegative:k_,isZero:Q_,shiftLeft:nu,shiftRight:iu,shl:W_,shr:$_,isOdd:H_,naf:j_,bits:V_,toNumber:K_,toArray:Y_,add:Z_,sub:J_,neg:X_,mul:t0,square:e0,pow:n0,exp:i0,abs:o0,div:a0,mod:r0,eq:s0,neq:c0,lt:l0,gt:u0,leq:d0,geq:f0,band:h0,bor:g0,bxor:p0,land:_0,lor:m0,lnot:L0});function ou(e,t){return typeof e=="string"&&e.slice(0,2)=="0x"?X(e.slice(2),16):X(e,t)}const A0=ou;function w0(e,t){return X.fromArray(e,t)}function I0(e){return X(e).bitLength()}function b0(e){return X(e).isNegative()}function E0(e){return X(e).isZero()}function au(e,t){return X(e).shiftLeft(t)}function ru(e,t){return X(e).shiftRight(t)}const C0=au,v0=ru;function F0(e){return X(e).isOdd()}function S0(e){let t=X(e);const n=[];for(;t.gt(X.zero);){if(t.isOdd()){const i=2-t.mod(4).toJSNumber();n.push(i),t=t.minus(i)}else n.push(0);t=t.shiftRight(1)}return n}function B0(e){let t=X(e);const n=[];for(;t.gt(X.zero);)t.isOdd()?n.push(1):n.push(0),t=t.shiftRight(1);return n}function x0(e){if(!e.lt(X("9007199254740992",10)))throw new Error("Number too big");return e.toJSNumber()}function O0(e,t){return X(e).toArray(t)}function T0(e,t){return X(e).add(X(t))}function P0(e,t){return X(e).minus(X(t))}function R0(e){return X.zero.minus(X(e))}function U0(e,t){return X(e).times(X(t))}function M0(e){return X(e).square()}function G0(e,t){return X(e).pow(X(t))}function N0(e,t){return X(e).pow(X(t))}function q0(e){return X(e).abs()}function z0(e,t){return X(e).divide(X(t))}function D0(e,t){return X(e).mod(X(t))}function k0(e,t){return X(e).eq(X(t))}function Q0(e,t){return X(e).neq(X(t))}function W0(e,t){return X(e).lt(X(t))}function $0(e,t){return X(e).gt(X(t))}function H0(e,t){return X(e).leq(X(t))}function j0(e,t){return X(e).geq(X(t))}function V0(e,t){return X(e).and(X(t))}function K0(e,t){return X(e).or(X(t))}function Y0(e,t){return X(e).xor(X(t))}function Z0(e,t){return!X(e).isZero()&&!X(t).isZero()}function J0(e,t){return!X(e).isZero()||!X(t).isZero()}function X0(e){return X(e).isZero()}var t1=Object.freeze({__proto__:null,fromString:ou,e:A0,fromArray:w0,bitLength:I0,isNegative:b0,isZero:E0,shiftLeft:au,shiftRight:ru,shl:C0,shr:v0,isOdd:F0,naf:S0,bits:B0,toNumber:x0,toArray:O0,add:T0,sub:P0,neg:R0,mul:U0,square:M0,pow:G0,exp:N0,abs:q0,div:z0,mod:D0,eq:k0,neq:Q0,lt:W0,gt:$0,leq:H0,geq:j0,band:V0,bor:K0,bxor:Y0,land:Z0,lor:J0,lnot:X0});const e1=typeof BigInt=="function";let ue={};e1?Object.assign(ue,y0):Object.assign(ue,t1),ue.toRprLE=function(t,n,i,o){const a="0000000"+i.toString(16),c=new Uint32Array(t.buffer,n,o/4),d=((a.length-7)*4-1>>5)+1;for(let h=0;h<d;h++)c[h]=parseInt(a.substring(a.length-8*h-8,a.length-8*h),16);for(let h=d;h<c.length;h++)c[h]=0;for(let h=c.length*4;h<o;h++)t[h]=ue.toNumber(ue.band(ue.shiftRight(i,h*8),255))},ue.toRprBE=function(t,n,i,o){const a="0000000"+i.toString(16),c=new DataView(t.buffer,t.byteOffset+n,o),d=((a.length-7)*4-1>>5)+1;for(let h=0;h<d;h++)c.setUint32(o-h*4-4,parseInt(a.substring(a.length-8*h-8,a.length-8*h),16),!1);for(let h=0;h<o/4-d;h++)c[h]=0},ue.fromRprLE=function(t,n,i){i=i||t.byteLength,n=n||0;const o=new Uint32Array(t.buffer,n,i/4),a=new Array(i/4);return o.forEach((c,d)=>a[a.length-d-1]=c.toString(16).padStart(8,"0")),ue.fromString(a.join(""),16)},ue.fromRprBE=function(t,n,i){i=i||t.byteLength,n=n||0;const o=new DataView(t.buffer,t.byteOffset+n,i),a=new Array(i/4);for(let c=0;c<i/4;c++)a[c]=o.getUint32(c*4,!1).toString(16).padStart(8,"0");return ue.fromString(a.join(""),16)},ue.toString=function(t,n){return t.toString(n)},ue.toLEBuff=function(t){const n=new Uint8Array(Math.floor((ue.bitLength(t)-1)/8)+1);return ue.toRprLE(n,0,t,n.byteLength),n},ue.zero=ue.e(0),ue.one=ue.e(1);let{toRprLE:gr,toRprBE:n1,fromRprLE:Mo,fromRprBE:i1,toString:pr,toLEBuff:Ci,zero:su,one:Xn,fromString:o1,e:ge,fromArray:a1,bitLength:_r,isNegative:cu,isZero:r1,shiftLeft:mr,shiftRight:Go,shl:s1,shr:c1,isOdd:lu,naf:l1,bits:u1,toNumber:d1,toArray:f1,add:Lr,sub:No,neg:uu,mul:du,square:h1,pow:g1,exp:p1,abs:_1,div:m1,mod:yr,eq:Ar,neq:L1,lt:y1,gt:wr,leq:A1,geq:fu,band:hu,bor:w1,bxor:I1,land:b1,lor:E1,lnot:C1}=ue;var v1=Object.freeze({__proto__:null,toRprLE:gr,toRprBE:n1,fromRprLE:Mo,fromRprBE:i1,toString:pr,toLEBuff:Ci,zero:su,one:Xn,fromString:o1,e:ge,fromArray:a1,bitLength:_r,isNegative:cu,isZero:r1,shiftLeft:mr,shiftRight:Go,shl:s1,shr:c1,isOdd:lu,naf:l1,bits:u1,toNumber:d1,toArray:f1,add:Lr,sub:No,neg:uu,mul:du,square:h1,pow:g1,exp:p1,abs:_1,div:m1,mod:yr,eq:Ar,neq:L1,lt:y1,gt:wr,leq:A1,geq:fu,band:hu,bor:w1,bxor:I1,land:b1,lor:E1,lnot:C1});function Rn(e,t,n,i,o){e[t]=e[t]+e[n]>>>0,e[o]=(e[o]^e[t])>>>0,e[o]=(e[o]<<16|e[o]>>>16&65535)>>>0,e[i]=e[i]+e[o]>>>0,e[n]=(e[n]^e[i])>>>0,e[n]=(e[n]<<12|e[n]>>>20&4095)>>>0,e[t]=e[t]+e[n]>>>0,e[o]=(e[o]^e[t])>>>0,e[o]=(e[o]<<8|e[o]>>>24&255)>>>0,e[i]=e[i]+e[o]>>>0,e[n]=(e[n]^e[i])>>>0,e[n]=(e[n]<<7|e[n]>>>25&127)>>>0}function F1(e){Rn(e,0,4,8,12),Rn(e,1,5,9,13),Rn(e,2,6,10,14),Rn(e,3,7,11,15),Rn(e,0,5,10,15),Rn(e,1,6,11,12),Rn(e,2,7,8,13),Rn(e,3,4,9,14)}class S1{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return this.idx==16&&this.update(),this.buff[this.idx++]}nextU64(){return Lr(du(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(this.nextU32()&1)==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let t=0;t<10;t++)F1(this.buff);for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,this.state[12]==0&&(this.state[13]=this.state[13]+1>>>0,this.state[13]==0&&(this.state[14]=this.state[14]+1>>>0,this.state[14]==0&&(this.state[15]=this.state[15]+1>>>0)))}}function B1(e){let t=new Uint8Array(e);if(typeof globalThis.crypto!="undefined")globalThis.crypto.getRandomValues(t);else for(let n=0;n<e;n++)t[n]=Math.random()*4294967296>>>0;return t}function x1(){const e=B1(32),t=new Uint32Array(e.buffer),n=[];for(let i=0;i<8;i++)n.push(t[i]);return n}let qo=null;function Ir(){return qo||(qo=new S1(x1()),qo)}function br(e){if(typeof e=="bigint"||e.eq!==void 0)return e.toString(10);if(e instanceof Uint8Array)return Mo(e,0);if(Array.isArray(e))return e.map(br);if(typeof e=="object"){const t={};return Object.keys(e).forEach(i=>{t[i]=br(e[i])}),t}else return e}function Er(e){if(typeof e=="string"&&/^[0-9]+$/.test(e))return BigInt(e);if(typeof e=="string"&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(Er);if(typeof e=="object"){if(e===null)return null;const t={};return Object.keys(e).forEach(i=>{t[i]=Er(e[i])}),t}else return e}function O1(e){let t=BigInt(0),n=e.length,i=0;const o=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n>0;)n>=4?(n-=4,t+=BigInt(o.getUint32(n))<<BigInt(i*8),i+=4):n>=2?(n-=2,t+=BigInt(o.getUint16(n))<<BigInt(i*8),i+=2):(n-=1,t+=BigInt(o.getUint8(n))<<BigInt(i*8),i+=1);return t}function T1(e,t){let n=e;const i=new Uint8Array(t),o=new DataView(i.buffer);let a=t;for(;a>0;)a-4>=0?(a-=4,o.setUint32(a,Number(n&BigInt(4294967295))),n=n>>BigInt(32)):a-2>=0?(a-=2,o.setUint16(a,Number(n&BigInt(65535))),n=n>>BigInt(16)):(a-=1,o.setUint8(a,Number(n&BigInt(255))),n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function P1(e){let t=BigInt(0),n=0;const i=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n<e.length;)n+4<=e.length?(t+=BigInt(i.getUint32(n,!0))<<BigInt(n*8),n+=4):n+4<=e.length?(t+=BigInt(i.getUint16(n,!0))<<BigInt(n*8),n+=2):(t+=BigInt(i.getUint8(n,!0))<<BigInt(n*8),n+=1);return t}function R1(e,t){let n=e;typeof t=="undefined"&&(t=Math.floor((_r(e)-1)/8)+1,t==0&&(t=1));const i=new Uint8Array(t),o=new DataView(i.buffer);let a=0;for(;a<t;)a+4<=t?(o.setUint32(a,Number(n&BigInt(4294967295)),!0),a+=4,n=n>>BigInt(32)):a+2<=t?(o.setUint16(Number(a,n&BigInt(65535)),!0),a+=2,n=n>>BigInt(16)):(o.setUint8(Number(a,n&BigInt(255)),!0),a+=1,n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function Cr(e,t){if(typeof t=="bigint"||t.eq!==void 0)return t.toString(10);if(t instanceof Uint8Array)return e.toString(e.e(t));if(Array.isArray(t))return t.map(Cr.bind(this,e));if(typeof t=="object"){const n={};return Object.keys(t).forEach(o=>{n[o]=Cr(e,t[o])}),n}else return t}function vr(e,t){if(typeof t=="string"&&/^[0-9]+$/.test(t))return e.e(t);if(typeof t=="string"&&/^0x[0-9a-fA-F]+$/.test(t))return e.e(t);if(Array.isArray(t))return t.map(vr.bind(this,e));if(typeof t=="object"){if(t===null)return null;const n={};return Object.keys(t).forEach(o=>{n[o]=vr(e,t[o])}),n}else return t}var U1=Object.freeze({__proto__:null,stringifyBigInts:br,unstringifyBigInts:Er,beBuff2int:O1,beInt2Buff:T1,leBuff2int:P1,leInt2Buff:R1,stringifyFElements:Cr,unstringifyFElements:vr});function Fr(e){if(typeof e=="bigint"||e.eq!==void 0)return e.toString(10);if(Array.isArray(e))return e.map(Fr);if(typeof e=="object"){const t={};return Object.keys(e).forEach(i=>{t[i]=Fr(e[i])}),t}else return e}function Sr(e){if(typeof e=="string"&&/^[0-9]+$/.test(e))return X(e);if(typeof e=="string"&&/^0x[0-9a-fA-F]+$/.test(e))return X(e);if(Array.isArray(e))return e.map(Sr);if(typeof e=="object"){const t={};return Object.keys(e).forEach(i=>{t[i]=Sr(e[i])}),t}else return e}function M1(e){let t=X.zero;for(let n=0;n<e.length;n++){const i=X(e[e.length-n-1]);t=t.add(i.shiftLeft(n*8))}return t}function G1(e,t){let n=e,i=t-1;const o=new Uint8Array(t);for(;n.gt(X.zero)&&i>=0;){let a=Number(n.and(X("255")));o[i]=a,i--,n=n.shiftRight(8)}if(!n.eq(X.zero))throw new Error("Number does not fit in this length");return o}function N1(e){let t=X.zero;for(let n=0;n<e.length;n++){const i=X(e[n]);t=t.add(i.shiftLeft(n*8))}return t}function q1(e,t){let n=e,i=0;const o=new Uint8Array(t);for(;n.gt(X.zero)&&i<o.length;){let a=Number(n.and(X(255)));o[i]=a,i++,n=n.shiftRight(8)}if(!n.eq(X.zero))throw new Error("Number does not fit in this length");return o}var z1=Object.freeze({__proto__:null,stringifyBigInts:Fr,unstringifyBigInts:Sr,beBuff2int:M1,beInt2Buff:G1,leBuff2int:N1,leInt2Buff:q1});let dn={};typeof BigInt=="function"?Object.assign(dn,U1):Object.assign(dn,z1);const oo=[];for(let e=0;e<256;e++)oo[e]=D1(e,8);function D1(e,t){let n=0,i=e;for(let o=0;o<t;o++)n<<=1,n=n|i&1,i>>=1;return n}dn.bitReverse=function(t,n){return(oo[t>>>24]|oo[t>>>16&255]<<8|oo[t>>>8&255]<<16|oo[t&255]<<24)>>>32-n},dn.log2=function(t){return((t&4294901760)!=0?(t&=4294901760,16):0)|((t&4278255360)!=0?(t&=4278255360,8):0)|((t&4042322160)!=0?(t&=4042322160,4):0)|((t&3435973836)!=0?(t&=3435973836,2):0)|(t&2863311530)!=0},dn.buffReverseBits=function(t,n){const i=t.byteLength/n,o=dn.log2(i);if(i!=1<<o)throw new Error("Invalid number of pointers");for(let a=0;a<i;a++){const c=dn.bitReverse(a,o);if(a>c){const d=t.slice(a*n,(a+1)*n);t.set(t.slice(c*n,(c+1)*n),a*n),t.set(d,c*n)}}},dn.array2buffer=function(e,t){const n=new Uint8Array(t*e.length);for(let i=0;i<e.length;i++)n.set(e[i],i*t);return n},dn.buffer2array=function(e,t){const n=e.byteLength/t,i=new Array(n);for(let o=0;o<n;o++)i[o]=e.slice(o*t,o*t+t);return i};let{bitReverse:uA,log2:Je,buffReverseBits:k1,stringifyBigInts:dA,unstringifyBigInts:fA,beBuff2int:hA,beInt2Buff:gA,leBuff2int:pA,leInt2Buff:Q1,array2buffer:gu,buffer2array:Br,stringifyFElements:_A,unstringifyFElements:mA}=dn;const we=1<<30;class ne{constructor(t){this.buffers=[],this.byteLength=t;for(let n=0;n<t;n+=we){const i=Math.min(t-n,we);this.buffers.push(new Uint8Array(i))}}slice(t,n){n===void 0&&(n=this.byteLength),t===void 0&&(t=0);const i=n-t,o=Math.floor(t/we),a=Math.floor((t+i-1)/we);if(o==a||i==0)return this.buffers[o].slice(t%we,t%we+i);let c,d=o,h=t%we,u=i;for(;u>0;){const s=h+u>we?we-h:u,_=new Uint8Array(this.buffers[d].buffer,this.buffers[d].byteOffset+h,s);if(s==i)return _.slice();c||(i<=we?c=new Uint8Array(i):c=new ne(i)),c.set(_,i-u),u=u-s,d++,h=0}return c}set(t,n){n===void 0&&(n=0);const i=t.byteLength;if(i==0)return;const o=Math.floor(n/we),a=Math.floor((n+i-1)/we);if(o==a)return t instanceof ne&&t.buffers.length==1?this.buffers[o].set(t.buffers[0],n%we):this.buffers[o].set(t,n%we);let c=o,d=n%we,h=i;for(;h>0;){const u=d+h>we?we-d:h,s=t.slice(i-h,i-h+u);new Uint8Array(this.buffers[c].buffer,this.buffers[c].byteOffset+d,u).set(s),h=h-u,c++,d=0}}}function Un(e,t,n,i){return async function(a){const c=Math.floor(a.byteLength/n);if(c*n!==a.byteLength)throw new Error("Invalid buffer size");const d=Math.floor(c/e.concurrency),h=[];for(let L=0;L<e.concurrency;L++){let g;if(L<e.concurrency-1?g=d:g=c-L*d,g==0)continue;const F=a.slice(L*d*n,L*d*n+g*n),T=[{cmd:"ALLOCSET",var:0,buff:F},{cmd:"ALLOC",var:1,len:i*g},{cmd:"CALL",fnName:t,params:[{var:0},{val:g},{var:1}]},{cmd:"GET",out:0,var:1,len:i*g}];h.push(e.queueAction(T))}const u=await Promise.all(h);let s;a instanceof ne?s=new ne(c*i):s=new Uint8Array(c*i);let _=0;for(let L=0;L<u.length;L++)s.set(u[L][0],_),_+=u[L][0].byteLength;return s}}class pu{constructor(t,n,i,o){if(this.tm=t,this.prefix=n,this.p=o,this.n8=i,this.type="F1",this.m=1,this.half=Go(o,Xn),this.bitLength=_r(o),this.mask=No(mr(Xn,this.bitLength),Xn),this.pOp1=t.alloc(i),this.pOp2=t.alloc(i),this.pOp3=t.alloc(i),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(i/8),this.n32=Math.floor(i/4),this.n64*8!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=Go(this.p,Xn),this.nqr=this.two;let a=this.exp(this.nqr,this.half);for(;!this.eq(a,this.negone);)this.nqr=this.add(this.nqr,this.one),a=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let c=No(this.p,Xn);for(;!lu(c);)this.s=this.s+1,c=Go(c,Xn);this.w=[],this.w[this.s]=this.exp(this.nqr,c);for(let d=this.s-1;d>=0;d--)this.w[d]=this.square(this.w[d+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Un(t,n+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Un(t,n+"_batchFromMontgomery",this.n8,this.n8)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Ci(ge(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,n){if(t instanceof Uint8Array)return t;let i=ge(t,n);cu(i)?(i=uu(i),wr(i,this.p)&&(i=yr(i,this.p)),i=No(this.p,i)):wr(i,this.p)&&(i=yr(i,this.p));const o=Q1(i,this.n8);return this.toMontgomery(o)}toString(t,n){const i=this.fromMontgomery(t),o=Mo(i,0);return pr(o,n)}fromRng(t){let n;const i=new Uint8Array(this.n8);do{n=su;for(let o=0;o<this.n64;o++)n=Lr(n,mr(t.nextU64(),64*o));n=hu(n,this.mask)}while(fu(n,this.p));return gr(i,0,n,this.n8),i}random(){return this.fromRng(Ir())}toObject(t){const n=this.fromMontgomery(t);return Mo(n,0)}fromObject(t){const n=new Uint8Array(this.n8);return gr(n,0,t,this.n8),this.toMontgomery(n)}toRprLE(t,n,i){t.set(this.fromMontgomery(i),n)}toRprBE(t,n,i){const o=this.fromMontgomery(i);for(let a=0;a<this.n8/2;a++){const c=o[a];o[a]=o[this.n8-1-a],o[this.n8-1-a]=c}t.set(o,n)}fromRprLE(t,n){n=n||0;const i=t.slice(n,n+this.n8);return this.toMontgomery(i)}async batchInverse(t){let n=!1;const i=this.n8,o=this.n8;Array.isArray(t)?(t=gu(t,i),n=!0):t=t.slice(0,t.byteLength);const a=Math.floor(t.byteLength/i);if(a*i!==t.byteLength)throw new Error("Invalid buffer size");const c=Math.floor(a/this.tm.concurrency),d=[];for(let _=0;_<this.tm.concurrency;_++){let L;if(_<this.tm.concurrency-1?L=c:L=a-_*c,L==0)continue;const g=t.slice(_*c*i,_*c*i+L*i),F=[{cmd:"ALLOCSET",var:0,buff:g},{cmd:"ALLOC",var:1,len:o*L},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:i},{val:L},{var:1},{val:o}]},{cmd:"GET",out:0,var:1,len:o*L}];d.push(this.tm.queueAction(F))}const h=await Promise.all(d);let u;t instanceof ne?u=new ne(a*o):u=new Uint8Array(a*o);let s=0;for(let _=0;_<h.length;_++)u.set(h[_][0],s),s+=h[_][0].byteLength;return n?Br(u,o):u}}class _u{constructor(t,n,i){this.tm=t,this.prefix=n,this.F=i,this.type="F2",this.m=i.m*2,this.n8=this.F.n8*2,this.n32=this.F.n32*2,this.n64=this.F.n64*2,this.pOp1=t.alloc(i.n8*2),this.pOp2=t.alloc(i.n8*2),this.pOp3=t.alloc(i.n8*2),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}mul1(t,n){return this.op2("_mul1",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Ci(ge(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==2){const i=this.F.e(t[0],n),o=this.F.e(t[1],n),a=new Uint8Array(this.F.n8*2);return a.set(i),a.set(o,this.F.n8*2),a}else throw new Error("invalid F2")}toString(t,n){const i=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[${i}, ${o}]`}fromRng(t){const n=this.F.fromRng(t),i=this.F.fromRng(t),o=new Uint8Array(this.F.n8*2);return o.set(n),o.set(i,this.F.n8),o}random(){return this.fromRng(Ir())}toObject(t){const n=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));return[n,i]}fromObject(t){const n=new Uint8Array(this.F.n8*2),i=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]);return n.set(i),n.set(o,this.F.n8),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class W1{constructor(t,n,i){this.tm=t,this.prefix=n,this.F=i,this.type="F3",this.m=i.m*3,this.n8=this.F.n8*3,this.n32=this.F.n32*3,this.n64=this.F.n64*3,this.pOp1=t.alloc(i.n8*3),this.pOp2=t.alloc(i.n8*3),this.pOp3=t.alloc(i.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}add(t,n){return this.op2("_add",t,n)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Ci(ge(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==3){const i=this.F.e(t[0],n),o=this.F.e(t[1],n),a=this.F.e(t[2],n),c=new Uint8Array(this.F.n8*3);return c.set(i),c.set(o,this.F.n8),c.set(a,this.F.n8*2),c}else throw new Error("invalid F3")}toString(t,n){const i=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),a=this.F.toString(t.slice(this.F.n8*2),n);return`[${i}, ${o}, ${a}]`}fromRng(t){const n=this.F.fromRng(t),i=this.F.fromRng(t),o=this.F.fromRng(t),a=new Uint8Array(this.F.n8*3);return a.set(n),a.set(i,this.F.n8),a.set(o,this.F.n8*2),a}random(){return this.fromRng(Ir())}toObject(t){const n=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3));return[n,i,o]}fromObject(t){const n=new Uint8Array(this.F.n8*3),i=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]),a=this.F.fromObject(t[2]);return n.set(i),n.set(o,this.F.n8),n.set(a,this.F.n8*2),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,this.F.n8*2)}c3(t){return t.slice(this.F.n8*2)}}class mu{constructor(t,n,i,o,a,c){this.tm=t,this.prefix=n,this.F=i,this.pOp1=t.alloc(i.n8*3),this.pOp2=t.alloc(i.n8*3),this.pOp3=t.alloc(i.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,i.n8*3),this.tm.instance.exports[n+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,i.n8*2),this.one=this.tm.getBuff(o,i.n8*3),this.g=this.one,this.oneAffine=this.tm.getBuff(o,i.n8*2),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(a,i.n8),c&&(this.cofactor=Ci(c)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Un(t,n+"_batchLEMtoC",i.n8*2,i.n8),this.batchLEMtoU=Un(t,n+"_batchLEMtoU",i.n8*2,i.n8*2),this.batchCtoLEM=Un(t,n+"_batchCtoLEM",i.n8,i.n8*2),this.batchUtoLEM=Un(t,n+"_batchUtoLEM",i.n8*2,i.n8*2),this.batchToJacobian=Un(t,n+"_batchToJacobian",i.n8*2,i.n8*3),this.batchToAffine=Un(t,n+"_batchToAffine",i.n8*3,i.n8*2)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op2bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op1Affine(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*2)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_add",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_addMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_addMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_addAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}sub(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_sub",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_subMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_subMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_subAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}neg(t){if(t.byteLength==this.F.n8*3)return this.op1("_neg",t);if(t.byteLength==this.F.n8*2)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==this.F.n8*3)return this.op1("_double",t);if(t.byteLength==this.F.n8*2)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==this.F.n8*3)return this.op1Bool("_isZero",t);if(t.byteLength==this.F.n8*2)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,n){n instanceof Uint8Array||(n=Ci(ge(n)));let i;if(t.byteLength==this.F.n8*3)i=this.prefix+"_timesScalar";else if(t.byteLength==this.F.n8*2)i=this.prefix+"_timesScalarAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[i](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}timesFr(t,n){let i;if(t.byteLength==this.F.n8*3)i=this.prefix+"_timesFr";else if(t.byteLength==this.F.n8*2)i=this.prefix+"_timesFrAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[i](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}eq(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2bool("_eq",t,n);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2bool("_eqMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}toAffine(t){if(t.byteLength==this.F.n8*3)return this.op1Affine("_toAffine",t);if(t.byteLength==this.F.n8*2)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==this.F.n8*3)return t;if(t.byteLength==this.F.n8*2)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,n,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}fromRprUncompressed(t,n){const i=t.slice(n,n+this.F.n8*2);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,this.F.n8*2)}toRprCompressed(t,n,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const o=this.tm.getBuff(this.pOp1,this.F.n8);t.set(o,n)}fromRprCompressed(t,n){const i=t.slice(n,n+this.F.n8);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,this.F.n8*2)}toUncompressed(t){const n=new Uint8Array(this.F.n8*2);return this.toRprUncompressed(n,0,t),n}toRprLEM(t,n,i){if(i.byteLength==this.F.n8*2){t.set(i,n);return}else if(i.byteLength==this.F.n8*3){this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}else throw new Error("invalid point size")}fromRprLEM(t,n){return n=n||0,t.slice(n,n+this.F.n8*2)}toString(t,n){if(t.byteLength==this.F.n8*3){const i=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),a=this.F.toString(t.slice(this.F.n8*2),n);return`[ ${i}, ${o}, ${a} ]`}else if(t.byteLength==this.F.n8*2){const i=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[ ${i}, ${o} ]`}else throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const n=this.F,i=this.toAffine(t),o=i.slice(0,this.F.n8),a=i.slice(this.F.n8,this.F.n8*2),c=n.add(n.mul(n.square(o),o),this.b),d=n.square(a);return n.eq(c,d)}fromRng(t){const n=this.F;let i=[],o,a;do i[0]=n.fromRng(t),o=t.nextBool(),a=n.add(n.mul(n.square(i[0]),i[0]),this.b);while(!n.isSquare(a));i[1]=n.sqrt(a);const c=n.isNegative(i[1]);o^c&&(i[1]=n.neg(i[1]));let d=new Uint8Array(this.F.n8*2);return d.set(i[0]),d.set(i[1],this.F.n8),this.cofactor&&(d=this.timesScalar(d,this.cofactor)),d}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const n=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));let o;return t.byteLength==this.F.n8*3?o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3)):o=this.F.toObject(this.F.one),[n,i,o]}fromObject(t){const n=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);let o;if(t.length==3?o=this.F.fromObject(t[2]):o=this.F.one,this.F.isZero(o,this.F.one))return this.zeroAffine;if(this.F.eq(o,this.F.one)){const a=new Uint8Array(this.F.n8*2);return a.set(n),a.set(i,this.F.n8),a}else{const a=new Uint8Array(this.F.n8*3);return a.set(n),a.set(i,this.F.n8),a.set(o,this.F.n8*2),a}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function Lu(e){const t=32767;let n,i;e&&(e.onmessage=function(s){let _;if(s.data?_=s.data:_=s,_[0].cmd=="INIT")o(_[0]).then(function(){e.postMessage(_.result)});else if(_[0].cmd=="TERMINATE")e.close();else{const L=u(_);e.postMessage(L)}});async function o(s){const _=new Uint8Array(s.code),L=await WebAssembly.compile(_);i=new WebAssembly.Memory({initial:s.init,maximum:t}),n=await WebAssembly.instantiate(L,{env:{memory:i}})}function a(s){const _=new Uint32Array(i.buffer,0,1);for(;_[0]&3;)_[0]++;const L=_[0];if(_[0]+=s,_[0]+s>i.buffer.byteLength){const g=i.buffer.byteLength/65536;let F=Math.floor((_[0]+s)/65536)+1;F>t&&(F=t),i.grow(F-g)}return L}function c(s){const _=a(s.byteLength);return h(_,s),_}function d(s,_){const L=new Uint8Array(i.buffer);return new Uint8Array(L.buffer,L.byteOffset+s,_)}function h(s,_){new Uint8Array(i.buffer).set(new Uint8Array(_),s)}function u(s){if(s[0].cmd=="INIT")return o(s[0]);const _={vars:[],out:[]},g=new Uint32Array(i.buffer,0,1)[0];for(let T=0;T<s.length;T++)switch(s[T].cmd){case"ALLOCSET":_.vars[s[T].var]=c(s[T].buff);break;case"ALLOC":_.vars[s[T].var]=a(s[T].len);break;case"SET":h(_.vars[s[T].var],s[T].buff);break;case"CALL":{const C=[];for(let U=0;U<s[T].params.length;U++){const x=s[T].params[U];typeof x.var!="undefined"?C.push(_.vars[x.var]+(x.offset||0)):typeof x.val!="undefined"&&C.push(x.val)}n.exports[s[T].fnName](...C);break}case"GET":_.out[s[T].out]=d(_.vars[s[T].var],s[T].len).slice();break;default:throw new Error("Invalid cmd")}const F=new Uint32Array(i.buffer,0,1);return F[0]=g,_.out}return u}const xr=25;class yu{constructor(){this.promise=new Promise((t,n)=>{this.reject=n,this.resolve=t})}}function $1(e){return new Promise(t=>setTimeout(t,e))}function H1(e){return globalThis.btoa(e)}const j1=H1("("+Lu.toString()+")(self)"),V1="data:application/javascript;base64,"+j1;async function K1(e,t){t=!0;const n=new Y1;n.memory=new WebAssembly.Memory({initial:xr}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);const i=await WebAssembly.compile(e.code);if(n.instance=await WebAssembly.instantiate(i,{env:{memory:n.memory}}),n.singleThread=t,n.initalPFree=n.u32[0],n.pq=e.pq,n.pr=e.pr,n.pG1gen=e.pG1gen,n.pG1zero=e.pG1zero,n.pG2gen=e.pG2gen,n.pG2zero=e.pG2zero,n.pOneT=e.pOneT,t)n.code=e.code,n.taskManager=Lu(),await n.taskManager([{cmd:"INIT",init:xr,code:n.code.slice()}]),n.concurrency=1;else{n.workers=[],n.pendingDeferreds=[],n.working=[];let a;typeof navigator=="object"&&navigator.hardwareConcurrency?a=navigator.hardwareConcurrency:a=eo.cpus().length,a==0&&(a=2),a>64&&(a=64),n.concurrency=a;for(let d=0;d<a;d++)n.workers[d]=new bt(V1),n.workers[d].addEventListener("message",o(d)),n.working[d]=!1;const c=[];for(let d=0;d<n.workers.length;d++){const h=e.code.slice();c.push(n.postAction(d,[{cmd:"INIT",init:xr,code:h}],[h.buffer]))}await Promise.all(c)}return n;function o(a){return function(c){let d;c&&c.data?d=c.data:d=c,n.working[a]=!1,n.pendingDeferreds[a].resolve(d),n.processWorks()}}}class Y1{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(this.oldPFree!=0)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(this.oldPFree==0)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,n,i,o){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=o||new yu,this.workers[t].postMessage(n,i),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(this.working[t]==!1){const n=this.actionQueue.shift();this.postAction(t,n.data,n.transfers,n.deferred)}}queueAction(t,n){const i=new yu;if(this.singleThread){const o=this.taskManager(t);i.resolve(o)}else this.actionQueue.push({data:t,transfers:n,deferred:i}),this.processWorks();return i.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const n=this.alloc(t.byteLength);return this.setBuff(n,t),n}getBuff(t,n){return this.u8.slice(t,t+n)}setBuff(t,n){this.u8.set(new Uint8Array(n),t)}alloc(t){for(;this.u32[0]&3;)this.u32[0]++;const n=this.u32[0];return this.u32[0]+=t,n}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await $1(200)}}function Or(e,t){const n=e[t],i=e.Fr,o=e.tm;e[t].batchApplyKey=async function(a,c,d,h,u){h=h||"affine",u=u||"affine";let s,_,L,g,F;if(t=="G1")h=="jacobian"?(L=n.F.n8*3,s="g1m_batchApplyKey"):(L=n.F.n8*2,s="g1m_batchApplyKeyMixed"),g=n.F.n8*3,u=="jacobian"?F=n.F.n8*3:(_="g1m_batchToAffine",F=n.F.n8*2);else if(t=="G2")h=="jacobian"?(L=n.F.n8*3,s="g2m_batchApplyKey"):(L=n.F.n8*2,s="g2m_batchApplyKeyMixed"),g=n.F.n8*3,u=="jacobian"?F=n.F.n8*3:(_="g2m_batchToAffine",F=n.F.n8*2);else if(t=="Fr")s="frm_batchApplyKey",L=n.n8,g=n.n8,F=n.n8;else throw new Error("Invalid group: "+t);const T=Math.floor(a.byteLength/L),C=Math.floor(T/o.concurrency),U=[];d=i.e(d);let x=i.e(c);for(let v=0;v<o.concurrency;v++){let m;if(v<o.concurrency-1?m=C:m=T-v*C,m==0)continue;const y=[];y.push({cmd:"ALLOCSET",var:0,buff:a.slice(v*C*L,v*C*L+m*L)}),y.push({cmd:"ALLOCSET",var:1,buff:x}),y.push({cmd:"ALLOCSET",var:2,buff:d}),y.push({cmd:"ALLOC",var:3,len:m*Math.max(g,F)}),y.push({cmd:"CALL",fnName:s,params:[{var:0},{val:m},{var:1},{var:2},{var:3}]}),_&&y.push({cmd:"CALL",fnName:_,params:[{var:3},{val:m},{var:3}]}),y.push({cmd:"GET",out:0,var:3,len:m*F}),U.push(o.queueAction(y)),x=i.mul(x,i.exp(d,m))}const V=await Promise.all(U);let D;a instanceof ne?D=new ne(T*F):D=new Uint8Array(T*F);let $=0;for(let v=0;v<V.length;v++)D.set(V[v][0],$),$+=V[v][0].byteLength;return D}}function Z1(e){const t=e.tm;e.pairing=function(i,o){t.startSyncOp();const a=t.allocBuff(e.G1.toJacobian(i)),c=t.allocBuff(e.G2.toJacobian(o)),d=t.alloc(e.Gt.n8);t.instance.exports[e.name+"_pairing"](a,c,d);const h=t.getBuff(d,e.Gt.n8);return t.endSyncOp(),h},e.pairingEq=async function(){let i,o;arguments.length%2==1?(i=arguments[arguments.length-1],o=(arguments.length-1)/2):(i=e.Gt.one,o=arguments.length/2);const a=[];for(let s=0;s<o;s++){const _=[],L=e.G1.toJacobian(arguments[s*2]);_.push({cmd:"ALLOCSET",var:0,buff:L}),_.push({cmd:"ALLOC",var:1,len:e.prePSize});const g=e.G2.toJacobian(arguments[s*2+1]);_.push({cmd:"ALLOCSET",var:2,buff:g}),_.push({cmd:"ALLOC",var:3,len:e.preQSize}),_.push({cmd:"ALLOC",var:4,len:e.Gt.n8}),_.push({cmd:"CALL",fnName:e.name+"_prepareG1",params:[{var:0},{var:1}]}),_.push({cmd:"CALL",fnName:e.name+"_prepareG2",params:[{var:2},{var:3}]}),_.push({cmd:"CALL",fnName:e.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),_.push({cmd:"GET",out:0,var:4,len:e.Gt.n8}),a.push(t.queueAction(_))}const c=await Promise.all(a);t.startSyncOp();const d=t.alloc(e.Gt.n8);t.instance.exports.ftm_one(d);for(let s=0;s<c.length;s++){const _=t.allocBuff(c[s][0]);t.instance.exports.ftm_mul(d,_,d)}t.instance.exports[e.name+"_finalExponentiation"](d,d);const h=t.allocBuff(i),u=!!t.instance.exports.ftm_eq(d,h);return t.endSyncOp(),u},e.prepareG1=function(n){this.tm.startSyncOp();const i=this.tm.allocBuff(n),o=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](i,o);const a=this.tm.getBuff(o,this.prePSize);return this.tm.endSyncOp(),a},e.prepareG2=function(n){this.tm.startSyncOp();const i=this.tm.allocBuff(n),o=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](i,o);const a=this.tm.getBuff(o,this.preQSize);return this.tm.endSyncOp(),a},e.millerLoop=function(n,i){this.tm.startSyncOp();const o=this.tm.allocBuff(n),a=this.tm.allocBuff(i),c=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](o,a,c);const d=this.tm.getBuff(c,this.Gt.n8);return this.tm.endSyncOp(),d},e.finalExponentiation=function(n){this.tm.startSyncOp();const i=this.tm.allocBuff(n),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](i,o);const a=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),a}}const Au=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function wu(e,t){const n=e[t],i=n.tm;async function o(c,d,h,u,s){if(!(c instanceof Uint8Array))throw u&&u.error(`${s} _multiExpChunk buffBases is not Uint8Array`),new Error(`${s} _multiExpChunk buffBases is not Uint8Array`);if(!(d instanceof Uint8Array))throw u&&u.error(`${s} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${s} _multiExpChunk buffScalars is not Uint8Array`);h=h||"affine";let _,L;if(t=="G1")h=="affine"?(L="g1m_multiexpAffine_chunk",_=n.F.n8*2):(L="g1m_multiexp_chunk",_=n.F.n8*3);else if(t=="G2")h=="affine"?(L="g2m_multiexpAffine_chunk",_=n.F.n8*2):(L="g2m_multiexp_chunk",_=n.F.n8*3);else throw new Error("Invalid group");const g=Math.floor(c.byteLength/_);if(g==0)return n.zero;const F=Math.floor(d.byteLength/g);if(F*g!=d.byteLength)throw new Error("Scalar size does not match");const T=Au[Je(g)],C=Math.floor((F*8-1)/T)+1,U=[];for(let D=0;D<C;D++){const $=[{cmd:"ALLOCSET",var:0,buff:c},{cmd:"ALLOCSET",var:1,buff:d},{cmd:"ALLOC",var:2,len:n.F.n8*3},{cmd:"CALL",fnName:L,params:[{var:0},{var:1},{val:F},{val:g},{val:D*T},{val:Math.min(F*8-D*T,T)},{var:2}]},{cmd:"GET",out:0,var:2,len:n.F.n8*3}];U.push(n.tm.queueAction($))}const x=await Promise.all(U);let V=n.zero;for(let D=x.length-1;D>=0;D--){if(!n.isZero(V))for(let $=0;$<T;$++)V=n.double(V);V=n.add(V,x[D][0])}return V}async function a(c,d,h,u,s){const _=1<<22,L=1<<10;let g;if(t=="G1")h=="affine"?g=n.F.n8*2:g=n.F.n8*3;else if(t=="G2")h=="affine"?g=n.F.n8*2:g=n.F.n8*3;else throw new Error("Invalid group");const F=Math.floor(c.byteLength/g),T=Math.floor(d.byteLength/F);if(T*F!=d.byteLength)throw new Error("Scalar size does not match");const C=Au[Je(F)],U=Math.floor((T*8-1)/C)+1;let x;x=Math.floor(F/(i.concurrency/U)),x>_&&(x=_),x<L&&(x=L);const V=[];for(let v=0;v<F;v+=x){u&&u.debug(`Multiexp start: ${s}: ${v}/${F}`);const m=Math.min(F-v,x),y=c.slice(v*g,(v+m)*g),G=d.slice(v*T,(v+m)*T);V.push(o(y,G,h,u,s).then(k=>(u&&u.debug(`Multiexp end: ${s}: ${v}/${F}`),k)))}const D=await Promise.all(V);let $=n.zero;for(let v=D.length-1;v>=0;v--)$=n.add($,D[v]);return $}n.multiExp=async function(d,h,u,s){return await a(d,h,"jacobian",u,s)},n.multiExpAffine=async function(d,h,u,s){return await a(d,h,"affine",u,s)}}function Tr(e,t){const n=e[t],i=e.Fr,o=n.tm;async function a(u,s,_,L,g,F){_=_||"affine",L=L||"affine";const T=14;let C,U,x,V,D,$,v,m;t=="G1"?(_=="affine"?(C=n.F.n8*2,V="g1m_batchToJacobian"):C=n.F.n8*3,U=n.F.n8*3,s&&(m="g1m_fftFinal"),v="g1m_fftJoin",$="g1m_fftMix",L=="affine"?(x=n.F.n8*2,D="g1m_batchToAffine"):x=n.F.n8*3):t=="G2"?(_=="affine"?(C=n.F.n8*2,V="g2m_batchToJacobian"):C=n.F.n8*3,U=n.F.n8*3,s&&(m="g2m_fftFinal"),v="g2m_fftJoin",$="g2m_fftMix",L=="affine"?(x=n.F.n8*2,D="g2m_batchToAffine"):x=n.F.n8*3):t=="Fr"&&(C=n.n8,U=n.n8,x=n.n8,s&&(m="frm_fftFinal"),$="frm_fftMix",v="frm_fftJoin");let y=!1;Array.isArray(u)?(u=gu(u,C),y=!0):u=u.slice(0,u.byteLength);const G=u.byteLength/C,k=Je(G);if(1<<k!=G)throw new Error("fft must be multiple of 2");if(k==i.s+1){let Z;return s?Z=await d(u,_,L,g,F):Z=await c(u,_,L,g,F),y?Br(Z,x):Z}let N;s&&(N=i.inv(i.e(G)));let R;k1(u,C);let E,z=Math.min(1<<T,G),tt=G/z;for(;tt<o.concurrency&&z>=16;)tt*=2,z/=2;const at=Je(z),it=[];for(let Z=0;Z<tt;Z++){g&&g.debug(`${F}: fft ${k} mix start: ${Z}/${tt}`);const ot=[];ot.push({cmd:"ALLOC",var:0,len:U*z});const nt=u.slice(z*Z*C,z*(Z+1)*C);ot.push({cmd:"SET",var:0,buff:nt}),V&&ot.push({cmd:"CALL",fnName:V,params:[{var:0},{val:z},{var:0}]});for(let gt=1;gt<=at;gt++)ot.push({cmd:"CALL",fnName:$,params:[{var:0},{val:z},{val:gt}]});at==k?(m&&(ot.push({cmd:"ALLOCSET",var:1,buff:N}),ot.push({cmd:"CALL",fnName:m,params:[{var:0},{val:z},{var:1}]})),D&&ot.push({cmd:"CALL",fnName:D,params:[{var:0},{val:z},{var:0}]}),ot.push({cmd:"GET",out:0,var:0,len:z*x})):ot.push({cmd:"GET",out:0,var:0,len:U*z}),it.push(o.queueAction(ot).then(gt=>(g&&g.debug(`${F}: fft ${k} mix end: ${Z}/${tt}`),gt)))}E=await Promise.all(it);for(let Z=0;Z<tt;Z++)E[Z]=E[Z][0];for(let Z=at+1;Z<=k;Z++){g&&g.debug(`${F}: fft  ${k}  join: ${Z}/${k}`);const ot=1<<k-Z,nt=tt/ot,gt=[];for(let pt=0;pt<ot;pt++)for(let yt=0;yt<nt/2;yt++){const w=i.exp(i.w[Z],yt*z),f=i.w[Z],O=pt*nt+yt,p=pt*nt+yt+nt/2,W=[];W.push({cmd:"ALLOCSET",var:0,buff:E[O]}),W.push({cmd:"ALLOCSET",var:1,buff:E[p]}),W.push({cmd:"ALLOCSET",var:2,buff:w}),W.push({cmd:"ALLOCSET",var:3,buff:f}),W.push({cmd:"CALL",fnName:v,params:[{var:0},{var:1},{val:z},{var:2},{var:3}]}),Z==k?(m&&(W.push({cmd:"ALLOCSET",var:4,buff:N}),W.push({cmd:"CALL",fnName:m,params:[{var:0},{val:z},{var:4}]}),W.push({cmd:"CALL",fnName:m,params:[{var:1},{val:z},{var:4}]})),D&&(W.push({cmd:"CALL",fnName:D,params:[{var:0},{val:z},{var:0}]}),W.push({cmd:"CALL",fnName:D,params:[{var:1},{val:z},{var:1}]})),W.push({cmd:"GET",out:0,var:0,len:z*x}),W.push({cmd:"GET",out:1,var:1,len:z*x})):(W.push({cmd:"GET",out:0,var:0,len:z*U}),W.push({cmd:"GET",out:1,var:1,len:z*U})),gt.push(o.queueAction(W).then(q=>(g&&g.debug(`${F}: fft ${k} join  ${Z}/${k}  ${pt+1}/${ot} ${yt}/${nt/2}`),q)))}const xt=await Promise.all(gt);for(let pt=0;pt<ot;pt++)for(let yt=0;yt<nt/2;yt++){const w=pt*nt+yt,f=pt*nt+yt+nt/2,O=xt.shift();E[w]=O[0],E[f]=O[1]}}if(u instanceof ne?R=new ne(G*x):R=new Uint8Array(G*x),s){R.set(E[0].slice((z-1)*x));let Z=x;for(let ot=tt-1;ot>0;ot--)R.set(E[ot],Z),Z+=z*x,delete E[ot];R.set(E[0].slice(0,(z-1)*x),Z),delete E[0]}else for(let Z=0;Z<tt;Z++)R.set(E[Z],z*x*Z),delete E[Z];return y?Br(R,x):R}async function c(u,s,_,L,g){let F,T;F=u.slice(0,u.byteLength/2),T=u.slice(u.byteLength/2,u.byteLength);const C=[];[F,T]=await h(F,T,"fftJoinExt",i.one,i.shift,s,"jacobian",L,g),C.push(a(F,!1,"jacobian",_,L,g)),C.push(a(T,!1,"jacobian",_,L,g));const U=await Promise.all(C);let x;return U[0].byteLength>1<<28?x=new ne(U[0].byteLength*2):x=new Uint8Array(U[0].byteLength*2),x.set(U[0]),x.set(U[1],U[0].byteLength),x}async function d(u,s,_,L,g){let F,T;F=u.slice(0,u.byteLength/2),T=u.slice(u.byteLength/2,u.byteLength);const C=[];C.push(a(F,!0,s,"jacobian",L,g)),C.push(a(T,!0,s,"jacobian",L,g)),[F,T]=await Promise.all(C);const U=await h(F,T,"fftJoinExtInv",i.one,i.shiftInv,"jacobian",_,L,g);let x;return U[0].byteLength>1<<28?x=new ne(U[0].byteLength*2):x=new Uint8Array(U[0].byteLength*2),x.set(U[0]),x.set(U[1],U[0].byteLength),x}async function h(u,s,_,L,g,F,T,C,U){const x=1<<16,V=1<<4;let D,$,v,m,y,G;if(t=="G1")F=="affine"?(y=n.F.n8*2,$="g1m_batchToJacobian"):y=n.F.n8*3,G=n.F.n8*3,D="g1m_"+_,T=="affine"?(v="g1m_batchToAffine",m=n.F.n8*2):m=n.F.n8*3;else if(t=="G2")F=="affine"?(y=n.F.n8*2,$="g2m_batchToJacobian"):y=n.F.n8*3,D="g2m_"+_,G=n.F.n8*3,T=="affine"?(v="g2m_batchToAffine",m=n.F.n8*2):m=n.F.n8*3;else if(t=="Fr")y=i.n8,m=i.n8,G=i.n8,D="frm_"+_;else throw new Error("Invalid group");if(u.byteLength!=s.byteLength)throw new Error("Invalid buffer size");const k=Math.floor(u.byteLength/y);if(k!=1<<Je(k))throw new Error("Invalid number of points");let N=Math.floor(k/o.concurrency);N<V&&(N=V),N>x&&(N=x);const R=[];for(let it=0;it<k;it+=N){C&&C.debug(`${U}: fftJoinExt Start: ${it}/${k}`);const Z=Math.min(k-it,N),ot=i.mul(L,i.exp(g,it)),nt=[],gt=u.slice(it*y,(it+Z)*y),xt=s.slice(it*y,(it+Z)*y);nt.push({cmd:"ALLOC",var:0,len:G*Z}),nt.push({cmd:"SET",var:0,buff:gt}),nt.push({cmd:"ALLOC",var:1,len:G*Z}),nt.push({cmd:"SET",var:1,buff:xt}),nt.push({cmd:"ALLOCSET",var:2,buff:ot}),nt.push({cmd:"ALLOCSET",var:3,buff:g}),$&&(nt.push({cmd:"CALL",fnName:$,params:[{var:0},{val:Z},{var:0}]}),nt.push({cmd:"CALL",fnName:$,params:[{var:1},{val:Z},{var:1}]})),nt.push({cmd:"CALL",fnName:D,params:[{var:0},{var:1},{val:Z},{var:2},{var:3},{val:i.s}]}),v&&(nt.push({cmd:"CALL",fnName:v,params:[{var:0},{val:Z},{var:0}]}),nt.push({cmd:"CALL",fnName:v,params:[{var:1},{val:Z},{var:1}]})),nt.push({cmd:"GET",out:0,var:0,len:Z*m}),nt.push({cmd:"GET",out:1,var:1,len:Z*m}),R.push(o.queueAction(nt).then(pt=>(C&&C.debug(`${U}: fftJoinExt End: ${it}/${k}`),pt)))}const E=await Promise.all(R);let z,tt;k*m>1<<28?(z=new ne(k*m),tt=new ne(k*m)):(z=new Uint8Array(k*m),tt=new Uint8Array(k*m));let at=0;for(let it=0;it<E.length;it++)z.set(E[it][0],at),tt.set(E[it][1],at),at+=E[it][0].byteLength;return[z,tt]}n.fft=async function(u,s,_,L,g){return await a(u,!1,s,_,L,g)},n.ifft=async function(u,s,_,L,g){return await a(u,!0,s,_,L,g)},n.lagrangeEvaluations=async function(u,s,_,L,g){s=s||"affine",_=_||"affine";let F;if(t=="G1")s=="affine"?F=n.F.n8*2:F=n.F.n8*3;else if(t=="G2")s=="affine"?F=n.F.n8*2:F=n.F.n8*3;else if(t=="Fr")F=i.n8;else throw new Error("Invalid group");const T=u.byteLength/F,C=Je(T);if(2**C*F!=u.byteLength)throw L&&L.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(C<=i.s)return await n.ifft(u,s,_,L,g);if(C>i.s+1)throw L&&L.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let U=u.slice(0,u.byteLength/2),x=u.slice(u.byteLength/2,u.byteLength);const V=i.exp(i.shift,T/2),D=i.inv(i.sub(i.one,V));[U,x]=await h(U,x,"prepareLagrangeEvaluation",D,i.shiftInv,s,"jacobian",L,g+" prep");const $=[];$.push(a(U,!0,"jacobian",_,L,g+" t0")),$.push(a(x,!0,"jacobian",_,L,g+" t1")),[U,x]=await Promise.all($);let v;return U.byteLength>1<<28?v=new ne(U.byteLength*2):v=new Uint8Array(U.byteLength*2),v.set(U),v.set(x,U.byteLength),v},n.fftMix=async function(s){const _=n.F.n8*3;let L,g;if(t=="G1")L="g1m_fftMix",g="g1m_fftJoin";else if(t=="G2")L="g2m_fftMix",g="g2m_fftJoin";else if(t=="Fr")L="frm_fftMix",g="frm_fftJoin";else throw new Error("Invalid group");const F=Math.floor(s.byteLength/_),T=Je(F);let C=1<<Je(o.concurrency);F<=C*2&&(C=1);const U=F/C,x=Je(U),V=[];for(let y=0;y<C;y++){const G=[],k=s.slice(y*U*_,(y+1)*U*_);G.push({cmd:"ALLOCSET",var:0,buff:k});for(let N=1;N<=x;N++)G.push({cmd:"CALL",fnName:L,params:[{var:0},{val:U},{val:N}]});G.push({cmd:"GET",out:0,var:0,len:U*_}),V.push(o.queueAction(G))}const D=await Promise.all(V),$=[];for(let y=0;y<D.length;y++)$[y]=D[y][0];for(let y=x+1;y<=T;y++){const G=1<<T-y,k=C/G,N=[];for(let E=0;E<G;E++)for(let z=0;z<k/2;z++){const tt=i.exp(i.w[y],z*U),at=i.w[y],it=E*k+z,Z=E*k+z+k/2,ot=[];ot.push({cmd:"ALLOCSET",var:0,buff:$[it]}),ot.push({cmd:"ALLOCSET",var:1,buff:$[Z]}),ot.push({cmd:"ALLOCSET",var:2,buff:tt}),ot.push({cmd:"ALLOCSET",var:3,buff:at}),ot.push({cmd:"CALL",fnName:g,params:[{var:0},{var:1},{val:U},{var:2},{var:3}]}),ot.push({cmd:"GET",out:0,var:0,len:U*_}),ot.push({cmd:"GET",out:1,var:1,len:U*_}),N.push(o.queueAction(ot))}const R=await Promise.all(N);for(let E=0;E<G;E++)for(let z=0;z<k/2;z++){const tt=E*k+z,at=E*k+z+k/2,it=R.shift();$[tt]=it[0],$[at]=it[1]}}let v;s instanceof ne?v=new ne(F*_):v=new Uint8Array(F*_);let m=0;for(let y=0;y<C;y++)v.set($[y],m),m+=$[y].byteLength;return v},n.fftJoin=async function(s,_,L,g){const F=n.F.n8*3;let T;if(t=="G1")T="g1m_fftJoin";else if(t=="G2")T="g2m_fftJoin";else if(t=="Fr")T="frm_fftJoin";else throw new Error("Invalid group");if(s.byteLength!=_.byteLength)throw new Error("Invalid buffer size");const C=Math.floor(s.byteLength/F);if(C!=1<<Je(C))throw new Error("Invalid number of points");let U=1<<Je(o.concurrency);C<=U*2&&(U=1);const x=C/U,V=[];for(let y=0;y<U;y++){const G=[],k=i.mul(L,i.exp(g,y*x)),N=s.slice(y*x*F,(y+1)*x*F),R=_.slice(y*x*F,(y+1)*x*F);G.push({cmd:"ALLOCSET",var:0,buff:N}),G.push({cmd:"ALLOCSET",var:1,buff:R}),G.push({cmd:"ALLOCSET",var:2,buff:k}),G.push({cmd:"ALLOCSET",var:3,buff:g}),G.push({cmd:"CALL",fnName:T,params:[{var:0},{var:1},{val:x},{var:2},{var:3}]}),G.push({cmd:"GET",out:0,var:0,len:x*F}),G.push({cmd:"GET",out:1,var:1,len:x*F}),V.push(o.queueAction(G))}const D=await Promise.all(V);let $,v;s instanceof ne?($=new ne(C*F),v=new ne(C*F)):($=new Uint8Array(C*F),v=new Uint8Array(C*F));let m=0;for(let y=0;y<D.length;y++)$.set(D[y][0],m),v.set(D[y][1],m),m+=D[y][0].byteLength;return[$,v]},n.fftFinal=async function(s,_){const L=n.F.n8*3,g=n.F.n8*2;let F,T;if(t=="G1")F="g1m_fftFinal",T="g1m_batchToAffine";else if(t=="G2")F="g2m_fftFinal",T="g2m_batchToAffine";else throw new Error("Invalid group");const C=Math.floor(s.byteLength/L);if(C!=1<<Je(C))throw new Error("Invalid number of points");const U=Math.floor(C/o.concurrency),x=[];for(let v=0;v<o.concurrency;v++){let m;if(v<o.concurrency-1?m=U:m=C-v*U,m==0)continue;const y=[],G=s.slice(v*U*L,(v*U+m)*L);y.push({cmd:"ALLOCSET",var:0,buff:G}),y.push({cmd:"ALLOCSET",var:1,buff:_}),y.push({cmd:"CALL",fnName:F,params:[{var:0},{val:m},{var:1}]}),y.push({cmd:"CALL",fnName:T,params:[{var:0},{val:m},{var:0}]}),y.push({cmd:"GET",out:0,var:0,len:m*g}),x.push(o.queueAction(y))}const V=await Promise.all(x);let D;s instanceof ne?D=new ne(C*g):D=new Uint8Array(C*g);let $=0;for(let v=V.length-1;v>=0;v--)D.set(V[v][0],$),$+=V[v][0].byteLength;return D}}async function Iu(e){const t=await K1(e.wasm,e.singleThread),n={};return n.q=ge(e.wasm.q),n.r=ge(e.wasm.r),n.name=e.name,n.tm=t,n.prePSize=e.wasm.prePSize,n.preQSize=e.wasm.preQSize,n.Fr=new pu(t,"frm",e.n8r,e.r),n.F1=new pu(t,"f1m",e.n8q,e.q),n.F2=new _u(t,"f2m",n.F1),n.G1=new mu(t,"g1m",n.F1,e.wasm.pG1gen,e.wasm.pG1b,e.cofactorG1),n.G2=new mu(t,"g2m",n.F2,e.wasm.pG2gen,e.wasm.pG2b,e.cofactorG2),n.F6=new W1(t,"f6m",n.F2),n.F12=new _u(t,"ftm",n.F6),n.Gt=n.F12,Or(n,"G1"),Or(n,"G2"),Or(n,"Fr"),wu(n,"G1"),wu(n,"G2"),Tr(n,"G1"),Tr(n,"G2"),Tr(n,"Fr"),Z1(n),n.array2buffer=function(i,o){const a=new Uint8Array(o*i.length);for(let c=0;c<i.length;c++)a.set(i[c],c*o);return a},n.buffer2array=function(i,o){const a=i.byteLength/o,c=new Array(a);for(let d=0;d<a;d++)c[d]=i.slice(d*o,d*o+o);return c},n}globalThis.curve_bn128=null;async function J1(e,t){const n=new Uo;n.setMemory(25),ql(n),t&&t(n);const i={};if(i.code=n.build(),i.pq=n.modules.f1m.pq,i.pr=n.modules.frm.pq,i.pG1gen=n.modules.bn128.pG1gen,i.pG1zero=n.modules.bn128.pG1zero,i.pG1b=n.modules.bn128.pG1b,i.pG2gen=n.modules.bn128.pG2gen,i.pG2zero=n.modules.bn128.pG2zero,i.pG2b=n.modules.bn128.pG2b,i.pOneT=n.modules.bn128.pOneT,i.prePSize=n.modules.bn128.prePSize,i.preQSize=n.modules.bn128.preQSize,i.n8q=32,i.n8r=32,i.q=n.modules.bn128.q,i.r=n.modules.bn128.r,!e&&globalThis.curve_bn128)return globalThis.curve_bn128;const o={name:"bn128",wasm:i,q:ge("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:ge("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:ge("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!e},a=await Iu(o);return a.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},e||(globalThis.curve_bn128=a),a}globalThis.curve_bls12381=null;async function X1(e,t){const n=new Uo;n.setMemory(25),zl(n),t&&t(n);const i={};if(i.code=n.build(),i.pq=n.modules.f1m.pq,i.pr=n.modules.frm.pq,i.pG1gen=n.modules.bls12381.pG1gen,i.pG1zero=n.modules.bls12381.pG1zero,i.pG1b=n.modules.bls12381.pG1b,i.pG2gen=n.modules.bls12381.pG2gen,i.pG2zero=n.modules.bls12381.pG2zero,i.pG2b=n.modules.bls12381.pG2b,i.pOneT=n.modules.bls12381.pOneT,i.prePSize=n.modules.bls12381.prePSize,i.preQSize=n.modules.bls12381.preQSize,i.n8q=48,i.n8r=32,i.q=n.modules.bn128.q,i.r=n.modules.bn128.r,!e&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const o={name:"bls12381",wasm:i,q:ge("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:ge("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:ge("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:ge("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!e},a=await Iu(o);return a.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},e||(globalThis.curve_bls12381=a),a}const t3=ge("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),e3=ge("21888242871839275222246405745257275088548364400416034343698204186575808495617");ge("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),ge("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function n3(e,t,n){let i;if(Ar(e,e3))i=await J1(t,n);else if(Ar(e,t3))i=await X1(t,n);else throw new Error(`Curve not supported: ${pr(e)}`);return i}const bu=v1;async function zo(e,t,n){const i={};return await Ne(e,t,1),i.n8=await e.readULE32(),i.prime=await Ei(e,i.n8),i.curve=await n3(i.prime,n),i.nVars=await e.readULE32(),i.nOutputs=await e.readULE32(),i.nPubInputs=await e.readULE32(),i.nPrvInputs=await e.readULE32(),i.nLabels=await e.readULE64(),i.nConstraints=await e.readULE32(),await qe(e),i}var i3=`//
// Copyright 2017 Christian Reitwiessner
// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
//
// 2019 OKIMS
//      ported to solidity 0.6
//      fixed linter warnings
//      added requiere error messages
//
//
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.6.11;
library Pairing {
    struct G1Point {
        uint X;
        uint Y;
    }
    // Encoding of field elements is: X[0] * z + X[1]
    struct G2Point {
        uint[2] X;
        uint[2] Y;
    }
    /// @return the generator of G1
    function P1() internal pure returns (G1Point memory) {
        return G1Point(1, 2);
    }
    /// @return the generator of G2
    function P2() internal pure returns (G2Point memory) {
        // Original code point
        return G2Point(
            [11559732032986387107991004021392285783925812861821192530917403151452391805634,
             10857046999023057135944570762232829481370756359578518086990519993285655852781],
            [4082367875863433681332203403145435568316851327593401208105741076214120093531,
             8495653923123431417604973247489272438418190587263600148770280649306958101930]
        );

/*
        // Changed by Jordi point
        return G2Point(
            [10857046999023057135944570762232829481370756359578518086990519993285655852781,
             11559732032986387107991004021392285783925812861821192530917403151452391805634],
            [8495653923123431417604973247489272438418190587263600148770280649306958101930,
             4082367875863433681332203403145435568316851327593401208105741076214120093531]
        );
*/
    }
    /// @return r the negation of p, i.e. p.addition(p.negate()) should be zero.
    function negate(G1Point memory p) internal pure returns (G1Point memory r) {
        // The prime q in the base field F_q for G1
        uint q = 21888242871839275222246405745257275088696311157297823662689037894645226208583;
        if (p.X == 0 && p.Y == 0)
            return G1Point(0, 0);
        return G1Point(p.X, q - (p.Y % q));
    }
    /// @return r the sum of two points of G1
    function addition(G1Point memory p1, G1Point memory p2) internal view returns (G1Point memory r) {
        uint[4] memory input;
        input[0] = p1.X;
        input[1] = p1.Y;
        input[2] = p2.X;
        input[3] = p2.Y;
        bool success;
        // solium-disable-next-line security/no-inline-assembly
        assembly {
            success := staticcall(sub(gas(), 2000), 6, input, 0xc0, r, 0x60)
            // Use "invalid" to make gas estimation work
            switch success case 0 { invalid() }
        }
        require(success,"pairing-add-failed");
    }
    /// @return r the product of a point on G1 and a scalar, i.e.
    /// p == p.scalar_mul(1) and p.addition(p) == p.scalar_mul(2) for all points p.
    function scalar_mul(G1Point memory p, uint s) internal view returns (G1Point memory r) {
        uint[3] memory input;
        input[0] = p.X;
        input[1] = p.Y;
        input[2] = s;
        bool success;
        // solium-disable-next-line security/no-inline-assembly
        assembly {
            success := staticcall(sub(gas(), 2000), 7, input, 0x80, r, 0x60)
            // Use "invalid" to make gas estimation work
            switch success case 0 { invalid() }
        }
        require (success,"pairing-mul-failed");
    }
    /// @return the result of computing the pairing check
    /// e(p1[0], p2[0]) *  .... * e(p1[n], p2[n]) == 1
    /// For example pairing([P1(), P1().negate()], [P2(), P2()]) should
    /// return true.
    function pairing(G1Point[] memory p1, G2Point[] memory p2) internal view returns (bool) {
        require(p1.length == p2.length,"pairing-lengths-failed");
        uint elements = p1.length;
        uint inputSize = elements * 6;
        uint[] memory input = new uint[](inputSize);
        for (uint i = 0; i < elements; i++)
        {
            input[i * 6 + 0] = p1[i].X;
            input[i * 6 + 1] = p1[i].Y;
            input[i * 6 + 2] = p2[i].X[0];
            input[i * 6 + 3] = p2[i].X[1];
            input[i * 6 + 4] = p2[i].Y[0];
            input[i * 6 + 5] = p2[i].Y[1];
        }
        uint[1] memory out;
        bool success;
        // solium-disable-next-line security/no-inline-assembly
        assembly {
            success := staticcall(sub(gas(), 2000), 8, add(input, 0x20), mul(inputSize, 0x20), out, 0x20)
            // Use "invalid" to make gas estimation work
            switch success case 0 { invalid() }
        }
        require(success,"pairing-opcode-failed");
        return out[0] != 0;
    }
    /// Convenience method for a pairing check for two pairs.
    function pairingProd2(G1Point memory a1, G2Point memory a2, G1Point memory b1, G2Point memory b2) internal view returns (bool) {
        G1Point[] memory p1 = new G1Point[](2);
        G2Point[] memory p2 = new G2Point[](2);
        p1[0] = a1;
        p1[1] = b1;
        p2[0] = a2;
        p2[1] = b2;
        return pairing(p1, p2);
    }
    /// Convenience method for a pairing check for three pairs.
    function pairingProd3(
            G1Point memory a1, G2Point memory a2,
            G1Point memory b1, G2Point memory b2,
            G1Point memory c1, G2Point memory c2
    ) internal view returns (bool) {
        G1Point[] memory p1 = new G1Point[](3);
        G2Point[] memory p2 = new G2Point[](3);
        p1[0] = a1;
        p1[1] = b1;
        p1[2] = c1;
        p2[0] = a2;
        p2[1] = b2;
        p2[2] = c2;
        return pairing(p1, p2);
    }
    /// Convenience method for a pairing check for four pairs.
    function pairingProd4(
            G1Point memory a1, G2Point memory a2,
            G1Point memory b1, G2Point memory b2,
            G1Point memory c1, G2Point memory c2,
            G1Point memory d1, G2Point memory d2
    ) internal view returns (bool) {
        G1Point[] memory p1 = new G1Point[](4);
        G2Point[] memory p2 = new G2Point[](4);
        p1[0] = a1;
        p1[1] = b1;
        p1[2] = c1;
        p1[3] = d1;
        p2[0] = a2;
        p2[1] = b2;
        p2[2] = c2;
        p2[3] = d2;
        return pairing(p1, p2);
    }
}
contract Verifier {
    using Pairing for *;
    struct VerifyingKey {
        Pairing.G1Point alfa1;
        Pairing.G2Point beta2;
        Pairing.G2Point gamma2;
        Pairing.G2Point delta2;
        Pairing.G1Point[] IC;
    }
    struct Proof {
        Pairing.G1Point A;
        Pairing.G2Point B;
        Pairing.G1Point C;
    }
    function verifyingKey() internal pure returns (VerifyingKey memory vk) {
        vk.alfa1 = Pairing.G1Point(
            <%=vk_alpha_1[0]%>,
            <%=vk_alpha_1[1]%>
        );

        vk.beta2 = Pairing.G2Point(
            [<%=vk_beta_2[0][1]%>,
             <%=vk_beta_2[0][0]%>],
            [<%=vk_beta_2[1][1]%>,
             <%=vk_beta_2[1][0]%>]
        );
        vk.gamma2 = Pairing.G2Point(
            [<%=vk_gamma_2[0][1]%>,
             <%=vk_gamma_2[0][0]%>],
            [<%=vk_gamma_2[1][1]%>,
             <%=vk_gamma_2[1][0]%>]
        );
        vk.delta2 = Pairing.G2Point(
            [<%=vk_delta_2[0][1]%>,
             <%=vk_delta_2[0][0]%>],
            [<%=vk_delta_2[1][1]%>,
             <%=vk_delta_2[1][0]%>]
        );
        vk.IC = new Pairing.G1Point[](<%=IC.length%>);
        <% for (let i=0; i<IC.length; i++) { %>
        vk.IC[<%=i%>] = Pairing.G1Point( 
            <%=IC[i][0]%>,
            <%=IC[i][1]%>
        );                                      
        <% } %>
    }
    function verify(uint[] memory input, Proof memory proof) internal view returns (uint) {
        uint256 snark_scalar_field = 21888242871839275222246405745257275088548364400416034343698204186575808495617;
        VerifyingKey memory vk = verifyingKey();
        require(input.length + 1 == vk.IC.length,"verifier-bad-input");
        // Compute the linear combination vk_x
        Pairing.G1Point memory vk_x = Pairing.G1Point(0, 0);
        for (uint i = 0; i < input.length; i++) {
            require(input[i] < snark_scalar_field,"verifier-gte-snark-scalar-field");
            vk_x = Pairing.addition(vk_x, Pairing.scalar_mul(vk.IC[i + 1], input[i]));
        }
        vk_x = Pairing.addition(vk_x, vk.IC[0]);
        if (!Pairing.pairingProd4(
            Pairing.negate(proof.A), proof.B,
            vk.alfa1, vk.beta2,
            vk_x, vk.gamma2,
            proof.C, vk.delta2
        )) return 1;
        return 0;
    }
    /// @return r  bool true if proof is valid
    function verifyProof(
            uint[2] memory a,
            uint[2][2] memory b,
            uint[2] memory c,
            uint[<%=IC.length-1%>] memory input
        ) public view returns (bool r) {
        Proof memory proof;
        proof.A = Pairing.G1Point(a[0], a[1]);
        proof.B = Pairing.G2Point([b[0][0], b[0][1]], [b[1][0], b[1][1]]);
        proof.C = Pairing.G1Point(c[0], c[1]);
        uint[] memory inputValues = new uint[](input.length);
        for(uint i = 0; i < input.length; i++){
            inputValues[i] = input[i];
        }
        if (verify(inputValues, proof) == 0) {
            return true;
        } else {
            return false;
        }
    }
}
`,o3=`// SPDX-License-Identifier: GPL-3.0
/*
    Copyright 2021 0KIMS association.

    This file is generated with [snarkJS](https://github.com/iden3/snarkjs).

    snarkJS is a free software: you can redistribute it and/or modify it
    under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    snarkJS is distributed in the hope that it will be useful, but WITHOUT
    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public
    License for more details.

    You should have received a copy of the GNU General Public License
    along with snarkJS. If not, see <https://www.gnu.org/licenses/>.
*/


pragma solidity >=0.7.0 <0.9.0;

contract PlonkVerifier {
    
    uint<%=2**Math.ceil(Math.log2(power))%> constant n =   <%=2**power%>;
    uint16 constant nPublic =  <%=nPublic%>;
    uint16 constant nLagrange = <%=Math.max(nPublic, 1)%>;
    
    uint256 constant Qmx = <%=Qm[0]%>;
    uint256 constant Qmy = <%=Qm[0] == "0" ? "0" : Qm[1]%>;
    uint256 constant Qlx = <%=Ql[0]%>;
    uint256 constant Qly = <%=Ql[0] == "0" ? "0" : Ql[1]%>;
    uint256 constant Qrx = <%=Qr[0]%>;
    uint256 constant Qry = <%=Qr[0] == "0" ? "0" : Qr[1]%>;
    uint256 constant Qox = <%=Qo[0]%>;
    uint256 constant Qoy = <%=Qo[0] == "0" ? "0" : Qo[1]%>;
    uint256 constant Qcx = <%=Qc[0]%>;
    uint256 constant Qcy = <%=Qc[0] == "0" ? "0" : Qc[1]%>;
    uint256 constant S1x = <%=S1[0]%>;
    uint256 constant S1y = <%=S1[0] == "0" ? "0" : S1[1]%>;
    uint256 constant S2x = <%=S2[0]%>;
    uint256 constant S2y = <%=S2[0] == "0" ? "0" : S2[1]%>;
    uint256 constant S3x = <%=S3[0]%>;
    uint256 constant S3y = <%=S3[0] == "0" ? "0" : S3[1]%>;
    uint256 constant k1 = 2;
    uint256 constant k2 = 3;
    uint256 constant X2x1 = <%=X_2[0][0]%>;
    uint256 constant X2x2 = <%=X_2[0][1]%>;
    uint256 constant X2y1 = <%=X_2[1][0]%>;
    uint256 constant X2y2 = <%=X_2[1][1]%>;
    
    uint256 constant q = 21888242871839275222246405745257275088548364400416034343698204186575808495617;
    uint256 constant qf = 21888242871839275222246405745257275088696311157297823662689037894645226208583;
    uint256 constant w1 = <%=w%>;    
    
    uint256 constant G1x = 1;
    uint256 constant G1y = 2;
    uint256 constant G2x1 = 10857046999023057135944570762232829481370756359578518086990519993285655852781;
    uint256 constant G2x2 = 11559732032986387107991004021392285783925812861821192530917403151452391805634;
    uint256 constant G2y1 = 8495653923123431417604973247489272438418190587263600148770280649306958101930;
    uint256 constant G2y2 = 4082367875863433681332203403145435568316851327593401208105741076214120093531;
    uint16 constant pA = 32;
    uint16 constant pB = 96;
    uint16 constant pC = 160;
    uint16 constant pZ = 224;
    uint16 constant pT1 = 288;
    uint16 constant pT2 = 352;
    uint16 constant pT3 = 416;
    uint16 constant pWxi = 480;
    uint16 constant pWxiw = 544;
    uint16 constant pEval_a = 608;
    uint16 constant pEval_b = 640;
    uint16 constant pEval_c = 672;
    uint16 constant pEval_s1 = 704;
    uint16 constant pEval_s2 = 736;
    uint16 constant pEval_zw = 768;
    uint16 constant pEval_r = 800;
    
    uint16 constant pAlpha = 0;
    uint16 constant pBeta = 32;
    uint16 constant pGamma = 64;
    uint16 constant pXi = 96;
    uint16 constant pXin = 128;
    uint16 constant pBetaXi = 160;
    uint16 constant pV1 = 192;
    uint16 constant pV2 = 224;
    uint16 constant pV3 = 256;
    uint16 constant pV4 = 288;
    uint16 constant pV5 = 320;
    uint16 constant pV6 = 352;
    uint16 constant pU = 384;
    uint16 constant pPl = 416;
    uint16 constant pEval_t = 448;
    uint16 constant pA1 = 480;
    uint16 constant pB1 = 544;
    uint16 constant pZh = 608;
    uint16 constant pZhInv = 640;
    <% for (let i=1; i<=Math.max(nPublic, 1); i++) { %>
    uint16 constant pEval_l<%=i%> = <%=640+i*32%>;
    <% } %>
    
    
    uint16 constant lastMem = <%=672+32*Math.max(nPublic,1)%>;


    function verifyProof(bytes memory proof, uint[] memory pubSignals) public view returns (bool) {
        assembly {
            /////////
            // Computes the inverse using the extended euclidean algorithm
            /////////
            function inverse(a, q) -> inv {
                let t := 0     
                let newt := 1
                let r := q     
                let newr := a
                let quotient
                let aux
                
                for { } newr { } {
                    quotient := sdiv(r, newr)
                    aux := sub(t, mul(quotient, newt))
                    t:= newt
                    newt:= aux
                    
                    aux := sub(r,mul(quotient, newr))
                    r := newr
                    newr := aux
                }
                
                if gt(r, 1) { revert(0,0) }
                if slt(t, 0) { t:= add(t, q) }

                inv := t
            }
            
            ///////
            // Computes the inverse of an array of values
            // See https://vitalik.ca/general/2018/07/21/starks_part_3.html in section where explain fields operations
            //////
            function inverseArray(pVals, n) {
    
                let pAux := mload(0x40)     // Point to the next free position
                let pIn := pVals
                let lastPIn := add(pVals, mul(n, 32))  // Read n elemnts
                let acc := mload(pIn)       // Read the first element
                pIn := add(pIn, 32)         // Point to the second element
                let inv
    
                
                for { } lt(pIn, lastPIn) { 
                    pAux := add(pAux, 32) 
                    pIn := add(pIn, 32)
                } 
                {
                    mstore(pAux, acc)
                    acc := mulmod(acc, mload(pIn), q)
                }
                acc := inverse(acc, q)
                
                // At this point pAux pint to the next free position we substract 1 to point to the last used
                pAux := sub(pAux, 32)
                // pIn points to the n+1 element, we substract to point to n
                pIn := sub(pIn, 32)
                lastPIn := pVals  // We don't process the first element 
                for { } gt(pIn, lastPIn) { 
                    pAux := sub(pAux, 32) 
                    pIn := sub(pIn, 32)
                } 
                {
                    inv := mulmod(acc, mload(pAux), q)
                    acc := mulmod(acc, mload(pIn), q)
                    mstore(pIn, inv)
                }
                // pIn points to first element, we just set it.
                mstore(pIn, acc)
            }
            
            function checkField(v) {
                if iszero(lt(v, q)) {
                    mstore(0, 0)
                    return(0,0x20)
                }
            }
            
            function checkInput(pProof) {
                if iszero(eq(mload(pProof), 800 )) {
                    mstore(0, 0)
                    return(0,0x20)
                }
                checkField(mload(add(pProof, pEval_a)))
                checkField(mload(add(pProof, pEval_b)))
                checkField(mload(add(pProof, pEval_c)))
                checkField(mload(add(pProof, pEval_s1)))
                checkField(mload(add(pProof, pEval_s2)))
                checkField(mload(add(pProof, pEval_zw)))
                checkField(mload(add(pProof, pEval_r)))

                // Points are checked in the point operations precompiled smart contracts
            }
            
            function calculateChallanges(pProof, pMem) {
            
                let a
                let b
                
                b := mod(keccak256(add(pProof, pA), 192), q) 
                mstore( add(pMem, pBeta), b)
                mstore( add(pMem, pGamma), mod(keccak256(add(pMem, pBeta), 32), q))
                mstore( add(pMem, pAlpha), mod(keccak256(add(pProof, pZ), 64), q))
                
                a := mod(keccak256(add(pProof, pT1), 192), q)
                mstore( add(pMem, pXi), a)
                mstore( add(pMem, pBetaXi), mulmod(b, a, q))
                <%for (let i=0; i<power;i++) {%>
                a:= mulmod(a, a, q)
                <%}%>
                mstore( add(pMem, pXin), a)
                a:= mod(add(sub(a, 1),q), q)
                mstore( add(pMem, pZh), a)
                mstore( add(pMem, pZhInv), a)  // We will invert later together with lagrange pols
                
                let v1 := mod(keccak256(add(pProof, pEval_a), 224), q)
                mstore( add(pMem, pV1), v1)
                a := mulmod(v1, v1, q)
                mstore( add(pMem, pV2), a)
                a := mulmod(a, v1, q)
                mstore( add(pMem, pV3), a)
                a := mulmod(a, v1, q)
                mstore( add(pMem, pV4), a)
                a := mulmod(a, v1, q)
                mstore( add(pMem, pV5), a)
                a := mulmod(a, v1, q)
                mstore( add(pMem, pV6), a)
                
                mstore( add(pMem, pU), mod(keccak256(add(pProof, pWxi), 128), q))
            }
            
            function calculateLagrange(pMem) {

                let w := 1                
                <% for (let i=1; i<=Math.max(nPublic, 1); i++) { %>
                mstore(
                    add(pMem, pEval_l<%=i%>), 
                    mulmod(
                        n, 
                        mod(
                            add(
                                sub(
                                    mload(add(pMem, pXi)), 
                                    w
                                ), 
                                q
                            ),
                            q
                        ), 
                        q
                    )
                )
                <% if (i<Math.max(nPublic, 1)) { %>
                w := mulmod(w, w1, q)
                <% } %>
                <% } %>
                
                inverseArray(add(pMem, pZhInv), <%=Math.max(nPublic, 1)+1%> )
                
                let zh := mload(add(pMem, pZh))
                w := 1
                <% for (let i=1; i<=Math.max(nPublic, 1); i++) { %>
                <% if (i==1) { %>
                mstore(
                    add(pMem, pEval_l1 ), 
                    mulmod(
                        mload(add(pMem, pEval_l1 )),
                        zh,
                        q
                    )
                )
                <% } else { %>
                mstore(
                    add(pMem, pEval_l<%=i%>), 
                    mulmod(
                        w,
                        mulmod(
                            mload(add(pMem, pEval_l<%=i%>)),
                            zh,
                            q
                        ),
                        q
                    )
                )
                <% } %>
                <% if (i<Math.max(nPublic, 1)) { %>
                w := mulmod(w, w1, q)
                <% } %>
                <% } %>


            }
            
            function calculatePl(pMem, pPub) {
                let pl := 0
                
                <% for (let i=0; i<nPublic; i++) { %> 
                pl := mod(
                    add(
                        sub(
                            pl,  
                            mulmod(
                                mload(add(pMem, pEval_l<%=i+1%>)),
                                mload(add(pPub, <%=32+i*32%>)),
                                q
                            )
                        ),
                        q
                    ),
                    q
                )
                <% } %>
                
                mstore(add(pMem, pPl), pl)
                

            }

            function calculateT(pProof, pMem) {
                let t
                let t1
                let t2
                t := addmod(
                    mload(add(pProof, pEval_r)), 
                    mload(add(pMem, pPl)), 
                    q
                )
                
                t1 := mulmod(
                    mload(add(pProof, pEval_s1)),
                    mload(add(pMem, pBeta)),
                    q
                )

                t1 := addmod(
                    t1,
                    mload(add(pProof, pEval_a)),
                    q
                )
                
                t1 := addmod(
                    t1,
                    mload(add(pMem, pGamma)),
                    q
                )

                t2 := mulmod(
                    mload(add(pProof, pEval_s2)),
                    mload(add(pMem, pBeta)),
                    q
                )

                t2 := addmod(
                    t2,
                    mload(add(pProof, pEval_b)),
                    q
                )
                
                t2 := addmod(
                    t2,
                    mload(add(pMem, pGamma)),
                    q
                )
                
                t1 := mulmod(t1, t2, q)
                
                t2 := addmod(
                    mload(add(pProof, pEval_c)),
                    mload(add(pMem, pGamma)),
                    q
                )

                t1 := mulmod(t1, t2, q)
                t1 := mulmod(t1, mload(add(pProof, pEval_zw)), q)
                t1 := mulmod(t1, mload(add(pMem, pAlpha)), q)
                
                t2 := mulmod(
                    mload(add(pMem, pEval_l1)), 
                    mload(add(pMem, pAlpha)), 
                    q
                )

                t2 := mulmod(
                    t2, 
                    mload(add(pMem, pAlpha)), 
                    q
                )

                t1 := addmod(t1, t2, q)
                
                t := mod(sub(add(t, q), t1), q)
                t := mulmod(t, mload(add(pMem, pZhInv)), q)
                
                mstore( add(pMem, pEval_t) , t)

            }
            
            function g1_set(pR, pP) {
                mstore(pR, mload(pP))
                mstore(add(pR, 32), mload(add(pP,32)))
            }

            function g1_acc(pR, pP) {
                let mIn := mload(0x40)
                mstore(mIn, mload(pR))
                mstore(add(mIn,32), mload(add(pR, 32)))
                mstore(add(mIn,64), mload(pP))
                mstore(add(mIn,96), mload(add(pP, 32)))

                let success := staticcall(sub(gas(), 2000), 6, mIn, 128, pR, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
            }

            function g1_mulAcc(pR, pP, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, mload(pP))
                mstore(add(mIn,32), mload(add(pP, 32)))
                mstore(add(mIn,64), s)

                success := staticcall(sub(gas(), 2000), 7, mIn, 96, mIn, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
                
                mstore(add(mIn,64), mload(pR))
                mstore(add(mIn,96), mload(add(pR, 32)))

                success := staticcall(sub(gas(), 2000), 6, mIn, 128, pR, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
                
            }

            function g1_mulAccC(pR, x, y, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x)
                mstore(add(mIn,32), y)
                mstore(add(mIn,64), s)

                success := staticcall(sub(gas(), 2000), 7, mIn, 96, mIn, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
                
                mstore(add(mIn,64), mload(pR))
                mstore(add(mIn,96), mload(add(pR, 32)))

                success := staticcall(sub(gas(), 2000), 6, mIn, 128, pR, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
            }

            function g1_mulSetC(pR, x, y, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x)
                mstore(add(mIn,32), y)
                mstore(add(mIn,64), s)

                success := staticcall(sub(gas(), 2000), 7, mIn, 96, pR, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
            }


            function calculateA1(pProof, pMem) {
                let p := add(pMem, pA1)
                g1_set(p, add(pProof, pWxi))
                g1_mulAcc(p, add(pProof, pWxiw), mload(add(pMem, pU)))
            }
            
            
            function calculateB1(pProof, pMem) {
                let s
                let s1
                let p := add(pMem, pB1)
                
                // Calculate D
                s := mulmod( mload(add(pProof, pEval_a)), mload(add(pMem, pV1)), q)
                g1_mulSetC(p, Qlx, Qly, s)

                s := mulmod( s, mload(add(pProof, pEval_b)), q)                
                g1_mulAccC(p, Qmx, Qmy, s)

                s := mulmod( mload(add(pProof, pEval_b)), mload(add(pMem, pV1)), q)
                g1_mulAccC(p, Qrx, Qry, s)
                
                s := mulmod( mload(add(pProof, pEval_c)), mload(add(pMem, pV1)), q)
                g1_mulAccC(p, Qox, Qoy, s)

                s :=mload(add(pMem, pV1))
                g1_mulAccC(p, Qcx, Qcy, s)

                s := addmod(mload(add(pProof, pEval_a)), mload(add(pMem, pBetaXi)), q)
                s := addmod(s, mload(add(pMem, pGamma)), q)
                s1 := mulmod(k1, mload(add(pMem, pBetaXi)), q)
                s1 := addmod(s1, mload(add(pProof, pEval_b)), q)
                s1 := addmod(s1, mload(add(pMem, pGamma)), q)
                s := mulmod(s, s1, q)
                s1 := mulmod(k2, mload(add(pMem, pBetaXi)), q)
                s1 := addmod(s1, mload(add(pProof, pEval_c)), q)
                s1 := addmod(s1, mload(add(pMem, pGamma)), q)
                s := mulmod(s, s1, q)
                s := mulmod(s, mload(add(pMem, pAlpha)), q)
                s := mulmod(s, mload(add(pMem, pV1)), q)
                s1 := mulmod(mload(add(pMem, pEval_l1)), mload(add(pMem, pAlpha)), q)
                s1 := mulmod(s1, mload(add(pMem, pAlpha)), q)
                s1 := mulmod(s1, mload(add(pMem, pV1)), q)
                s := addmod(s, s1, q)
                s := addmod(s, mload(add(pMem, pU)), q)
                g1_mulAcc(p, add(pProof, pZ), s)
                
                s := mulmod(mload(add(pMem, pBeta)), mload(add(pProof, pEval_s1)), q)
                s := addmod(s, mload(add(pProof, pEval_a)), q)
                s := addmod(s, mload(add(pMem, pGamma)), q)
                s1 := mulmod(mload(add(pMem, pBeta)), mload(add(pProof, pEval_s2)), q)
                s1 := addmod(s1, mload(add(pProof, pEval_b)), q)
                s1 := addmod(s1, mload(add(pMem, pGamma)), q)
                s := mulmod(s, s1, q)
                s := mulmod(s, mload(add(pMem, pAlpha)), q)
                s := mulmod(s, mload(add(pMem, pV1)), q)
                s := mulmod(s, mload(add(pMem, pBeta)), q)
                s := mulmod(s, mload(add(pProof, pEval_zw)), q)
                s := mod(sub(q, s), q)
                g1_mulAccC(p, S3x, S3y, s)


                // calculate F
                g1_acc(p , add(pProof, pT1))

                s := mload(add(pMem, pXin))
                g1_mulAcc(p, add(pProof, pT2), s)
                
                s := mulmod(s, s, q)
                g1_mulAcc(p, add(pProof, pT3), s)
                
                g1_mulAcc(p, add(pProof, pA), mload(add(pMem, pV2)))
                g1_mulAcc(p, add(pProof, pB), mload(add(pMem, pV3)))
                g1_mulAcc(p, add(pProof, pC), mload(add(pMem, pV4)))
                g1_mulAccC(p, S1x, S1y, mload(add(pMem, pV5)))
                g1_mulAccC(p, S2x, S2y, mload(add(pMem, pV6)))
                
                // calculate E
                s := mload(add(pMem, pEval_t))
                s := addmod(s, mulmod(mload(add(pProof, pEval_r)), mload(add(pMem, pV1)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_a)), mload(add(pMem, pV2)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_b)), mload(add(pMem, pV3)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_c)), mload(add(pMem, pV4)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_s1)), mload(add(pMem, pV5)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_s2)), mload(add(pMem, pV6)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_zw)), mload(add(pMem, pU)), q), q)
                s := mod(sub(q, s), q)
                g1_mulAccC(p, G1x, G1y, s)
                
                
                // Last part of B
                s := mload(add(pMem, pXi))
                g1_mulAcc(p, add(pProof, pWxi), s)

                s := mulmod(mload(add(pMem, pU)), mload(add(pMem, pXi)), q)
                s := mulmod(s, w1, q)
                g1_mulAcc(p, add(pProof, pWxiw), s)

            }
            
            function checkPairing(pMem) -> isOk {
                let mIn := mload(0x40)
                mstore(mIn, mload(add(pMem, pA1)))
                mstore(add(mIn,32), mload(add(add(pMem, pA1), 32)))
                mstore(add(mIn,64), X2x2)
                mstore(add(mIn,96), X2x1)
                mstore(add(mIn,128), X2y2)
                mstore(add(mIn,160), X2y1)
                mstore(add(mIn,192), mload(add(pMem, pB1)))
                let s := mload(add(add(pMem, pB1), 32))
                s := mod(sub(qf, s), qf)
                mstore(add(mIn,224), s)
                mstore(add(mIn,256), G2x2)
                mstore(add(mIn,288), G2x1)
                mstore(add(mIn,320), G2y2)
                mstore(add(mIn,352), G2y1)
                
                let success := staticcall(sub(gas(), 2000), 8, mIn, 384, mIn, 0x20)
                
                isOk := and(success, mload(mIn))
            }
            
            let pMem := mload(0x40)
            mstore(0x40, add(pMem, lastMem))
            
            checkInput(proof)
            calculateChallanges(proof, pMem)
            calculateLagrange(pMem)
            calculatePl(pMem, pubSignals)
            calculateT(proof, pMem)
            calculateA1(proof, pMem)
            calculateB1(proof, pMem)
            let isValid := checkPairing(pMem)
            
            mstore(0x40, sub(pMem, lastMem))
            mstore(0, isValid)
            return(0,0x20)
        }
        
    }
}`,a3='var snarkjs=function(t){"use strict";const e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function a(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}const i=a;function o(t,e){return BigInt(t)<<BigInt(e)}function n(t,e){return BigInt(t)>>BigInt(e)}const r=o,l=n;var c=Object.freeze({__proto__:null,fromString:a,e:i,fromArray:function(t,e){let a=BigInt(0);e=BigInt(e);for(let i=0;i<t.length;i++)a=a*e+BigInt(t[i]);return a},bitLength:function(t){const a=t.toString(16);return 4*(a.length-1)+e[parseInt(a[0],16)]},isNegative:function(t){return BigInt(t)<BigInt(0)},isZero:function(t){return!t},shiftLeft:o,shiftRight:n,shl:r,shr:l,isOdd:function(t){return(BigInt(t)&BigInt(1))==BigInt(1)},naf:function(t){let e=BigInt(t);const a=[];for(;e;){if(e&BigInt(1)){const t=2-Number(e%BigInt(4));a.push(t),e-=BigInt(t)}else a.push(0);e>>=BigInt(1)}return a},bits:function(t){let e=BigInt(t);const a=[];for(;e;)e&BigInt(1)?a.push(1):a.push(0),e>>=BigInt(1);return a},toNumber:function(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(t)},toArray:function(t,e){const a=[];let i=BigInt(t);for(e=BigInt(e);i;)a.unshift(Number(i%e)),i/=e;return a},add:function(t,e){return BigInt(t)+BigInt(e)},sub:function(t,e){return BigInt(t)-BigInt(e)},neg:function(t){return-BigInt(t)},mul:function(t,e){return BigInt(t)*BigInt(e)},square:function(t){return BigInt(t)*BigInt(t)},pow:function(t,e){return BigInt(t)**BigInt(e)},exp:function(t,e){return BigInt(t)**BigInt(e)},abs:function(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)},div:function(t,e){return BigInt(t)/BigInt(e)},mod:function(t,e){return BigInt(t)%BigInt(e)},eq:function(t,e){return BigInt(t)==BigInt(e)},neq:function(t,e){return BigInt(t)!=BigInt(e)},lt:function(t,e){return BigInt(t)<BigInt(e)},gt:function(t,e){return BigInt(t)>BigInt(e)},leq:function(t,e){return BigInt(t)<=BigInt(e)},geq:function(t,e){return BigInt(t)>=BigInt(e)},band:function(t,e){return BigInt(t)&BigInt(e)},bor:function(t,e){return BigInt(t)|BigInt(e)},bxor:function(t,e){return BigInt(t)^BigInt(e)},land:function(t,e){return BigInt(t)&&BigInt(e)},lor:function(t,e){return BigInt(t)||BigInt(e)},lnot:function(t){return!BigInt(t)}}),s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function d(t){var e={exports:{}};return t(e,e.exports),e.exports}var u=d((function(t){var e=function(t){var a=1e7,i=9007199254740992,o=g(i),n="0123456789abcdefghijklmnopqrstuvwxyz",r="function"==typeof BigInt;function l(t,e,a,i){return void 0===t?l[0]:void 0!==e&&(10!=+e||a)?K(t,e,a,i):Z(t)}function c(t,e){this.value=t,this.sign=e,this.isSmall=!1}function s(t){this.value=t,this.sign=t<0,this.isSmall=!0}function d(t){this.value=t}function u(t){return-i<t&&t<i}function g(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function f(t){_(t);var e=t.length;if(e<4&&S(t,o)<0)switch(e){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*a;default:return t[0]+(t[1]+t[2]*a)*a}return t}function _(t){for(var e=t.length;0===t[--e];);t.length=e+1}function p(t){for(var e=new Array(t),a=-1;++a<t;)e[a]=0;return e}function h(t){return t>0?Math.floor(t):Math.ceil(t)}function m(t,e){var i,o,n=t.length,r=e.length,l=new Array(n),c=0,s=a;for(o=0;o<r;o++)c=(i=t[o]+e[o]+c)>=s?1:0,l[o]=i-c*s;for(;o<n;)c=(i=t[o]+c)===s?1:0,l[o++]=i-c*s;return c>0&&l.push(c),l}function L(t,e){return t.length>=e.length?m(t,e):m(e,t)}function w(t,e){var i,o,n=t.length,r=new Array(n),l=a;for(o=0;o<n;o++)i=t[o]-l+e,e=Math.floor(i/l),r[o]=i-e*l,e+=1;for(;e>0;)r[o++]=e%l,e=Math.floor(e/l);return r}function A(t,e){var i,o,n=t.length,r=e.length,l=new Array(n),c=0,s=a;for(i=0;i<r;i++)(o=t[i]-c-e[i])<0?(o+=s,c=1):c=0,l[i]=o;for(i=r;i<n;i++){if(!((o=t[i]-c)<0)){l[i++]=o;break}o+=s,l[i]=o}for(;i<n;i++)l[i]=t[i];return _(l),l}function b(t,e,i){var o,n,r=t.length,l=new Array(r),d=-e,u=a;for(o=0;o<r;o++)n=t[o]+d,d=Math.floor(n/u),n%=u,l[o]=n<0?n+u:n;return"number"==typeof(l=f(l))?(i&&(l=-l),new s(l)):new c(l,i)}function y(t,e){var i,o,n,r,l=t.length,c=e.length,s=p(l+c),d=a;for(n=0;n<l;++n){r=t[n];for(var u=0;u<c;++u)i=r*e[u]+s[n+u],o=Math.floor(i/d),s[n+u]=i-o*d,s[n+u+1]+=o}return _(s),s}function I(t,e){var i,o,n=t.length,r=new Array(n),l=a,c=0;for(o=0;o<n;o++)i=t[o]*e+c,c=Math.floor(i/l),r[o]=i-c*l;for(;c>0;)r[o++]=c%l,c=Math.floor(c/l);return r}function C(t,e){for(var a=[];e-- >0;)a.push(0);return a.concat(t)}function F(t,e){var a=Math.max(t.length,e.length);if(a<=30)return y(t,e);a=Math.ceil(a/2);var i=t.slice(a),o=t.slice(0,a),n=e.slice(a),r=e.slice(0,a),l=F(o,r),c=F(i,n),s=F(L(o,i),L(r,n)),d=L(L(l,C(A(A(s,l),c),a)),C(c,2*a));return _(d),d}function x(t,e,i){return new c(t<a?I(e,t):y(e,g(t)),i)}function v(t){var e,i,o,n,r=t.length,l=p(r+r),c=a;for(o=0;o<r;o++){i=0-(n=t[o])*n;for(var s=o;s<r;s++)e=n*t[s]*2+l[o+s]+i,i=Math.floor(e/c),l[o+s]=e-i*c;l[o+r]=i}return _(l),l}function E(t,e){var a,i,o,n,r=t.length,l=p(r);for(o=0,a=r-1;a>=0;--a)o=(n=1e7*o+t[a])-(i=h(n/e))*e,l[a]=0|i;return[l,0|o]}function B(t,e){var i,o=Z(e);if(r)return[new d(t.value/o.value),new d(t.value%o.value)];var n,u=t.value,m=o.value;if(0===m)throw new Error("Cannot divide by zero");if(t.isSmall)return o.isSmall?[new s(h(u/m)),new s(u%m)]:[l[0],t];if(o.isSmall){if(1===m)return[t,l[0]];if(-1==m)return[t.negate(),l[0]];var L=Math.abs(m);if(L<a){n=f((i=E(u,L))[0]);var w=i[1];return t.sign&&(w=-w),"number"==typeof n?(t.sign!==o.sign&&(n=-n),[new s(n),new s(w)]):[new c(n,t.sign!==o.sign),new s(w)]}m=g(L)}var b=S(u,m);if(-1===b)return[l[0],t];if(0===b)return[l[t.sign===o.sign?1:-1],l[0]];i=u.length+m.length<=200?function(t,e){var i,o,n,r,l,c,s,d=t.length,u=e.length,g=a,_=p(e.length),h=e[u-1],m=Math.ceil(g/(2*h)),L=I(t,m),w=I(e,m);for(L.length<=d&&L.push(0),w.push(0),h=w[u-1],o=d-u;o>=0;o--){for(i=g-1,L[o+u]!==h&&(i=Math.floor((L[o+u]*g+L[o+u-1])/h)),n=0,r=0,c=w.length,l=0;l<c;l++)n+=i*w[l],s=Math.floor(n/g),r+=L[o+l]-(n-s*g),n=s,r<0?(L[o+l]=r+g,r=-1):(L[o+l]=r,r=0);for(;0!==r;){for(i-=1,n=0,l=0;l<c;l++)(n+=L[o+l]-g+w[l])<0?(L[o+l]=n+g,n=0):(L[o+l]=n,n=1);r+=n}_[o]=i}return L=E(L,m)[0],[f(_),f(L)]}(u,m):function(t,e){for(var i,o,n,r,l,c=t.length,s=e.length,d=[],u=[],g=a;c;)if(u.unshift(t[--c]),_(u),S(u,e)<0)d.push(0);else{n=u[(o=u.length)-1]*g+u[o-2],r=e[s-1]*g+e[s-2],o>s&&(n=(n+1)*g),i=Math.ceil(n/r);do{if(S(l=I(e,i),u)<=0)break;i--}while(i);d.push(i),u=A(u,l)}return d.reverse(),[f(d),f(u)]}(u,m),n=i[0];var y=t.sign!==o.sign,C=i[1],F=t.sign;return"number"==typeof n?(y&&(n=-n),n=new s(n)):n=new c(n,y),"number"==typeof C?(F&&(C=-C),C=new s(C)):C=new c(C,F),[n,C]}function S(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var a=t.length-1;a>=0;a--)if(t[a]!==e[a])return t[a]>e[a]?1:-1;return 0}function G(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function P(t,a){for(var i,o,n,r=t.prev(),l=r,c=0;l.isEven();)l=l.divide(2),c++;t:for(o=0;o<a.length;o++)if(!t.lesser(a[o])&&!(n=e(a[o]).modPow(l,t)).isUnit()&&!n.equals(r)){for(i=c-1;0!=i;i--){if((n=n.square().mod(t)).isUnit())return!1;if(n.equals(r))continue t}return!1}return!0}c.prototype=Object.create(l.prototype),s.prototype=Object.create(l.prototype),d.prototype=Object.create(l.prototype),c.prototype.add=function(t){var e=Z(t);if(this.sign!==e.sign)return this.subtract(e.negate());var a=this.value,i=e.value;return e.isSmall?new c(w(a,Math.abs(i)),this.sign):new c(L(a,i),this.sign)},c.prototype.plus=c.prototype.add,s.prototype.add=function(t){var e=Z(t),a=this.value;if(a<0!==e.sign)return this.subtract(e.negate());var i=e.value;if(e.isSmall){if(u(a+i))return new s(a+i);i=g(Math.abs(i))}return new c(w(i,Math.abs(a)),a<0)},s.prototype.plus=s.prototype.add,d.prototype.add=function(t){return new d(this.value+Z(t).value)},d.prototype.plus=d.prototype.add,c.prototype.subtract=function(t){var e=Z(t);if(this.sign!==e.sign)return this.add(e.negate());var a=this.value,i=e.value;return e.isSmall?b(a,Math.abs(i),this.sign):function(t,e,a){var i;return S(t,e)>=0?i=A(t,e):(i=A(e,t),a=!a),"number"==typeof(i=f(i))?(a&&(i=-i),new s(i)):new c(i,a)}(a,i,this.sign)},c.prototype.minus=c.prototype.subtract,s.prototype.subtract=function(t){var e=Z(t),a=this.value;if(a<0!==e.sign)return this.add(e.negate());var i=e.value;return e.isSmall?new s(a-i):b(i,Math.abs(a),a>=0)},s.prototype.minus=s.prototype.subtract,d.prototype.subtract=function(t){return new d(this.value-Z(t).value)},d.prototype.minus=d.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},s.prototype.negate=function(){var t=this.sign,e=new s(-this.value);return e.sign=!t,e},d.prototype.negate=function(){return new d(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},s.prototype.abs=function(){return new s(Math.abs(this.value))},d.prototype.abs=function(){return new d(this.value>=0?this.value:-this.value)},c.prototype.multiply=function(t){var e,i,o,n=Z(t),r=this.value,s=n.value,d=this.sign!==n.sign;if(n.isSmall){if(0===s)return l[0];if(1===s)return this;if(-1===s)return this.negate();if((e=Math.abs(s))<a)return new c(I(r,e),d);s=g(e)}return i=r.length,o=s.length,new c(-.012*i-.012*o+15e-6*i*o>0?F(r,s):y(r,s),d)},c.prototype.times=c.prototype.multiply,s.prototype._multiplyBySmall=function(t){return u(t.value*this.value)?new s(t.value*this.value):x(Math.abs(t.value),g(Math.abs(this.value)),this.sign!==t.sign)},c.prototype._multiplyBySmall=function(t){return 0===t.value?l[0]:1===t.value?this:-1===t.value?this.negate():x(Math.abs(t.value),this.value,this.sign!==t.sign)},s.prototype.multiply=function(t){return Z(t)._multiplyBySmall(this)},s.prototype.times=s.prototype.multiply,d.prototype.multiply=function(t){return new d(this.value*Z(t).value)},d.prototype.times=d.prototype.multiply,c.prototype.square=function(){return new c(v(this.value),!1)},s.prototype.square=function(){var t=this.value*this.value;return u(t)?new s(t):new c(v(g(Math.abs(this.value))),!1)},d.prototype.square=function(t){return new d(this.value*this.value)},c.prototype.divmod=function(t){var e=B(this,t);return{quotient:e[0],remainder:e[1]}},d.prototype.divmod=s.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(t){return B(this,t)[0]},d.prototype.over=d.prototype.divide=function(t){return new d(this.value/Z(t).value)},s.prototype.over=s.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(t){return B(this,t)[1]},d.prototype.mod=d.prototype.remainder=function(t){return new d(this.value%Z(t).value)},s.prototype.remainder=s.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(t){var e,a,i,o=Z(t),n=this.value,r=o.value;if(0===r)return l[1];if(0===n)return l[0];if(1===n)return l[1];if(-1===n)return o.isEven()?l[1]:l[-1];if(o.sign)return l[0];if(!o.isSmall)throw new Error("The exponent "+o.toString()+" is too large.");if(this.isSmall&&u(e=Math.pow(n,r)))return new s(h(e));for(a=this,i=l[1];!0&r&&(i=i.times(a),--r),0!==r;)r/=2,a=a.square();return i},s.prototype.pow=c.prototype.pow,d.prototype.pow=function(t){var e=Z(t),a=this.value,i=e.value,o=BigInt(0),n=BigInt(1),r=BigInt(2);if(i===o)return l[1];if(a===o)return l[0];if(a===n)return l[1];if(a===BigInt(-1))return e.isEven()?l[1]:l[-1];if(e.isNegative())return new d(o);for(var c=this,s=l[1];(i&n)===n&&(s=s.times(c),--i),i!==o;)i/=r,c=c.square();return s},c.prototype.modPow=function(t,e){if(t=Z(t),(e=Z(e)).isZero())throw new Error("Cannot take modPow with modulus 0");var a=l[1],i=this.mod(e);for(t.isNegative()&&(t=t.multiply(l[-1]),i=i.modInv(e));t.isPositive();){if(i.isZero())return l[0];t.isOdd()&&(a=a.multiply(i).mod(e)),t=t.divide(2),i=i.square().mod(e)}return a},d.prototype.modPow=s.prototype.modPow=c.prototype.modPow,c.prototype.compareAbs=function(t){var e=Z(t),a=this.value,i=e.value;return e.isSmall?1:S(a,i)},s.prototype.compareAbs=function(t){var e=Z(t),a=Math.abs(this.value),i=e.value;return e.isSmall?a===(i=Math.abs(i))?0:a>i?1:-1:-1},d.prototype.compareAbs=function(t){var e=this.value,a=Z(t).value;return(e=e>=0?e:-e)===(a=a>=0?a:-a)?0:e>a?1:-1},c.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Z(t),a=this.value,i=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:S(a,i)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,s.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Z(t),a=this.value,i=e.value;return e.isSmall?a==i?0:a>i?1:-1:a<0!==e.sign?a<0?-1:1:a<0?1:-1},s.prototype.compareTo=s.prototype.compare,d.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,a=Z(t).value;return e===a?0:e>a?1:-1},d.prototype.compareTo=d.prototype.compare,c.prototype.equals=function(t){return 0===this.compare(t)},d.prototype.eq=d.prototype.equals=s.prototype.eq=s.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(t){return 0!==this.compare(t)},d.prototype.neq=d.prototype.notEquals=s.prototype.neq=s.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(t){return this.compare(t)>0},d.prototype.gt=d.prototype.greater=s.prototype.gt=s.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(t){return this.compare(t)<0},d.prototype.lt=d.prototype.lesser=s.prototype.lt=s.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},d.prototype.geq=d.prototype.greaterOrEquals=s.prototype.geq=s.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},d.prototype.leq=d.prototype.lesserOrEquals=s.prototype.leq=s.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return 0==(1&this.value[0])},s.prototype.isEven=function(){return 0==(1&this.value)},d.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return 1==(1&this.value[0])},s.prototype.isOdd=function(){return 1==(1&this.value)},d.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},s.prototype.isPositive=function(){return this.value>0},d.prototype.isPositive=s.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},s.prototype.isNegative=function(){return this.value<0},d.prototype.isNegative=s.prototype.isNegative,c.prototype.isUnit=function(){return!1},s.prototype.isUnit=function(){return 1===Math.abs(this.value)},d.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},s.prototype.isZero=function(){return 0===this.value},d.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(t){var e=Z(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},d.prototype.isDivisibleBy=s.prototype.isDivisibleBy=c.prototype.isDivisibleBy,c.prototype.isPrime=function(a){var i=G(this);if(i!==t)return i;var o=this.abs(),n=o.bitLength();if(n<=64)return P(o,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var r=Math.log(2)*n.toJSNumber(),l=Math.ceil(!0===a?2*Math.pow(r,2):r),c=[],s=0;s<l;s++)c.push(e(s+2));return P(o,c)},d.prototype.isPrime=s.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(a,i){var o=G(this);if(o!==t)return o;for(var n=this.abs(),r=a===t?5:a,l=[],c=0;c<r;c++)l.push(e.randBetween(2,n.minus(2),i));return P(n,l)},d.prototype.isProbablePrime=s.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(t){for(var a,i,o,n=e.zero,r=e.one,l=Z(t),c=this.abs();!c.isZero();)a=l.divide(c),i=n,o=l,n=r,l=c,r=i.subtract(a.multiply(r)),c=o.subtract(a.multiply(c));if(!l.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===n.compare(0)&&(n=n.add(t)),this.isNegative()?n.negate():n},d.prototype.modInv=s.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var t=this.value;return this.sign?b(t,1,this.sign):new c(w(t,1),this.sign)},s.prototype.next=function(){var t=this.value;return t+1<i?new s(t+1):new c(o,!1)},d.prototype.next=function(){return new d(this.value+BigInt(1))},c.prototype.prev=function(){var t=this.value;return this.sign?new c(w(t,1),!0):b(t,1,this.sign)},s.prototype.prev=function(){var t=this.value;return t-1>-i?new s(t-1):new c(o,!0)},d.prototype.prev=function(){return new d(this.value-BigInt(1))};for(var O=[1];2*O[O.length-1]<=a;)O.push(2*O[O.length-1]);var U=O.length,z=O[U-1];function q(t){return Math.abs(t)<=a}function Q(t,a,i){a=Z(a);for(var o=t.isNegative(),n=a.isNegative(),r=o?t.not():t,l=n?a.not():a,c=0,s=0,d=null,u=null,g=[];!r.isZero()||!l.isZero();)c=(d=B(r,z))[1].toJSNumber(),o&&(c=z-1-c),s=(u=B(l,z))[1].toJSNumber(),n&&(s=z-1-s),r=d[0],l=u[0],g.push(i(c,s));for(var f=0!==i(o?1:0,n?1:0)?e(-1):e(0),_=g.length-1;_>=0;_-=1)f=f.multiply(z).add(e(g[_]));return f}c.prototype.shiftLeft=function(t){var e=Z(t).toJSNumber();if(!q(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var a=this;if(a.isZero())return a;for(;e>=U;)a=a.multiply(z),e-=U-1;return a.multiply(O[e])},d.prototype.shiftLeft=s.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(t){var e,a=Z(t).toJSNumber();if(!q(a))throw new Error(String(a)+" is too large for shifting.");if(a<0)return this.shiftLeft(-a);for(var i=this;a>=U;){if(i.isZero()||i.isNegative()&&i.isUnit())return i;i=(e=B(i,z))[1].isNegative()?e[0].prev():e[0],a-=U-1}return(e=B(i,O[a]))[1].isNegative()?e[0].prev():e[0]},d.prototype.shiftRight=s.prototype.shiftRight=c.prototype.shiftRight,c.prototype.not=function(){return this.negate().prev()},d.prototype.not=s.prototype.not=c.prototype.not,c.prototype.and=function(t){return Q(this,t,(function(t,e){return t&e}))},d.prototype.and=s.prototype.and=c.prototype.and,c.prototype.or=function(t){return Q(this,t,(function(t,e){return t|e}))},d.prototype.or=s.prototype.or=c.prototype.or,c.prototype.xor=function(t){return Q(this,t,(function(t,e){return t^e}))},d.prototype.xor=s.prototype.xor=c.prototype.xor;var M=1<<30;function k(t){var e=t.value,i="number"==typeof e?e|M:"bigint"==typeof e?e|BigInt(M):e[0]+e[1]*a|1073758208;return i&-i}function T(t,a){if(a.compareTo(t)<=0){var i=T(t,a.square(a)),o=i.p,n=i.e,r=o.multiply(a);return r.compareTo(t)<=0?{p:r,e:2*n+1}:{p:o,e:2*n}}return{p:e(1),e:0}}function R(t,e){return t=Z(t),e=Z(e),t.greater(e)?t:e}function N(t,e){return t=Z(t),e=Z(e),t.lesser(e)?t:e}function D(t,e){if(t=Z(t).abs(),e=Z(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var a,i,o=l[1];t.isEven()&&e.isEven();)a=N(k(t),k(e)),t=t.divide(a),e=e.divide(a),o=o.multiply(a);for(;t.isEven();)t=t.divide(k(t));do{for(;e.isEven();)e=e.divide(k(e));t.greater(e)&&(i=e,e=t,t=i),e=e.subtract(t)}while(!e.isZero());return o.isUnit()?t:t.multiply(o)}c.prototype.bitLength=function(){var t=this;return t.compareTo(e(0))<0&&(t=t.negate().subtract(e(1))),0===t.compareTo(e(0))?e(0):e(T(t,e(2)).e).add(e(1))},d.prototype.bitLength=s.prototype.bitLength=c.prototype.bitLength;var K=function(t,e,a,i){a=a||n,t=String(t),i||(t=t.toLowerCase(),a=a.toLowerCase());var o,r=t.length,l=Math.abs(e),c={};for(o=0;o<a.length;o++)c[a[o]]=o;for(o=0;o<r;o++){if("-"!==(u=t[o])&&(u in c&&c[u]>=l)){if("1"===u&&1===l)continue;throw new Error(u+" is not a valid digit in base "+e+".")}}e=Z(e);var s=[],d="-"===t[0];for(o=d?1:0;o<t.length;o++){var u;if((u=t[o])in c)s.push(Z(c[u]));else{if("<"!==u)throw new Error(u+" is not a valid character");var g=o;do{o++}while(">"!==t[o]&&o<t.length);s.push(Z(t.slice(g+1,o)))}}return V(s,e,d)};function V(t,e,a){var i,o=l[0],n=l[1];for(i=t.length-1;i>=0;i--)o=o.add(t[i].times(n)),n=n.times(e);return a?o.negate():o}function j(t,a){if((a=e(a)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(a.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var i=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return i.unshift([1]),{value:[].concat.apply([],i),isNegative:!1}}var o=!1;if(t.isNegative()&&a.isPositive()&&(o=!0,t=t.abs()),a.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:o};for(var n,r=[],l=t;l.isNegative()||l.compareAbs(a)>=0;){n=l.divmod(a),l=n.quotient;var c=n.remainder;c.isNegative()&&(c=a.minus(c).abs(),l=l.next()),r.push(c.toJSNumber())}return r.push(l.toJSNumber()),{value:r.reverse(),isNegative:o}}function H(t,e,a){var i=j(t,e);return(i.isNegative?"-":"")+i.value.map((function(t){return function(t,e){return t<(e=e||n).length?e[t]:"<"+t+">"}(t,a)})).join("")}function $(t){if(u(+t)){var e=+t;if(e===h(e))return r?new d(BigInt(e)):new s(e);throw new Error("Invalid integer: "+t)}var a="-"===t[0];a&&(t=t.slice(1));var i=t.split(/e/i);if(i.length>2)throw new Error("Invalid integer: "+i.join("e"));if(2===i.length){var o=i[1];if("+"===o[0]&&(o=o.slice(1)),(o=+o)!==h(o)||!u(o))throw new Error("Invalid integer: "+o+" is not a valid exponent.");var n=i[0],l=n.indexOf(".");if(l>=0&&(o-=n.length-l-1,n=n.slice(0,l)+n.slice(l+1)),o<0)throw new Error("Cannot include negative exponent part for integers");t=n+=new Array(o+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(r)return new d(BigInt(a?"-"+t:t));for(var g=[],f=t.length,p=f-7;f>0;)g.push(+t.slice(p,f)),(p-=7)<0&&(p=0),f-=7;return _(g),new c(g,a)}function Z(t){return"number"==typeof t?function(t){if(r)return new d(BigInt(t));if(u(t)){if(t!==h(t))throw new Error(t+" is not an integer.");return new s(t)}return $(t.toString())}(t):"string"==typeof t?$(t):"bigint"==typeof t?new d(t):t}c.prototype.toArray=function(t){return j(this,t)},s.prototype.toArray=function(t){return j(this,t)},d.prototype.toArray=function(t){return j(this,t)},c.prototype.toString=function(e,a){if(e===t&&(e=10),10!==e)return H(this,e,a);for(var i,o=this.value,n=o.length,r=String(o[--n]);--n>=0;)i=String(o[n]),r+="0000000".slice(i.length)+i;return(this.sign?"-":"")+r},s.prototype.toString=function(e,a){return e===t&&(e=10),10!=e?H(this,e,a):String(this.value)},d.prototype.toString=s.prototype.toString,d.prototype.toJSON=c.prototype.toJSON=s.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,s.prototype.valueOf=function(){return this.value},s.prototype.toJSNumber=s.prototype.valueOf,d.prototype.valueOf=d.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var Y=0;Y<1e3;Y++)l[Y]=Z(Y),Y>0&&(l[-Y]=Z(-Y));return l.one=l[1],l.zero=l[0],l.minusOne=l[-1],l.max=R,l.min=N,l.gcd=D,l.lcm=function(t,e){return t=Z(t).abs(),e=Z(e).abs(),t.divide(D(t,e)).multiply(e)},l.isInstance=function(t){return t instanceof c||t instanceof s||t instanceof d},l.randBetween=function(t,e,i){t=Z(t),e=Z(e);var o=i||Math.random,n=N(t,e),r=R(t,e).subtract(n).add(1);if(r.isSmall)return n.add(Math.floor(o()*r));for(var c=j(r,a).value,s=[],d=!0,u=0;u<c.length;u++){var g=d?c[u]+(u+1<c.length?c[u+1]/a:0):a,f=h(o()*g);s.push(f),f<c[u]&&(d=!1)}return n.add(l.fromArray(s,a,!1))},l.fromArray=function(t,e,a){return V(t.map(Z),Z(e||10),a)},l}();t.hasOwnProperty("exports")&&(t.exports=e)}));function g(t,e){return"string"==typeof t&&"0x"==t.slice(0,2)?u(t.slice(2),16):u(t,e)}const f=g;function _(t,e){return u(t).shiftLeft(e)}function p(t,e){return u(t).shiftRight(e)}const h=_,m=p;var L=Object.freeze({__proto__:null,fromString:g,e:f,fromArray:function(t,e){return u.fromArray(t,e)},bitLength:function(t){return u(t).bitLength()},isNegative:function(t){return u(t).isNegative()},isZero:function(t){return u(t).isZero()},shiftLeft:_,shiftRight:p,shl:h,shr:m,isOdd:function(t){return u(t).isOdd()},naf:function(t){let e=u(t);const a=[];for(;e.gt(u.zero);){if(e.isOdd()){const t=2-e.mod(4).toJSNumber();a.push(t),e=e.minus(t)}else a.push(0);e=e.shiftRight(1)}return a},bits:function(t){let e=u(t);const a=[];for(;e.gt(u.zero);)e.isOdd()?a.push(1):a.push(0),e=e.shiftRight(1);return a},toNumber:function(t){if(!t.lt(u("9007199254740992",10)))throw new Error("Number too big");return t.toJSNumber()},toArray:function(t,e){return u(t).toArray(e)},add:function(t,e){return u(t).add(u(e))},sub:function(t,e){return u(t).minus(u(e))},neg:function(t){return u.zero.minus(u(t))},mul:function(t,e){return u(t).times(u(e))},square:function(t){return u(t).square()},pow:function(t,e){return u(t).pow(u(e))},exp:function(t,e){return u(t).pow(u(e))},abs:function(t){return u(t).abs()},div:function(t,e){return u(t).divide(u(e))},mod:function(t,e){return u(t).mod(u(e))},eq:function(t,e){return u(t).eq(u(e))},neq:function(t,e){return u(t).neq(u(e))},lt:function(t,e){return u(t).lt(u(e))},gt:function(t,e){return u(t).gt(u(e))},leq:function(t,e){return u(t).leq(u(e))},geq:function(t,e){return u(t).geq(u(e))},band:function(t,e){return u(t).and(u(e))},bor:function(t,e){return u(t).or(u(e))},bxor:function(t,e){return u(t).xor(u(e))},land:function(t,e){return!u(t).isZero()&&!u(e).isZero()},lor:function(t,e){return!u(t).isZero()||!u(e).isZero()},lnot:function(t){return u(t).isZero()}});const w="function"==typeof BigInt;let A={};w?Object.assign(A,c):Object.assign(A,L),A.toRprLE=function(t,e,a,i){const o="0000000"+a.toString(16),n=new Uint32Array(t.buffer,e,i/4),r=1+(4*(o.length-7)-1>>5);for(let t=0;t<r;t++)n[t]=parseInt(o.substring(o.length-8*t-8,o.length-8*t),16);for(let t=r;t<n.length;t++)n[t]=0;for(let e=4*n.length;e<i;e++)t[e]=A.toNumber(A.band(A.shiftRight(a,8*e),255))},A.toRprBE=function(t,e,a,i){const o="0000000"+a.toString(16),n=new DataView(t.buffer,t.byteOffset+e,i),r=1+(4*(o.length-7)-1>>5);for(let t=0;t<r;t++)n.setUint32(i-4*t-4,parseInt(o.substring(o.length-8*t-8,o.length-8*t),16),!1);for(let t=0;t<i/4-r;t++)n[t]=0},A.fromRprLE=function(t,e,a){a=a||t.byteLength,e=e||0;const i=new Uint32Array(t.buffer,e,a/4),o=new Array(a/4);return i.forEach(((t,e)=>o[o.length-e-1]=t.toString(16).padStart(8,"0"))),A.fromString(o.join(""),16)},A.fromRprBE=function(t,e,a){a=a||t.byteLength,e=e||0;const i=new DataView(t.buffer,t.byteOffset+e,a),o=new Array(a/4);for(let t=0;t<a/4;t++)o[t]=i.getUint32(4*t,!1).toString(16).padStart(8,"0");return A.fromString(o.join(""),16)},A.toString=function(t,e){return t.toString(e)},A.toLEBuff=function(t){const e=new Uint8Array(Math.floor((A.bitLength(t)-1)/8)+1);return A.toRprLE(e,0,t,e.byteLength),e},A.zero=A.e(0),A.one=A.e(1);let{toRprLE:b,toRprBE:y,fromRprLE:I,fromRprBE:C,toString:F,toLEBuff:x,zero:v,one:E,fromString:B,e:S,fromArray:G,bitLength:P,isNegative:O,isZero:U,shiftLeft:z,shiftRight:q,shl:Q,shr:M,isOdd:k,naf:T,bits:R,toNumber:N,toArray:D,add:K,sub:V,neg:j,mul:H,square:$,pow:Z,exp:Y,abs:J,div:W,mod:X,eq:tt,neq:et,lt:at,gt:it,leq:ot,geq:nt,band:rt,bor:lt,bxor:ct,land:st,lor:dt,lnot:ut}=A;var gt=Object.freeze({__proto__:null,toRprLE:b,toRprBE:y,fromRprLE:I,fromRprBE:C,toString:F,toLEBuff:x,zero:v,one:E,fromString:B,e:S,fromArray:G,bitLength:P,isNegative:O,isZero:U,shiftLeft:z,shiftRight:q,shl:Q,shr:M,isOdd:k,naf:T,bits:R,toNumber:N,toArray:D,add:K,sub:V,neg:j,mul:H,square:$,pow:Z,exp:Y,abs:J,div:W,mod:X,eq:tt,neq:et,lt:at,gt:it,leq:ot,geq:nt,band:rt,bor:lt,bxor:ct,land:st,lor:dt,lnot:ut});const ft=[];for(let t=0;t<256;t++)ft[t]=_t(t,8);function _t(t,e){let a=0,i=t;for(let t=0;t<e;t++)a<<=1,a|=1&i,i>>=1;return a}function pt(t,e,a){if(U(a))return t.one;const i=R(a);if(0==i.legth)return t.one;let o=e;for(let a=i.length-2;a>=0;a--)o=t.square(o),i[a]&&(o=t.mul(o,e));return o}function ht(t){if(t.m%2==1)if(tt(X(t.p,4),1))if(tt(X(t.p,8),1))if(tt(X(t.p,16),1))!function(t){t.sqrt_q=Z(t.p,t.m),t.sqrt_s=0,t.sqrt_t=V(t.sqrt_q,1);for(;!k(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=W(t.sqrt_t,2);let e=t.one;for(;t.eq(e,t.one);){const a=t.random();t.sqrt_z=t.pow(a,t.sqrt_t),e=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=W(V(t.sqrt_t,1),2),t.sqrt=function(t){const e=this;if(e.isZero(t))return e.zero;let a=e.pow(t,e.sqrt_tm1d2);const i=e.pow(e.mul(e.square(a),t),2**(e.sqrt_s-1));if(e.eq(i,e.negone))return null;let o=e.sqrt_s,n=e.mul(t,a),r=e.mul(n,a),l=e.sqrt_z;for(;!e.eq(r,e.one);){let t=e.square(r),i=1;for(;!e.eq(t,e.one);)t=e.square(t),i++;a=l;for(let t=0;t<o-i-1;t++)a=e.square(a);l=e.square(a),r=e.mul(r,l),n=e.mul(n,a),o=i}return e.geq(n,e.zero)?n:e.neg(n)}}(t);else{if(!tt(X(t.p,16),9))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}(t)}else{if(!tt(X(t.p,8),5))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}(t)}else tt(X(t.p,4),3)&&function(t){t.sqrt_q=Z(t.p,t.m),t.sqrt_e1=W(V(t.sqrt_q,3),4),t.sqrt=function(e){if(this.isZero(e))return this.zero;const a=this.pow(e,this.sqrt_e1),i=this.mul(this.square(a),e);if(this.eq(i,this.negone))return null;const o=this.mul(a,e);return t.geq(o,t.zero)?o:t.neg(o)}}(t);else{const e=X(Z(t.p,t.m/2),4);1==e?function(t){t.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}(t):3==e?function(t){t.sqrt_q=Z(t.p,t.m/2),t.sqrt_e34=W(V(t.sqrt_q,3),4),t.sqrt_e12=W(V(t.sqrt_q,1),2),t.frobenius=function(e,a){return e%2==1?t.conjugate(a):a},t.sqrt=function(t){const e=this,a=e.pow(t,e.sqrt_e34),i=e.mul(e.square(a),t),o=e.mul(e.frobenius(1,i),i);if(e.eq(o,e.negone))return null;const n=e.mul(a,t);let r;if(e.eq(i,e.negone))r=e.mul(n,[e.F.zero,e.F.one]);else{const t=e.pow(e.add(e.one,i),e.sqrt_e12);r=e.mul(t,n)}return e.geq(r,e.zero)?r:e.neg(r)}}(t):function(t){t.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}(t)}}function mt(t,e,a,i,o){t[e]=t[e]+t[a]>>>0,t[o]=(t[o]^t[e])>>>0,t[o]=(t[o]<<16|t[o]>>>16&65535)>>>0,t[i]=t[i]+t[o]>>>0,t[a]=(t[a]^t[i])>>>0,t[a]=(t[a]<<12|t[a]>>>20&4095)>>>0,t[e]=t[e]+t[a]>>>0,t[o]=(t[o]^t[e])>>>0,t[o]=(t[o]<<8|t[o]>>>24&255)>>>0,t[i]=t[i]+t[o]>>>0,t[a]=(t[a]^t[i])>>>0,t[a]=(t[a]<<7|t[a]>>>25&127)>>>0}class Lt{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return K(H(this.nextU32(),4294967296),this.nextU32())}nextBool(){return 1==(1&this.nextU32())}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let e=0;e<10;e++)mt(t=this.buff,0,4,8,12),mt(t,1,5,9,13),mt(t,2,6,10,14),mt(t,3,7,11,15),mt(t,0,5,10,15),mt(t,1,6,11,12),mt(t,2,7,8,13),mt(t,3,4,9,14);var t;for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}var wt={};function At(t){let e=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(e);else for(let a=0;a<t;a++)e[a]=4294967296*Math.random()>>>0;return e}let bt=null;function yt(){return bt||(bt=new Lt(function(){const t=At(32),e=new Uint32Array(t.buffer),a=[];for(let t=0;t<8;t++)a.push(e[t]);return a}()),bt)}class It{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=P(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const e=this.negone>>this.one;this.nqr=this.two;let a=this.pow(this.nqr,e);for(;!this.eq(a,this.negone);)this.nqr=this.nqr+this.one,a=this.pow(this.nqr,e);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),ht(this)}e(t,e){let a;if(e?16==e&&(a=BigInt("0x"+t)):a=BigInt(t),a<0){let t=-a;return t>=this.p&&(t%=this.p),this.p-t}return a>=this.p?a%this.p:a}add(t,e){const a=t+e;return a>=this.p?a-this.p:a}sub(t,e){return t>=e?t-e:this.p-e+t}neg(t){return t?this.p-t:t}mul(t,e){return t*e%this.p}mulScalar(t,e){return t*this.e(e)%this.p}square(t){return t*t%this.p}eq(t,e){return t==e}neq(t,e){return t!=e}lt(t,e){return(t>this.half?t-this.p:t)<(e>this.half?e-this.p:e)}gt(t,e){return(t>this.half?t-this.p:t)>(e>this.half?e-this.p:e)}leq(t,e){return(t>this.half?t-this.p:t)<=(e>this.half?e-this.p:e)}geq(t,e){return(t>this.half?t-this.p:t)>=(e>this.half?e-this.p:e)}div(t,e){return this.mul(t,this.inv(e))}idiv(t,e){if(!e)throw new Error("Division by zero");return t/e}inv(t){if(!t)throw new Error("Division by zero");let e=this.zero,a=this.p,i=this.one,o=t%this.p;for(;o;){let t=a/o;[e,i]=[i,e-t*i],[a,o]=[o,a-t*o]}return e<this.zero&&(e+=this.p),e}mod(t,e){return t%e}pow(t,e){return pt(this,t,e)}exp(t,e){return pt(this,t,e)}band(t,e){const a=t&e&this.mask;return a>=this.p?a-this.p:a}bor(t,e){const a=(t|e)&this.mask;return a>=this.p?a-this.p:a}bxor(t,e){const a=(t^e)&this.mask;return a>=this.p?a-this.p:a}bnot(t){const e=t^this.mask;return e>=this.p?e-this.p:e}shl(t,e){if(Number(e)<this.bitLength){const a=t<<e&this.mask;return a>=this.p?a-this.p:a}{const a=this.p-e;return Number(a)<this.bitLength?t>>a:this.zero}}shr(t,e){if(Number(e)<this.bitLength)return t>>e;{const a=this.p-e;if(Number(a)<this.bitLength){const e=t<<a&this.mask;return e>=this.p?e-this.p:e}return 0}}land(t,e){return t&&e?this.one:this.zero}lor(t,e){return t||e?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let e=this.s,a=this.nqr_to_t,i=this.pow(t,this.t),o=this.pow(t,this.add(this.t,this.one)>>this.one);for(;i!=this.one;){let t=this.square(i),n=1;for(;t!=this.one;)n++,t=this.square(t);let r=a;for(let t=0;t<e-n-1;t++)r=this.square(r);e=n,a=this.square(r),i=this.mul(i,a),o=this.mul(o,r)}return o>this.p>>this.one&&(o=this.neg(o)),o}normalize(t,e){if((t=BigInt(t,e))<0){let e=-t;return e>=this.p&&(e%=this.p),this.p-e}return t>=this.p?t%this.p:t}random(){const t=2*this.bitLength/8;let e=this.zero;for(let a=0;a<t;a++)e=(e<<BigInt(8))+BigInt(At(1)[0]);return e%this.p}toString(t,e){let a;if(t>this.half){a="-"+(this.p-t).toString(e)}else a=t.toString(e);return a}isZero(t){return t==this.zero}fromRng(t){let e;do{e=this.zero;for(let a=0;a<this.n64;a++)e+=t.nextU64()<<BigInt(64*a);e&=this.mask}while(e>=this.p);return e=e*this.Ri%this.p,e}}class Ct{constructor(t){this.type="F1",this.one=u.one,this.zero=u.zero,this.p=u(t),this.m=1,this.negone=this.p.minus(u.one),this.two=u(2),this.half=this.p.shiftRight(1),this.bitLength=this.p.bitLength(),this.mask=u.one.shiftLeft(this.bitLength).minus(u.one),this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=u.one.shiftLeft(64*this.n64),this.Ri=this.inv(this.R);const e=this.negone.shiftRight(this.one);this.nqr=this.two;let a=this.pow(this.nqr,e);for(;!a.equals(this.negone);)this.nqr=this.nqr.add(this.one),a=this.pow(this.nqr,e);for(this.s=this.zero,this.t=this.negone;!this.t.isOdd();)this.s=this.s.add(this.one),this.t=this.t.shiftRight(this.one);this.nqr_to_t=this.pow(this.nqr,this.t),ht(this)}e(t,e){const a=u(t,e);return this.normalize(a)}add(t,e){let a=t.add(e);return a.geq(this.p)&&(a=a.minus(this.p)),a}sub(t,e){return t.geq(e)?t.minus(e):this.p.minus(e.minus(t))}neg(t){return t.isZero()?t:this.p.minus(t)}mul(t,e){return t.times(e).mod(this.p)}mulScalar(t,e){return t.times(u(e)).mod(this.p)}square(t){return t.square().mod(this.p)}eq(t,e){return t.eq(e)}neq(t,e){return t.neq(e)}lt(t,e){const a=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return a.lt(i)}gt(t,e){const a=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return a.gt(i)}leq(t,e){const a=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return a.leq(i)}geq(t,e){const a=t.gt(this.half)?t.minus(this.p):t,i=e.gt(this.half)?e.minus(this.p):e;return a.geq(i)}div(t,e){if(e.isZero())throw new Error("Division by zero");return t.times(e.modInv(this.p)).mod(this.p)}idiv(t,e){if(e.isZero())throw new Error("Division by zero");return t.divide(e)}inv(t){if(t.isZero())throw new Error("Division by zero");return t.modInv(this.p)}mod(t,e){return t.mod(e)}pow(t,e){return t.modPow(e,this.p)}exp(t,e){return t.modPow(e,this.p)}band(t,e){return t.and(e).and(this.mask).mod(this.p)}bor(t,e){return t.or(e).and(this.mask).mod(this.p)}bxor(t,e){return t.xor(e).and(this.mask).mod(this.p)}bnot(t){return t.xor(this.mask).mod(this.p)}shl(t,e){if(e.lt(this.bitLength))return t.shiftLeft(e).and(this.mask).mod(this.p);{const a=this.p.minus(e);return a.lt(this.bitLength)?this.shr(t,a):u.zero}}shr(t,e){if(e.lt(this.bitLength))return t.shiftRight(e);{const a=this.p.minus(e);return a.lt(this.bitLength)?this.shl(t,a):u.zero}}land(t,e){return t.isZero()||e.isZero()?u.zero:u.one}lor(t,e){return t.isZero()&&e.isZero()?u.zero:u.one}lnot(t){return t.isZero()?u.one:u.zero}sqrt_old(t){if(t.equals(this.zero))return this.zero;if(!this.pow(t,this.negone.shiftRight(this.one)).equals(this.one))return null;let e=parseInt(this.s),a=this.nqr_to_t,i=this.pow(t,this.t),o=this.pow(t,this.add(this.t,this.one).shiftRight(this.one));for(;!i.equals(this.one);){let t=this.square(i),n=1;for(;!t.equals(this.one);)n++,t=this.square(t);let r=a;for(let t=0;t<e-n-1;t++)r=this.square(r);e=n,a=this.square(r),i=this.mul(i,a),o=this.mul(o,r)}return o.greater(this.p.shiftRight(this.one))&&(o=this.neg(o)),o}normalize(t){return(t=u(t)).isNegative()?this.p.minus(t.abs().mod(this.p)):t.mod(this.p)}random(){let t=u(0),e=u(this.p.square());for(;!e.isZero();)t=t.shiftLeft(8).add(u(At(1)[0])),e=e.shiftRight(8);return t.mod(this.p)}toString(t,e){let a;if(t.lesserOrEquals(this.p.shiftRight(u(1))))a=t.toString(e);else{a="-"+this.p.minus(t).toString(e)}return a}isZero(t){return t.isZero()}fromRng(t){let e;do{e=u(0);for(let a=0;a<this.n64;a++)e=e.add(e,t.nextU64().shiftLeft(64*a));e=e.and(this.mask)}while(e.geq(this.p));return e=e.times(this.Ri).mod(this.q),e}}const Ft="function"==typeof BigInt;let xt;xt=Ft?It:Ct;class vt extends xt{toRprLE(t,e,a){b(t,e,a,8*this.n64)}toRprBE(t,e,a){y(t,e,a,8*this.n64)}toRprBEM(t,e,a){return this.toRprBE(t,e,this.mul(this.R,a))}toRprLEM(t,e,a){return this.toRprLE(t,e,this.mul(this.R,a))}fromRprLE(t,e){return I(t,e,this.n8)}fromRprBE(t,e){return C(t,e,this.n8)}fromRprLEM(t,e){return this.mul(this.fromRprLE(t,e),this.Ri)}fromRprBEM(t,e){return this.mul(this.fromRprBE(t,e),this.Ri)}}var Et=function(t,e){const a=Array(e);let i=u(t);for(let t=0;t<e;t++)a[t]=i.and(255).toJSNumber(),i=i.shiftRight(8);return a},Bt=function(t,e,a){const i=a||"int";if(t.modules[i])return i;t.modules[i]={};const o=2*e,n=8*e;return t.alloc(n,Et(1,n)),function(){const a=t.addFunction(i+"_copy");a.addParam("px","i32"),a.addParam("pr","i32");const o=a.getCodeBuilder();for(let t=0;t<e;t++)a.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_load(o.getLocal("px"),8*t)))}(),function(){const a=t.addFunction(i+"_zero");a.addParam("pr","i32");const o=a.getCodeBuilder();for(let t=0;t<e;t++)a.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_const(0)))}(),function(){const a=t.addFunction(i+"_isZero");a.addParam("px","i32"),a.setReturnType("i32");const o=a.getCodeBuilder();a.addCode(function t(e){return 0==e?o.ret(o.i64_eqz(o.i64_load(o.getLocal("px")))):o.if(o.i64_eqz(o.i64_load(o.getLocal("px"),8*e)),t(e-1),o.ret(o.i32_const(0)))}(e-1)),a.addCode(o.ret(o.i32_const(0)))}(),function(){const a=t.addFunction(i+"_one");a.addParam("pr","i32");const o=a.getCodeBuilder();a.addCode(o.i64_store(o.getLocal("pr"),0,o.i64_const(1)));for(let t=1;t<e;t++)a.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_const(0)))}(),function(){const a=t.addFunction(i+"_eq");a.addParam("px","i32"),a.addParam("py","i32"),a.setReturnType("i32");const o=a.getCodeBuilder();a.addCode(function t(e){return 0==e?o.ret(o.i64_eq(o.i64_load(o.getLocal("px")),o.i64_load(o.getLocal("py")))):o.if(o.i64_eq(o.i64_load(o.getLocal("px"),8*e),o.i64_load(o.getLocal("py"),8*e)),t(e-1),o.ret(o.i32_const(0)))}(e-1)),a.addCode(o.ret(o.i32_const(0)))}(),function(){const a=t.addFunction(i+"_gte");a.addParam("px","i32"),a.addParam("py","i32"),a.setReturnType("i32");const o=a.getCodeBuilder();a.addCode(function t(e){return 0==e?o.ret(o.i64_ge_u(o.i64_load(o.getLocal("px")),o.i64_load(o.getLocal("py")))):o.if(o.i64_lt_u(o.i64_load(o.getLocal("px"),8*e),o.i64_load(o.getLocal("py"),8*e)),o.ret(o.i32_const(0)),o.if(o.i64_gt_u(o.i64_load(o.getLocal("px"),8*e),o.i64_load(o.getLocal("py"),8*e)),o.ret(o.i32_const(1)),t(e-1)))}(e-1)),a.addCode(o.ret(o.i32_const(0)))}(),function(){const e=t.addFunction(i+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.setReturnType("i32"),e.addLocal("c","i64");const a=e.getCodeBuilder();e.addCode(a.setLocal("c",a.i64_add(a.i64_load32_u(a.getLocal("x")),a.i64_load32_u(a.getLocal("y"))))),e.addCode(a.i64_store32(a.getLocal("r"),a.getLocal("c")));for(let t=1;t<o;t++)e.addCode(a.setLocal("c",a.i64_add(a.i64_add(a.i64_load32_u(a.getLocal("x"),4*t),a.i64_load32_u(a.getLocal("y"),4*t)),a.i64_shr_u(a.getLocal("c"),a.i64_const(32))))),e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.getLocal("c")));e.addCode(a.i32_wrap_i64(a.i64_shr_u(a.getLocal("c"),a.i64_const(32))))}(),function(){const e=t.addFunction(i+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.setReturnType("i32"),e.addLocal("c","i64");const a=e.getCodeBuilder();e.addCode(a.setLocal("c",a.i64_sub(a.i64_load32_u(a.getLocal("x")),a.i64_load32_u(a.getLocal("y"))))),e.addCode(a.i64_store32(a.getLocal("r"),a.i64_and(a.getLocal("c"),a.i64_const("0xFFFFFFFF"))));for(let t=1;t<o;t++)e.addCode(a.setLocal("c",a.i64_add(a.i64_sub(a.i64_load32_u(a.getLocal("x"),4*t),a.i64_load32_u(a.getLocal("y"),4*t)),a.i64_shr_s(a.getLocal("c"),a.i64_const(32))))),e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.i64_and(a.getLocal("c"),a.i64_const("0xFFFFFFFF"))));e.addCode(a.i32_wrap_i64(a.i64_shr_s(a.getLocal("c"),a.i64_const(32))))}(),function(){const e=t.addFunction(i+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64");for(let t=0;t<o;t++)e.addLocal("x"+t,"i64"),e.addLocal("y"+t,"i64");const a=e.getCodeBuilder(),n=[],r=[];function l(t,e){let i,o;return n[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),n[t]=!0),r[e]?o=a.getLocal("y"+e):(o=a.teeLocal("y"+e,a.i64_load32_u(a.getLocal("y"),4*e)),r[e]=!0),a.i64_mul(i,o)}let c="c0",s="c1";for(let t=0;t<2*o-1;t++){for(let i=Math.max(0,t-o+1);i<=t&&i<o;i++){const o=t-i;e.addCode(a.setLocal(c,a.i64_add(a.i64_and(a.getLocal(c),a.i64_const(4294967295)),l(i,o)))),e.addCode(a.setLocal(s,a.i64_add(a.getLocal(s),a.i64_shr_u(a.getLocal(c),a.i64_const(32)))))}e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.getLocal(c))),[c,s]=[s,c],e.addCode(a.setLocal(s,a.i64_shr_u(a.getLocal(c),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),4*o*2-4,a.getLocal(c)))}(),function(){const e=t.addFunction(i+"_square");e.addParam("x","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("c0_old","i64"),e.addLocal("c1_old","i64");for(let t=0;t<o;t++)e.addLocal("x"+t,"i64");const a=e.getCodeBuilder(),n=[];function r(t,e){let i,o;return n[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),n[t]=!0),n[e]?o=a.getLocal("x"+e):(o=a.teeLocal("x"+e,a.i64_load32_u(a.getLocal("x"),4*e)),n[e]=!0),a.i64_mul(i,o)}let l="c0",c="c1",s="c0_old",d="c1_old";for(let t=0;t<2*o-1;t++){e.addCode(a.setLocal(l,a.i64_const(0)),a.setLocal(c,a.i64_const(0)));for(let i=Math.max(0,t-o+1);i<t+1>>1&&i<o;i++){const o=t-i;e.addCode(a.setLocal(l,a.i64_add(a.i64_and(a.getLocal(l),a.i64_const(4294967295)),r(i,o)))),e.addCode(a.setLocal(c,a.i64_add(a.getLocal(c),a.i64_shr_u(a.getLocal(l),a.i64_const(32)))))}e.addCode(a.setLocal(l,a.i64_shl(a.i64_and(a.getLocal(l),a.i64_const(4294967295)),a.i64_const(1)))),e.addCode(a.setLocal(c,a.i64_add(a.i64_shl(a.getLocal(c),a.i64_const(1)),a.i64_shr_u(a.getLocal(l),a.i64_const(32))))),t%2==0&&(e.addCode(a.setLocal(l,a.i64_add(a.i64_and(a.getLocal(l),a.i64_const(4294967295)),r(t>>1,t>>1)))),e.addCode(a.setLocal(c,a.i64_add(a.getLocal(c),a.i64_shr_u(a.getLocal(l),a.i64_const(32)))))),t>0&&(e.addCode(a.setLocal(l,a.i64_add(a.i64_and(a.getLocal(l),a.i64_const(4294967295)),a.i64_and(a.getLocal(s),a.i64_const(4294967295))))),e.addCode(a.setLocal(c,a.i64_add(a.i64_add(a.getLocal(c),a.i64_shr_u(a.getLocal(l),a.i64_const(32))),a.getLocal(d))))),e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.getLocal(l))),e.addCode(a.setLocal(s,a.getLocal(c)),a.setLocal(d,a.i64_shr_u(a.getLocal(s),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),4*o*2-4,a.getLocal(s)))}(),function(){const e=t.addFunction(i+"_squareOld");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(i+"_mul",a.getLocal("x"),a.getLocal("x"),a.getLocal("r")))}(),function(){!function(){const e=t.addFunction(i+"__mul1");e.addParam("px","i32"),e.addParam("y","i64"),e.addParam("pr","i32"),e.addLocal("c","i64");const a=e.getCodeBuilder();e.addCode(a.setLocal("c",a.i64_mul(a.i64_load32_u(a.getLocal("px"),0,0),a.getLocal("y")))),e.addCode(a.i64_store32(a.getLocal("pr"),0,0,a.getLocal("c")));for(let t=1;t<o;t++)e.addCode(a.setLocal("c",a.i64_add(a.i64_mul(a.i64_load32_u(a.getLocal("px"),4*t,0),a.getLocal("y")),a.i64_shr_u(a.getLocal("c"),a.i64_const(32))))),e.addCode(a.i64_store32(a.getLocal("pr"),4*t,0,a.getLocal("c")))}(),function(){const e=t.addFunction(i+"__add1");e.addParam("x","i32"),e.addParam("y","i64"),e.addLocal("c","i64"),e.addLocal("px","i32");const a=e.getCodeBuilder();e.addCode(a.setLocal("px",a.getLocal("x"))),e.addCode(a.setLocal("c",a.i64_add(a.i64_load32_u(a.getLocal("px"),0,0),a.getLocal("y")))),e.addCode(a.i64_store32(a.getLocal("px"),0,0,a.getLocal("c"))),e.addCode(a.setLocal("c",a.i64_shr_u(a.getLocal("c"),a.i64_const(32)))),e.addCode(a.block(a.loop(a.br_if(1,a.i64_eqz(a.getLocal("c"))),a.setLocal("px",a.i32_add(a.getLocal("px"),a.i32_const(4))),a.setLocal("c",a.i64_add(a.i64_load32_u(a.getLocal("px"),0,0),a.getLocal("c"))),a.i64_store32(a.getLocal("px"),0,0,a.getLocal("c")),a.setLocal("c",a.i64_shr_u(a.getLocal("c"),a.i64_const(32))),a.br(0))))}();const e=t.addFunction(i+"_div");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("c","i32"),e.addParam("r","i32"),e.addLocal("rr","i32"),e.addLocal("cc","i32"),e.addLocal("eX","i32"),e.addLocal("eY","i32"),e.addLocal("sy","i64"),e.addLocal("sx","i64"),e.addLocal("ec","i32");const a=e.getCodeBuilder(),r=a.i32_const(t.alloc(n)),l=a.i32_const(t.alloc(n)),c=a.i32_const(t.alloc(n)),s=a.getLocal("cc"),d=a.getLocal("rr"),u=t.alloc(2*n),g=a.i32_const(u),f=a.i32_const(u+n);e.addCode(a.if(a.getLocal("c"),a.setLocal("cc",a.getLocal("c")),a.setLocal("cc",l))),e.addCode(a.if(a.getLocal("r"),a.setLocal("rr",a.getLocal("r")),a.setLocal("rr",c))),e.addCode(a.call(i+"_copy",a.getLocal("x"),d)),e.addCode(a.call(i+"_copy",a.getLocal("y"),r)),e.addCode(a.call(i+"_zero",s)),e.addCode(a.call(i+"_zero",g)),e.addCode(a.setLocal("eX",a.i32_const(n-1))),e.addCode(a.setLocal("eY",a.i32_const(n-1))),e.addCode(a.block(a.loop(a.br_if(1,a.i32_or(a.i32_load8_u(a.i32_add(r,a.getLocal("eY")),0,0),a.i32_eq(a.getLocal("eY"),a.i32_const(3)))),a.setLocal("eY",a.i32_sub(a.getLocal("eY"),a.i32_const(1))),a.br(0)))),e.addCode(a.setLocal("sy",a.i64_add(a.i64_load32_u(a.i32_sub(a.i32_add(r,a.getLocal("eY")),a.i32_const(3)),0,0),a.i64_const(1)))),e.addCode(a.if(a.i64_eq(a.getLocal("sy"),a.i64_const(1)),a.drop(a.i64_div_u(a.i64_const(0),a.i64_const(0))))),e.addCode(a.block(a.loop(a.block(a.loop(a.br_if(1,a.i32_or(a.i32_load8_u(a.i32_add(d,a.getLocal("eX")),0,0),a.i32_eq(a.getLocal("eX"),a.i32_const(7)))),a.setLocal("eX",a.i32_sub(a.getLocal("eX"),a.i32_const(1))),a.br(0))),a.setLocal("sx",a.i64_load(a.i32_sub(a.i32_add(d,a.getLocal("eX")),a.i32_const(7)),0,0)),a.setLocal("sx",a.i64_div_u(a.getLocal("sx"),a.getLocal("sy"))),a.setLocal("ec",a.i32_sub(a.i32_sub(a.getLocal("eX"),a.getLocal("eY")),a.i32_const(4))),a.block(a.loop(a.br_if(1,a.i32_and(a.i64_eqz(a.i64_and(a.getLocal("sx"),a.i64_const("0xFFFFFFFF00000000"))),a.i32_ge_s(a.getLocal("ec"),a.i32_const(0)))),a.setLocal("sx",a.i64_shr_u(a.getLocal("sx"),a.i64_const(8))),a.setLocal("ec",a.i32_add(a.getLocal("ec"),a.i32_const(1))),a.br(0))),a.if(a.i64_eqz(a.getLocal("sx")),[...a.br_if(2,a.i32_eqz(a.call(i+"_gte",d,r))),...a.setLocal("sx",a.i64_const(1)),...a.setLocal("ec",a.i32_const(0))]),a.call(i+"__mul1",r,a.getLocal("sx"),f),a.drop(a.call(i+"_sub",d,a.i32_sub(f,a.getLocal("ec")),d)),a.call(i+"__add1",a.i32_add(s,a.getLocal("ec")),a.getLocal("sx")),a.br(0))))}(),function(){const e=t.addFunction(i+"_inverseMod");e.addParam("px","i32"),e.addParam("pm","i32"),e.addParam("pr","i32"),e.addLocal("t","i32"),e.addLocal("newt","i32"),e.addLocal("r","i32"),e.addLocal("qq","i32"),e.addLocal("qr","i32"),e.addLocal("newr","i32"),e.addLocal("swp","i32"),e.addLocal("x","i32"),e.addLocal("signt","i32"),e.addLocal("signnewt","i32"),e.addLocal("signx","i32");const a=e.getCodeBuilder(),o=a.i32_const(t.alloc(n)),r=a.i32_const(t.alloc(n)),l=a.i32_const(t.alloc(n)),c=a.i32_const(t.alloc(n)),s=a.i32_const(t.alloc(n)),d=a.i32_const(t.alloc(n)),u=a.i32_const(t.alloc(2*n)),g=a.i32_const(t.alloc(n));e.addCode(a.setLocal("t",o),a.call(i+"_zero",o),a.setLocal("signt",a.i32_const(0))),e.addCode(a.setLocal("r",r),a.call(i+"_copy",a.getLocal("pm"),r)),e.addCode(a.setLocal("newt",l),a.call(i+"_one",l),a.setLocal("signnewt",a.i32_const(0))),e.addCode(a.setLocal("newr",c),a.call(i+"_copy",a.getLocal("px"),c)),e.addCode(a.setLocal("qq",s)),e.addCode(a.setLocal("qr",d)),e.addCode(a.setLocal("x",g)),e.addCode(a.block(a.loop(a.br_if(1,a.call(i+"_isZero",a.getLocal("newr"))),a.call(i+"_div",a.getLocal("r"),a.getLocal("newr"),a.getLocal("qq"),a.getLocal("qr")),a.call(i+"_mul",a.getLocal("qq"),a.getLocal("newt"),u),a.if(a.getLocal("signt"),a.if(a.getLocal("signnewt"),a.if(a.call(i+"_gte",u,a.getLocal("t")),[...a.drop(a.call(i+"_sub",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(0))],[...a.drop(a.call(i+"_sub",a.getLocal("t"),u,a.getLocal("x"))),...a.setLocal("signx",a.i32_const(1))]),[...a.drop(a.call(i+"_add",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(1))]),a.if(a.getLocal("signnewt"),[...a.drop(a.call(i+"_add",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(0))],a.if(a.call(i+"_gte",a.getLocal("t"),u),[...a.drop(a.call(i+"_sub",a.getLocal("t"),u,a.getLocal("x"))),...a.setLocal("signx",a.i32_const(0))],[...a.drop(a.call(i+"_sub",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(1))]))),a.setLocal("swp",a.getLocal("t")),a.setLocal("t",a.getLocal("newt")),a.setLocal("newt",a.getLocal("x")),a.setLocal("x",a.getLocal("swp")),a.setLocal("signt",a.getLocal("signnewt")),a.setLocal("signnewt",a.getLocal("signx")),a.setLocal("swp",a.getLocal("r")),a.setLocal("r",a.getLocal("newr")),a.setLocal("newr",a.getLocal("qr")),a.setLocal("qr",a.getLocal("swp")),a.br(0)))),e.addCode(a.if(a.getLocal("signt"),a.drop(a.call(i+"_sub",a.getLocal("pm"),a.getLocal("t"),a.getLocal("pr"))),a.call(i+"_copy",a.getLocal("t"),a.getLocal("pr"))))}(),t.exportFunction(i+"_copy"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_gte"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_square"),t.exportFunction(i+"_squareOld"),t.exportFunction(i+"_div"),t.exportFunction(i+"_inverseMod"),i},St=function(t,e,a,i,o,n,r){const l=t.addFunction(e);l.addParam("base","i32"),l.addParam("scalar","i32"),l.addParam("scalarLength","i32"),l.addParam("r","i32"),l.addLocal("i","i32"),l.addLocal("b","i32");const c=l.getCodeBuilder(),s=c.i32_const(t.alloc(a));l.addCode(c.if(c.i32_eqz(c.getLocal("scalarLength")),[...c.call(r,c.getLocal("r")),...c.ret([])])),l.addCode(c.call(n,c.getLocal("base"),s)),l.addCode(c.call(r,c.getLocal("r"))),l.addCode(c.setLocal("i",c.getLocal("scalarLength"))),l.addCode(c.block(c.loop(c.setLocal("i",c.i32_sub(c.getLocal("i"),c.i32_const(1))),c.setLocal("b",c.i32_load8_u(c.i32_add(c.getLocal("scalar"),c.getLocal("i")))),...function(){const t=[];for(let e=0;e<8;e++)t.push(...c.call(o,c.getLocal("r"),c.getLocal("r")),...c.if(c.i32_ge_u(c.getLocal("b"),c.i32_const(128>>e)),[...c.setLocal("b",c.i32_sub(c.getLocal("b"),c.i32_const(128>>e))),...c.call(i,c.getLocal("r"),s,c.getLocal("r"))]));return t}(),c.br_if(1,c.i32_eqz(c.getLocal("i"))),c.br(0))))},Gt=function(t,e){const a=8*t.modules[e].n64,i=t.addFunction(e+"_batchInverse");i.addParam("pIn","i32"),i.addParam("inStep","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addParam("outStep","i32"),i.addLocal("itAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(a));i.addCode(o.setLocal("itAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("itAux"),o.i32_mul(o.i32_add(o.getLocal("n"),o.i32_const(1)),o.i32_const(a))))),i.addCode(o.call(e+"_one",o.getLocal("itAux")),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(e+"_isZero",o.getLocal("itIn")),o.call(e+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(a)),o.getLocal("itAux")),o.call(e+"_mul",o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(a)),o.getLocal("itAux"))),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("itOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("outStep")))),o.call(e+"_inverse",o.getLocal("itAux"),o.getLocal("itAux")),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.if(o.call(e+"_isZero",o.getLocal("itIn")),[...o.call(e+"_copy",o.getLocal("itAux"),o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),...o.call(e+"_zero",o.getLocal("itOut"))],[...o.call(e+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(a)),n),...o.call(e+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),...o.call(e+"_mul",o.getLocal("itAux"),n,o.getLocal("itOut"))]),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itOut",o.i32_sub(o.getLocal("itOut"),o.getLocal("outStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),i.addCode(o.i32_store(o.i32_const(0),o.getLocal("itAux")))};var Pt=function(t,e,a,i,o,n){void 0===n&&(n=i<o);const r=t.addFunction(e);r.addParam("pIn","i32"),r.addParam("n","i32"),r.addParam("pOut","i32"),r.addLocal("i","i32"),r.addLocal("itIn","i32"),r.addLocal("itOut","i32");const l=r.getCodeBuilder();n?r.addCode(l.setLocal("itIn",l.i32_add(l.getLocal("pIn"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.i32_const(1)),l.i32_const(i)))),l.setLocal("itOut",l.i32_add(l.getLocal("pOut"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.i32_const(1)),l.i32_const(o)))),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(a,l.getLocal("itIn"),l.getLocal("itOut")),l.setLocal("itIn",l.i32_sub(l.getLocal("itIn"),l.i32_const(i))),l.setLocal("itOut",l.i32_sub(l.getLocal("itOut"),l.i32_const(o))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0)))):r.addCode(l.setLocal("itIn",l.getLocal("pIn")),l.setLocal("itOut",l.getLocal("pOut")),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(a,l.getLocal("itIn"),l.getLocal("itOut")),l.setLocal("itIn",l.i32_add(l.getLocal("itIn"),l.i32_const(i))),l.setLocal("itOut",l.i32_add(l.getLocal("itOut"),l.i32_const(o))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))};var Ot=function(t,e,a,i,o,n){void 0===n&&(n=i<o);const r=t.addFunction(e);r.addParam("pIn1","i32"),r.addParam("pIn2","i32"),r.addParam("n","i32"),r.addParam("pOut","i32"),r.addLocal("i","i32"),r.addLocal("itIn1","i32"),r.addLocal("itIn2","i32"),r.addLocal("itOut","i32");const l=r.getCodeBuilder();n?r.addCode(l.setLocal("itIn1",l.i32_add(l.getLocal("pIn1"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.i32_const(1)),l.i32_const(i)))),l.setLocal("itIn2",l.i32_add(l.getLocal("pIn2"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.i32_const(1)),l.i32_const(i)))),l.setLocal("itOut",l.i32_add(l.getLocal("pOut"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.i32_const(1)),l.i32_const(o)))),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(a,l.getLocal("itIn1"),l.getLocal("itIn2"),l.getLocal("itOut")),l.setLocal("itIn1",l.i32_sub(l.getLocal("itIn1"),l.i32_const(i))),l.setLocal("itIn2",l.i32_sub(l.getLocal("itIn2"),l.i32_const(i))),l.setLocal("itOut",l.i32_sub(l.getLocal("itOut"),l.i32_const(o))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0)))):r.addCode(l.setLocal("itIn1",l.getLocal("pIn1")),l.setLocal("itIn2",l.getLocal("pIn2")),l.setLocal("itOut",l.getLocal("pOut")),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(a,l.getLocal("itIn1"),l.getLocal("itIn2"),l.getLocal("itOut")),l.setLocal("itIn1",l.i32_add(l.getLocal("itIn1"),l.i32_const(i))),l.setLocal("itIn2",l.i32_add(l.getLocal("itIn2"),l.i32_const(i))),l.setLocal("itOut",l.i32_add(l.getLocal("itOut"),l.i32_const(o))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))};var Ut=function(t,e,a,i){const o=u(e),n=Math.floor((o.minus(1).bitLength()-1)/64)+1,r=2*n,l=8*n,c=a||"f1m";if(t.modules[c])return c;const s=Bt(t,n,i),d=t.alloc(l,Et(o,l));t.alloc(Et(u.one.shiftLeft(64*n).mod(o),l));const g=t.alloc(Et(u.one.shiftLeft(64*n).square().mod(o),l)),f=t.alloc(Et(u.one.shiftLeft(64*n).mod(o),l)),_=t.alloc(Et(u.zero,l)),p=o.minus(u.one),h=p.shiftRight(1),m=t.alloc(l,Et(h,l)),L=h.add(u.one),w=t.alloc(l,Et(L,l));t.modules[c]={pq:d,pR2:g,n64:n,q:o,pOne:f,pZero:_,pePlusOne:w};let A=u(2);if(o.isPrime())for(;!A.modPow(h,o).equals(p);)A=A.add(u.one);t.alloc(Et(A.shiftLeft(64*n).mod(o),l));let b=0,y=p;for(;!y.isOdd()&&!y.isZero();)b++,y=y.shiftRight(1);const I=t.alloc(l,Et(y,l)),C=A.modPow(y,o),F=t.alloc(Et(C.shiftLeft(64*n).mod(o),l)),x=y.add(1).shiftRight(1),v=t.alloc(l,Et(x,l));return t.exportFunction(s+"_copy",c+"_copy"),t.exportFunction(s+"_zero",c+"_zero"),t.exportFunction(s+"_isZero",c+"_isZero"),t.exportFunction(s+"_eq",c+"_eq"),function(){const e=t.addFunction(c+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const a=e.getCodeBuilder();e.addCode(a.ret(a.call(s+"_eq",a.getLocal("x"),a.i32_const(f))))}(),function(){const e=t.addFunction(c+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.if(a.call(s+"_add",a.getLocal("x"),a.getLocal("y"),a.getLocal("r")),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))),a.if(a.call(s+"_gte",a.getLocal("r"),a.i32_const(d)),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))))))}(),function(){const e=t.addFunction(c+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.if(a.call(s+"_sub",a.getLocal("x"),a.getLocal("y"),a.getLocal("r")),a.drop(a.call(s+"_add",a.getLocal("r"),a.i32_const(d),a.getLocal("r")))))}(),function(){const e=t.addFunction(c+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(c+"_sub",a.i32_const(_),a.getLocal("x"),a.getLocal("r")))}(),function(){const e=t.alloc(r*r*8),a=t.addFunction(c+"_mReduct");a.addParam("t","i32"),a.addParam("r","i32"),a.addLocal("np32","i64"),a.addLocal("c","i64"),a.addLocal("m","i64");const i=a.getCodeBuilder(),n=u("100000000",16).minus(o.modInv(u("100000000",16))).toJSNumber();a.addCode(i.setLocal("np32",i.i64_const(n)));for(let t=0;t<r;t++){a.addCode(i.setLocal("c",i.i64_const(0))),a.addCode(i.setLocal("m",i.i64_and(i.i64_mul(i.i64_load32_u(i.getLocal("t"),4*t),i.getLocal("np32")),i.i64_const("0xFFFFFFFF"))));for(let e=0;e<r;e++)a.addCode(i.setLocal("c",i.i64_add(i.i64_add(i.i64_load32_u(i.getLocal("t"),4*(t+e)),i.i64_shr_u(i.getLocal("c"),i.i64_const(32))),i.i64_mul(i.i64_load32_u(i.i32_const(d),4*e),i.getLocal("m"))))),a.addCode(i.i64_store32(i.getLocal("t"),4*(t+e),i.getLocal("c")));a.addCode(i.i64_store32(i.i32_const(e),4*t,i.i64_shr_u(i.getLocal("c"),i.i64_const(32))))}a.addCode(i.call(c+"_add",i.i32_const(e),i.i32_add(i.getLocal("t"),i.i32_const(4*r)),i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("np32","i64");for(let t=0;t<r;t++)e.addLocal("x"+t,"i64"),e.addLocal("y"+t,"i64"),e.addLocal("m"+t,"i64"),e.addLocal("q"+t,"i64");const a=e.getCodeBuilder(),i=u("100000000",16).minus(o.modInv(u("100000000",16))).toJSNumber();e.addCode(a.setLocal("np32",a.i64_const(i)));const n=[],l=[],g=[];function f(t,e){let i,o;return n[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),n[t]=!0),l[e]?o=a.getLocal("y"+e):(o=a.teeLocal("y"+e,a.i64_load32_u(a.getLocal("y"),4*e)),l[e]=!0),a.i64_mul(i,o)}function _(t,e){let i,o;return g[t]?i=a.getLocal("q"+t):(i=a.teeLocal("q"+t,a.i64_load32_u(a.i32_const(0),d+4*t)),g[t]=!0),o=a.getLocal("m"+e),a.i64_mul(i,o)}let p="c0",h="c1";for(let t=0;t<2*r-1;t++){for(let i=Math.max(0,t-r+1);i<=t&&i<r;i++){const o=t-i;e.addCode(a.setLocal(p,a.i64_add(a.i64_and(a.getLocal(p),a.i64_const(4294967295)),f(i,o)))),e.addCode(a.setLocal(h,a.i64_add(a.getLocal(h),a.i64_shr_u(a.getLocal(p),a.i64_const(32)))))}for(let i=Math.max(1,t-r+1);i<=t&&i<r;i++){const o=t-i;e.addCode(a.setLocal(p,a.i64_add(a.i64_and(a.getLocal(p),a.i64_const(4294967295)),_(i,o)))),e.addCode(a.setLocal(h,a.i64_add(a.getLocal(h),a.i64_shr_u(a.getLocal(p),a.i64_const(32)))))}t<r&&(e.addCode(a.setLocal("m"+t,a.i64_and(a.i64_mul(a.i64_and(a.getLocal(p),a.i64_const(4294967295)),a.getLocal("np32")),a.i64_const("0xFFFFFFFF")))),e.addCode(a.setLocal(p,a.i64_add(a.i64_and(a.getLocal(p),a.i64_const(4294967295)),_(0,t)))),e.addCode(a.setLocal(h,a.i64_add(a.getLocal(h),a.i64_shr_u(a.getLocal(p),a.i64_const(32)))))),t>=r&&e.addCode(a.i64_store32(a.getLocal("r"),4*(t-r),a.getLocal(p))),[p,h]=[h,p],e.addCode(a.setLocal(h,a.i64_shr_u(a.getLocal(p),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),4*r-4,a.getLocal(p))),e.addCode(a.if(a.i32_wrap_i64(a.getLocal(h)),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))),a.if(a.call(s+"_gte",a.getLocal("r"),a.i32_const(d)),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))))))}(),function(){const e=t.addFunction(c+"_square");e.addParam("x","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("c0_old","i64"),e.addLocal("c1_old","i64"),e.addLocal("np32","i64");for(let t=0;t<r;t++)e.addLocal("x"+t,"i64"),e.addLocal("m"+t,"i64"),e.addLocal("q"+t,"i64");const a=e.getCodeBuilder(),i=u("100000000",16).minus(o.modInv(u("100000000",16))).toJSNumber();e.addCode(a.setLocal("np32",a.i64_const(i)));const n=[],l=[];function g(t,e){let i,o;return n[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),n[t]=!0),n[e]?o=a.getLocal("x"+e):(o=a.teeLocal("x"+e,a.i64_load32_u(a.getLocal("x"),4*e)),n[e]=!0),a.i64_mul(i,o)}function f(t,e){let i,o;return l[t]?i=a.getLocal("q"+t):(i=a.teeLocal("q"+t,a.i64_load32_u(a.i32_const(0),d+4*t)),l[t]=!0),o=a.getLocal("m"+e),a.i64_mul(i,o)}let _="c0",p="c1",h="c0_old",m="c1_old";for(let t=0;t<2*r-1;t++){e.addCode(a.setLocal(_,a.i64_const(0)),a.setLocal(p,a.i64_const(0)));for(let i=Math.max(0,t-r+1);i<t+1>>1&&i<r;i++){const o=t-i;e.addCode(a.setLocal(_,a.i64_add(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),g(i,o)))),e.addCode(a.setLocal(p,a.i64_add(a.getLocal(p),a.i64_shr_u(a.getLocal(_),a.i64_const(32)))))}e.addCode(a.setLocal(_,a.i64_shl(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),a.i64_const(1)))),e.addCode(a.setLocal(p,a.i64_add(a.i64_shl(a.getLocal(p),a.i64_const(1)),a.i64_shr_u(a.getLocal(_),a.i64_const(32))))),t%2==0&&(e.addCode(a.setLocal(_,a.i64_add(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),g(t>>1,t>>1)))),e.addCode(a.setLocal(p,a.i64_add(a.getLocal(p),a.i64_shr_u(a.getLocal(_),a.i64_const(32)))))),t>0&&(e.addCode(a.setLocal(_,a.i64_add(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),a.i64_and(a.getLocal(h),a.i64_const(4294967295))))),e.addCode(a.setLocal(p,a.i64_add(a.i64_add(a.getLocal(p),a.i64_shr_u(a.getLocal(_),a.i64_const(32))),a.getLocal(m)))));for(let i=Math.max(1,t-r+1);i<=t&&i<r;i++){const o=t-i;e.addCode(a.setLocal(_,a.i64_add(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),f(i,o)))),e.addCode(a.setLocal(p,a.i64_add(a.getLocal(p),a.i64_shr_u(a.getLocal(_),a.i64_const(32)))))}t<r&&(e.addCode(a.setLocal("m"+t,a.i64_and(a.i64_mul(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),a.getLocal("np32")),a.i64_const("0xFFFFFFFF")))),e.addCode(a.setLocal(_,a.i64_add(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),f(0,t)))),e.addCode(a.setLocal(p,a.i64_add(a.getLocal(p),a.i64_shr_u(a.getLocal(_),a.i64_const(32)))))),t>=r&&e.addCode(a.i64_store32(a.getLocal("r"),4*(t-r),a.getLocal(_))),e.addCode(a.setLocal(h,a.getLocal(p)),a.setLocal(m,a.i64_shr_u(a.getLocal(h),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),4*r-4,a.getLocal(h))),e.addCode(a.if(a.i32_wrap_i64(a.getLocal(m)),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))),a.if(a.call(s+"_gte",a.getLocal("r"),a.i32_const(d)),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))))))}(),function(){const e=t.addFunction(c+"_squareOld");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(c+"_mul",a.getLocal("x"),a.getLocal("x"),a.getLocal("r")))}(),function(){const e=t.addFunction(c+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(c+"_mul",a.getLocal("x"),a.i32_const(g),a.getLocal("r")))}(),function(){const e=t.alloc(2*l),a=t.addFunction(c+"_fromMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const i=a.getCodeBuilder();a.addCode(i.call(s+"_copy",i.getLocal("x"),i.i32_const(e))),a.addCode(i.call(s+"_zero",i.i32_const(e+l))),a.addCode(i.call(c+"_mReduct",i.i32_const(e),i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(l));e.addCode(a.call(c+"_fromMontgomery",a.getLocal("x"),i),a.call(s+"_gte",i,a.i32_const(w)))}(),function(){const e=t.addFunction(c+"_sign");e.addParam("x","i32"),e.setReturnType("i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(l));e.addCode(a.if(a.call(s+"_isZero",a.getLocal("x")),a.ret(a.i32_const(0))),a.call(c+"_fromMontgomery",a.getLocal("x"),i),a.if(a.call(s+"_gte",i,a.i32_const(w)),a.ret(a.i32_const(-1))),a.ret(a.i32_const(1)))}(),function(){const e=t.addFunction(c+"_inverse");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(c+"_fromMontgomery",a.getLocal("x"),a.getLocal("r"))),e.addCode(a.call(s+"_inverseMod",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))),e.addCode(a.call(c+"_toMontgomery",a.getLocal("r"),a.getLocal("r")))}(),function(){const e=t.addFunction(c+"_one");e.addParam("pr","i32");const a=e.getCodeBuilder();e.addCode(a.call(s+"_copy",a.i32_const(f),a.getLocal("pr")))}(),function(){const e=t.addFunction(c+"_load");e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32"),e.addLocal("p","i32"),e.addLocal("l","i32"),e.addLocal("i","i32"),e.addLocal("j","i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(l)),o=t.alloc(l),n=a.i32_const(o);e.addCode(a.call(s+"_zero",a.getLocal("r")),a.setLocal("i",a.i32_const(l)),a.setLocal("p",a.getLocal("scalar")),a.block(a.loop(a.br_if(1,a.i32_gt_u(a.getLocal("i"),a.getLocal("scalarLen"))),a.if(a.i32_eq(a.getLocal("i"),a.i32_const(l)),a.call(c+"_one",i),a.call(c+"_mul",i,a.i32_const(g),i)),a.call(c+"_mul",a.getLocal("p"),i,n),a.call(c+"_add",a.getLocal("r"),n,a.getLocal("r")),a.setLocal("p",a.i32_add(a.getLocal("p"),a.i32_const(l))),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(l))),a.br(0))),a.setLocal("l",a.i32_rem_u(a.getLocal("scalarLen"),a.i32_const(l))),a.if(a.i32_eqz(a.getLocal("l")),a.ret([])),a.call(s+"_zero",n),a.setLocal("j",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("j"),a.getLocal("l"))),a.i32_store8(a.getLocal("j"),o,a.i32_load8_u(a.getLocal("p"))),a.setLocal("p",a.i32_add(a.getLocal("p"),a.i32_const(1))),a.setLocal("j",a.i32_add(a.getLocal("j"),a.i32_const(1))),a.br(0))),a.if(a.i32_eq(a.getLocal("i"),a.i32_const(l)),a.call(c+"_one",i),a.call(c+"_mul",i,a.i32_const(g),i)),a.call(c+"_mul",n,i,n),a.call(c+"_add",a.getLocal("r"),n,a.getLocal("r")))}(),function(){const e=t.addFunction(c+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(l));e.addCode(a.call(c+"_load",a.getLocal("scalar"),a.getLocal("scalarLen"),i),a.call(c+"_toMontgomery",i,i),a.call(c+"_mul",a.getLocal("x"),i,a.getLocal("r")))}(),Gt(t,c),Pt(t,c+"_batchToMontgomery",c+"_toMontgomery",l,l),Pt(t,c+"_batchFromMontgomery",c+"_fromMontgomery",l,l),Pt(t,c+"_batchNeg",c+"_neg",l,l),Ot(t,c+"_batchAdd",c+"_add",l,l),Ot(t,c+"_batchSub",c+"_sub",l,l),Ot(t,c+"_batchMul",c+"_mul",l,l),t.exportFunction(c+"_add"),t.exportFunction(c+"_sub"),t.exportFunction(c+"_neg"),t.exportFunction(c+"_isNegative"),t.exportFunction(c+"_isOne"),t.exportFunction(c+"_sign"),t.exportFunction(c+"_mReduct"),t.exportFunction(c+"_mul"),t.exportFunction(c+"_square"),t.exportFunction(c+"_squareOld"),t.exportFunction(c+"_fromMontgomery"),t.exportFunction(c+"_toMontgomery"),t.exportFunction(c+"_inverse"),t.exportFunction(c+"_one"),t.exportFunction(c+"_load"),t.exportFunction(c+"_timesScalar"),St(t,c+"_exp",l,c+"_mul",c+"_square",s+"_copy",c+"_one"),t.exportFunction(c+"_exp"),t.exportFunction(c+"_batchInverse"),o.isPrime()&&(!function(){const e=t.addFunction(c+"_sqrt");e.addParam("n","i32"),e.addParam("r","i32"),e.addLocal("m","i32"),e.addLocal("i","i32"),e.addLocal("j","i32");const a=e.getCodeBuilder(),i=a.i32_const(f),o=a.i32_const(t.alloc(l)),n=a.i32_const(t.alloc(l)),r=a.i32_const(t.alloc(l)),s=a.i32_const(t.alloc(l)),d=a.i32_const(t.alloc(l));e.addCode(a.if(a.call(c+"_isZero",a.getLocal("n")),a.ret(a.call(c+"_zero",a.getLocal("r")))),a.setLocal("m",a.i32_const(b)),a.call(c+"_copy",a.i32_const(F),o),a.call(c+"_exp",a.getLocal("n"),a.i32_const(I),a.i32_const(l),n),a.call(c+"_exp",a.getLocal("n"),a.i32_const(v),a.i32_const(l),r),a.block(a.loop(a.br_if(1,a.call(c+"_eq",n,i)),a.call(c+"_square",n,s),a.setLocal("i",a.i32_const(1)),a.block(a.loop(a.br_if(1,a.call(c+"_eq",s,i)),a.call(c+"_square",s,s),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))),a.call(c+"_copy",o,d),a.setLocal("j",a.i32_sub(a.i32_sub(a.getLocal("m"),a.getLocal("i")),a.i32_const(1))),a.block(a.loop(a.br_if(1,a.i32_eqz(a.getLocal("j"))),a.call(c+"_square",d,d),a.setLocal("j",a.i32_sub(a.getLocal("j"),a.i32_const(1))),a.br(0))),a.setLocal("m",a.getLocal("i")),a.call(c+"_square",d,o),a.call(c+"_mul",n,o,n),a.call(c+"_mul",r,d,r),a.br(0))),a.if(a.call(c+"_isNegative",r),a.call(c+"_neg",r,a.getLocal("r")),a.call(c+"_copy",r,a.getLocal("r"))))}(),function(){const e=t.addFunction(c+"_isSquare");e.addParam("n","i32"),e.setReturnType("i32");const a=e.getCodeBuilder(),i=a.i32_const(f),o=a.i32_const(t.alloc(l));e.addCode(a.if(a.call(c+"_isZero",a.getLocal("n")),a.ret(a.i32_const(1))),a.call(c+"_exp",a.getLocal("n"),a.i32_const(m),a.i32_const(l),o),a.call(c+"_eq",o,i))}(),t.exportFunction(c+"_sqrt"),t.exportFunction(c+"_isSquare")),t.exportFunction(c+"_batchToMontgomery"),t.exportFunction(c+"_batchFromMontgomery"),c},zt=function(t,e,a,i,o){const n=u(e),r=Math.floor((n.minus(1).bitLength()-1)/64)+1,l=8*r,c=a||"f1";if(t.modules[c])return c;t.modules[c]={n64:r};const s=o||"int",d=Ut(t,n,i,s),g=t.modules[d].pR2,f=t.modules[d].pq,_=t.modules[d].pePlusOne;return function(){const e=t.alloc(l),a=t.addFunction(c+"_mul");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const i=a.getCodeBuilder();a.addCode(i.call(d+"_mul",i.getLocal("x"),i.getLocal("y"),i.i32_const(e))),a.addCode(i.call(d+"_mul",i.i32_const(e),i.i32_const(g),i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_square");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(c+"_mul",a.getLocal("x"),a.getLocal("x"),a.getLocal("r")))}(),function(){const e=t.addFunction(c+"_inverse");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(s+"_inverseMod",a.getLocal("x"),a.i32_const(f),a.getLocal("r")))}(),function(){const e=t.addFunction(c+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const a=e.getCodeBuilder();e.addCode(a.call(s+"_gte",a.getLocal("x"),a.i32_const(_)))}(),t.exportFunction(d+"_add",c+"_add"),t.exportFunction(d+"_sub",c+"_sub"),t.exportFunction(d+"_neg",c+"_neg"),t.exportFunction(c+"_mul"),t.exportFunction(c+"_square"),t.exportFunction(c+"_inverse"),t.exportFunction(c+"_isNegative"),t.exportFunction(d+"_copy",c+"_copy"),t.exportFunction(d+"_zero",c+"_zero"),t.exportFunction(d+"_one",c+"_one"),t.exportFunction(d+"_isZero",c+"_isZero"),t.exportFunction(d+"_eq",c+"_eq"),c},qt=function(t,e,a,i){if(t.modules[a])return a;const o=8*t.modules[i].n64,n=t.modules[i].q;return t.modules[a]={n64:2*t.modules[i].n64},function(){const e=t.addFunction(a+"_isZero");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.i32_and(n.call(i+"_isZero",r),n.call(i+"_isZero",l)))}(),function(){const e=t.addFunction(a+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.ret(n.i32_and(n.call(i+"_isOne",r),n.call(i+"_isZero",l))))}(),function(){const e=t.addFunction(a+"_zero");e.addParam("x","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.call(i+"_zero",r),n.call(i+"_zero",l))}(),function(){const e=t.addFunction(a+"_one");e.addParam("x","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.call(i+"_one",r),n.call(i+"_zero",l))}(),function(){const e=t.addFunction(a+"_copy");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_copy",r,c),n.call(i+"_copy",l,s))}(),function(){const n=t.addFunction(a+"_mul");n.addParam("x","i32"),n.addParam("y","i32"),n.addParam("r","i32");const r=n.getCodeBuilder(),l=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(o)),s=r.getLocal("y"),d=r.i32_add(r.getLocal("y"),r.i32_const(o)),u=r.getLocal("r"),g=r.i32_add(r.getLocal("r"),r.i32_const(o)),f=r.i32_const(t.alloc(o)),_=r.i32_const(t.alloc(o)),p=r.i32_const(t.alloc(o)),h=r.i32_const(t.alloc(o));n.addCode(r.call(i+"_mul",l,s,f),r.call(i+"_mul",c,d,_),r.call(i+"_add",l,c,p),r.call(i+"_add",s,d,h),r.call(i+"_mul",p,h,p),r.call(e,_,u),r.call(i+"_add",f,u,u),r.call(i+"_add",f,_,g),r.call(i+"_sub",p,g,g))}(),function(){const e=t.addFunction(a+"_mul1");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.getLocal("y"),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_mul",r,c,s),n.call(i+"_mul",l,c,d))}(),function(){const n=t.addFunction(a+"_square");n.addParam("x","i32"),n.addParam("r","i32");const r=n.getCodeBuilder(),l=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(o)),s=r.getLocal("r"),d=r.i32_add(r.getLocal("r"),r.i32_const(o)),u=r.i32_const(t.alloc(o)),g=r.i32_const(t.alloc(o)),f=r.i32_const(t.alloc(o)),_=r.i32_const(t.alloc(o));n.addCode(r.call(i+"_mul",l,c,u),r.call(i+"_add",l,c,g),r.call(e,c,f),r.call(i+"_add",l,f,f),r.call(e,u,_),r.call(i+"_add",_,u,_),r.call(i+"_mul",g,f,s),r.call(i+"_sub",s,_,s),r.call(i+"_add",u,u,d))}(),function(){const e=t.addFunction(a+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.getLocal("y"),s=n.i32_add(n.getLocal("y"),n.i32_const(o)),d=n.getLocal("r"),u=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_add",r,c,d),n.call(i+"_add",l,s,u))}(),function(){const e=t.addFunction(a+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.getLocal("y"),s=n.i32_add(n.getLocal("y"),n.i32_const(o)),d=n.getLocal("r"),u=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_sub",r,c,d),n.call(i+"_sub",l,s,u))}(),function(){const e=t.addFunction(a+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_neg",r,c),n.call(i+"_neg",l,s))}(),function(){const e=t.addFunction(a+"_conjugate");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_copy",r,c),n.call(i+"_neg",l,s))}(),function(){const e=t.addFunction(a+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_toMontgomery",r,c),n.call(i+"_toMontgomery",l,s))}(),function(){const e=t.addFunction(a+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_fromMontgomery",r,c),n.call(i+"_fromMontgomery",l,s))}(),function(){const e=t.addFunction(a+"_eq");e.addParam("x","i32"),e.addParam("y","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.getLocal("y"),s=n.i32_add(n.getLocal("y"),n.i32_const(o));e.addCode(n.i32_and(n.call(i+"_eq",r,c),n.call(i+"_eq",l,s)))}(),function(){const n=t.addFunction(a+"_inverse");n.addParam("x","i32"),n.addParam("r","i32");const r=n.getCodeBuilder(),l=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(o)),s=r.getLocal("r"),d=r.i32_add(r.getLocal("r"),r.i32_const(o)),u=r.i32_const(t.alloc(o)),g=r.i32_const(t.alloc(o)),f=r.i32_const(t.alloc(o)),_=r.i32_const(t.alloc(o));n.addCode(r.call(i+"_square",l,u),r.call(i+"_square",c,g),r.call(e,g,f),r.call(i+"_sub",u,f,f),r.call(i+"_inverse",f,_),r.call(i+"_mul",l,_,s),r.call(i+"_mul",c,_,d),r.call(i+"_neg",d,d))}(),function(){const e=t.addFunction(a+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_timesScalar",r,n.getLocal("scalar"),n.getLocal("scalarLen"),c),n.call(i+"_timesScalar",l,n.getLocal("scalar"),n.getLocal("scalarLen"),s))}(),function(){const e=t.addFunction(a+"_sign");e.addParam("x","i32"),e.addLocal("s","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.setLocal("s",n.call(i+"_sign",l)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.ret(n.call(i+"_sign",r)))}(),function(){const e=t.addFunction(a+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.if(n.call(i+"_isZero",l),n.ret(n.call(i+"_isNegative",r))),n.ret(n.call(i+"_isNegative",l)))}(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_mul1"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_conjugate"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),Gt(t,a),St(t,a+"_exp",2*o,a+"_mul",a+"_square",a+"_copy",a+"_one"),function(){const e=t.addFunction(a+"_sqrt");e.addParam("a","i32"),e.addParam("pr","i32");const r=e.getCodeBuilder(),l=r.i32_const(t.alloc(Et(u(n).minus(u(3)).divide(4),o))),c=r.i32_const(t.alloc(Et(u(n).minus(u(1)).divide(2),o))),s=r.getLocal("a"),d=r.i32_const(t.alloc(2*o)),g=r.i32_const(t.alloc(2*o)),f=r.i32_const(t.alloc(2*o)),_=t.alloc(2*o),p=r.i32_const(_),h=r.i32_const(_),m=r.i32_const(_+o),L=r.i32_const(t.alloc(2*o)),w=r.i32_const(t.alloc(2*o));e.addCode(r.call(a+"_one",p),r.call(a+"_neg",p,p),r.call(a+"_exp",s,l,r.i32_const(o),d),r.call(a+"_square",d,g),r.call(a+"_mul",s,g,g),r.call(a+"_conjugate",g,f),r.call(a+"_mul",f,g,f),r.if(r.call(a+"_eq",f,p),r.unreachable()),r.call(a+"_mul",d,s,L),r.if(r.call(a+"_eq",g,p),[...r.call(i+"_zero",h),...r.call(i+"_one",m),...r.call(a+"_mul",p,L,r.getLocal("pr"))],[...r.call(a+"_one",w),...r.call(a+"_add",w,g,w),...r.call(a+"_exp",w,c,r.i32_const(o),w),...r.call(a+"_mul",w,L,r.getLocal("pr"))]))}(),function(){const e=t.addFunction(a+"_isSquare");e.addParam("a","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),r=i.i32_const(t.alloc(Et(u(n).minus(u(3)).divide(4),o))),l=i.getLocal("a"),c=i.i32_const(t.alloc(2*o)),s=i.i32_const(t.alloc(2*o)),d=i.i32_const(t.alloc(2*o)),g=t.alloc(2*o),f=i.i32_const(g);e.addCode(i.call(a+"_one",f),i.call(a+"_neg",f,f),i.call(a+"_exp",l,r,i.i32_const(o),c),i.call(a+"_square",c,s),i.call(a+"_mul",l,s,s),i.call(a+"_conjugate",s,d),i.call(a+"_mul",d,s,d),i.if(i.call(a+"_eq",d,f),i.ret(i.i32_const(0))),i.ret(i.i32_const(1)))}(),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_sqrt"),t.exportFunction(a+"_isSquare"),t.exportFunction(a+"_isNegative"),a},Qt=function(t,e,a,i){if(t.modules[a])return a;const o=8*t.modules[i].n64;return t.modules[a]={n64:3*t.modules[i].n64},function(){const e=t.addFunction(a+"_isZero");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.i32_and(n.i32_and(n.call(i+"_isZero",r),n.call(i+"_isZero",l)),n.call(i+"_isZero",c)))}(),function(){const e=t.addFunction(a+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.ret(n.i32_and(n.i32_and(n.call(i+"_isOne",r),n.call(i+"_isZero",l)),n.call(i+"_isZero",c))))}(),function(){const e=t.addFunction(a+"_zero");e.addParam("x","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.call(i+"_zero",r),n.call(i+"_zero",l),n.call(i+"_zero",c))}(),function(){const e=t.addFunction(a+"_one");e.addParam("x","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.call(i+"_one",r),n.call(i+"_zero",l),n.call(i+"_zero",c))}(),function(){const e=t.addFunction(a+"_copy");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_copy",r,s),n.call(i+"_copy",l,d),n.call(i+"_copy",c,u))}(),function(){const n=t.addFunction(a+"_mul");n.addParam("x","i32"),n.addParam("y","i32"),n.addParam("r","i32");const r=n.getCodeBuilder(),l=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(o)),s=r.i32_add(r.getLocal("x"),r.i32_const(2*o)),d=r.getLocal("y"),u=r.i32_add(r.getLocal("y"),r.i32_const(o)),g=r.i32_add(r.getLocal("y"),r.i32_const(2*o)),f=r.getLocal("r"),_=r.i32_add(r.getLocal("r"),r.i32_const(o)),p=r.i32_add(r.getLocal("r"),r.i32_const(2*o)),h=r.i32_const(t.alloc(o)),m=r.i32_const(t.alloc(o)),L=r.i32_const(t.alloc(o)),w=r.i32_const(t.alloc(o)),A=r.i32_const(t.alloc(o)),b=r.i32_const(t.alloc(o)),y=r.i32_const(t.alloc(o)),I=r.i32_const(t.alloc(o)),C=r.i32_const(t.alloc(o)),F=r.i32_const(t.alloc(o)),x=r.i32_const(t.alloc(o)),v=r.i32_const(t.alloc(o)),E=r.i32_const(t.alloc(o));n.addCode(r.call(i+"_mul",l,d,h),r.call(i+"_mul",c,u,m),r.call(i+"_mul",s,g,L),r.call(i+"_add",l,c,w),r.call(i+"_add",d,u,A),r.call(i+"_add",l,s,b),r.call(i+"_add",d,g,y),r.call(i+"_add",c,s,I),r.call(i+"_add",u,g,C),r.call(i+"_add",h,m,F),r.call(i+"_add",h,L,x),r.call(i+"_add",m,L,v),r.call(i+"_mul",I,C,f),r.call(i+"_sub",f,v,f),r.call(e,f,f),r.call(i+"_add",h,f,f),r.call(i+"_mul",w,A,_),r.call(i+"_sub",_,F,_),r.call(e,L,E),r.call(i+"_add",_,E,_),r.call(i+"_mul",b,y,p),r.call(i+"_sub",p,x,p),r.call(i+"_add",p,m,p))}(),function(){const n=t.addFunction(a+"_square");n.addParam("x","i32"),n.addParam("r","i32");const r=n.getCodeBuilder(),l=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(o)),s=r.i32_add(r.getLocal("x"),r.i32_const(2*o)),d=r.getLocal("r"),u=r.i32_add(r.getLocal("r"),r.i32_const(o)),g=r.i32_add(r.getLocal("r"),r.i32_const(2*o)),f=r.i32_const(t.alloc(o)),_=r.i32_const(t.alloc(o)),p=r.i32_const(t.alloc(o)),h=r.i32_const(t.alloc(o)),m=r.i32_const(t.alloc(o)),L=r.i32_const(t.alloc(o)),w=r.i32_const(t.alloc(o));n.addCode(r.call(i+"_square",l,f),r.call(i+"_mul",l,c,_),r.call(i+"_add",_,_,p),r.call(i+"_sub",l,c,h),r.call(i+"_add",h,s,h),r.call(i+"_square",h,h),r.call(i+"_mul",c,s,m),r.call(i+"_add",m,m,L),r.call(i+"_square",s,w),r.call(e,L,d),r.call(i+"_add",f,d,d),r.call(e,w,u),r.call(i+"_add",p,u,u),r.call(i+"_add",f,w,g),r.call(i+"_sub",L,g,g),r.call(i+"_add",h,g,g),r.call(i+"_add",p,g,g))}(),function(){const e=t.addFunction(a+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(o)),u=n.i32_add(n.getLocal("y"),n.i32_const(2*o)),g=n.getLocal("r"),f=n.i32_add(n.getLocal("r"),n.i32_const(o)),_=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_add",r,s,g),n.call(i+"_add",l,d,f),n.call(i+"_add",c,u,_))}(),function(){const e=t.addFunction(a+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(o)),u=n.i32_add(n.getLocal("y"),n.i32_const(2*o)),g=n.getLocal("r"),f=n.i32_add(n.getLocal("r"),n.i32_const(o)),_=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_sub",r,s,g),n.call(i+"_sub",l,d,f),n.call(i+"_sub",c,u,_))}(),function(){const e=t.addFunction(a+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_neg",r,s),n.call(i+"_neg",l,d),n.call(i+"_neg",c,u))}(),function(){const e=t.addFunction(a+"_sign");e.addParam("x","i32"),e.addLocal("s","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.setLocal("s",n.call(i+"_sign",c)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.setLocal("s",n.call(i+"_sign",l)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.ret(n.call(i+"_sign",r)))}(),function(){const e=t.addFunction(a+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_toMontgomery",r,s),n.call(i+"_toMontgomery",l,d),n.call(i+"_toMontgomery",c,u))}(),function(){const e=t.addFunction(a+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_fromMontgomery",r,s),n.call(i+"_fromMontgomery",l,d),n.call(i+"_fromMontgomery",c,u))}(),function(){const e=t.addFunction(a+"_eq");e.addParam("x","i32"),e.addParam("y","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(o)),u=n.i32_add(n.getLocal("y"),n.i32_const(2*o));e.addCode(n.i32_and(n.i32_and(n.call(i+"_eq",r,s),n.call(i+"_eq",l,d)),n.call(i+"_eq",c,u)))}(),function(){const n=t.addFunction(a+"_inverse");n.addParam("x","i32"),n.addParam("r","i32");const r=n.getCodeBuilder(),l=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(o)),s=r.i32_add(r.getLocal("x"),r.i32_const(2*o)),d=r.getLocal("r"),u=r.i32_add(r.getLocal("r"),r.i32_const(o)),g=r.i32_add(r.getLocal("r"),r.i32_const(2*o)),f=r.i32_const(t.alloc(o)),_=r.i32_const(t.alloc(o)),p=r.i32_const(t.alloc(o)),h=r.i32_const(t.alloc(o)),m=r.i32_const(t.alloc(o)),L=r.i32_const(t.alloc(o)),w=r.i32_const(t.alloc(o)),A=r.i32_const(t.alloc(o)),b=r.i32_const(t.alloc(o)),y=r.i32_const(t.alloc(o)),I=r.i32_const(t.alloc(o));n.addCode(r.call(i+"_square",l,f),r.call(i+"_square",c,_),r.call(i+"_square",s,p),r.call(i+"_mul",l,c,h),r.call(i+"_mul",l,s,m),r.call(i+"_mul",c,s,L),r.call(e,L,w),r.call(i+"_sub",f,w,w),r.call(e,p,A),r.call(i+"_sub",A,h,A),r.call(i+"_sub",_,m,b),r.call(i+"_mul",s,A,y),r.call(i+"_mul",c,b,I),r.call(i+"_add",y,I,y),r.call(e,y,y),r.call(i+"_mul",l,w,I),r.call(i+"_add",I,y,y),r.call(i+"_inverse",y,y),r.call(i+"_mul",y,w,d),r.call(i+"_mul",y,A,u),r.call(i+"_mul",y,b,g))}(),function(){const e=t.addFunction(a+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_timesScalar",r,n.getLocal("scalar"),n.getLocal("scalarLen"),s),n.call(i+"_timesScalar",l,n.getLocal("scalar"),n.getLocal("scalarLen"),d),n.call(i+"_timesScalar",c,n.getLocal("scalar"),n.getLocal("scalarLen"),u))}(),function(){const e=t.addFunction(a+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),r=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(o)),c=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.if(n.call(i+"_isZero",c),n.if(n.call(i+"_isZero",l),n.ret(n.call(i+"_isNegative",r)),n.ret(n.call(i+"_isNegative",l)))),n.ret(n.call(i+"_isNegative",c)))}(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),Gt(t,a),St(t,a+"_exp",3*o,a+"_mul",a+"_square",a+"_copy",a+"_one"),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_isNegative"),a},Mt=function(t,e,a,i,o,n,r,l){const c=t.addFunction(e);c.addParam("base","i32"),c.addParam("scalar","i32"),c.addParam("scalarLength","i32"),c.addParam("r","i32"),c.addLocal("old0","i32"),c.addLocal("nbits","i32"),c.addLocal("i","i32"),c.addLocal("last","i32"),c.addLocal("cur","i32"),c.addLocal("carry","i32"),c.addLocal("p","i32");const s=c.getCodeBuilder(),d=s.i32_const(t.alloc(a));function u(t){return s.i32_and(s.i32_shr_u(s.i32_load(s.i32_add(s.getLocal("scalar"),s.i32_and(s.i32_shr_u(t,s.i32_const(3)),s.i32_const(4294967292)))),s.i32_and(t,s.i32_const(31))),s.i32_const(1))}function g(t){return[...s.i32_store8(s.getLocal("p"),s.i32_const(t)),...s.setLocal("p",s.i32_add(s.getLocal("p"),s.i32_const(1)))]}c.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(l,s.getLocal("r")),...s.ret([])]),s.setLocal("nbits",s.i32_shl(s.getLocal("scalarLength"),s.i32_const(3))),s.setLocal("old0",s.i32_load(s.i32_const(0))),s.setLocal("p",s.getLocal("old0")),s.i32_store(s.i32_const(0),s.i32_and(s.i32_add(s.i32_add(s.getLocal("old0"),s.i32_const(32)),s.getLocal("nbits")),s.i32_const(4294967288))),s.setLocal("i",s.i32_const(1)),s.setLocal("last",u(s.i32_const(0))),s.setLocal("carry",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("nbits"))),s.setLocal("cur",u(s.getLocal("i"))),s.if(s.getLocal("last"),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(1)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(255)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(255)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...g(1)])),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(0)],[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...g(0)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...g(0)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...g(0)]))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.getLocal("last"),s.if(s.getLocal("carry"),[...g(255),...g(0),...g(1)],[...g(1)]),s.if(s.getLocal("carry"),[...g(0),...g(1)])),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.call(r,s.getLocal("base"),d),s.call(l,s.getLocal("r")),s.block(s.loop(s.call(o,s.getLocal("r"),s.getLocal("r")),s.setLocal("cur",s.i32_load8_u(s.getLocal("p"))),s.if(s.getLocal("cur"),s.if(s.i32_eq(s.getLocal("cur"),s.i32_const(1)),s.call(i,s.getLocal("r"),d,s.getLocal("r")),s.call(n,s.getLocal("r"),d,s.getLocal("r")))),s.br_if(1,s.i32_eq(s.getLocal("old0"),s.getLocal("p"))),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.br(0))),s.i32_store(s.i32_const(0),s.getLocal("old0")))},kt=function(t,e,a,i,o){const n=8*t.modules[e].n64;function r(){const i=t.addFunction(a);i.addParam("pBases","i32"),i.addParam("pScalars","i32"),i.addParam("scalarSize","i32"),i.addParam("n","i32"),i.addParam("pr","i32"),i.addLocal("chunkSize","i32"),i.addLocal("nChunks","i32"),i.addLocal("itScalar","i32"),i.addLocal("endScalar","i32"),i.addLocal("itBase","i32"),i.addLocal("itBit","i32"),i.addLocal("i","i32"),i.addLocal("j","i32"),i.addLocal("nTable","i32"),i.addLocal("pTable","i32"),i.addLocal("idx","i32"),i.addLocal("pIdxTable","i32");const o=i.getCodeBuilder(),r=o.i32_const(t.alloc(n)),l=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);i.addCode(o.call(e+"_zero",o.getLocal("pr")),o.if(o.i32_eqz(o.getLocal("n")),o.ret([])),o.setLocal("chunkSize",o.i32_load8_u(o.i32_clz(o.getLocal("n")),l)),o.setLocal("nChunks",o.i32_add(o.i32_div_u(o.i32_sub(o.i32_shl(o.getLocal("scalarSize"),o.i32_const(3)),o.i32_const(1)),o.getLocal("chunkSize")),o.i32_const(1))),o.setLocal("itBit",o.i32_mul(o.i32_sub(o.getLocal("nChunks"),o.i32_const(1)),o.getLocal("chunkSize"))),o.block(o.loop(o.br_if(1,o.i32_lt_s(o.getLocal("itBit"),o.i32_const(0))),o.if(o.i32_eqz(o.call(e+"_isZero",o.getLocal("pr"))),[...o.setLocal("j",o.i32_const(0)),...o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("j"),o.getLocal("chunkSize"))),o.call(e+"_double",o.getLocal("pr"),o.getLocal("pr")),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0)))]),o.call(a+"_chunk",o.getLocal("pBases"),o.getLocal("pScalars"),o.getLocal("scalarSize"),o.getLocal("n"),o.getLocal("itBit"),o.getLocal("chunkSize"),r),o.call(e+"_add",o.getLocal("pr"),r,o.getLocal("pr")),o.setLocal("itBit",o.i32_sub(o.getLocal("itBit"),o.getLocal("chunkSize"))),o.br(0))))}!function(){const e=t.addFunction(a+"_getChunk");e.addParam("pScalar","i32"),e.addParam("scalarSize","i32"),e.addParam("startBit","i32"),e.addParam("chunkSize","i32"),e.addLocal("bitsToEnd","i32"),e.addLocal("mask","i32"),e.setReturnType("i32");const i=e.getCodeBuilder();e.addCode(i.setLocal("bitsToEnd",i.i32_sub(i.i32_mul(i.getLocal("scalarSize"),i.i32_const(8)),i.getLocal("startBit"))),i.if(i.i32_gt_s(i.getLocal("chunkSize"),i.getLocal("bitsToEnd")),i.setLocal("mask",i.i32_sub(i.i32_shl(i.i32_const(1),i.getLocal("bitsToEnd")),i.i32_const(1))),i.setLocal("mask",i.i32_sub(i.i32_shl(i.i32_const(1),i.getLocal("chunkSize")),i.i32_const(1)))),i.i32_and(i.i32_shr_u(i.i32_load(i.i32_add(i.getLocal("pScalar"),i.i32_shr_u(i.getLocal("startBit"),i.i32_const(3))),0,0),i.i32_and(i.getLocal("startBit"),i.i32_const(7))),i.getLocal("mask")))}(),function(){const i=t.addFunction(a+"_reduceTable");i.addParam("pTable","i32"),i.addParam("p","i32"),i.addLocal("half","i32"),i.addLocal("it1","i32"),i.addLocal("it2","i32"),i.addLocal("pAcc","i32");const o=i.getCodeBuilder();i.addCode(o.if(o.i32_eq(o.getLocal("p"),o.i32_const(1)),o.ret([])),o.setLocal("half",o.i32_shl(o.i32_const(1),o.i32_sub(o.getLocal("p"),o.i32_const(1)))),o.setLocal("it1",o.getLocal("pTable")),o.setLocal("it2",o.i32_add(o.getLocal("pTable"),o.i32_mul(o.getLocal("half"),o.i32_const(n)))),o.setLocal("pAcc",o.i32_sub(o.getLocal("it2"),o.i32_const(n))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("it1"),o.getLocal("pAcc"))),o.call(e+"_add",o.getLocal("it1"),o.getLocal("it2"),o.getLocal("it1")),o.call(e+"_add",o.getLocal("pAcc"),o.getLocal("it2"),o.getLocal("pAcc")),o.setLocal("it1",o.i32_add(o.getLocal("it1"),o.i32_const(n))),o.setLocal("it2",o.i32_add(o.getLocal("it2"),o.i32_const(n))),o.br(0))),o.call(a+"_reduceTable",o.getLocal("pTable"),o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.setLocal("p",o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("p"))),o.call(e+"_double",o.getLocal("pAcc"),o.getLocal("pAcc")),o.setLocal("p",o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.br(0))),o.call(e+"_add",o.getLocal("pTable"),o.getLocal("pAcc"),o.getLocal("pTable")))}(),function(){const r=t.addFunction(a+"_chunk");r.addParam("pBases","i32"),r.addParam("pScalars","i32"),r.addParam("scalarSize","i32"),r.addParam("n","i32"),r.addParam("startBit","i32"),r.addParam("chunkSize","i32"),r.addParam("pr","i32"),r.addLocal("nChunks","i32"),r.addLocal("itScalar","i32"),r.addLocal("endScalar","i32"),r.addLocal("itBase","i32"),r.addLocal("i","i32"),r.addLocal("j","i32"),r.addLocal("nTable","i32"),r.addLocal("pTable","i32"),r.addLocal("idx","i32"),r.addLocal("pIdxTable","i32");const l=r.getCodeBuilder();r.addCode(l.if(l.i32_eqz(l.getLocal("n")),[...l.call(e+"_zero",l.getLocal("pr")),...l.ret([])]),l.setLocal("nTable",l.i32_shl(l.i32_const(1),l.getLocal("chunkSize"))),l.setLocal("pTable",l.i32_load(l.i32_const(0))),l.i32_store(l.i32_const(0),l.i32_add(l.getLocal("pTable"),l.i32_mul(l.getLocal("nTable"),l.i32_const(n)))),l.setLocal("j",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("j"),l.getLocal("nTable"))),l.call(e+"_zero",l.i32_add(l.getLocal("pTable"),l.i32_mul(l.getLocal("j"),l.i32_const(n)))),l.setLocal("j",l.i32_add(l.getLocal("j"),l.i32_const(1))),l.br(0))),l.setLocal("itBase",l.getLocal("pBases")),l.setLocal("itScalar",l.getLocal("pScalars")),l.setLocal("endScalar",l.i32_add(l.getLocal("pScalars"),l.i32_mul(l.getLocal("n"),l.getLocal("scalarSize")))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("itScalar"),l.getLocal("endScalar"))),l.setLocal("idx",l.call(a+"_getChunk",l.getLocal("itScalar"),l.getLocal("scalarSize"),l.getLocal("startBit"),l.getLocal("chunkSize"))),l.if(l.getLocal("idx"),[...l.setLocal("pIdxTable",l.i32_add(l.getLocal("pTable"),l.i32_mul(l.i32_sub(l.getLocal("idx"),l.i32_const(1)),l.i32_const(n)))),...l.call(i,l.getLocal("pIdxTable"),l.getLocal("itBase"),l.getLocal("pIdxTable"))]),l.setLocal("itScalar",l.i32_add(l.getLocal("itScalar"),l.getLocal("scalarSize"))),l.setLocal("itBase",l.i32_add(l.getLocal("itBase"),l.i32_const(o))),l.br(0))),l.call(a+"_reduceTable",l.getLocal("pTable"),l.getLocal("chunkSize")),l.call(e+"_copy",l.getLocal("pTable"),l.getLocal("pr")),l.i32_store(l.i32_const(0),l.getLocal("pTable")))}(),r(),t.exportFunction(a),t.exportFunction(a+"_chunk")},Tt=function(t,e,a,i){const o=t.modules[a].n64,n=8*o;if(t.modules[e])return e;return t.modules[e]={n64:3*o},function(){const i=t.addFunction(e+"_isZeroAffine");i.addParam("p1","i32"),i.setReturnType("i32");const o=i.getCodeBuilder();i.addCode(o.i32_and(o.call(a+"_isZero",o.getLocal("p1")),o.call(a+"_isZero",o.i32_add(o.getLocal("p1"),o.i32_const(n)))))}(),function(){const i=t.addFunction(e+"_isZero");i.addParam("p1","i32"),i.setReturnType("i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_isZero",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))))}(),function(){const i=t.addFunction(e+"_zeroAffine");i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_zero",o.getLocal("pr"))),i.addCode(o.call(a+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(n))))}(),function(){const i=t.addFunction(e+"_zero");i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_zero",o.getLocal("pr"))),i.addCode(o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(n)))),i.addCode(o.call(a+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))))}(),function(){const a=t.addFunction(e+"_copyAffine");a.addParam("ps","i32"),a.addParam("pd","i32");const i=a.getCodeBuilder();for(let t=0;t<2*o;t++)a.addCode(i.i64_store(i.getLocal("pd"),8*t,i.i64_load(i.getLocal("ps"),8*t)))}(),function(){const a=t.addFunction(e+"_copy");a.addParam("ps","i32"),a.addParam("pd","i32");const i=a.getCodeBuilder();for(let t=0;t<3*o;t++)a.addCode(i.i64_store(i.getLocal("pd"),8*t,i.i64_load(i.getLocal("ps"),8*t)))}(),function(){const i=t.addFunction(e+"_toJacobian");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n)),c=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(n)),d=o.i32_add(o.getLocal("pr"),o.i32_const(2*n));i.addCode(o.if(o.call(e+"_isZeroAffine",o.getLocal("p1")),o.call(e+"_zero",o.getLocal("pr")),[...o.call(a+"_one",d),...o.call(a+"_copy",l,s),...o.call(a+"_copy",r,c)]))}(),function(){const i=t.addFunction(e+"_eqAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder();i.addCode(o.ret(o.i32_and(o.call(a+"_eq",o.getLocal("p1"),o.getLocal("p2")),o.call(a+"_eq",o.i32_add(o.getLocal("p1"),o.i32_const(n)),o.i32_add(o.getLocal("p2"),o.i32_const(n))))))}(),function(){const i=t.addFunction(e+"_eqMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const c=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n)),u=o.i32_const(t.alloc(n)),g=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),o.ret(o.call(e+"_isZeroAffine",o.getLocal("p2")))),o.if(o.call(e+"_isZeroAffine",o.getLocal("p2")),o.ret(o.i32_const(0))),o.if(o.call(a+"_isOne",c),o.ret(o.call(e+"_eqAffine",o.getLocal("p1"),o.getLocal("p2")))),o.call(a+"_square",c,u),o.call(a+"_mul",s,u,g),o.call(a+"_mul",c,u,f),o.call(a+"_mul",d,f,_),o.if(o.call(a+"_eq",r,g),o.if(o.call(a+"_eq",l,_),o.ret(o.i32_const(1)))),o.ret(o.i32_const(0)))}(),function(){const i=t.addFunction(e+"_eq");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32"),i.addLocal("z2","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const c=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n));i.addCode(o.setLocal("z2",o.i32_add(o.getLocal("p2"),o.i32_const(2*n))));const u=o.getLocal("z2"),g=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),o.ret(o.call(e+"_isZero",o.getLocal("p2")))),o.if(o.call(e+"_isZero",o.getLocal("p2")),o.ret(o.i32_const(0))),o.if(o.call(a+"_isOne",c),o.ret(o.call(e+"_eqMixed",o.getLocal("p2"),o.getLocal("p1")))),o.if(o.call(a+"_isOne",u),o.ret(o.call(e+"_eqMixed",o.getLocal("p1"),o.getLocal("p2")))),o.call(a+"_square",c,g),o.call(a+"_square",u,f),o.call(a+"_mul",r,f,_),o.call(a+"_mul",s,g,p),o.call(a+"_mul",c,g,h),o.call(a+"_mul",u,f,m),o.call(a+"_mul",l,m,L),o.call(a+"_mul",d,h,w),o.if(o.call(a+"_eq",_,p),o.if(o.call(a+"_eq",L,w),o.ret(o.i32_const(1)))),o.ret(o.i32_const(0)))}(),function(){const i=t.addFunction(e+"_doubleAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n)),c=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(n)),d=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),u=o.i32_const(t.alloc(n)),g=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZeroAffine",o.getLocal("p1")),[...o.call(e+"_toJacobian",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.call(a+"_square",r,u),o.call(a+"_square",l,g),o.call(a+"_square",g,f),o.call(a+"_add",r,g,_),o.call(a+"_square",_,_),o.call(a+"_sub",_,u,_),o.call(a+"_sub",_,f,_),o.call(a+"_add",_,_,_),o.call(a+"_add",u,u,p),o.call(a+"_add",p,u,p),o.call(a+"_add",l,l,d),o.call(a+"_square",p,c),o.call(a+"_sub",c,_,c),o.call(a+"_sub",c,_,c),o.call(a+"_add",f,f,h),o.call(a+"_add",h,h,h),o.call(a+"_add",h,h,h),o.call(a+"_sub",_,c,s),o.call(a+"_mul",s,p,s),o.call(a+"_sub",s,h,s))}(),function(){const i=t.addFunction(e+"_double");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n)),c=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),g=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(e+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isOne",c),[...o.ret(o.call(e+"_doubleAffine",o.getLocal("p1"),o.getLocal("pr"))),...o.ret([])]),o.call(a+"_square",r,g),o.call(a+"_square",l,f),o.call(a+"_square",f,_),o.call(a+"_add",r,f,p),o.call(a+"_square",p,p),o.call(a+"_sub",p,g,p),o.call(a+"_sub",p,_,p),o.call(a+"_add",p,p,p),o.call(a+"_add",g,g,h),o.call(a+"_add",h,g,h),o.call(a+"_square",h,m),o.call(a+"_mul",l,c,L),o.call(a+"_add",p,p,s),o.call(a+"_sub",m,s,s),o.call(a+"_add",_,_,w),o.call(a+"_add",w,w,w),o.call(a+"_add",w,w,w),o.call(a+"_sub",p,s,d),o.call(a+"_mul",d,h,d),o.call(a+"_sub",d,w,d),o.call(a+"_add",L,L,u))}(),function(){const i=t.addFunction(e+"_addAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const c=o.getLocal("p2"),s=o.i32_add(o.getLocal("p2"),o.i32_const(n)),d=o.getLocal("pr"),u=o.i32_add(o.getLocal("pr"),o.i32_const(n)),g=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),f=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n)),A=o.i32_const(t.alloc(n)),b=o.i32_const(t.alloc(n)),y=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZeroAffine",o.getLocal("p1")),[...o.call(e+"_copyAffine",o.getLocal("p2"),o.getLocal("pr")),...o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))),...o.ret([])]),o.if(o.call(e+"_isZeroAffine",o.getLocal("p2")),[...o.call(e+"_copyAffine",o.getLocal("p1"),o.getLocal("pr")),...o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))),...o.ret([])]),o.if(o.call(a+"_eq",r,c),o.if(o.call(a+"_eq",l,s),[...o.call(e+"_doubleAffine",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])])),o.call(a+"_sub",c,r,f),o.call(a+"_sub",s,l,p),o.call(a+"_square",f,_),o.call(a+"_add",_,_,h),o.call(a+"_add",h,h,h),o.call(a+"_mul",f,h,m),o.call(a+"_add",p,p,L),o.call(a+"_mul",r,h,A),o.call(a+"_square",L,w),o.call(a+"_add",A,A,b),o.call(a+"_sub",w,m,d),o.call(a+"_sub",d,b,d),o.call(a+"_mul",l,m,y),o.call(a+"_add",y,y,y),o.call(a+"_sub",A,d,u),o.call(a+"_mul",u,L,u),o.call(a+"_sub",u,y,u),o.call(a+"_add",f,f,g))}(),function(){const i=t.addFunction(e+"_addMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const c=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n)),u=o.getLocal("pr"),g=o.i32_add(o.getLocal("pr"),o.i32_const(n)),f=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),_=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n)),A=o.i32_const(t.alloc(n)),b=o.i32_const(t.alloc(n)),y=o.i32_const(t.alloc(n)),I=o.i32_const(t.alloc(n)),C=o.i32_const(t.alloc(n)),F=o.i32_const(t.alloc(n)),x=o.i32_const(t.alloc(n)),v=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(e+"_copyAffine",o.getLocal("p2"),o.getLocal("pr")),...o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))),...o.ret([])]),o.if(o.call(e+"_isZeroAffine",o.getLocal("p2")),[...o.call(e+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isOne",c),[...o.call(e+"_addAffine",r,s,u),...o.ret([])]),o.call(a+"_square",c,_),o.call(a+"_mul",s,_,p),o.call(a+"_mul",c,_,h),o.call(a+"_mul",d,h,m),o.if(o.call(a+"_eq",r,p),o.if(o.call(a+"_eq",l,m),[...o.call(e+"_doubleAffine",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])])),o.call(a+"_sub",p,r,L),o.call(a+"_sub",m,l,A),o.call(a+"_square",L,w),o.call(a+"_add",w,w,b),o.call(a+"_add",b,b,b),o.call(a+"_mul",L,b,y),o.call(a+"_add",A,A,I),o.call(a+"_mul",r,b,F),o.call(a+"_square",I,C),o.call(a+"_add",F,F,x),o.call(a+"_sub",C,y,u),o.call(a+"_sub",u,x,u),o.call(a+"_mul",l,y,v),o.call(a+"_add",v,v,v),o.call(a+"_sub",F,u,g),o.call(a+"_mul",g,I,g),o.call(a+"_sub",g,v,g),o.call(a+"_add",c,L,f),o.call(a+"_square",f,f),o.call(a+"_sub",f,_,f),o.call(a+"_sub",f,w,f))}(),function(){const i=t.addFunction(e+"_add");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32"),i.addLocal("z2","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const c=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n));i.addCode(o.setLocal("z2",o.i32_add(o.getLocal("p2"),o.i32_const(2*n))));const u=o.getLocal("z2"),g=o.getLocal("pr"),f=o.i32_add(o.getLocal("pr"),o.i32_const(n)),_=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n)),A=o.i32_const(t.alloc(n)),b=o.i32_const(t.alloc(n)),y=o.i32_const(t.alloc(n)),I=o.i32_const(t.alloc(n)),C=o.i32_const(t.alloc(n)),F=o.i32_const(t.alloc(n)),x=o.i32_const(t.alloc(n)),v=o.i32_const(t.alloc(n)),E=o.i32_const(t.alloc(n)),B=o.i32_const(t.alloc(n)),S=o.i32_const(t.alloc(n)),G=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(e+"_copy",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(e+"_isZero",o.getLocal("p2")),[...o.call(e+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isOne",c),[...o.call(e+"_addMixed",s,r,g),...o.ret([])]),o.if(o.call(a+"_isOne",u),[...o.call(e+"_addMixed",r,s,g),...o.ret([])]),o.call(a+"_square",c,p),o.call(a+"_square",u,h),o.call(a+"_mul",r,h,m),o.call(a+"_mul",s,p,L),o.call(a+"_mul",c,p,w),o.call(a+"_mul",u,h,A),o.call(a+"_mul",l,A,b),o.call(a+"_mul",d,w,y),o.if(o.call(a+"_eq",m,L),o.if(o.call(a+"_eq",b,y),[...o.call(e+"_double",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])])),o.call(a+"_sub",L,m,I),o.call(a+"_sub",y,b,C),o.call(a+"_add",I,I,F),o.call(a+"_square",F,F),o.call(a+"_mul",I,F,x),o.call(a+"_add",C,C,v),o.call(a+"_mul",m,F,B),o.call(a+"_square",v,E),o.call(a+"_add",B,B,S),o.call(a+"_sub",E,x,g),o.call(a+"_sub",g,S,g),o.call(a+"_mul",b,x,G),o.call(a+"_add",G,G,G),o.call(a+"_sub",B,g,f),o.call(a+"_mul",f,v,f),o.call(a+"_sub",f,G,f),o.call(a+"_add",c,u,_),o.call(a+"_square",_,_),o.call(a+"_sub",_,p,_),o.call(a+"_sub",_,h,_),o.call(a+"_mul",_,I,_))}(),function(){const i=t.addFunction(e+"_negAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n)),c=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(n));i.addCode(o.call(a+"_copy",r,c),o.call(a+"_neg",l,s))}(),function(){const i=t.addFunction(e+"_neg");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n)),c=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*n));i.addCode(o.call(a+"_copy",r,s),o.call(a+"_neg",l,d),o.call(a+"_copy",c,u))}(),function(){const a=t.addFunction(e+"_subAffine");a.addParam("p1","i32"),a.addParam("p2","i32"),a.addParam("pr","i32");const i=a.getCodeBuilder(),o=i.i32_const(t.alloc(3*n));a.addCode(i.call(e+"_negAffine",i.getLocal("p2"),o),i.call(e+"_addAffine",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){const a=t.addFunction(e+"_subMixed");a.addParam("p1","i32"),a.addParam("p2","i32"),a.addParam("pr","i32");const i=a.getCodeBuilder(),o=i.i32_const(t.alloc(3*n));a.addCode(i.call(e+"_negAffine",i.getLocal("p2"),o),i.call(e+"_addMixed",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){const a=t.addFunction(e+"_sub");a.addParam("p1","i32"),a.addParam("p2","i32"),a.addParam("pr","i32");const i=a.getCodeBuilder(),o=i.i32_const(t.alloc(3*n));a.addCode(i.call(e+"_neg",i.getLocal("p2"),o),i.call(e+"_add",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){const i=t.addFunction(e+"_fromMontgomeryAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_fromMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<2;t++)i.addCode(o.call(a+"_fromMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(e+"_fromMontgomery");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_fromMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<3;t++)i.addCode(o.call(a+"_fromMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(e+"_toMontgomeryAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_toMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<2;t++)i.addCode(o.call(a+"_toMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(e+"_toMontgomery");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_toMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<3;t++)i.addCode(o.call(a+"_toMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(e+"_toAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n)),c=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_const(t.alloc(n)),g=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(a+"_zero",s),...o.call(a+"_zero",d)],[...o.call(a+"_inverse",c,u),...o.call(a+"_square",u,g),...o.call(a+"_mul",u,g,f),...o.call(a+"_mul",r,g,s),...o.call(a+"_mul",l,f,d)]))}(),function(){const o=t.addFunction(e+"_inCurveAffine");o.addParam("pIn","i32"),o.setReturnType("i32");const r=o.getCodeBuilder(),l=r.getLocal("pIn"),c=r.i32_add(r.getLocal("pIn"),r.i32_const(n)),s=r.i32_const(t.alloc(n)),d=r.i32_const(t.alloc(n));o.addCode(r.call(a+"_square",c,s),r.call(a+"_square",l,d),r.call(a+"_mul",l,d,d),r.call(a+"_add",d,r.i32_const(i),d),r.ret(r.call(a+"_eq",s,d)))}(),function(){const a=t.addFunction(e+"_inCurve");a.addParam("pIn","i32"),a.setReturnType("i32");const i=a.getCodeBuilder(),o=i.i32_const(t.alloc(2*n));a.addCode(i.call(e+"_toAffine",i.getLocal("pIn"),o),i.ret(i.call(e+"_inCurveAffine",o)))}(),function(){const i=t.addFunction(e+"_batchToAffine");i.addParam("pIn","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addLocal("pAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itAux","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");const o=i.getCodeBuilder(),r=o.i32_const(t.alloc(n));i.addCode(o.setLocal("pAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("pAux"),o.i32_mul(o.getLocal("n"),o.i32_const(n)))),o.call(a+"_batchInverse",o.i32_add(o.getLocal("pIn"),o.i32_const(2*n)),o.i32_const(3*n),o.getLocal("n"),o.getLocal("pAux"),o.i32_const(n)),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.getLocal("pAux")),o.setLocal("itOut",o.getLocal("pOut")),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(a+"_isZero",o.getLocal("itAux")),[...o.call(a+"_zero",o.getLocal("itOut")),...o.call(a+"_zero",o.i32_add(o.getLocal("itOut"),o.i32_const(n)))],[...o.call(a+"_mul",o.getLocal("itAux"),o.i32_add(o.getLocal("itIn"),o.i32_const(n)),r),...o.call(a+"_square",o.getLocal("itAux"),o.getLocal("itAux")),...o.call(a+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.getLocal("itOut")),...o.call(a+"_mul",o.getLocal("itAux"),r,o.i32_add(o.getLocal("itOut"),o.i32_const(n)))]),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.i32_const(3*n))),o.setLocal("itOut",o.i32_add(o.getLocal("itOut"),o.i32_const(2*n))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.i32_store(o.i32_const(0),o.getLocal("pAux")))}(),function(){const i=t.addFunction(e+"_normalize");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),r=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(n)),c=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),g=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),o.call(e+"_zero",o.getLocal("pr")),[...o.call(a+"_inverse",c,g),...o.call(a+"_square",g,f),...o.call(a+"_mul",g,f,_),...o.call(a+"_mul",r,f,s),...o.call(a+"_mul",l,_,d),...o.call(a+"_one",u)]))}(),function(){const a=t.addFunction(e+"__reverseBytes");a.addParam("pIn","i32"),a.addParam("n","i32"),a.addParam("pOut","i32"),a.addLocal("itOut","i32"),a.addLocal("itIn","i32");const i=a.getCodeBuilder();a.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}(),function(){const a=t.addFunction(e+"_LEMtoU");a.addParam("pIn","i32"),a.addParam("pOut","i32");const i=a.getCodeBuilder(),o=t.alloc(2*n),r=i.i32_const(o),l=i.i32_const(o),c=i.i32_const(o+n);a.addCode(i.if(i.call(e+"_isZeroAffine",i.getLocal("pIn")),[...i.call(e+"_zeroAffine",i.getLocal("pOut")),...i.i32_store8(i.getLocal("pOut"),i.i32_const(64)),...i.ret([])]),i.call(e+"_fromMontgomeryAffine",i.getLocal("pIn"),r),i.call(e+"__reverseBytes",l,i.i32_const(n),i.getLocal("pOut")),i.call(e+"__reverseBytes",c,i.i32_const(n),i.i32_add(i.getLocal("pOut"),i.i32_const(n))))}(),function(){const i=t.addFunction(e+"_LEMtoC");i.addParam("pIn","i32"),i.addParam("pOut","i32");const o=i.getCodeBuilder(),r=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("pIn")),[...o.call(a+"_zero",o.getLocal("pOut")),...o.i32_store8(o.getLocal("pOut"),o.i32_const(64)),...o.ret([])]),o.call(a+"_fromMontgomery",o.getLocal("pIn"),r),o.call(e+"__reverseBytes",r,o.i32_const(n),o.getLocal("pOut")),o.if(o.i32_eq(o.call(a+"_sign",o.i32_add(o.getLocal("pIn"),o.i32_const(n))),o.i32_const(-1)),o.i32_store8(o.getLocal("pOut"),o.i32_or(o.i32_load8_u(o.getLocal("pOut")),o.i32_const(128)))))}(),function(){const a=t.addFunction(e+"_UtoLEM");a.addParam("pIn","i32"),a.addParam("pOut","i32");const i=a.getCodeBuilder(),o=t.alloc(2*n),r=i.i32_const(o),l=i.i32_const(o),c=i.i32_const(o+n);a.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(e+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(e+"__reverseBytes",i.getLocal("pIn"),i.i32_const(n),l),i.call(e+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(n)),i.i32_const(n),c),i.call(e+"_toMontgomeryAffine",r,i.getLocal("pOut")))}(),function(){const o=t.addFunction(e+"_CtoLEM");o.addParam("pIn","i32"),o.addParam("pOut","i32"),o.addLocal("firstByte","i32"),o.addLocal("greatest","i32");const r=o.getCodeBuilder(),l=t.alloc(2*n),c=r.i32_const(l),s=r.i32_const(l+n);o.addCode(r.setLocal("firstByte",r.i32_load8_u(r.getLocal("pIn"))),r.if(r.i32_and(r.getLocal("firstByte"),r.i32_const(64)),[...r.call(e+"_zeroAffine",r.getLocal("pOut")),...r.ret([])]),r.setLocal("greatest",r.i32_and(r.getLocal("firstByte"),r.i32_const(128))),r.call(a+"_copy",r.getLocal("pIn"),s),r.i32_store8(s,r.i32_and(r.getLocal("firstByte"),r.i32_const(63))),r.call(e+"__reverseBytes",s,r.i32_const(n),c),r.call(a+"_toMontgomery",c,r.getLocal("pOut")),r.call(a+"_square",r.getLocal("pOut"),s),r.call(a+"_mul",r.getLocal("pOut"),s,s),r.call(a+"_add",s,r.i32_const(i),s),r.call(a+"_sqrt",s,s),r.call(a+"_neg",s,c),r.if(r.i32_eq(r.call(a+"_sign",s),r.i32_const(-1)),r.if(r.getLocal("greatest"),r.call(a+"_copy",s,r.i32_add(r.getLocal("pOut"),r.i32_const(n))),r.call(a+"_neg",s,r.i32_add(r.getLocal("pOut"),r.i32_const(n)))),r.if(r.getLocal("greatest"),r.call(a+"_neg",s,r.i32_add(r.getLocal("pOut"),r.i32_const(n))),r.call(a+"_copy",s,r.i32_add(r.getLocal("pOut"),r.i32_const(n))))))}(),Pt(t,e+"_batchLEMtoU",e+"_LEMtoU",2*n,2*n),Pt(t,e+"_batchLEMtoC",e+"_LEMtoC",2*n,n),Pt(t,e+"_batchUtoLEM",e+"_UtoLEM",2*n,2*n),Pt(t,e+"_batchCtoLEM",e+"_CtoLEM",n,2*n,!0),Pt(t,e+"_batchToJacobian",e+"_toJacobian",2*n,3*n,!0),kt(t,e,e+"_multiexp",e+"_add",3*n),kt(t,e,e+"_multiexpAffine",e+"_addMixed",2*n),Mt(t,e+"_timesScalar",3*n,e+"_add",e+"_double",e+"_sub",e+"_copy",e+"_zero"),Mt(t,e+"_timesScalarAffine",2*n,e+"_addMixed",e+"_double",e+"_subMixed",e+"_copyAffine",e+"_zero"),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_isZeroAffine"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_eqMixed"),t.exportFunction(e+"_eqAffine"),t.exportFunction(e+"_copy"),t.exportFunction(e+"_copyAffine"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_zeroAffine"),t.exportFunction(e+"_double"),t.exportFunction(e+"_doubleAffine"),t.exportFunction(e+"_add"),t.exportFunction(e+"_addMixed"),t.exportFunction(e+"_addAffine"),t.exportFunction(e+"_neg"),t.exportFunction(e+"_negAffine"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_subMixed"),t.exportFunction(e+"_subAffine"),t.exportFunction(e+"_fromMontgomery"),t.exportFunction(e+"_fromMontgomeryAffine"),t.exportFunction(e+"_toMontgomery"),t.exportFunction(e+"_toMontgomeryAffine"),t.exportFunction(e+"_timesScalar"),t.exportFunction(e+"_timesScalarAffine"),t.exportFunction(e+"_normalize"),t.exportFunction(e+"_LEMtoU"),t.exportFunction(e+"_LEMtoC"),t.exportFunction(e+"_UtoLEM"),t.exportFunction(e+"_CtoLEM"),t.exportFunction(e+"_batchLEMtoU"),t.exportFunction(e+"_batchLEMtoC"),t.exportFunction(e+"_batchUtoLEM"),t.exportFunction(e+"_batchCtoLEM"),t.exportFunction(e+"_toAffine"),t.exportFunction(e+"_toJacobian"),t.exportFunction(e+"_batchToAffine"),t.exportFunction(e+"_batchToJacobian"),t.exportFunction(e+"_inCurve"),t.exportFunction(e+"_inCurveAffine"),e},Rt=function(t,e,a,i,o){const n=8*t.modules[i].n64,r=8*t.modules[a].n64,l=t.modules[i].q;let c=l.minus(u(1)),s=0;for(;!c.isOdd();)s++,c=c.shiftRight(1);let d=u(2);for(;d.modPow(l.shiftRight(1),l).equals(1);)d=d.add(1);const g=new Array(s+1);g[s]=d.modPow(c,l);let f=s-1;for(;f>=0;)g[f]=g[f+1].modPow(2,l),f--;const _=[],p=u(1).shiftLeft(8*n).mod(l);for(let t=0;t<g.length;t++){const e=g[t].times(p).mod(l);_.push(...Et(e,n))}const h=t.alloc(_),m=new Array(s+1);m[0]=u(1);for(let t=1;t<=s;t++)m[t]=m[t-1].times(2);const L=[];for(let t=0;t<=s;t++){const e=m[t].modInv(l).times(p).mod(l);L.push(...Et(e,n))}const w=t.alloc(L),A=d.modPow(2,l),b=[],y=[];for(let t=0;t<=s;t++){const e=A.modPow(u(2).pow(t),l),a=l.add(u.one).minus(e).modInv(l);b.push(...Et(e.times(p).mod(l),n)),y.push(...Et(a.times(p).mod(l),n))}const I=t.alloc(b),C=t.alloc(y);function F(t){let e=0;for(let a=0;a<8;a++)t&1<<a&&(e|=128>>a);return e}const x=Array(256);for(let t=0;t<256;t++)x[t]=F(t);const v=t.alloc(x);function E(){const a=t.addFunction(e+"_fft");a.addParam("px","i32"),a.addParam("n","i32"),a.addLocal("bits","i32");const o=a.getCodeBuilder(),r=o.i32_const(t.alloc(n));a.addCode(o.setLocal("bits",o.call(e+"__log2",o.getLocal("n"))),o.call(i+"_one",r),o.call(e+"_rawfft",o.getLocal("px"),o.getLocal("bits"),o.i32_const(0),r))}!function(){const a=t.addFunction(e+"__rev");a.addParam("x","i32"),a.addParam("bits","i32"),a.setReturnType("i32");const i=a.getCodeBuilder();a.addCode(i.i32_rotl(i.i32_add(i.i32_add(i.i32_shl(i.i32_load8_u(i.i32_and(i.getLocal("x"),i.i32_const(255)),v,0),i.i32_const(24)),i.i32_shl(i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(8)),i.i32_const(255)),v,0),i.i32_const(16))),i.i32_add(i.i32_shl(i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(16)),i.i32_const(255)),v,0),i.i32_const(8)),i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(24)),i.i32_const(255)),v,0))),i.getLocal("bits")))}(),function(){const i=t.addFunction(e+"__reversePermutation");i.addParam("px","i32"),i.addParam("bits","i32"),i.addLocal("n","i32"),i.addLocal("i","i32"),i.addLocal("ri","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(r));i.addCode(o.setLocal("n",o.i32_shl(o.i32_const(1),o.getLocal("bits"))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.setLocal("idx1",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("i"),o.i32_const(r)))),o.setLocal("ri",o.call(e+"__rev",o.getLocal("i"),o.getLocal("bits"))),o.setLocal("idx2",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("ri"),o.i32_const(r)))),o.if(o.i32_lt_u(o.getLocal("i"),o.getLocal("ri")),[...o.call(a+"_copy",o.getLocal("idx1"),n),...o.call(a+"_copy",o.getLocal("idx2"),o.getLocal("idx1")),...o.call(a+"_copy",n,o.getLocal("idx2"))]),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){const n=t.addFunction(e+"__fftFinal");n.addParam("px","i32"),n.addParam("bits","i32"),n.addParam("reverse","i32"),n.addParam("mulFactor","i32"),n.addLocal("n","i32"),n.addLocal("ndiv2","i32"),n.addLocal("pInv2","i32"),n.addLocal("i","i32"),n.addLocal("mask","i32"),n.addLocal("idx1","i32"),n.addLocal("idx2","i32");const l=n.getCodeBuilder(),c=l.i32_const(t.alloc(r));n.addCode(l.if(l.i32_and(l.i32_eqz(l.getLocal("reverse")),l.call(i+"_isOne",l.getLocal("mulFactor"))),l.ret([])),l.setLocal("n",l.i32_shl(l.i32_const(1),l.getLocal("bits"))),l.setLocal("mask",l.i32_sub(l.getLocal("n"),l.i32_const(1))),l.setLocal("i",l.i32_const(1)),l.setLocal("ndiv2",l.i32_shr_u(l.getLocal("n"),l.i32_const(1))),l.block(l.loop(l.br_if(1,l.i32_ge_u(l.getLocal("i"),l.getLocal("ndiv2"))),l.setLocal("idx1",l.i32_add(l.getLocal("px"),l.i32_mul(l.getLocal("i"),l.i32_const(r)))),l.setLocal("idx2",l.i32_add(l.getLocal("px"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.getLocal("i")),l.i32_const(r)))),l.if(l.getLocal("reverse"),l.if(l.call(i+"_isOne",l.getLocal("mulFactor")),[...l.call(a+"_copy",l.getLocal("idx1"),c),...l.call(a+"_copy",l.getLocal("idx2"),l.getLocal("idx1")),...l.call(a+"_copy",c,l.getLocal("idx2"))],[...l.call(a+"_copy",l.getLocal("idx1"),c),...l.call(o,l.getLocal("idx2"),l.getLocal("mulFactor"),l.getLocal("idx1")),...l.call(o,c,l.getLocal("mulFactor"),l.getLocal("idx2"))]),l.if(l.call(i+"_isOne",l.getLocal("mulFactor")),[],[...l.call(o,l.getLocal("idx1"),l.getLocal("mulFactor"),l.getLocal("idx1")),...l.call(o,l.getLocal("idx2"),l.getLocal("mulFactor"),l.getLocal("idx2"))])),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))),l.if(l.call(i+"_isOne",l.getLocal("mulFactor")),[],[...l.call(o,l.getLocal("px"),l.getLocal("mulFactor"),l.getLocal("px")),...l.setLocal("idx2",l.i32_add(l.getLocal("px"),l.i32_mul(l.getLocal("ndiv2"),l.i32_const(r)))),...l.call(o,l.getLocal("idx2"),l.getLocal("mulFactor"),l.getLocal("idx2"))]))}(),function(){const l=t.addFunction(e+"_rawfft");l.addParam("px","i32"),l.addParam("bits","i32"),l.addParam("reverse","i32"),l.addParam("mulFactor","i32"),l.addLocal("s","i32"),l.addLocal("k","i32"),l.addLocal("j","i32"),l.addLocal("m","i32"),l.addLocal("mdiv2","i32"),l.addLocal("n","i32"),l.addLocal("pwm","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32");const c=l.getCodeBuilder(),s=c.i32_const(t.alloc(n)),d=c.i32_const(t.alloc(r)),u=c.i32_const(t.alloc(r));l.addCode(c.call(e+"__reversePermutation",c.getLocal("px"),c.getLocal("bits")),c.setLocal("n",c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.setLocal("s",c.i32_const(1)),c.block(c.loop(c.br_if(1,c.i32_gt_u(c.getLocal("s"),c.getLocal("bits"))),c.setLocal("m",c.i32_shl(c.i32_const(1),c.getLocal("s"))),c.setLocal("pwm",c.i32_add(c.i32_const(h),c.i32_mul(c.getLocal("s"),c.i32_const(n)))),c.setLocal("k",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("k"),c.getLocal("n"))),c.call(i+"_one",s),c.setLocal("mdiv2",c.i32_shr_u(c.getLocal("m"),c.i32_const(1))),c.setLocal("j",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("j"),c.getLocal("mdiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("px"),c.i32_mul(c.i32_add(c.getLocal("k"),c.getLocal("j")),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("idx1"),c.i32_mul(c.getLocal("mdiv2"),c.i32_const(r)))),c.call(o,c.getLocal("idx2"),s,d),c.call(a+"_copy",c.getLocal("idx1"),u),c.call(a+"_add",u,d,c.getLocal("idx1")),c.call(a+"_sub",u,d,c.getLocal("idx2")),c.call(i+"_mul",s,c.getLocal("pwm"),s),c.setLocal("j",c.i32_add(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("k",c.i32_add(c.getLocal("k"),c.getLocal("m"))),c.br(0))),c.setLocal("s",c.i32_add(c.getLocal("s"),c.i32_const(1))),c.br(0))),c.call(e+"__fftFinal",c.getLocal("px"),c.getLocal("bits"),c.getLocal("reverse"),c.getLocal("mulFactor")))}(),function(){const a=t.addFunction(e+"__log2");a.addParam("n","i32"),a.setReturnType("i32"),a.addLocal("bits","i32"),a.addLocal("aux","i32");const i=a.getCodeBuilder();a.addCode(i.setLocal("aux",i.i32_shr_u(i.getLocal("n"),i.i32_const(1)))),a.addCode(i.setLocal("bits",i.i32_const(0))),a.addCode(i.block(i.loop(i.br_if(1,i.i32_eqz(i.getLocal("aux"))),i.setLocal("aux",i.i32_shr_u(i.getLocal("aux"),i.i32_const(1))),i.setLocal("bits",i.i32_add(i.getLocal("bits"),i.i32_const(1))),i.br(0)))),a.addCode(i.if(i.i32_ne(i.getLocal("n"),i.i32_shl(i.i32_const(1),i.getLocal("bits"))),i.unreachable())),a.addCode(i.if(i.i32_gt_u(i.getLocal("bits"),i.i32_const(s)),i.unreachable())),a.addCode(i.getLocal("bits"))}(),E(),function(){const a=t.addFunction(e+"_ifft");a.addParam("px","i32"),a.addParam("n","i32"),a.addLocal("bits","i32"),a.addLocal("pInv2","i32");const i=a.getCodeBuilder();a.addCode(i.setLocal("bits",i.call(e+"__log2",i.getLocal("n"))),i.setLocal("pInv2",i.i32_add(i.i32_const(w),i.i32_mul(i.getLocal("bits"),i.i32_const(n)))),i.call(e+"_rawfft",i.getLocal("px"),i.getLocal("bits"),i.i32_const(1),i.getLocal("pInv2")))}(),function(){const l=t.addFunction(e+"_fftJoin");l.addParam("pBuff1","i32"),l.addParam("pBuff2","i32"),l.addParam("n","i32"),l.addParam("first","i32"),l.addParam("inc","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32");const c=l.getCodeBuilder(),s=c.i32_const(t.alloc(n)),d=c.i32_const(t.alloc(r)),u=c.i32_const(t.alloc(r));l.addCode(c.call(i+"_copy",c.getLocal("first"),s),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(o,c.getLocal("idx2"),s,d),c.call(a+"_copy",c.getLocal("idx1"),u),c.call(a+"_add",u,d,c.getLocal("idx1")),c.call(a+"_sub",u,d,c.getLocal("idx2")),c.call(i+"_mul",s,c.getLocal("inc"),s),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const l=t.addFunction(e+"_fftJoinExt");l.addParam("pBuff1","i32"),l.addParam("pBuff2","i32"),l.addParam("n","i32"),l.addParam("first","i32"),l.addParam("inc","i32"),l.addParam("totalBits","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32"),l.addLocal("pShiftToM","i32");const c=l.getCodeBuilder(),s=c.i32_const(t.alloc(n)),d=c.i32_const(t.alloc(r));l.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(I),c.i32_mul(c.getLocal("totalBits"),c.i32_const(n)))),c.call(i+"_copy",c.getLocal("first"),s),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(a+"_add",c.getLocal("idx1"),c.getLocal("idx2"),d),c.call(o,c.getLocal("idx2"),c.getLocal("pShiftToM"),c.getLocal("idx2")),c.call(a+"_add",c.getLocal("idx1"),c.getLocal("idx2"),c.getLocal("idx2")),c.call(o,c.getLocal("idx2"),s,c.getLocal("idx2")),c.call(a+"_copy",d,c.getLocal("idx1")),c.call(i+"_mul",s,c.getLocal("inc"),s),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const l=t.addFunction(e+"_fftJoinExtInv");l.addParam("pBuff1","i32"),l.addParam("pBuff2","i32"),l.addParam("n","i32"),l.addParam("first","i32"),l.addParam("inc","i32"),l.addParam("totalBits","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32"),l.addLocal("pShiftToM","i32"),l.addLocal("pSConst","i32");const c=l.getCodeBuilder(),s=c.i32_const(t.alloc(n)),d=c.i32_const(t.alloc(r));l.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(I),c.i32_mul(c.getLocal("totalBits"),c.i32_const(n)))),c.setLocal("pSConst",c.i32_add(c.i32_const(C),c.i32_mul(c.getLocal("totalBits"),c.i32_const(n)))),c.call(i+"_copy",c.getLocal("first"),s),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(o,c.getLocal("idx2"),s,d),c.call(a+"_sub",c.getLocal("idx1"),d,c.getLocal("idx2")),c.call(o,c.getLocal("idx2"),c.getLocal("pSConst"),c.getLocal("idx2")),c.call(o,c.getLocal("idx1"),c.getLocal("pShiftToM"),c.getLocal("idx1")),c.call(a+"_sub",d,c.getLocal("idx1"),c.getLocal("idx1")),c.call(o,c.getLocal("idx1"),c.getLocal("pSConst"),c.getLocal("idx1")),c.call(i+"_mul",s,c.getLocal("inc"),s),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const l=t.addFunction(e+"_fftMix");l.addParam("pBuff","i32"),l.addParam("n","i32"),l.addParam("exp","i32"),l.addLocal("nGroups","i32"),l.addLocal("nPerGroup","i32"),l.addLocal("nPerGroupDiv2","i32"),l.addLocal("pairOffset","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32"),l.addLocal("j","i32"),l.addLocal("pwm","i32");const c=l.getCodeBuilder(),s=c.i32_const(t.alloc(n)),d=c.i32_const(t.alloc(r)),u=c.i32_const(t.alloc(r));l.addCode(c.setLocal("nPerGroup",c.i32_shl(c.i32_const(1),c.getLocal("exp"))),c.setLocal("nPerGroupDiv2",c.i32_shr_u(c.getLocal("nPerGroup"),c.i32_const(1))),c.setLocal("nGroups",c.i32_shr_u(c.getLocal("n"),c.getLocal("exp"))),c.setLocal("pairOffset",c.i32_mul(c.getLocal("nPerGroupDiv2"),c.i32_const(r))),c.setLocal("pwm",c.i32_add(c.i32_const(h),c.i32_mul(c.getLocal("exp"),c.i32_const(n)))),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("nGroups"))),c.call(i+"_one",s),c.setLocal("j",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("j"),c.getLocal("nPerGroupDiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.i32_add(c.i32_mul(c.getLocal("i"),c.getLocal("nPerGroup")),c.getLocal("j")),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("idx1"),c.getLocal("pairOffset"))),c.call(o,c.getLocal("idx2"),s,d),c.call(a+"_copy",c.getLocal("idx1"),u),c.call(a+"_add",u,d,c.getLocal("idx1")),c.call(a+"_sub",u,d,c.getLocal("idx2")),c.call(i+"_mul",s,c.getLocal("pwm"),s),c.setLocal("j",c.i32_add(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const i=t.addFunction(e+"_fftFinal");i.addParam("pBuff","i32"),i.addParam("n","i32"),i.addParam("factor","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("ndiv2","i32");const n=i.getCodeBuilder(),l=n.i32_const(t.alloc(r));i.addCode(n.setLocal("ndiv2",n.i32_shr_u(n.getLocal("n"),n.i32_const(1))),n.if(n.i32_and(n.getLocal("n"),n.i32_const(1)),n.call(o,n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("ndiv2"),n.i32_const(r))),n.getLocal("factor"),n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("ndiv2"),n.i32_const(r))))),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_ge_u(n.getLocal("i"),n.getLocal("ndiv2"))),n.setLocal("idx1",n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("i"),n.i32_const(r)))),n.setLocal("idx2",n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.i32_sub(n.i32_sub(n.getLocal("n"),n.i32_const(1)),n.getLocal("i")),n.i32_const(r)))),n.call(o,n.getLocal("idx2"),n.getLocal("factor"),l),n.call(o,n.getLocal("idx1"),n.getLocal("factor"),n.getLocal("idx2")),n.call(a+"_copy",l,n.getLocal("idx1")),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),function(){const l=t.addFunction(e+"_prepareLagrangeEvaluation");l.addParam("pBuff1","i32"),l.addParam("pBuff2","i32"),l.addParam("n","i32"),l.addParam("first","i32"),l.addParam("inc","i32"),l.addParam("totalBits","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32"),l.addLocal("pShiftToM","i32"),l.addLocal("pSConst","i32");const c=l.getCodeBuilder(),s=c.i32_const(t.alloc(n)),d=c.i32_const(t.alloc(r));l.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(I),c.i32_mul(c.getLocal("totalBits"),c.i32_const(n)))),c.setLocal("pSConst",c.i32_add(c.i32_const(C),c.i32_mul(c.getLocal("totalBits"),c.i32_const(n)))),c.call(i+"_copy",c.getLocal("first"),s),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(o,c.getLocal("idx1"),c.getLocal("pShiftToM"),d),c.call(a+"_sub",c.getLocal("idx2"),d,d),c.call(a+"_sub",c.getLocal("idx1"),c.getLocal("idx2"),c.getLocal("idx2")),c.call(o,d,c.getLocal("pSConst"),c.getLocal("idx1")),c.call(o,c.getLocal("idx2"),s,c.getLocal("idx2")),c.call(i+"_mul",s,c.getLocal("inc"),s),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),t.exportFunction(e+"_fft"),t.exportFunction(e+"_ifft"),t.exportFunction(e+"_rawfft"),t.exportFunction(e+"_fftJoin"),t.exportFunction(e+"_fftJoinExt"),t.exportFunction(e+"_fftJoinExtInv"),t.exportFunction(e+"_fftMix"),t.exportFunction(e+"_fftFinal"),t.exportFunction(e+"_prepareLagrangeEvaluation")},Nt=function(t,e,a){const i=8*t.modules[a].n64;return function(){const o=t.addFunction(e+"_zero");o.addParam("px","i32"),o.addParam("n","i32"),o.addLocal("lastp","i32"),o.addLocal("p","i32");const n=o.getCodeBuilder();o.addCode(n.setLocal("p",n.getLocal("px")),n.setLocal("lastp",n.i32_add(n.getLocal("px"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("p"),n.getLocal("lastp"))),n.call(a+"_zero",n.getLocal("p")),n.setLocal("p",n.i32_add(n.getLocal("p"),n.i32_const(i))),n.br(0))))}(),function(){const o=t.addFunction(e+"_constructLC");o.addParam("ppolynomials","i32"),o.addParam("psignals","i32"),o.addParam("nSignals","i32"),o.addParam("pres","i32"),o.addLocal("i","i32"),o.addLocal("j","i32"),o.addLocal("pp","i32"),o.addLocal("ps","i32"),o.addLocal("pd","i32"),o.addLocal("ncoefs","i32");const n=o.getCodeBuilder(),r=n.i32_const(t.alloc(i));o.addCode(n.setLocal("i",n.i32_const(0)),n.setLocal("pp",n.getLocal("ppolynomials")),n.setLocal("ps",n.getLocal("psignals")),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("nSignals"))),n.setLocal("ncoefs",n.i32_load(n.getLocal("pp"))),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(4))),n.setLocal("j",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("j"),n.getLocal("ncoefs"))),n.setLocal("pd",n.i32_add(n.getLocal("pres"),n.i32_mul(n.i32_load(n.getLocal("pp")),n.i32_const(i)))),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(4))),n.call(a+"_mul",n.getLocal("ps"),n.getLocal("pp"),r),n.call(a+"_add",r,n.getLocal("pd"),n.getLocal("pd")),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(i))),n.setLocal("j",n.i32_add(n.getLocal("j"),n.i32_const(1))),n.br(0))),n.setLocal("ps",n.i32_add(n.getLocal("ps"),n.i32_const(i))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),t.exportFunction(e+"_zero"),t.exportFunction(e+"_constructLC"),e},Dt=function(t,e,a){const i=8*t.modules[a].n64;return function(){const o=t.addFunction(e+"_buildABC");o.addParam("pCoefs","i32"),o.addParam("nCoefs","i32"),o.addParam("pWitness","i32"),o.addParam("pA","i32"),o.addParam("pB","i32"),o.addParam("pC","i32"),o.addParam("offsetOut","i32"),o.addParam("nOut","i32"),o.addParam("offsetWitness","i32"),o.addParam("nWitness","i32"),o.addLocal("it","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("last","i32"),o.addLocal("m","i32"),o.addLocal("c","i32"),o.addLocal("s","i32"),o.addLocal("pOut","i32");const n=o.getCodeBuilder(),r=n.i32_const(t.alloc(i));o.addCode(n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("nOut"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_zero",n.getLocal("ita")),n.call(a+"_zero",n.getLocal("itb")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.br(0))),n.setLocal("it",n.getLocal("pCoefs")),n.setLocal("last",n.i32_add(n.getLocal("pCoefs"),n.i32_mul(n.getLocal("nCoefs"),n.i32_const(i+12)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("it"),n.getLocal("last"))),n.setLocal("s",n.i32_load(n.getLocal("it"),8)),n.if(n.i32_or(n.i32_lt_u(n.getLocal("s"),n.getLocal("offsetWitness")),n.i32_ge_u(n.getLocal("s"),n.i32_add(n.getLocal("offsetWitness"),n.getLocal("nWitness")))),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)]),n.setLocal("m",n.i32_load(n.getLocal("it"))),n.if(n.i32_eq(n.getLocal("m"),n.i32_const(0)),n.setLocal("pOut",n.getLocal("pA")),n.if(n.i32_eq(n.getLocal("m"),n.i32_const(1)),n.setLocal("pOut",n.getLocal("pB")),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)])),n.setLocal("c",n.i32_load(n.getLocal("it"),4)),n.if(n.i32_or(n.i32_lt_u(n.getLocal("c"),n.getLocal("offsetOut")),n.i32_ge_u(n.getLocal("c"),n.i32_add(n.getLocal("offsetOut"),n.getLocal("nOut")))),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)]),n.setLocal("pOut",n.i32_add(n.getLocal("pOut"),n.i32_mul(n.i32_sub(n.getLocal("c"),n.getLocal("offsetOut")),n.i32_const(i)))),n.call(a+"_mul",n.i32_add(n.getLocal("pWitness"),n.i32_mul(n.i32_sub(n.getLocal("s"),n.getLocal("offsetWitness")),n.i32_const(i))),n.i32_add(n.getLocal("it"),n.i32_const(12)),r),n.call(a+"_add",n.getLocal("pOut"),r,n.getLocal("pOut")),n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),n.br(0))),n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("it",n.getLocal("pC")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("nOut"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_mul",n.getLocal("ita"),n.getLocal("itb"),n.getLocal("it")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i))),n.br(0))))}(),function(){const o=t.addFunction(e+"_joinABC");o.addParam("pA","i32"),o.addParam("pB","i32"),o.addParam("pC","i32"),o.addParam("n","i32"),o.addParam("pP","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("itc","i32"),o.addLocal("itp","i32"),o.addLocal("last","i32");const n=o.getCodeBuilder(),r=n.i32_const(t.alloc(i));o.addCode(n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("itc",n.getLocal("pC")),n.setLocal("itp",n.getLocal("pP")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_mul",n.getLocal("ita"),n.getLocal("itb"),r),n.call(a+"_sub",r,n.getLocal("itc"),n.getLocal("itp")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("itc",n.i32_add(n.getLocal("itc"),n.i32_const(i))),n.setLocal("itp",n.i32_add(n.getLocal("itp"),n.i32_const(i))),n.br(0))))}(),function(){const o=t.addFunction(e+"_batchAdd");o.addParam("pa","i32"),o.addParam("pb","i32"),o.addParam("n","i32"),o.addParam("pr","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("itr","i32"),o.addLocal("last","i32");const n=o.getCodeBuilder();o.addCode(n.setLocal("ita",n.getLocal("pa")),n.setLocal("itb",n.getLocal("pb")),n.setLocal("itr",n.getLocal("pr")),n.setLocal("last",n.i32_add(n.getLocal("pa"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_add",n.getLocal("ita"),n.getLocal("itb"),n.getLocal("itr")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("itr",n.i32_add(n.getLocal("itr"),n.i32_const(i))),n.br(0))))}(),t.exportFunction(e+"_buildABC"),t.exportFunction(e+"_joinABC"),t.exportFunction(e+"_batchAdd"),e},Kt=function(t,e,a,i,o,n,r,l){const c=t.addFunction(e);c.addParam("pIn","i32"),c.addParam("n","i32"),c.addParam("pFirst","i32"),c.addParam("pInc","i32"),c.addParam("pOut","i32"),c.addLocal("pOldFree","i32"),c.addLocal("i","i32"),c.addLocal("pFrom","i32"),c.addLocal("pTo","i32");const s=c.getCodeBuilder(),d=s.i32_const(t.alloc(r));c.addCode(s.setLocal("pFrom",s.getLocal("pIn")),s.setLocal("pTo",s.getLocal("pOut"))),c.addCode(s.call(i+"_copy",s.getLocal("pFirst"),d)),c.addCode(s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(l,s.getLocal("pFrom"),d,s.getLocal("pTo")),s.setLocal("pFrom",s.i32_add(s.getLocal("pFrom"),s.i32_const(o))),s.setLocal("pTo",s.i32_add(s.getLocal("pTo"),s.i32_const(n))),s.call(i+"_mul",d,s.getLocal("pInc"),d),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))),t.exportFunction(e)},Vt=function(t,e){const a=e||"bn128";if(t.modules[a])return a;const i=u("21888242871839275222246405745257275088696311157297823662689037894645226208583"),o=u("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n=Math.floor((i.minus(1).bitLength()-1)/64)+1,r=8*n,l=r,c=r,s=2*c,d=12*c,g=t.alloc(Et(o,l)),f=Ut(t,i,"f1m");zt(t,o,"fr","frm");const _=t.alloc(Et(A(u(3)),c)),p=Tt(t,"g1m","f1m",_);Rt(t,"frm","frm","frm","frm_mul"),Nt(t,"pol","frm"),Dt(t,"qap","frm");const h=qt(t,"f1m_neg","f2m","f1m"),m=t.alloc([...Et(A(u("19485874751759354771024239261021720505790618469301721065564631296452457478373")),c),...Et(A(u("266929791119991161246907387137283842545076965332900288569378510910307636690")),c)]),L=Tt(t,"g2m","f2m",m);function w(e,a){const i=t.addFunction(e);i.addParam("pG","i32"),i.addParam("pFr","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(r));i.addCode(o.call("frm_fromMontgomery",o.getLocal("pFr"),n),o.call(a,o.getLocal("pG"),n,o.i32_const(r),o.getLocal("pr"))),t.exportFunction(e)}function A(t){return u(t).times(u.one.shiftLeft(8*c)).mod(i)}w("g1m_timesFr","g1m_timesScalar"),Rt(t,"g1m","g1m","frm","g1m_timesFr"),w("g2m_timesFr","g2m_timesScalar"),Rt(t,"g2m","g2m","frm","g2m_timesFr"),w("g1m_timesFrAffine","g1m_timesScalarAffine"),w("g2m_timesFrAffine","g2m_timesScalarAffine"),Kt(t,"frm_batchApplyKey",0,"frm",r,r,r,"frm_mul"),Kt(t,"g1m_batchApplyKey",0,"frm",3*r,3*r,r,"g1m_timesFr"),Kt(t,"g1m_batchApplyKeyMixed",0,"frm",2*r,3*r,r,"g1m_timesFrAffine"),Kt(t,"g2m_batchApplyKey",0,"frm",2*r*3,3*r*2,r,"g2m_timesFr"),Kt(t,"g2m_batchApplyKeyMixed",0,"frm",2*r*2,3*r*2,r,"g2m_timesFrAffine");const b=[u("1"),u("2"),u.one],y=t.alloc([...Et(A(b[0]),c),...Et(A(b[1]),c),...Et(A(b[2]),c)]),I=[u.zero,u.one,u.zero],C=t.alloc([...Et(A(I[0]),c),...Et(A(I[1]),c),...Et(A(I[2]),c)]),F=[[u("10857046999023057135944570762232829481370756359578518086990519993285655852781"),u("11559732032986387107991004021392285783925812861821192530917403151452391805634")],[u("8495653923123431417604973247489272438418190587263600148770280649306958101930"),u("4082367875863433681332203403145435568316851327593401208105741076214120093531")],[u.one,u.zero]],x=t.alloc([...Et(A(F[0][0]),c),...Et(A(F[0][1]),c),...Et(A(F[1][0]),c),...Et(A(F[1][1]),c),...Et(A(F[2][0]),c),...Et(A(F[2][1]),c)]),v=[[u.zero,u.zero],[u.one,u.zero],[u.zero,u.zero]],E=t.alloc([...Et(A(v[0][0]),c),...Et(A(v[0][1]),c),...Et(A(v[1][0]),c),...Et(A(v[1][1]),c),...Et(A(v[2][0]),c),...Et(A(v[2][1]),c)]),B=t.alloc([...Et(A(1),c),...Et(A(0),c),...Et(A(0),c),...Et(A(0),c),...Et(A(0),c),...Et(A(0),c),...Et(A(0),c),...Et(A(0),c),...Et(A(0),c),...Et(A(0),c),...Et(A(0),c),...Et(A(0),c)]),S=t.alloc([...Et(A(9),c),...Et(A(1),c)]),G=t.alloc([...Et(A(u(2).modInv(i)),c),...Et(u(0),c)]),P=S,O=t.alloc([...Et(A("19485874751759354771024239261021720505790618469301721065564631296452457478373"),c),...Et(A("266929791119991161246907387137283842545076965332900288569378510910307636690"),c)]);!function(){const e=t.addFunction(a+"_mulNR6");e.addParam("x","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(h+"_mul",i.i32_const(S),i.getLocal("x"),i.getLocal("pr")))}();const U=Qt(t,a+"_mulNR6","f6m","f2m");!function(){const e=t.addFunction(a+"_mulNR12");e.addParam("x","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(h+"_mul",i.i32_const(S),i.i32_add(i.getLocal("x"),i.i32_const(4*r)),i.getLocal("pr")),i.call(h+"_copy",i.getLocal("x"),i.i32_add(i.getLocal("pr"),i.i32_const(2*r))),i.call(h+"_copy",i.i32_add(i.getLocal("x"),i.i32_const(2*r)),i.i32_add(i.getLocal("pr"),i.i32_const(4*r))))}();const z=qt(t,a+"_mulNR12","ftm",U),q=function(t){let e=t;const a=[];for(;e.gt(u.zero);)e.isOdd()?a.push(1):a.push(0),e=e.shiftRight(1);return a}(u("29793968203157093288")),Q=t.alloc(q),M=3*s,k=q.length-1,T=q.reduce(((t,e)=>t+(0!=e?1:0)),0),R=6*r,N=3*r*2+(T+k+1)*M;t.modules[a]={n64:n,pG1gen:y,pG1zero:C,pG1b:_,pG2gen:x,pG2zero:E,pG2b:m,pq:t.modules.f1m.pq,pr:g,pOneT:B,prePSize:R,preQSize:N,r:o.toString(),q:i.toString()};const D=u("4965661367192848881");function K(e){const o=[[[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")]],[[u("1"),u("0")],[u("8376118865763821496583973867626364092589906065868298776909617916018768340080"),u("16469823323077808223889137241176536799009286646108169935659301613961712198316")],[u("21888242871839275220042445260109153167277707414472061641714758635765020556617"),u("0")],[u("11697423496358154304825782922584725312912383441159505038794027105778954184319"),u("303847389135065887422783454877609941456349188919719272345083954437860409601")],[u("21888242871839275220042445260109153167277707414472061641714758635765020556616"),u("0")],[u("3321304630594332808241809054958361220322477375291206261884409189760185844239"),u("5722266937896532885780051958958348231143373700109372999374820235121374419868")],[u("21888242871839275222246405745257275088696311157297823662689037894645226208582"),u("0")],[u("13512124006075453725662431877630910996106405091429524885779419978626457868503"),u("5418419548761466998357268504080738289687024511189653727029736280683514010267")],[u("2203960485148121921418603742825762020974279258880205651966"),u("0")],[u("10190819375481120917420622822672549775783927716138318623895010788866272024264"),u("21584395482704209334823622290379665147239961968378104390343953940207365798982")],[u("2203960485148121921418603742825762020974279258880205651967"),u("0")],[u("18566938241244942414004596690298913868373833782006617400804628704885040364344"),u("16165975933942742336466353786298926857552937457188450663314217659523851788715")]]],n=[[[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")]],[[u("1"),u("0")],[u("21575463638280843010398324269430826099269044274347216827212613867836435027261"),u("10307601595873709700152284273816112264069230130616436755625194854815875713954")],[u("21888242871839275220042445260109153167277707414472061641714758635765020556616"),u("0")],[u("3772000881919853776433695186713858239009073593817195771773381919316419345261"),u("2236595495967245188281701248203181795121068902605861227855261137820944008926")],[u("2203960485148121921418603742825762020974279258880205651966"),u("0")],[u("18429021223477853657660792034369865839114504446431234726392080002137598044644"),u("9344045779998320333812420223237981029506012124075525679208581902008406485703")]],[[u("1"),u("0")],[u("2581911344467009335267311115468803099551665605076196740867805258568234346338"),u("19937756971775647987995932169929341994314640652964949448313374472400716661030")],[u("2203960485148121921418603742825762020974279258880205651966"),u("0")],[u("5324479202449903542726783395506214481928257762400643279780343368557297135718"),u("16208900380737693084919495127334387981393726419856888799917914180988844123039")],[u("21888242871839275220042445260109153167277707414472061641714758635765020556616"),u("0")],[u("13981852324922362344252311234282257507216387789820983642040889267519694726527"),u("7629828391165209371577384193250820201684255241773809077146787135900891633097")]]],r=t.addFunction(a+"__frobeniusMap"+e);r.addParam("x","i32"),r.addParam("r","i32");const l=r.getCodeBuilder();for(let a=0;a<6;a++){const i=0==a?l.getLocal("x"):l.i32_add(l.getLocal("x"),l.i32_const(a*s)),u=i,g=l.i32_add(l.getLocal("x"),l.i32_const(a*s+c)),_=0==a?l.getLocal("r"):l.i32_add(l.getLocal("r"),l.i32_const(a*s)),p=_,m=l.i32_add(l.getLocal("r"),l.i32_const(a*s+c)),L=d(o[Math.floor(a/3)][e%12],n[a%3][e%6]),w=t.alloc([...Et(A(L[0]),32),...Et(A(L[1]),32)]);e%2==1?r.addCode(l.call(f+"_copy",u,p),l.call(f+"_neg",g,m),l.call(h+"_mul",_,l.i32_const(w),_)):r.addCode(l.call(h+"_mul",i,l.i32_const(w),_))}function d(t,e){const a=u(t[0]),o=u(t[1]),n=u(e[0]),r=u(e[1]),l=[a.times(n).minus(o.times(r)).mod(i),a.times(r).add(o.times(n)).mod(i)];return l[0].isNegative()&&(l[0]=l[0].add(i)),l}}function V(e,i){const o=function(t){let e=t;const a=[];for(;e.gt(u.zero);){if(e.isOdd()){const t=2-e.mod(4).toJSNumber();a.push(t),e=e.minus(t)}else a.push(0);e=e.shiftRight(1)}return a}(e).map((t=>-1==t?255:t)),n=t.alloc(o);t.alloc(Et(e,32));const r=t.addFunction(a+"__cyclotomicExp_"+i);r.addParam("x","i32"),r.addParam("r","i32"),r.addLocal("bit","i32"),r.addLocal("i","i32");const l=r.getCodeBuilder(),c=l.getLocal("x"),s=l.getLocal("r"),g=l.i32_const(t.alloc(d));r.addCode(l.call(z+"_conjugate",c,g),l.call(z+"_one",s),l.if(l.teeLocal("bit",l.i32_load8_s(l.i32_const(o.length-1),n)),l.if(l.i32_eq(l.getLocal("bit"),l.i32_const(1)),l.call(z+"_mul",s,c,s),l.call(z+"_mul",s,g,s))),l.setLocal("i",l.i32_const(o.length-2)),l.block(l.loop(l.call(a+"__cyclotomicSquare",s,s),l.if(l.teeLocal("bit",l.i32_load8_s(l.getLocal("i"),n)),l.if(l.i32_eq(l.getLocal("bit"),l.i32_const(1)),l.call(z+"_mul",s,c,s),l.call(z+"_mul",s,g,s))),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.br(0))))}function j(){!function(){const e=t.addFunction(a+"__cyclotomicSquare");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(s)),r=i.i32_add(i.getLocal("x"),i.i32_const(2*s)),l=i.i32_add(i.getLocal("x"),i.i32_const(3*s)),c=i.i32_add(i.getLocal("x"),i.i32_const(4*s)),d=i.i32_add(i.getLocal("x"),i.i32_const(5*s)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(s)),f=i.i32_add(i.getLocal("r"),i.i32_const(2*s)),_=i.i32_add(i.getLocal("r"),i.i32_const(3*s)),p=i.i32_add(i.getLocal("r"),i.i32_const(4*s)),m=i.i32_add(i.getLocal("r"),i.i32_const(5*s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s)),y=i.i32_const(t.alloc(s)),I=i.i32_const(t.alloc(s)),C=i.i32_const(t.alloc(s)),F=i.i32_const(t.alloc(s));e.addCode(i.call(h+"_mul",o,c,C),i.call(h+"_mul",c,i.i32_const(S),L),i.call(h+"_add",o,L,L),i.call(h+"_add",o,c,F),i.call(h+"_mul",F,L,L),i.call(h+"_mul",i.i32_const(S),C,F),i.call(h+"_add",C,F,F),i.call(h+"_sub",L,F,L),i.call(h+"_add",C,C,w),i.call(h+"_mul",l,r,C),i.call(h+"_mul",r,i.i32_const(S),A),i.call(h+"_add",l,A,A),i.call(h+"_add",l,r,F),i.call(h+"_mul",F,A,A),i.call(h+"_mul",i.i32_const(S),C,F),i.call(h+"_add",C,F,F),i.call(h+"_sub",A,F,A),i.call(h+"_add",C,C,b),i.call(h+"_mul",n,d,C),i.call(h+"_mul",d,i.i32_const(S),y),i.call(h+"_add",n,y,y),i.call(h+"_add",n,d,F),i.call(h+"_mul",F,y,y),i.call(h+"_mul",i.i32_const(S),C,F),i.call(h+"_add",C,F,F),i.call(h+"_sub",y,F,y),i.call(h+"_add",C,C,I),i.call(h+"_sub",L,o,u),i.call(h+"_add",u,u,u),i.call(h+"_add",L,u,u),i.call(h+"_add",w,c,p),i.call(h+"_add",p,p,p),i.call(h+"_add",w,p,p),i.call(h+"_mul",I,i.i32_const(P),F),i.call(h+"_add",F,l,_),i.call(h+"_add",_,_,_),i.call(h+"_add",F,_,_),i.call(h+"_sub",y,r,f),i.call(h+"_add",f,f,f),i.call(h+"_add",y,f,f),i.call(h+"_sub",A,n,g),i.call(h+"_add",g,g,g),i.call(h+"_add",A,g,g),i.call(h+"_add",b,d,m),i.call(h+"_add",m,m,m),i.call(h+"_add",b,m,m))}(),V(D,"w0");const e=t.addFunction(a+"__finalExponentiationLastChunk");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),r=i.i32_const(t.alloc(d)),l=i.i32_const(t.alloc(d)),c=i.i32_const(t.alloc(d)),u=i.i32_const(t.alloc(d)),g=i.i32_const(t.alloc(d)),f=i.i32_const(t.alloc(d)),_=i.i32_const(t.alloc(d)),p=i.i32_const(t.alloc(d)),m=i.i32_const(t.alloc(d)),L=i.i32_const(t.alloc(d)),w=i.i32_const(t.alloc(d)),A=i.i32_const(t.alloc(d)),b=i.i32_const(t.alloc(d)),y=i.i32_const(t.alloc(d)),I=i.i32_const(t.alloc(d)),C=i.i32_const(t.alloc(d)),F=i.i32_const(t.alloc(d)),x=i.i32_const(t.alloc(d)),v=i.i32_const(t.alloc(d)),E=i.i32_const(t.alloc(d)),B=i.i32_const(t.alloc(d));e.addCode(i.call(a+"__cyclotomicExp_w0",o,r),i.call(z+"_conjugate",r,r),i.call(a+"__cyclotomicSquare",r,l),i.call(a+"__cyclotomicSquare",l,c),i.call(z+"_mul",c,l,u),i.call(a+"__cyclotomicExp_w0",u,g),i.call(z+"_conjugate",g,g),i.call(a+"__cyclotomicSquare",g,f),i.call(a+"__cyclotomicExp_w0",f,_),i.call(z+"_conjugate",_,_),i.call(z+"_conjugate",u,p),i.call(z+"_conjugate",_,m),i.call(z+"_mul",m,g,L),i.call(z+"_mul",L,p,w),i.call(z+"_mul",w,l,A),i.call(z+"_mul",w,g,b),i.call(z+"_mul",b,o,y),i.call(a+"__frobeniusMap1",A,I),i.call(z+"_mul",I,y,C),i.call(a+"__frobeniusMap2",w,F),i.call(z+"_mul",F,C,x),i.call(z+"_conjugate",o,v),i.call(z+"_mul",v,A,E),i.call(a+"__frobeniusMap3",E,B),i.call(z+"_mul",B,x,n))}const H=t.alloc(R),$=t.alloc(N);function Z(e){const i=t.addFunction(a+"_pairingEq"+e);for(let t=0;t<e;t++)i.addParam("p_"+t,"i32"),i.addParam("q_"+t,"i32");i.addParam("c","i32"),i.setReturnType("i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(d)),r=o.i32_const(t.alloc(d));i.addCode(o.call(z+"_one",n));for(let t=0;t<e;t++)i.addCode(o.call(a+"_prepareG1",o.getLocal("p_"+t),o.i32_const(H))),i.addCode(o.call(a+"_prepareG2",o.getLocal("q_"+t),o.i32_const($))),i.addCode(o.call(a+"_millerLoop",o.i32_const(H),o.i32_const($),r)),i.addCode(o.call(z+"_mul",n,r,n));i.addCode(o.call(a+"_finalExponentiation",n,n)),i.addCode(o.call(z+"_eq",n,o.getLocal("c")))}!function(){const e=t.addFunction(a+"_prepAddStep");e.addParam("pQ","i32"),e.addParam("pR","i32"),e.addParam("pCoef","i32");const i=e.getCodeBuilder(),o=i.getLocal("pQ"),n=i.i32_add(i.getLocal("pQ"),i.i32_const(s)),r=i.getLocal("pR"),l=i.i32_add(i.getLocal("pR"),i.i32_const(s)),c=i.i32_add(i.getLocal("pR"),i.i32_const(2*s)),d=i.getLocal("pCoef"),u=i.i32_add(i.getLocal("pCoef"),i.i32_const(s)),g=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*s)),f=u,_=i.i32_const(t.alloc(s)),p=i.i32_const(t.alloc(s)),m=i.i32_const(t.alloc(s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s));e.addCode(i.call(h+"_mul",o,c,f),i.call(h+"_sub",r,f,f),i.call(h+"_mul",n,c,_),i.call(h+"_sub",l,_,_),i.call(h+"_square",f,p),i.call(h+"_square",_,m),i.call(h+"_mul",f,p,L),i.call(h+"_mul",r,p,w),i.call(h+"_add",w,w,b),i.call(h+"_mul",c,m,A),i.call(h+"_add",L,A,A),i.call(h+"_sub",A,b,A),i.call(h+"_mul",f,A,r),i.call(h+"_mul",L,l,l),i.call(h+"_sub",w,A,b),i.call(h+"_mul",_,b,b),i.call(h+"_sub",b,l,l),i.call(h+"_mul",c,L,c),i.call(h+"_mul",f,n,b),i.call(h+"_mul",_,o,d),i.call(h+"_sub",d,b,d),i.call(h+"_mul",d,i.i32_const(P),d),i.call(h+"_neg",_,g))}(),function(){const e=t.addFunction(a+"_prepDblStep");e.addParam("pR","i32"),e.addParam("pCoef","i32");const i=e.getCodeBuilder(),o=i.getLocal("pR"),n=i.i32_add(i.getLocal("pR"),i.i32_const(s)),r=i.i32_add(i.getLocal("pR"),i.i32_const(2*s)),l=i.getLocal("pCoef"),c=i.i32_add(i.getLocal("pCoef"),i.i32_const(s)),d=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*s)),u=i.i32_const(t.alloc(s)),g=i.i32_const(t.alloc(s)),f=i.i32_const(t.alloc(s)),_=i.i32_const(t.alloc(s)),p=i.i32_const(t.alloc(s)),m=i.i32_const(t.alloc(s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s)),y=i.i32_const(t.alloc(s)),I=i.i32_const(t.alloc(s));e.addCode(i.call(h+"_mul",n,i.i32_const(G),u),i.call(h+"_mul",o,u,u),i.call(h+"_square",n,g),i.call(h+"_square",r,f),i.call(h+"_add",f,f,_),i.call(h+"_add",_,f,_),i.call(h+"_mul",i.i32_const(O),_,p),i.call(h+"_add",p,p,m),i.call(h+"_add",p,m,m),i.call(h+"_add",g,m,L),i.call(h+"_mul",L,i.i32_const(G),L),i.call(h+"_add",g,f,I),i.call(h+"_add",n,r,w),i.call(h+"_square",w,w),i.call(h+"_sub",w,I,w),i.call(h+"_sub",p,g,A),i.call(h+"_square",o,b),i.call(h+"_square",p,y),i.call(h+"_sub",g,m,I),i.call(h+"_mul",u,I,o),i.call(h+"_add",y,y,I),i.call(h+"_add",y,I,I),i.call(h+"_square",L,n),i.call(h+"_sub",n,I,n),i.call(h+"_mul",g,w,r),i.call(h+"_mul",i.i32_const(P),A,l),i.call(h+"_neg",w,c),i.call(h+"_add",b,b,d),i.call(h+"_add",b,d,d))}(),function(){const e=t.addFunction(a+"_prepareG1");e.addParam("pP","i32"),e.addParam("ppreP","i32");const i=e.getCodeBuilder();e.addCode(i.call(p+"_normalize",i.getLocal("pP"),i.getLocal("ppreP")))}(),function(){!function(){const e=t.addFunction(a+"_mulByQ");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),o=i.getLocal("p1"),n=i.i32_add(i.getLocal("p1"),i.i32_const(s)),r=i.i32_add(i.getLocal("p1"),i.i32_const(2*s)),l=i.getLocal("pr"),d=i.i32_add(i.getLocal("pr"),i.i32_const(s)),u=i.i32_add(i.getLocal("pr"),i.i32_const(2*s)),g=i.i32_const(t.alloc([...Et(A("21575463638280843010398324269430826099269044274347216827212613867836435027261"),c),...Et(A("10307601595873709700152284273816112264069230130616436755625194854815875713954"),c)])),f=i.i32_const(t.alloc([...Et(A("2821565182194536844548159561693502659359617185244120367078079554186484126554"),c),...Et(A("3505843767911556378687030309984248845540243509899259641013678093033130930403"),c)]));e.addCode(i.call(h+"_conjugate",o,l),i.call(h+"_mul",g,l,l),i.call(h+"_conjugate",n,d),i.call(h+"_mul",f,d,d),i.call(h+"_conjugate",r,u))}();const e=t.addFunction(a+"_prepareG2");e.addParam("pQ","i32"),e.addParam("ppreQ","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),o=i.getLocal("pQ");i.i32_add(i.getLocal("pQ"),i.i32_const(s)),i.i32_add(i.getLocal("pQ"),i.i32_const(2*s));const n=t.alloc(3*s),r=i.i32_const(n),l=i.i32_const(n),d=i.i32_const(n+s),u=i.i32_const(n+2*s),g=i.i32_add(i.getLocal("ppreQ"),i.i32_const(0)),f=i.i32_add(i.getLocal("ppreQ"),i.i32_const(s));i.i32_add(i.getLocal("ppreQ"),i.i32_const(2*s));const _=t.alloc(3*s),p=i.i32_const(_),m=t.alloc(3*s),w=i.i32_const(m);i.i32_const(m);const b=i.i32_const(m+s);i.i32_const(m+2*s),e.addCode(i.call(L+"_normalize",o,g),i.call(h+"_copy",g,l),i.call(h+"_copy",f,d),i.call(h+"_one",u)),e.addCode(i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*s))),i.setLocal("i",i.i32_const(q.length-2)),i.block(i.loop(i.call(a+"_prepDblStep",r,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(M))),i.if(i.i32_load8_s(i.getLocal("i"),Q),[...i.call(a+"_prepAddStep",g,r,i.getLocal("pCoef")),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(M)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0)))),e.addCode(i.call(a+"_mulByQ",g,p),i.call(a+"_mulByQ",p,w)),e.addCode(i.call(h+"_neg",b,b),i.call(a+"_prepAddStep",p,r,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(M))),i.call(a+"_prepAddStep",w,r,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(M))))}(),function(){const e=t.addFunction(a+"__mulBy024");e.addParam("pEll0","i32"),e.addParam("pEllVW","i32"),e.addParam("pEllVV","i32"),e.addParam("pR","i32");const i=e.getCodeBuilder(),o=i.getLocal("pEll0"),n=i.getLocal("pEllVV"),l=i.getLocal("pEllVW"),c=i.getLocal("pR"),d=i.i32_add(i.getLocal("pR"),i.i32_const(2*r)),u=i.i32_add(i.getLocal("pR"),i.i32_const(4*r)),g=i.i32_add(i.getLocal("pR"),i.i32_const(6*r)),f=i.i32_add(i.getLocal("pR"),i.i32_const(8*r)),_=i.i32_add(i.getLocal("pR"),i.i32_const(10*r)),p=i.i32_const(t.alloc(s)),m=i.i32_const(t.alloc(s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s)),y=i.i32_const(t.alloc(s)),I=i.i32_const(t.alloc(s)),C=i.i32_const(t.alloc(s)),F=i.i32_const(t.alloc(s)),x=i.i32_const(t.alloc(s));e.addCode(i.call(h+"_mul",c,o,y),i.call(h+"_mul",u,n,I),i.call(h+"_mul",f,l,C),i.call(h+"_add",c,f,L),i.call(h+"_add",c,u,m),i.call(h+"_add",d,g,w),i.call(h+"_add",w,_,w),i.call(h+"_mul",d,n,F),i.call(h+"_add",F,C,A),i.call(h+"_mul",i.i32_const(S),A,b),i.call(h+"_add",b,y,c),i.call(h+"_mul",_,l,A),i.call(h+"_add",F,A,F),i.call(h+"_add",A,I,A),i.call(h+"_mul",i.i32_const(S),A,b),i.call(h+"_mul",d,o,A),i.call(h+"_add",F,A,F),i.call(h+"_add",b,A,d),i.call(h+"_add",o,n,p),i.call(h+"_mul",m,p,A),i.call(h+"_add",y,I,x),i.call(h+"_sub",A,x,A),i.call(h+"_mul",g,l,b),i.call(h+"_add",F,b,F),i.call(h+"_add",u,f,p),i.call(h+"_add",A,b,u),i.call(h+"_add",n,l,m),i.call(h+"_mul",m,p,A),i.call(h+"_add",I,C,x),i.call(h+"_sub",A,x,A),i.call(h+"_mul",i.i32_const(S),A,b),i.call(h+"_mul",g,o,A),i.call(h+"_add",F,A,F),i.call(h+"_add",b,A,g),i.call(h+"_mul",_,n,A),i.call(h+"_add",F,A,F),i.call(h+"_mul",i.i32_const(S),A,b),i.call(h+"_add",o,l,p),i.call(h+"_mul",L,p,A),i.call(h+"_add",y,C,x),i.call(h+"_sub",A,x,A),i.call(h+"_add",b,A,f),i.call(h+"_add",o,n,p),i.call(h+"_add",p,l,p),i.call(h+"_mul",w,p,A),i.call(h+"_sub",A,F,_))}(),function(){const e=t.addFunction(a+"__mulBy024Old");e.addParam("pEll0","i32"),e.addParam("pEllVW","i32"),e.addParam("pEllVV","i32"),e.addParam("pR","i32");const i=e.getCodeBuilder(),o=i.getLocal("pEll0"),n=i.getLocal("pEllVV"),r=i.getLocal("pEllVW"),l=i.getLocal("pR"),c=t.alloc(d),u=i.i32_const(c),g=i.i32_const(c),f=i.i32_const(c+s),_=i.i32_const(c+2*s),p=i.i32_const(c+3*s),m=i.i32_const(c+4*s),L=i.i32_const(c+5*s);e.addCode(i.call(h+"_copy",o,g),i.call(h+"_zero",f),i.call(h+"_copy",n,_),i.call(h+"_zero",p),i.call(h+"_copy",r,m),i.call(h+"_zero",L),i.call(z+"_mul",u,l,l))}(),function(){const e=t.addFunction(a+"_millerLoop");e.addParam("ppreP","i32"),e.addParam("ppreQ","i32"),e.addParam("r","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),o=i.getLocal("ppreP"),n=i.i32_add(i.getLocal("ppreP"),i.i32_const(c)),r=i.getLocal("pCoef"),l=i.i32_add(i.getLocal("pCoef"),i.i32_const(s)),d=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*s)),u=t.alloc(s),g=i.i32_const(u),f=t.alloc(s),_=i.i32_const(f),p=i.getLocal("r");e.addCode(i.call(z+"_one",p),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*s))),i.setLocal("i",i.i32_const(q.length-2)),i.block(i.loop(i.call(z+"_square",p,p),i.call(h+"_mul1",l,n,g),i.call(h+"_mul1",d,o,_),i.call(a+"__mulBy024",r,g,_,p),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(M))),i.if(i.i32_load8_s(i.getLocal("i"),Q),[...i.call(h+"_mul1",l,n,g),...i.call(h+"_mul1",d,o,_),...i.call(a+"__mulBy024",r,g,_,p),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(M)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0)))),e.addCode(i.call(h+"_mul1",l,n,g),i.call(h+"_mul1",d,o,_),i.call(a+"__mulBy024",r,g,_,p),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(M))),i.call(h+"_mul1",l,n,g),i.call(h+"_mul1",d,o,_),i.call(a+"__mulBy024",r,g,_,p),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(M))))}();for(let e=0;e<10;e++)K(e),t.exportFunction(a+"__frobeniusMap"+e);!function(){const e=t.addFunction(a+"_finalExponentiationOld");e.addParam("x","i32"),e.addParam("r","i32");const i=u("552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480"),o=t.alloc(Et(i,352)),n=e.getCodeBuilder();e.addCode(n.call(z+"_exp",n.getLocal("x"),n.i32_const(o),n.i32_const(352),n.getLocal("r")))}(),function(){!function(){const e=t.addFunction(a+"__finalExponentiationFirstChunk");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=o,l=i.i32_add(o,i.i32_const(6*r)),c=i.getLocal("r"),s=t.alloc(d),u=i.i32_const(s),g=u,f=i.i32_const(s+6*r),_=i.i32_const(t.alloc(d)),p=i.i32_const(t.alloc(d)),h=i.i32_const(t.alloc(d));e.addCode(i.call(U+"_copy",n,g),i.call(U+"_neg",l,f),i.call(z+"_inverse",o,_),i.call(z+"_mul",u,_,p),i.call(a+"__frobeniusMap2",p,h),i.call(z+"_mul",p,h,c))}(),j();const e=t.addFunction(a+"_finalExponentiation");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),l=i.i32_const(t.alloc(d));e.addCode(i.call(a+"__finalExponentiationFirstChunk",o,l),i.call(a+"__finalExponentiationLastChunk",l,n))}();for(let e=1;e<=5;e++)Z(e),t.exportFunction(a+"_pairingEq"+e);!function(){const e=t.addFunction(a+"_pairing");e.addParam("p","i32"),e.addParam("q","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.i32_const(t.alloc(d));e.addCode(i.call(a+"_prepareG1",i.getLocal("p"),i.i32_const(H))),e.addCode(i.call(a+"_prepareG2",i.getLocal("q"),i.i32_const($))),e.addCode(i.call(a+"_millerLoop",i.i32_const(H),i.i32_const($),o)),e.addCode(i.call(a+"_finalExponentiation",o,i.getLocal("r")))}(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__mulBy024"),t.exportFunction(a+"__mulBy024Old"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0")},jt=function(t,e){const a=e||"bls12381";if(t.modules[a])return a;const i=u("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),o=u("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n=Math.floor((i.minus(1).bitLength()-1)/64)+1,r=8*n,l=r,c=2*l,s=12*l,d=Math.floor((o.minus(1).bitLength()-1)/64)+1,g=8*d,f=g,_=t.alloc(Et(o,f)),p=Ut(t,i,"f1m","intq");zt(t,o,"fr","frm","intr");const h=t.alloc(Et(y(u(4)),l)),m=Tt(t,"g1m","f1m",h);Rt(t,"frm","frm","frm","frm_mul"),Nt(t,"pol","frm"),Dt(t,"qap","frm");const L=qt(t,"f1m_neg","f2m","f1m"),w=t.alloc([...Et(y(u("4")),l),...Et(y(u("4")),l)]),A=Tt(t,"g2m","f2m",w);function b(e,a){const i=t.addFunction(e);i.addParam("pG","i32"),i.addParam("pFr","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(g));i.addCode(o.call("frm_fromMontgomery",o.getLocal("pFr"),n),o.call(a,o.getLocal("pG"),n,o.i32_const(g),o.getLocal("pr"))),t.exportFunction(e)}function y(t){return u(t).times(u.one.shiftLeft(8*l)).mod(i)}b("g1m_timesFr","g1m_timesScalar"),Rt(t,"g1m","g1m","frm","g1m_timesFr"),b("g2m_timesFr","g2m_timesScalar"),Rt(t,"g2m","g2m","frm","g2m_timesFr"),b("g1m_timesFrAffine","g1m_timesScalarAffine"),b("g2m_timesFrAffine","g2m_timesScalarAffine"),Kt(t,"frm_batchApplyKey",0,"frm",g,g,g,"frm_mul"),Kt(t,"g1m_batchApplyKey",0,"frm",3*r,3*r,g,"g1m_timesFr"),Kt(t,"g1m_batchApplyKeyMixed",0,"frm",2*r,3*r,g,"g1m_timesFrAffine"),Kt(t,"g2m_batchApplyKey",0,"frm",2*r*3,3*r*2,g,"g2m_timesFr"),Kt(t,"g2m_batchApplyKeyMixed",0,"frm",2*r*2,3*r*2,g,"g2m_timesFrAffine");const I=[u("3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507"),u("1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569"),u.one],C=t.alloc([...Et(y(I[0]),l),...Et(y(I[1]),l),...Et(y(I[2]),l)]),F=[u.zero,u.one,u.zero],x=t.alloc([...Et(y(F[0]),l),...Et(y(F[1]),l),...Et(y(F[2]),l)]),v=[[u("352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160"),u("3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758")],[u("1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905"),u("927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582")],[u.one,u.zero]],E=t.alloc([...Et(y(v[0][0]),l),...Et(y(v[0][1]),l),...Et(y(v[1][0]),l),...Et(y(v[1][1]),l),...Et(y(v[2][0]),l),...Et(y(v[2][1]),l)]),B=[[u.zero,u.zero],[u.one,u.zero],[u.zero,u.zero]],S=t.alloc([...Et(y(B[0][0]),l),...Et(y(B[0][1]),l),...Et(y(B[1][0]),l),...Et(y(B[1][1]),l),...Et(y(B[2][0]),l),...Et(y(B[2][1]),l)]),G=t.alloc([...Et(y(1),l),...Et(y(0),l),...Et(y(0),l),...Et(y(0),l),...Et(y(0),l),...Et(y(0),l),...Et(y(0),l),...Et(y(0),l),...Et(y(0),l),...Et(y(0),l),...Et(y(0),l),...Et(y(0),l)]);t.alloc([...Et(y(u(2).modInv(i)),l),...Et(u(0),l)]);const P=t.alloc([...Et(y(1),l),...Et(y(1),l)]);t.alloc([...Et(y("4"),l),...Et(y("4"),l)]),function(){const e=t.addFunction(L+"_mulNR");e.addParam("x","i32"),e.addParam("pr","i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(l)),o=a.getLocal("x"),n=a.i32_add(a.getLocal("x"),a.i32_const(l)),r=a.getLocal("pr"),c=a.i32_add(a.getLocal("pr"),a.i32_const(l));e.addCode(a.call(p+"_copy",o,i),a.call(p+"_sub",o,n,r),a.call(p+"_add",i,n,c))}();const O=Qt(t,L+"_mulNR","f6m","f2m");!function(){const e=t.addFunction(O+"_mulNR");e.addParam("x","i32"),e.addParam("pr","i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(2*l));e.addCode(a.call(L+"_copy",a.getLocal("x"),i),a.call(L+"_mulNR",a.i32_add(a.getLocal("x"),a.i32_const(4*r)),a.getLocal("pr")),a.call(L+"_copy",a.i32_add(a.getLocal("x"),a.i32_const(2*r)),a.i32_add(a.getLocal("pr"),a.i32_const(4*r))),a.call(L+"_copy",i,a.i32_add(a.getLocal("pr"),a.i32_const(2*r))))}();const U=qt(t,O+"_mulNR","ftm",O),z=function(t){let e=t;const a=[];for(;e.gt(u.zero);)e.isOdd()?a.push(1):a.push(0),e=e.shiftRight(1);return a}(u("d201000000010000",16)),q=t.alloc(z),Q=3*c,M=z.length-1,k=z.reduce(((t,e)=>t+(0!=e?1:0)),0),T=6*r,R=3*r*2+(k+M+1)*Q,N=u("15132376222941642752");function D(e){const a=[[[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")]],[[u("1"),u("0")],[u("3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760"),u("151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027")],[u("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351"),u("0")],[u("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530"),u("1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257")],[u("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),u("0")],[u("3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557"),u("877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230")],[u("4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786"),u("0")],[u("151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027"),u("3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760")],[u("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),u("0")],[u("1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257"),u("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530")],[u("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437"),u("0")],[u("877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230"),u("3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557")]]],o=[[[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")],[u("1"),u("0")]],[[u("1"),u("0")],[u("0"),u("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436")],[u("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),u("0")],[u("0"),u("1")],[u("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),u("0")],[u("0"),u("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350")]],[[u("1"),u("0")],[u("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437"),u("0")],[u("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),u("0")],[u("4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786"),u("0")],[u("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),u("0")],[u("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351"),u("0")]]],n=t.addFunction(U+"_frobeniusMap"+e);n.addParam("x","i32"),n.addParam("r","i32");const s=n.getCodeBuilder();for(let i=0;i<6;i++){const u=0==i?s.getLocal("x"):s.i32_add(s.getLocal("x"),s.i32_const(i*c)),g=u,f=s.i32_add(s.getLocal("x"),s.i32_const(i*c+l)),_=0==i?s.getLocal("r"):s.i32_add(s.getLocal("r"),s.i32_const(i*c)),h=_,m=s.i32_add(s.getLocal("r"),s.i32_const(i*c+l)),w=d(a[Math.floor(i/3)][e%12],o[i%3][e%6]),A=t.alloc([...Et(y(w[0]),r),...Et(y(w[1]),r)]);e%2==1?n.addCode(s.call(p+"_copy",g,h),s.call(p+"_neg",f,m),s.call(L+"_mul",_,s.i32_const(A),_)):n.addCode(s.call(L+"_mul",u,s.i32_const(A),_))}function d(t,e){const a=u(t[0]),o=u(t[1]),n=u(e[0]),r=u(e[1]),l=[a.times(n).minus(o.times(r)).mod(i),a.times(r).add(o.times(n)).mod(i)];return l[0].isNegative()&&(l[0]=l[0].add(i)),l}}function K(e,i,o){const n=function(t){let e=t;const a=[];for(;e.gt(u.zero);){if(e.isOdd()){const t=2-e.mod(4).toJSNumber();a.push(t),e=e.minus(t)}else a.push(0);e=e.shiftRight(1)}return a}(e).map((t=>-1==t?255:t)),r=t.alloc(n),l=t.addFunction(a+"__cyclotomicExp_"+o);l.addParam("x","i32"),l.addParam("r","i32"),l.addLocal("bit","i32"),l.addLocal("i","i32");const c=l.getCodeBuilder(),d=c.getLocal("x"),g=c.getLocal("r"),f=c.i32_const(t.alloc(s));l.addCode(c.call(U+"_conjugate",d,f),c.call(U+"_one",g),c.if(c.teeLocal("bit",c.i32_load8_s(c.i32_const(n.length-1),r)),c.if(c.i32_eq(c.getLocal("bit"),c.i32_const(1)),c.call(U+"_mul",g,d,g),c.call(U+"_mul",g,f,g))),c.setLocal("i",c.i32_const(n.length-2)),c.block(c.loop(c.call(a+"__cyclotomicSquare",g,g),c.if(c.teeLocal("bit",c.i32_load8_s(c.getLocal("i"),r)),c.if(c.i32_eq(c.getLocal("bit"),c.i32_const(1)),c.call(U+"_mul",g,d,g),c.call(U+"_mul",g,f,g))),c.br_if(1,c.i32_eqz(c.getLocal("i"))),c.setLocal("i",c.i32_sub(c.getLocal("i"),c.i32_const(1))),c.br(0)))),i&&l.addCode(c.call(U+"_conjugate",g,g))}t.modules[a]={n64q:n,n64r:d,n8q:r,n8r:g,pG1gen:C,pG1zero:x,pG1b:h,pG2gen:E,pG2zero:S,pG2b:w,pq:t.modules.f1m.pq,pr:_,pOneT:G,r:o,q:i,prePSize:T,preQSize:R},function(){const e=t.addFunction(O+"_mul1");e.addParam("pA","i32"),e.addParam("pC1","i32"),e.addParam("pR","i32");const a=e.getCodeBuilder(),i=a.getLocal("pA"),o=a.i32_add(a.getLocal("pA"),a.i32_const(2*l)),n=a.i32_add(a.getLocal("pA"),a.i32_const(4*l)),r=a.getLocal("pC1"),c=a.getLocal("pR"),s=a.i32_add(a.getLocal("pR"),a.i32_const(2*l)),d=a.i32_add(a.getLocal("pR"),a.i32_const(4*l)),u=a.i32_const(t.alloc(2*l)),g=a.i32_const(t.alloc(2*l));e.addCode(a.call(L+"_add",i,o,u),a.call(L+"_add",o,n,g),a.call(L+"_mul",o,r,d),a.call(L+"_mul",g,r,c),a.call(L+"_sub",c,d,c),a.call(L+"_mulNR",c,c),a.call(L+"_mul",u,r,s),a.call(L+"_sub",s,d,s))}(),function(){const e=t.addFunction(O+"_mul01");e.addParam("pA","i32"),e.addParam("pC0","i32"),e.addParam("pC1","i32"),e.addParam("pR","i32");const a=e.getCodeBuilder(),i=a.getLocal("pA"),o=a.i32_add(a.getLocal("pA"),a.i32_const(2*l)),n=a.i32_add(a.getLocal("pA"),a.i32_const(4*l)),r=a.getLocal("pC0"),c=a.getLocal("pC1"),s=a.getLocal("pR"),d=a.i32_add(a.getLocal("pR"),a.i32_const(2*l)),u=a.i32_add(a.getLocal("pR"),a.i32_const(4*l)),g=a.i32_const(t.alloc(2*l)),f=a.i32_const(t.alloc(2*l)),_=a.i32_const(t.alloc(2*l)),p=a.i32_const(t.alloc(2*l));e.addCode(a.call(L+"_mul",i,r,g),a.call(L+"_mul",o,c,f),a.call(L+"_add",i,o,_),a.call(L+"_add",i,n,p),a.call(L+"_add",o,n,s),a.call(L+"_mul",s,c,s),a.call(L+"_sub",s,f,s),a.call(L+"_mulNR",s,s),a.call(L+"_add",s,g,s),a.call(L+"_add",r,c,d),a.call(L+"_mul",d,_,d),a.call(L+"_sub",d,g,d),a.call(L+"_sub",d,f,d),a.call(L+"_mul",p,r,u),a.call(L+"_sub",u,g,u),a.call(L+"_add",u,f,u))}(),function(){const e=t.addFunction(U+"_mul014");e.addParam("pA","i32"),e.addParam("pC0","i32"),e.addParam("pC1","i32"),e.addParam("pC4","i32"),e.addParam("pR","i32");const a=e.getCodeBuilder(),i=a.getLocal("pA"),o=a.i32_add(a.getLocal("pA"),a.i32_const(6*l)),n=a.getLocal("pC0"),r=a.getLocal("pC1"),c=a.getLocal("pC4"),s=a.i32_const(t.alloc(6*l)),d=a.i32_const(t.alloc(6*l)),u=a.i32_const(t.alloc(2*l)),g=a.getLocal("pR"),f=a.i32_add(a.getLocal("pR"),a.i32_const(6*l));e.addCode(a.call(O+"_mul01",i,n,r,s),a.call(O+"_mul1",o,c,d),a.call(L+"_add",r,c,u),a.call(O+"_add",o,i,f),a.call(O+"_mul01",f,n,u,f),a.call(O+"_sub",f,s,f),a.call(O+"_sub",f,d,f),a.call(O+"_copy",d,g),a.call(O+"_mulNR",g,g),a.call(O+"_add",g,s,g))}(),function(){const e=t.addFunction(a+"_ell");e.addParam("pP","i32"),e.addParam("pCoefs","i32"),e.addParam("pF","i32");const i=e.getCodeBuilder(),o=i.getLocal("pP"),n=i.i32_add(i.getLocal("pP"),i.i32_const(r)),c=i.getLocal("pF"),s=i.getLocal("pCoefs"),d=i.i32_add(i.getLocal("pCoefs"),i.i32_const(l)),u=i.i32_add(i.getLocal("pCoefs"),i.i32_const(2*l)),g=i.i32_add(i.getLocal("pCoefs"),i.i32_const(3*l)),f=i.i32_add(i.getLocal("pCoefs"),i.i32_const(4*l)),_=t.alloc(2*l),h=i.i32_const(_),m=i.i32_const(_),L=i.i32_const(_+l),w=t.alloc(2*l),A=i.i32_const(w),b=i.i32_const(w),y=i.i32_const(w+l);e.addCode(i.call(p+"_mul",s,n,m),i.call(p+"_mul",d,n,L),i.call(p+"_mul",u,o,b),i.call(p+"_mul",g,o,y),i.call(U+"_mul014",c,f,A,h,c))}();const V=t.alloc(T),j=t.alloc(R);function H(e){const i=t.addFunction(a+"_pairingEq"+e);for(let t=0;t<e;t++)i.addParam("p_"+t,"i32"),i.addParam("q_"+t,"i32");i.addParam("c","i32"),i.setReturnType("i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(s)),r=o.i32_const(t.alloc(s));i.addCode(o.call(U+"_one",n));for(let t=0;t<e;t++)i.addCode(o.call(a+"_prepareG1",o.getLocal("p_"+t),o.i32_const(V))),i.addCode(o.call(a+"_prepareG2",o.getLocal("q_"+t),o.i32_const(j))),i.addCode(o.if(o.i32_eqz(o.call(m+"_inGroupAffine",o.i32_const(V))),o.ret(o.i32_const(0))),o.if(o.i32_eqz(o.call(A+"_inGroupAffine",o.i32_const(j))),o.ret(o.i32_const(0)))),i.addCode(o.call(a+"_millerLoop",o.i32_const(V),o.i32_const(j),r)),i.addCode(o.call(U+"_mul",n,r,n));i.addCode(o.call(a+"_finalExponentiation",n,n)),i.addCode(o.call(U+"_eq",n,o.getLocal("c")))}for(let e=0;e<10;e++)D(e),t.exportFunction(U+"_frobeniusMap"+e);!function(){const e=t.addFunction(m+"_inGroupAffine");e.addParam("p","i32"),e.setReturnType("i32");const a=e.getCodeBuilder(),i=u("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),o=u("793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350"),n=N.times(N).minus(u.one).divide(u(3)),c=a.i32_const(t.alloc(Et(y(i),r))),s=a.i32_const(t.alloc(Et(y(o),r))),d=a.i32_const(t.alloc(Et(n,16))),g=a.getLocal("p"),f=a.i32_add(a.getLocal("p"),a.i32_const(l)),_=t.alloc(3*l),h=a.i32_const(_),L=a.i32_const(_),w=a.i32_const(_+l);a.i32_const(_+2*l);const A=t.alloc(2*l),b=a.i32_const(A),I=a.i32_const(A),C=a.i32_const(A+l);e.addCode(a.if(a.call(m+"_isZeroAffine",a.getLocal("p")),a.ret(a.i32_const(1))),a.if(a.i32_eqz(a.call(m+"_inCurveAffine",a.getLocal("p"))),a.ret(a.i32_const(0))),a.call(p+"_mul",g,c,L),a.call(p+"_copy",f,w),a.call(p+"_mul",g,s,I),a.call(p+"_copy",f,C),a.call(m+"_doubleAffine",h,h),a.call(m+"_subMixed",h,a.getLocal("p"),h),a.call(m+"_subMixed",h,b,h),a.call(m+"_timesScalar",h,d,a.i32_const(16),h),a.ret(a.call(m+"_eqMixed",h,b)));const F=t.addFunction(m+"_inGroup");F.addParam("pIn","i32"),F.setReturnType("i32");const x=F.getCodeBuilder(),v=x.i32_const(t.alloc(2*l));F.addCode(x.call(m+"_toAffine",x.getLocal("pIn"),v),x.ret(x.call(m+"_inGroupAffine",v)))}(),function(){const e=t.addFunction(A+"_inGroupAffine");e.addParam("p","i32"),e.setReturnType("i32");const a=e.getCodeBuilder(),i=[u("2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894"),u("2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893")],o=u("4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436"),n=[u("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530"),u("2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530")],s=a.i32_const(t.alloc([...Et(y(i[0]),r),...Et(y(i[1]),r)])),d=a.i32_const(t.alloc(Et(y(o),r))),g=a.i32_const(t.alloc([...Et(y(n[0]),r),...Et(y(n[1]),r)])),f=a.i32_const(t.alloc(Et(N,8))),_=a.getLocal("p"),h=a.i32_add(a.getLocal("p"),a.i32_const(c)),m=a.i32_const(t.alloc(l)),w=a.i32_const(t.alloc(c)),b=a.i32_const(t.alloc(c)),I=t.alloc(2*c),C=a.i32_const(I),F=a.i32_const(I),x=a.i32_const(I),v=a.i32_const(I+l),E=a.i32_const(I+c),B=a.i32_const(I+c),S=a.i32_const(I+c+l),G=t.alloc(3*c),P=a.i32_const(G),O=a.i32_const(G),U=a.i32_const(G),z=a.i32_const(G+l),q=a.i32_const(G+c),Q=a.i32_const(G+c),M=a.i32_const(G+c+l),k=a.i32_const(G+2*c);e.addCode(a.if(a.call(A+"_isZeroAffine",a.getLocal("p")),a.ret(a.i32_const(1))),a.if(a.i32_eqz(a.call(A+"_inCurveAffine",a.getLocal("p"))),a.ret(a.i32_const(0))),a.call(L+"_mul",_,s,w),a.call(L+"_mul",h,s,b),a.call(L+"_mul1",w,d,F),a.call(L+"_neg",b,E),a.call(L+"_neg",w,O),a.call(L+"_mul",b,g,q),a.call(p+"_sub",x,v,m),a.call(p+"_add",x,v,v),a.call(p+"_copy",m,x),a.call(p+"_sub",B,S,m),a.call(p+"_add",B,S,S),a.call(p+"_copy",m,B),a.call(p+"_add",U,z,m),a.call(p+"_sub",U,z,z),a.call(p+"_copy",m,U),a.call(p+"_sub",M,Q,m),a.call(p+"_add",Q,M,M),a.call(p+"_copy",m,Q),a.call(L+"_one",k),a.call(A+"_timesScalar",P,f,a.i32_const(8),P),a.call(A+"_addMixed",P,C,P),a.ret(a.call(A+"_eqMixed",P,a.getLocal("p"))));const T=t.addFunction(A+"_inGroup");T.addParam("pIn","i32"),T.setReturnType("i32");const R=T.getCodeBuilder(),D=R.i32_const(t.alloc(2*c));T.addCode(R.call(A+"_toAffine",R.getLocal("pIn"),D),R.ret(R.call(A+"_inGroupAffine",D)))}(),function(){const e=t.addFunction(a+"_prepAddStep");e.addParam("R","i32"),e.addParam("Q","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("R"),n=i.i32_add(i.getLocal("R"),i.i32_const(2*r)),l=i.i32_add(i.getLocal("R"),i.i32_const(4*r)),s=i.getLocal("Q"),d=i.i32_add(i.getLocal("Q"),i.i32_const(2*r)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(2*r)),f=i.i32_add(i.getLocal("r"),i.i32_const(4*r)),_=i.i32_const(t.alloc(c)),p=i.i32_const(t.alloc(c)),h=i.i32_const(t.alloc(c)),m=i.i32_const(t.alloc(c)),w=i.i32_const(t.alloc(c)),A=i.i32_const(t.alloc(c)),b=i.i32_const(t.alloc(c)),y=i.i32_const(t.alloc(c)),I=i.i32_const(t.alloc(c)),C=i.i32_const(t.alloc(c)),F=i.i32_const(t.alloc(c));e.addCode(i.call(L+"_square",l,_),i.call(L+"_square",d,p),i.call(L+"_mul",_,s,m),i.call(L+"_add",d,l,g),i.call(L+"_square",g,g),i.call(L+"_sub",g,p,g),i.call(L+"_sub",g,_,g),i.call(L+"_mul",g,_,g),i.call(L+"_sub",m,o,w),i.call(L+"_square",w,A),i.call(L+"_add",A,A,b),i.call(L+"_add",b,b,b),i.call(L+"_mul",b,w,y),i.call(L+"_sub",g,n,I),i.call(L+"_sub",I,n,I),i.call(L+"_mul",I,s,f),i.call(L+"_mul",b,o,C),i.call(L+"_square",I,o),i.call(L+"_sub",o,y,o),i.call(L+"_sub",o,C,o),i.call(L+"_sub",o,C,o),i.call(L+"_add",l,w,l),i.call(L+"_square",l,l),i.call(L+"_sub",l,_,l),i.call(L+"_sub",l,A,l),i.call(L+"_add",d,l,u),i.call(L+"_sub",C,o,F),i.call(L+"_mul",F,I,F),i.call(L+"_mul",n,y,m),i.call(L+"_add",m,m,m),i.call(L+"_sub",F,m,n),i.call(L+"_square",u,u),i.call(L+"_sub",u,p,u),i.call(L+"_square",l,h),i.call(L+"_sub",u,h,u),i.call(L+"_add",f,f,f),i.call(L+"_sub",f,u,f),i.call(L+"_add",l,l,u),i.call(L+"_neg",I,I),i.call(L+"_add",I,I,g))}(),function(){const e=t.addFunction(a+"_prepDblStep");e.addParam("R","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("R"),n=i.i32_add(i.getLocal("R"),i.i32_const(2*r)),l=i.i32_add(i.getLocal("R"),i.i32_const(4*r)),s=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(2*r)),u=i.i32_add(i.getLocal("r"),i.i32_const(4*r)),g=i.i32_const(t.alloc(c)),f=i.i32_const(t.alloc(c)),_=i.i32_const(t.alloc(c)),p=i.i32_const(t.alloc(c)),h=i.i32_const(t.alloc(c));e.addCode(i.call(L+"_square",o,s),i.call(L+"_square",n,f),i.call(L+"_square",f,_),i.call(L+"_add",f,o,d),i.call(L+"_square",d,d),i.call(L+"_sub",d,s,d),i.call(L+"_sub",d,_,d),i.call(L+"_add",d,d,d),i.call(L+"_add",s,s,p),i.call(L+"_add",p,s,p),i.call(L+"_add",o,p,u),i.call(L+"_square",p,h),i.call(L+"_square",l,g),i.call(L+"_sub",h,d,o),i.call(L+"_sub",o,d,o),i.call(L+"_add",l,n,l),i.call(L+"_square",l,l),i.call(L+"_sub",l,f,l),i.call(L+"_sub",l,g,l),i.call(L+"_sub",d,o,n),i.call(L+"_mul",n,p,n),i.call(L+"_add",_,_,_),i.call(L+"_add",_,_,_),i.call(L+"_add",_,_,_),i.call(L+"_sub",n,_,n),i.call(L+"_mul",p,g,d),i.call(L+"_add",d,d,d),i.call(L+"_neg",d,d),i.call(L+"_square",u,u),i.call(L+"_sub",u,s,u),i.call(L+"_sub",u,h,u),i.call(L+"_add",f,f,f),i.call(L+"_add",f,f,f),i.call(L+"_sub",u,f,u),i.call(L+"_mul",l,g,s),i.call(L+"_add",s,s,s))}(),function(){const e=t.addFunction(a+"_prepareG1");e.addParam("pP","i32"),e.addParam("ppreP","i32");const i=e.getCodeBuilder();e.addCode(i.call(m+"_normalize",i.getLocal("pP"),i.getLocal("ppreP")))}(),function(){const e=t.addFunction(a+"_prepareG2");e.addParam("pQ","i32"),e.addParam("ppreQ","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),o=i.getLocal("pQ"),n=t.alloc(3*c),r=i.i32_const(n),l=i.getLocal("ppreQ");e.addCode(i.call(A+"_normalize",o,l),i.if(i.call(A+"_isZero",l),i.ret([])),i.call(A+"_copy",l,r),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*c)))),e.addCode(i.setLocal("i",i.i32_const(z.length-2)),i.block(i.loop(i.call(a+"_prepDblStep",r,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q))),i.if(i.i32_load8_s(i.getLocal("i"),q),[...i.call(a+"_prepAddStep",r,l,i.getLocal("pCoef")),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0))))}(),function(){const e=t.addFunction(a+"_millerLoop");e.addParam("ppreP","i32"),e.addParam("ppreQ","i32"),e.addParam("r","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),o=i.getLocal("ppreP");i.getLocal("ppreQ");const n=i.getLocal("pCoef"),r=i.getLocal("r");e.addCode(i.call(U+"_one",r),i.if(i.call(m+"_isZero",o),i.ret([])),i.if(i.call(m+"_isZero",i.getLocal("ppreQ")),i.ret([])),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*c))),i.setLocal("i",i.i32_const(z.length-2)),i.block(i.loop(i.call(a+"_ell",o,n,r),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q))),i.if(i.i32_load8_s(i.getLocal("i"),q),[...i.call(a+"_ell",o,n,r),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q)))]),i.call(U+"_square",r,r),i.br_if(1,i.i32_eq(i.getLocal("i"),i.i32_const(1))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.call(a+"_ell",o,n,r)),e.addCode(i.call(U+"_conjugate",r,r))}(),function(){const e=t.addFunction(a+"_finalExponentiationOld");e.addParam("x","i32"),e.addParam("r","i32");const i=u("322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560"),o=t.alloc(Et(i,544)),n=e.getCodeBuilder();e.addCode(n.call(U+"_exp",n.getLocal("x"),n.i32_const(o),n.i32_const(544),n.getLocal("r")))}(),function(){!function(){const e=t.addFunction(a+"__cyclotomicSquare");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(c)),r=i.i32_add(i.getLocal("x"),i.i32_const(2*c)),l=i.i32_add(i.getLocal("x"),i.i32_const(3*c)),s=i.i32_add(i.getLocal("x"),i.i32_const(4*c)),d=i.i32_add(i.getLocal("x"),i.i32_const(5*c)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(c)),f=i.i32_add(i.getLocal("r"),i.i32_const(2*c)),_=i.i32_add(i.getLocal("r"),i.i32_const(3*c)),p=i.i32_add(i.getLocal("r"),i.i32_const(4*c)),h=i.i32_add(i.getLocal("r"),i.i32_const(5*c)),m=i.i32_const(t.alloc(c)),w=i.i32_const(t.alloc(c)),A=i.i32_const(t.alloc(c)),b=i.i32_const(t.alloc(c)),y=i.i32_const(t.alloc(c)),I=i.i32_const(t.alloc(c)),C=i.i32_const(t.alloc(c)),F=i.i32_const(t.alloc(c));e.addCode(i.call(L+"_mul",o,s,C),i.call(L+"_mulNR",s,m),i.call(L+"_add",o,m,m),i.call(L+"_add",o,s,F),i.call(L+"_mul",F,m,m),i.call(L+"_mulNR",C,F),i.call(L+"_add",C,F,F),i.call(L+"_sub",m,F,m),i.call(L+"_add",C,C,w),i.call(L+"_mul",l,r,C),i.call(L+"_mulNR",r,A),i.call(L+"_add",l,A,A),i.call(L+"_add",l,r,F),i.call(L+"_mul",F,A,A),i.call(L+"_mulNR",C,F),i.call(L+"_add",C,F,F),i.call(L+"_sub",A,F,A),i.call(L+"_add",C,C,b),i.call(L+"_mul",n,d,C),i.call(L+"_mulNR",d,y),i.call(L+"_add",n,y,y),i.call(L+"_add",n,d,F),i.call(L+"_mul",F,y,y),i.call(L+"_mulNR",C,F),i.call(L+"_add",C,F,F),i.call(L+"_sub",y,F,y),i.call(L+"_add",C,C,I),i.call(L+"_sub",m,o,u),i.call(L+"_add",u,u,u),i.call(L+"_add",m,u,u),i.call(L+"_add",w,s,p),i.call(L+"_add",p,p,p),i.call(L+"_add",w,p,p),i.call(L+"_mul",I,i.i32_const(P),F),i.call(L+"_add",F,l,_),i.call(L+"_add",_,_,_),i.call(L+"_add",F,_,_),i.call(L+"_sub",y,r,f),i.call(L+"_add",f,f,f),i.call(L+"_add",y,f,f),i.call(L+"_sub",A,n,g),i.call(L+"_add",g,g,g),i.call(L+"_add",A,g,g),i.call(L+"_add",b,d,h),i.call(L+"_add",h,h,h),i.call(L+"_add",b,h,h))}(),K(N,true,"w0");const e=t.addFunction(a+"_finalExponentiation");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),r=i.i32_const(t.alloc(s)),l=i.i32_const(t.alloc(s)),d=i.i32_const(t.alloc(s)),u=i.i32_const(t.alloc(s)),g=i.i32_const(t.alloc(s)),f=i.i32_const(t.alloc(s)),_=i.i32_const(t.alloc(s));e.addCode(i.call(U+"_frobeniusMap6",o,r),i.call(U+"_inverse",o,l),i.call(U+"_mul",r,l,d),i.call(U+"_copy",d,l),i.call(U+"_frobeniusMap2",d,d),i.call(U+"_mul",d,l,d),i.call(a+"__cyclotomicSquare",d,l),i.call(U+"_conjugate",l,l),i.call(a+"__cyclotomicExp_w0",d,u),i.call(a+"__cyclotomicSquare",u,g),i.call(U+"_mul",l,u,f),i.call(a+"__cyclotomicExp_w0",f,l),i.call(a+"__cyclotomicExp_w0",l,r),i.call(a+"__cyclotomicExp_w0",r,_),i.call(U+"_mul",_,g,_),i.call(a+"__cyclotomicExp_w0",_,g),i.call(U+"_conjugate",f,f),i.call(U+"_mul",g,f,g),i.call(U+"_mul",g,d,g),i.call(U+"_conjugate",d,f),i.call(U+"_mul",l,d,l),i.call(U+"_frobeniusMap3",l,l),i.call(U+"_mul",_,f,_),i.call(U+"_frobeniusMap1",_,_),i.call(U+"_mul",u,r,u),i.call(U+"_frobeniusMap2",u,u),i.call(U+"_mul",u,l,u),i.call(U+"_mul",u,_,u),i.call(U+"_mul",u,g,n))}();for(let e=1;e<=5;e++)H(e),t.exportFunction(a+"_pairingEq"+e);!function(){const e=t.addFunction(a+"_pairing");e.addParam("p","i32"),e.addParam("q","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.i32_const(t.alloc(s));e.addCode(i.call(a+"_prepareG1",i.getLocal("p"),i.i32_const(V))),e.addCode(i.call(a+"_prepareG2",i.getLocal("q"),i.i32_const(j))),e.addCode(i.call(a+"_millerLoop",i.i32_const(V),i.i32_const(j),o)),e.addCode(i.call(a+"_finalExponentiation",o,i.getLocal("r")))}(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0"),t.exportFunction(O+"_mul1"),t.exportFunction(O+"_mul01"),t.exportFunction(U+"_mul014"),t.exportFunction(m+"_inGroupAffine"),t.exportFunction(m+"_inGroup"),t.exportFunction(A+"_inGroupAffine"),t.exportFunction(A+"_inGroup")};var Ht=Object.freeze({__proto__:null,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return I(e,0);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const a={};return Object.keys(e).forEach((i=>{a[i]=t(e[i])})),a}return e},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e))return BigInt(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(t);if("object"==typeof e){if(null===e)return null;const a={};return Object.keys(e).forEach((i=>{a[i]=t(e[i])})),a}return e},beBuff2int:function(t){let e=BigInt(0),a=t.length,i=0;const o=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;a>0;)a>=4?(a-=4,e+=BigInt(o.getUint32(a))<<BigInt(8*i),i+=4):a>=2?(a-=2,e+=BigInt(o.getUint16(a))<<BigInt(8*i),i+=2):(a-=1,e+=BigInt(o.getUint8(a))<<BigInt(8*i),i+=1);return e},beInt2Buff:function(t,e){let a=t;const i=new Uint8Array(e),o=new DataView(i.buffer);let n=e;for(;n>0;)n-4>=0?(n-=4,o.setUint32(n,Number(a&BigInt(4294967295))),a>>=BigInt(32)):n-2>=0?(n-=2,o.setUint16(n,Number(a&BigInt(65535))),a>>=BigInt(16)):(n-=1,o.setUint8(n,Number(a&BigInt(255))),a>>=BigInt(8));if(a)throw new Error("Number does not fit in this length");return i},leBuff2int:function(t){let e=BigInt(0),a=0;const i=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;a<t.length;)a+4<=t.length?(e+=BigInt(i.getUint32(a,!0))<<BigInt(8*a),a+=4):a+4<=t.length?(e+=BigInt(i.getUint16(a,!0))<<BigInt(8*a),a+=2):(e+=BigInt(i.getUint8(a,!0))<<BigInt(8*a),a+=1);return e},leInt2Buff:function(t,e){let a=t;void 0===e&&0==(e=Math.floor((P(t)-1)/8)+1)&&(e=1);const i=new Uint8Array(e),o=new DataView(i.buffer);let n=0;for(;n<e;)n+4<=e?(o.setUint32(n,Number(a&BigInt(4294967295)),!0),n+=4,a>>=BigInt(32)):n+2<=e?(o.setUint16(Number(n,a&BigInt(65535)),!0),n+=2,a>>=BigInt(16)):(o.setUint8(Number(n,a&BigInt(255)),!0),n+=1,a>>=BigInt(8));if(a)throw new Error("Number does not fit in this length");return i},stringifyFElements:function t(e,a){if("bigint"==typeof a||void 0!==a.eq)return a.toString(10);if(a instanceof Uint8Array)return e.toString(e.e(a));if(Array.isArray(a))return a.map(t.bind(this,e));if("object"==typeof a){const i={};return Object.keys(a).forEach((o=>{i[o]=t(e,a[o])})),i}return a},unstringifyFElements:function t(e,a){if("string"==typeof a&&/^[0-9]+$/.test(a))return e.e(a);if("string"==typeof a&&/^0x[0-9a-fA-F]+$/.test(a))return e.e(a);if(Array.isArray(a))return a.map(t.bind(this,e));if("object"==typeof a){if(null===a)return null;const i={};return Object.keys(a).forEach((o=>{i[o]=t(e,a[o])})),i}return a}});var $t=Object.freeze({__proto__:null,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const a={};return Object.keys(e).forEach((i=>{a[i]=t(e[i])})),a}return e},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e))return u(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return u(e);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const a={};return Object.keys(e).forEach((i=>{a[i]=t(e[i])})),a}return e},beBuff2int:function(t){let e=u.zero;for(let a=0;a<t.length;a++){const i=u(t[t.length-a-1]);e=e.add(i.shiftLeft(8*a))}return e},beInt2Buff:function(t,e){let a=t,i=e-1;const o=new Uint8Array(e);for(;a.gt(u.zero)&&i>=0;){let t=Number(a.and(u("255")));o[i]=t,i--,a=a.shiftRight(8)}if(!a.eq(u.zero))throw new Error("Number does not fit in this length");return o},leBuff2int:function(t){let e=u.zero;for(let a=0;a<t.length;a++){const i=u(t[a]);e=e.add(i.shiftLeft(8*a))}return e},leInt2Buff:function(t,e){let a=t,i=0;const o=new Uint8Array(e);for(;a.gt(u.zero)&&i<o.length;){let t=Number(a.and(u(255)));o[i]=t,i++,a=a.shiftRight(8)}if(!a.eq(u.zero))throw new Error("Number does not fit in this length");return o}});let Zt={};"function"==typeof BigInt?Object.assign(Zt,Ht):Object.assign(Zt,$t);const Yt=[];for(let t=0;t<256;t++)Yt[t]=Jt(t,8);function Jt(t,e){let a=0,i=t;for(let t=0;t<e;t++)a<<=1,a|=1&i,i>>=1;return a}Zt.bitReverse=function(t,e){return(Yt[t>>>24]|Yt[t>>>16&255]<<8|Yt[t>>>8&255]<<16|Yt[255&t]<<24)>>>32-e},Zt.log2=function(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)},Zt.buffReverseBits=function(t,e){const a=t.byteLength/e,i=Zt.log2(a);if(a!=1<<i)throw new Error("Invalid number of pointers");for(let o=0;o<a;o++){const a=Zt.bitReverse(o,i);if(o>a){const i=t.slice(o*e,(o+1)*e);t.set(t.slice(a*e,(a+1)*e),o*e),t.set(i,a*e)}}},Zt.array2buffer=function(t,e){const a=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)a.set(t[i],i*e);return a},Zt.buffer2array=function(t,e){const a=t.byteLength/e,i=new Array(a);for(let o=0;o<a;o++)i[o]=t.slice(o*e,o*e+e);return i};let{bitReverse:Wt,log2:Xt,buffReverseBits:te,stringifyBigInts:ee,unstringifyBigInts:ae,beBuff2int:ie,beInt2Buff:oe,leBuff2int:ne,leInt2Buff:re,array2buffer:le,buffer2array:ce,stringifyFElements:se,unstringifyFElements:de}=Zt;var ue=Object.freeze({__proto__:null,bitReverse:Wt,log2:Xt,buffReverseBits:te,stringifyBigInts:ee,unstringifyBigInts:ae,beBuff2int:ie,beInt2Buff:oe,leBuff2int:ne,leInt2Buff:re,array2buffer:le,buffer2array:ce,stringifyFElements:se,unstringifyFElements:de});const ge=1<<30;class fe{constructor(t){this.buffers=[],this.byteLength=t;for(let e=0;e<t;e+=ge){const a=Math.min(t-e,ge);this.buffers.push(new Uint8Array(a))}}slice(t,e){void 0===e&&(e=this.byteLength),void 0===t&&(t=0);const a=e-t,i=Math.floor(t/ge);if(i==Math.floor((t+a-1)/ge)||0==a)return this.buffers[i].slice(t%ge,t%ge+a);let o,n=i,r=t%ge,l=a;for(;l>0;){const t=r+l>ge?ge-r:l,e=new Uint8Array(this.buffers[n].buffer,this.buffers[n].byteOffset+r,t);if(t==a)return e.slice();o||(o=a<=ge?new Uint8Array(a):new fe(a)),o.set(e,a-l),l-=t,n++,r=0}return o}set(t,e){void 0===e&&(e=0);const a=t.byteLength;if(0==a)return;const i=Math.floor(e/ge);if(i==Math.floor((e+a-1)/ge))return t instanceof fe&&1==t.buffers.length?this.buffers[i].set(t.buffers[0],e%ge):this.buffers[i].set(t,e%ge);let o=i,n=e%ge,r=a;for(;r>0;){const e=n+r>ge?ge-n:r,i=t.slice(a-r,a-r+e);new Uint8Array(this.buffers[o].buffer,this.buffers[o].byteOffset+n,e).set(i),r-=e,o++,n=0}}}function _e(t,e,a,i){return async function(o){const n=Math.floor(o.byteLength/a);if(n*a!==o.byteLength)throw new Error("Invalid buffer size");const r=Math.floor(n/t.concurrency),l=[];for(let c=0;c<t.concurrency;c++){let s;if(s=c<t.concurrency-1?r:n-c*r,0==s)continue;const d=[{cmd:"ALLOCSET",var:0,buff:o.slice(c*r*a,c*r*a+s*a)},{cmd:"ALLOC",var:1,len:i*s},{cmd:"CALL",fnName:e,params:[{var:0},{val:s},{var:1}]},{cmd:"GET",out:0,var:1,len:i*s}];l.push(t.queueAction(d))}const c=await Promise.all(l);let s;s=o instanceof fe?new fe(n*i):new Uint8Array(n*i);let d=0;for(let t=0;t<c.length;t++)s.set(c[t][0],d),d+=c[t][0].byteLength;return s}}class pe{constructor(t,e,a,i){if(this.tm=t,this.prefix=e,this.p=i,this.n8=a,this.type="F1",this.m=1,this.half=q(i,E),this.bitLength=P(i),this.mask=V(z(E,this.bitLength),E),this.pOp1=t.alloc(a),this.pOp2=t.alloc(a),this.pOp3=t.alloc(a),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(a/8),this.n32=Math.floor(a/4),8*this.n64!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=q(this.p,E),this.nqr=this.two;let o=this.exp(this.nqr,this.half);for(;!this.eq(o,this.negone);)this.nqr=this.add(this.nqr,this.one),o=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let n=V(this.p,E);for(;!k(n);)this.s=this.s+1,n=q(n,E);this.w=[],this.w[this.s]=this.exp(this.nqr,n);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=_e(t,e+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=_e(t,e+"_batchFromMontgomery",this.n8,this.n8)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=x(S(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,e){if(t instanceof Uint8Array)return t;let a=S(t,e);O(a)?(a=j(a),it(a,this.p)&&(a=X(a,this.p)),a=V(this.p,a)):it(a,this.p)&&(a=X(a,this.p));const i=re(a,this.n8);return this.toMontgomery(i)}toString(t,e){const a=this.fromMontgomery(t),i=I(a,0);return F(i,e)}fromRng(t){let e;const a=new Uint8Array(this.n8);do{e=v;for(let a=0;a<this.n64;a++)e=K(e,z(t.nextU64(),64*a));e=rt(e,this.mask)}while(nt(e,this.p));return b(a,0,e,this.n8),a}random(){return this.fromRng(yt())}toObject(t){const e=this.fromMontgomery(t);return I(e,0)}fromObject(t){const e=new Uint8Array(this.n8);return b(e,0,t,this.n8),this.toMontgomery(e)}toRprLE(t,e,a){t.set(this.fromMontgomery(a),e)}toRprBE(t,e,a){const i=this.fromMontgomery(a);for(let t=0;t<this.n8/2;t++){const e=i[t];i[t]=i[this.n8-1-t],i[this.n8-1-t]=e}t.set(i,e)}fromRprLE(t,e){e=e||0;const a=t.slice(e,e+this.n8);return this.toMontgomery(a)}async batchInverse(t){let e=!1;const a=this.n8,i=this.n8;Array.isArray(t)?(t=le(t,a),e=!0):t=t.slice(0,t.byteLength);const o=Math.floor(t.byteLength/a);if(o*a!==t.byteLength)throw new Error("Invalid buffer size");const n=Math.floor(o/this.tm.concurrency),r=[];for(let e=0;e<this.tm.concurrency;e++){let l;if(l=e<this.tm.concurrency-1?n:o-e*n,0==l)continue;const c=[{cmd:"ALLOCSET",var:0,buff:t.slice(e*n*a,e*n*a+l*a)},{cmd:"ALLOC",var:1,len:i*l},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:a},{val:l},{var:1},{val:i}]},{cmd:"GET",out:0,var:1,len:i*l}];r.push(this.tm.queueAction(c))}const l=await Promise.all(r);let c;c=t instanceof fe?new fe(o*i):new Uint8Array(o*i);let s=0;for(let t=0;t<l.length;t++)c.set(l[t][0],s),s+=l[t][0].byteLength;return e?ce(c,i):c}}class he{constructor(t,e,a){this.tm=t,this.prefix=e,this.F=a,this.type="F2",this.m=2*a.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*a.n8),this.pOp2=t.alloc(2*a.n8),this.pOp3=t.alloc(2*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}mul1(t,e){return this.op2("_mul1",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=x(S(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){const a=this.F.e(t[0],e),i=this.F.e(t[1],e),o=new Uint8Array(2*this.F.n8);return o.set(a),o.set(i,2*this.F.n8),o}throw new Error("invalid F2")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),a=this.F.fromRng(t),i=new Uint8Array(2*this.F.n8);return i.set(e),i.set(a,this.F.n8),i}random(){return this.fromRng(yt())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8))]}fromObject(t){const e=new Uint8Array(2*this.F.n8),a=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);return e.set(a),e.set(i,this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class me{constructor(t,e,a){this.tm=t,this.prefix=e,this.F=a,this.type="F3",this.m=3*a.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*a.n8),this.pOp2=t.alloc(3*a.n8),this.pOp3=t.alloc(3*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}add(t,e){return this.op2("_add",t,e)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=x(S(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){const a=this.F.e(t[0],e),i=this.F.e(t[1],e),o=this.F.e(t[2],e),n=new Uint8Array(3*this.F.n8);return n.set(a),n.set(i,this.F.n8),n.set(o,2*this.F.n8),n}throw new Error("invalid F3")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),a=this.F.fromRng(t),i=this.F.fromRng(t),o=new Uint8Array(3*this.F.n8);return o.set(e),o.set(a,this.F.n8),o.set(i,2*this.F.n8),o}random(){return this.fromRng(yt())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8))]}fromObject(t){const e=new Uint8Array(3*this.F.n8),a=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]),o=this.F.fromObject(t[2]);return e.set(a),e.set(i,this.F.n8),e.set(o,2*this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class Le{constructor(t,e,a,i,o,n){this.tm=t,this.prefix=e,this.F=a,this.pOp1=t.alloc(3*a.n8),this.pOp2=t.alloc(3*a.n8),this.pOp3=t.alloc(3*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*a.n8),this.tm.instance.exports[e+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*a.n8),this.one=this.tm.getBuff(i,3*a.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(i,2*a.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(o,a.n8),n&&(this.cofactor=x(n)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=_e(t,e+"_batchLEMtoC",2*a.n8,a.n8),this.batchLEMtoU=_e(t,e+"_batchLEMtoU",2*a.n8,2*a.n8),this.batchCtoLEM=_e(t,e+"_batchCtoLEM",a.n8,2*a.n8),this.batchUtoLEM=_e(t,e+"_batchUtoLEM",2*a.n8,2*a.n8),this.batchToJacobian=_e(t,e+"_batchToJacobian",2*a.n8,3*a.n8),this.batchToAffine=_e(t,e+"_batchToAffine",3*a.n8,2*a.n8)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_add",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_addMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_addMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_addAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}sub(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_sub",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_subMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_subMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_subAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,e){let a;if(e instanceof Uint8Array||(e=x(S(e))),t.byteLength==3*this.F.n8)a=this.prefix+"_timesScalar";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");a=this.prefix+"_timesScalarAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[a](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,e){let a;if(t.byteLength==3*this.F.n8)a=this.prefix+"_timesFr";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");a=this.prefix+"_timesFrAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eq",t,e);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,e,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}fromRprUncompressed(t,e){const a=t.slice(e,e+2*this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,e,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,this.F.n8);t.set(i,e)}fromRprCompressed(t,e){const a=t.slice(e,e+this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){const e=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(e,0,t),e}toRprLEM(t,e,a){if(a.byteLength!=2*this.F.n8){if(a.byteLength!=3*this.F.n8)throw new Error("invalid point size");{this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}}else t.set(a,e)}fromRprLEM(t,e){return e=e||0,t.slice(e,e+2*this.F.n8)}toString(t,e){if(t.byteLength==3*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)} ]`}if(t.byteLength==2*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)} ]`}throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const e=this.F,a=this.toAffine(t),i=a.slice(0,this.F.n8),o=a.slice(this.F.n8,2*this.F.n8),n=e.add(e.mul(e.square(i),i),this.b),r=e.square(o);return e.eq(n,r)}fromRng(t){const e=this.F;let a,i,o=[];do{o[0]=e.fromRng(t),a=t.nextBool(),i=e.add(e.mul(e.square(o[0]),o[0]),this.b)}while(!e.isSquare(i));o[1]=e.sqrt(i);a^e.isNegative(o[1])&&(o[1]=e.neg(o[1]));let n=new Uint8Array(2*this.F.n8);return n.set(o[0]),n.set(o[1],this.F.n8),this.cofactor&&(n=this.timesScalar(n,this.cofactor)),n}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const e=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));let i;return i=t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one),[e,a,i]}fromObject(t){const e=this.F.fromObject(t[0]),a=this.F.fromObject(t[1]);let i;if(i=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(i,this.F.one))return this.zeroAffine;if(this.F.eq(i,this.F.one)){const t=new Uint8Array(2*this.F.n8);return t.set(e),t.set(a,this.F.n8),t}{const t=new Uint8Array(3*this.F.n8);return t.set(e),t.set(a,this.F.n8),t.set(i,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function we(t){const e=32767;let a,i;async function o(t){const o=new Uint8Array(t.code),n=await WebAssembly.compile(o);i=new WebAssembly.Memory({initial:t.init,maximum:e}),a=await WebAssembly.instantiate(n,{env:{memory:i}})}function n(t){const a=new Uint32Array(i.buffer,0,1);for(;3&a[0];)a[0]++;const o=a[0];if(a[0]+=t,a[0]+t>i.buffer.byteLength){const o=i.buffer.byteLength/65536;let n=Math.floor((a[0]+t)/65536)+1;n>e&&(n=e),i.grow(n-o)}return o}function r(t){const e=n(t.byteLength);return c(e,t),e}function l(t,e){const a=new Uint8Array(i.buffer);return new Uint8Array(a.buffer,a.byteOffset+t,e)}function c(t,e){new Uint8Array(i.buffer).set(new Uint8Array(e),t)}function s(t){if("INIT"==t[0].cmd)return o(t[0]);const e={vars:[],out:[]},s=new Uint32Array(i.buffer,0,1)[0];for(let i=0;i<t.length;i++)switch(t[i].cmd){case"ALLOCSET":e.vars[t[i].var]=r(t[i].buff);break;case"ALLOC":e.vars[t[i].var]=n(t[i].len);break;case"SET":c(e.vars[t[i].var],t[i].buff);break;case"CALL":{const o=[];for(let a=0;a<t[i].params.length;a++){const n=t[i].params[a];void 0!==n.var?o.push(e.vars[n.var]+(n.offset||0)):void 0!==n.val&&o.push(n.val)}a.exports[t[i].fnName](...o);break}case"GET":e.out[t[i].out]=l(e.vars[t[i].var],t[i].len).slice();break;default:throw new Error("Invalid cmd")}return new Uint32Array(i.buffer,0,1)[0]=s,e.out}return t&&(t.onmessage=function(e){let a;if(a=e.data?e.data:e,"INIT"==a[0].cmd)o(a[0]).then((function(){t.postMessage(a.result)}));else if("TERMINATE"==a[0].cmd)t.close();else{const e=s(a);t.postMessage(e)}}),s}var Ae={},be=Worker;class ye{constructor(){this.promise=new Promise(((t,e)=>{this.reject=e,this.resolve=t}))}}var Ie;const Ce="data:application/javascript;base64,"+(Ie="("+we.toString()+")(self)",globalThis.btoa(Ie));class Fe{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,e,a,i){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=i||new ye,this.workers[t].postMessage(e,a),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(0==this.working[t]){const e=this.actionQueue.shift();this.postAction(t,e.data,e.transfers,e.deferred)}}queueAction(t,e){const a=new ye;if(this.singleThread){const e=this.taskManager(t);a.resolve(e)}else this.actionQueue.push({data:t,transfers:e,deferred:a}),this.processWorks();return a.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const e=this.alloc(t.byteLength);return this.setBuff(e,t),e}getBuff(t,e){return this.u8.slice(t,t+e)}setBuff(t,e){this.u8.set(new Uint8Array(e),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;const e=this.u32[0];return this.u32[0]+=t,e}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);var t;await(t=200,new Promise((e=>setTimeout(e,t))))}}function xe(t,e){const a=t[e],i=t.Fr,o=t.tm;t[e].batchApplyKey=async function(t,n,r,l,c){let s,d,u,g,f;if(l=l||"affine",c=c||"affine","G1"==e)"jacobian"==l?(u=3*a.F.n8,s="g1m_batchApplyKey"):(u=2*a.F.n8,s="g1m_batchApplyKeyMixed"),g=3*a.F.n8,"jacobian"==c?f=3*a.F.n8:(d="g1m_batchToAffine",f=2*a.F.n8);else if("G2"==e)"jacobian"==l?(u=3*a.F.n8,s="g2m_batchApplyKey"):(u=2*a.F.n8,s="g2m_batchApplyKeyMixed"),g=3*a.F.n8,"jacobian"==c?f=3*a.F.n8:(d="g2m_batchToAffine",f=2*a.F.n8);else{if("Fr"!=e)throw new Error("Invalid group: "+e);s="frm_batchApplyKey",u=a.n8,g=a.n8,f=a.n8}const _=Math.floor(t.byteLength/u),p=Math.floor(_/o.concurrency),h=[];r=i.e(r);let m=i.e(n);for(let e=0;e<o.concurrency;e++){let a;if(a=e<o.concurrency-1?p:_-e*p,0==a)continue;const n=[];n.push({cmd:"ALLOCSET",var:0,buff:t.slice(e*p*u,e*p*u+a*u)}),n.push({cmd:"ALLOCSET",var:1,buff:m}),n.push({cmd:"ALLOCSET",var:2,buff:r}),n.push({cmd:"ALLOC",var:3,len:a*Math.max(g,f)}),n.push({cmd:"CALL",fnName:s,params:[{var:0},{val:a},{var:1},{var:2},{var:3}]}),d&&n.push({cmd:"CALL",fnName:d,params:[{var:3},{val:a},{var:3}]}),n.push({cmd:"GET",out:0,var:3,len:a*f}),h.push(o.queueAction(n)),m=i.mul(m,i.exp(r,a))}const L=await Promise.all(h);let w;w=t instanceof fe?new fe(_*f):new Uint8Array(_*f);let A=0;for(let t=0;t<L.length;t++)w.set(L[t][0],A),A+=L[t][0].byteLength;return w}}const ve=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function Ee(t,e){const a=t[e],i=a.tm;async function o(t,i,o,n,r){if(!(t instanceof Uint8Array))throw n&&n.error(`${r} _multiExpChunk buffBases is not Uint8Array`),new Error(`${r} _multiExpChunk buffBases is not Uint8Array`);if(!(i instanceof Uint8Array))throw n&&n.error(`${r} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${r} _multiExpChunk buffScalars is not Uint8Array`);let l,c;if(o=o||"affine","G1"==e)"affine"==o?(c="g1m_multiexpAffine_chunk",l=2*a.F.n8):(c="g1m_multiexp_chunk",l=3*a.F.n8);else{if("G2"!=e)throw new Error("Invalid group");"affine"==o?(c="g2m_multiexpAffine_chunk",l=2*a.F.n8):(c="g2m_multiexp_chunk",l=3*a.F.n8)}const s=Math.floor(t.byteLength/l);if(0==s)return a.zero;const d=Math.floor(i.byteLength/s);if(d*s!=i.byteLength)throw new Error("Scalar size does not match");const u=ve[Xt(s)],g=Math.floor((8*d-1)/u)+1,f=[];for(let e=0;e<g;e++){const o=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:i},{cmd:"ALLOC",var:2,len:3*a.F.n8},{cmd:"CALL",fnName:c,params:[{var:0},{var:1},{val:d},{val:s},{val:e*u},{val:Math.min(8*d-e*u,u)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*a.F.n8}];f.push(a.tm.queueAction(o))}const _=await Promise.all(f);let p=a.zero;for(let t=_.length-1;t>=0;t--){if(!a.isZero(p))for(let t=0;t<u;t++)p=a.double(p);p=a.add(p,_[t][0])}return p}async function n(t,n,r,l,c){const s=1<<22;let d;if("G1"==e)d="affine"==r?2*a.F.n8:3*a.F.n8;else{if("G2"!=e)throw new Error("Invalid group");d="affine"==r?2*a.F.n8:3*a.F.n8}const u=Math.floor(t.byteLength/d),g=Math.floor(n.byteLength/u);if(g*u!=n.byteLength)throw new Error("Scalar size does not match");const f=ve[Xt(u)],_=Math.floor((8*g-1)/f)+1;let p;p=Math.floor(u/(i.concurrency/_)),p>s&&(p=s),p<1024&&(p=1024);const h=[];for(let e=0;e<u;e+=p){l&&l.debug(`Multiexp start: ${c}: ${e}/${u}`);const a=Math.min(u-e,p),i=t.slice(e*d,(e+a)*d),s=n.slice(e*g,(e+a)*g);h.push(o(i,s,r,l,c).then((t=>(l&&l.debug(`Multiexp end: ${c}: ${e}/${u}`),t))))}const m=await Promise.all(h);let L=a.zero;for(let t=m.length-1;t>=0;t--)L=a.add(L,m[t]);return L}a.multiExp=async function(t,e,a,i){return await n(t,e,"jacobian",a,i)},a.multiExpAffine=async function(t,e,a,i){return await n(t,e,"affine",a,i)}}function Be(t,e){const a=t[e],i=t.Fr,o=a.tm;async function n(t,l,c,s,d,u){c=c||"affine",s=s||"affine";let g,f,_,p,h,m,L,w;"G1"==e?("affine"==c?(g=2*a.F.n8,p="g1m_batchToJacobian"):g=3*a.F.n8,f=3*a.F.n8,l&&(w="g1m_fftFinal"),L="g1m_fftJoin",m="g1m_fftMix","affine"==s?(_=2*a.F.n8,h="g1m_batchToAffine"):_=3*a.F.n8):"G2"==e?("affine"==c?(g=2*a.F.n8,p="g2m_batchToJacobian"):g=3*a.F.n8,f=3*a.F.n8,l&&(w="g2m_fftFinal"),L="g2m_fftJoin",m="g2m_fftMix","affine"==s?(_=2*a.F.n8,h="g2m_batchToAffine"):_=3*a.F.n8):"Fr"==e&&(g=a.n8,f=a.n8,_=a.n8,l&&(w="frm_fftFinal"),m="frm_fftMix",L="frm_fftJoin");let A=!1;Array.isArray(t)?(t=le(t,g),A=!0):t=t.slice(0,t.byteLength);const b=t.byteLength/g,y=Xt(b);if(1<<y!=b)throw new Error("fft must be multiple of 2");if(y==i.s+1){let e;return e=l?await async function(t,e,a,o,l){let c,s;c=t.slice(0,t.byteLength/2),s=t.slice(t.byteLength/2,t.byteLength);const d=[];d.push(n(c,!0,e,"jacobian",o,l)),d.push(n(s,!0,e,"jacobian",o,l)),[c,s]=await Promise.all(d);const u=await r(c,s,"fftJoinExtInv",i.one,i.shiftInv,"jacobian",a,o,l);let g;g=u[0].byteLength>1<<28?new fe(2*u[0].byteLength):new Uint8Array(2*u[0].byteLength);return g.set(u[0]),g.set(u[1],u[0].byteLength),g}(t,c,s,d,u):await async function(t,e,a,o,l){let c,s;c=t.slice(0,t.byteLength/2),s=t.slice(t.byteLength/2,t.byteLength);const d=[];[c,s]=await r(c,s,"fftJoinExt",i.one,i.shift,e,"jacobian",o,l),d.push(n(c,!1,"jacobian",a,o,l)),d.push(n(s,!1,"jacobian",a,o,l));const u=await Promise.all(d);let g;g=u[0].byteLength>1<<28?new fe(2*u[0].byteLength):new Uint8Array(2*u[0].byteLength);return g.set(u[0]),g.set(u[1],u[0].byteLength),g}(t,c,s,d,u),A?ce(e,_):e}let I,C,F;l&&(I=i.inv(i.e(b))),te(t,g);let x=Math.min(16384,b),v=b/x;for(;v<o.concurrency&&x>=16;)v*=2,x/=2;const E=Xt(x),B=[];for(let e=0;e<v;e++){d&&d.debug(`${u}: fft ${y} mix start: ${e}/${v}`);const a=[];a.push({cmd:"ALLOC",var:0,len:f*x});const i=t.slice(x*e*g,x*(e+1)*g);a.push({cmd:"SET",var:0,buff:i}),p&&a.push({cmd:"CALL",fnName:p,params:[{var:0},{val:x},{var:0}]});for(let t=1;t<=E;t++)a.push({cmd:"CALL",fnName:m,params:[{var:0},{val:x},{val:t}]});E==y?(w&&(a.push({cmd:"ALLOCSET",var:1,buff:I}),a.push({cmd:"CALL",fnName:w,params:[{var:0},{val:x},{var:1}]})),h&&a.push({cmd:"CALL",fnName:h,params:[{var:0},{val:x},{var:0}]}),a.push({cmd:"GET",out:0,var:0,len:x*_})):a.push({cmd:"GET",out:0,var:0,len:f*x}),B.push(o.queueAction(a).then((t=>(d&&d.debug(`${u}: fft ${y} mix end: ${e}/${v}`),t))))}F=await Promise.all(B);for(let t=0;t<v;t++)F[t]=F[t][0];for(let t=E+1;t<=y;t++){d&&d.debug(`${u}: fft  ${y}  join: ${t}/${y}`);const e=1<<y-t,a=v/e,n=[];for(let r=0;r<e;r++)for(let l=0;l<a/2;l++){const c=i.exp(i.w[t],l*x),s=i.w[t],g=r*a+l,p=r*a+l+a/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:F[g]}),m.push({cmd:"ALLOCSET",var:1,buff:F[p]}),m.push({cmd:"ALLOCSET",var:2,buff:c}),m.push({cmd:"ALLOCSET",var:3,buff:s}),m.push({cmd:"CALL",fnName:L,params:[{var:0},{var:1},{val:x},{var:2},{var:3}]}),t==y?(w&&(m.push({cmd:"ALLOCSET",var:4,buff:I}),m.push({cmd:"CALL",fnName:w,params:[{var:0},{val:x},{var:4}]}),m.push({cmd:"CALL",fnName:w,params:[{var:1},{val:x},{var:4}]})),h&&(m.push({cmd:"CALL",fnName:h,params:[{var:0},{val:x},{var:0}]}),m.push({cmd:"CALL",fnName:h,params:[{var:1},{val:x},{var:1}]})),m.push({cmd:"GET",out:0,var:0,len:x*_}),m.push({cmd:"GET",out:1,var:1,len:x*_})):(m.push({cmd:"GET",out:0,var:0,len:x*f}),m.push({cmd:"GET",out:1,var:1,len:x*f})),n.push(o.queueAction(m).then((i=>(d&&d.debug(`${u}: fft ${y} join  ${t}/${y}  ${r+1}/${e} ${l}/${a/2}`),i))))}const r=await Promise.all(n);for(let t=0;t<e;t++)for(let e=0;e<a/2;e++){const i=t*a+e,o=t*a+e+a/2,n=r.shift();F[i]=n[0],F[o]=n[1]}}if(C=t instanceof fe?new fe(b*_):new Uint8Array(b*_),l){C.set(F[0].slice((x-1)*_));let t=_;for(let e=v-1;e>0;e--)C.set(F[e],t),t+=x*_,delete F[e];C.set(F[0].slice(0,(x-1)*_),t),delete F[0]}else for(let t=0;t<v;t++)C.set(F[t],x*_*t),delete F[t];return A?ce(C,_):C}async function r(t,n,r,l,c,s,d,u,g){let f,_,p,h,m,L;if("G1"==e)"affine"==s?(m=2*a.F.n8,_="g1m_batchToJacobian"):m=3*a.F.n8,L=3*a.F.n8,f="g1m_"+r,"affine"==d?(p="g1m_batchToAffine",h=2*a.F.n8):h=3*a.F.n8;else if("G2"==e)"affine"==s?(m=2*a.F.n8,_="g2m_batchToJacobian"):m=3*a.F.n8,f="g2m_"+r,L=3*a.F.n8,"affine"==d?(p="g2m_batchToAffine",h=2*a.F.n8):h=3*a.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");m=i.n8,h=i.n8,L=i.n8,f="frm_"+r}if(t.byteLength!=n.byteLength)throw new Error("Invalid buffer size");const w=Math.floor(t.byteLength/m);if(w!=1<<Xt(w))throw new Error("Invalid number of points");let A=Math.floor(w/o.concurrency);A<16&&(A=16),A>65536&&(A=65536);const b=[];for(let e=0;e<w;e+=A){u&&u.debug(`${g}: fftJoinExt Start: ${e}/${w}`);const a=Math.min(w-e,A),r=i.mul(l,i.exp(c,e)),s=[],d=t.slice(e*m,(e+a)*m),y=n.slice(e*m,(e+a)*m);s.push({cmd:"ALLOC",var:0,len:L*a}),s.push({cmd:"SET",var:0,buff:d}),s.push({cmd:"ALLOC",var:1,len:L*a}),s.push({cmd:"SET",var:1,buff:y}),s.push({cmd:"ALLOCSET",var:2,buff:r}),s.push({cmd:"ALLOCSET",var:3,buff:c}),_&&(s.push({cmd:"CALL",fnName:_,params:[{var:0},{val:a},{var:0}]}),s.push({cmd:"CALL",fnName:_,params:[{var:1},{val:a},{var:1}]})),s.push({cmd:"CALL",fnName:f,params:[{var:0},{var:1},{val:a},{var:2},{var:3},{val:i.s}]}),p&&(s.push({cmd:"CALL",fnName:p,params:[{var:0},{val:a},{var:0}]}),s.push({cmd:"CALL",fnName:p,params:[{var:1},{val:a},{var:1}]})),s.push({cmd:"GET",out:0,var:0,len:a*h}),s.push({cmd:"GET",out:1,var:1,len:a*h}),b.push(o.queueAction(s).then((t=>(u&&u.debug(`${g}: fftJoinExt End: ${e}/${w}`),t))))}const y=await Promise.all(b);let I,C;w*h>1<<28?(I=new fe(w*h),C=new fe(w*h)):(I=new Uint8Array(w*h),C=new Uint8Array(w*h));let F=0;for(let t=0;t<y.length;t++)I.set(y[t][0],F),C.set(y[t][1],F),F+=y[t][0].byteLength;return[I,C]}a.fft=async function(t,e,a,i,o){return await n(t,!1,e,a,i,o)},a.ifft=async function(t,e,a,i,o){return await n(t,!0,e,a,i,o)},a.lagrangeEvaluations=async function(t,o,l,c,s){let d;if(o=o||"affine",l=l||"affine","G1"==e)d="affine"==o?2*a.F.n8:3*a.F.n8;else if("G2"==e)d="affine"==o?2*a.F.n8:3*a.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");d=i.n8}const u=t.byteLength/d,g=Xt(u);if(2**g*d!=t.byteLength)throw c&&c.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(g<=i.s)return await a.ifft(t,o,l,c,s);if(g>i.s+1)throw c&&c.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let f=t.slice(0,t.byteLength/2),_=t.slice(t.byteLength/2,t.byteLength);const p=i.exp(i.shift,u/2),h=i.inv(i.sub(i.one,p));[f,_]=await r(f,_,"prepareLagrangeEvaluation",h,i.shiftInv,o,"jacobian",c,s+" prep");const m=[];let L;return m.push(n(f,!0,"jacobian",l,c,s+" t0")),m.push(n(_,!0,"jacobian",l,c,s+" t1")),[f,_]=await Promise.all(m),L=f.byteLength>1<<28?new fe(2*f.byteLength):new Uint8Array(2*f.byteLength),L.set(f),L.set(_,f.byteLength),L},a.fftMix=async function(t){const n=3*a.F.n8;let r,l;if("G1"==e)r="g1m_fftMix",l="g1m_fftJoin";else if("G2"==e)r="g2m_fftMix",l="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");r="frm_fftMix",l="frm_fftJoin"}const c=Math.floor(t.byteLength/n),s=Xt(c);let d=1<<Xt(o.concurrency);c<=2*d&&(d=1);const u=c/d,g=Xt(u),f=[];for(let e=0;e<d;e++){const a=[],i=t.slice(e*u*n,(e+1)*u*n);a.push({cmd:"ALLOCSET",var:0,buff:i});for(let t=1;t<=g;t++)a.push({cmd:"CALL",fnName:r,params:[{var:0},{val:u},{val:t}]});a.push({cmd:"GET",out:0,var:0,len:u*n}),f.push(o.queueAction(a))}const _=await Promise.all(f),p=[];for(let t=0;t<_.length;t++)p[t]=_[t][0];for(let t=g+1;t<=s;t++){const e=1<<s-t,a=d/e,r=[];for(let c=0;c<e;c++)for(let e=0;e<a/2;e++){const s=i.exp(i.w[t],e*u),d=i.w[t],g=c*a+e,f=c*a+e+a/2,_=[];_.push({cmd:"ALLOCSET",var:0,buff:p[g]}),_.push({cmd:"ALLOCSET",var:1,buff:p[f]}),_.push({cmd:"ALLOCSET",var:2,buff:s}),_.push({cmd:"ALLOCSET",var:3,buff:d}),_.push({cmd:"CALL",fnName:l,params:[{var:0},{var:1},{val:u},{var:2},{var:3}]}),_.push({cmd:"GET",out:0,var:0,len:u*n}),_.push({cmd:"GET",out:1,var:1,len:u*n}),r.push(o.queueAction(_))}const c=await Promise.all(r);for(let t=0;t<e;t++)for(let e=0;e<a/2;e++){const i=t*a+e,o=t*a+e+a/2,n=c.shift();p[i]=n[0],p[o]=n[1]}}let h;h=t instanceof fe?new fe(c*n):new Uint8Array(c*n);let m=0;for(let t=0;t<d;t++)h.set(p[t],m),m+=p[t].byteLength;return h},a.fftJoin=async function(t,n,r,l){const c=3*a.F.n8;let s;if("G1"==e)s="g1m_fftJoin";else if("G2"==e)s="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");s="frm_fftJoin"}if(t.byteLength!=n.byteLength)throw new Error("Invalid buffer size");const d=Math.floor(t.byteLength/c);if(d!=1<<Xt(d))throw new Error("Invalid number of points");let u=1<<Xt(o.concurrency);d<=2*u&&(u=1);const g=d/u,f=[];for(let e=0;e<u;e++){const a=[],d=i.mul(r,i.exp(l,e*g)),u=t.slice(e*g*c,(e+1)*g*c),_=n.slice(e*g*c,(e+1)*g*c);a.push({cmd:"ALLOCSET",var:0,buff:u}),a.push({cmd:"ALLOCSET",var:1,buff:_}),a.push({cmd:"ALLOCSET",var:2,buff:d}),a.push({cmd:"ALLOCSET",var:3,buff:l}),a.push({cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:g},{var:2},{var:3}]}),a.push({cmd:"GET",out:0,var:0,len:g*c}),a.push({cmd:"GET",out:1,var:1,len:g*c}),f.push(o.queueAction(a))}const _=await Promise.all(f);let p,h;t instanceof fe?(p=new fe(d*c),h=new fe(d*c)):(p=new Uint8Array(d*c),h=new Uint8Array(d*c));let m=0;for(let t=0;t<_.length;t++)p.set(_[t][0],m),h.set(_[t][1],m),m+=_[t][0].byteLength;return[p,h]},a.fftFinal=async function(t,i){const n=3*a.F.n8,r=2*a.F.n8;let l,c;if("G1"==e)l="g1m_fftFinal",c="g1m_batchToAffine";else{if("G2"!=e)throw new Error("Invalid group");l="g2m_fftFinal",c="g2m_batchToAffine"}const s=Math.floor(t.byteLength/n);if(s!=1<<Xt(s))throw new Error("Invalid number of points");const d=Math.floor(s/o.concurrency),u=[];for(let e=0;e<o.concurrency;e++){let a;if(a=e<o.concurrency-1?d:s-e*d,0==a)continue;const g=[],f=t.slice(e*d*n,(e*d+a)*n);g.push({cmd:"ALLOCSET",var:0,buff:f}),g.push({cmd:"ALLOCSET",var:1,buff:i}),g.push({cmd:"CALL",fnName:l,params:[{var:0},{val:a},{var:1}]}),g.push({cmd:"CALL",fnName:c,params:[{var:0},{val:a},{var:0}]}),g.push({cmd:"GET",out:0,var:0,len:a*r}),u.push(o.queueAction(g))}const g=await Promise.all(u);let f;f=t instanceof fe?new fe(s*r):new Uint8Array(s*r);let _=0;for(let t=g.length-1;t>=0;t--)f.set(g[t][0],_),_+=g[t][0].byteLength;return f}}async function Se(t){const e=await async function(t,e){const a=new Fe;a.memory=new WebAssembly.Memory({initial:25}),a.u8=new Uint8Array(a.memory.buffer),a.u32=new Uint32Array(a.memory.buffer);const i=await WebAssembly.compile(t.code);if(a.instance=await WebAssembly.instantiate(i,{env:{memory:a.memory}}),a.singleThread=e,a.initalPFree=a.u32[0],a.pq=t.pq,a.pr=t.pr,a.pG1gen=t.pG1gen,a.pG1zero=t.pG1zero,a.pG2gen=t.pG2gen,a.pG2zero=t.pG2zero,a.pOneT=t.pOneT,e)a.code=t.code,a.taskManager=we(),await a.taskManager([{cmd:"INIT",init:25,code:a.code.slice()}]),a.concurrency=1;else{let e;a.workers=[],a.pendingDeferreds=[],a.working=[],e="object"==typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:Ae.cpus().length,0==e&&(e=2),e>64&&(e=64),a.concurrency=e;for(let t=0;t<e;t++)a.workers[t]=new be(Ce),a.workers[t].addEventListener("message",o(t)),a.working[t]=!1;const i=[];for(let e=0;e<a.workers.length;e++){const o=t.code.slice();i.push(a.postAction(e,[{cmd:"INIT",init:25,code:o}],[o.buffer]))}await Promise.all(i)}return a;function o(t){return function(e){let i;i=e&&e.data?e.data:e,a.working[t]=!1,a.pendingDeferreds[t].resolve(i),a.processWorks()}}}(t.wasm,t.singleThread),a={};return a.q=S(t.wasm.q),a.r=S(t.wasm.r),a.name=t.name,a.tm=e,a.prePSize=t.wasm.prePSize,a.preQSize=t.wasm.preQSize,a.Fr=new pe(e,"frm",t.n8r,t.r),a.F1=new pe(e,"f1m",t.n8q,t.q),a.F2=new he(e,"f2m",a.F1),a.G1=new Le(e,"g1m",a.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),a.G2=new Le(e,"g2m",a.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),a.F6=new me(e,"f6m",a.F2),a.F12=new he(e,"ftm",a.F6),a.Gt=a.F12,xe(a,"G1"),xe(a,"G2"),xe(a,"Fr"),Ee(a,"G1"),Ee(a,"G2"),Be(a,"G1"),Be(a,"G2"),Be(a,"Fr"),function(t){const e=t.tm;t.pairing=function(a,i){e.startSyncOp();const o=e.allocBuff(t.G1.toJacobian(a)),n=e.allocBuff(t.G2.toJacobian(i)),r=e.alloc(t.Gt.n8);e.instance.exports[t.name+"_pairing"](o,n,r);const l=e.getBuff(r,t.Gt.n8);return e.endSyncOp(),l},t.pairingEq=async function(){let a,i;arguments.length%2==1?(a=arguments[arguments.length-1],i=(arguments.length-1)/2):(a=t.Gt.one,i=arguments.length/2);const o=[];for(let a=0;a<i;a++){const i=[],n=t.G1.toJacobian(arguments[2*a]);i.push({cmd:"ALLOCSET",var:0,buff:n}),i.push({cmd:"ALLOC",var:1,len:t.prePSize});const r=t.G2.toJacobian(arguments[2*a+1]);i.push({cmd:"ALLOCSET",var:2,buff:r}),i.push({cmd:"ALLOC",var:3,len:t.preQSize}),i.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),i.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),i.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),i.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),i.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),o.push(e.queueAction(i))}const n=await Promise.all(o);e.startSyncOp();const r=e.alloc(t.Gt.n8);e.instance.exports.ftm_one(r);for(let t=0;t<n.length;t++){const a=e.allocBuff(n[t][0]);e.instance.exports.ftm_mul(r,a,r)}e.instance.exports[t.name+"_finalExponentiation"](r,r);const l=e.allocBuff(a),c=!!e.instance.exports.ftm_eq(r,l);return e.endSyncOp(),c},t.prepareG1=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),a=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](e,a);const i=this.tm.getBuff(a,this.prePSize);return this.tm.endSyncOp(),i},t.prepareG2=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),a=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](e,a);const i=this.tm.getBuff(a,this.preQSize);return this.tm.endSyncOp(),i},t.millerLoop=function(t,e){this.tm.startSyncOp();const a=this.tm.allocBuff(t),i=this.tm.allocBuff(e),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](a,i,o);const n=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),n},t.finalExponentiation=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](e,a);const i=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),i}}(a),a.array2buffer=function(t,e){const a=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)a.set(t[i],i*e);return a},a.buffer2array=function(t,e){const a=t.byteLength/e,i=new Array(a);for(let o=0;o<a;o++)i[o]=t.slice(o*e,o*e+e);return i},a}function Ge(t){let e;return e="string"==typeof t&&"0x"==t.slice(0,2).toLowerCase()?u(t.slice(2),16):u(t),e}function Pe(t){const e=[];let a=Ge(t);if(a.isNegative())throw new Error("Number cannot be negative");for(;!a.isZero();)e.push(a.and(127).toJSNumber()),a=a.shiftRight(7);0==e.length&&e.push(0);for(let t=0;t<e.length-1;t++)e[t]=128|e[t];return e}function Oe(t){let e,a;const i=t.bitLength().toJSNumber();t<0?(a=!0,e=u.one.shiftLeft(i).add(t)):(a=!1,e=Ge(t));const o=7-i%7,n=u.one.shiftLeft(o).minus(1).shiftLeft(i),r=(1<<7-o)-1|128,l=Pe(e.add(n));return a||(l[l.length-1]=l[l.length-1]&r),l}function Ue(t){let e=Ge(t);if(e.greater(u("FFFFFFFF",16)))throw new Error("Number too big");return Pe(e)}var ze=function(t){const e=function(t){for(var e=[],a=0;a<t.length;a++){var i=t.charCodeAt(a);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(a++,i=65536+((1023&i)<<10|1023&t.charCodeAt(a)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e}(t);return[...Ue(e.length),...e]},qe=function t(e){if("string"==typeof e){let t=e.split("\\n");for(let e=0;e<t.length;e++)t[e]&&(t[e]="    "+t[e]);return t.join("\\n")}if(Array.isArray(e)){for(let a=0;a<e.length;a++)e[a]=t(e[a]);return e}},Qe={toNumber:Ge,u32:function(t){const e=[],a=Ge(t);return e.push(a.and(255).toJSNumber()),e.push(a.shiftRight(8).and(255).toJSNumber()),e.push(a.shiftRight(16).and(255).toJSNumber()),e.push(a.shiftRight(24).and(255).toJSNumber()),e},u64:function(t){const e=[],a=Ge(t);return e.push(a.and(255).toJSNumber()),e.push(a.shiftRight(8).and(255).toJSNumber()),e.push(a.shiftRight(16).and(255).toJSNumber()),e.push(a.shiftRight(24).and(255).toJSNumber()),e.push(a.shiftRight(32).and(255).toJSNumber()),e.push(a.shiftRight(40).and(255).toJSNumber()),e.push(a.shiftRight(48).and(255).toJSNumber()),e.push(a.shiftRight(56).and(255).toJSNumber()),e},varuint32:Ue,varuint64:function(t){let e=Ge(t);if(e.greater(u("FFFFFFFFFFFFFFFF",16)))throw new Error("Number too big");return Pe(e)},varint32:function(t){let e=Ge(t);if(e.greater(u("FFFFFFFF",16)))throw new Error("Number too big");if(e.greater(u("7FFFFFFF",16))&&(e=e.minus(u("100000000",16))),e.lesser(u("-80000000",16)))throw new Error("Number too small");return Oe(e)},varint64:function(t){let e=Ge(t);if(e.greater(u("FFFFFFFFFFFFFFFF",16)))throw new Error("Number too big");if(e.greater(u("7FFFFFFFFFFFFFFF",16))&&(e=e.minus(u("10000000000000000",16))),e.lesser(u("-8000000000000000",16)))throw new Error("Number too small");return Oe(e)},string:ze,toHexString:function(t){return Array.from(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")},ident:qe};var Me=class{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,e){const a=this.func.localIdxByName[t];if(void 0===a)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,33,...Qe.varuint32(a)]}teeLocal(t,e){const a=this.func.localIdxByName[t];if(void 0===a)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,34,...Qe.varuint32(a)]}getLocal(t){const e=this.func.localIdxByName[t];if(void 0===e)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...Qe.varuint32(e)]}i64_load8_s(t,e,a){const i=e||0;return[...t,48,void 0===a?0:a,...Qe.varuint32(i)]}i64_load8_u(t,e,a){const i=e||0;return[...t,49,void 0===a?0:a,...Qe.varuint32(i)]}i64_load16_s(t,e,a){const i=e||0;return[...t,50,void 0===a?1:a,...Qe.varuint32(i)]}i64_load16_u(t,e,a){const i=e||0;return[...t,51,void 0===a?1:a,...Qe.varuint32(i)]}i64_load32_s(t,e,a){const i=e||0;return[...t,52,void 0===a?2:a,...Qe.varuint32(i)]}i64_load32_u(t,e,a){const i=e||0;return[...t,53,void 0===a?2:a,...Qe.varuint32(i)]}i64_load(t,e,a){const i=e||0;return[...t,41,void 0===a?3:a,...Qe.varuint32(i)]}i64_store(t,e,a,i){let o,n,r;return Array.isArray(e)?(o=0,n=3,r=e):Array.isArray(a)?(o=e,n=3,r=a):Array.isArray(i)&&(o=e,n=a,r=i),[...t,...r,55,n,...Qe.varuint32(o)]}i64_store32(t,e,a,i){let o,n,r;return Array.isArray(e)?(o=0,n=2,r=e):Array.isArray(a)?(o=e,n=2,r=a):Array.isArray(i)&&(o=e,n=a,r=i),[...t,...r,62,n,...Qe.varuint32(o)]}i64_store16(t,e,a,i){let o,n,r;return Array.isArray(e)?(o=0,n=1,r=e):Array.isArray(a)?(o=e,n=1,r=a):Array.isArray(i)&&(o=e,n=a,r=i),[...t,...r,61,n,...Qe.varuint32(o)]}i64_store8(t,e,a,i){let o,n,r;return Array.isArray(e)?(o=0,n=0,r=e):Array.isArray(a)?(o=e,n=0,r=a):Array.isArray(i)&&(o=e,n=a,r=i),[...t,...r,60,n,...Qe.varuint32(o)]}i32_load8_s(t,e,a){const i=e||0;return[...t,44,void 0===a?0:a,...Qe.varuint32(i)]}i32_load8_u(t,e,a){const i=e||0;return[...t,45,void 0===a?0:a,...Qe.varuint32(i)]}i32_load16_s(t,e,a){const i=e||0;return[...t,46,void 0===a?1:a,...Qe.varuint32(i)]}i32_load16_u(t,e,a){const i=e||0;return[...t,47,void 0===a?1:a,...Qe.varuint32(i)]}i32_load(t,e,a){const i=e||0;return[...t,40,void 0===a?2:a,...Qe.varuint32(i)]}i32_store(t,e,a,i){let o,n,r;return Array.isArray(e)?(o=0,n=2,r=e):Array.isArray(a)?(o=e,n=2,r=a):Array.isArray(i)&&(o=e,n=a,r=i),[...t,...r,54,n,...Qe.varuint32(o)]}i32_store16(t,e,a,i){let o,n,r;return Array.isArray(e)?(o=0,n=1,r=e):Array.isArray(a)?(o=e,n=1,r=a):Array.isArray(i)&&(o=e,n=a,r=i),[...t,...r,59,n,...Qe.varuint32(o)]}i32_store8(t,e,a,i){let o,n,r;return Array.isArray(e)?(o=0,n=0,r=e):Array.isArray(a)?(o=e,n=0,r=a):Array.isArray(i)&&(o=e,n=a,r=i),[...t,...r,58,n,...Qe.varuint32(o)]}call(t,...e){const a=this.module.functionIdxByName[t];if(void 0===a)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...e),16,...Qe.varuint32(a)]}call_indirect(t,...e){return[...[].concat(...e),...t,17,0,0]}if(t,e,a){return a?[...t,4,64,...e,5,...a,11]:[...t,4,64,...e,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,e){return[...e,13,...Qe.varuint32(t)]}br(t){return[12,...Qe.varuint32(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...Qe.varint64(t)]}i32_const(t){return[65,...Qe.varint32(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,e){return[...t,...e,81]}i64_ne(t,e){return[...t,...e,82]}i64_lt_s(t,e){return[...t,...e,83]}i64_lt_u(t,e){return[...t,...e,84]}i64_gt_s(t,e){return[...t,...e,85]}i64_gt_u(t,e){return[...t,...e,86]}i64_le_s(t,e){return[...t,...e,87]}i64_le_u(t,e){return[...t,...e,88]}i64_ge_s(t,e){return[...t,...e,89]}i64_ge_u(t,e){return[...t,...e,90]}i64_add(t,e){return[...t,...e,124]}i64_sub(t,e){return[...t,...e,125]}i64_mul(t,e){return[...t,...e,126]}i64_div_s(t,e){return[...t,...e,127]}i64_div_u(t,e){return[...t,...e,128]}i64_rem_s(t,e){return[...t,...e,129]}i64_rem_u(t,e){return[...t,...e,130]}i64_and(t,e){return[...t,...e,131]}i64_or(t,e){return[...t,...e,132]}i64_xor(t,e){return[...t,...e,133]}i64_shl(t,e){return[...t,...e,134]}i64_shr_s(t,e){return[...t,...e,135]}i64_shr_u(t,e){return[...t,...e,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,e){return[...t,...e,70]}i32_ne(t,e){return[...t,...e,71]}i32_lt_s(t,e){return[...t,...e,72]}i32_lt_u(t,e){return[...t,...e,73]}i32_gt_s(t,e){return[...t,...e,74]}i32_gt_u(t,e){return[...t,...e,75]}i32_le_s(t,e){return[...t,...e,76]}i32_le_u(t,e){return[...t,...e,77]}i32_ge_s(t,e){return[...t,...e,78]}i32_ge_u(t,e){return[...t,...e,79]}i32_add(t,e){return[...t,...e,106]}i32_sub(t,e){return[...t,...e,107]}i32_mul(t,e){return[...t,...e,108]}i32_div_s(t,e){return[...t,...e,109]}i32_div_u(t,e){return[...t,...e,110]}i32_rem_s(t,e){return[...t,...e,111]}i32_rem_u(t,e){return[...t,...e,112]}i32_and(t,e){return[...t,...e,113]}i32_or(t,e){return[...t,...e,114]}i32_xor(t,e){return[...t,...e,115]}i32_shl(t,e){return[...t,...e,116]}i32_shr_s(t,e){return[...t,...e,117]}i32_shr_u(t,e){return[...t,...e,118]}i32_rotl(t,e){return[...t,...e,119]}i32_rotr(t,e){return[...t,...e,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}};const ke={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};var Te=class{constructor(t,e,a,i,o){if("import"==a)this.fnType="import",this.moduleName=i,this.fieldName=o;else{if("internal"!=a)throw new Error("Invalid function fnType: "+a);this.fnType="internal"}this.module=t,this.fnName=e,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,e){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);const a=this.nextLocal++;this.localIdxByName[t]=a,this.params.push({type:e})}addLocal(t,e,a){const i=a||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);const o=this.nextLocal++;this.localIdxByName[t]=o,this.locals.push({type:e,length:i})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){return[96,...[...Qe.varuint32(this.params.length),...this.params.map((t=>ke[t.type]))],...this.returnType?[1,ke[this.returnType]]:[0]]}getBody(){const t=this.locals.map((t=>[...Qe.varuint32(t.length),ke[t.type]])),e=[...Qe.varuint32(this.locals.length),...[].concat(...t),...this.code,11];return[...Qe.varuint32(e.length),...e]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new Me(this)}};var Re=class{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Qe.u32(1836278016),...Qe.u32(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);const e=this.functions.length;return this.functionIdxByName[t]=e,this.functions.push(new Te(this,t,"internal")),this.nInternalFunctions++,this.functions[e]}addIimportFunction(t,e,a){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&"internal"==this.functions[this.functions.length-1].type)throw new Error(`Import functions must be declared before internal: ${t}`);let i=a||t;const o=this.functions.length;return this.functionIdxByName[t]=o,this.functions.push(new Te(this,t,"import",e,i)),this.nImportFunctions++,this.functions[o]}setMemory(t,e,a){this.memory={pagesSize:t,moduleName:e||"env",fieldName:a||"memory"}}exportFunction(t,e){const a=e||t;if(void 0===this.functionIdxByName[t])throw new Error(`Function not defined: ${t}`);const i=this.functionIdxByName[t];a!=t&&(this.functionIdxByName[a]=i),this.exports.push({exportName:a,idx:i})}addFunctionToTable(t){const e=this.functionIdxByName[t];this.functionsTable.push(e)}addData(t,e){this.datas.push({offset:t,bytes:e})}alloc(t,e){let a,i;(Array.isArray(t)||ArrayBuffer.isView(t))&&void 0===e?(a=t.length,i=t):(a=t,i=e),a=1+(a-1>>3)<<3;const o=this.free;return this.free+=a,i&&this.addData(o,i),o}allocString(t){const e=(new globalThis.TextEncoder).encode(t);return this.alloc([...e,0])}_setSignatures(){this.signatures=[];const t={};if(this.functionsTable.length>0){const e=this.functions[this.functionsTable[0]].getSignature();t["s_"+Qe.toHexString(e)]=0,this.signatures.push(e)}for(let e=0;e<this.functions.length;e++){const a=this.functions[e].getSignature(),i="s_"+Qe.toHexString(a);void 0===t[i]&&(t[i]=this.signatures.length,this.signatures.push(a)),this.functions[e].signatureIdx=t[i]}}_buildSection(t,e){return[t,...Qe.varuint32(e.length),...e]}_buildType(){return this._buildSection(1,[...Qe.varuint32(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const t=[];t.push([...Qe.string(this.memory.moduleName),...Qe.string(this.memory.fieldName),2,0,...Qe.varuint32(this.memory.pagesSize)]);for(let e=0;e<this.nImportFunctions;e++)t.push([...Qe.string(this.functions[e].moduleName),...Qe.string(this.functions[e].fieldName),0,...Qe.varuint32(this.functions[e].signatureIdx)]);return this._buildSection(2,Qe.varuint32(t.length).concat(...t))}_buildFunctionDeclarations(){const t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(...Qe.varuint32(this.functions[e].signatureIdx));return this._buildSection(3,[...Qe.varuint32(t.length),...t])}_buildFunctionsTable(){return 0==this.functionsTable.length?[]:this._buildSection(4,[...Qe.varuint32(1),112,0,...Qe.varuint32(this.functionsTable.length)])}_buildElements(){if(0==this.functionsTable.length)return[];const t=[];for(let e=0;e<this.functionsTable.length;e++)t.push(...Qe.varuint32(this.functionsTable[e]));return this._buildSection(9,[...Qe.varuint32(1),...Qe.varuint32(0),65,...Qe.varint32(0),11,...Qe.varuint32(this.functionsTable.length),...t])}_buildExports(){const t=[];for(let e=0;e<this.exports.length;e++)t.push([...Qe.string(this.exports[e].exportName),0,...Qe.varuint32(this.exports[e].idx)]);return this._buildSection(7,Qe.varuint32(t.length).concat(...t))}_buildCode(){const t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(this.functions[e].getBody());return this._buildSection(10,Qe.varuint32(t.length).concat(...t))}_buildData(){const t=[];t.push([0,65,0,11,4,...Qe.u32(this.free)]);for(let e=0;e<this.datas.length;e++)t.push([0,65,...Qe.varint32(this.datas[e].offset),11,...Qe.varuint32(this.datas[e].bytes.length),...this.datas[e].bytes]);return this._buildSection(11,Qe.varuint32(t.length).concat(...t))}},Ne=Re;async function De(t,e){const a=new Ne;a.setMemory(25),Vt(a),e&&e(a);const i={};if(i.code=a.build(),i.pq=a.modules.f1m.pq,i.pr=a.modules.frm.pq,i.pG1gen=a.modules.bn128.pG1gen,i.pG1zero=a.modules.bn128.pG1zero,i.pG1b=a.modules.bn128.pG1b,i.pG2gen=a.modules.bn128.pG2gen,i.pG2zero=a.modules.bn128.pG2zero,i.pG2b=a.modules.bn128.pG2b,i.pOneT=a.modules.bn128.pOneT,i.prePSize=a.modules.bn128.prePSize,i.preQSize=a.modules.bn128.preQSize,i.n8q=32,i.n8r=32,i.q=a.modules.bn128.q,i.r=a.modules.bn128.r,!t&&globalThis.curve_bn128)return globalThis.curve_bn128;const o={name:"bn128",wasm:i,q:S("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:S("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:S("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},n=await Se(o);return n.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=n),n}async function Ke(t,e){const a=new Ne;a.setMemory(25),jt(a),e&&e(a);const i={};if(i.code=a.build(),i.pq=a.modules.f1m.pq,i.pr=a.modules.frm.pq,i.pG1gen=a.modules.bls12381.pG1gen,i.pG1zero=a.modules.bls12381.pG1zero,i.pG1b=a.modules.bls12381.pG1b,i.pG2gen=a.modules.bls12381.pG2gen,i.pG2zero=a.modules.bls12381.pG2zero,i.pG2b=a.modules.bls12381.pG2b,i.pOneT=a.modules.bls12381.pOneT,i.prePSize=a.modules.bls12381.prePSize,i.preQSize=a.modules.bls12381.preQSize,i.n8q=48,i.n8r=32,i.q=a.modules.bn128.q,i.r=a.modules.bn128.r,!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const o={name:"bls12381",wasm:i,q:S("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:S("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:S("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:S("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},n=await Se(o);return n.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=n),n}globalThis.curve_bn128=null,globalThis.curve_bls12381=null;const Ve=S("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),je=S("21888242871839275222246405745257275088548364400416034343698204186575808495617");S("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),S("21888242871839275222246405745257275088696311157297823662689037894645226208583");const He=gt,$e=ue;var Ze={};async function Ye(t,e,a,i){if(a=a||262144,["w+","wx+","r","ax+","a+"].indexOf(e)<0)throw new Error("Invalid open option");const o=await Ze.promises.open(t,e),n=await o.stat();return new Je(o,n,a,i,t)}class Je{constructor(t,e,a,i,o){for(this.fileName=o,this.fd=t,this.pos=0,this.pageSize=i||256;this.pageSize<e.blksize;)this.pageSize*=2;this.totalSize=e.size,this.totalPages=Math.floor((e.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(a/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){const e=this,a=new Promise(((a,i)=>{e.pendingLoads.push({page:t,resolve:a,reject:i})}));return e.__statusPage("After Load request: ",t),a}__statusPage(t,e){const a=[],i=this;if(!i.logHistory)return;a.push("=="+t+" "+e);let o="";for(let t=0;t<i.pendingLoads.length;t++)i.pendingLoads[t].page==e&&(o=o+" "+t);if(o&&a.push("Pending loads:"+o),void 0!==i.pages[e]){const t=i.pages[e];a.push("Loaded"),a.push("pendingOps: "+t.pendingOps),t.loading&&a.push("loading: "+t.loading),t.writing&&a.push("writing"),t.dirty&&a.push("dirty")}a.push("=="),i.history[e]||(i.history[e]=[]),i.history[e].push(a)}__printHistory(t){const e=this;e.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let a=0;a<e.history[t].length;a++)for(let i=0;i<e.history[t][a].length;i++)console.log("-> "+e.history[t][a][i])}_triggerLoad(){const t=this;if(t.reading)return;if(0==t.pendingLoads.length)return;const e=Object.keys(t.pages),a=[];for(let i=0;i<e.length;i++){const o=t.pages[parseInt(e[i])];0!=o.dirty||0!=o.pendingOps||o.writing||o.loading||a.push(parseInt(e[i]))}let i=t.maxPagesLoaded-e.length;const o=[];for(;t.pendingLoads.length>0&&(void 0!==t.pages[t.pendingLoads[0].page]||i>0||a.length>0);){const e=t.pendingLoads.shift();if(void 0!==t.pages[e.page]){t.pages[e.page].pendingOps++;const i=a.indexOf(e.page);i>=0&&a.splice(i,1),t.pages[e.page].loading?t.pages[e.page].loading.push(e):e.resolve(),t.__statusPage("After Load (cached): ",e.page)}else{if(i)i--;else{const e=a.shift();t.__statusPage("Before Unload: ",e),t.avBuffs.unshift(t.pages[e]),delete t.pages[e],t.__statusPage("After Unload: ",e)}e.page>=t.totalPages?(t.pages[e.page]=n(),e.resolve(),t.__statusPage("After Load (new): ",e.page)):(t.reading=!0,t.pages[e.page]=n(),t.pages[e.page].loading=[e],o.push(t.fd.read(t.pages[e.page].buff,0,t.pageSize,e.page*t.pageSize).then((a=>{t.pages[e.page].size=a.bytesRead;const i=t.pages[e.page].loading;delete t.pages[e.page].loading;for(let t=0;t<i.length;t++)i[t].resolve();return t.__statusPage("After Load (loaded): ",e.page),a}),(t=>{e.reject(t)}))),t.__statusPage("After Load (loading): ",e.page))}}function n(){if(t.avBuffs.length>0){const e=t.avBuffs.shift();return e.dirty=!1,e.pendingOps=1,e.size=0,e}return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}Promise.all(o).then((()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()}))}_triggerWrite(){const t=this;if(t.writing)return;const e=Object.keys(t.pages),a=[];for(let i=0;i<e.length;i++){const o=t.pages[parseInt(e[i])];o.dirty&&(o.dirty=!1,o.writing=!0,t.writing=!0,a.push(t.fd.write(o.buff,0,o.size,parseInt(e[i])*t.pageSize).then((()=>{o.writing=!1}),(e=>{console.log("ERROR Writing: "+e),t.error=e,t._tryClose()}))))}t.writing&&Promise.all(a).then((()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))}))}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,e){if(0==t.byteLength)return;const a=this;if(void 0===e&&(e=a.pos),a.pos=e+t.byteLength,a.totalSize<e+t.byteLength&&(a.totalSize=e+t.byteLength),a.pendingClose)throw new Error("Writing a closing file");const i=Math.floor(e/a.pageSize),o=Math.floor((e+t.byteLength-1)/a.pageSize),n=[];for(let t=i;t<=o;t++)n.push(a._loadPage(t));a._triggerLoad();let r=i,l=e%a.pageSize,c=t.byteLength;for(;c>0;){await n[r-i];const e=l+c>a.pageSize?a.pageSize-l:c,o=t.slice(t.byteLength-c,t.byteLength-c+e);new Uint8Array(a.pages[r].buff.buffer,l,e).set(o),a.pages[r].dirty=!0,a.pages[r].pendingOps--,a.pages[r].size=Math.max(l+e,a.pages[r].size),r>=a.totalPages&&(a.totalPages=r+1),c-=e,r++,l=0,a.writing||setImmediate(a._triggerWrite.bind(a))}}async read(t,e){let a=new Uint8Array(t);return await this.readToBuffer(a,0,t,e),a}async readToBuffer(t,e,a,i){if(0==a)return;const o=this;if(a>o.pageSize*o.maxPagesLoaded*.8){const t=Math.floor(1.1*a);this.maxPagesLoaded=Math.floor(t/o.pageSize)+1}if(void 0===i&&(i=o.pos),o.pos=i+a,o.pendingClose)throw new Error("Reading a closing file");const n=Math.floor(i/o.pageSize),r=Math.floor((i+a-1)/o.pageSize),l=[];for(let t=n;t<=r;t++)l.push(o._loadPage(t));o._triggerLoad();let c=n,s=i%o.pageSize,d=i+a>o.totalSize?a-(i+a-o.totalSize):a;for(;d>0;){await l[c-n],o.__statusPage("After Await (read): ",c);const i=s+d>o.pageSize?o.pageSize-s:d,r=new Uint8Array(o.pages[c].buff.buffer,o.pages[c].buff.byteOffset+s,i);t.set(r,e+a-d),o.pages[c].pendingOps--,o.__statusPage("After Op done: ",c),d-=i,c++,s=0,o.pendingLoads.length>0&&setImmediate(o._triggerLoad.bind(o))}this.pos=i+a}_tryClose(){const t=this;if(!t.pendingClose)return;t.error&&t.pendingCloseReject(t.error);t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0||t.pendingClose()}close(){const t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise(((e,a)=>{t.pendingClose=e,t.pendingCloseReject=a,t._tryClose()})).then((()=>{t.fd.close()}),(e=>{throw t.fd.close(),e}))}async discard(){await this.close(),await Ze.promises.unlink(this.fileName)}async writeULE32(t,e){const a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,t,!0),await this.write(a,e)}async writeUBE32(t,e){const a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,t,!1),await this.write(a,e)}async writeULE64(t,e){const a=new Uint8Array(8),i=new DataView(a.buffer);i.setUint32(0,4294967295&t,!0),i.setUint32(4,Math.floor(t/4294967296),!0),await this.write(a,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),a=new Uint32Array(e.buffer);return 4294967296*a[1]+a[0]}}const We=new Uint8Array(4),Xe=new DataView(We.buffer),ta=new Uint8Array(8),ea=new DataView(ta.buffer);class aa{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){const e=Math.max(this.allocSize+(1<<20),Math.floor(1.1*this.allocSize),t),a=new Uint8Array(e);a.set(this.o.data),this.o.data=a,this.allocSize=e}}async write(t,e){if(void 0===e&&(e=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength),this.o.data.set(t.slice(),e),e+t.byteLength>this.totalSize&&(this.totalSize=e+t.byteLength),this.pos=e+t.byteLength}async readToBuffer(t,e,a,i){if(void 0===i&&(i=this.pos),this.readOnly&&i+a>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(i+a);const o=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+i,a);t.set(o,e),this.pos=i+a}async read(t,e){const a=new Uint8Array(t);return await this.readToBuffer(a,0,t,e),a}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,e){Xe.setUint32(0,t,!0),await this.write(We,e)}async writeUBE32(t,e){Xe.setUint32(0,t,!1),await this.write(We,e)}async writeULE64(t,e){ea.setUint32(0,4294967295&t,!0),ea.setUint32(4,Math.floor(t/4294967296),!0),await this.write(ta,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),a=new Uint32Array(e.buffer);return 4294967296*a[1]+a[0]}}const ia=1<<22;const oa=new Uint8Array(4),na=new DataView(oa.buffer),ra=new Uint8Array(8),la=new DataView(ra.buffer);class ca{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const e=Math.floor((t-1)/ia)+1;for(let a=Math.max(this.o.data.length-1,0);a<e;a++){const i=new Uint8Array(a<e-1?ia:t-(e-1)*ia);a==this.o.data.length-1&&i.set(this.o.data[a]),this.o.data[a]=i}this.totalSize=t}async write(t,e){const a=this;if(void 0===e&&(e=a.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength);let i=Math.floor(e/ia),o=e%ia,n=t.byteLength;for(;n>0;){const e=o+n>ia?ia-o:n,r=t.slice(t.byteLength-n,t.byteLength-n+e);new Uint8Array(a.o.data[i].buffer,o,e).set(r),n-=e,i++,o=0}this.pos=e+t.byteLength}async readToBuffer(t,e,a,i){const o=this;if(void 0===i&&(i=o.pos),this.readOnly&&i+a>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(i+a);let n=Math.floor(i/ia),r=i%ia,l=a;for(;l>0;){const i=r+l>ia?ia-r:l,c=new Uint8Array(o.o.data[n].buffer,r,i);t.set(c,e+a-l),l-=i,n++,r=0}this.pos=i+a}async read(t,e){const a=new Uint8Array(t);return await this.readToBuffer(a,0,t,e),a}close(){}async discard(){}async writeULE32(t,e){na.setUint32(0,t,!0),await this.write(oa,e)}async writeUBE32(t,e){na.setUint32(0,t,!1),await this.write(oa,e)}async writeULE64(t,e){la.setUint32(0,4294967295&t,!0),la.setUint32(4,Math.floor(t/4294967296),!0),await this.write(ra,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),a=new Uint32Array(e.buffer);return 4294967296*a[1]+a[0]}}async function sa(t,e,a){if("string"==typeof t&&(t={type:"file",fileName:t,cacheSize:e||65536,pageSize:a||8192}),"file"==t.type)return await Ye(t.fileName,"w+",t.cacheSize,t.pageSize);if("mem"==t.type)return function(t){const e=t.initialSize||1<<20,a=new aa;return a.o=t,a.o.data=new Uint8Array(e),a.allocSize=e,a.totalSize=0,a.readOnly=!1,a.pos=0,a}(t);if("bigMem"==t.type)return function(t){const e=t.initialSize||0,a=new ca;a.o=t;const i=e?Math.floor((e-1)/ia)+1:0;a.o.data=[];for(let t=0;t<i-1;t++)a.o.data.push(new Uint8Array(ia));return i&&a.o.data.push(new Uint8Array(e-ia*(i-1))),a.totalSize=0,a.readOnly=!1,a.pos=0,a}(t);throw new Error("Invalid FastFile type: "+t.type)}async function da(t,e,a){if(t instanceof Uint8Array&&(t={type:"mem",data:t}),"string"==typeof t){t={type:"mem",data:await fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return new Uint8Array(t)}))}}if("file"==t.type)return await Ye(t.fileName,"r",t.cacheSize,t.pageSize);if("mem"==t.type)return await function(t){const e=new aa;return e.o=t,e.allocSize=t.data.byteLength,e.totalSize=t.data.byteLength,e.readOnly=!0,e.pos=0,e}(t);if("bigMem"==t.type)return await function(t){const e=new ca;return e.o=t,e.totalSize=(t.data.length-1)*ia+t.data[t.data.length-1].byteLength,e.readOnly=!0,e.pos=0,e}(t);throw new Error("Invalid FastFile type: "+t.type)}async function ua(t,e,a,i,o){const n=await da(t),r=await n.read(4);let l="";for(let t=0;t<4;t++)l+=String.fromCharCode(r[t]);if(l!=e)throw new Error(t+": Invalid File format");if(await n.readULE32()>a)throw new Error("Version not supported");const c=await n.readULE32();let s=[];for(let t=0;t<c;t++){let t=await n.readULE32(),e=await n.readULE64();void 0===s[t]&&(s[t]=[]),s[t].push({p:n.pos,size:e}),n.pos+=e}return{fd:n,sections:s}}async function ga(t,e,a,i,o,n){const r=await sa(t,o,n),l=new Uint8Array(4);for(let t=0;t<4;t++)l[t]=e.charCodeAt(t);return await r.write(l,0),await r.writeULE32(a),await r.writeULE32(i),r}async function fa(t,e){if(void 0!==t.writingSection)throw new Error("Already writing a section");await t.writeULE32(e),t.writingSection={pSectionSize:t.pos},await t.writeULE64(0)}async function _a(t){if(void 0===t.writingSection)throw new Error("Not writing a section");const e=t.pos-t.writingSection.pSectionSize-8,a=t.pos;t.pos=t.writingSection.pSectionSize,await t.writeULE64(e),t.pos=a,delete t.writingSection}async function pa(t,e,a){if(void 0!==t.readingSection)throw new Error("Already reading a section");if(!e[a])throw new Error(t.fileName+": Missing section "+a);if(e[a].length>1)throw new Error(t.fileName+": Section Duplicated "+a);t.pos=e[a][0].p,t.readingSection=e[a][0]}async function ha(t,e){if(void 0===t.readingSection)throw new Error("Not reading a section");if(!e&&t.pos-t.readingSection.p!=t.readingSection.size)throw new Error("Invalid section size reading");delete t.readingSection}async function ma(t,e,a,i){const o=new Uint8Array(a);He.toRprLE(o,0,e,a),await t.write(o,i)}async function La(t,e,a){const i=await t.read(e,a);return He.fromRprLE(i,0,e)}async function wa(t,e,a,i,o){void 0===o&&(o=e[i][0].size);const n=t.pageSize;await pa(t,e,i),await fa(a,i);for(let e=0;e<o;e+=n){const i=Math.min(o-e,n),r=await t.read(i);await a.write(r)}await _a(a),await ha(t,o!=e[i][0].size)}async function Aa(t,e,a,i,o){if((i=void 0===i?0:i)+(o=void 0===o?e[a][0].size-i:o)>e[a][0].size)throw new Error("Reading out of the range of the section");let n;return n=o<1<<30?new Uint8Array(o):new fe(o),await t.readToBuffer(n,0,o,e[a][0].p+i),n}async function ba(t,e,a,i,o){const n=16*t.pageSize;if(await pa(t,e,o),await pa(a,i,o),e[o][0].size!=i[o][0].size)return!1;const r=e[o][0].size;for(let e=0;e<r;e+=n){const i=Math.min(r-e,n),o=await t.read(i),l=await a.read(i);for(let t=0;t<i;t++)if(o[t]!=l[t])return!1}return await ha(t),await ha(a),!0}He.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),He.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const ya=He.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),Ia=He.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function Ca(t){let e;if(He.eq(t,Ia))e=await De();else{if(!He.eq(t,ya))throw new Error(`Curve not supported: ${He.toString(t)}`);e=await Ke()}return e}async function Fa(t){let e;const a=t.toUpperCase().match(/[A-Za-z0-9]+/g).join("");if(["BN128","BN254","ALTBN128"].indexOf(a)>=0)e=await De();else{if(!(["BLS12381"].indexOf(a)>=0))throw new Error(`Curve not supported: ${t}`);e=await Ke()}return e}var xa=function t(e,a){if(!e){var i=new va(a);throw Error.captureStackTrace&&Error.captureStackTrace(i,t),i}};class va extends Error{}function Ea(t){return t.length}va.prototype.name="AssertionError";var Ba={byteLength:Ea,toString:function(t){const e=t.byteLength;let a="";for(let i=0;i<e;i++)a+=String.fromCharCode(t[i]);return a},write:function(t,e,a=0,i=Ea(e)){const o=Math.min(i,t.byteLength-a);for(let i=0;i<o;i++)t[a+i]=e.charCodeAt(i);return o}};const Sa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ga=new Uint8Array(256);for(let t=0;t<Sa.length;t++)Ga[Sa.charCodeAt(t)]=t;function Pa(t){let e=t.length;return 61===t.charCodeAt(e-1)&&e--,e>1&&61===t.charCodeAt(e-1)&&e--,3*e>>>2}Ga[45]=62,Ga[95]=63;var Oa={byteLength:Pa,toString:function(t){const e=t.byteLength;let a="";for(let i=0;i<e;i+=3)a+=Sa[t[i]>>2]+Sa[(3&t[i])<<4|t[i+1]>>4]+Sa[(15&t[i+1])<<2|t[i+2]>>6]+Sa[63&t[i+2]];return e%3==2?a=a.substring(0,a.length-1)+"=":e%3==1&&(a=a.substring(0,a.length-2)+"=="),a},write:function(t,e,a=0,i=Pa(e)){const o=Math.min(i,t.byteLength-a);for(let a=0,i=0;a<o;a+=4){const o=Ga[e.charCodeAt(a)],n=Ga[e.charCodeAt(a+1)],r=Ga[e.charCodeAt(a+2)],l=Ga[e.charCodeAt(a+3)];t[i++]=o<<2|n>>4,t[i++]=(15&n)<<4|r>>2,t[i++]=(3&r)<<6|63&l}return o}};function Ua(t){return t.length>>>1}var za={byteLength:Ua,toString:function(t){const e=t.byteLength;t=new DataView(t.buffer,t.byteOffset,e);let a="",i=0;for(let o=e-e%4;i<o;i+=4)a+=t.getUint32(i).toString(16).padStart(8,"0");for(;i<e;i++)a+=t.getUint8(i).toString(16).padStart(2,"0");return a},write:function(t,e,a=0,i=Ua(e)){const o=Math.min(i,t.byteLength-a);for(let i=0;i<o;i++){const o=qa(e.charCodeAt(2*i)),n=qa(e.charCodeAt(2*i+1));if(void 0===o||void 0===n)return t.subarray(0,i);t[a+i]=o<<4|n}return o}};function qa(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:void 0}function Qa(t){let e=0;for(let a=0,i=t.length;a<i;a++){const o=t.charCodeAt(a);if(o>=55296&&o<=56319&&a+1<i){const i=t.charCodeAt(a+1);if(i>=56320&&i<=57343){e+=4,a++;continue}}e+=o<=127?1:o<=2047?2:3}return e}let Ma,ka;if("undefined"!=typeof TextDecoder){const t=new TextDecoder;Ma=function(e){return t.decode(e)}}else Ma=function(t){const e=t.byteLength;let a="",i=0;for(;i<e;){let o=t[i];if(o<=127){a+=String.fromCharCode(o),i++;continue}let n=0,r=0;if(o<=223?(n=1,r=31&o):o<=239?(n=2,r=15&o):o<=244&&(n=3,r=7&o),e-i-n>0){let e=0;for(;e<n;)o=t[i+e+1],r=r<<6|63&o,e+=1}else r=65533,n=e-i;a+=String.fromCodePoint(r),i+=n+1}return a};if("undefined"!=typeof TextEncoder){const t=new TextEncoder;ka=function(e,a,i=0,o=Qa(a)){const n=Math.min(o,e.byteLength-i);return t.encodeInto(a,e.subarray(i,i+n)),n}}else ka=function(t,e,a=0,i=Qa(e)){const o=Math.min(i,t.byteLength-a);t=t.subarray(a,a+o);let n=0,r=0;for(;n<e.length;){const a=e.codePointAt(n);if(a<=127){t[r++]=a,n++;continue}let i=0,o=0;for(a<=2047?(i=6,o=192):a<=65535?(i=12,o=224):a<=2097151&&(i=18,o=240),t[r++]=o|a>>i,i-=6;i>=0;)t[r++]=128|a>>i&63,i-=6;n+=a>=65536?2:1}return o};var Ta={byteLength:Qa,toString:Ma,write:ka};function Ra(t){return 2*t.length}var Na={byteLength:Ra,toString:function(t){const e=t.byteLength;let a="";for(let i=0;i<e-1;i+=2)a+=String.fromCharCode(t[i]+256*t[i+1]);return a},write:function(t,e,a=0,i=Ra(e)){const o=Math.min(i,t.byteLength-a);let n=o;for(let i=0;i<e.length&&!((n-=2)<0);++i){const o=e.charCodeAt(i),n=o>>8,r=o%256;t[a+2*i]=r,t[a+2*i+1]=n}return o}};function Da(t){switch(t){case"ascii":return Ba;case"base64":return Oa;case"hex":return za;case"utf8":case"utf-8":case void 0:return Ta;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Na;default:throw new Error(`Unknown encoding: ${t}`)}}function Ka(t){return t instanceof Uint8Array}function Va(t,e,a){return"string"==typeof t?function(t,e){const a=Da(e),i=new Uint8Array(a.byteLength(t));return a.write(i,t,0,i.byteLength),i}(t,e):Array.isArray(t)?function(t){const e=new Uint8Array(t.length);return e.set(t),e}(t):ArrayBuffer.isView(t)?function(t){const e=new Uint8Array(t.byteLength);return e.set(t),e}(t):function(t,e,a){return new Uint8Array(t,e,a)}(t,e,a)}function ja(t,e,a){const i=t[e];t[e]=t[a],t[a]=i}var Ha={isBuffer:Ka,alloc:function(t,e,a){const i=new Uint8Array(t);return void 0!==e&&e(i,e,0,i.byteLength,a),i},allocUnsafe:function(t){return new Uint8Array(t)},allocUnsafeSlow:function(t){return new Uint8Array(t)},byteLength:function(t,e){return Da(e).byteLength(t)},compare:function(t,e){if(t===e)return 0;const a=Math.min(t.byteLength,e.byteLength);t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let i=0;for(let o=a-a%4;i<o;i+=4){const a=t.getUint32(i),o=e.getUint32(i);if(a<o)return-1;if(a>o)return 1}for(;i<a;i++){const a=t.getUint8(i),o=e.getUint8(i);if(a<o)return-1;if(a>o)return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0},concat:function(t,e){void 0===e&&(e=t.reduce(((t,e)=>t+e.byteLength),0));const a=new Uint8Array(e);return t.reduce(((t,e)=>(a.set(e,t),t+e.byteLength)),0),a},copy:function(t,e,a=0,i=0,o=t.byteLength){if(o>0&&o<i)return 0;if(o===i)return 0;if(0===t.byteLength||0===e.byteLength)return 0;if(a<0)throw new RangeError("targetStart is out of range");if(i<0||i>=t.byteLength)throw new RangeError("sourceStart is out of range");if(o<0)throw new RangeError("sourceEnd is out of range");a>=e.byteLength&&(a=e.byteLength),o>t.byteLength&&(o=t.byteLength),e.byteLength-a<o-i&&(o=e.length-a+i);const n=o-i;return t===e?e.copyWithin(a,i,o):e.set(t.subarray(i,o),a),n},equals:function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;const a=t.byteLength;t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let i=0;for(let o=a-a%4;i<o;i+=4)if(t.getUint32(i)!==e.getUint32(i))return!1;for(;i<a;i++)if(t.getUint8(i)!==e.getUint8(i))return!1;return!0},fill:function(t,e,a,i,o){if("string"==typeof e?"string"==typeof a?(o=a,a=0,i=t.byteLength):"string"==typeof i&&(o=i,i=t.byteLength):"number"==typeof val?e&=255:"boolean"==typeof val&&(e=+e),a<0||t.byteLength<a||t.byteLength<i)throw new RangeError("Out of range index");if(void 0===a&&(a=0),void 0===i&&(i=t.byteLength),i<=a)return t;if(e||(e=0),"number"==typeof e)for(let o=a;o<i;++o)t[o]=e;else{const n=(e=Ka(e)?e:Va(e,o)).byteLength;for(let o=0;o<i-a;++o)t[o+a]=e[o%n]}return t},from:Va,swap16:function(t){const e=t.byteLength;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let a=0;a<e;a+=2)ja(t,a,a+1);return t},swap32:function(t){const e=t.byteLength;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let a=0;a<e;a+=4)ja(t,a,a+3),ja(t,a+1,a+2);return t},swap64:function(t){const e=t.byteLength;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let a=0;a<e;a+=8)ja(t,a,a+7),ja(t,a+1,a+6),ja(t,a+2,a+5),ja(t,a+3,a+4);return t},toBuffer:function(t){return t},toString:function(t,e,a=0,i=t.byteLength){const o=t.byteLength;return a>=o||i<=a?"":(a<0&&(a=0),i>o&&(i=o),(0!==a||i<o)&&(t=t.subarray(a,i)),Da(e).toString(t))},write:function(t,e,a,i,o){return void 0===a?o="utf8":void 0===i&&"string"==typeof a?(o=a,a=void 0):void 0===o&&"string"==typeof i&&(o=i,i=void 0),Da(o).write(t,e,a,i)}},$a=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var a=e.length,i=new Uint8Array(3*(a-("="==e[a-1])-("="==e[a-2]))/4|0),o=0,n=0;o<a;){var r=t[e.charCodeAt(o++)],l=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],s=t[e.charCodeAt(o++)];i[n++]=r<<2|l>>4,i[n++]=l<<4|c>>2,i[n++]=c<<6|s}return i}})(),Za=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./blake2b.wat"(t,e){e.exports=$a("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}}),Ya=Za(),Ja=WebAssembly.compile(Ya),Wa=d((function(t){var e=null,a="undefined"!=typeof WebAssembly&&(async t=>(await WebAssembly.instantiate(await Ja,t)).exports)().then((t=>{e=t})),i=64,o=[];t.exports=u;var n=t.exports.BYTES_MIN=16,r=t.exports.BYTES_MAX=64;t.exports.BYTES=32;var l=t.exports.KEYBYTES_MIN=16,c=t.exports.KEYBYTES_MAX=64;t.exports.KEYBYTES=32;var s=t.exports.SALTBYTES=16,d=t.exports.PERSONALBYTES=16;function u(t,a,g,f,_){if(!(this instanceof u))return new u(t,a,g,f,_);if(!e)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");t||(t=32),!0!==_&&(xa(t>=n,"digestLength must be at least "+n+", was given "+t),xa(t<=r,"digestLength must be at most "+r+", was given "+t),null!=a&&(xa(a instanceof Uint8Array,"key must be Uint8Array or Buffer"),xa(a.length>=l,"key must be at least "+l+", was given "+a.length),xa(a.length<=c,"key must be at least "+c+", was given "+a.length)),null!=g&&(xa(g instanceof Uint8Array,"salt must be Uint8Array or Buffer"),xa(g.length===s,"salt must be exactly "+s+", was given "+g.length)),null!=f&&(xa(f instanceof Uint8Array,"personal must be Uint8Array or Buffer"),xa(f.length===d,"personal must be exactly "+d+", was given "+f.length))),o.length||(o.push(i),i+=216),this.digestLength=t,this.finalized=!1,this.pointer=o.pop(),this._memory=new Uint8Array(e.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=a?a.length:0,this._memory[2]=1,this._memory[3]=1,g&&this._memory.set(g,32),f&&this._memory.set(f,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),e.blake2b_init(this.pointer,this.digestLength),a&&(this.update(a),this._memory.fill(0,i,i+a.length),this._memory[this.pointer+200]=128)}function g(){}u.prototype._realloc=function(t){e.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(e.memory.buffer)},u.prototype.update=function(t){return xa(!1===this.finalized,"Hash instance finalized"),xa(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),i+t.length>this._memory.length&&this._realloc(i+t.length),this._memory.set(t,i),e.blake2b_update(this.pointer,i,i+t.length),this},u.prototype.digest=function(t){if(xa(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,o.push(this.pointer),e.blake2b_final(this.pointer),!t||"binary"===t)return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if("string"==typeof t)return Ha.toString(this._memory,t,this.pointer+128,this.pointer+128+this.digestLength);xa(t instanceof Uint8Array&&t.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var a=0;a<this.digestLength;a++)t[a]=this._memory[this.pointer+128+a];return t},u.prototype.final=u.prototype.digest,u.WASM=e,u.SUPPORTED="undefined"!=typeof WebAssembly,u.ready=function(t){return t||(t=g),a?a.then((()=>t()),t):t(new Error("WebAssembly not supported"))},u.prototype.ready=u.ready,u.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},u.prototype.setPartialHash=function(t){this._memory.set(t,this.pointer)}}));const Xa=[];for(let t=0;t<256;t++)Xa[t]=ti(t,8);function ti(t,e){let a=0,i=t;for(let t=0;t<e;t++)a<<=1,a|=1&i,i>>=1;return a}function ei(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function ai(t,e){const a=new DataView(t.buffer,t.byteOffset,t.byteLength);let i="";for(let t=0;t<4;t++){t>0&&(i+="\\n"),i+="\\t\\t";for(let e=0;e<4;e++)e>0&&(i+=" "),i+=a.getUint32(16*t+4*e).toString(16).padStart(8,"0")}return e&&(i=e+"\\n"+i),i}function ii(t,e){if(t.byteLength!=e.byteLength)return!1;for(var a=new Int8Array(t),i=new Int8Array(e),o=0;o!=t.byteLength;o++)if(a[o]!=i[o])return!1;return!0}function oi(t){const e=t.getPartialHash(),a=Wa(64);return a.setPartialHash(e),a}async function ni(t,e,a,i,o){if(t.G1.isZero(e))return!1;if(t.G1.isZero(a))return!1;if(t.G2.isZero(i))return!1;if(t.G2.isZero(o))return!1;return await t.pairingEq(e,o,t.G1.neg(a),i)}async function ri(t){for(;!t;)t=await window.prompt("Enter a random text. (Entropy): ","");const e=Wa(64);e.update(wt.randomBytes(64));const a=new TextEncoder;e.update(a.encode(t));const i=Buffer.from(e.digest()),o=[];for(let t=0;t<8;t++)o[t]=i.readUInt32BE(4*t);return new Lt(o)}function li(t,e){let a,i;e<32?(a=1<<e>>>0,i=1):(a=4294967296,i=1<<e-32>>>0);let o=t;for(let t=0;t<i;t++)for(let t=0;t<a;t++)o=wt.createHash("sha256").update(o).digest();const n=new DataView(o.buffer,o.byteOffset,o.byteLength),r=[];for(let t=0;t<8;t++)r[t]=n.getUint32(4*t,!1);return new Lt(r)}function ci(t){return t instanceof Uint8Array?t:("0x"==t.slice(0,2)&&(t=t.slice(2)),new Uint8Array(t.match(/[\\da-f]{2}/gi).map((function(t){return parseInt(t,16)}))))}function si(t){return Array.prototype.map.call(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")}async function di(t,e){await fa(t,1),await t.writeULE32(1),await _a(t);const a=await Ca(e.q);await fa(t,2);const i=a.q,o=8*(Math.floor((He.bitLength(i)-1)/64)+1),n=a.r,r=8*(Math.floor((He.bitLength(n)-1)/64)+1);await t.writeULE32(o),await ma(t,i,o),await t.writeULE32(r),await ma(t,n,r),await t.writeULE32(e.nVars),await t.writeULE32(e.nPublic),await t.writeULE32(e.domainSize),await ui(t,a,e.vk_alpha_1),await ui(t,a,e.vk_beta_1),await gi(t,a,e.vk_beta_2),await gi(t,a,e.vk_gamma_2),await ui(t,a,e.vk_delta_1),await gi(t,a,e.vk_delta_2),await _a(t)}async function ui(t,e,a){const i=new Uint8Array(2*e.G1.F.n8);e.G1.toRprLEM(i,0,a),await t.write(i)}async function gi(t,e,a){const i=new Uint8Array(2*e.G2.F.n8);e.G2.toRprLEM(i,0,a),await t.write(i)}async function fi(t,e,a){const i=await t.read(2*e.G1.F.n8),o=e.G1.fromRprLEM(i,0);return a?e.G1.toObject(o):o}async function _i(t,e,a){const i=await t.read(2*e.G2.F.n8),o=e.G2.fromRprLEM(i,0);return a?e.G2.toObject(o):o}async function pi(t,e,a){await pa(t,e,1);const i=await t.readULE32();if(await ha(t),1==i)return await async function(t,e,a){const i={protocol:"groth16"};await pa(t,e,2);const o=await t.readULE32();i.n8q=o,i.q=await La(t,o);const n=await t.readULE32();i.n8r=n,i.r=await La(t,n);let r=await Ca(i.q);return i.nVars=await t.readULE32(),i.nPublic=await t.readULE32(),i.domainSize=await t.readULE32(),i.power=ei(i.domainSize),i.vk_alpha_1=await fi(t,r,a),i.vk_beta_1=await fi(t,r,a),i.vk_beta_2=await _i(t,r,a),i.vk_gamma_2=await _i(t,r,a),i.vk_delta_1=await fi(t,r,a),i.vk_delta_2=await _i(t,r,a),await ha(t),i}(t,e,a);if(2==i)return await async function(t,e,a,i){const o={protocol:"plonk"};await pa(t,e,2);const n=await t.readULE32();o.n8q=n,o.q=await La(t,n);const r=await t.readULE32();o.n8r=r,o.r=await La(t,r);let l=await Ca(o.q);return o.nVars=await t.readULE32(),o.nPublic=await t.readULE32(),o.domainSize=await t.readULE32(),o.power=ei(o.domainSize),o.nAdditions=await t.readULE32(),o.nConstrains=await t.readULE32(),o.k1=await t.read(r),o.k2=await t.read(r),o.Qm=await fi(t,l,i),o.Ql=await fi(t,l,i),o.Qr=await fi(t,l,i),o.Qo=await fi(t,l,i),o.Qc=await fi(t,l,i),o.S1=await fi(t,l,i),o.S2=await fi(t,l,i),o.S3=await fi(t,l,i),o.X_2=await _i(t,l,i),await ha(t),o}(t,e);throw new Error("Protocol not supported: ")}async function hi(t,e,a){const i={delta:{}};i.deltaAfter=await fi(t,e,a),i.delta.g1_s=await fi(t,e,a),i.delta.g1_sx=await fi(t,e,a),i.delta.g2_spx=await _i(t,e,a),i.transcript=await t.read(64),i.type=await t.readULE32();const o=await t.readULE32(),n=t.pos;let r=0;for(;t.pos-n<o;){const e=await t.read(1);if(e[0]<=r)throw new Error("Parameters in the contribution must be sorted");if(r=e[0],1==e[0]){const e=await t.read(1),a=await t.read(e[0]);i.name=(new TextDecoder).decode(a)}else if(2==e[0]){const e=await t.read(1);i.numIterationsExp=e[0]}else{if(3!=e[0])throw new Error("Parameter not recognized");{const e=await t.read(1);i.beaconHash=await t.read(e[0])}}}if(t.pos!=n+o)throw new Error("Parametes do not match");return i}async function mi(t,e,a){await pa(t,a,10);const i={contributions:[]};i.csHash=await t.read(64);const o=await t.readULE32();for(let a=0;a<o;a++){const a=await hi(t,e);i.contributions.push(a)}return await ha(t),i}async function Li(t,e,a){await ui(t,e,a.deltaAfter),await ui(t,e,a.delta.g1_s),await ui(t,e,a.delta.g1_sx),await gi(t,e,a.delta.g2_spx),await t.write(a.transcript),await t.writeULE32(a.type||0);const i=[];if(a.name){i.push(1);const t=new TextEncoder("utf-8").encode(a.name.substring(0,64));i.push(t.byteLength);for(let e=0;e<t.byteLength;e++)i.push(t[e])}if(1==a.type){i.push(2),i.push(a.numIterationsExp),i.push(3),i.push(a.beaconHash.byteLength);for(let t=0;t<a.beaconHash.byteLength;t++)i.push(a.beaconHash[t])}if(i.length>0){const e=new Uint8Array(i);await t.writeULE32(e.byteLength),await t.write(e)}else await t.writeULE32(0)}async function wi(t,e,a){await fa(t,10),await t.write(a.csHash),await t.writeULE32(a.contributions.length);for(let i=0;i<a.contributions.length;i++)await Li(t,e,a.contributions[i]);await _a(t)}function Ai(t,e,a){const i=new Uint8Array(2*e.G1.F.n8);e.G1.toRprUncompressed(i,0,a),t.update(i)}function bi(t,e,a){Ai(t,e,a.deltaAfter),Ai(t,e,a.delta.g1_s),Ai(t,e,a.delta.g1_sx),function(t,e,a){const i=new Uint8Array(2*e.G2.F.n8);e.G2.toRprUncompressed(i,0,a),t.update(i)}(t,e,a.delta.g2_spx),t.update(a.transcript)}async function yi(t,e){await pa(t,e,1);const a=await t.readULE32(),i=await La(t,a),o=await t.readULE32();return await ha(t),{n8:a,q:i,nWitness:o}}const{stringifyBigInts:Ii}=$e;async function Ci(t,e,a){const{fd:i,sections:o}=await ua(e,"wtns",2),n=await yi(i,o),{fd:r,sections:l}=await ua(t,"zkey",2),c=await pi(r,l);if("groth16"!=c.protocol)throw new Error("zkey file is not groth16");if(!He.eq(c.r,n.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(n.nWitness!=c.nVars)throw new Error(`Invalid witness length. Circuit: ${c.nVars}, witness: ${n.nWitness}`);const s=await Ca(c.q),d=s.Fr,u=s.G1,g=s.G2,f=ei(c.domainSize);a&&a.debug("Reading Wtns");const _=await Aa(i,o,2);a&&a.debug("Reading Coeffs");const p=await Aa(r,l,4);a&&a.debug("Building ABC");const[h,m,L]=await async function(t,e,a,i,o){const n=t.Fr.n8,r=12+e.n8r,l=(i.byteLength-4)/r,c=new fe(e.domainSize*n),s=new fe(e.domainSize*n),d=new fe(e.domainSize*n),u=[c,s];for(let e=0;e<l;e++){o&&e%1e6==0&&o.debug(`QAP AB: ${e}/${l}`);const c=i.slice(4+e*r,4+e*r+r),s=new DataView(c.buffer),d=s.getUint32(0,!0),g=s.getUint32(4,!0),f=s.getUint32(8,!0),_=c.slice(12,12+n);u[d].set(t.Fr.add(u[d].slice(g*n,g*n+n),t.Fr.mul(_,a.slice(f*n,f*n+n))),g*n)}for(let a=0;a<e.domainSize;a++)o&&a%1e6==0&&o.debug(`QAP C: ${a}/${e.domainSize}`),d.set(t.Fr.mul(c.slice(a*n,a*n+n),s.slice(a*n,a*n+n)),a*n);return[c,s,d]}(s,c,_,p,a),w=f==d.s?s.Fr.shift:s.Fr.w[f+1],A=await d.ifft(h,"","",a,"IFFT_A"),b=await d.batchApplyKey(A,d.e(1),w),y=await d.fft(b,"","",a,"FFT_A"),I=await d.ifft(m,"","",a,"IFFT_B"),C=await d.batchApplyKey(I,d.e(1),w),F=await d.fft(C,"","",a,"FFT_B"),x=await d.ifft(L,"","",a,"IFFT_C"),v=await d.batchApplyKey(x,d.e(1),w),E=await d.fft(v,"","",a,"FFT_C");a&&a.debug("Join ABC");const B=await async function(t,e,a,i,o,n){const r=1<<22,l=t.Fr.n8,c=Math.floor(a.byteLength/t.Fr.n8),s=[];for(let e=0;e<c;e+=r){n&&n.debug(`JoinABC: ${e}/${c}`);const d=Math.min(c-e,r),u=[],g=a.slice(e*l,(e+d)*l),f=i.slice(e*l,(e+d)*l),_=o.slice(e*l,(e+d)*l);u.push({cmd:"ALLOCSET",var:0,buff:g}),u.push({cmd:"ALLOCSET",var:1,buff:f}),u.push({cmd:"ALLOCSET",var:2,buff:_}),u.push({cmd:"ALLOC",var:3,len:d*l}),u.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:d},{var:3}]}),u.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:d},{var:3}]}),u.push({cmd:"GET",out:0,var:3,len:d*l}),s.push(t.tm.queueAction(u))}const d=await Promise.all(s);let u;u=a instanceof fe?new fe(a.byteLength):new Uint8Array(a.byteLength);let g=0;for(let t=0;t<d.length;t++)u.set(d[t][0],g),g+=d[t][0].byteLength;return u}(s,0,y,F,E,a);let S={};a&&a.debug("Reading A Points");const G=await Aa(r,l,5);S.pi_a=await s.G1.multiExpAffine(G,_,a,"multiexp A"),a&&a.debug("Reading B1 Points");const P=await Aa(r,l,6);let O=await s.G1.multiExpAffine(P,_,a,"multiexp B1");a&&a.debug("Reading B2 Points");const U=await Aa(r,l,7);S.pi_b=await s.G2.multiExpAffine(U,_,a,"multiexp B2"),a&&a.debug("Reading C Points");const z=await Aa(r,l,8);S.pi_c=await s.G1.multiExpAffine(z,_.slice((c.nPublic+1)*s.Fr.n8),a,"multiexp C"),a&&a.debug("Reading H Points");const q=await Aa(r,l,9),Q=await s.G1.multiExpAffine(q,B,a,"multiexp H"),M=s.Fr.random(),k=s.Fr.random();S.pi_a=u.add(S.pi_a,c.vk_alpha_1),S.pi_a=u.add(S.pi_a,u.timesFr(c.vk_delta_1,M)),S.pi_b=g.add(S.pi_b,c.vk_beta_2),S.pi_b=g.add(S.pi_b,g.timesFr(c.vk_delta_2,k)),O=u.add(O,c.vk_beta_1),O=u.add(O,u.timesFr(c.vk_delta_1,k)),S.pi_c=u.add(S.pi_c,Q),S.pi_c=u.add(S.pi_c,u.timesFr(S.pi_a,k)),S.pi_c=u.add(S.pi_c,u.timesFr(O,M)),S.pi_c=u.add(S.pi_c,u.timesFr(c.vk_delta_1,d.neg(d.mul(M,k))));let T=[];for(let t=1;t<=c.nPublic;t++){const e=_.slice(t*d.n8,t*d.n8+d.n8);T.push(He.fromRprLE(e))}return S.pi_a=u.toObject(u.toAffine(S.pi_a)),S.pi_b=g.toObject(g.toAffine(S.pi_b)),S.pi_c=u.toObject(u.toAffine(S.pi_c)),S.protocol="groth16",S.curve=s.name,await r.close(),await i.close(),S=Ii(S),T=Ii(T),{proof:S,publicSignals:T}}function Fi(t){var e=[];return function t(e,a){if(Array.isArray(a))for(let i=0;i<a.length;i++)t(e,a[i]);else e.push(a)}(e,t),e}function xi(t){const e=BigInt(2)**BigInt(64);let a=BigInt("0xCBF29CE484222325");for(var i=0;i<t.length;i++)a^=BigInt(t[i].charCodeAt()),a*=BigInt(1099511628211),a%=e;let o=a.toString(16),n=16-o.length;return o="0".repeat(n).concat(o),o}function vi(t,e){const a=[];let i=BigInt(t);const o=BigInt(4294967296);for(;i;)a.unshift(Number(i%o)),i/=o;if(e)for(var n=e-a.length;n>0;)a.unshift(0),n--;return a}async function Ei(t,e){e=e||{};let a,i=32767,o=!1;for(;!o;)try{a=new WebAssembly.Memory({initial:i}),o=!0}catch(t){if(1===i)throw t;console.warn("Could not allocate "+1024*i*64+" bytes. This may cause severe instability. Trying with "+1024*i*64/2+" bytes"),i=Math.floor(i/2)}const n=await WebAssembly.compile(t);let r;const l=await WebAssembly.instantiate(n,{env:{memory:a},runtime:{exceptionHandler:function(t){let e;throw e=1==t?"Signal not found. ":2==t?"Too many signals set. ":3==t?"Signal already set. ":4==t?"Assert Failed. ":5==t?"Not enough memory. ":"Unknown error.",console.log("ERROR: ",t,e),new Error(e)},showSharedRWMemory:function(){const t=l.exports.getFieldNumLen32(),e=new Uint32Array(t);for(let a=0;a<t;a++)e[t-1-a]=l.exports.readSharedRWMemory(a);console.log(He.fromArray(e,4294967296))},error:function(t,a,i,o,n,l){let c;throw c=7==t?s(a)+" "+r.getFr(o).toString()+" != "+r.getFr(n).toString()+" "+s(l):9==t?s(a)+" "+r.getFr(o).toString()+" "+s(n):5==t&&e.sym?s(a)+" "+e.sym.labelIdx2Name[n]:s(a)+" "+i+" "+o+" "+n+" "+l,console.log("ERROR: ",t,c),new Error(c)},log:function(t){console.log(r.getFr(t).toString())},logGetSignal:function(t,a){e.logGetSignal&&e.logGetSignal(t,r.getFr(a))},logSetSignal:function(t,a){e.logSetSignal&&e.logSetSignal(t,r.getFr(a))},logStartComponent:function(t){e.logStartComponent&&e.logStartComponent(t)},logFinishComponent:function(t){e.logFinishComponent&&e.logFinishComponent(t)}}}),c=e&&(e.sanityCheck||e.logGetSignal||e.logSetSignal||e.logStartComponent||e.logFinishComponent);return r="function"==typeof l.exports.getVersion?new Si(l,c):new Bi(a,l,c),r;function s(t){const e=new Uint8Array(a.buffer),i=[];for(let a=0;e[t+a]>0;a++)i.push(e[t+a]);return String.fromCharCode.apply(null,i)}}class Bi{constructor(t,e,a){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=e,this.n32=(this.instance.exports.getFrLen()>>2)-2;const i=this.instance.exports.getPRawPrime(),o=new Array(this.n32);for(let t=0;t<this.n32;t++)o[this.n32-1-t]=this.i32[(i>>2)+t];this.prime=He.fromArray(o,4294967296),this.Fr=new vt(this.prime),this.mask32=He.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(He.shiftLeft(1,64*this.n64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=a}circom_version(){return 1}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);const a=this.allocInt(),i=this.allocFr();Object.keys(t).forEach((e=>{const o=xi(e),n=parseInt(o.slice(0,8),16),r=parseInt(o.slice(8,16),16);try{this.instance.exports.getSignalOffset32(a,0,n,r)}catch(t){throw new Error(`Signal ${e} is not an input of the circuit.`)}const l=this.getInt(a),c=Fi(t[e]);for(let t=0;t<c.length;t++)this.setFr(i,c[t]),this.instance.exports.setSignal(0,0,l+t,i)}))}async calculateWitness(t,e){const a=this,i=a.i32[0],o=[];await a._doCalculateWitness(t,e);for(let t=0;t<a.NVars;t++){const e=a.instance.exports.getPWitness(t);o.push(a.getFr(e))}return a.i32[0]=i,o}async calculateBinWitness(t,e){const a=this,i=a.i32[0];await a._doCalculateWitness(t,e);const o=a.instance.exports.getWitnessBuffer();a.i32[0]=i;const n=a.memory.buffer.slice(o,o+a.NVars*a.n64*8);return new Uint8Array(n)}allocInt(){const t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){const t=this.i32[0];return this.i32[0]=t+4*this.n32+8,t}getInt(t){return this.i32[t>>2]}setInt(t,e){this.i32[t>>2]=e}getFr(t){const e=this,a=t>>2;if(2147483648&e.i32[a+1]){const t=new Array(e.n32);for(let i=0;i<e.n32;i++)t[e.n32-1-i]=e.i32[a+2+i];const o=e.Fr.e(He.fromArray(t,4294967296));return 1073741824&e.i32[a+1]?(i=o,e.Fr.mul(e.RInv,i)):o}return 2147483648&e.i32[a]?e.Fr.e(e.i32[a]-4294967296):e.Fr.e(e.i32[a]);var i}setFr(t,e){const a=this;e=a.Fr.e(e);const i=a.Fr.neg(a.Fr.e("80000000",16)),o=a.Fr.e("7FFFFFFF",16);if(a.Fr.geq(e,i)&&a.Fr.leq(e,o)){let o;return a.Fr.geq(e,a.Fr.zero)?o=He.toNumber(e):(o=He.toNumber(a.Fr.sub(e,i)),o-=2147483648,o=4294967296+o),a.i32[t>>2]=o,void(a.i32[1+(t>>2)]=0)}a.i32[t>>2]=0,a.i32[1+(t>>2)]=2147483648;const n=He.toArray(e,4294967296);for(let e=0;e<a.n32;e++){const i=n.length-1-e;a.i32[2+(t>>2)+e]=i>=0?n[i]:0}}}class Si{constructor(t,e){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const a=new Array(this.n32);for(let t=0;t<this.n32;t++)a[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);this.prime=He.fromArray(a,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=e}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);const a=Object.keys(t);var i=0;if(a.forEach((e=>{const a=xi(e),o=parseInt(a.slice(0,8),16),n=parseInt(a.slice(8,16),16),r=Fi(t[e]);for(let t=0;t<r.length;t++){const e=vi(r[t],this.n32);for(let t=0;t<this.n32;t++)this.instance.exports.writeSharedRWMemory(t,e[this.n32-1-t]);try{this.instance.exports.setInputSignal(o,n,t),i++}catch(t){throw new Error(t)}}})),i<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${i} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,e){const a=[];await this._doCalculateWitness(t,e);for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);const e=new Uint32Array(this.n32);for(let t=0;t<this.n32;t++)e[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);a.push(fromArray32(e))}return a}async calculateWTNSBin(t,e){const a=new Uint32Array(this.witnessSize*this.n32+this.n32+11),i=new Uint8Array(a.buffer);await this._doCalculateWitness(t,e),i[0]="w".charCodeAt(0),i[1]="t".charCodeAt(0),i[2]="n".charCodeAt(0),i[3]="s".charCodeAt(0),a[1]=2,a[2]=2,a[3]=1;const o=4*this.n32,n=(8+o).toString(16);a[4]=parseInt(n.slice(0,8),16),a[5]=parseInt(n.slice(8,16),16),a[6]=o,this.instance.exports.getRawPrime();var r=7;for(let t=0;t<this.n32;t++)a[r+t]=this.instance.exports.readSharedRWMemory(t);a[r+=this.n32]=this.witnessSize,a[++r]=2,r++;const l=(o*this.witnessSize).toString(16);a[r]=parseInt(l.slice(0,8),16),a[r+1]=parseInt(l.slice(8,16),16),r+=2;for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);for(let t=0;t<this.n32;t++)a[r+t]=this.instance.exports.readSharedRWMemory(t);r+=this.n32}return i}}async function Gi(t,e,a,i){const o=await da(e),n=await o.read(o.totalSize);await o.close();const r=await Ei(n);if(1==r.circom_version()){const e=await r.calculateBinWitness(t),i=await ga(a,"wtns",2,2);await async function(t,e,a){await fa(t,1);const i=8*(Math.floor((He.bitLength(a)-1)/64)+1);if(await t.writeULE32(i),await ma(t,a,i),e.byteLength%i!=0)throw new Error("Invalid witness length");await t.writeULE32(e.byteLength/i),await _a(t),await fa(t,2),await t.write(e),await _a(t)}(i,e,r.prime),await i.close()}else{const e=await sa(a),i=await r.calculateWTNSBin(t);await e.write(i),await e.close()}}const{unstringifyBigInts:Pi}=$e;function Oi(t){let e=t.toString(16);for(;e.length<64;)e="0"+e;return e=`"0x${e}"`,e}var Ui=Object.freeze({__proto__:null,fullProve:async function(t,e,a,i){const o={type:"mem"};return await Gi(t,e,o),await Ci(a,o,i)},prove:Ci,verify:async function(t,e,a,i){t=Pi(t),a=Pi(a),e=Pi(e);const o=await Fa(t.curve),n=o.G1.fromObject(t.IC[0]),r=new Uint8Array(2*o.G1.F.n8*e.length),l=new Uint8Array(o.Fr.n8*e.length);for(let a=0;a<e.length;a++){const i=o.G1.fromObject(t.IC[a+1]);r.set(i,a*o.G1.F.n8*2),He.toRprLE(l,o.Fr.n8*a,e[a],o.Fr.n8)}let c=await o.G1.multiExpAffine(r,l);c=o.G1.add(c,n);const s=o.G1.fromObject(a.pi_a),d=o.G2.fromObject(a.pi_b),u=o.G1.fromObject(a.pi_c),g=o.G2.fromObject(t.vk_gamma_2),f=o.G2.fromObject(t.vk_delta_2),_=o.G1.fromObject(t.vk_alpha_1),p=o.G2.fromObject(t.vk_beta_2);return await o.pairingEq(o.G1.neg(s),d,c,g,u,f,_,p)?(i&&i.info("OK!"),!0):(i&&i.error("Invalid proof"),!1)},exportSolidityCallData:async function(t,e){let a,i="";for(let t=0;t<e.length;t++)""!=i&&(i+=","),i+=Oi(e[t]);return a=`[${Oi(t.pi_a[0])}, ${Oi(t.pi_a[1])}],[[${Oi(t.pi_b[0][1])}, ${Oi(t.pi_b[0][0])}],[${Oi(t.pi_b[1][1])}, ${Oi(t.pi_b[1][0])}]],[${Oi(t.pi_c[0])}, ${Oi(t.pi_c[1])}],[${i}]`,a}});function zi(t,e){const a=new DataView(e.buffer,e.byteOffset,e.byteLength),i=[];for(let t=0;t<8;t++)i[t]=a.getUint32(4*t);const o=new Lt(i);return t.G2.fromRng(o)}function qi(t,e,a,i,o){const n=Wa(64),r=new Uint8Array([e]);n.update(r),n.update(a);const l=t.G1.toUncompressed(i);n.update(l);const c=t.G1.toUncompressed(o);n.update(c);return zi(t,n.digest())}function Qi(t,e,a,i,o){return t.g1_s=e.G1.toAffine(e.G1.fromRng(o)),t.g1_sx=e.G1.toAffine(e.G1.timesFr(t.g1_s,t.prvKey)),t.g2_sp=e.G2.toAffine(qi(e,a,i,t.g1_s,t.g1_sx)),t.g2_spx=e.G2.toAffine(e.G2.timesFr(t.g2_sp,t.prvKey)),t}function Mi(t,e,a){const i={tau:{},alpha:{},beta:{}};return i.tau.prvKey=t.Fr.fromRng(a),i.alpha.prvKey=t.Fr.fromRng(a),i.beta.prvKey=t.Fr.fromRng(a),Qi(i.tau,t,0,e,a),Qi(i.alpha,t,1,e,a),Qi(i.beta,t,2,e,a),i}async function ki(t,e,a,i){i||(i=a),await t.writeULE32(1);const o=t.pos;await t.writeULE64(0),await t.writeULE32(8*e.F1.n64);const n=new Uint8Array(e.F1.n8);He.toRprLE(n,0,e.q,e.F1.n8),await t.write(n),await t.writeULE32(a),await t.writeULE32(i);const r=t.pos-o-8,l=t.pos;await t.writeULE64(r,o),t.pos=l}async function Ti(t,e){if(!e[1])throw new Error(t.fileName+": File has no  header");if(e[1].length>1)throw new Error(t.fileName+": File has more than one header");t.pos=e[1][0].p;const a=await t.readULE32(),i=await t.read(a),o=He.fromRprLE(i),n=await Ca(o);if(8*n.F1.n64!=a)throw new Error(t.fileName+": Invalid size");const r=await t.readULE32(),l=await t.readULE32();if(t.pos-e[1][0].p!=e[1][0].size)throw new Error("Invalid PTau header size");return{curve:n,power:r,ceremonyPower:l}}function Ri(t,e,a,i){const o={tau:{},alpha:{},beta:{}};return o.tau.g1_s=n(),o.tau.g1_sx=n(),o.alpha.g1_s=n(),o.alpha.g1_sx=n(),o.beta.g1_s=n(),o.beta.g1_sx=n(),o.tau.g2_spx=r(),o.alpha.g2_spx=r(),o.beta.g2_spx=r(),o;function n(){let o;return o=i?a.G1.fromRprLEM(t,e):a.G1.fromRprUncompressed(t,e),e+=2*a.G1.F.n8,o}function r(){let o;return o=i?a.G2.fromRprLEM(t,e):a.G2.fromRprUncompressed(t,e),e+=2*a.G2.F.n8,o}}function Ni(t,e,a,i,o){async function n(i){o?a.G1.toRprLEM(t,e,i):a.G1.toRprUncompressed(t,e,i),e+=2*a.F1.n8}async function r(i){o?a.G2.toRprLEM(t,e,i):a.G2.toRprUncompressed(t,e,i),e+=2*a.F2.n8}return n(i.tau.g1_s),n(i.tau.g1_sx),n(i.alpha.g1_s),n(i.alpha.g1_sx),n(i.beta.g1_s),n(i.beta.g1_sx),r(i.tau.g2_spx),r(i.alpha.g2_spx),r(i.beta.g2_spx),t}async function Di(t,e){const a={};a.tauG1=await c(),a.tauG2=await s(),a.alphaG1=await c(),a.betaG1=await c(),a.betaG2=await s(),a.key=await async function(t,e,a){return Ri(await t.read(2*e.F1.n8*6+2*e.F2.n8*3),0,e,a)}(t,e,!0),a.partialHash=await t.read(216),a.nextChallenge=await t.read(64),a.type=await t.readULE32();const i=new Uint8Array(2*e.G1.F.n8*6+2*e.G2.F.n8*3);Ni(i,0,e,a.key,!1);const o=Wa(64);o.setPartialHash(a.partialHash),o.update(i),a.responseHash=o.digest();const n=await t.readULE32(),r=t.pos;let l=0;for(;t.pos-r<n;){const t=await d(1);if(t[0]<=l)throw new Error("Parameters in the contribution must be sorted");if(l=t[0],1==t[0]){const t=await d(1),e=await d(t[0]);a.name=(new TextDecoder).decode(e)}else if(2==t[0]){const t=await d(1);a.numIterationsExp=t[0]}else{if(3!=t[0])throw new Error("Parameter not recognized");{const t=await d(1);a.beaconHash=await d(t[0])}}}if(t.pos!=r+n)throw new Error("Parametes do not match");return a;async function c(){const a=await t.read(2*e.G1.F.n8);return e.G1.fromRprLEM(a)}async function s(){const a=await t.read(2*e.G2.F.n8);return e.G2.fromRprLEM(a)}async function d(e){const a=await t.read(e);return new Uint8Array(a)}}async function Ki(t,e,a){if(!a[7])throw new Error(t.fileName+": File has no  contributions");if(a[7][0].length>1)throw new Error(t.fileName+": File has more than one contributions section");t.pos=a[7][0].p;const i=await t.readULE32(),o=[];for(let a=0;a<i;a++){const i=await Di(t,e);i.id=a+1,o.push(i)}if(t.pos-a[7][0].p!=a[7][0].size)throw new Error("Invalid contribution section size");return o}async function Vi(t,e,a){const i=new Uint8Array(2*e.F1.n8),o=new Uint8Array(2*e.F2.n8);await r(a.tauG1),await l(a.tauG2),await r(a.alphaG1),await r(a.betaG1),await l(a.betaG2),await async function(t,e,a,i){const o=new Uint8Array(2*e.F1.n8*6+2*e.F2.n8*3);Ni(o,0,e,a,i),await t.write(o)}(t,e,a.key,!0),await t.write(a.partialHash),await t.write(a.nextChallenge),await t.writeULE32(a.type||0);const n=[];if(a.name){n.push(1);const t=new TextEncoder("utf-8").encode(a.name.substring(0,64));n.push(t.byteLength);for(let e=0;e<t.byteLength;e++)n.push(t[e])}if(1==a.type){n.push(2),n.push(a.numIterationsExp),n.push(3),n.push(a.beaconHash.byteLength);for(let t=0;t<a.beaconHash.byteLength;t++)n.push(a.beaconHash[t])}if(n.length>0){const e=new Uint8Array(n);await t.writeULE32(e.byteLength),await t.write(e)}else await t.writeULE32(0);async function r(a){e.G1.toRprLEM(i,0,a),await t.write(i)}async function l(a){e.G2.toRprLEM(o,0,a),await t.write(o)}}async function ji(t,e,a){await t.writeULE32(7);const i=t.pos;await t.writeULE64(0),await t.writeULE32(a.length);for(let i=0;i<a.length;i++)await Vi(t,e,a[i]);const o=t.pos-i-8,n=t.pos;await t.writeULE64(o,i),t.pos=n}function Hi(t,e,a){a&&a.debug("Calculating First Challenge Hash");const i=new Wa(64),o=new Uint8Array(2*t.G1.F.n8),n=new Uint8Array(2*t.G2.F.n8);let r;return t.G1.toRprUncompressed(o,0,t.G1.g),t.G2.toRprUncompressed(n,0,t.G2.g),i.update(Wa(64).digest()),r=2**e*2-1,a&&a.debug("Calculate Initial Hash: tauG1"),l(o,r),r=2**e,a&&a.debug("Calculate Initial Hash: tauG2"),l(n,r),a&&a.debug("Calculate Initial Hash: alphaTauG1"),l(o,r),a&&a.debug("Calculate Initial Hash: betaTauG1"),l(o,r),i.update(n),i.digest();function l(t,e){const o=5e5,n=Math.floor(e/o),r=e%o,l=new Uint8Array(o*t.byteLength);for(let e=0;e<o;e++)l.set(t,e*t.byteLength);for(let t=0;t<n;t++)i.update(l),a&&a.debug("Initial hash: "+t*o);for(let e=0;e<r;e++)i.update(t)}}function $i(t,e,a,i){return Mi(t,e,li(a,i))}const Zi=ni;async function Yi(t,e,a,i){let o;if(1==e.type){const o=$i(t,a.nextChallenge,e.beaconHash,e.numIterationsExp);if(!t.G1.eq(e.key.tau.g1_s,o.tau.g1_s))return i&&i.error(`BEACON key (tauG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.tau.g1_sx,o.tau.g1_sx))return i&&i.error(`BEACON key (tauG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.tau.g2_spx,o.tau.g2_spx))return i&&i.error(`BEACON key (tauG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.alpha.g1_s,o.alpha.g1_s))return i&&i.error(`BEACON key (alphaG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.alpha.g1_sx,o.alpha.g1_sx))return i&&i.error(`BEACON key (alphaG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.alpha.g2_spx,o.alpha.g2_spx))return i&&i.error(`BEACON key (alphaG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.beta.g1_s,o.beta.g1_s))return i&&i.error(`BEACON key (betaG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.beta.g1_sx,o.beta.g1_sx))return i&&i.error(`BEACON key (betaG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.beta.g2_spx,o.beta.g2_spx))return i&&i.error(`BEACON key (betaG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1}return e.key.tau.g2_sp=t.G2.toAffine(qi(t,0,a.nextChallenge,e.key.tau.g1_s,e.key.tau.g1_sx)),e.key.alpha.g2_sp=t.G2.toAffine(qi(t,1,a.nextChallenge,e.key.alpha.g1_s,e.key.alpha.g1_sx)),e.key.beta.g2_sp=t.G2.toAffine(qi(t,2,a.nextChallenge,e.key.beta.g1_s,e.key.beta.g1_sx)),o=await Zi(t,e.key.tau.g1_s,e.key.tau.g1_sx,e.key.tau.g2_sp,e.key.tau.g2_spx),!0!==o?(i&&i.error("INVALID key (tau) in challenge #"+e.id),!1):(o=await Zi(t,e.key.alpha.g1_s,e.key.alpha.g1_sx,e.key.alpha.g2_sp,e.key.alpha.g2_spx),!0!==o?(i&&i.error("INVALID key (alpha) in challenge #"+e.id),!1):(o=await Zi(t,e.key.beta.g1_s,e.key.beta.g1_sx,e.key.beta.g2_sp,e.key.beta.g2_spx),!0!==o?(i&&i.error("INVALID key (beta) in challenge #"+e.id),!1):(o=await Zi(t,a.tauG1,e.tauG1,e.key.tau.g2_sp,e.key.tau.g2_spx),!0!==o?(i&&i.error("INVALID tau*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(o=await Zi(t,e.key.tau.g1_s,e.key.tau.g1_sx,a.tauG2,e.tauG2),!0!==o?(i&&i.error("INVALID tau*G2. challenge #"+e.id+" It does not follow the previous contribution"),!1):(o=await Zi(t,a.alphaG1,e.alphaG1,e.key.alpha.g2_sp,e.key.alpha.g2_spx),!0!==o?(i&&i.error("INVALID alpha*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(o=await Zi(t,a.betaG1,e.betaG1,e.key.beta.g2_sp,e.key.beta.g2_spx),!0!==o?(i&&i.error("INVALID beta*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(o=await Zi(t,e.key.beta.g1_s,e.key.beta.g1_sx,a.betaG2,e.betaG2),!0!==o?(i&&i.error("INVALID beta*G2. challenge #"+e.id+"It does not follow the previous contribution"),!1):(i&&i.info("Powers Of tau file OK!"),!0))))))))}async function Ji(t,e,a,i,o,n,r,l,c,s){const d=o[n],u=2*d.F.n8,g=e[i][0].size/u;await pa(t,e,i),await fa(a,i);let f=r;for(let e=0;e<g;e+=65536){s&&s.debug(`Applying key: ${c}: ${e}/${g}`);const i=Math.min(g-e,65536);let n;n=await t.read(i*u),n=await d.batchApplyKey(n,f,l),await a.write(n),f=o.Fr.mul(f,o.Fr.exp(l,i))}await _a(a),await ha(t)}async function Wi(t,e,a,i,o,n,r,l,c,s,d){const u=i[o],g=2*u.F.n8,f=Math.floor((1<<20)/g);let _=r;for(let o=0;o<n;o+=f){d&&d.debug(`Applying key ${s}: ${o}/${n}`);const r=Math.min(n-o,f),p=await t.read(r*g),h=await u.batchUtoLEM(p),m=await u.batchApplyKey(h,_,l);let L;L="COMPRESSED"==c?await u.batchLEMtoC(m):await u.batchLEMtoU(m),a&&a.update(L),await e.write(L),_=i.Fr.mul(_,i.Fr.exp(l,r))}}var Xi=Object.freeze({__proto__:null,newAccumulator:async function(t,e,a,i){await Wa.ready();const o=await ga(a,"ptau",1,7);await ki(o,t,e,0);const n=t.G1.oneAffine,r=t.G2.oneAffine;await fa(o,2);const l=2**e*2-1;for(let t=0;t<l;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("tauG1: "+t);await _a(o),await fa(o,3);const c=2**e;for(let t=0;t<c;t++)await o.write(r),i&&t%1e5==0&&t&&i.log("tauG2: "+t);await _a(o),await fa(o,4);const s=2**e;for(let t=0;t<s;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("alphaTauG1: "+t);await _a(o),await fa(o,5);const d=2**e;for(let t=0;t<d;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("betaTauG1: "+t);await _a(o),await fa(o,6),await o.write(r),await _a(o),await fa(o,7),await o.writeULE32(0),await _a(o),await o.close();const u=Hi(t,e,i);return i&&i.debug(ai(Wa(64).digest(),"Blank Contribution Hash:")),i&&i.info(ai(u,"First Contribution Hash:")),u},exportChallenge:async function(t,e,a){await Wa.ready();const{fd:i,sections:o}=await ua(t,"ptau",1),{curve:n,power:r}=await Ti(i,o),l=await Ki(i,n,o);let c,s;0==l.length?(c=Wa(64).digest(),s=Hi(n,r)):(c=l[l.length-1].responseHash,s=l[l.length-1].nextChallenge),a&&a.info(ai(c,"Last Response Hash: ")),a&&a.info(ai(s,"New Challenge Hash: "));const d=await sa(e),u=Wa(64);await d.write(c),u.update(c),await f(2,"G1",2**r*2-1,"tauG1"),await f(3,"G2",2**r,"tauG2"),await f(4,"G1",2**r,"alphaTauG1"),await f(5,"G1",2**r,"betaTauG1"),await f(6,"G2",1,"betaG2"),await i.close(),await d.close();const g=u.digest();if(!ii(s,g))throw a&&a.info(ai(g,"Calc Curret Challenge Hash: ")),a&&a.error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one"),new Error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one");return s;async function f(t,e,r,l){const c=n[e],s=2*c.F.n8,g=Math.floor((1<<24)/s);await pa(i,o,t);for(let t=0;t<r;t+=g){a&&a.debug(`Exporting ${l}: ${t}/${r}`);const e=Math.min(r-t,g);let o;o=await i.read(e*s),o=await c.batchLEMtoU(o),await d.write(o),u.update(o)}await ha(i)}},importResponse:async function(t,e,a,i,o,n){await Wa.ready();const r=new Uint8Array(64);for(let t=0;t<64;t++)r[t]=255;const{fd:l,sections:c}=await ua(t,"ptau",1),{curve:s,power:d}=await Ti(l,c),u=await Ki(l,s,c),g={};i&&(g.name=i);const f=2*s.F1.n8,_=s.F1.n8,p=2*s.F2.n8,h=s.F2.n8,m=await da(e);if(m.totalSize!=64+(2**d*2-1)*_+2**d*h+2**d*_+2**d*_+h+6*f+3*p)throw new Error("Size of the contribution is invalid");let L;L=u.length>0?u[u.length-1].nextChallenge:Hi(s,d,n);const w=await ga(a,"ptau",1,o?7:2);await ki(w,s,d);const A=await m.read(64);if(ii(r,L)&&(L=A,u[u.length-1].nextChallenge=L),!ii(A,L))throw new Error("Wrong contribution. this contribution is not based on the previus hash");const b=new Wa(64);b.update(A);const y=[];let I;I=await x(m,w,"G1",2,2**d*2-1,[1],"tauG1"),g.tauG1=I[0],I=await x(m,w,"G2",3,2**d,[1],"tauG2"),g.tauG2=I[0],I=await x(m,w,"G1",4,2**d,[0],"alphaG1"),g.alphaG1=I[0],I=await x(m,w,"G1",5,2**d,[0],"betaG1"),g.betaG1=I[0],I=await x(m,w,"G2",6,1,[0],"betaG2"),g.betaG2=I[0],g.partialHash=b.getPartialHash();const C=await m.read(2*s.F1.n8*6+2*s.F2.n8*3);g.key=Ri(C,0,s,!1),b.update(new Uint8Array(C));const F=b.digest();if(n&&n.info(ai(F,"Contribution Response Hash imported: ")),o){const t=new Wa(64);t.update(F),await v(t,w,"G1",2,2**d*2-1,"tauG1",n),await v(t,w,"G2",3,2**d,"tauG2",n),await v(t,w,"G1",4,2**d,"alphaTauG1",n),await v(t,w,"G1",5,2**d,"betaTauG1",n),await v(t,w,"G2",6,1,"betaG2",n),g.nextChallenge=t.digest(),n&&n.info(ai(g.nextChallenge,"Next Challenge Hash: "))}else g.nextChallenge=r;return u.push(g),await ji(w,s,u),await m.close(),await w.close(),await l.close(),g.nextChallenge;async function x(t,e,a,i,r,l,c){return o?await async function(t,e,a,i,o,r,l){const c=s[a],d=c.F.n8,u=2*c.F.n8,g=[];await fa(e,i);const f=Math.floor((1<<24)/u);y[i]=e.pos;for(let a=0;a<o;a+=f){n&&n.debug(`Importing ${l}: ${a}/${o}`);const i=Math.min(o-a,f),s=await t.read(i*d);b.update(s);const _=await c.batchCtoLEM(s);await e.write(_);for(let t=0;t<r.length;t++){const e=r[t];if(e>=a&&e<a+i){const t=c.fromRprLEM(_,(e-a)*u);g.push(t)}}}return await _a(e),g}(t,e,a,i,r,l,c):await async function(t,e,a,i,o,r,l){const c=s[a],d=c.F.n8,u=[],g=Math.floor((1<<24)/d);for(let e=0;e<o;e+=g){n&&n.debug(`Importing ${l}: ${e}/${o}`);const a=Math.min(o-e,g),i=await t.read(a*d);b.update(i);for(let t=0;t<r.length;t++){const o=r[t];if(o>=e&&o<e+a){const t=c.fromRprCompressed(i,(o-e)*d);u.push(t)}}}return u}(t,0,a,0,r,l,c)}async function v(t,e,a,i,o,n,r){const l=s[a],c=2*l.F.n8,d=Math.floor((1<<24)/c),u=e.pos;e.pos=y[i];for(let a=0;a<o;a+=d){r&&r.debug(`Hashing ${n}: ${a}/${o}`);const i=Math.min(o-a,d),s=await e.read(i*c),u=await l.batchLEMtoU(s);t.update(u)}e.pos=u}},verify:async function(t,e){let a;await Wa.ready();const{fd:i,sections:o}=await ua(t,"ptau",1),{curve:n,power:r,ceremonyPower:l}=await Ti(i,o),c=await Ki(i,n,o);e&&e.debug("power: 2**"+r),e&&e.debug("Computing initial contribution hash");const s={tauG1:n.G1.g,tauG2:n.G2.g,alphaG1:n.G1.g,betaG1:n.G1.g,betaG2:n.G2.g,nextChallenge:Hi(n,l,e),responseHash:Wa(64).digest()};if(0==c.length)return e&&e.error("This file has no contribution! It cannot be used in production"),!1;let d;d=c.length>1?c[c.length-2]:s;const u=c[c.length-1];if(e&&e.debug("Validating contribution #"+c[c.length-1].id),!await Yi(n,u,d,e))return!1;const g=Wa(64);g.update(u.responseHash),e&&e.debug("Verifying powers in tau*G1 section");const f=await A(2,"G1","tauG1",2**r*2-1,[0,1],e);if(a=await Zi(n,f.R1,f.R2,n.G2.g,u.tauG2),!0!==a)return e&&e.error("tauG1 section. Powers do not match"),!1;if(!n.G1.eq(n.G1.g,f.singularPoints[0]))return e&&e.error("First element of tau*G1 section must be the generator"),!1;if(!n.G1.eq(u.tauG1,f.singularPoints[1]))return e&&e.error("Second element of tau*G1 section does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in tau*G2 section");const _=await A(3,"G2","tauG2",2**r,[0,1],e);if(a=await Zi(n,n.G1.g,u.tauG1,_.R1,_.R2),!0!==a)return e&&e.error("tauG2 section. Powers do not match"),!1;if(!n.G2.eq(n.G2.g,_.singularPoints[0]))return e&&e.error("First element of tau*G2 section must be the generator"),!1;if(!n.G2.eq(u.tauG2,_.singularPoints[1]))return e&&e.error("Second element of tau*G2 section does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in alpha*tau*G1 section");const p=await A(4,"G1","alphatauG1",2**r,[0],e);if(a=await Zi(n,p.R1,p.R2,n.G2.g,u.tauG2),!0!==a)return e&&e.error("alphaTauG1 section. Powers do not match"),!1;if(!n.G1.eq(u.alphaG1,p.singularPoints[0]))return e&&e.error("First element of alpha*tau*G1 section (alpha*G1) does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in beta*tau*G1 section");const h=await A(5,"G1","betatauG1",2**r,[0],e);if(a=await Zi(n,h.R1,h.R2,n.G2.g,u.tauG2),!0!==a)return e&&e.error("betaTauG1 section. Powers do not match"),!1;if(!n.G1.eq(u.betaG1,h.singularPoints[0]))return e&&e.error("First element of beta*tau*G1 section (beta*G1) does not match the one in the contribution section"),!1;const m=await async function(t){const e=n.G2,a=2*e.F.n8,r=new Uint8Array(a);if(!o[6])throw t.error("File has no BetaG2 section"),new Error("File has no BetaG2 section");if(o[6].length>1)throw t.error("File has no BetaG2 section"),new Error("File has more than one GetaG2 section");i.pos=o[6][0].p;const l=await i.read(a),c=e.fromRprLEM(l);return e.toRprUncompressed(r,0,c),g.update(r),c}(e);if(!n.G2.eq(u.betaG2,m))return e&&e.error("betaG2 element in betaG2 section does not match the one in the contribution section"),!1;const L=g.digest();if(r==l&&!ii(L,u.nextChallenge))return e&&e.error("Hash of the values does not match the next challenge of the last contributor in the contributions section"),!1;e&&e.info(ai(L,"Next challenge hash: ")),w(u,d);for(let t=c.length-2;t>=0;t--){const a=c[t],i=t>0?c[t-1]:s;if(!await Yi(n,a,i,e))return!1;w(a,i)}if(e&&e.info("-----------------------------------------------------"),o[12]&&o[13]&&o[14]&&o[15]){let t;if(t=await b("G1",2,12,"tauG1",e),!t)return!1;if(t=await b("G2",3,13,"tauG2",e),!t)return!1;if(t=await b("G1",4,14,"alphaTauG1",e),!t)return!1;if(t=await b("G1",5,15,"betaTauG1",e),!t)return!1}else e&&e.warn(\'this file does not contain phase2 precalculated values. Please run: \\n   snarkjs "powersoftau preparephase2" to prepare this file to be used in the phase2 ceremony.\');return await i.close(),e&&e.info("Powers of Tau Ok!"),!0;function w(t,a){if(!e)return;e.info("-----------------------------------------------------"),e.info(`Contribution #${t.id}: ${t.name||""}`),e.info(ai(t.nextChallenge,"Next Challenge: "));const i=new Uint8Array(2*n.G1.F.n8*6+2*n.G2.F.n8*3);Ni(i,0,n,t.key,!1);const o=Wa(64);o.setPartialHash(t.partialHash),o.update(i);const r=o.digest();e.info(ai(r,"Response Hash:")),e.info(ai(a.nextChallenge,"Response Hash:")),1==t.type&&(e.info(`Beacon generator: ${si(t.beaconHash)}`),e.info(`Beacon iterations Exp: ${t.numIterationsExp}`))}async function A(t,e,a,r,l,c){const s=n[e],d=2*s.F.n8;await pa(i,o,t);const u=[];let f=s.zero,_=s.zero,p=s.zero;for(let t=0;t<r;t+=65536){c&&c.debug(`points relations: ${a}: ${t}/${r} `);const e=Math.min(r-t,65536),o=await i.read(e*d),n=await s.batchLEMtoU(o);g.update(n);const h=new Uint8Array(4*(e-1));if(wt.randomFillSync(h),t>0){const t=s.fromRprLEM(o,0),e=wt.randomBytes(4).readUInt32BE(0,!0);f=s.add(f,s.timesScalar(p,e)),_=s.add(_,s.timesScalar(t,e))}const m=await s.multiExpAffine(o.slice(0,(e-1)*d),h),L=await s.multiExpAffine(o.slice(d),h);f=s.add(f,m),_=s.add(_,L),p=s.fromRprLEM(o,(e-1)*d);for(let a=0;a<l.length;a++){const i=l[a];if(i>=t&&i<t+e){const e=s.fromRprLEM(o,(i-t)*d);u.push(e)}}}return await ha(i),{R1:f,R2:_,singularPoints:u}}async function b(t,e,a,l,c){c&&c.debug(`Verifying phase2 calculated values ${l}...`);const s=n[t],d=2*s.F.n8,u=new Array(8);for(let t=0;t<8;t++)u[t]=wt.randomBytes(4).readUInt32BE(0,!0);for(let t=0;t<=r;t++){if(!await g(t))return!1}if(2==e){if(!await g(r+1))return!1}return!0;async function g(t){c&&c.debug(`Power ${t}...`);const g=n.Fr.n8,f=2**t;let _,p=new Uint32Array(f),h=new Lt(u);c&&c.debug(`Creating random numbers Powers${t}...`);for(let e=0;e<f;e++)p[e]=t==r+1&&e==f-1?0:h.nextU32();p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength),c&&c.debug(`reading points Powers${t}...`),await pa(i,o,e),_=new fe(f*d),t==r+1?(await i.readToBuffer(_,0,(f-1)*d),_.set(n.G1.zeroAffine,(f-1)*d)):await i.readToBuffer(_,0,f*d),await ha(i,!0);const m=await s.multiExpAffine(_,p,c,l+"_"+t);p=new fe(f*g),h=new Lt(u);const L=new Uint8Array(4),w=new DataView(L.buffer);c&&c.debug(`Creating random numbers Powers${t}...`);for(let e=0;e<f;e++)e==f-1&&t==r+1||(w.setUint32(0,h.nextU32(),!0),p.set(L,e*g));c&&c.debug(`batchToMontgomery ${t}...`),p=await n.Fr.batchToMontgomery(p),c&&c.debug(`fft ${t}...`),p=await n.Fr.fft(p),c&&c.debug(`batchFromMontgomery ${t}...`),p=await n.Fr.batchFromMontgomery(p),c&&c.debug(`reading points Lagrange${t}...`),await pa(i,o,a),i.pos+=d*(2**t-1),await i.readToBuffer(_,0,f*d),await ha(i,!0);const A=await s.multiExpAffine(_,p,c,l+"_"+t+"_transformed");return!!s.eq(m,A)||(c&&c.error("Phase2 caclutation does not match with powers of tau"),!1)}}},challengeContribute:async function(t,e,a,i,o){await Wa.ready();const n=await da(e),r=8*t.F1.n64*2,l=8*t.F2.n64*2,c=(n.totalSize+r-64-l)/(4*r+l);let s=c,d=0;for(;s>1;)s/=2,d+=1;if(2**d!=c)throw new Error("Invalid file size");o&&o.debug("Power to tau size: "+d);const u=await ri(i),g=await sa(a),f=Wa(64);for(let t=0;t<n.totalSize;t+=n.pageSize){o&&o.debug(`Hashing challenge ${t}/${n.totalSize}`);const e=Math.min(n.totalSize-t,n.pageSize),a=await n.read(e);f.update(a)}const _=await n.read(64,0);o&&o.info(ai(_,"Claimed Previous Response Hash: "));const p=f.digest();o&&o.info(ai(p,"Current Challenge Hash: "));const h=Mi(t,p,u);o&&["tau","alpha","beta"].forEach((e=>{o.debug(e+".g1_s: "+t.G1.toString(h[e].g1_s,16)),o.debug(e+".g1_sx: "+t.G1.toString(h[e].g1_sx,16)),o.debug(e+".g2_sp: "+t.G2.toString(h[e].g2_sp,16)),o.debug(e+".g2_spx: "+t.G2.toString(h[e].g2_spx,16)),o.debug("")}));const m=Wa(64);await g.write(p),m.update(p),await Wi(n,g,m,t,"G1",2**d*2-1,t.Fr.one,h.tau.prvKey,"COMPRESSED","tauG1",o),await Wi(n,g,m,t,"G2",2**d,t.Fr.one,h.tau.prvKey,"COMPRESSED","tauG2",o),await Wi(n,g,m,t,"G1",2**d,h.alpha.prvKey,h.tau.prvKey,"COMPRESSED","alphaTauG1",o),await Wi(n,g,m,t,"G1",2**d,h.beta.prvKey,h.tau.prvKey,"COMPRESSED","betaTauG1",o),await Wi(n,g,m,t,"G2",1,h.beta.prvKey,h.tau.prvKey,"COMPRESSED","betaTauG2",o);const L=new Uint8Array(2*t.F1.n8*6+2*t.F2.n8*3);Ni(L,0,t,h,!1),await g.write(L),m.update(L);const w=m.digest();o&&o.info(ai(w,"Contribution Response Hash: ")),await g.close(),await n.close()},beacon:async function(t,e,a,i,o,n){const r=ci(i);if(0==r.byteLength||2*r.byteLength!=i.length)return n&&n.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(r.length>=256)return n&&n.error("Maximum lenght of beacon hash is 255 bytes"),!1;if((o=parseInt(o))<10||o>63)return n&&n.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;await Wa.ready();const{fd:l,sections:c}=await ua(t,"ptau",1),{curve:s,power:d,ceremonyPower:u}=await Ti(l,c);if(d!=u)return n&&n.error("This file has been reduced. You cannot contribute into a reduced file."),!1;c[12]&&n&&n.warn("Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");const g=await Ki(l,s,c),f={name:a,type:1,numIterationsExp:o,beaconHash:r};let _;_=g.length>0?g[g.length-1].nextChallenge:Hi(s,d,n),f.key=$i(s,_,r,o);const p=new Wa(64);p.update(_);const h=await ga(e,"ptau",1,7);await ki(h,s,d);const m=[];let L;L=await y(2,"G1",2**d*2-1,s.Fr.e(1),f.key.tau.prvKey,"tauG1",n),f.tauG1=L[1],L=await y(3,"G2",2**d,s.Fr.e(1),f.key.tau.prvKey,"tauG2",n),f.tauG2=L[1],L=await y(4,"G1",2**d,f.key.alpha.prvKey,f.key.tau.prvKey,"alphaTauG1",n),f.alphaG1=L[0],L=await y(5,"G1",2**d,f.key.beta.prvKey,f.key.tau.prvKey,"betaTauG1",n),f.betaG1=L[0],L=await y(6,"G2",1,f.key.beta.prvKey,f.key.tau.prvKey,"betaTauG2",n),f.betaG2=L[0],f.partialHash=p.getPartialHash();const w=new Uint8Array(2*s.F1.n8*6+2*s.F2.n8*3);Ni(w,0,s,f.key,!1),p.update(new Uint8Array(w));const A=p.digest();n&&n.info(ai(A,"Contribution Response Hash imported: "));const b=new Wa(64);return b.update(A),await I(h,"G1",2,2**d*2-1,"tauG1",n),await I(h,"G2",3,2**d,"tauG2",n),await I(h,"G1",4,2**d,"alphaTauG1",n),await I(h,"G1",5,2**d,"betaTauG1",n),await I(h,"G2",6,1,"betaG2",n),f.nextChallenge=b.digest(),n&&n.info(ai(f.nextChallenge,"Next Challenge Hash: ")),g.push(f),await ji(h,s,g),await l.close(),await h.close(),A;async function y(t,e,a,i,o,n,r){const d=[];l.pos=c[t][0].p,await fa(h,t),m[t]=h.pos;const u=s[e],g=2*u.F.n8,f=Math.floor((1<<20)/g);let _=i;for(let t=0;t<a;t+=f){r&&r.debug(`applying key${n}: ${t}/${a}`);const e=Math.min(a-t,f),i=await l.read(e*g),c=await u.batchApplyKey(i,_,o),m=h.write(c),L=await u.batchLEMtoC(c);if(p.update(L),await m,0==t)for(let t=0;t<Math.min(2,a);t++)d.push(u.fromRprLEM(c,t*g));_=s.Fr.mul(_,s.Fr.exp(o,e))}return await _a(h),d}async function I(t,e,a,i,o,n){const r=s[e],l=2*r.F.n8,c=Math.floor((1<<24)/l),d=t.pos;t.pos=m[a];for(let e=0;e<i;e+=c){n&&n.debug(`Hashing ${o}: ${e}/${i}`);const a=Math.min(i-e,c),s=await t.read(a*l),d=await r.batchLEMtoU(s);b.update(d)}t.pos=d}},contribute:async function(t,e,a,i,o){await Wa.ready();const{fd:n,sections:r}=await ua(t,"ptau",1),{curve:l,power:c,ceremonyPower:s}=await Ti(n,r);if(c!=s)throw o&&o.error("This file has been reduced. You cannot contribute into a reduced file."),new Error("This file has been reduced. You cannot contribute into a reduced file.");r[12]&&o&&o.warn("WARNING: Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");const d=await Ki(n,l,r),u={name:a,type:0};let g;const f=await ri(i);g=d.length>0?d[d.length-1].nextChallenge:Hi(l,c,o),u.key=Mi(l,g,f);const _=new Wa(64);_.update(g);const p=await ga(e,"ptau",1,7);await ki(p,l,c);const h=[];let m;m=await b(2,"G1",2**c*2-1,l.Fr.e(1),u.key.tau.prvKey,"tauG1"),u.tauG1=m[1],m=await b(3,"G2",2**c,l.Fr.e(1),u.key.tau.prvKey,"tauG2"),u.tauG2=m[1],m=await b(4,"G1",2**c,u.key.alpha.prvKey,u.key.tau.prvKey,"alphaTauG1"),u.alphaG1=m[0],m=await b(5,"G1",2**c,u.key.beta.prvKey,u.key.tau.prvKey,"betaTauG1"),u.betaG1=m[0],m=await b(6,"G2",1,u.key.beta.prvKey,u.key.tau.prvKey,"betaTauG2"),u.betaG2=m[0],u.partialHash=_.getPartialHash();const L=new Uint8Array(2*l.F1.n8*6+2*l.F2.n8*3);Ni(L,0,l,u.key,!1),_.update(new Uint8Array(L));const w=_.digest();o&&o.info(ai(w,"Contribution Response Hash imported: "));const A=new Wa(64);return A.update(w),await y(p,"G1",2,2**c*2-1,"tauG1"),await y(p,"G2",3,2**c,"tauG2"),await y(p,"G1",4,2**c,"alphaTauG1"),await y(p,"G1",5,2**c,"betaTauG1"),await y(p,"G2",6,1,"betaG2"),u.nextChallenge=A.digest(),o&&o.info(ai(u.nextChallenge,"Next Challenge Hash: ")),d.push(u),await ji(p,l,d),await n.close(),await p.close(),w;async function b(t,e,a,i,c,s){const d=[];n.pos=r[t][0].p,await fa(p,t),h[t]=p.pos;const u=l[e],g=2*u.F.n8,f=Math.floor((1<<20)/g);let m=i;for(let t=0;t<a;t+=f){o&&o.debug(`processing: ${s}: ${t}/${a}`);const e=Math.min(a-t,f),i=await n.read(e*g),r=await u.batchApplyKey(i,m,c),h=p.write(r),L=await u.batchLEMtoC(r);if(_.update(L),await h,0==t)for(let t=0;t<Math.min(2,a);t++)d.push(u.fromRprLEM(r,t*g));m=l.Fr.mul(m,l.Fr.exp(c,e))}return await _a(p),d}async function y(t,e,a,i,n){const r=l[e],c=2*r.F.n8,s=Math.floor((1<<24)/c),d=t.pos;t.pos=h[a];for(let e=0;e<i;e+=s){o&&e&&o.debug(`Hashing ${n}: `+e);const a=Math.min(i-e,s),l=await t.read(a*c),d=await r.batchLEMtoU(l);A.update(d)}t.pos=d}},preparePhase2:async function(t,e,a){const{fd:i,sections:o}=await ua(t,"ptau",1),{curve:n,power:r}=await Ti(i,o),l=await ga(e,"ptau",1,11);return await ki(l,n,r),await wa(i,o,l,2),await wa(i,o,l,3),await wa(i,o,l,4),await wa(i,o,l,5),await wa(i,o,l,6),await wa(i,o,l,7),await c(2,12,"G1","tauG1"),await c(3,13,"G2","tauG2"),await c(4,14,"G1","alphaTauG1"),await c(5,15,"G1","betaTauG1"),await i.close(),void await l.close();async function c(t,e,c,s){a&&a.debug("Starting section: "+s),await fa(l,e);for(let t=0;t<=r;t++)await d(t);async function d(e){const d=2**e,u=n[c];n.Fr;const g=2*u.F.n8;let f;u.F.n8,f=new fe(d*g),await pa(i,o,t),2==t&&e==r+1?(await i.readToBuffer(f,0,(d-1)*g),f.set(n.G1.zeroAffine,(d-1)*g)):await i.readToBuffer(f,0,d*g),await ha(i,!0),f=await u.lagrangeEvaluations(f,"affine","affine",a,s),await l.write(f)}2==t&&await d(r+1),await _a(l)}},truncate:async function(t,e,a){const{fd:i,sections:o}=await ua(t,"ptau",1),{curve:n,power:r,ceremonyPower:l}=await Ti(i,o),c=2*n.G1.F.n8,s=2*n.G2.F.n8;for(let t=1;t<r;t++)await d(t);return await i.close(),!0;async function d(t){let r=t.toString();for(;r.length<2;)r="0"+r;a&&a.debug("Writing Power: "+r);const d=await ga(e+r+".ptau","ptau",1,11);await ki(d,n,t,l),await wa(i,o,d,2,(2**t*2-1)*c),await wa(i,o,d,3,2**t*s),await wa(i,o,d,4,2**t*c),await wa(i,o,d,5,2**t*c),await wa(i,o,d,6,s),await wa(i,o,d,7),await wa(i,o,d,12,(2**(t+1)*2-1)*c),await wa(i,o,d,13,(2**t*2-1)*s),await wa(i,o,d,14,(2**t*2-1)*c),await wa(i,o,d,15,(2**t*2-1)*c),await d.close()}},convert:async function(t,e,a){const{fd:i,sections:o}=await ua(t,"ptau",1),{curve:n,power:r}=await Ti(i,o),l=await ga(e,"ptau",1,11);return await ki(l,n,r),await wa(i,o,l,2),await wa(i,o,l,3),await wa(i,o,l,4),await wa(i,o,l,5),await wa(i,o,l,6),await wa(i,o,l,7),await async function(t,e,c,s){a&&a.debug("Starting section: "+s);await fa(l,e);const d=o[e][0].size,u=i.pageSize;await pa(i,o,e);for(let t=0;t<d;t+=u){const e=Math.min(d-t,u),a=await i.read(e);await l.write(a)}await ha(i),2==t&&await async function(e){const d=2**e,u=n[c],g=2*u.F.n8;let f;f=new fe(d*g),await pa(i,o,t),2==t&&e==r+1?(await i.readToBuffer(f,0,(d-1)*g),f.set(n.G1.zeroAffine,(d-1)*g)):await i.readToBuffer(f,0,d*g);await ha(i,!0),f=await u.lagrangeEvaluations(f,"affine","affine",a,s),await l.write(f)}(r+1);await _a(l)}(2,12,"G1","tauG1"),await wa(i,o,l,13),await wa(i,o,l,14),await wa(i,o,l,15),await i.close(),void await l.close()},exportJson:async function(t,e){const{fd:a,sections:i}=await ua(t,"ptau",1),{curve:o,power:n}=await Ti(a,i),r={};return r.q=o.q,r.power=n,r.contributions=await Ki(a,o,i),r.tauG1=await l(2,"G1",2**n*2-1,"tauG1"),r.tauG2=await l(3,"G2",2**n,"tauG2"),r.alphaTauG1=await l(4,"G1",2**n,"alphaTauG1"),r.betaTauG1=await l(5,"G1",2**n,"betaTauG1"),r.betaG2=await l(6,"G2",1,"betaG2"),r.lTauG1=await c(12,"G1","lTauG1"),r.lTauG2=await c(13,"G2","lTauG2"),r.lAlphaTauG1=await c(14,"G1","lAlphaTauG2"),r.lBetaTauG1=await c(15,"G1","lBetaTauG2"),await a.close(),r;async function l(t,n,r,l){const c=o[n],s=2*c.F.n8,d=[];await pa(a,i,t);for(let t=0;t<r;t++){e&&t&&t%1e4==0&&console.log(`${l}: `+t);const i=await a.read(s);d.push(c.fromRprLEM(i,0))}return await ha(a),d}async function c(t,r,l){const c=o[r],s=2*c.F.n8,d=[];await pa(a,i,t);for(let t=0;t<=n;t++){e&&console.log(`${l}: Power: ${t}`),d[t]=[];const i=2**t;for(let o=0;o<i;o++){e&&o&&o%1e4==0&&console.log(`${l}: ${o}/${i}`);const n=await a.read(s);d[t].push(c.fromRprLEM(n,0))}}return await ha(a),d}}});const to=262144,eo={get:function(t,e){return isNaN(e)?t[e]:t.getElement(e)},set:function(t,e,a){return isNaN(e)?(t[e]=a,!0):t.setElement(e,a)}};class ao{constructor(t){this.length=t||0,this.arr=new Array(to);for(let e=0;e<t;e+=to)this.arr[e/to]=new Array(Math.min(to,t-e));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,e){const a=new Array(e-t);for(let i=t;i<e;i++)a[i-t]=this.getElement(i);return a}getElement(t){t=parseInt(t);const e=Math.floor(t/to),a=t%to;return this.arr[e]?this.arr[e][a]:void 0}setElement(t,e){t=parseInt(t);const a=Math.floor(t/to);this.arr[a]||(this.arr[a]=new Array(to));const i=t%to;return this.arr[a][i]=e,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new io;for(let e=0;e<this.arr.length;e++)if(this.arr[e])for(let a=0;a<this.arr[e].length;a++)void 0!==this.arr[e][a]&&t.push(e*to+a);return t}}class io{constructor(t){const e=new ao(t);return new Proxy(e,eo)}}async function oo(t,e,a){const i={};return await pa(t,e,1),i.n8=await t.readULE32(),i.prime=await La(t,i.n8),i.curve=await async function(t,e,a){let i;if(tt(t,je))i=await De(e,a);else{if(!tt(t,Ve))throw new Error(`Curve not supported: ${F(t)}`);i=await Ke(e,a)}return i}(i.prime,a),i.nVars=await t.readULE32(),i.nOutputs=await t.readULE32(),i.nPubInputs=await t.readULE32(),i.nPrvInputs=await t.readULE32(),i.nLabels=await t.readULE64(),i.nConstraints=await t.readULE32(),await ha(t),i}async function no(t,e,a,i,o,n){const{fd:r,sections:l}=await ua(t,"r1cs",1),c=await oo(r,l,i);return e&&(c.constraints=await async function(t,e,a,i,o){const n=await Aa(t,e,2);let r,l=0;r=a.nConstraints>1<<20?new io:[];for(let t=0;t<a.nConstraints;t++){i&&t%1e5==0&&i.info(`${o}: Loading constraints: ${t}/${a.nConstraints}`);const e=c();r.push(e)}return r;function c(){const t=[];return t[0]=s(),t[1]=s(),t[2]=s(),t}function s(){const t={},e=n.slice(l,l+4);l+=4;const i=new DataView(e.buffer).getUint32(0,!0),o=n.slice(l,l+(4+a.n8)*i);l+=(4+a.n8)*i;const r=new DataView(o.buffer);for(let e=0;e<i;e++){const i=r.getUint32(e*(4+a.n8),!0),n=a.curve.Fr.fromRprLE(o,e*(4+a.n8)+4);t[i]=n}return t}}(r,l,c,o,n)),a&&(c.map=await async function(t,e,a,i,o){const n=await Aa(t,e,3);let r,l=0;r=a.nVars>1<<20?new io:[];for(let t=0;t<a.nVars;t++){i&&t%1e4==0&&i.info(`${o}: Loading map: ${t}/${a.nVars}`);const e=c();r.push(e)}return r;function c(){const t=n.slice(l,l+8);l+=8;const e=new DataView(t.buffer),a=e.getUint32(0,!0);return 4294967296*e.getUint32(4,!0)+a}}(r,l,c,o,n)),await r.close(),c}const ro=He.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),lo=He.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");function co(t,e){if(e instanceof Uint8Array)return t.toString(e);if(Array.isArray(e))return e.map(co.bind(null,t));if("object"==typeof e){const a={};return Object.keys(e).forEach((i=>{a[i]=co(t,e[i])})),a}return"bigint"==typeof e||void 0!==e.eq?e.toString(10):e}var so=Object.freeze({__proto__:null,print:function(t,e,a){for(let e=0;e<t.constraints.length;e++)i(t.constraints[e]);function i(i){const o=a=>{let i="";return Object.keys(a).forEach((o=>{let n=e.varIdx2Name[o];"one"==n&&(n="");let r=t.curve.Fr.toString(a[o]);"1"==r&&(r=""),"-1"==r&&(r="-"),""!=i&&"-"!=r[0]&&(r="+"+r),""!=i&&(r=" "+r),i=i+r+n})),i},n=`[ ${o(i[0])} ] * [ ${o(i[1])} ] - [ ${o(i[2])} ] = 0`;a&&a.info(n)}},info:async function(t,e){const a=await no(t);return He.eq(a.prime,lo)?e&&e.info("Curve: bn-128"):He.eq(a.prime,ro)?e&&e.info("Curve: bls12-381"):e&&e.info(`Unknown Curve. Prime: ${He.toString(a.prime)}`),e&&e.info(`# of Wires: ${a.nVars}`),e&&e.info(`# of Constraints: ${a.nConstraints}`),e&&e.info(`# of Private Inputs: ${a.nPrvInputs}`),e&&e.info(`# of Public Inputs: ${a.nPubInputs}`),e&&e.info(`# of Labels: ${a.nLabels}`),e&&e.info(`# of Outputs: ${a.nOutputs}`),a},exportJson:async function(t,e){const a=await no(t,!0,!0,!0,e),i=a.curve.Fr;return delete a.curve,co(i,a)}});async function uo(t){const e={labelIdx2Name:["one"],varIdx2Name:["one"],componentIdx2Name:[]},a=await da(t),i=await a.read(a.totalSize),o=new TextDecoder("utf-8").decode(i).split("\\n");for(let t=0;t<o.length;t++){const a=o[t].split(",");4==a.length&&(e.varIdx2Name[a[1]]?e.varIdx2Name[a[1]]+="|"+a[3]:e.varIdx2Name[a[1]]=a[3],e.labelIdx2Name[a[0]]=a[3],e.componentIdx2Name[a[2]]||(e.componentIdx2Name[a[2]]=n(a[3])))}return await a.close(),e;function n(t){const e=t.split(".");return e.pop(),e.join(".")}}var go=Object.freeze({__proto__:null,calculate:Gi,debug:async function(t,e,a,i,o,n){const r=await da(e),l=await r.read(r.totalSize);await r.close();let c={sanityCheck:!0},s=await uo(i);o.set&&(s||(s=await uo(i)),c.logSetSignal=function(t,e){n&&n.info("SET "+s.labelIdx2Name[t]+" <-- "+e.toString())}),o.get&&(s||(s=await uo(i)),c.logGetSignal=function(t,e){n&&n.info("GET "+s.labelIdx2Name[t]+" --\\x3e "+e.toString())}),o.trigger&&(s||(s=await uo(i)),c.logStartComponent=function(t){n&&n.info("START: "+s.componentIdx2Name[t])},c.logFinishComponent=function(t){n&&n.info("FINISH: "+s.componentIdx2Name[t])}),c.sym=s;const d=await Ei(l,c),u=await d.calculateWitness(t),g=await ga(a,"wtns",2,2);await async function(t,e,a){await fa(t,1);const i=8*(Math.floor((He.bitLength(a)-1)/64)+1);await t.writeULE32(i),await ma(t,a,i),await t.writeULE32(e.length),await _a(t),await fa(t,2);for(let a=0;a<e.length;a++)await ma(t,e[a],i);await _a(t)}(g,u,d.prime),await g.close()},exportJson:async function(t){return await async function(t){const{fd:e,sections:a}=await ua(t,"wtns",2),{n8:i,nWitness:o}=await yi(e,a);await pa(e,a,2);const n=[];for(let t=0;t<o;t++){const t=await La(e,i);n.push(t)}return await ha(e),await e.close(),n}(t)}});const fo=262144,_o={get:function(t,e){return isNaN(e)?t[e]:t.getElement(e)},set:function(t,e,a){return isNaN(e)?(t[e]=a,!0):t.setElement(e,a)}};class po{constructor(t){this.length=t||0,this.arr=new Array(fo);for(let e=0;e<t;e+=fo)this.arr[e/fo]=new Array(Math.min(fo,t-e));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,e){const a=new Array(e-t);for(let i=t;i<e;i++)a[i-t]=this.getElement(i);return a}getElement(t){t=parseInt(t);const e=Math.floor(t/fo),a=t%fo;return this.arr[e]?this.arr[e][a]:void 0}setElement(t,e){t=parseInt(t);const a=Math.floor(t/fo);this.arr[a]||(this.arr[a]=new Array(fo));const i=t%fo;return this.arr[a][i]=e,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new ho;for(let e=0;e<this.arr.length;e++)if(this.arr[e])for(let a=0;a<this.arr[e].length;a++)void 0!==this.arr[e][a]&&t.push(e*fo+a);return t}}class ho{constructor(t){const e=new po(t);return new Proxy(e,_o)}}async function mo(t,e,a,i){await Wa.ready();const o=Wa(64),{fd:n,sections:r}=await ua(e,"ptau",1),{curve:l,power:c}=await Ti(n,r),{fd:s,sections:d}=await ua(t,"r1cs",1),u=await oo(s,d,!1),g=await ga(a,"zkey",1,10,1<<22,1<<24),f=2*l.G1.F.n8,_=2*l.G2.F.n8;if(u.prime!=l.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;const p=ei(u.nConstraints+u.nPubInputs+u.nOutputs+1-1)+1;if(p>c)return i&&i.error(`circuit too big for this power of tau ceremony. ${u.nConstraints}*2 > 2**${c}`),-1;if(!r[12])return i&&i.error("Powers of tau is not prepared."),-1;const h=u.nOutputs+u.nPubInputs,m=2**p;await fa(g,1),await g.writeULE32(1),await _a(g),await fa(g,2);const L=l.q,w=8*(Math.floor((He.bitLength(L)-1)/64)+1),A=l.r,b=8*(Math.floor((He.bitLength(A)-1)/64)+1),y=He.mod(He.shl(1,8*b),A),I=l.Fr.e(He.mod(He.mul(y,y),A));let C,F,x;await g.writeULE32(w),await ma(g,L,w),await g.writeULE32(b),await ma(g,A,b),await g.writeULE32(u.nVars),await g.writeULE32(h),await g.writeULE32(m),C=await n.read(f,r[4][0].p),await g.write(C),C=await l.G1.batchLEMtoU(C),o.update(C),F=await n.read(f,r[5][0].p),await g.write(F),F=await l.G1.batchLEMtoU(F),o.update(F),x=await n.read(_,r[6][0].p),await g.write(x),x=await l.G2.batchLEMtoU(x),o.update(x);const v=new Uint8Array(f);l.G1.toRprLEM(v,0,l.G1.g);const E=new Uint8Array(_);l.G2.toRprLEM(E,0,l.G2.g);const B=new Uint8Array(f);l.G1.toRprUncompressed(B,0,l.G1.g);const S=new Uint8Array(_);l.G2.toRprUncompressed(S,0,l.G2.g),await g.write(E),await g.write(v),await g.write(E),o.update(S),o.update(B),o.update(S),await _a(g),i&&i.info("Reading r1cs");let G=await Aa(s,d,2);const P=new ho(u.nVars),O=new ho(u.nVars),U=new ho(u.nVars),z=new ho(u.nVars-h-1),q=new Array(h+1);i&&i.info("Reading tauG1");let Q=await Aa(n,r,12,(m-1)*f,m*f);i&&i.info("Reading tauG2");let M=await Aa(n,r,13,(m-1)*_,m*_);i&&i.info("Reading alphatauG1");let k=await Aa(n,r,14,(m-1)*f,m*f);i&&i.info("Reading betatauG1");let T=await Aa(n,r,15,(m-1)*f,m*f);await async function(){const t=new Uint8Array(12+l.Fr.n8),e=new DataView(t.buffer),a=new Uint8Array(l.Fr.n8);l.Fr.toRprLE(a,0,l.Fr.e(1));let o=0;function n(){const t=G.slice(o,o+4);o+=4;return new DataView(t.buffer).getUint32(0,!0)}const r=new ho;for(let t=0;t<u.nConstraints;t++){i&&t%1e4==0&&i.debug(`processing constraints: ${t}/${u.nConstraints}`);const e=n();for(let a=0;a<e;a++){const e=n(),a=o;o+=l.Fr.n8;const i=0,c=f*t,s=3,d=f*t;void 0===P[e]&&(P[e]=[]),P[e].push([i,c,a]),e<=h?(void 0===q[e]&&(q[e]=[]),q[e].push([s,d,a])):(void 0===z[e-h-1]&&(z[e-h-1]=[]),z[e-h-1].push([s,d,a])),r.push([0,t,e,a])}const a=n();for(let e=0;e<a;e++){const e=n(),a=o;o+=l.Fr.n8;const i=0,c=f*t,s=1,d=_*t,u=2,g=f*t;void 0===O[e]&&(O[e]=[]),O[e].push([i,c,a]),void 0===U[e]&&(U[e]=[]),U[e].push([s,d,a]),e<=h?(void 0===q[e]&&(q[e]=[]),q[e].push([u,g,a])):(void 0===z[e-h-1]&&(z[e-h-1]=[]),z[e-h-1].push([u,g,a])),r.push([1,t,e,a])}const c=n();for(let e=0;e<c;e++){const e=n(),a=o;o+=l.Fr.n8;const i=0,r=f*t;e<=h?(void 0===q[e]&&(q[e]=[]),q[e].push([i,r,a])):(void 0===z[e-h-1]&&(z[e-h-1]=[]),z[e-h-1].push([i,r,a]))}}for(let t=0;t<=h;t++){const e=0,a=f*(u.nConstraints+t),i=3,o=f*(u.nConstraints+t);void 0===P[t]&&(P[t]=[]),P[t].push([e,a,-1]),void 0===q[t]&&(q[t]=[]),q[t].push([i,o,-1]),r.push([0,u.nConstraints+t,t,-1])}await fa(g,4);const c=new fe(r.length*(12+l.Fr.n8)+4),s=new Uint8Array(4);new DataView(s.buffer).setUint32(0,r.length,!0),c.set(s);let d=4;for(let t=0;t<r.length;t++)i&&t%1e5==0&&i.debug(`writing coeffs: ${t}/${r.length}`),p(r[t]);function p(i){let o;e.setUint32(0,i[0],!0),e.setUint32(4,i[1],!0),e.setUint32(8,i[2],!0),o=i[3]>=0?l.Fr.fromRprLE(G.slice(i[3],i[3]+l.Fr.n8),0):l.Fr.fromRprLE(a,0);const n=l.Fr.mul(o,I);l.Fr.toRprLE(t,12,n),c.set(t,d),d+=t.length}await g.write(c),await _a(g)}(),await N(3,"G1",q,"IC"),await async function(){await fa(g,9);const t=new fe(m*f);if(p<l.Fr.s){let e=await Aa(n,r,12,(2*m-1)*f,2*m*f);for(let a=0;a<m;a++){i&&a%1e4==0&&i.debug(`spliting buffer: ${a}/${m}`);const o=e.slice((2*a+1)*f,(2*a+1)*f+f);t.set(o,a*f)}}else{if(p!=l.Fr.s)throw i&&i.error("Circuit too big"),new Error("Circuit too big for this curve");{const e=r[12][0].p+(2**(p+1)-1)*f;await n.readToBuffer(t,0,m*f,e+m*f)}}await g.write(t),await _a(g)}(),await async function(){j(m-1);for(let t=0;t<m-1;t+=16384){i&&i.debug(`HashingHPoints: ${t}/${m}`);const e=Math.min(m-1,16384);await K(t,e)}}(),await N(8,"G1",z,"C"),await N(5,"G1",P,"A"),await N(6,"G1",O,"B1"),await N(7,"G2",U,"B2");const R=o.digest();return await fa(g,10),await g.write(R),await g.writeULE32(0),await _a(g),i&&i.info(ai(R,"Circuit hash: ")),await g.close(),await s.close(),await n.close(),R;async function N(t,e,a,n){const r=l[e];j(a.length),await fa(g,t);let c=[],s=0;for(;s<a.length;){let t=0;for(;s<a.length&&t<l.tm.concurrency;){i&&i.debug(`Writing points start ${n}: ${s}/${a.length}`);let o=1,r=a[s]?a[s].length:0;for(;s+o<a.length&&r+(a[s+o]?a[s+o].length:0)<32768&&o<32768;)r+=a[s+o]?a[s+o].length:0,o++;const l=a.slice(s,s+o),d=s;c.push(D(e,l,i,n).then((t=>(i&&i.debug(`Writing points end ${n}: ${d}/${a.length}`),t)))),s+=o,t++}const d=await Promise.all(c);for(let t=0;t<d.length;t++){await g.write(d[t][0]);const e=await r.batchLEMtoU(d[t][0]);o.update(e)}c=[]}await _a(g)}async function D(t,e,a,i){const o=l[t],n=2*o.F.n8,r=3*o.F.n8,c=2*o.F.n8;let s,d,u,g;if("G1"==t)s="g1m_timesScalarAffine",d="g1m_multiexpAffine",u="g1m_batchToAffine",g="g1m_zero";else{if("G2"!=t)throw new Error("Invalid group");s="g2m_timesScalarAffine",d="g2m_multiexpAffine",u="g2m_batchToAffine",g="g2m_zero"}let f,_,p=0;for(let t=0;t<e.length;t++)p+=e[t]?e[t].length:0;p>32768?(f=new fe(p*n),_=new fe(p*l.Fr.n8)):(f=new Uint8Array(p*n),_=new Uint8Array(p*l.Fr.n8));let h=0,m=0;const L=[Q,M,k,T],w=new Uint8Array(l.Fr.n8);l.Fr.toRprLE(w,0,l.Fr.e(1));let A=0;for(let t=0;t<e.length;t++)if(e[t])for(let o=0;o<e[t].length;o++)a&&o&&o%1e4==0&&a.debug(`Configuring big array ${i}: ${o}/${e[t].length}`),f.set(L[e[t][o][0]].slice(e[t][o][1],e[t][o][1]+n),A*n),e[t][o][2]>=0?_.set(G.slice(e[t][o][2],e[t][o][2]+l.Fr.n8),A*l.Fr.n8):_.set(w,A*l.Fr.n8),A++;if(e.length>1){const t=[];t.push({cmd:"ALLOCSET",var:0,buff:f}),t.push({cmd:"ALLOCSET",var:1,buff:_}),t.push({cmd:"ALLOC",var:2,len:e.length*r}),h=0,m=0;let a=0;for(let i=0;i<e.length;i++)e[i]?(1==e[i].length?t.push({cmd:"CALL",fnName:s,params:[{var:0,offset:h},{var:1,offset:m},{val:l.Fr.n8},{var:2,offset:a}]}):t.push({cmd:"CALL",fnName:d,params:[{var:0,offset:h},{var:1,offset:m},{val:l.Fr.n8},{val:e[i].length},{var:2,offset:a}]}),h+=n*e[i].length,m+=l.Fr.n8*e[i].length,a+=r):(t.push({cmd:"CALL",fnName:g,params:[{var:2,offset:a}]}),a+=r);t.push({cmd:"CALL",fnName:u,params:[{var:2},{val:e.length},{var:2}]}),t.push({cmd:"GET",out:0,var:2,len:e.length*c});return await l.tm.queueAction(t)}{let t=await o.multiExpAffine(f,_,a,i);return t=[o.toAffine(t)],t}}async function K(t,e){const a=await n.read(e*f,r[2][0].p+(t+m)*f),i=await n.read(e*f,r[2][0].p+t*f),c=l.tm.concurrency,s=Math.floor(e/c),d=[];for(let t=0;t<c;t++){let o;if(o=t<c-1?s:e-t*s,0==o)continue;const n=a.slice(t*s*f,(t*s+o)*f),r=i.slice(t*s*f,(t*s+o)*f);d.push(V(n,r))}const u=await Promise.all(d);for(let t=0;t<u.length;t++)o.update(u[t][0])}async function V(t,e){const a=t.byteLength/f,i=3*l.G1.F.n8,o=[];o.push({cmd:"ALLOCSET",var:0,buff:t}),o.push({cmd:"ALLOCSET",var:1,buff:e}),o.push({cmd:"ALLOC",var:2,len:a*i});for(let t=0;t<a;t++)o.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:t*f},{var:1,offset:t*f},{var:2,offset:t*i}]});o.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:a},{var:2}]}),o.push({cmd:"CALL",fnName:"g1m_batchLEMtoU",params:[{var:2},{val:a},{var:2}]}),o.push({cmd:"GET",out:0,var:2,len:a*f});return await l.tm.queueAction(o)}function j(t){const e=new Uint8Array(4);new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(0,t,!1),o.update(e)}}const Lo=ni;async function wo(t,e,a,i){let o;await Wa.ready();const{fd:n,sections:r}=await ua(a,"zkey",2),l=await pi(n,r,!1);if("groth16"!=l.protocol)throw new Error("zkey file is not groth16");const c=await Ca(l.q),s=2*c.G1.F.n8,d=await mi(n,c,r),u=Wa(64);u.update(d.csHash);let g=c.G1.g;for(let t=0;t<d.contributions.length;t++){const e=d.contributions[t],a=oi(u);if(Ai(a,c,e.delta.g1_s),Ai(a,c,e.delta.g1_sx),!ii(a.digest(),e.transcript))return console.log(`INVALID(${t}): Inconsistent transcript `),!1;const i=zi(c,e.transcript);if(o=await Lo(c,e.delta.g1_s,e.delta.g1_sx,i,e.delta.g2_spx),!0!==o)return console.log(`INVALID(${t}): public key G1 and G2 do not have the same ration `),!1;if(o=await Lo(c,g,e.deltaAfter,i,e.delta.g2_spx),!0!==o)return console.log(`INVALID(${t}): deltaAfter does not fillow the public key `),!1;if(1==e.type){const a=li(e.beaconHash,e.numIterationsExp),i=c.Fr.fromRng(a),o=c.G1.toAffine(c.G1.fromRng(a)),n=c.G1.toAffine(c.G1.timesFr(o,i));if(!0!==c.G1.eq(o,e.delta.g1_s))return console.log(`INVALID(${t}): Key of the beacon does not match. g1_s `),!1;if(!0!==c.G1.eq(n,e.delta.g1_sx))return console.log(`INVALID(${t}): Key of the beacon does not match. g1_sx `),!1}bi(u,c,e);const n=Wa(64);bi(n,c,e),e.contributionHash=n.digest(),g=e.deltaAfter}const{fd:f,sections:_}=await ua(t,"zkey",2),p=await pi(f,_,!1);if("groth16"!=p.protocol)throw new Error("zkeyinit file is not groth16");if(!He.eq(p.q,l.q)||!He.eq(p.r,l.r)||p.n8q!=l.n8q||p.n8r!=l.n8r)return i&&i.error("INVALID:  Different curves"),!1;if(p.nVars!=l.nVars||p.nPublic!=l.nPublic||p.domainSize!=l.domainSize)return i&&i.error("INVALID:  Different circuit parameters"),!1;if(!c.G1.eq(l.vk_alpha_1,p.vk_alpha_1))return i&&i.error("INVALID:  Invalid alpha1"),!1;if(!c.G1.eq(l.vk_beta_1,p.vk_beta_1))return i&&i.error("INVALID:  Invalid beta1"),!1;if(!c.G2.eq(l.vk_beta_2,p.vk_beta_2))return i&&i.error("INVALID:  Invalid beta2"),!1;if(!c.G2.eq(l.vk_gamma_2,p.vk_gamma_2))return i&&i.error("INVALID:  Invalid gamma2"),!1;if(!c.G1.eq(l.vk_delta_1,g))return i&&i.error("INVALID:  Invalid delta1"),!1;if(o=await Lo(c,c.G1.g,g,c.G2.g,l.vk_delta_2),!0!==o)return i&&i.error("INVALID:  Invalid delta2"),!1;const h=await mi(f,c,_);if(!ii(d.csHash,h.csHash))return i&&i.error("INVALID:  Circuit does not match"),!1;if(r[8][0].size!=s*(l.nVars-l.nPublic-1))return i&&i.error("INVALID:  Invalid L section size"),!1;if(r[9][0].size!=s*l.domainSize)return i&&i.error("INVALID:  Invalid H section size"),!1;let m;if(m=await ba(n,r,f,_,3),!m)return i&&i.error("INVALID:  IC section is not identical"),!1;if(m=await ba(n,r,f,_,4),!m)return i&&i.error("Coeffs section is not identical"),!1;if(m=await ba(n,r,f,_,5),!m)return i&&i.error("A section is not identical"),!1;if(m=await ba(n,r,f,_,6),!m)return i&&i.error("B1 section is not identical"),!1;if(m=await ba(n,r,f,_,7),!m)return i&&i.error("B2 section is not identical"),!1;if(o=await async function(t,e,a,n,r,l,s,d,u){const g=1<<20,f=c[t],_=2*f.F.n8;await pa(e,a,l),await pa(n,r,l);let p=f.zero,h=f.zero;const m=a[l][0].size/_;for(let t=0;t<m;t+=g){i&&i.debug(`Same ratio check ${u}:  ${t}/${m}`);const a=Math.min(m-t,g),o=await e.read(a*_),r=await n.read(a*_),l=new Uint8Array(4*a);wt.randomFillSync(l);const c=await f.multiExpAffine(o,l),s=await f.multiExpAffine(r,l);p=f.add(p,c),h=f.add(h,s)}return await ha(e),await ha(n),0==m||(o=await Lo(c,p,h,s,d),!0===o)}("G1",f,_,n,r,8,l.vk_delta_2,p.vk_delta_2,"L section"),!0!==o)return i&&i.error("L section does not match"),!1;if(o=await async function(){const t=1<<20,a=c.G1,s=c.Fr,d=2*a.F.n8,{fd:u,sections:g}=await ua(e,"ptau",1);let f=new fe(l.domainSize*l.n8r);const _=new Array(8);for(let t=0;t<8;t++)_[t]=wt.randomBytes(4).readUInt32BE(0,!0);const h=new Lt(_);for(let t=0;t<l.domainSize-1;t++){const e=s.fromRng(h);s.toRprLE(f,t*l.n8r,e)}s.toRprLE(f,(l.domainSize-1)*l.n8r,s.zero);let m,w=a.zero;for(let e=0;e<l.domainSize;e+=t){i&&i.debug(`H Verificaition(tau):  ${e}/${l.domainSize}`);const o=Math.min(l.domainSize-e,t),n=await u.read(d*o,g[2][0].p+l.domainSize*d+e*d),r=await u.read(d*o,g[2][0].p+e*d),c=await L(n,r),s=f.slice(e*l.n8r,(e+o)*l.n8r),_=await a.multiExpAffine(c,s);w=a.add(w,_)}if(f=await s.batchToMontgomery(f),l.power<s.s)m=s.neg(s.e(2));else{const t=2**s.s,e=s.exp(s.shift,t);m=s.sub(e,s.one)}const A=l.power<s.s?s.w[l.power+1]:s.shift;f=await s.batchApplyKey(f,m,A),f=await s.fft(f),f=await s.batchFromMontgomery(f),await pa(n,r,9);let b=a.zero;for(let e=0;e<l.domainSize;e+=t){i&&i.debug(`H Verificaition(lagrange):  ${e}/${l.domainSize}`);const o=Math.min(l.domainSize-e,t),r=await n.read(d*o),c=f.slice(e*l.n8r,(e+o)*l.n8r),s=await a.multiExpAffine(r,c);b=a.add(b,s)}return await ha(n),o=await Lo(c,w,b,l.vk_delta_2,p.vk_delta_2),!0===o}(),!0!==o)return i&&i.error("H section does not match"),!1;i&&i.info(ai(d.csHash,"Circuit Hash: ")),await n.close(),await f.close();for(let t=d.contributions.length-1;t>=0;t--){const e=d.contributions[t];i&&i.info("-------------------------"),i&&i.info(ai(e.contributionHash,`contribution #${t+1} ${e.name?e.name:""}:`)),1==e.type&&(i&&i.info(`Beacon generator: ${si(e.beaconHash)}`),i&&i.info(`Beacon iterations Exp: ${e.numIterationsExp}`))}return i&&i.info("-------------------------"),i&&i.info("ZKey Ok!"),!0;async function L(t,e){const a=2*c.G1.F.n8,i=t.byteLength/a,o=c.tm.concurrency,n=Math.floor(i/o),r=[];for(let a=0;a<o;a++){let l;if(l=a<o-1?n:i-a*n,0==l)continue;const c=t.slice(a*n*s,(a*n+l)*s),d=e.slice(a*n*s,(a*n+l)*s);r.push(w(c,d))}const l=await Promise.all(r),d=new Uint8Array(i*a);let u=0;for(let t=0;t<l.length;t++)d.set(l[t][0],u),u+=l[t][0].byteLength;return d}async function w(t,e){const a=2*c.G1.F.n8,i=3*c.G1.F.n8,o=t.byteLength/a,n=[];n.push({cmd:"ALLOCSET",var:0,buff:t}),n.push({cmd:"ALLOCSET",var:1,buff:e}),n.push({cmd:"ALLOC",var:2,len:o*i});for(let t=0;t<o;t++)n.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:t*a},{var:1,offset:t*a},{var:2,offset:t*i}]});n.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:o},{var:2}]}),n.push({cmd:"GET",out:0,var:2,len:o*a});return await c.tm.queueAction(n)}}const{stringifyBigInts:Ao}=$e;async function bo(t){const{fd:e,sections:a}=await ua(t,"zkey",2),i=await pi(e,a);let o;if("groth16"==i.protocol)o=await async function(t,e,a){const i=await Ca(t.q),o=2*i.G1.F.n8,n=await i.pairing(t.vk_alpha_1,t.vk_beta_2);let r={protocol:t.protocol,curve:i.name,nPublic:t.nPublic,vk_alpha_1:i.G1.toObject(t.vk_alpha_1),vk_beta_2:i.G2.toObject(t.vk_beta_2),vk_gamma_2:i.G2.toObject(t.vk_gamma_2),vk_delta_2:i.G2.toObject(t.vk_delta_2),vk_alphabeta_12:i.Gt.toObject(n)};await pa(e,a,3),r.IC=[];for(let a=0;a<=t.nPublic;a++){const t=await e.read(o),a=i.G1.toObject(t);r.IC.push(a)}return await ha(e),r=Ao(r),r}(i,e,a);else{if("plonk"!=i.protocol)throw new Error("zkey file is not groth16");o=await async function(t){const e=await Ca(t.q);let a={protocol:t.protocol,curve:e.name,nPublic:t.nPublic,power:t.power,k1:e.Fr.toObject(t.k1),k2:e.Fr.toObject(t.k2),Qm:e.G1.toObject(t.Qm),Ql:e.G1.toObject(t.Ql),Qr:e.G1.toObject(t.Qr),Qo:e.G1.toObject(t.Qo),Qc:e.G1.toObject(t.Qc),S1:e.G1.toObject(t.S1),S2:e.G1.toObject(t.S2),S3:e.G1.toObject(t.S3),X_2:e.G2.toObject(t.X_2),w:e.Fr.toObject(e.Fr.w[t.power])};return a=Ao(a),a}(i)}return await e.close(),o}var yo={};var Io=Object.freeze({__proto__:null,newZKey:mo,exportBellman:async function(t,e,a){const{fd:i,sections:o}=await ua(t,"zkey",2),n=await pi(i,o);if("groth16"!=n.protocol)throw new Error("zkey file is not groth16");const r=await Ca(n.q),l=2*r.G1.F.n8,c=2*r.G2.F.n8,s=await mi(i,r,o),d=await sa(e);let u;await L(n.vk_alpha_1),await L(n.vk_beta_1),await w(n.vk_beta_2),await w(n.vk_gamma_2),await L(n.vk_delta_1),await w(n.vk_delta_2),u=await Aa(i,o,3),u=await r.G1.batchLEMtoU(u),await A("G1",u);const g=await Aa(i,o,9);let f,_,p,h,m;f=await r.G1.fft(g,"affine","jacobian",a),f=await r.G1.batchApplyKey(f,r.Fr.neg(r.Fr.e(2)),r.Fr.w[n.power+1],"jacobian","affine",a),f=f.slice(0,f.byteLength-l),f=await r.G1.batchLEMtoU(f),await A("G1",f),_=await Aa(i,o,8),_=await r.G1.batchLEMtoU(_),await A("G1",_),p=await Aa(i,o,5),p=await r.G1.batchLEMtoU(p),await A("G1",p),h=await Aa(i,o,6),h=await r.G1.batchLEMtoU(h),await A("G1",h),m=await Aa(i,o,7),m=await r.G2.batchLEMtoU(m),await A("G2",m),await d.write(s.csHash),await async function(t){const e=new Uint8Array(4);new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(0,t,!1),await d.write(e)}(s.contributions.length);for(let t=0;t<s.contributions.length;t++){const e=s.contributions[t];await L(e.deltaAfter),await L(e.delta.g1_s),await L(e.delta.g1_sx),await w(e.delta.g2_spx),await d.write(e.transcript)}async function L(t){const e=new Uint8Array(l);r.G1.toRprUncompressed(e,0,t),await d.write(e)}async function w(t){const e=new Uint8Array(c);r.G2.toRprUncompressed(e,0,t),await d.write(e)}async function A(t,e){let a;a="G1"==t?l:c;const i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,e.byteLength/a,!1),await d.write(i),await d.write(e)}await i.close(),await d.close()},importBellman:async function(t,e,a,i,o){const{fd:n,sections:r}=await ua(t,"zkey",2),l=await pi(n,r,!1);if("groth16"!=l.protocol)throw new Error("zkey file is not groth16");const c=await Ca(l.q),s=2*c.G1.F.n8,d=2*c.G2.F.n8,u=await mi(n,c,r),g={},f=await da(e);f.pos=3*s+3*d+8+s*l.nVars+4+s*(l.domainSize-1)+4+s*l.nVars+4+s*l.nVars+4+d*l.nVars,g.csHash=await f.read(64);const _=await f.readUBE32();g.contributions=[];for(let t=0;t<_;t++){const e={delta:{}};e.deltaAfter=await y(f),e.delta.g1_s=await y(f),e.delta.g1_sx=await y(f),e.delta.g2_spx=await I(f),e.transcript=await f.read(64),t<u.contributions.length&&(e.type=u.contributions[t].type,1==e.type&&(e.beaconHash=u.contributions[t].beaconHash,e.numIterationsExp=u.contributions[t].numIterationsExp),u.contributions[t].name&&(e.name=u.contributions[t].name)),g.contributions.push(e)}if(!ii(g.csHash,u.csHash))return o&&o.error("Hash of the original circuit does not match with the MPC one"),!1;if(u.contributions.length>g.contributions.length)return o&&o.error("The impoerted file does not include new contributions"),!1;for(let t=0;t<u.contributions.length;t++)if(!C(u.contributions[t],g.contributions[t]))return o&&o.error(`Previos contribution ${t} does not match`),!1;if(i)for(let t=u.contributions.length;t<g.contributions.length;t++)g.contributions[t].name=i;const p=await ga(a,"zkey",1,10);if(f.pos=0,f.pos+=s,f.pos+=s,f.pos+=d,f.pos+=d,l.vk_delta_1=await y(f),l.vk_delta_2=await I(f),await di(p,l),await f.readUBE32()!=l.nPublic+1)return o&&o.error("Invalid number of points in IC"),await p.discard(),!1;if(f.pos+=s*(l.nPublic+1),await wa(n,r,p,3),await wa(n,r,p,4),await f.readUBE32()!=l.domainSize-1)return o&&o.error("Invalid number of points in H"),await p.discard(),!1;let h;const m=await f.read(s*(l.domainSize-1)),L=await c.G1.batchUtoLEM(m);h=new Uint8Array(l.domainSize*s),h.set(L),c.G1.toRprLEM(h,s*(l.domainSize-1),c.G1.zeroAffine);const w=c.Fr.neg(c.Fr.inv(c.Fr.e(2))),A=c.Fr.inv(c.Fr.w[l.power+1]);if(h=await c.G1.batchApplyKey(h,w,A,"affine","jacobian",o),h=await c.G1.ifft(h,"jacobian","affine",o),await fa(p,9),await p.write(h),await _a(p),await f.readUBE32()!=l.nVars-l.nPublic-1)return o&&o.error("Invalid number of points in L"),await p.discard(),!1;let b;return b=await f.read(s*(l.nVars-l.nPublic-1)),b=await c.G1.batchUtoLEM(b),await fa(p,8),await p.write(b),await _a(p),await f.readUBE32()!=l.nVars?(o&&o.error("Invalid number of points in A"),await p.discard(),!1):(f.pos+=s*l.nVars,await wa(n,r,p,5),await f.readUBE32()!=l.nVars?(o&&o.error("Invalid number of points in B1"),await p.discard(),!1):(f.pos+=s*l.nVars,await wa(n,r,p,6),await f.readUBE32()!=l.nVars?(o&&o.error("Invalid number of points in B2"),await p.discard(),!1):(f.pos+=d*l.nVars,await wa(n,r,p,7),await wi(p,c,g),await f.close(),await p.close(),await n.close(),!0)));async function y(t){const e=await t.read(2*c.G1.F.n8);return c.G1.fromRprUncompressed(e,0)}async function I(t){const e=await t.read(2*c.G2.F.n8);return c.G2.fromRprUncompressed(e,0)}function C(t,e){return!!c.G1.eq(t.deltaAfter,e.deltaAfter)&&(!!c.G1.eq(t.delta.g1_s,e.delta.g1_s)&&(!!c.G1.eq(t.delta.g1_sx,e.delta.g1_sx)&&(!!c.G2.eq(t.delta.g2_spx,e.delta.g2_spx)&&!!ii(t.transcript,e.transcript))))}},verifyFromR1cs:async function(t,e,a,i){const o={type:"bigMem"};return await mo(t,e,o,i),await wo(o,e,a,i)},verifyFromInit:wo,contribute:async function(t,e,a,i,o){await Wa.ready();const{fd:n,sections:r}=await ua(t,"zkey",2),l=await pi(n,r);if("groth16"!=l.protocol)throw new Error("zkey file is not groth16");const c=await Ca(l.q),s=await mi(n,c,r),d=await ga(e,"zkey",1,10),u=await ri(i),g=Wa(64);g.update(s.csHash);for(let t=0;t<s.contributions.length;t++)bi(g,c,s.contributions[t]);const f={delta:{}};f.delta.prvKey=c.Fr.fromRng(u),f.delta.g1_s=c.G1.toAffine(c.G1.fromRng(u)),f.delta.g1_sx=c.G1.toAffine(c.G1.timesFr(f.delta.g1_s,f.delta.prvKey)),Ai(g,c,f.delta.g1_s),Ai(g,c,f.delta.g1_sx),f.transcript=g.digest(),f.delta.g2_sp=zi(c,f.transcript),f.delta.g2_spx=c.G2.toAffine(c.G2.timesFr(f.delta.g2_sp,f.delta.prvKey)),l.vk_delta_1=c.G1.timesFr(l.vk_delta_1,f.delta.prvKey),l.vk_delta_2=c.G2.timesFr(l.vk_delta_2,f.delta.prvKey),f.deltaAfter=l.vk_delta_1,f.type=0,a&&(f.name=a),s.contributions.push(f),await di(d,l),await wa(n,r,d,3),await wa(n,r,d,4),await wa(n,r,d,5),await wa(n,r,d,6),await wa(n,r,d,7);const _=c.Fr.inv(f.delta.prvKey);await Ji(n,r,d,8,c,"G1",_,c.Fr.e(1),"L Section",o),await Ji(n,r,d,9,c,"G1",_,c.Fr.e(1),"H Section",o),await wi(d,c,s),await n.close(),await d.close();const p=Wa(64);bi(p,c,f);const h=p.digest();return o&&o.info(ai(s.csHash,"Circuit Hash: ")),o&&o.info(ai(h,"Contribution Hash: ")),h},beacon:async function(t,e,a,i,o,n){await Wa.ready();const r=ci(i);if(0==r.byteLength||2*r.byteLength!=i.length)return n&&n.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(r.length>=256)return n&&n.error("Maximum lenght of beacon hash is 255 bytes"),!1;if((o=parseInt(o))<10||o>63)return n&&n.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;const{fd:l,sections:c}=await ua(t,"zkey",2),s=await pi(l,c);if("groth16"!=s.protocol)throw new Error("zkey file is not groth16");const d=await Ca(s.q),u=await mi(l,d,c),g=await ga(e,"zkey",1,10),f=await li(r,o),_=Wa(64);_.update(u.csHash);for(let t=0;t<u.contributions.length;t++)bi(_,d,u.contributions[t]);const p={delta:{}};p.delta.prvKey=d.Fr.fromRng(f),p.delta.g1_s=d.G1.toAffine(d.G1.fromRng(f)),p.delta.g1_sx=d.G1.toAffine(d.G1.timesFr(p.delta.g1_s,p.delta.prvKey)),Ai(_,d,p.delta.g1_s),Ai(_,d,p.delta.g1_sx),p.transcript=_.digest(),p.delta.g2_sp=zi(d,p.transcript),p.delta.g2_spx=d.G2.toAffine(d.G2.timesFr(p.delta.g2_sp,p.delta.prvKey)),s.vk_delta_1=d.G1.timesFr(s.vk_delta_1,p.delta.prvKey),s.vk_delta_2=d.G2.timesFr(s.vk_delta_2,p.delta.prvKey),p.deltaAfter=s.vk_delta_1,p.type=1,p.numIterationsExp=o,p.beaconHash=r,a&&(p.name=a),u.contributions.push(p),await di(g,s),await wa(l,c,g,3),await wa(l,c,g,4),await wa(l,c,g,5),await wa(l,c,g,6),await wa(l,c,g,7);const h=d.Fr.inv(p.delta.prvKey);await Ji(l,c,g,8,d,"G1",h,d.Fr.e(1),"L Section",n),await Ji(l,c,g,9,d,"G1",h,d.Fr.e(1),"H Section",n),await wi(g,d,u),await l.close(),await g.close();const m=Wa(64);bi(m,d,p);const L=m.digest();return n&&n.info(ai(L,"Contribution Hash: ")),L},exportJson:async function(t){const e=await async function(t,e){const{fd:a,sections:i}=await ua(t,"zkey",1),o=await pi(a,i,"groth16"),n=new vt(o.r),r=He.mod(He.shl(1,8*o.n8r),o.r),l=n.inv(r),c=n.mul(l,l);let s=await Ca(o.q);await pa(a,i,3),o.IC=[];for(let t=0;t<=o.nPublic;t++){const t=await fi(a,s,e);o.IC.push(t)}await ha(a),await pa(a,i,4);const d=await a.readULE32();o.ccoefs=[];for(let t=0;t<d;t++){const t=await a.readULE32(),e=await a.readULE32(),i=await a.readULE32(),n=await u();o.ccoefs.push({matrix:t,constraint:e,signal:i,value:n})}await ha(a),await pa(a,i,5),o.A=[];for(let t=0;t<o.nVars;t++){const i=await fi(a,s,e);o.A[t]=i}await ha(a),await pa(a,i,6),o.B1=[];for(let t=0;t<o.nVars;t++){const i=await fi(a,s,e);o.B1[t]=i}await ha(a),await pa(a,i,7),o.B2=[];for(let t=0;t<o.nVars;t++){const i=await _i(a,s,e);o.B2[t]=i}await ha(a),await pa(a,i,8),o.C=[];for(let t=o.nPublic+1;t<o.nVars;t++){const i=await fi(a,s,e);o.C[t]=i}await ha(a),await pa(a,i,9),o.hExps=[];for(let t=0;t<o.domainSize;t++){const t=await fi(a,s,e);o.hExps.push(t)}return await ha(a),await a.close(),o;async function u(){const t=await La(a,o.n8r);return n.mul(t,c)}}(t,!0);return e},bellmanContribute:async function(t,e,a,i,o){await Wa.ready();const n=await ri(i),r=t.Fr.fromRng(n),l=t.Fr.inv(r),c=2*t.G1.F.n8,s=2*t.G2.F.n8,d=await da(e),u=await sa(a);await E(c),await E(c),await E(s),await E(s);const g=await B(),f=t.G1.timesFr(g,r);await G(f);const _=await S(),p=t.G2.timesFr(_,r);await P(p);const h=await d.readUBE32();await u.writeUBE32(h),await E(h*c);const m=await d.readUBE32();await u.writeUBE32(m),await Wi(d,u,null,t,"G1",m,l,t.Fr.e(1),"UNCOMPRESSED","H",o);const L=await d.readUBE32();await u.writeUBE32(L),await Wi(d,u,null,t,"G1",L,l,t.Fr.e(1),"UNCOMPRESSED","L",o);const w=await d.readUBE32();await u.writeUBE32(w),await E(w*c);const A=await d.readUBE32();await u.writeUBE32(A),await E(A*c);const b=await d.readUBE32();await u.writeUBE32(b),await E(b*s);const y=Wa(64),I={};I.csHash=await d.read(64),y.update(I.csHash);const C=await d.readUBE32();I.contributions=[];for(let e=0;e<C;e++){const e={delta:{}};e.deltaAfter=await B(),e.delta.g1_s=await B(),e.delta.g1_sx=await B(),e.delta.g2_spx=await S(),e.transcript=await d.read(64),I.contributions.push(e),bi(y,t,e)}const F={delta:{}};F.delta.prvKey=r,F.delta.g1_s=t.G1.toAffine(t.G1.fromRng(n)),F.delta.g1_sx=t.G1.toAffine(t.G1.timesFr(F.delta.g1_s,r)),Ai(y,t,F.delta.g1_s),Ai(y,t,F.delta.g1_sx),F.transcript=y.digest(),F.delta.g2_sp=zi(t,F.transcript),F.delta.g2_spx=t.G2.toAffine(t.G2.timesFr(F.delta.g2_sp,r)),F.deltaAfter=f,F.type=0,I.contributions.push(F),await u.write(I.csHash),await u.writeUBE32(I.contributions.length);for(let t=0;t<I.contributions.length;t++){const e=I.contributions[t];await G(e.deltaAfter),await G(e.delta.g1_s),await G(e.delta.g1_sx),await P(e.delta.g2_spx),await u.write(e.transcript)}const x=Wa(64);bi(x,t,F);const v=x.digest();return o&&o.info(ai(v,"Contribution Hash: ")),await u.close(),await d.close(),v;async function E(t){const e=2*d.pageSize;for(let a=0;a<t;a+=e){const i=Math.min(t-a,e),o=await d.read(i);await u.write(o)}}async function B(){const e=await d.read(2*t.G1.F.n8);return t.G1.fromRprUncompressed(e,0)}async function S(){const e=await d.read(2*t.G2.F.n8);return t.G2.fromRprUncompressed(e,0)}async function G(e){const a=new Uint8Array(c);t.G1.toRprUncompressed(a,0,e),await u.write(a)}async function P(e){const a=new Uint8Array(s);t.G2.toRprUncompressed(a,0,e),await u.write(a)}},exportVerificationKey:bo,exportSolidityVerifier:async function(t,e,a){const i=await bo(t);let o=e[i.protocol];return yo.render(o,i)}});\n/**\n     * [js-sha3]{@link https://github.com/emn178/js-sha3}\n     *\n     * @version 0.8.0\n     * @author Chen, Yi-Cyuan [emn178@gmail.com]\n     * @copyright Chen, Yi-Cyuan 2015-2018\n     * @license MIT\n     */\nvar Co=d((function(t){!function(){var e="input is invalid type",a="object"==typeof window,i=a?window:{};i.JS_SHA3_NO_WINDOW&&(a=!1);var o=!a&&"object"==typeof self;!i.JS_SHA3_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node?i=s:o&&(i=self);var n=!i.JS_SHA3_NO_COMMON_JS&&t.exports,r=!i.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,l="0123456789abcdef".split(""),c=[4,1024,262144,67108864],d=[0,8,16,24],u=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],g=[224,256,384,512],f=[128,256],_=["hex","buffer","arrayBuffer","array","digest"],p={128:168,256:136};!i.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!r||!i.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});for(var h=function(t,e,a){return function(i){return new G(t,e,t).update(i)[a]()}},m=function(t,e,a){return function(i,o){return new G(t,e,o).update(i)[a]()}},L=function(t,e,a){return function(e,i,o,n){return I["cshake"+t].update(e,i,o,n)[a]()}},w=function(t,e,a){return function(e,i,o,n){return I["kmac"+t].update(e,i,o,n)[a]()}},A=function(t,e,a,i){for(var o=0;o<_.length;++o){var n=_[o];t[n]=e(a,i,n)}return t},b=function(t,e){var a=h(t,e,"hex");return a.create=function(){return new G(t,e,t)},a.update=function(t){return a.create().update(t)},A(a,h,t,e)},y=[{name:"keccak",padding:[1,256,65536,16777216],bits:g,createMethod:b},{name:"sha3",padding:[6,1536,393216,100663296],bits:g,createMethod:b},{name:"shake",padding:[31,7936,2031616,520093696],bits:f,createMethod:function(t,e){var a=m(t,e,"hex");return a.create=function(a){return new G(t,e,a)},a.update=function(t,e){return a.create(e).update(t)},A(a,m,t,e)}},{name:"cshake",padding:c,bits:f,createMethod:function(t,e){var a=p[t],i=L(t,0,"hex");return i.create=function(i,o,n){return o||n?new G(t,e,i).bytepad([o,n],a):I["shake"+t].create(i)},i.update=function(t,e,a,o){return i.create(e,a,o).update(t)},A(i,L,t,e)}},{name:"kmac",padding:c,bits:f,createMethod:function(t,e){var a=p[t],i=w(t,0,"hex");return i.create=function(i,o,n){return new P(t,e,o).bytepad(["KMAC",n],a).bytepad([i],a)},i.update=function(t,e,a,o){return i.create(t,a,o).update(e)},A(i,w,t,e)}}],I={},C=[],F=0;F<y.length;++F)for(var x=y[F],v=x.bits,E=0;E<v.length;++E){var B=x.name+"_"+v[E];if(C.push(B),I[B]=x.createMethod(v[E],x.padding),"sha3"!==x.name){var S=x.name+v[E];C.push(S),I[S]=I[B]}}function G(t,e,a){this.blocks=[],this.s=[],this.padding=e,this.outputBits=a,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=a>>5,this.extraBytes=(31&a)>>3;for(var i=0;i<50;++i)this.s[i]=0}function P(t,e,a){G.call(this,t,e,a)}G.prototype.update=function(t){if(this.finalized)throw new Error("finalize already called");var a,i=typeof t;if("string"!==i){if("object"!==i)throw new Error(e);if(null===t)throw new Error(e);if(r&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||r&&ArrayBuffer.isView(t)))throw new Error(e);a=!0}for(var o,n,l=this.blocks,c=this.byteCount,s=t.length,u=this.blockCount,g=0,f=this.s;g<s;){if(this.reset)for(this.reset=!1,l[0]=this.block,o=1;o<u+1;++o)l[o]=0;if(a)for(o=this.start;g<s&&o<c;++g)l[o>>2]|=t[g]<<d[3&o++];else for(o=this.start;g<s&&o<c;++g)(n=t.charCodeAt(g))<128?l[o>>2]|=n<<d[3&o++]:n<2048?(l[o>>2]|=(192|n>>6)<<d[3&o++],l[o>>2]|=(128|63&n)<<d[3&o++]):n<55296||n>=57344?(l[o>>2]|=(224|n>>12)<<d[3&o++],l[o>>2]|=(128|n>>6&63)<<d[3&o++],l[o>>2]|=(128|63&n)<<d[3&o++]):(n=65536+((1023&n)<<10|1023&t.charCodeAt(++g)),l[o>>2]|=(240|n>>18)<<d[3&o++],l[o>>2]|=(128|n>>12&63)<<d[3&o++],l[o>>2]|=(128|n>>6&63)<<d[3&o++],l[o>>2]|=(128|63&n)<<d[3&o++]);if(this.lastByteIndex=o,o>=c){for(this.start=o-c,this.block=l[u],o=0;o<u;++o)f[o]^=l[o];O(f),this.reset=!0}else this.start=o}return this},G.prototype.encode=function(t,e){var a=255&t,i=1,o=[a];for(a=255&(t>>=8);a>0;)o.unshift(a),a=255&(t>>=8),++i;return e?o.push(i):o.unshift(i),this.update(o),o.length},G.prototype.encodeString=function(t){var a,i=typeof t;if("string"!==i){if("object"!==i)throw new Error(e);if(null===t)throw new Error(e);if(r&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||r&&ArrayBuffer.isView(t)))throw new Error(e);a=!0}var o=0,n=t.length;if(a)o=n;else for(var l=0;l<t.length;++l){var c=t.charCodeAt(l);c<128?o+=1:c<2048?o+=2:c<55296||c>=57344?o+=3:(c=65536+((1023&c)<<10|1023&t.charCodeAt(++l)),o+=4)}return o+=this.encode(8*o),this.update(t),o},G.prototype.bytepad=function(t,e){for(var a=this.encode(e),i=0;i<t.length;++i)a+=this.encodeString(t[i]);var o=e-a%e,n=[];return n.length=o,this.update(n),this},G.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex,a=this.blockCount,i=this.s;if(t[e>>2]|=this.padding[3&e],this.lastByteIndex===this.byteCount)for(t[0]=t[a],e=1;e<a+1;++e)t[e]=0;for(t[a-1]|=2147483648,e=0;e<a;++e)i[e]^=t[e];O(i)}},G.prototype.toString=G.prototype.hex=function(){this.finalize();for(var t,e=this.blockCount,a=this.s,i=this.outputBlocks,o=this.extraBytes,n=0,r=0,c="";r<i;){for(n=0;n<e&&r<i;++n,++r)t=a[n],c+=l[t>>4&15]+l[15&t]+l[t>>12&15]+l[t>>8&15]+l[t>>20&15]+l[t>>16&15]+l[t>>28&15]+l[t>>24&15];r%e==0&&(O(a),n=0)}return o&&(t=a[n],c+=l[t>>4&15]+l[15&t],o>1&&(c+=l[t>>12&15]+l[t>>8&15]),o>2&&(c+=l[t>>20&15]+l[t>>16&15])),c},G.prototype.arrayBuffer=function(){this.finalize();var t,e=this.blockCount,a=this.s,i=this.outputBlocks,o=this.extraBytes,n=0,r=0,l=this.outputBits>>3;t=o?new ArrayBuffer(i+1<<2):new ArrayBuffer(l);for(var c=new Uint32Array(t);r<i;){for(n=0;n<e&&r<i;++n,++r)c[r]=a[n];r%e==0&&O(a)}return o&&(c[n]=a[n],t=t.slice(0,l)),t},G.prototype.buffer=G.prototype.arrayBuffer,G.prototype.digest=G.prototype.array=function(){this.finalize();for(var t,e,a=this.blockCount,i=this.s,o=this.outputBlocks,n=this.extraBytes,r=0,l=0,c=[];l<o;){for(r=0;r<a&&l<o;++r,++l)t=l<<2,e=i[r],c[t]=255&e,c[t+1]=e>>8&255,c[t+2]=e>>16&255,c[t+3]=e>>24&255;l%a==0&&O(i)}return n&&(t=l<<2,e=i[r],c[t]=255&e,n>1&&(c[t+1]=e>>8&255),n>2&&(c[t+2]=e>>16&255)),c},P.prototype=new G,P.prototype.finalize=function(){return this.encode(this.outputBits,!0),G.prototype.finalize.call(this)};var O=function(t){var e,a,i,o,n,r,l,c,s,d,g,f,_,p,h,m,L,w,A,b,y,I,C,F,x,v,E,B,S,G,P,O,U,z,q,Q,M,k,T,R,N,D,K,V,j,H,$,Z,Y,J,W,X,tt,et,at,it,ot,nt,rt,lt,ct,st,dt;for(i=0;i<48;i+=2)o=t[0]^t[10]^t[20]^t[30]^t[40],n=t[1]^t[11]^t[21]^t[31]^t[41],r=t[2]^t[12]^t[22]^t[32]^t[42],l=t[3]^t[13]^t[23]^t[33]^t[43],c=t[4]^t[14]^t[24]^t[34]^t[44],s=t[5]^t[15]^t[25]^t[35]^t[45],d=t[6]^t[16]^t[26]^t[36]^t[46],g=t[7]^t[17]^t[27]^t[37]^t[47],e=(f=t[8]^t[18]^t[28]^t[38]^t[48])^(r<<1|l>>>31),a=(_=t[9]^t[19]^t[29]^t[39]^t[49])^(l<<1|r>>>31),t[0]^=e,t[1]^=a,t[10]^=e,t[11]^=a,t[20]^=e,t[21]^=a,t[30]^=e,t[31]^=a,t[40]^=e,t[41]^=a,e=o^(c<<1|s>>>31),a=n^(s<<1|c>>>31),t[2]^=e,t[3]^=a,t[12]^=e,t[13]^=a,t[22]^=e,t[23]^=a,t[32]^=e,t[33]^=a,t[42]^=e,t[43]^=a,e=r^(d<<1|g>>>31),a=l^(g<<1|d>>>31),t[4]^=e,t[5]^=a,t[14]^=e,t[15]^=a,t[24]^=e,t[25]^=a,t[34]^=e,t[35]^=a,t[44]^=e,t[45]^=a,e=c^(f<<1|_>>>31),a=s^(_<<1|f>>>31),t[6]^=e,t[7]^=a,t[16]^=e,t[17]^=a,t[26]^=e,t[27]^=a,t[36]^=e,t[37]^=a,t[46]^=e,t[47]^=a,e=d^(o<<1|n>>>31),a=g^(n<<1|o>>>31),t[8]^=e,t[9]^=a,t[18]^=e,t[19]^=a,t[28]^=e,t[29]^=a,t[38]^=e,t[39]^=a,t[48]^=e,t[49]^=a,p=t[0],h=t[1],H=t[11]<<4|t[10]>>>28,$=t[10]<<4|t[11]>>>28,B=t[20]<<3|t[21]>>>29,S=t[21]<<3|t[20]>>>29,lt=t[31]<<9|t[30]>>>23,ct=t[30]<<9|t[31]>>>23,D=t[40]<<18|t[41]>>>14,K=t[41]<<18|t[40]>>>14,z=t[2]<<1|t[3]>>>31,q=t[3]<<1|t[2]>>>31,m=t[13]<<12|t[12]>>>20,L=t[12]<<12|t[13]>>>20,Z=t[22]<<10|t[23]>>>22,Y=t[23]<<10|t[22]>>>22,G=t[33]<<13|t[32]>>>19,P=t[32]<<13|t[33]>>>19,st=t[42]<<2|t[43]>>>30,dt=t[43]<<2|t[42]>>>30,et=t[5]<<30|t[4]>>>2,at=t[4]<<30|t[5]>>>2,Q=t[14]<<6|t[15]>>>26,M=t[15]<<6|t[14]>>>26,w=t[25]<<11|t[24]>>>21,A=t[24]<<11|t[25]>>>21,J=t[34]<<15|t[35]>>>17,W=t[35]<<15|t[34]>>>17,O=t[45]<<29|t[44]>>>3,U=t[44]<<29|t[45]>>>3,F=t[6]<<28|t[7]>>>4,x=t[7]<<28|t[6]>>>4,it=t[17]<<23|t[16]>>>9,ot=t[16]<<23|t[17]>>>9,k=t[26]<<25|t[27]>>>7,T=t[27]<<25|t[26]>>>7,b=t[36]<<21|t[37]>>>11,y=t[37]<<21|t[36]>>>11,X=t[47]<<24|t[46]>>>8,tt=t[46]<<24|t[47]>>>8,V=t[8]<<27|t[9]>>>5,j=t[9]<<27|t[8]>>>5,v=t[18]<<20|t[19]>>>12,E=t[19]<<20|t[18]>>>12,nt=t[29]<<7|t[28]>>>25,rt=t[28]<<7|t[29]>>>25,R=t[38]<<8|t[39]>>>24,N=t[39]<<8|t[38]>>>24,I=t[48]<<14|t[49]>>>18,C=t[49]<<14|t[48]>>>18,t[0]=p^~m&w,t[1]=h^~L&A,t[10]=F^~v&B,t[11]=x^~E&S,t[20]=z^~Q&k,t[21]=q^~M&T,t[30]=V^~H&Z,t[31]=j^~$&Y,t[40]=et^~it&nt,t[41]=at^~ot&rt,t[2]=m^~w&b,t[3]=L^~A&y,t[12]=v^~B&G,t[13]=E^~S&P,t[22]=Q^~k&R,t[23]=M^~T&N,t[32]=H^~Z&J,t[33]=$^~Y&W,t[42]=it^~nt&lt,t[43]=ot^~rt&ct,t[4]=w^~b&I,t[5]=A^~y&C,t[14]=B^~G&O,t[15]=S^~P&U,t[24]=k^~R&D,t[25]=T^~N&K,t[34]=Z^~J&X,t[35]=Y^~W&tt,t[44]=nt^~lt&st,t[45]=rt^~ct&dt,t[6]=b^~I&p,t[7]=y^~C&h,t[16]=G^~O&F,t[17]=P^~U&x,t[26]=R^~D&z,t[27]=N^~K&q,t[36]=J^~X&V,t[37]=W^~tt&j,t[46]=lt^~st&et,t[47]=ct^~dt&at,t[8]=I^~p&m,t[9]=C^~h&L,t[18]=O^~F&v,t[19]=U^~x&E,t[28]=D^~z&Q,t[29]=K^~q&M,t[38]=X^~V&H,t[39]=tt^~j&$,t[48]=st^~et&it,t[49]=dt^~at&ot,t[0]^=u[i],t[1]^=u[i+1]};if(n)t.exports=I;else for(F=0;F<C.length;++F)i[C[F]]=I[C[F]]}()}));const{stringifyBigInts:Fo}=$e,{keccak256:xo}=Co;async function vo(t,e,a){const{fd:i,sections:o}=await ua(e,"wtns",2),n=await yi(i,o),{fd:r,sections:l}=await ua(t,"zkey",2),c=await pi(r,l);if("plonk"!=c.protocol)throw new Error("zkey file is not plonk");if(!He.eq(c.r,n.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(n.nWitness!=c.nVars-c.nAdditions)throw new Error(`Invalid witness length. Circuit: ${c.nVars}, witness: ${n.nWitness}, ${c.nAdditions}`);const s=await Ca(c.q),d=s.Fr,u=s.G1,g=s.Fr.n8;a&&a.debug("Reading Wtns");const f=await Aa(i,o,2);f.set(d.zero,0);const _=new fe(g*c.nAdditions);let p,h,m,L,w,A,b,y,I,C,F,x,v,E;await async function(){const t=await Aa(r,l,3),e=8+2*s.Fr.n8;for(let a=0;a<c.nAdditions;a++){const i=Q(t,a*e),o=Q(t,a*e+4),n=t.slice(a*e+8,a*e+8+g),r=t.slice(a*e+8+g,a*e+8+2*g),l=M(i),c=M(o),d=s.Fr.add(s.Fr.mul(n,l),s.Fr.mul(r,c));_.set(d,g*a)}}();let B={};const S=new fe(c.domainSize*g*4*3);let G=l[12][0].p+c.domainSize*g;await r.readToBuffer(S,0,c.domainSize*g*4,G),G+=c.domainSize*g*5,await r.readToBuffer(S,c.domainSize*g*4,c.domainSize*g*4,G),G+=c.domainSize*g*5,await r.readToBuffer(S,c.domainSize*g*8,c.domainSize*g*4,G);const P=new fe(c.domainSize*g);await r.readToBuffer(P,0,c.domainSize*g,l[12][0].p);const O=new fe(c.domainSize*g);await r.readToBuffer(O,0,c.domainSize*g,l[12][0].p+5*c.domainSize*g);const U=await Aa(r,l,14),z={};await async function(){z.b=[];for(let t=1;t<=9;t++)z.b[t]=s.Fr.random();[p,h,m]=await async function(){let t=new fe(c.domainSize*g),e=new fe(c.domainSize*g),a=new fe(c.domainSize*g);const i=await Aa(r,l,4),o=await Aa(r,l,5),n=await Aa(r,l,6);for(let r=0;r<c.nConstrains;r++){const l=Q(i,4*r);t.set(M(l),r*g);const c=Q(o,4*r);e.set(M(c),r*g);const s=Q(n,4*r);a.set(M(s),r*g)}return t=await d.batchToMontgomery(t),e=await d.batchToMontgomery(e),a=await d.batchToMontgomery(a),[t,e,a]}(),[I,w]=await D(p,[z.b[2],z.b[1]]),[C,A]=await D(h,[z.b[4],z.b[3]]),[F,b]=await D(m,[z.b[6],z.b[5]]),B.A=await N(I,"multiexp A"),B.B=await N(C,"multiexp B"),B.C=await N(F,"multiexp C")}(),await async function(){const t=new Uint8Array(c.nPublic*g+2*u.F.n8*3);for(let e=0;e<c.nPublic;e++)d.toRprBE(t,e*g,p.slice(e*g,(e+1)*g));u.toRprUncompressed(t,c.nPublic*g+0,B.A),u.toRprUncompressed(t,c.nPublic*g+2*u.F.n8,B.B),u.toRprUncompressed(t,c.nPublic*g+4*u.F.n8,B.C),z.beta=k(t),a&&a.debug("beta: "+d.toString(z.beta));const e=new Uint8Array(g);d.toRprBE(e,0,z.beta),z.gamma=k(e),a&&a.debug("gamma: "+d.toString(z.gamma));let i=new fe(d.n8*c.domainSize),o=new fe(d.n8*c.domainSize);i.set(d.one,0),o.set(d.one,0);let n=d.one;for(let t=0;t<c.domainSize;t++){let e=p.slice(t*g,(t+1)*g);e=d.add(e,d.mul(z.beta,n)),e=d.add(e,z.gamma);let a=h.slice(t*g,(t+1)*g);a=d.add(a,d.mul(c.k1,d.mul(z.beta,n))),a=d.add(a,z.gamma);let r=m.slice(t*g,(t+1)*g);r=d.add(r,d.mul(c.k2,d.mul(z.beta,n))),r=d.add(r,z.gamma);const l=d.mul(e,d.mul(a,r));let s=p.slice(t*g,(t+1)*g);s=d.add(s,d.mul(S.slice(t*g*4,t*g*4+g),z.beta)),s=d.add(s,z.gamma);let u=h.slice(t*g,(t+1)*g);u=d.add(u,d.mul(S.slice(4*(c.domainSize+t)*g,4*(c.domainSize+t)*g+g),z.beta)),u=d.add(u,z.gamma);let f=m.slice(t*g,(t+1)*g);f=d.add(f,d.mul(S.slice(4*(2*c.domainSize+t)*g,4*(2*c.domainSize+t)*g+g),z.beta)),f=d.add(f,z.gamma);const _=d.mul(s,d.mul(u,f));i.set(d.mul(i.slice(t*g,(t+1)*g),l),(t+1)%c.domainSize*g),o.set(d.mul(o.slice(t*g,(t+1)*g),_),(t+1)%c.domainSize*g),n=d.mul(n,d.w[c.power])}o=await d.batchInverse(o);for(let t=0;t<c.domainSize;t++)i.set(d.mul(i.slice(t*g,(t+1)*g),o.slice(t*g,(t+1)*g)),t*g);if(!d.eq(i.slice(0,g),d.one))throw new Error("Copy constraints does not match");L=i,[x,y]=await D(L,[z.b[9],z.b[8],z.b[7]]),B.Z=await N(x,"multiexp Z")}(),await async function(){a&&a.debug("phse3: Reading QM4");const t=new fe(4*c.domainSize*g);await r.readToBuffer(t,0,c.domainSize*g*4,l[7][0].p+c.domainSize*g),a&&a.debug("phse3: Reading QL4");const e=new fe(4*c.domainSize*g);await r.readToBuffer(e,0,c.domainSize*g*4,l[8][0].p+c.domainSize*g),a&&a.debug("phse3: Reading QR4");const i=new fe(4*c.domainSize*g);await r.readToBuffer(i,0,c.domainSize*g*4,l[9][0].p+c.domainSize*g),a&&a.debug("phse3: Reading QO4");const o=new fe(4*c.domainSize*g);await r.readToBuffer(o,0,c.domainSize*g*4,l[10][0].p+c.domainSize*g),a&&a.debug("phse3: Reading QC4");const n=new fe(4*c.domainSize*g);await r.readToBuffer(n,0,c.domainSize*g*4,l[11][0].p+c.domainSize*g);const s=await Aa(r,l,13),f=new Uint8Array(2*u.F.n8);u.toRprUncompressed(f,0,B.Z),z.alpha=k(f),a&&a.debug("alpha: "+d.toString(z.alpha));const _=[d.zero,d.add(d.e(-1),d.w[2]),d.e(-2),d.sub(d.e(-1),d.w[2])],h=[d.zero,d.add(d.zero,d.mul(d.e(-2),d.w[2])),d.e(4),d.sub(d.zero,d.mul(d.e(-2),d.w[2]))],m=[d.zero,d.add(d.e(2),d.mul(d.e(2),d.w[2])),d.e(-8),d.sub(d.e(2),d.mul(d.e(2),d.w[2]))],L=new fe(4*c.domainSize*g),I=new fe(4*c.domainSize*g);let C=d.one;for(let r=0;r<4*c.domainSize;r++){r%4096==0&&a&&a.debug(`calculating t ${r}/${4*c.domainSize}`);const l=w.slice(r*g,r*g+g),u=A.slice(r*g,r*g+g),f=b.slice(r*g,r*g+g),_=y.slice(r*g,r*g+g),h=y.slice((r+4*c.domainSize+4)%(4*c.domainSize)*g,(r+4*c.domainSize+4)%(4*c.domainSize)*g+g),m=t.slice(r*g,r*g+g),F=e.slice(r*g,r*g+g),x=i.slice(r*g,r*g+g),v=o.slice(r*g,r*g+g),B=n.slice(r*g,r*g+g),P=S.slice(r*g,r*g+g),O=S.slice((r+4*c.domainSize)*g,(r+4*c.domainSize)*g+g),U=S.slice((r+8*c.domainSize)*g,(r+8*c.domainSize)*g+g),q=d.add(z.b[2],d.mul(z.b[1],C)),Q=d.add(z.b[4],d.mul(z.b[3],C)),M=d.add(z.b[6],d.mul(z.b[5],C)),k=d.square(C),T=d.add(d.add(d.mul(z.b[7],k),d.mul(z.b[8],C)),z.b[9]),R=d.mul(C,d.w[c.power]),N=d.square(R),D=d.add(d.add(d.mul(z.b[7],N),d.mul(z.b[8],R)),z.b[9]);let K=d.zero;for(let t=0;t<c.nPublic;t++)K=d.sub(K,d.mul(s.slice((5*t*c.domainSize+c.domainSize+r)*g,(5*t*c.domainSize+c.domainSize+r+1)*g),p.slice(t*g,(t+1)*g)));let[V,j]=E(l,u,q,Q,r%4);V=d.mul(V,m),j=d.mul(j,m),V=d.add(V,d.mul(l,F)),j=d.add(j,d.mul(q,F)),V=d.add(V,d.mul(u,x)),j=d.add(j,d.mul(Q,x)),V=d.add(V,d.mul(f,v)),j=d.add(j,d.mul(M,v)),V=d.add(V,K),V=d.add(V,B);const H=d.mul(z.beta,C);let $=l;$=d.add($,H),$=d.add($,z.gamma);let Z=u;Z=d.add(Z,d.mul(H,c.k1)),Z=d.add(Z,z.gamma);let Y=f;Y=d.add(Y,d.mul(H,c.k2)),Y=d.add(Y,z.gamma);let J=_,[W,X]=G($,Z,Y,J,q,Q,M,T,r%4);W=d.mul(W,z.alpha),X=d.mul(X,z.alpha);let tt=l;tt=d.add(tt,d.mul(z.beta,P)),tt=d.add(tt,z.gamma);let et=u;et=d.add(et,d.mul(z.beta,O)),et=d.add(et,z.gamma);let at=f;at=d.add(at,d.mul(z.beta,U)),at=d.add(at,z.gamma);let it=h,[ot,nt]=G(tt,et,at,it,q,Q,M,D,r%4);ot=d.mul(ot,z.alpha),nt=d.mul(nt,z.alpha);let rt=d.sub(_,d.one);rt=d.mul(rt,s.slice((c.domainSize+r)*g,(c.domainSize+r+1)*g)),rt=d.mul(rt,d.mul(z.alpha,z.alpha));let lt=d.mul(T,s.slice((c.domainSize+r)*g,(c.domainSize+r+1)*g));lt=d.mul(lt,d.mul(z.alpha,z.alpha));let ct=d.add(d.sub(d.add(V,W),ot),rt),st=d.add(d.sub(d.add(j,X),nt),lt);L.set(ct,r*g),I.set(st,r*g),C=d.mul(C,d.w[c.power+2])}a&&a.debug("ifft T");let F=await d.ifft(L);a&&a.debug("dividing T/Z");for(let t=0;t<c.domainSize;t++)F.set(d.neg(F.slice(t*g,t*g+g)),t*g);for(let t=c.domainSize;t<4*c.domainSize;t++){const e=d.sub(F.slice((t-c.domainSize)*g,(t-c.domainSize)*g+g),F.slice(t*g,t*g+g));if(F.set(e,t*g),t>3*c.domainSize-4&&!d.isZero(e))throw new Error("T Polynomial is not divisible")}a&&a.debug("ifft Tz");const x=await d.ifft(I);for(let t=0;t<4*c.domainSize;t++){const e=x.slice(t*g,(t+1)*g);if(t>3*c.domainSize+5){if(!d.isZero(e))throw new Error("Tz Polynomial is not well calculated")}else F.set(d.add(F.slice(t*g,(t+1)*g),e),t*g)}function E(t,e,a,i,o){let n,r;const l=d.mul(t,e),c=d.mul(t,i),s=d.mul(a,e);n=l;let u=d.mul(a,i);return r=d.add(c,s),o&&(r=d.add(r,d.mul(_[o],u))),[n,r]}function G(t,e,a,i,o,n,r,l,c){let s,u;const g=d.mul(t,e),f=d.mul(t,n),p=d.mul(o,e),L=d.mul(o,n),w=d.mul(a,i),A=d.mul(a,l),b=d.mul(r,i),y=d.mul(r,l);s=d.mul(g,w);let I=d.mul(p,w);I=d.add(I,d.mul(f,w)),I=d.add(I,d.mul(g,b)),I=d.add(I,d.mul(g,A));let C=d.mul(L,w);C=d.add(C,d.mul(p,b)),C=d.add(C,d.mul(p,A)),C=d.add(C,d.mul(f,b)),C=d.add(C,d.mul(f,A)),C=d.add(C,d.mul(g,y));let F=d.mul(f,y);F=d.add(F,d.mul(p,y)),F=d.add(F,d.mul(L,A)),F=d.add(F,d.mul(L,b));let x=d.mul(L,y);return u=I,c&&(u=d.add(u,d.mul(_[c],C)),u=d.add(u,d.mul(h[c],F)),u=d.add(u,d.mul(m[c],x))),[s,u]}v=F.slice(0,(3*c.domainSize+6)*g),B.T1=await N(F.slice(0,c.domainSize*g),"multiexp T1"),B.T2=await N(F.slice(c.domainSize*g,2*c.domainSize*g),"multiexp T2"),B.T3=await N(F.slice(2*c.domainSize*g,(3*c.domainSize+6)*g),"multiexp T3")}(),await async function(){const t=new fe(c.domainSize*g);await r.readToBuffer(t,0,c.domainSize*g,l[7][0].p);const e=new fe(c.domainSize*g);await r.readToBuffer(e,0,c.domainSize*g,l[8][0].p);const i=new fe(c.domainSize*g);await r.readToBuffer(i,0,c.domainSize*g,l[9][0].p);const o=new fe(c.domainSize*g);await r.readToBuffer(o,0,c.domainSize*g,l[10][0].p);const n=new fe(c.domainSize*g);await r.readToBuffer(n,0,c.domainSize*g,l[11][0].p);const s=new fe(c.domainSize*g);await r.readToBuffer(s,0,c.domainSize*g,l[12][0].p+10*c.domainSize*g);const f=new Uint8Array(2*u.F.n8*3);u.toRprUncompressed(f,0,B.T1),u.toRprUncompressed(f,2*u.F.n8,B.T2),u.toRprUncompressed(f,4*u.F.n8,B.T3),z.xi=k(f),a&&a.debug("xi: "+d.toString(z.xi));B.eval_a=T(I,z.xi),B.eval_b=T(C,z.xi),B.eval_c=T(F,z.xi),B.eval_s1=T(P,z.xi),B.eval_s2=T(O,z.xi),B.eval_t=T(v,z.xi),B.eval_zw=T(x,d.mul(z.xi,d.w[c.power]));const _=d.mul(B.eval_a,B.eval_b);let p=B.eval_a;const h=d.mul(z.beta,z.xi);p=d.add(p,h),p=d.add(p,z.gamma);let m=B.eval_b;m=d.add(m,d.mul(h,c.k1)),m=d.add(m,z.gamma);let L=B.eval_c;L=d.add(L,d.mul(h,c.k2)),L=d.add(L,z.gamma);const w=d.mul(d.mul(d.mul(p,m),L),z.alpha);let A=B.eval_a;A=d.add(A,d.mul(z.beta,B.eval_s1)),A=d.add(A,z.gamma);let b=B.eval_b;b=d.add(b,d.mul(z.beta,B.eval_s2)),b=d.add(b,z.gamma);let y=d.mul(A,b);y=d.mul(y,z.beta),y=d.mul(y,B.eval_zw),y=d.mul(y,z.alpha),z.xim=z.xi;for(let t=0;t<c.power;t++)z.xim=d.mul(z.xim,z.xim);const S=d.div(d.sub(z.xim,d.one),d.mul(d.sub(z.xi,d.one),d.e(c.domainSize))),G=d.mul(S,d.mul(z.alpha,z.alpha)),U=y,q=d.add(w,G);E=new fe((c.domainSize+3)*g);for(let a=0;a<c.domainSize+3;a++){let r=d.mul(q,x.slice(a*g,(a+1)*g));a<c.domainSize&&(r=d.add(r,d.mul(_,t.slice(a*g,(a+1)*g))),r=d.add(r,d.mul(B.eval_a,e.slice(a*g,(a+1)*g))),r=d.add(r,d.mul(B.eval_b,i.slice(a*g,(a+1)*g))),r=d.add(r,d.mul(B.eval_c,o.slice(a*g,(a+1)*g))),r=d.add(r,n.slice(a*g,(a+1)*g)),r=d.sub(r,d.mul(U,s.slice(a*g,(a+1)*g)))),E.set(r,a*g)}B.eval_r=T(E,z.xi)}(),await async function(){const t=new Uint8Array(7*g);d.toRprBE(t,0,B.eval_a),d.toRprBE(t,g,B.eval_b),d.toRprBE(t,2*g,B.eval_c),d.toRprBE(t,3*g,B.eval_s1),d.toRprBE(t,4*g,B.eval_s2),d.toRprBE(t,5*g,B.eval_zw),d.toRprBE(t,6*g,B.eval_r),z.v=[],z.v[1]=k(t),a&&a.debug("v: "+d.toString(z.v[1]));for(let t=2;t<=6;t++)z.v[t]=d.mul(z.v[t-1],z.v[1]);let e=new fe((c.domainSize+6)*g);const i=d.mul(z.xim,z.xim);for(let t=0;t<c.domainSize+6;t++){let a=d.zero;a=d.add(a,d.mul(i,v.slice((2*c.domainSize+t)*g,(2*c.domainSize+t+1)*g))),t<c.domainSize+3&&(a=d.add(a,d.mul(z.v[1],E.slice(t*g,(t+1)*g)))),t<c.domainSize+2&&(a=d.add(a,d.mul(z.v[2],I.slice(t*g,(t+1)*g))),a=d.add(a,d.mul(z.v[3],C.slice(t*g,(t+1)*g))),a=d.add(a,d.mul(z.v[4],F.slice(t*g,(t+1)*g)))),t<c.domainSize&&(a=d.add(a,v.slice(t*g,(t+1)*g)),a=d.add(a,d.mul(z.xim,v.slice((c.domainSize+t)*g,(c.domainSize+t+1)*g))),a=d.add(a,d.mul(z.v[5],P.slice(t*g,(t+1)*g))),a=d.add(a,d.mul(z.v[6],O.slice(t*g,(t+1)*g)))),e.set(a,t*g)}let o=e.slice(0,g);o=d.sub(o,B.eval_t),o=d.sub(o,d.mul(z.v[1],B.eval_r)),o=d.sub(o,d.mul(z.v[2],B.eval_a)),o=d.sub(o,d.mul(z.v[3],B.eval_b)),o=d.sub(o,d.mul(z.v[4],B.eval_c)),o=d.sub(o,d.mul(z.v[5],B.eval_s1)),o=d.sub(o,d.mul(z.v[6],B.eval_s2)),e.set(o,0),e=R(e,z.xi),B.Wxi=await N(e,"multiexp Wxi");let n=new fe((c.domainSize+3)*g);for(let t=0;t<c.domainSize+3;t++){const e=x.slice(t*g,(t+1)*g);n.set(e,t*g)}o=n.slice(0,g),o=d.sub(o,B.eval_zw),n.set(o,0),n=R(n,d.mul(z.xi,d.w[c.power])),B.Wxiw=await N(n,"multiexp Wxiw")}(),B.protocol="plonk",B.curve=s.name,await r.close(),await i.close();let q=[];for(let t=1;t<=c.nPublic;t++){const e=f.slice(t*d.n8,t*d.n8+d.n8);q.push(He.fromRprLE(e))}return B.A=u.toObject(B.A),B.B=u.toObject(B.B),B.C=u.toObject(B.C),B.Z=u.toObject(B.Z),B.T1=u.toObject(B.T1),B.T2=u.toObject(B.T2),B.T3=u.toObject(B.T3),B.eval_a=d.toObject(B.eval_a),B.eval_b=d.toObject(B.eval_b),B.eval_c=d.toObject(B.eval_c),B.eval_s1=d.toObject(B.eval_s1),B.eval_s2=d.toObject(B.eval_s2),B.eval_zw=d.toObject(B.eval_zw),B.eval_t=d.toObject(B.eval_t),B.eval_r=d.toObject(B.eval_r),B.Wxi=u.toObject(B.Wxi),B.Wxiw=u.toObject(B.Wxiw),delete B.eval_t,B=Fo(B),q=Fo(q),{proof:B,publicSignals:q};function Q(t,e){const a=t.slice(e,e+4);return new DataView(a.buffer,a.byteOffset,a.byteLength).getUint32(0,!0)}function M(t){return t<c.nVars-c.nAdditions?f.slice(t*g,t*g+g):t<c.nVars?_.slice((t-(c.nVars-c.nAdditions))*g,(t-(c.nVars-c.nAdditions))*g+g):s.Fr.zero}function k(t){const e=He.fromRprBE(new Uint8Array(xo.arrayBuffer(t)));return d.e(e)}function T(t,e){const a=t.byteLength/g;if(0==a)return d.zero;let i=t.slice((a-1)*g,a*g);for(let o=a-2;o>=0;o--)i=d.add(d.mul(i,e),t.slice(o*g,(o+1)*g));return i}function R(t,e){const a=t.byteLength/g,i=new fe(a*g);i.set(d.zero,(a-1)*g),i.set(t.slice((a-1)*g,a*g),(a-2)*g);for(let o=a-3;o>=0;o--)i.set(d.add(t.slice((o+1)*g,(o+2)*g),d.mul(e,i.slice((o+1)*g,(o+2)*g))),o*g);if(!d.eq(t.slice(0,g),d.mul(d.neg(e),i.slice(0,g))))throw new Error("Polinomial does not divide");return i}async function N(t,e){const i=t.byteLength/g,o=U.slice(0,i*s.G1.F.n8*2),n=await s.Fr.batchFromMontgomery(t);let r=await s.G1.multiExpAffine(o,n,a,e);return r=s.G1.toAffine(r),r}async function D(t,e){e=e||[];let a=await d.ifft(t);const i=new fe(g*c.domainSize*4);i.set(a,0);const o=new fe(g*(c.domainSize+e.length));o.set(a,0);for(let t=0;t<e.length;t++)o.set(d.add(o.slice((c.domainSize+t)*g,(c.domainSize+t+1)*g),e[t]),(c.domainSize+t)*g),o.set(d.sub(o.slice(t*g,(t+1)*g),e[t]),t*g);return[o,await d.fft(i)]}}const{unstringifyBigInts:Eo}=$e,{keccak256:Bo}=Co;function So(t,e){const a=He.fromRprBE(new Uint8Array(Bo.arrayBuffer(e)));return t.Fr.e(a)}function Go(t){return("0"+t.toString(16)).slice(-2)}function Po(t){let e=t.toString(16);for(;e.length<64;)e="0"+e;return e=`"0x${e}"`,e}var Oo=Object.freeze({__proto__:null,setup:async function(t,e,a,i){globalThis.gc&&globalThis.gc(),await Wa.ready();const{fd:o,sections:n}=await ua(e,"ptau",1),{curve:r,power:l}=await Ti(o,n),{fd:c,sections:s}=await ua(t,"r1cs",1),d=await oo(c,s,!1),u=2*r.G1.F.n8,g=r.G1,f=2*r.G2.F.n8,_=r.Fr,p=r.Fr.n8;i&&i.info("Reading r1cs");let h=await Aa(c,s,2);const m=new ho,L=new ho;let w=d.nVars;const A=d.nOutputs+d.nPubInputs;await async function(){let t=0;function e(){const e=h.slice(t,t+4);t+=4;return new DataView(e.buffer).getUint32(0,!0)}function a(){const e=_.fromRprLE(h.slice(t,t+r.Fr.n8));return t+=r.Fr.n8,e}function o(){const t=[],i={k:r.Fr.zero},o=e();for(let n=0;n<o;n++){const o=e(),n=a();0==o?i.k=n:t.push([o,n])}const l=n(t);return i.s=l[0],i.coef=l[1],i}function n(t){if(0==t.length)return[0,r.Fr.zero];if(1==t.length)return t[0];const e=t.slice(0,t.length>>1),a=t.slice(t.length>>1),i=n(e),o=n(a),l=i[0],c=o[0],s=w++,d=r.Fr.zero,u=_.neg(i[1]),g=_.neg(o[1]),f=r.Fr.one,p=r.Fr.zero;return m.push([l,c,s,d,u,g,f,p]),L.push([l,c,i[1],o[1]]),[s,r.Fr.one]}for(let t=1;t<=A;t++){const e=t,a=0,i=0,o=r.Fr.zero,n=r.Fr.one,l=r.Fr.zero,c=r.Fr.zero,s=r.Fr.zero;m.push([e,a,i,o,n,l,c,s])}for(let t=0;t<d.nConstraints;t++){i&&t%1e4==0&&i.debug(`processing constraints: ${t}/${d.nConstraints}`);const e=o(),a=o(),n=o(),l=e.s,c=a.s,s=n.s,u=r.Fr.mul(e.coef,a.coef),g=r.Fr.mul(e.coef,a.k),f=r.Fr.mul(e.k,a.coef),_=r.Fr.neg(n.coef),p=r.Fr.sub(r.Fr.mul(e.k,a.k),n.k);m.push([l,c,s,u,g,f,_,p])}}(),globalThis.gc&&globalThis.gc();const b=await ga(a,"zkey",1,14,1<<22,1<<24);if(d.prime!=r.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;let y=ei(m.length-1)+1;y<3&&(y=3);const I=2**y;if(i&&i.info("Plonk constraints: "+m.length),y>l)return i&&i.error(`circuit too big for this power of tau ceremony. ${m.length} > 2**${l}`),-1;if(!n[12])return i&&i.error("Powers of tau is not prepared."),-1;const C=new fe(I*u),F=n[12][0].p+(2**y-1)*u;await o.readToBuffer(C,0,I*u,F);const[x,v]=function(){let t=_.two;for(;a(t,[],y);)_.add(t,_.one);let e=_.add(t,_.one);for(;a(e,[t],y);)_.add(e,_.one);return[t,e];function a(t,e,a){const i=2**a;let o=_.one;for(let n=0;n<i;n++){if(_.eq(t,o))return!0;for(let a=0;a<e.length;a++)if(_.eq(t,_.mul(e[a],o)))return!0;o=_.mul(o,_.w[a])}return!1}}(),E={};await async function(t,e){await fa(b,t);const a=new Uint8Array(8+2*p),o=new DataView(a.buffer);for(let t=0;t<L.length;t++){const n=L[t];let r=0;o.setUint32(r,n[0],!0),r+=4,o.setUint32(r,n[1],!0),r+=4,a.set(n[2],r),r+=p,a.set(n[3],r),r+=p,await b.write(a),i&&t%1e6==0&&i.debug(`writing ${e}: ${t}/${L.length}`)}await _a(b)}(3,"Additions"),globalThis.gc&&globalThis.gc(),await S(4,0,"Amap"),globalThis.gc&&globalThis.gc(),await S(5,1,"Bmap"),globalThis.gc&&globalThis.gc(),await S(6,2,"Cmap"),globalThis.gc&&globalThis.gc(),await G(7,3,"Qm"),globalThis.gc&&globalThis.gc(),await G(8,4,"Ql"),globalThis.gc&&globalThis.gc(),await G(9,5,"Qr"),globalThis.gc&&globalThis.gc(),await G(10,6,"Qo"),globalThis.gc&&globalThis.gc(),await G(11,7,"Qc"),globalThis.gc&&globalThis.gc(),await async function(t,e){const a=new fe(p*I*3),o=new ho(w),n=new ho(w);let l=_.one;for(let t=0;t<I;t++)t<m.length?(u(m[t][0],t),u(m[t][1],I+t),u(m[t][2],2*I+t)):(u(0,t),u(0,I+t),u(0,2*I+t)),l=_.mul(l,_.w[y]),i&&t%1e6==0&&i.debug(`writing ${e} phase1: ${t}/${m.length}`);for(let t=0;t<w;t++)void 0!==n[t]?a.set(o[t],n[t]*p):console.log("Variable not used"),i&&t%1e6==0&&i.debug(`writing ${e} phase2: ${t}/${w}`);globalThis.gc&&globalThis.gc();await fa(b,t);let c=a.slice(0,I*p);await P(c),globalThis.gc&&globalThis.gc();let s=a.slice(I*p,I*p*2);await P(s),globalThis.gc&&globalThis.gc();let d=a.slice(I*p*2,I*p*3);await P(d),globalThis.gc&&globalThis.gc();await _a(b),c=await _.batchFromMontgomery(c),s=await _.batchFromMontgomery(s),d=await _.batchFromMontgomery(d),E.S1=await r.G1.multiExpAffine(C,c,i,"multiexp S1"),globalThis.gc&&globalThis.gc();E.S2=await r.G1.multiExpAffine(C,s,i,"multiexp S2"),globalThis.gc&&globalThis.gc();E.S3=await r.G1.multiExpAffine(C,d,i,"multiexp S3"),globalThis.gc&&globalThis.gc();function u(t,e){let i;void 0===o[t]?n[t]=e:a.set(o[t],e*p),i=e<I?l:e<2*I?_.mul(l,x):_.mul(l,v),o[t]=i}}(12,"sigma"),globalThis.gc&&globalThis.gc(),await async function(t,e){await fa(b,t);const a=Math.max(A,1);for(let t=0;t<a;t++){let o=new fe(I*p);o.set(_.one,t*p),await P(o),i&&i.debug(`writing ${e} ${t}/${a}`)}await _a(b)}(13,"lagrange polynomials"),globalThis.gc&&globalThis.gc(),await fa(b,14);const B=new fe((I+6)*u);return await o.readToBuffer(B,0,(I+6)*u,n[2][0].p),await b.write(B),await _a(b),globalThis.gc&&globalThis.gc(),await async function(){await fa(b,1),await b.writeULE32(2),await _a(b),await fa(b,2);const t=r.q,e=8*(Math.floor((He.bitLength(t)-1)/64)+1),a=r.r,i=8*(Math.floor((He.bitLength(a)-1)/64)+1);let l;await b.writeULE32(e),await ma(b,t,e),await b.writeULE32(i),await ma(b,a,i),await b.writeULE32(w),await b.writeULE32(A),await b.writeULE32(I),await b.writeULE32(L.length),await b.writeULE32(m.length),await b.write(x),await b.write(v),await b.write(g.toAffine(E.Qm)),await b.write(g.toAffine(E.Ql)),await b.write(g.toAffine(E.Qr)),await b.write(g.toAffine(E.Qo)),await b.write(g.toAffine(E.Qc)),await b.write(g.toAffine(E.S1)),await b.write(g.toAffine(E.S2)),await b.write(g.toAffine(E.S3)),l=await o.read(f,n[3][0].p+f),await b.write(l),await _a(b)}(),await b.close(),await c.close(),await o.close(),void(i&&i.info("Setup Finished"));async function S(t,e,a){await fa(b,t);for(let t=0;t<m.length;t++)await b.writeULE32(m[t][e]),i&&t%1e6==0&&i.debug(`writing ${a}: ${t}/${m.length}`);await _a(b)}async function G(t,e,a){let o=new fe(I*p);for(let t=0;t<m.length;t++)o.set(m[t][e],t*p),i&&t%1e6==0&&i.debug(`writing ${a}: ${t}/${m.length}`);await fa(b,t),await P(o),await _a(b),o=await _.batchFromMontgomery(o),E[a]=await r.G1.multiExpAffine(C,o,i,"multiexp "+a)}async function P(t){const e=await _.ifft(t),a=new fe(I*p*4);a.set(e,0);const i=await _.fft(a);await b.write(e),await b.write(i)}},fullProve:async function(t,e,a,i){const o={type:"mem"};return await Gi(t,e,o),await vo(a,o,i)},prove:vo,verify:async function(t,e,a,i){t=Eo(t),a=Eo(a),e=Eo(e);const o=await Fa(t.curve),n=o.Fr,r=o.G1;if(a=function(t,e){const a=t.G1,i=t.Fr,o={};return o.A=a.fromObject(e.A),o.B=a.fromObject(e.B),o.C=a.fromObject(e.C),o.Z=a.fromObject(e.Z),o.T1=a.fromObject(e.T1),o.T2=a.fromObject(e.T2),o.T3=a.fromObject(e.T3),o.eval_a=i.fromObject(e.eval_a),o.eval_b=i.fromObject(e.eval_b),o.eval_c=i.fromObject(e.eval_c),o.eval_zw=i.fromObject(e.eval_zw),o.eval_s1=i.fromObject(e.eval_s1),o.eval_s2=i.fromObject(e.eval_s2),o.eval_r=i.fromObject(e.eval_r),o.Wxi=a.fromObject(e.Wxi),o.Wxiw=a.fromObject(e.Wxiw),o}(o,a),t=function(t,e){const a=t.G1,i=t.G2,o=t.Fr,n=e;return n.Qm=a.fromObject(e.Qm),n.Ql=a.fromObject(e.Ql),n.Qr=a.fromObject(e.Qr),n.Qo=a.fromObject(e.Qo),n.Qc=a.fromObject(e.Qc),n.S1=a.fromObject(e.S1),n.S2=a.fromObject(e.S2),n.S3=a.fromObject(e.S3),n.k1=o.fromObject(e.k1),n.k2=o.fromObject(e.k2),n.X_2=i.fromObject(e.X_2),n}(o,t),!function(t,e){const a=t.G1;return!!a.isValid(e.A)&&(!!a.isValid(e.B)&&(!!a.isValid(e.C)&&(!!a.isValid(e.Z)&&(!!a.isValid(e.T1)&&(!!a.isValid(e.T2)&&(!!a.isValid(e.T3)&&(!!a.isValid(e.Wxi)&&!!a.isValid(e.Wxiw))))))))}(o,a))return i.error("Proof is not well constructed"),!1;if(e.length!=t.nPublic)return i.error("Invalid number of public inputs"),!1;const l=function(t,e,a){const i=t.G1,o=t.Fr,n=t.Fr.n8,r={},l=new Uint8Array(a.length*n+2*i.F.n8*3);for(let t=0;t<a.length;t++)o.toRprBE(l,t*n,o.e(a[t]));i.toRprUncompressed(l,a.length*n+0,e.A),i.toRprUncompressed(l,a.length*n+2*i.F.n8,e.B),i.toRprUncompressed(l,a.length*n+4*i.F.n8,e.C),r.beta=So(t,l);const c=new Uint8Array(n);o.toRprBE(c,0,r.beta),r.gamma=So(t,c);const s=new Uint8Array(2*i.F.n8);i.toRprUncompressed(s,0,e.Z),r.alpha=So(t,s);const d=new Uint8Array(2*i.F.n8*3);i.toRprUncompressed(d,0,e.T1),i.toRprUncompressed(d,2*i.F.n8,e.T2),i.toRprUncompressed(d,4*i.F.n8,e.T3),r.xi=So(t,d);const u=new Uint8Array(7*n);o.toRprBE(u,0,e.eval_a),o.toRprBE(u,n,e.eval_b),o.toRprBE(u,2*n,e.eval_c),o.toRprBE(u,3*n,e.eval_s1),o.toRprBE(u,4*n,e.eval_s2),o.toRprBE(u,5*n,e.eval_zw),o.toRprBE(u,6*n,e.eval_r),r.v=[],r.v[1]=So(t,u);for(let t=2;t<=6;t++)r.v[t]=o.mul(r.v[t-1],r.v[1]);const g=new Uint8Array(2*i.F.n8*2);return i.toRprUncompressed(g,0,e.Wxi),i.toRprUncompressed(g,2*i.F.n8,e.Wxiw),r.u=So(t,g),r}(o,a,e);i&&(i.debug("beta: "+n.toString(l.beta,16)),i.debug("gamma: "+n.toString(l.gamma,16)),i.debug("alpha: "+n.toString(l.alpha,16)),i.debug("xi: "+n.toString(l.xi,16)),i.debug("v1: "+n.toString(l.v[1],16)),i.debug("v6: "+n.toString(l.v[6],16)),i.debug("u: "+n.toString(l.u,16)));const c=function(t,e,a){const i=t.Fr;let o=e.xi,n=1;for(let t=0;t<a.power;t++)o=i.square(o),n*=2;e.xin=o,e.zh=i.sub(o,i.one);const r=[],l=i.e(n);let c=i.one;for(let t=1;t<=Math.max(1,a.nPublic);t++)r[t]=i.div(i.mul(c,e.zh),i.mul(l,i.sub(e.xi,c))),c=i.mul(c,i.w[a.power]);return r}(o,l,t);if(i){i.debug("Lagrange Evaluations: ");for(let t=1;t<c.length;t++)i.debug(`L${t}(xi)=`+n.toString(c[t],16))}if(e.length!=t.nPublic)return i.error("Number of public signals does not match with vk"),!1;const s=function(t,e,a){const i=t.Fr;let o=i.zero;for(let t=0;t<e.length;t++){const n=i.e(e[t]);o=i.sub(o,i.mul(n,a[t+1]))}return o}(o,e,c);i&&i.debug("Pl: "+n.toString(s,16));const d=function(t,e,a,i,o){const n=t.Fr;let r=e.eval_r;r=n.add(r,i);let l=e.eval_a;l=n.add(l,n.mul(a.beta,e.eval_s1)),l=n.add(l,a.gamma);let c=e.eval_b;c=n.add(c,n.mul(a.beta,e.eval_s2)),c=n.add(c,a.gamma);let s=e.eval_c;s=n.add(s,a.gamma);let d=n.mul(n.mul(l,c),s);d=n.mul(d,e.eval_zw),d=n.mul(d,a.alpha),r=n.sub(r,d),r=n.sub(r,n.mul(o,n.square(a.alpha)));return n.div(r,a.zh)}(o,a,l,s,c[1]);i&&i.debug("t: "+n.toString(d,16));const u=function(t,e,a,i,o){const n=t.G1,r=t.Fr;let l=r.mul(r.mul(e.eval_a,e.eval_b),a.v[1]),c=n.timesFr(i.Qm,l),s=r.mul(e.eval_a,a.v[1]);c=n.add(c,n.timesFr(i.Ql,s));let d=r.mul(e.eval_b,a.v[1]);c=n.add(c,n.timesFr(i.Qr,d));let u=r.mul(e.eval_c,a.v[1]);c=n.add(c,n.timesFr(i.Qo,u)),c=n.add(c,n.timesFr(i.Qc,a.v[1]));const g=r.mul(a.beta,a.xi);let f=e.eval_a;f=r.add(f,g),f=r.add(f,a.gamma);let _=e.eval_b;_=r.add(_,r.mul(g,i.k1)),_=r.add(_,a.gamma);let p=e.eval_c;p=r.add(p,r.mul(g,i.k2)),p=r.add(p,a.gamma);let h=r.mul(r.mul(f,_),p);h=r.mul(h,r.mul(a.alpha,a.v[1]));let m=r.mul(r.mul(o,r.square(a.alpha)),a.v[1]);h=r.add(h,m),h=r.add(h,a.u),c=n.add(c,n.timesFr(e.Z,h));let L=e.eval_a;L=r.add(L,r.mul(a.beta,e.eval_s1)),L=r.add(L,a.gamma);let w=e.eval_b;w=r.add(w,r.mul(a.beta,e.eval_s2)),w=r.add(w,a.gamma);let A=r.mul(L,w);return A=r.mul(A,a.alpha),A=r.mul(A,a.v[1]),A=r.mul(A,a.beta),A=r.mul(A,e.eval_zw),c=n.sub(c,n.timesFr(i.S3,A)),c}(o,a,l,t,c[1]);i&&i.debug("D: "+r.toString(r.toAffine(u),16));const g=function(t,e,a,i,o){const n=t.G1,r=t.Fr;let l=e.T1;return l=n.add(l,n.timesFr(e.T2,a.xin)),l=n.add(l,n.timesFr(e.T3,r.square(a.xin))),l=n.add(l,o),l=n.add(l,n.timesFr(e.A,a.v[2])),l=n.add(l,n.timesFr(e.B,a.v[3])),l=n.add(l,n.timesFr(e.C,a.v[4])),l=n.add(l,n.timesFr(i.S1,a.v[5])),l=n.add(l,n.timesFr(i.S2,a.v[6])),l}(o,a,l,t,u);i&&i.debug("F: "+r.toString(r.toAffine(g),16));const f=function(t,e,a,i,o){const n=t.G1,r=t.Fr;let l=o;l=r.add(l,r.mul(a.v[1],e.eval_r)),l=r.add(l,r.mul(a.v[2],e.eval_a)),l=r.add(l,r.mul(a.v[3],e.eval_b)),l=r.add(l,r.mul(a.v[4],e.eval_c)),l=r.add(l,r.mul(a.v[5],e.eval_s1)),l=r.add(l,r.mul(a.v[6],e.eval_s2)),l=r.add(l,r.mul(a.u,e.eval_zw));return n.timesFr(n.one,l)}(o,a,l,0,d);i&&i.debug("E: "+r.toString(r.toAffine(f),16));const _=await async function(t,e,a,i,o,n){const r=t.G1,l=t.Fr;let c=e.Wxi;c=r.add(c,r.timesFr(e.Wxiw,a.u));let s=r.timesFr(e.Wxi,a.xi);const d=l.mul(l.mul(a.u,a.xi),l.w[i.power]);s=r.add(s,r.timesFr(e.Wxiw,d)),s=r.add(s,n),s=r.sub(s,o);return await t.pairingEq(r.neg(c),i.X_2,s,t.G2.one)}(o,a,l,t,f,g);return i&&(_?i.info("OK!"):i.warn("Invalid Proof")),_},exportSolidityCallData:async function(t,e){const a=await Fa(t.curve),i=a.G1,o=a.Fr;let n="";for(let t=0;t<e.length;t++)""!=n&&(n+=","),n+=Po(e[t]);const r=new Uint8Array(2*i.F.n8*9+7*o.n8);return i.toRprUncompressed(r,0,i.e(t.A)),i.toRprUncompressed(r,2*i.F.n8,i.e(t.B)),i.toRprUncompressed(r,4*i.F.n8,i.e(t.C)),i.toRprUncompressed(r,6*i.F.n8,i.e(t.Z)),i.toRprUncompressed(r,8*i.F.n8,i.e(t.T1)),i.toRprUncompressed(r,10*i.F.n8,i.e(t.T2)),i.toRprUncompressed(r,12*i.F.n8,i.e(t.T3)),i.toRprUncompressed(r,14*i.F.n8,i.e(t.Wxi)),i.toRprUncompressed(r,16*i.F.n8,i.e(t.Wxiw)),o.toRprBE(r,18*i.F.n8,o.e(t.eval_a)),o.toRprBE(r,18*i.F.n8+o.n8,o.e(t.eval_b)),o.toRprBE(r,18*i.F.n8+2*o.n8,o.e(t.eval_c)),o.toRprBE(r,18*i.F.n8+3*o.n8,o.e(t.eval_s1)),o.toRprBE(r,18*i.F.n8+4*o.n8,o.e(t.eval_s2)),o.toRprBE(r,18*i.F.n8+5*o.n8,o.e(t.eval_zw)),o.toRprBE(r,18*i.F.n8+6*o.n8,o.e(t.eval_r)),"0x"+Array.from(r).map(Go).join("")+",["+n+"]"}});return t.groth16=Ui,t.plonk=Oo,t.powersOfTau=Xi,t.r1cs=so,t.wtns=go,t.zKey=Io,Object.defineProperty(t,"__esModule",{value:!0}),t}({});\n',r3=`<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta charset="utf8" />
<title>zkREPL Demo App</title>
<style>
    * {
        box-sizing: border-box;
    }
    body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
            Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    }
    .main {
        padding: 20px;
        margin: 0 auto;
        max-width: 500px;
    }

    .banner {
        background: linear-gradient(#673ab7, #344395);
        color: white;
        padding: 20px;
        border-bottom: 1px solid #e0e0e0;
        text-align: center;
    }

    #proofData {
        width: 100%;
        height: 150px;
        display: block;
        margin-bottom: 10px;
        padding: 10px;
    }

    #publicSignals {
        width: 100%;
        height: 50px;
        display: block;
        margin-bottom: 10px;
        padding: 10px;
    }
    button {
        display: block;
        width: 100%;
        background: #ef8e00;
        border: 0;
        color: white;
        padding: 10px;
        border-radius: 10px;
        font-weight: bold;
        font-size: inherit;
        cursor: pointer;
    }
    #result {
        margin-top: 10px;
    }
</style>

<div class="banner">
    This is a demo application automatically generated by zkREPL.
</div>
<div class="main">
    <h4>Inputs</h4>

    <div>a: <input type="text" id="input_a" value="33" /></div>
    <br />
    <div>b: <input id="input_b" type="text" value="12" /></div>

    <h4>Proof</h4>

    <button onclick="calculateProof()">Generate Proof</button>

    <div id="proof"></div>
    <h4>Verify</h4>
    <textarea
        id="proofData"
        placeholder="Click 'Generate Proof' to generate a proof"
    ></textarea>

    <textarea placeholder="Public signals..." id="publicSignals"></textarea>
    <button onclick="verifyProof()">Verify Proof</button>

    <div id="result"></div>

    <h4>Audit</h4>

    <p>
        Upload the ZKey to zkREPL to confirm that the current proving key
        matches the source code for the claimed circuit
    </p>
    <button onclick="downloadZKey()">Download ZKey</button>
</div>
<script src="snarkjs.min.js"><\/script>

<script>
    async function calculateProof() {
        const { proof, publicSignals } = await snarkjs.groth16.fullProve(
            {
                a: document.getElementById("input_a").value,
                b: document.getElementById("input_b").value,
            },
            WASM_URL,
            ZKEY_DATA
        )

        document.getElementById("proofData").value = JSON.stringify(proof)
        document.getElementById("publicSignals").value =
            JSON.stringify(publicSignals)
    }

    async function verifyProof() {
        const publicSignals = JSON.parse(
            document.getElementById("publicSignals").value
        )
        const proof = JSON.parse(document.getElementById("proofData").value)

        const res = await snarkjs.groth16.verify(
            VKEY_DATA,
            publicSignals,
            proof
        )

        document.getElementById("result").innerHTML = res
            ? "\u2705 Proof is valid"
            : "\u274C Proof is invalid"
    }

    async function downloadZKey() {
        const a = document.createElement("a")
        a.href = ZKEY_DATA
        a.download = "main.zkey"
        a.click()
    }
<\/script>

<script>
    const VKEY_DATA = {{VKEY_DATA}}
<\/script>

<script>
    /* {{SNARKJS}} */
<\/script>

<script>
    const ZKEY_DATA = "{{ZKEY_DATA}}"
<\/script>

<script>
    const WASM_URL = "{{WASM_URL}}"
<\/script>
`;const s3=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function Eu(e,t){if(!t||t==10)return BigInt(e);if(t==16)return e.slice(0,2)=="0x"?BigInt(e):BigInt("0x"+e)}const c3=Eu;function l3(e,t){let n=BigInt(0);t=BigInt(t);for(let i=0;i<e.length;i++)n=n*t+BigInt(e[i]);return n}function u3(e){const t=e.toString(16);return(t.length-1)*4+s3[parseInt(t[0],16)]}function d3(e){return BigInt(e)<BigInt(0)}function f3(e){return!e}function Cu(e,t){return BigInt(e)<<BigInt(t)}function vu(e,t){return BigInt(e)>>BigInt(t)}const h3=Cu,g3=vu;function p3(e){return(BigInt(e)&BigInt(1))==BigInt(1)}function _3(e){let t=BigInt(e);const n=[];for(;t;){if(t&BigInt(1)){const i=2-Number(t%BigInt(4));n.push(i),t=t-BigInt(i)}else n.push(0);t=t>>BigInt(1)}return n}function m3(e){let t=BigInt(e);const n=[];for(;t;)t&BigInt(1)?n.push(1):n.push(0),t=t>>BigInt(1);return n}function L3(e){if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(e)}function y3(e,t){const n=[];let i=BigInt(e);for(t=BigInt(t);i;)n.unshift(Number(i%t)),i=i/t;return n}function A3(e,t){return BigInt(e)+BigInt(t)}function w3(e,t){return BigInt(e)-BigInt(t)}function I3(e){return-BigInt(e)}function b3(e,t){return BigInt(e)*BigInt(t)}function E3(e){return BigInt(e)*BigInt(e)}function C3(e,t){return BigInt(e)**BigInt(t)}function v3(e,t){return BigInt(e)**BigInt(t)}function F3(e){return BigInt(e)>=0?BigInt(e):-BigInt(e)}function S3(e,t){return BigInt(e)/BigInt(t)}function B3(e,t){return BigInt(e)%BigInt(t)}function x3(e,t){return BigInt(e)==BigInt(t)}function O3(e,t){return BigInt(e)!=BigInt(t)}function T3(e,t){return BigInt(e)<BigInt(t)}function P3(e,t){return BigInt(e)>BigInt(t)}function R3(e,t){return BigInt(e)<=BigInt(t)}function U3(e,t){return BigInt(e)>=BigInt(t)}function M3(e,t){return BigInt(e)&BigInt(t)}function G3(e,t){return BigInt(e)|BigInt(t)}function N3(e,t){return BigInt(e)^BigInt(t)}function q3(e,t){return BigInt(e)&&BigInt(t)}function z3(e,t){return BigInt(e)||BigInt(t)}function D3(e){return!BigInt(e)}var k3=Object.freeze({__proto__:null,fromString:Eu,e:c3,fromArray:l3,bitLength:u3,isNegative:d3,isZero:f3,shiftLeft:Cu,shiftRight:vu,shl:h3,shr:g3,isOdd:p3,naf:_3,bits:m3,toNumber:L3,toArray:y3,add:A3,sub:w3,neg:I3,mul:b3,square:E3,pow:C3,exp:v3,abs:F3,div:S3,mod:B3,eq:x3,neq:O3,lt:T3,gt:P3,leq:R3,geq:U3,band:M3,bor:G3,bxor:N3,land:q3,lor:z3,lnot:D3});function Fu(e,t){return typeof e=="string"&&e.slice(0,2)=="0x"?X(e.slice(2),16):X(e,t)}const Q3=Fu;function W3(e,t){return X.fromArray(e,t)}function $3(e){return X(e).bitLength()}function H3(e){return X(e).isNegative()}function j3(e){return X(e).isZero()}function Su(e,t){return X(e).shiftLeft(t)}function Bu(e,t){return X(e).shiftRight(t)}const V3=Su,K3=Bu;function Y3(e){return X(e).isOdd()}function Z3(e){let t=X(e);const n=[];for(;t.gt(X.zero);){if(t.isOdd()){const i=2-t.mod(4).toJSNumber();n.push(i),t=t.minus(i)}else n.push(0);t=t.shiftRight(1)}return n}function J3(e){let t=X(e);const n=[];for(;t.gt(X.zero);)t.isOdd()?n.push(1):n.push(0),t=t.shiftRight(1);return n}function X3(e){if(!e.lt(X("9007199254740992",10)))throw new Error("Number too big");return e.toJSNumber()}function tm(e,t){return X(e).toArray(t)}function em(e,t){return X(e).add(X(t))}function nm(e,t){return X(e).minus(X(t))}function im(e){return X.zero.minus(X(e))}function om(e,t){return X(e).times(X(t))}function am(e){return X(e).square()}function rm(e,t){return X(e).pow(X(t))}function sm(e,t){return X(e).pow(X(t))}function cm(e){return X(e).abs()}function lm(e,t){return X(e).divide(X(t))}function um(e,t){return X(e).mod(X(t))}function dm(e,t){return X(e).eq(X(t))}function fm(e,t){return X(e).neq(X(t))}function hm(e,t){return X(e).lt(X(t))}function gm(e,t){return X(e).gt(X(t))}function pm(e,t){return X(e).leq(X(t))}function _m(e,t){return X(e).geq(X(t))}function mm(e,t){return X(e).and(X(t))}function Lm(e,t){return X(e).or(X(t))}function ym(e,t){return X(e).xor(X(t))}function Am(e,t){return!X(e).isZero()&&!X(t).isZero()}function wm(e,t){return!X(e).isZero()||!X(t).isZero()}function Im(e){return X(e).isZero()}var bm=Object.freeze({__proto__:null,fromString:Fu,e:Q3,fromArray:W3,bitLength:$3,isNegative:H3,isZero:j3,shiftLeft:Su,shiftRight:Bu,shl:V3,shr:K3,isOdd:Y3,naf:Z3,bits:J3,toNumber:X3,toArray:tm,add:em,sub:nm,neg:im,mul:om,square:am,pow:rm,exp:sm,abs:cm,div:lm,mod:um,eq:dm,neq:fm,lt:hm,gt:gm,leq:pm,geq:_m,band:mm,bor:Lm,bxor:ym,land:Am,lor:wm,lnot:Im});const Em=typeof BigInt=="function";let de={};Em?Object.assign(de,k3):Object.assign(de,bm),de.toRprLE=function(t,n,i,o){const a="0000000"+i.toString(16),c=new Uint32Array(t.buffer,n,o/4),d=((a.length-7)*4-1>>5)+1;for(let h=0;h<d;h++)c[h]=parseInt(a.substring(a.length-8*h-8,a.length-8*h),16);for(let h=d;h<c.length;h++)c[h]=0;for(let h=c.length*4;h<o;h++)t[h]=de.toNumber(de.band(de.shiftRight(i,h*8),255))},de.toRprBE=function(t,n,i,o){const a="0000000"+i.toString(16),c=new DataView(t.buffer,t.byteOffset+n,o),d=((a.length-7)*4-1>>5)+1;for(let h=0;h<d;h++)c.setUint32(o-h*4-4,parseInt(a.substring(a.length-8*h-8,a.length-8*h),16),!1);for(let h=0;h<o/4-d;h++)c[h]=0},de.fromRprLE=function(t,n,i){i=i||t.byteLength,n=n||0;const o=new Uint32Array(t.buffer,n,i/4),a=new Array(i/4);return o.forEach((c,d)=>a[a.length-d-1]=c.toString(16).padStart(8,"0")),de.fromString(a.join(""),16)},de.fromRprBE=function(t,n,i){i=i||t.byteLength,n=n||0;const o=new DataView(t.buffer,t.byteOffset+n,i),a=new Array(i/4);for(let c=0;c<i/4;c++)a[c]=o.getUint32(c*4,!1).toString(16).padStart(8,"0");return de.fromString(a.join(""),16)},de.toString=function(t,n){return t.toString(n)},de.toLEBuff=function(t){const n=new Uint8Array(Math.floor((de.bitLength(t)-1)/8)+1);return de.toRprLE(n,0,t,n.byteLength),n},de.zero=de.e(0),de.one=de.e(1);let{toRprLE:Pr,toRprBE:Cm,fromRprLE:Do,fromRprBE:vm,toString:xu,toLEBuff:vi,zero:Ou,one:ti,fromString:Fm,e:pe,fromArray:Sm,bitLength:Rr,isNegative:Tu,isZero:Bm,shiftLeft:Ur,shiftRight:ko,shl:xm,shr:Om,isOdd:Pu,naf:Tm,bits:Pm,toNumber:Rm,toArray:Um,add:Mr,sub:Qo,neg:Ru,mul:Uu,square:Mm,pow:Gm,exp:Nm,abs:qm,div:zm,mod:Gr,eq:Dm,neq:km,lt:Qm,gt:Nr,leq:Wm,geq:Mu,band:Gu,bor:$m,bxor:Hm,land:jm,lor:Vm,lnot:Km}=de;var Ym=Object.freeze({__proto__:null,toRprLE:Pr,toRprBE:Cm,fromRprLE:Do,fromRprBE:vm,toString:xu,toLEBuff:vi,zero:Ou,one:ti,fromString:Fm,e:pe,fromArray:Sm,bitLength:Rr,isNegative:Tu,isZero:Bm,shiftLeft:Ur,shiftRight:ko,shl:xm,shr:Om,isOdd:Pu,naf:Tm,bits:Pm,toNumber:Rm,toArray:Um,add:Mr,sub:Qo,neg:Ru,mul:Uu,square:Mm,pow:Gm,exp:Nm,abs:qm,div:zm,mod:Gr,eq:Dm,neq:km,lt:Qm,gt:Nr,leq:Wm,geq:Mu,band:Gu,bor:$m,bxor:Hm,land:jm,lor:Vm,lnot:Km});function Mn(e,t,n,i,o){e[t]=e[t]+e[n]>>>0,e[o]=(e[o]^e[t])>>>0,e[o]=(e[o]<<16|e[o]>>>16&65535)>>>0,e[i]=e[i]+e[o]>>>0,e[n]=(e[n]^e[i])>>>0,e[n]=(e[n]<<12|e[n]>>>20&4095)>>>0,e[t]=e[t]+e[n]>>>0,e[o]=(e[o]^e[t])>>>0,e[o]=(e[o]<<8|e[o]>>>24&255)>>>0,e[i]=e[i]+e[o]>>>0,e[n]=(e[n]^e[i])>>>0,e[n]=(e[n]<<7|e[n]>>>25&127)>>>0}function Zm(e){Mn(e,0,4,8,12),Mn(e,1,5,9,13),Mn(e,2,6,10,14),Mn(e,3,7,11,15),Mn(e,0,5,10,15),Mn(e,1,6,11,12),Mn(e,2,7,8,13),Mn(e,3,4,9,14)}class ao{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return this.idx==16&&this.update(),this.buff[this.idx++]}nextU64(){return Mr(Uu(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(this.nextU32()&1)==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let t=0;t<10;t++)Zm(this.buff);for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,this.state[12]==0&&(this.state[13]=this.state[13]+1>>>0,this.state[13]==0&&(this.state[14]=this.state[14]+1>>>0,this.state[14]==0&&(this.state[15]=this.state[15]+1>>>0)))}}function Jm(e){let t=new Uint8Array(e);if(typeof globalThis.crypto!="undefined")globalThis.crypto.getRandomValues(t);else for(let n=0;n<e;n++)t[n]=Math.random()*4294967296>>>0;return t}function Xm(){const e=Jm(32),t=new Uint32Array(e.buffer),n=[];for(let i=0;i<8;i++)n.push(t[i]);return n}let Wo=null;function qr(){return Wo||(Wo=new ao(Xm()),Wo)}function zr(e){if(typeof e=="bigint"||e.eq!==void 0)return e.toString(10);if(e instanceof Uint8Array)return Do(e,0);if(Array.isArray(e))return e.map(zr);if(typeof e=="object"){const t={};return Object.keys(e).forEach(i=>{t[i]=zr(e[i])}),t}else return e}function Dr(e){if(typeof e=="string"&&/^[0-9]+$/.test(e))return BigInt(e);if(typeof e=="string"&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(Dr);if(typeof e=="object"){if(e===null)return null;const t={};return Object.keys(e).forEach(i=>{t[i]=Dr(e[i])}),t}else return e}function tL(e){let t=BigInt(0),n=e.length,i=0;const o=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n>0;)n>=4?(n-=4,t+=BigInt(o.getUint32(n))<<BigInt(i*8),i+=4):n>=2?(n-=2,t+=BigInt(o.getUint16(n))<<BigInt(i*8),i+=2):(n-=1,t+=BigInt(o.getUint8(n))<<BigInt(i*8),i+=1);return t}function eL(e,t){let n=e;const i=new Uint8Array(t),o=new DataView(i.buffer);let a=t;for(;a>0;)a-4>=0?(a-=4,o.setUint32(a,Number(n&BigInt(4294967295))),n=n>>BigInt(32)):a-2>=0?(a-=2,o.setUint16(a,Number(n&BigInt(65535))),n=n>>BigInt(16)):(a-=1,o.setUint8(a,Number(n&BigInt(255))),n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function nL(e){let t=BigInt(0),n=0;const i=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n<e.length;)n+4<=e.length?(t+=BigInt(i.getUint32(n,!0))<<BigInt(n*8),n+=4):n+4<=e.length?(t+=BigInt(i.getUint16(n,!0))<<BigInt(n*8),n+=2):(t+=BigInt(i.getUint8(n,!0))<<BigInt(n*8),n+=1);return t}function iL(e,t){let n=e;typeof t=="undefined"&&(t=Math.floor((Rr(e)-1)/8)+1,t==0&&(t=1));const i=new Uint8Array(t),o=new DataView(i.buffer);let a=0;for(;a<t;)a+4<=t?(o.setUint32(a,Number(n&BigInt(4294967295)),!0),a+=4,n=n>>BigInt(32)):a+2<=t?(o.setUint16(Number(a,n&BigInt(65535)),!0),a+=2,n=n>>BigInt(16)):(o.setUint8(Number(a,n&BigInt(255)),!0),a+=1,n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function kr(e,t){if(typeof t=="bigint"||t.eq!==void 0)return t.toString(10);if(t instanceof Uint8Array)return e.toString(e.e(t));if(Array.isArray(t))return t.map(kr.bind(this,e));if(typeof t=="object"){const n={};return Object.keys(t).forEach(o=>{n[o]=kr(e,t[o])}),n}else return t}function Qr(e,t){if(typeof t=="string"&&/^[0-9]+$/.test(t))return e.e(t);if(typeof t=="string"&&/^0x[0-9a-fA-F]+$/.test(t))return e.e(t);if(Array.isArray(t))return t.map(Qr.bind(this,e));if(typeof t=="object"){if(t===null)return null;const n={};return Object.keys(t).forEach(o=>{n[o]=Qr(e,t[o])}),n}else return t}var oL=Object.freeze({__proto__:null,stringifyBigInts:zr,unstringifyBigInts:Dr,beBuff2int:tL,beInt2Buff:eL,leBuff2int:nL,leInt2Buff:iL,stringifyFElements:kr,unstringifyFElements:Qr});function Wr(e){if(typeof e=="bigint"||e.eq!==void 0)return e.toString(10);if(Array.isArray(e))return e.map(Wr);if(typeof e=="object"){const t={};return Object.keys(e).forEach(i=>{t[i]=Wr(e[i])}),t}else return e}function $r(e){if(typeof e=="string"&&/^[0-9]+$/.test(e))return X(e);if(typeof e=="string"&&/^0x[0-9a-fA-F]+$/.test(e))return X(e);if(Array.isArray(e))return e.map($r);if(typeof e=="object"){const t={};return Object.keys(e).forEach(i=>{t[i]=$r(e[i])}),t}else return e}function aL(e){let t=X.zero;for(let n=0;n<e.length;n++){const i=X(e[e.length-n-1]);t=t.add(i.shiftLeft(n*8))}return t}function rL(e,t){let n=e,i=t-1;const o=new Uint8Array(t);for(;n.gt(X.zero)&&i>=0;){let a=Number(n.and(X("255")));o[i]=a,i--,n=n.shiftRight(8)}if(!n.eq(X.zero))throw new Error("Number does not fit in this length");return o}function sL(e){let t=X.zero;for(let n=0;n<e.length;n++){const i=X(e[n]);t=t.add(i.shiftLeft(n*8))}return t}function cL(e,t){let n=e,i=0;const o=new Uint8Array(t);for(;n.gt(X.zero)&&i<o.length;){let a=Number(n.and(X(255)));o[i]=a,i++,n=n.shiftRight(8)}if(!n.eq(X.zero))throw new Error("Number does not fit in this length");return o}var lL=Object.freeze({__proto__:null,stringifyBigInts:Wr,unstringifyBigInts:$r,beBuff2int:aL,beInt2Buff:rL,leBuff2int:sL,leInt2Buff:cL});let fn={};typeof BigInt=="function"?Object.assign(fn,oL):Object.assign(fn,lL);const ro=[];for(let e=0;e<256;e++)ro[e]=uL(e,8);function uL(e,t){let n=0,i=e;for(let o=0;o<t;o++)n<<=1,n=n|i&1,i>>=1;return n}fn.bitReverse=function(t,n){return(ro[t>>>24]|ro[t>>>16&255]<<8|ro[t>>>8&255]<<16|ro[t&255]<<24)>>>32-n},fn.log2=function(t){return((t&4294901760)!=0?(t&=4294901760,16):0)|((t&4278255360)!=0?(t&=4278255360,8):0)|((t&4042322160)!=0?(t&=4042322160,4):0)|((t&3435973836)!=0?(t&=3435973836,2):0)|(t&2863311530)!=0},fn.buffReverseBits=function(t,n){const i=t.byteLength/n,o=fn.log2(i);if(i!=1<<o)throw new Error("Invalid number of pointers");for(let a=0;a<i;a++){const c=fn.bitReverse(a,o);if(a>c){const d=t.slice(a*n,(a+1)*n);t.set(t.slice(c*n,(c+1)*n),a*n),t.set(d,c*n)}}},fn.array2buffer=function(e,t){const n=new Uint8Array(t*e.length);for(let i=0;i<e.length;i++)n.set(e[i],i*t);return n},fn.buffer2array=function(e,t){const n=e.byteLength/t,i=new Array(n);for(let o=0;o<n;o++)i[o]=e.slice(o*t,o*t+t);return i};let{bitReverse:dL,log2:$e,buffReverseBits:Nu,stringifyBigInts:fL,unstringifyBigInts:hL,beBuff2int:gL,beInt2Buff:pL,leBuff2int:_L,leInt2Buff:qu,array2buffer:Hr,buffer2array:$o,stringifyFElements:mL,unstringifyFElements:LL}=fn;var yL=Object.freeze({__proto__:null,bitReverse:dL,log2:$e,buffReverseBits:Nu,stringifyBigInts:fL,unstringifyBigInts:hL,beBuff2int:gL,beInt2Buff:pL,leBuff2int:_L,leInt2Buff:qu,array2buffer:Hr,buffer2array:$o,stringifyFElements:mL,unstringifyFElements:LL});const Ie=1<<30;class Kt{constructor(t){this.buffers=[],this.byteLength=t;for(let n=0;n<t;n+=Ie){const i=Math.min(t-n,Ie);this.buffers.push(new Uint8Array(i))}}slice(t,n){n===void 0&&(n=this.byteLength),t===void 0&&(t=0);const i=n-t,o=Math.floor(t/Ie),a=Math.floor((t+i-1)/Ie);if(o==a||i==0)return this.buffers[o].slice(t%Ie,t%Ie+i);let c,d=o,h=t%Ie,u=i;for(;u>0;){const s=h+u>Ie?Ie-h:u,_=new Uint8Array(this.buffers[d].buffer,this.buffers[d].byteOffset+h,s);if(s==i)return _.slice();c||(i<=Ie?c=new Uint8Array(i):c=new Kt(i)),c.set(_,i-u),u=u-s,d++,h=0}return c}set(t,n){n===void 0&&(n=0);const i=t.byteLength;if(i==0)return;const o=Math.floor(n/Ie),a=Math.floor((n+i-1)/Ie);if(o==a)return t instanceof Kt&&t.buffers.length==1?this.buffers[o].set(t.buffers[0],n%Ie):this.buffers[o].set(t,n%Ie);let c=o,d=n%Ie,h=i;for(;h>0;){const u=d+h>Ie?Ie-d:h,s=t.slice(i-h,i-h+u);new Uint8Array(this.buffers[c].buffer,this.buffers[c].byteOffset+d,u).set(s),h=h-u,c++,d=0}}}function Gn(e,t,n,i){return async function(a){const c=Math.floor(a.byteLength/n);if(c*n!==a.byteLength)throw new Error("Invalid buffer size");const d=Math.floor(c/e.concurrency),h=[];for(let L=0;L<e.concurrency;L++){let g;if(L<e.concurrency-1?g=d:g=c-L*d,g==0)continue;const F=a.slice(L*d*n,L*d*n+g*n),T=[{cmd:"ALLOCSET",var:0,buff:F},{cmd:"ALLOC",var:1,len:i*g},{cmd:"CALL",fnName:t,params:[{var:0},{val:g},{var:1}]},{cmd:"GET",out:0,var:1,len:i*g}];h.push(e.queueAction(T))}const u=await Promise.all(h);let s;a instanceof Kt?s=new Kt(c*i):s=new Uint8Array(c*i);let _=0;for(let L=0;L<u.length;L++)s.set(u[L][0],_),_+=u[L][0].byteLength;return s}}class zu{constructor(t,n,i,o){if(this.tm=t,this.prefix=n,this.p=o,this.n8=i,this.type="F1",this.m=1,this.half=ko(o,ti),this.bitLength=Rr(o),this.mask=Qo(Ur(ti,this.bitLength),ti),this.pOp1=t.alloc(i),this.pOp2=t.alloc(i),this.pOp3=t.alloc(i),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(i/8),this.n32=Math.floor(i/4),this.n64*8!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=ko(this.p,ti),this.nqr=this.two;let a=this.exp(this.nqr,this.half);for(;!this.eq(a,this.negone);)this.nqr=this.add(this.nqr,this.one),a=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let c=Qo(this.p,ti);for(;!Pu(c);)this.s=this.s+1,c=ko(c,ti);this.w=[],this.w[this.s]=this.exp(this.nqr,c);for(let d=this.s-1;d>=0;d--)this.w[d]=this.square(this.w[d+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Gn(t,n+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Gn(t,n+"_batchFromMontgomery",this.n8,this.n8)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=vi(pe(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,n){if(t instanceof Uint8Array)return t;let i=pe(t,n);Tu(i)?(i=Ru(i),Nr(i,this.p)&&(i=Gr(i,this.p)),i=Qo(this.p,i)):Nr(i,this.p)&&(i=Gr(i,this.p));const o=qu(i,this.n8);return this.toMontgomery(o)}toString(t,n){const i=this.fromMontgomery(t),o=Do(i,0);return xu(o,n)}fromRng(t){let n;const i=new Uint8Array(this.n8);do{n=Ou;for(let o=0;o<this.n64;o++)n=Mr(n,Ur(t.nextU64(),64*o));n=Gu(n,this.mask)}while(Mu(n,this.p));return Pr(i,0,n,this.n8),i}random(){return this.fromRng(qr())}toObject(t){const n=this.fromMontgomery(t);return Do(n,0)}fromObject(t){const n=new Uint8Array(this.n8);return Pr(n,0,t,this.n8),this.toMontgomery(n)}toRprLE(t,n,i){t.set(this.fromMontgomery(i),n)}toRprBE(t,n,i){const o=this.fromMontgomery(i);for(let a=0;a<this.n8/2;a++){const c=o[a];o[a]=o[this.n8-1-a],o[this.n8-1-a]=c}t.set(o,n)}fromRprLE(t,n){n=n||0;const i=t.slice(n,n+this.n8);return this.toMontgomery(i)}async batchInverse(t){let n=!1;const i=this.n8,o=this.n8;Array.isArray(t)?(t=Hr(t,i),n=!0):t=t.slice(0,t.byteLength);const a=Math.floor(t.byteLength/i);if(a*i!==t.byteLength)throw new Error("Invalid buffer size");const c=Math.floor(a/this.tm.concurrency),d=[];for(let _=0;_<this.tm.concurrency;_++){let L;if(_<this.tm.concurrency-1?L=c:L=a-_*c,L==0)continue;const g=t.slice(_*c*i,_*c*i+L*i),F=[{cmd:"ALLOCSET",var:0,buff:g},{cmd:"ALLOC",var:1,len:o*L},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:i},{val:L},{var:1},{val:o}]},{cmd:"GET",out:0,var:1,len:o*L}];d.push(this.tm.queueAction(F))}const h=await Promise.all(d);let u;t instanceof Kt?u=new Kt(a*o):u=new Uint8Array(a*o);let s=0;for(let _=0;_<h.length;_++)u.set(h[_][0],s),s+=h[_][0].byteLength;return n?$o(u,o):u}}class Du{constructor(t,n,i){this.tm=t,this.prefix=n,this.F=i,this.type="F2",this.m=i.m*2,this.n8=this.F.n8*2,this.n32=this.F.n32*2,this.n64=this.F.n64*2,this.pOp1=t.alloc(i.n8*2),this.pOp2=t.alloc(i.n8*2),this.pOp3=t.alloc(i.n8*2),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}mul1(t,n){return this.op2("_mul1",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=vi(pe(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==2){const i=this.F.e(t[0],n),o=this.F.e(t[1],n),a=new Uint8Array(this.F.n8*2);return a.set(i),a.set(o,this.F.n8*2),a}else throw new Error("invalid F2")}toString(t,n){const i=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[${i}, ${o}]`}fromRng(t){const n=this.F.fromRng(t),i=this.F.fromRng(t),o=new Uint8Array(this.F.n8*2);return o.set(n),o.set(i,this.F.n8),o}random(){return this.fromRng(qr())}toObject(t){const n=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));return[n,i]}fromObject(t){const n=new Uint8Array(this.F.n8*2),i=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]);return n.set(i),n.set(o,this.F.n8),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class AL{constructor(t,n,i){this.tm=t,this.prefix=n,this.F=i,this.type="F3",this.m=i.m*3,this.n8=this.F.n8*3,this.n32=this.F.n32*3,this.n64=this.F.n64*3,this.pOp1=t.alloc(i.n8*3),this.pOp2=t.alloc(i.n8*3),this.pOp3=t.alloc(i.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}add(t,n){return this.op2("_add",t,n)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=vi(pe(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==3){const i=this.F.e(t[0],n),o=this.F.e(t[1],n),a=this.F.e(t[2],n),c=new Uint8Array(this.F.n8*3);return c.set(i),c.set(o,this.F.n8),c.set(a,this.F.n8*2),c}else throw new Error("invalid F3")}toString(t,n){const i=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),a=this.F.toString(t.slice(this.F.n8*2),n);return`[${i}, ${o}, ${a}]`}fromRng(t){const n=this.F.fromRng(t),i=this.F.fromRng(t),o=this.F.fromRng(t),a=new Uint8Array(this.F.n8*3);return a.set(n),a.set(i,this.F.n8),a.set(o,this.F.n8*2),a}random(){return this.fromRng(qr())}toObject(t){const n=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3));return[n,i,o]}fromObject(t){const n=new Uint8Array(this.F.n8*3),i=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]),a=this.F.fromObject(t[2]);return n.set(i),n.set(o,this.F.n8),n.set(a,this.F.n8*2),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,this.F.n8*2)}c3(t){return t.slice(this.F.n8*2)}}class ku{constructor(t,n,i,o,a,c){this.tm=t,this.prefix=n,this.F=i,this.pOp1=t.alloc(i.n8*3),this.pOp2=t.alloc(i.n8*3),this.pOp3=t.alloc(i.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,i.n8*3),this.tm.instance.exports[n+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,i.n8*2),this.one=this.tm.getBuff(o,i.n8*3),this.g=this.one,this.oneAffine=this.tm.getBuff(o,i.n8*2),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(a,i.n8),c&&(this.cofactor=vi(c)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Gn(t,n+"_batchLEMtoC",i.n8*2,i.n8),this.batchLEMtoU=Gn(t,n+"_batchLEMtoU",i.n8*2,i.n8*2),this.batchCtoLEM=Gn(t,n+"_batchCtoLEM",i.n8,i.n8*2),this.batchUtoLEM=Gn(t,n+"_batchUtoLEM",i.n8*2,i.n8*2),this.batchToJacobian=Gn(t,n+"_batchToJacobian",i.n8*2,i.n8*3),this.batchToAffine=Gn(t,n+"_batchToAffine",i.n8*3,i.n8*2)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op2bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op1Affine(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*2)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_add",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_addMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_addMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_addAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}sub(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_sub",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_subMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_subMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_subAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}neg(t){if(t.byteLength==this.F.n8*3)return this.op1("_neg",t);if(t.byteLength==this.F.n8*2)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==this.F.n8*3)return this.op1("_double",t);if(t.byteLength==this.F.n8*2)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==this.F.n8*3)return this.op1Bool("_isZero",t);if(t.byteLength==this.F.n8*2)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,n){n instanceof Uint8Array||(n=vi(pe(n)));let i;if(t.byteLength==this.F.n8*3)i=this.prefix+"_timesScalar";else if(t.byteLength==this.F.n8*2)i=this.prefix+"_timesScalarAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[i](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}timesFr(t,n){let i;if(t.byteLength==this.F.n8*3)i=this.prefix+"_timesFr";else if(t.byteLength==this.F.n8*2)i=this.prefix+"_timesFrAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[i](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}eq(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2bool("_eq",t,n);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2bool("_eqMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}toAffine(t){if(t.byteLength==this.F.n8*3)return this.op1Affine("_toAffine",t);if(t.byteLength==this.F.n8*2)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==this.F.n8*3)return t;if(t.byteLength==this.F.n8*2)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,n,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}fromRprUncompressed(t,n){const i=t.slice(n,n+this.F.n8*2);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,this.F.n8*2)}toRprCompressed(t,n,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const o=this.tm.getBuff(this.pOp1,this.F.n8);t.set(o,n)}fromRprCompressed(t,n){const i=t.slice(n,n+this.F.n8);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,this.F.n8*2)}toUncompressed(t){const n=new Uint8Array(this.F.n8*2);return this.toRprUncompressed(n,0,t),n}toRprLEM(t,n,i){if(i.byteLength==this.F.n8*2){t.set(i,n);return}else if(i.byteLength==this.F.n8*3){this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}else throw new Error("invalid point size")}fromRprLEM(t,n){return n=n||0,t.slice(n,n+this.F.n8*2)}toString(t,n){if(t.byteLength==this.F.n8*3){const i=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),a=this.F.toString(t.slice(this.F.n8*2),n);return`[ ${i}, ${o}, ${a} ]`}else if(t.byteLength==this.F.n8*2){const i=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[ ${i}, ${o} ]`}else throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const n=this.F,i=this.toAffine(t),o=i.slice(0,this.F.n8),a=i.slice(this.F.n8,this.F.n8*2),c=n.add(n.mul(n.square(o),o),this.b),d=n.square(a);return n.eq(c,d)}fromRng(t){const n=this.F;let i=[],o,a;do i[0]=n.fromRng(t),o=t.nextBool(),a=n.add(n.mul(n.square(i[0]),i[0]),this.b);while(!n.isSquare(a));i[1]=n.sqrt(a);const c=n.isNegative(i[1]);o^c&&(i[1]=n.neg(i[1]));let d=new Uint8Array(this.F.n8*2);return d.set(i[0]),d.set(i[1],this.F.n8),this.cofactor&&(d=this.timesScalar(d,this.cofactor)),d}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const n=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));let o;return t.byteLength==this.F.n8*3?o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3)):o=this.F.toObject(this.F.one),[n,i,o]}fromObject(t){const n=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);let o;if(t.length==3?o=this.F.fromObject(t[2]):o=this.F.one,this.F.isZero(o,this.F.one))return this.zeroAffine;if(this.F.eq(o,this.F.one)){const a=new Uint8Array(this.F.n8*2);return a.set(n),a.set(i,this.F.n8),a}else{const a=new Uint8Array(this.F.n8*3);return a.set(n),a.set(i,this.F.n8),a.set(o,this.F.n8*2),a}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function Qu(e){const t=32767;let n,i;e&&(e.onmessage=function(s){let _;if(s.data?_=s.data:_=s,_[0].cmd=="INIT")o(_[0]).then(function(){e.postMessage(_.result)});else if(_[0].cmd=="TERMINATE")e.close();else{const L=u(_);e.postMessage(L)}});async function o(s){const _=new Uint8Array(s.code),L=await WebAssembly.compile(_);i=new WebAssembly.Memory({initial:s.init,maximum:t}),n=await WebAssembly.instantiate(L,{env:{memory:i}})}function a(s){const _=new Uint32Array(i.buffer,0,1);for(;_[0]&3;)_[0]++;const L=_[0];if(_[0]+=s,_[0]+s>i.buffer.byteLength){const g=i.buffer.byteLength/65536;let F=Math.floor((_[0]+s)/65536)+1;F>t&&(F=t),i.grow(F-g)}return L}function c(s){const _=a(s.byteLength);return h(_,s),_}function d(s,_){const L=new Uint8Array(i.buffer);return new Uint8Array(L.buffer,L.byteOffset+s,_)}function h(s,_){new Uint8Array(i.buffer).set(new Uint8Array(_),s)}function u(s){if(s[0].cmd=="INIT")return o(s[0]);const _={vars:[],out:[]},g=new Uint32Array(i.buffer,0,1)[0];for(let T=0;T<s.length;T++)switch(s[T].cmd){case"ALLOCSET":_.vars[s[T].var]=c(s[T].buff);break;case"ALLOC":_.vars[s[T].var]=a(s[T].len);break;case"SET":h(_.vars[s[T].var],s[T].buff);break;case"CALL":{const C=[];for(let U=0;U<s[T].params.length;U++){const x=s[T].params[U];typeof x.var!="undefined"?C.push(_.vars[x.var]+(x.offset||0)):typeof x.val!="undefined"&&C.push(x.val)}n.exports[s[T].fnName](...C);break}case"GET":_.out[s[T].out]=d(_.vars[s[T].var],s[T].len).slice();break;default:throw new Error("Invalid cmd")}const F=new Uint32Array(i.buffer,0,1);return F[0]=g,_.out}return u}const jr=25;class Wu{constructor(){this.promise=new Promise((t,n)=>{this.reject=n,this.resolve=t})}}function wL(e){return new Promise(t=>setTimeout(t,e))}function IL(e){return globalThis.btoa(e)}const bL=IL("("+Qu.toString()+")(self)"),EL="data:application/javascript;base64,"+bL;async function CL(e,t){const n=new vL;n.memory=new WebAssembly.Memory({initial:jr}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);const i=await WebAssembly.compile(e.code);if(n.instance=await WebAssembly.instantiate(i,{env:{memory:n.memory}}),n.singleThread=t,n.initalPFree=n.u32[0],n.pq=e.pq,n.pr=e.pr,n.pG1gen=e.pG1gen,n.pG1zero=e.pG1zero,n.pG2gen=e.pG2gen,n.pG2zero=e.pG2zero,n.pOneT=e.pOneT,t)n.code=e.code,n.taskManager=Qu(),await n.taskManager([{cmd:"INIT",init:jr,code:n.code.slice()}]),n.concurrency=1;else{n.workers=[],n.pendingDeferreds=[],n.working=[];let a;typeof navigator=="object"&&navigator.hardwareConcurrency?a=navigator.hardwareConcurrency:a=eo.cpus().length,a==0&&(a=2),a>64&&(a=64),n.concurrency=a;for(let d=0;d<a;d++)n.workers[d]=new bt(EL),n.workers[d].addEventListener("message",o(d)),n.working[d]=!1;const c=[];for(let d=0;d<n.workers.length;d++){const h=e.code.slice();c.push(n.postAction(d,[{cmd:"INIT",init:jr,code:h}],[h.buffer]))}await Promise.all(c)}return n;function o(a){return function(c){let d;c&&c.data?d=c.data:d=c,n.working[a]=!1,n.pendingDeferreds[a].resolve(d),n.processWorks()}}}class vL{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(this.oldPFree!=0)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(this.oldPFree==0)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,n,i,o){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=o||new Wu,this.workers[t].postMessage(n,i),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(this.working[t]==!1){const n=this.actionQueue.shift();this.postAction(t,n.data,n.transfers,n.deferred)}}queueAction(t,n){const i=new Wu;if(this.singleThread){const o=this.taskManager(t);i.resolve(o)}else this.actionQueue.push({data:t,transfers:n,deferred:i}),this.processWorks();return i.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const n=this.alloc(t.byteLength);return this.setBuff(n,t),n}getBuff(t,n){return this.u8.slice(t,t+n)}setBuff(t,n){this.u8.set(new Uint8Array(n),t)}alloc(t){for(;this.u32[0]&3;)this.u32[0]++;const n=this.u32[0];return this.u32[0]+=t,n}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await wL(200)}}function Vr(e,t){const n=e[t],i=e.Fr,o=e.tm;e[t].batchApplyKey=async function(a,c,d,h,u){h=h||"affine",u=u||"affine";let s,_,L,g,F;if(t=="G1")h=="jacobian"?(L=n.F.n8*3,s="g1m_batchApplyKey"):(L=n.F.n8*2,s="g1m_batchApplyKeyMixed"),g=n.F.n8*3,u=="jacobian"?F=n.F.n8*3:(_="g1m_batchToAffine",F=n.F.n8*2);else if(t=="G2")h=="jacobian"?(L=n.F.n8*3,s="g2m_batchApplyKey"):(L=n.F.n8*2,s="g2m_batchApplyKeyMixed"),g=n.F.n8*3,u=="jacobian"?F=n.F.n8*3:(_="g2m_batchToAffine",F=n.F.n8*2);else if(t=="Fr")s="frm_batchApplyKey",L=n.n8,g=n.n8,F=n.n8;else throw new Error("Invalid group: "+t);const T=Math.floor(a.byteLength/L),C=Math.floor(T/o.concurrency),U=[];d=i.e(d);let x=i.e(c);for(let v=0;v<o.concurrency;v++){let m;if(v<o.concurrency-1?m=C:m=T-v*C,m==0)continue;const y=[];y.push({cmd:"ALLOCSET",var:0,buff:a.slice(v*C*L,v*C*L+m*L)}),y.push({cmd:"ALLOCSET",var:1,buff:x}),y.push({cmd:"ALLOCSET",var:2,buff:d}),y.push({cmd:"ALLOC",var:3,len:m*Math.max(g,F)}),y.push({cmd:"CALL",fnName:s,params:[{var:0},{val:m},{var:1},{var:2},{var:3}]}),_&&y.push({cmd:"CALL",fnName:_,params:[{var:3},{val:m},{var:3}]}),y.push({cmd:"GET",out:0,var:3,len:m*F}),U.push(o.queueAction(y)),x=i.mul(x,i.exp(d,m))}const V=await Promise.all(U);let D;a instanceof Kt?D=new Kt(T*F):D=new Uint8Array(T*F);let $=0;for(let v=0;v<V.length;v++)D.set(V[v][0],$),$+=V[v][0].byteLength;return D}}function FL(e){const t=e.tm;e.pairing=function(i,o){t.startSyncOp();const a=t.allocBuff(e.G1.toJacobian(i)),c=t.allocBuff(e.G2.toJacobian(o)),d=t.alloc(e.Gt.n8);t.instance.exports[e.name+"_pairing"](a,c,d);const h=t.getBuff(d,e.Gt.n8);return t.endSyncOp(),h},e.pairingEq=async function(){let i,o;arguments.length%2==1?(i=arguments[arguments.length-1],o=(arguments.length-1)/2):(i=e.Gt.one,o=arguments.length/2);const a=[];for(let s=0;s<o;s++){const _=[],L=e.G1.toJacobian(arguments[s*2]);_.push({cmd:"ALLOCSET",var:0,buff:L}),_.push({cmd:"ALLOC",var:1,len:e.prePSize});const g=e.G2.toJacobian(arguments[s*2+1]);_.push({cmd:"ALLOCSET",var:2,buff:g}),_.push({cmd:"ALLOC",var:3,len:e.preQSize}),_.push({cmd:"ALLOC",var:4,len:e.Gt.n8}),_.push({cmd:"CALL",fnName:e.name+"_prepareG1",params:[{var:0},{var:1}]}),_.push({cmd:"CALL",fnName:e.name+"_prepareG2",params:[{var:2},{var:3}]}),_.push({cmd:"CALL",fnName:e.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),_.push({cmd:"GET",out:0,var:4,len:e.Gt.n8}),a.push(t.queueAction(_))}const c=await Promise.all(a);t.startSyncOp();const d=t.alloc(e.Gt.n8);t.instance.exports.ftm_one(d);for(let s=0;s<c.length;s++){const _=t.allocBuff(c[s][0]);t.instance.exports.ftm_mul(d,_,d)}t.instance.exports[e.name+"_finalExponentiation"](d,d);const h=t.allocBuff(i),u=!!t.instance.exports.ftm_eq(d,h);return t.endSyncOp(),u},e.prepareG1=function(n){this.tm.startSyncOp();const i=this.tm.allocBuff(n),o=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](i,o);const a=this.tm.getBuff(o,this.prePSize);return this.tm.endSyncOp(),a},e.prepareG2=function(n){this.tm.startSyncOp();const i=this.tm.allocBuff(n),o=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](i,o);const a=this.tm.getBuff(o,this.preQSize);return this.tm.endSyncOp(),a},e.millerLoop=function(n,i){this.tm.startSyncOp();const o=this.tm.allocBuff(n),a=this.tm.allocBuff(i),c=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](o,a,c);const d=this.tm.getBuff(c,this.Gt.n8);return this.tm.endSyncOp(),d},e.finalExponentiation=function(n){this.tm.startSyncOp();const i=this.tm.allocBuff(n),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](i,o);const a=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),a}}const $u=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function Hu(e,t){const n=e[t],i=n.tm;async function o(c,d,h,u,s){if(!(c instanceof Uint8Array))throw u&&u.error(`${s} _multiExpChunk buffBases is not Uint8Array`),new Error(`${s} _multiExpChunk buffBases is not Uint8Array`);if(!(d instanceof Uint8Array))throw u&&u.error(`${s} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${s} _multiExpChunk buffScalars is not Uint8Array`);h=h||"affine";let _,L;if(t=="G1")h=="affine"?(L="g1m_multiexpAffine_chunk",_=n.F.n8*2):(L="g1m_multiexp_chunk",_=n.F.n8*3);else if(t=="G2")h=="affine"?(L="g2m_multiexpAffine_chunk",_=n.F.n8*2):(L="g2m_multiexp_chunk",_=n.F.n8*3);else throw new Error("Invalid group");const g=Math.floor(c.byteLength/_);if(g==0)return n.zero;const F=Math.floor(d.byteLength/g);if(F*g!=d.byteLength)throw new Error("Scalar size does not match");const T=$u[$e(g)],C=Math.floor((F*8-1)/T)+1,U=[];for(let D=0;D<C;D++){const $=[{cmd:"ALLOCSET",var:0,buff:c},{cmd:"ALLOCSET",var:1,buff:d},{cmd:"ALLOC",var:2,len:n.F.n8*3},{cmd:"CALL",fnName:L,params:[{var:0},{var:1},{val:F},{val:g},{val:D*T},{val:Math.min(F*8-D*T,T)},{var:2}]},{cmd:"GET",out:0,var:2,len:n.F.n8*3}];U.push(n.tm.queueAction($))}const x=await Promise.all(U);let V=n.zero;for(let D=x.length-1;D>=0;D--){if(!n.isZero(V))for(let $=0;$<T;$++)V=n.double(V);V=n.add(V,x[D][0])}return V}async function a(c,d,h,u,s){const _=1<<22,L=1<<10;let g;if(t=="G1")h=="affine"?g=n.F.n8*2:g=n.F.n8*3;else if(t=="G2")h=="affine"?g=n.F.n8*2:g=n.F.n8*3;else throw new Error("Invalid group");const F=Math.floor(c.byteLength/g),T=Math.floor(d.byteLength/F);if(T*F!=d.byteLength)throw new Error("Scalar size does not match");const C=$u[$e(F)],U=Math.floor((T*8-1)/C)+1;let x;x=Math.floor(F/(i.concurrency/U)),x>_&&(x=_),x<L&&(x=L);const V=[];for(let v=0;v<F;v+=x){u&&u.debug(`Multiexp start: ${s}: ${v}/${F}`);const m=Math.min(F-v,x),y=c.slice(v*g,(v+m)*g),G=d.slice(v*T,(v+m)*T);V.push(o(y,G,h,u,s).then(k=>(u&&u.debug(`Multiexp end: ${s}: ${v}/${F}`),k)))}const D=await Promise.all(V);let $=n.zero;for(let v=D.length-1;v>=0;v--)$=n.add($,D[v]);return $}n.multiExp=async function(d,h,u,s){return await a(d,h,"jacobian",u,s)},n.multiExpAffine=async function(d,h,u,s){return await a(d,h,"affine",u,s)}}function Kr(e,t){const n=e[t],i=e.Fr,o=n.tm;async function a(u,s,_,L,g,F){_=_||"affine",L=L||"affine";const T=14;let C,U,x,V,D,$,v,m;t=="G1"?(_=="affine"?(C=n.F.n8*2,V="g1m_batchToJacobian"):C=n.F.n8*3,U=n.F.n8*3,s&&(m="g1m_fftFinal"),v="g1m_fftJoin",$="g1m_fftMix",L=="affine"?(x=n.F.n8*2,D="g1m_batchToAffine"):x=n.F.n8*3):t=="G2"?(_=="affine"?(C=n.F.n8*2,V="g2m_batchToJacobian"):C=n.F.n8*3,U=n.F.n8*3,s&&(m="g2m_fftFinal"),v="g2m_fftJoin",$="g2m_fftMix",L=="affine"?(x=n.F.n8*2,D="g2m_batchToAffine"):x=n.F.n8*3):t=="Fr"&&(C=n.n8,U=n.n8,x=n.n8,s&&(m="frm_fftFinal"),$="frm_fftMix",v="frm_fftJoin");let y=!1;Array.isArray(u)?(u=Hr(u,C),y=!0):u=u.slice(0,u.byteLength);const G=u.byteLength/C,k=$e(G);if(1<<k!=G)throw new Error("fft must be multiple of 2");if(k==i.s+1){let Z;return s?Z=await d(u,_,L,g,F):Z=await c(u,_,L,g,F),y?$o(Z,x):Z}let N;s&&(N=i.inv(i.e(G)));let R;Nu(u,C);let E,z=Math.min(1<<T,G),tt=G/z;for(;tt<o.concurrency&&z>=16;)tt*=2,z/=2;const at=$e(z),it=[];for(let Z=0;Z<tt;Z++){g&&g.debug(`${F}: fft ${k} mix start: ${Z}/${tt}`);const ot=[];ot.push({cmd:"ALLOC",var:0,len:U*z});const nt=u.slice(z*Z*C,z*(Z+1)*C);ot.push({cmd:"SET",var:0,buff:nt}),V&&ot.push({cmd:"CALL",fnName:V,params:[{var:0},{val:z},{var:0}]});for(let gt=1;gt<=at;gt++)ot.push({cmd:"CALL",fnName:$,params:[{var:0},{val:z},{val:gt}]});at==k?(m&&(ot.push({cmd:"ALLOCSET",var:1,buff:N}),ot.push({cmd:"CALL",fnName:m,params:[{var:0},{val:z},{var:1}]})),D&&ot.push({cmd:"CALL",fnName:D,params:[{var:0},{val:z},{var:0}]}),ot.push({cmd:"GET",out:0,var:0,len:z*x})):ot.push({cmd:"GET",out:0,var:0,len:U*z}),it.push(o.queueAction(ot).then(gt=>(g&&g.debug(`${F}: fft ${k} mix end: ${Z}/${tt}`),gt)))}E=await Promise.all(it);for(let Z=0;Z<tt;Z++)E[Z]=E[Z][0];for(let Z=at+1;Z<=k;Z++){g&&g.debug(`${F}: fft  ${k}  join: ${Z}/${k}`);const ot=1<<k-Z,nt=tt/ot,gt=[];for(let pt=0;pt<ot;pt++)for(let yt=0;yt<nt/2;yt++){const w=i.exp(i.w[Z],yt*z),f=i.w[Z],O=pt*nt+yt,p=pt*nt+yt+nt/2,W=[];W.push({cmd:"ALLOCSET",var:0,buff:E[O]}),W.push({cmd:"ALLOCSET",var:1,buff:E[p]}),W.push({cmd:"ALLOCSET",var:2,buff:w}),W.push({cmd:"ALLOCSET",var:3,buff:f}),W.push({cmd:"CALL",fnName:v,params:[{var:0},{var:1},{val:z},{var:2},{var:3}]}),Z==k?(m&&(W.push({cmd:"ALLOCSET",var:4,buff:N}),W.push({cmd:"CALL",fnName:m,params:[{var:0},{val:z},{var:4}]}),W.push({cmd:"CALL",fnName:m,params:[{var:1},{val:z},{var:4}]})),D&&(W.push({cmd:"CALL",fnName:D,params:[{var:0},{val:z},{var:0}]}),W.push({cmd:"CALL",fnName:D,params:[{var:1},{val:z},{var:1}]})),W.push({cmd:"GET",out:0,var:0,len:z*x}),W.push({cmd:"GET",out:1,var:1,len:z*x})):(W.push({cmd:"GET",out:0,var:0,len:z*U}),W.push({cmd:"GET",out:1,var:1,len:z*U})),gt.push(o.queueAction(W).then(q=>(g&&g.debug(`${F}: fft ${k} join  ${Z}/${k}  ${pt+1}/${ot} ${yt}/${nt/2}`),q)))}const xt=await Promise.all(gt);for(let pt=0;pt<ot;pt++)for(let yt=0;yt<nt/2;yt++){const w=pt*nt+yt,f=pt*nt+yt+nt/2,O=xt.shift();E[w]=O[0],E[f]=O[1]}}if(u instanceof Kt?R=new Kt(G*x):R=new Uint8Array(G*x),s){R.set(E[0].slice((z-1)*x));let Z=x;for(let ot=tt-1;ot>0;ot--)R.set(E[ot],Z),Z+=z*x,delete E[ot];R.set(E[0].slice(0,(z-1)*x),Z),delete E[0]}else for(let Z=0;Z<tt;Z++)R.set(E[Z],z*x*Z),delete E[Z];return y?$o(R,x):R}async function c(u,s,_,L,g){let F,T;F=u.slice(0,u.byteLength/2),T=u.slice(u.byteLength/2,u.byteLength);const C=[];[F,T]=await h(F,T,"fftJoinExt",i.one,i.shift,s,"jacobian",L,g),C.push(a(F,!1,"jacobian",_,L,g)),C.push(a(T,!1,"jacobian",_,L,g));const U=await Promise.all(C);let x;return U[0].byteLength>1<<28?x=new Kt(U[0].byteLength*2):x=new Uint8Array(U[0].byteLength*2),x.set(U[0]),x.set(U[1],U[0].byteLength),x}async function d(u,s,_,L,g){let F,T;F=u.slice(0,u.byteLength/2),T=u.slice(u.byteLength/2,u.byteLength);const C=[];C.push(a(F,!0,s,"jacobian",L,g)),C.push(a(T,!0,s,"jacobian",L,g)),[F,T]=await Promise.all(C);const U=await h(F,T,"fftJoinExtInv",i.one,i.shiftInv,"jacobian",_,L,g);let x;return U[0].byteLength>1<<28?x=new Kt(U[0].byteLength*2):x=new Uint8Array(U[0].byteLength*2),x.set(U[0]),x.set(U[1],U[0].byteLength),x}async function h(u,s,_,L,g,F,T,C,U){const x=1<<16,V=1<<4;let D,$,v,m,y,G;if(t=="G1")F=="affine"?(y=n.F.n8*2,$="g1m_batchToJacobian"):y=n.F.n8*3,G=n.F.n8*3,D="g1m_"+_,T=="affine"?(v="g1m_batchToAffine",m=n.F.n8*2):m=n.F.n8*3;else if(t=="G2")F=="affine"?(y=n.F.n8*2,$="g2m_batchToJacobian"):y=n.F.n8*3,D="g2m_"+_,G=n.F.n8*3,T=="affine"?(v="g2m_batchToAffine",m=n.F.n8*2):m=n.F.n8*3;else if(t=="Fr")y=i.n8,m=i.n8,G=i.n8,D="frm_"+_;else throw new Error("Invalid group");if(u.byteLength!=s.byteLength)throw new Error("Invalid buffer size");const k=Math.floor(u.byteLength/y);if(k!=1<<$e(k))throw new Error("Invalid number of points");let N=Math.floor(k/o.concurrency);N<V&&(N=V),N>x&&(N=x);const R=[];for(let it=0;it<k;it+=N){C&&C.debug(`${U}: fftJoinExt Start: ${it}/${k}`);const Z=Math.min(k-it,N),ot=i.mul(L,i.exp(g,it)),nt=[],gt=u.slice(it*y,(it+Z)*y),xt=s.slice(it*y,(it+Z)*y);nt.push({cmd:"ALLOC",var:0,len:G*Z}),nt.push({cmd:"SET",var:0,buff:gt}),nt.push({cmd:"ALLOC",var:1,len:G*Z}),nt.push({cmd:"SET",var:1,buff:xt}),nt.push({cmd:"ALLOCSET",var:2,buff:ot}),nt.push({cmd:"ALLOCSET",var:3,buff:g}),$&&(nt.push({cmd:"CALL",fnName:$,params:[{var:0},{val:Z},{var:0}]}),nt.push({cmd:"CALL",fnName:$,params:[{var:1},{val:Z},{var:1}]})),nt.push({cmd:"CALL",fnName:D,params:[{var:0},{var:1},{val:Z},{var:2},{var:3},{val:i.s}]}),v&&(nt.push({cmd:"CALL",fnName:v,params:[{var:0},{val:Z},{var:0}]}),nt.push({cmd:"CALL",fnName:v,params:[{var:1},{val:Z},{var:1}]})),nt.push({cmd:"GET",out:0,var:0,len:Z*m}),nt.push({cmd:"GET",out:1,var:1,len:Z*m}),R.push(o.queueAction(nt).then(pt=>(C&&C.debug(`${U}: fftJoinExt End: ${it}/${k}`),pt)))}const E=await Promise.all(R);let z,tt;k*m>1<<28?(z=new Kt(k*m),tt=new Kt(k*m)):(z=new Uint8Array(k*m),tt=new Uint8Array(k*m));let at=0;for(let it=0;it<E.length;it++)z.set(E[it][0],at),tt.set(E[it][1],at),at+=E[it][0].byteLength;return[z,tt]}n.fft=async function(u,s,_,L,g){return await a(u,!1,s,_,L,g)},n.ifft=async function(u,s,_,L,g){return await a(u,!0,s,_,L,g)},n.lagrangeEvaluations=async function(u,s,_,L,g){s=s||"affine",_=_||"affine";let F;if(t=="G1")s=="affine"?F=n.F.n8*2:F=n.F.n8*3;else if(t=="G2")s=="affine"?F=n.F.n8*2:F=n.F.n8*3;else if(t=="Fr")F=i.n8;else throw new Error("Invalid group");const T=u.byteLength/F,C=$e(T);if(2**C*F!=u.byteLength)throw L&&L.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(C<=i.s)return await n.ifft(u,s,_,L,g);if(C>i.s+1)throw L&&L.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let U=u.slice(0,u.byteLength/2),x=u.slice(u.byteLength/2,u.byteLength);const V=i.exp(i.shift,T/2),D=i.inv(i.sub(i.one,V));[U,x]=await h(U,x,"prepareLagrangeEvaluation",D,i.shiftInv,s,"jacobian",L,g+" prep");const $=[];$.push(a(U,!0,"jacobian",_,L,g+" t0")),$.push(a(x,!0,"jacobian",_,L,g+" t1")),[U,x]=await Promise.all($);let v;return U.byteLength>1<<28?v=new Kt(U.byteLength*2):v=new Uint8Array(U.byteLength*2),v.set(U),v.set(x,U.byteLength),v},n.fftMix=async function(s){const _=n.F.n8*3;let L,g;if(t=="G1")L="g1m_fftMix",g="g1m_fftJoin";else if(t=="G2")L="g2m_fftMix",g="g2m_fftJoin";else if(t=="Fr")L="frm_fftMix",g="frm_fftJoin";else throw new Error("Invalid group");const F=Math.floor(s.byteLength/_),T=$e(F);let C=1<<$e(o.concurrency);F<=C*2&&(C=1);const U=F/C,x=$e(U),V=[];for(let y=0;y<C;y++){const G=[],k=s.slice(y*U*_,(y+1)*U*_);G.push({cmd:"ALLOCSET",var:0,buff:k});for(let N=1;N<=x;N++)G.push({cmd:"CALL",fnName:L,params:[{var:0},{val:U},{val:N}]});G.push({cmd:"GET",out:0,var:0,len:U*_}),V.push(o.queueAction(G))}const D=await Promise.all(V),$=[];for(let y=0;y<D.length;y++)$[y]=D[y][0];for(let y=x+1;y<=T;y++){const G=1<<T-y,k=C/G,N=[];for(let E=0;E<G;E++)for(let z=0;z<k/2;z++){const tt=i.exp(i.w[y],z*U),at=i.w[y],it=E*k+z,Z=E*k+z+k/2,ot=[];ot.push({cmd:"ALLOCSET",var:0,buff:$[it]}),ot.push({cmd:"ALLOCSET",var:1,buff:$[Z]}),ot.push({cmd:"ALLOCSET",var:2,buff:tt}),ot.push({cmd:"ALLOCSET",var:3,buff:at}),ot.push({cmd:"CALL",fnName:g,params:[{var:0},{var:1},{val:U},{var:2},{var:3}]}),ot.push({cmd:"GET",out:0,var:0,len:U*_}),ot.push({cmd:"GET",out:1,var:1,len:U*_}),N.push(o.queueAction(ot))}const R=await Promise.all(N);for(let E=0;E<G;E++)for(let z=0;z<k/2;z++){const tt=E*k+z,at=E*k+z+k/2,it=R.shift();$[tt]=it[0],$[at]=it[1]}}let v;s instanceof Kt?v=new Kt(F*_):v=new Uint8Array(F*_);let m=0;for(let y=0;y<C;y++)v.set($[y],m),m+=$[y].byteLength;return v},n.fftJoin=async function(s,_,L,g){const F=n.F.n8*3;let T;if(t=="G1")T="g1m_fftJoin";else if(t=="G2")T="g2m_fftJoin";else if(t=="Fr")T="frm_fftJoin";else throw new Error("Invalid group");if(s.byteLength!=_.byteLength)throw new Error("Invalid buffer size");const C=Math.floor(s.byteLength/F);if(C!=1<<$e(C))throw new Error("Invalid number of points");let U=1<<$e(o.concurrency);C<=U*2&&(U=1);const x=C/U,V=[];for(let y=0;y<U;y++){const G=[],k=i.mul(L,i.exp(g,y*x)),N=s.slice(y*x*F,(y+1)*x*F),R=_.slice(y*x*F,(y+1)*x*F);G.push({cmd:"ALLOCSET",var:0,buff:N}),G.push({cmd:"ALLOCSET",var:1,buff:R}),G.push({cmd:"ALLOCSET",var:2,buff:k}),G.push({cmd:"ALLOCSET",var:3,buff:g}),G.push({cmd:"CALL",fnName:T,params:[{var:0},{var:1},{val:x},{var:2},{var:3}]}),G.push({cmd:"GET",out:0,var:0,len:x*F}),G.push({cmd:"GET",out:1,var:1,len:x*F}),V.push(o.queueAction(G))}const D=await Promise.all(V);let $,v;s instanceof Kt?($=new Kt(C*F),v=new Kt(C*F)):($=new Uint8Array(C*F),v=new Uint8Array(C*F));let m=0;for(let y=0;y<D.length;y++)$.set(D[y][0],m),v.set(D[y][1],m),m+=D[y][0].byteLength;return[$,v]},n.fftFinal=async function(s,_){const L=n.F.n8*3,g=n.F.n8*2;let F,T;if(t=="G1")F="g1m_fftFinal",T="g1m_batchToAffine";else if(t=="G2")F="g2m_fftFinal",T="g2m_batchToAffine";else throw new Error("Invalid group");const C=Math.floor(s.byteLength/L);if(C!=1<<$e(C))throw new Error("Invalid number of points");const U=Math.floor(C/o.concurrency),x=[];for(let v=0;v<o.concurrency;v++){let m;if(v<o.concurrency-1?m=U:m=C-v*U,m==0)continue;const y=[],G=s.slice(v*U*L,(v*U+m)*L);y.push({cmd:"ALLOCSET",var:0,buff:G}),y.push({cmd:"ALLOCSET",var:1,buff:_}),y.push({cmd:"CALL",fnName:F,params:[{var:0},{val:m},{var:1}]}),y.push({cmd:"CALL",fnName:T,params:[{var:0},{val:m},{var:0}]}),y.push({cmd:"GET",out:0,var:0,len:m*g}),x.push(o.queueAction(y))}const V=await Promise.all(x);let D;s instanceof Kt?D=new Kt(C*g):D=new Uint8Array(C*g);let $=0;for(let v=V.length-1;v>=0;v--)D.set(V[v][0],$),$+=V[v][0].byteLength;return D}}async function ju(e){const t=await CL(e.wasm,e.singleThread),n={};return n.q=pe(e.wasm.q.toString()),n.r=pe(e.wasm.r.toString()),n.name=e.name,n.tm=t,n.prePSize=e.wasm.prePSize,n.preQSize=e.wasm.preQSize,n.Fr=new zu(t,"frm",e.n8r,e.r),n.F1=new zu(t,"f1m",e.n8q,e.q),n.F2=new Du(t,"f2m",n.F1),n.G1=new ku(t,"g1m",n.F1,e.wasm.pG1gen,e.wasm.pG1b,e.cofactorG1),n.G2=new ku(t,"g2m",n.F2,e.wasm.pG2gen,e.wasm.pG2b,e.cofactorG2),n.F6=new AL(t,"f6m",n.F2),n.F12=new Du(t,"ftm",n.F6),n.Gt=n.F12,Vr(n,"G1"),Vr(n,"G2"),Vr(n,"Fr"),Hu(n,"G1"),Hu(n,"G2"),Kr(n,"G1"),Kr(n,"G2"),Kr(n,"Fr"),FL(n),n.array2buffer=function(i,o){const a=new Uint8Array(o*i.length);for(let c=0;c<i.length;c++)a.set(i[c],c*o);return a},n.buffer2array=function(i,o){const a=i.byteLength/o,c=new Array(a);for(let d=0;d<a;d++)c[d]=i.slice(d*o,d*o+o);return c},n}globalThis.curve_bn128=null;async function SL(e,t){const n=new Uo;n.setMemory(25),ql(n),t&&t(n);const i={};if(i.code=n.build(),i.pq=n.modules.f1m.pq,i.pr=n.modules.frm.pq,i.pG1gen=n.modules.bn128.pG1gen,i.pG1zero=n.modules.bn128.pG1zero,i.pG1b=n.modules.bn128.pG1b,i.pG2gen=n.modules.bn128.pG2gen,i.pG2zero=n.modules.bn128.pG2zero,i.pG2b=n.modules.bn128.pG2b,i.pOneT=n.modules.bn128.pOneT,i.prePSize=n.modules.bn128.prePSize,i.preQSize=n.modules.bn128.preQSize,i.n8q=32,i.n8r=32,i.q=n.modules.bn128.q,i.r=n.modules.bn128.r,!e&&globalThis.curve_bn128)return globalThis.curve_bn128;const o={name:"bn128",wasm:i,q:pe("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:pe("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:pe("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!e},a=await ju(o);return a.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},e||(globalThis.curve_bn128=a),a}globalThis.curve_bls12381=null;async function BL(e,t){const n=new Uo;n.setMemory(25),zl(n),t&&t(n);const i={};if(i.code=n.build(),i.pq=n.modules.f1m.pq,i.pr=n.modules.frm.pq,i.pG1gen=n.modules.bls12381.pG1gen,i.pG1zero=n.modules.bls12381.pG1zero,i.pG1b=n.modules.bls12381.pG1b,i.pG2gen=n.modules.bls12381.pG2gen,i.pG2zero=n.modules.bls12381.pG2zero,i.pG2b=n.modules.bls12381.pG2b,i.pOneT=n.modules.bls12381.pOneT,i.prePSize=n.modules.bls12381.prePSize,i.preQSize=n.modules.bls12381.preQSize,i.n8q=48,i.n8r=32,i.q=n.modules.bls12381.q,i.r=n.modules.bls12381.r,!e&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const o={name:"bls12381",wasm:i,q:pe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:pe("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:pe("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:pe("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!e},a=await ju(o);return a.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},e||(globalThis.curve_bls12381=a),a}pe("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),pe("21888242871839275222246405745257275088548364400416034343698204186575808495617"),pe("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),pe("21888242871839275222246405745257275088696311157297823662689037894645226208583");const se=Ym,xL=yL;se.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),se.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const OL=se.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),TL=se.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function Nn(e){let t;if(se.eq(e,TL))t=await SL();else if(se.eq(e,OL))t=await BL();else throw new Error(`Curve not supported: ${se.toString(e)}`);return t}var hn={exports:{}},PL=Ku;class Vu extends Error{}Vu.prototype.name="AssertionError";function Ku(e,t){if(!e){var n=new Vu(t);throw Error.captureStackTrace&&Error.captureStackTrace(n,Ku),n}}function Yu(e){return e.length}function RL(e){const t=e.byteLength;let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}function UL(e,t,n=0,i=Yu(t)){const o=Math.min(i,e.byteLength-n);for(let a=0;a<o;a++)e[n+a]=t.charCodeAt(a);return o}var ML={byteLength:Yu,toString:RL,write:UL};const Fi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ei=new Uint8Array(256);for(let e=0;e<Fi.length;e++)ei[Fi.charCodeAt(e)]=e;ei[45]=62,ei[95]=63;function Zu(e){let t=e.length;return e.charCodeAt(t-1)===61&&t--,t>1&&e.charCodeAt(t-1)===61&&t--,t*3>>>2}function GL(e){const t=e.byteLength;let n="";for(let i=0;i<t;i+=3)n+=Fi[e[i]>>2]+Fi[(e[i]&3)<<4|e[i+1]>>4]+Fi[(e[i+1]&15)<<2|e[i+2]>>6]+Fi[e[i+2]&63];return t%3==2?n=n.substring(0,n.length-1)+"=":t%3==1&&(n=n.substring(0,n.length-2)+"=="),n}function NL(e,t,n=0,i=Zu(t)){const o=Math.min(i,e.byteLength-n);for(let a=0,c=0;a<o;a+=4){const d=ei[t.charCodeAt(a)],h=ei[t.charCodeAt(a+1)],u=ei[t.charCodeAt(a+2)],s=ei[t.charCodeAt(a+3)];e[c++]=d<<2|h>>4,e[c++]=(h&15)<<4|u>>2,e[c++]=(u&3)<<6|s&63}return o}var qL={byteLength:Zu,toString:GL,write:NL};function Ju(e){return e.length>>>1}function zL(e){const t=e.byteLength;e=new DataView(e.buffer,e.byteOffset,t);let n="",i=0;for(let o=t-t%4;i<o;i+=4)n+=e.getUint32(i).toString(16).padStart(8,"0");for(;i<t;i++)n+=e.getUint8(i).toString(16).padStart(2,"0");return n}function DL(e,t,n=0,i=Ju(t)){const o=Math.min(i,e.byteLength-n);for(let a=0;a<o;a++){const c=Xu(t.charCodeAt(a*2)),d=Xu(t.charCodeAt(a*2+1));if(c===void 0||d===void 0)return e.subarray(0,a);e[n+a]=c<<4|d}return o}var kL={byteLength:Ju,toString:zL,write:DL};function Xu(e){if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-65+10;if(e>=97&&e<=102)return e-97+10}function Yr(e){let t=0;for(let n=0,i=e.length;n<i;n++){const o=e.charCodeAt(n);if(o>=55296&&o<=56319&&n+1<i){const a=e.charCodeAt(n+1);if(a>=56320&&a<=57343){t+=4,n++;continue}}o<=127?t+=1:o<=2047?t+=2:t+=3}return t}let Zr;if(typeof TextDecoder!="undefined"){const e=new TextDecoder;Zr=function(n){return e.decode(n)}}else Zr=function(t){const n=t.byteLength;let i="",o=0;for(;o<n;){let a=t[o];if(a<=127){i+=String.fromCharCode(a),o++;continue}let c=0,d=0;if(a<=223?(c=1,d=a&31):a<=239?(c=2,d=a&15):a<=244&&(c=3,d=a&7),n-o-c>0){let h=0;for(;h<c;)a=t[o+h+1],d=d<<6|a&63,h+=1}else d=65533,c=n-o;i+=String.fromCodePoint(d),o+=c+1}return i};let Jr;if(typeof TextEncoder!="undefined"){const e=new TextEncoder;Jr=function(n,i,o=0,a=Yr(i)){const c=Math.min(a,n.byteLength-o);return e.encodeInto(i,n.subarray(o,o+c)),c}}else Jr=function(t,n,i=0,o=Yr(n)){const a=Math.min(o,t.byteLength-i);t=t.subarray(i,i+a);let c=0,d=0;for(;c<n.length;){const h=n.codePointAt(c);if(h<=127){t[d++]=h,c++;continue}let u=0,s=0;for(h<=2047?(u=6,s=192):h<=65535?(u=12,s=224):h<=2097151&&(u=18,s=240),t[d++]=s|h>>u,u-=6;u>=0;)t[d++]=128|h>>u&63,u-=6;c+=h>=65536?2:1}return a};var QL={byteLength:Yr,toString:Zr,write:Jr};function td(e){return e.length*2}function WL(e){const t=e.byteLength;let n="";for(let i=0;i<t-1;i+=2)n+=String.fromCharCode(e[i]+e[i+1]*256);return n}function $L(e,t,n=0,i=td(t)){const o=Math.min(i,e.byteLength-n);let a=o;for(let c=0;c<t.length&&!((a-=2)<0);++c){const d=t.charCodeAt(c),h=d>>8,u=d%256;e[n+c*2]=u,e[n+c*2+1]=h}return o}var HL={byteLength:td,toString:WL,write:$L};const jL=ML,VL=qL,KL=kL,YL=QL,ZL=HL,Ho=new Uint8Array(Uint16Array.of(255).buffer)[0]===255;function so(e){switch(e){case"ascii":return jL;case"base64":return VL;case"hex":return KL;case"utf8":case"utf-8":case void 0:return YL;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ZL;default:throw new Error(`Unknown encoding: ${e}`)}}function ed(e){return e instanceof Uint8Array}function JL(e){try{return so(e),!0}catch{return!1}}function XL(e,t,n){const i=new Uint8Array(e);return t!==void 0&&t(i,t,0,i.byteLength,n),i}function ty(e){return new Uint8Array(e)}function ey(e){return new Uint8Array(e)}function ny(e,t){return so(t).byteLength(e)}function iy(e,t){if(e===t)return 0;const n=Math.min(e.byteLength,t.byteLength);e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let i=0;for(let o=n-n%4;i<o;i+=4){const a=e.getUint32(i,Ho),c=t.getUint32(i,Ho);if(a!==c)break}for(;i<n;i++){const o=e.getUint8(i),a=t.getUint8(i);if(o<a)return-1;if(o>a)return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}function oy(e,t){t===void 0&&(t=e.reduce((i,o)=>i+o.byteLength,0));const n=new Uint8Array(t);return e.reduce((i,o)=>(n.set(o,i),i+o.byteLength),0),n}function ay(e,t,n=0,i=0,o=e.byteLength){if(o>0&&o<i||o===i||e.byteLength===0||t.byteLength===0)return 0;if(n<0)throw new RangeError("targetStart is out of range");if(i<0||i>=e.byteLength)throw new RangeError("sourceStart is out of range");if(o<0)throw new RangeError("sourceEnd is out of range");n>=t.byteLength&&(n=t.byteLength),o>e.byteLength&&(o=e.byteLength),t.byteLength-n<o-i&&(o=t.length-n+i);const a=o-i;return e===t?t.copyWithin(n,i,o):t.set(e.subarray(i,o),n),a}function ry(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const n=e.byteLength;e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let i=0;for(let o=n-n%4;i<o;i+=4)if(e.getUint32(i,Ho)!==t.getUint32(i,Ho))return!1;for(;i<n;i++)if(e.getUint8(i)!==t.getUint8(i))return!1;return!0}function sy(e,t,n,i,o){if(typeof t=="string"?typeof n=="string"?(o=n,n=0,i=e.byteLength):typeof i=="string"&&(o=i,i=e.byteLength):typeof val=="number"?t=t&255:typeof val=="boolean"&&(t=+t),n<0||e.byteLength<n||e.byteLength<i)throw new RangeError("Out of range index");if(n===void 0&&(n=0),i===void 0&&(i=e.byteLength),i<=n)return e;if(t||(t=0),typeof t=="number")for(let a=n;a<i;++a)e[a]=t;else{t=ed(t)?t:Xr(t,o);const a=t.byteLength;for(let c=0;c<i-n;++c)e[c+n]=t[c%a]}return e}function Xr(e,t,n){return typeof e=="string"?cy(e,t):Array.isArray(e)?ly(e):ArrayBuffer.isView(e)?uy(e):dy(e,t,n)}function cy(e,t){const n=so(t),i=new Uint8Array(n.byteLength(e));return n.write(i,e,0,i.byteLength),i}function ly(e){const t=new Uint8Array(e.length);return t.set(e),t}function uy(e){const t=new Uint8Array(e.byteLength);return t.set(e),t}function dy(e,t,n){return new Uint8Array(e,t,n)}function fy(e,t,n,i){return id(e,t,n,i)!==-1}function nd(e,t,n,i,o){if(e.byteLength===0)return-1;if(typeof n=="string"?(i=n,n=0):n===void 0?n=o?0:e.length-1:n<0&&(n+=e.byteLength),n>=e.byteLength){if(o)return-1;n=e.byteLength-1}else if(n<0)if(o)n=0;else return-1;if(typeof t=="string")t=Xr(t,i);else if(typeof t=="number")return t=t&255,o?e.indexOf(t,n):e.lastIndexOf(t,n);if(t.byteLength===0)return-1;if(o){let a=-1;for(let c=n;c<e.byteLength;c++)if(e[c]===t[a===-1?0:c-a]){if(a===-1&&(a=c),c-a+1===t.byteLength)return a}else a!==-1&&(c-=c-a),a=-1}else{n+t.byteLength>e.byteLength&&(n=e.byteLength-t.byteLength);for(let a=n;a>=0;a--){let c=!0;for(let d=0;d<t.byteLength;d++)if(e[a+d]!==t[d]){c=!1;break}if(c)return a}}return-1}function id(e,t,n,i){return nd(e,t,n,i,!0)}function hy(e,t,n,i){return nd(e,t,n,i,!1)}function ni(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function gy(e){const t=e.byteLength;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<t;n+=2)ni(e,n,n+1);return e}function py(e){const t=e.byteLength;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<t;n+=4)ni(e,n,n+3),ni(e,n+1,n+2);return e}function _y(e){const t=e.byteLength;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<t;n+=8)ni(e,n,n+7),ni(e,n+1,n+6),ni(e,n+2,n+5),ni(e,n+3,n+4);return e}function my(e){return e}function Ly(e,t,n=0,i=e.byteLength){const o=e.byteLength;return n>=o||i<=n?"":(n<0&&(n=0),i>o&&(i=o),(n!==0||i<o)&&(e=e.subarray(n,i)),so(t).toString(e))}function yy(e,t,n,i,o){return n===void 0?o="utf8":i===void 0&&typeof n=="string"?(o=n,n=void 0):o===void 0&&typeof i=="string"&&(o=i,i=void 0),so(o).write(e,t,n,i)}var Ay={isBuffer:ed,isEncoding:JL,alloc:XL,allocUnsafe:ty,allocUnsafeSlow:ey,byteLength:ny,compare:iy,concat:oy,copy:ay,equals:ry,fill:sy,from:Xr,includes:fy,indexOf:id,lastIndexOf:hy,swap16:gy,swap32:py,swap64:_y,toBuffer:my,toString:Ly,write:yy},wy=(e,t)=>function(){return t||(0,e[Object.keys(e)[0]])((t={exports:{}}).exports,t),t.exports},Iy=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return n=>{for(var i=n.length,o=new Uint8Array((i-(n[i-1]=="=")-(n[i-2]=="="))*3/4|0),a=0,c=0;a<i;){var d=e[n.charCodeAt(a++)],h=e[n.charCodeAt(a++)],u=e[n.charCodeAt(a++)],s=e[n.charCodeAt(a++)];o[c++]=d<<2|h>>4,o[c++]=h<<4|u>>2,o[c++]=u<<6|s}return o}})(),by=wy({"wasm-binary:./blake2b.wat"(e,t){t.exports=Iy("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}}),Ey=by(),Cy=WebAssembly.compile(Ey),vy=async e=>(await WebAssembly.instantiate(await Cy,e)).exports,He=PL,Fy=Ay,vn=null,od=typeof WebAssembly!="undefined"&&vy().then(e=>{vn=e}),Fn=64,jo=[];hn.exports=Re;var ad=hn.exports.BYTES_MIN=16,rd=hn.exports.BYTES_MAX=64;hn.exports.BYTES=32;var sd=hn.exports.KEYBYTES_MIN=16,cd=hn.exports.KEYBYTES_MAX=64;hn.exports.KEYBYTES=32;var ld=hn.exports.SALTBYTES=16,ud=hn.exports.PERSONALBYTES=16;function Re(e,t,n,i,o){if(!(this instanceof Re))return new Re(e,t,n,i,o);if(!vn)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");e||(e=32),o!==!0&&(He(e>=ad,"digestLength must be at least "+ad+", was given "+e),He(e<=rd,"digestLength must be at most "+rd+", was given "+e),t!=null&&(He(t instanceof Uint8Array,"key must be Uint8Array or Buffer"),He(t.length>=sd,"key must be at least "+sd+", was given "+t.length),He(t.length<=cd,"key must be at least "+cd+", was given "+t.length)),n!=null&&(He(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),He(n.length===ld,"salt must be exactly "+ld+", was given "+n.length)),i!=null&&(He(i instanceof Uint8Array,"personal must be Uint8Array or Buffer"),He(i.length===ud,"personal must be exactly "+ud+", was given "+i.length))),jo.length||(jo.push(Fn),Fn+=216),this.digestLength=e,this.finalized=!1,this.pointer=jo.pop(),this._memory=new Uint8Array(vn.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=t?t.length:0,this._memory[2]=1,this._memory[3]=1,n&&this._memory.set(n,32),i&&this._memory.set(i,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),vn.blake2b_init(this.pointer,this.digestLength),t&&(this.update(t),this._memory.fill(0,Fn,Fn+t.length),this._memory[this.pointer+200]=128)}Re.prototype._realloc=function(e){vn.memory.grow(Math.max(0,Math.ceil(Math.abs(e-this._memory.length)/65536))),this._memory=new Uint8Array(vn.memory.buffer)},Re.prototype.update=function(e){return He(this.finalized===!1,"Hash instance finalized"),He(e instanceof Uint8Array,"input must be Uint8Array or Buffer"),Fn+e.length>this._memory.length&&this._realloc(Fn+e.length),this._memory.set(e,Fn),vn.blake2b_update(this.pointer,Fn,Fn+e.length),this},Re.prototype.digest=function(e){if(He(this.finalized===!1,"Hash instance finalized"),this.finalized=!0,jo.push(this.pointer),vn.blake2b_final(this.pointer),!e||e==="binary")return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if(typeof e=="string")return Fy.toString(this._memory,e,this.pointer+128,this.pointer+128+this.digestLength);He(e instanceof Uint8Array&&e.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var t=0;t<this.digestLength;t++)e[t]=this._memory[this.pointer+128+t];return e},Re.prototype.final=Re.prototype.digest,Re.WASM=vn,Re.SUPPORTED=typeof WebAssembly!="undefined",Re.ready=function(e){return e||(e=Sy),od?od.then(()=>e(),e):e(new Error("WebAssembly not supported"))},Re.prototype.ready=Re.ready,Re.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},Re.prototype.setPartialHash=function(e){this._memory.set(e,this.pointer)};function Sy(){}var tn=hn.exports;function Vo(e){return((e&4294901760)!=0?(e&=4294901760,16):0)|((e&4278255360)!=0?(e&=4278255360,8):0)|((e&4042322160)!=0?(e&=4042322160,4):0)|((e&3435973836)!=0?(e&=3435973836,2):0)|(e&2863311530)!=0}function co(e,t){const n=new DataView(e.buffer,e.byteOffset,e.byteLength);let i="";for(let o=0;o<4;o++){o>0&&(i+=`
`),i+="		";for(let a=0;a<4;a++)a>0&&(i+=" "),i+=n.getUint32(o*16+a*4).toString(16).padStart(8,"0")}return t&&(i=t+`
`+i),i}function dd(e,t){if(e.byteLength!=t.byteLength)return!1;for(var n=new Int8Array(e),i=new Int8Array(t),o=0;o!=e.byteLength;o++)if(n[o]!=i[o])return!1;return!0}function By(e){const t=e.getPartialHash(),n=tn(64);return n.setPartialHash(t),n}async function xy(e,t,n,i,o){return e.G1.isZero(t)||e.G1.isZero(n)||e.G2.isZero(i)||e.G2.isZero(o)?!1:await e.pairingEq(t,o,e.G1.neg(n),i)}function Oy(){return window.prompt("Enter a random text. (Entropy): ","")}async function Ty(e){for(;!e;)e=await Oy();const t=tn(64);t.update(Oo.randomBytes(64));const n=new TextEncoder;t.update(n.encode(e));const i=Buffer.from(t.digest()),o=[];for(let c=0;c<8;c++)o[c]=i.readUInt32BE(c*4);return new ao(o)}function Py(e,t){let n,i;t<32?(n=1<<t>>>0,i=1):(n=4294967296,i=1<<t-32>>>0);let o=e;for(let h=0;h<i;h++)for(let u=0;u<n;u++)o=Oo.createHash("sha256").update(o).digest();const a=new DataView(o.buffer,o.byteOffset,o.byteLength),c=[];for(let h=0;h<8;h++)c[h]=a.getUint32(h*4,!1);return new ao(c)}function Ry(e){return Array.prototype.map.call(e,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}async function Uy(e,t){await fe(e,1),await e.writeULE32(1),await he(e);const n=await Nn(t.q);await fe(e,2);const i=n.q,o=(Math.floor((se.bitLength(i)-1)/64)+1)*8,a=n.r,c=(Math.floor((se.bitLength(a)-1)/64)+1)*8;await e.writeULE32(o),await bi(e,i,o),await e.writeULE32(c),await bi(e,a,c),await e.writeULE32(t.nVars),await e.writeULE32(t.nPublic),await e.writeULE32(t.domainSize),await Si(e,n,t.vk_alpha_1),await Si(e,n,t.vk_beta_1),await Ko(e,n,t.vk_beta_2),await Ko(e,n,t.vk_gamma_2),await Si(e,n,t.vk_delta_1),await Ko(e,n,t.vk_delta_2),await he(e)}async function Si(e,t,n){const i=new Uint8Array(t.G1.F.n8*2);t.G1.toRprLEM(i,0,n),await e.write(i)}async function Ko(e,t,n){const i=new Uint8Array(t.G2.F.n8*2);t.G2.toRprLEM(i,0,n),await e.write(i)}async function ze(e,t,n){const i=await e.read(t.G1.F.n8*2),o=t.G1.fromRprLEM(i,0);return n?t.G1.toObject(o):o}async function lo(e,t,n){const i=await e.read(t.G2.F.n8*2),o=t.G2.fromRprLEM(i,0);return n?t.G2.toObject(o):o}async function Yo(e,t,n){await Ne(e,t,1);const i=await e.readULE32();if(await qe(e),i==1)return await My(e,t,n);if(i==2)return await Gy(e,t);throw new Error("Protocol not supported: ")}async function My(e,t,n){const i={};i.protocol="groth16",await Ne(e,t,2);const o=await e.readULE32();i.n8q=o,i.q=await Ei(e,o);const a=await e.readULE32();i.n8r=a,i.r=await Ei(e,a);let c=await Nn(i.q);return i.nVars=await e.readULE32(),i.nPublic=await e.readULE32(),i.domainSize=await e.readULE32(),i.power=Vo(i.domainSize),i.vk_alpha_1=await ze(e,c,n),i.vk_beta_1=await ze(e,c,n),i.vk_beta_2=await lo(e,c,n),i.vk_gamma_2=await lo(e,c,n),i.vk_delta_1=await ze(e,c,n),i.vk_delta_2=await lo(e,c,n),await qe(e),i}async function Gy(e,t,n,i){const o={};o.protocol="plonk",await Ne(e,t,2);const a=await e.readULE32();o.n8q=a,o.q=await Ei(e,a);const c=await e.readULE32();o.n8r=c,o.r=await Ei(e,c);let d=await Nn(o.q);return o.nVars=await e.readULE32(),o.nPublic=await e.readULE32(),o.domainSize=await e.readULE32(),o.power=Vo(o.domainSize),o.nAdditions=await e.readULE32(),o.nConstrains=await e.readULE32(),o.k1=await e.read(c),o.k2=await e.read(c),o.Qm=await ze(e,d,i),o.Ql=await ze(e,d,i),o.Qr=await ze(e,d,i),o.Qo=await ze(e,d,i),o.Qc=await ze(e,d,i),o.S1=await ze(e,d,i),o.S2=await ze(e,d,i),o.S3=await ze(e,d,i),o.X_2=await lo(e,d,i),await qe(e),o}async function Ny(e,t,n){const i={delta:{}};i.deltaAfter=await ze(e,t,n),i.delta.g1_s=await ze(e,t,n),i.delta.g1_sx=await ze(e,t,n),i.delta.g2_spx=await lo(e,t,n),i.transcript=await e.read(64),i.type=await e.readULE32();const o=await e.readULE32(),a=e.pos;let c=0;for(;e.pos-a<o;){const d=await e.read(1);if(d[0]<=c)throw new Error("Parameters in the contribution must be sorted");if(c=d[0],d[0]==1){const h=await e.read(1),u=await e.read(h[0]);i.name=new TextDecoder().decode(u)}else if(d[0]==2){const h=await e.read(1);i.numIterationsExp=h[0]}else if(d[0]==3){const h=await e.read(1);i.beaconHash=await e.read(h[0])}else throw new Error("Parameter not recognized")}if(e.pos!=a+o)throw new Error("Parametes do not match");return i}async function ts(e,t,n){await Ne(e,n,10);const i={contributions:[]};i.csHash=await e.read(64);const o=await e.readULE32();for(let a=0;a<o;a++){const c=await Ny(e,t);i.contributions.push(c)}return await qe(e),i}async function qy(e,t,n){await Si(e,t,n.deltaAfter),await Si(e,t,n.delta.g1_s),await Si(e,t,n.delta.g1_sx),await Ko(e,t,n.delta.g2_spx),await e.write(n.transcript),await e.writeULE32(n.type||0);const i=[];if(n.name){i.push(1);const o=new TextEncoder("utf-8").encode(n.name.substring(0,64));i.push(o.byteLength);for(let a=0;a<o.byteLength;a++)i.push(o[a])}if(n.type==1){i.push(2),i.push(n.numIterationsExp),i.push(3),i.push(n.beaconHash.byteLength);for(let o=0;o<n.beaconHash.byteLength;o++)i.push(n.beaconHash[o])}if(i.length>0){const o=new Uint8Array(i);await e.writeULE32(o.byteLength),await e.write(o)}else await e.writeULE32(0)}async function zy(e,t,n){await fe(e,10),await e.write(n.csHash),await e.writeULE32(n.contributions.length);for(let i=0;i<n.contributions.length;i++)await qy(e,t,n.contributions[i]);await he(e)}function ii(e,t,n){const i=new Uint8Array(t.G1.F.n8*2);t.G1.toRprUncompressed(i,0,n),e.update(i)}function Dy(e,t,n){const i=new Uint8Array(t.G2.F.n8*2);t.G2.toRprUncompressed(i,0,n),e.update(i)}function Zo(e,t,n){ii(e,t,n.deltaAfter),ii(e,t,n.delta.g1_s),ii(e,t,n.delta.g1_sx),Dy(e,t,n.delta.g2_spx),e.update(n.transcript)}function fd(e,t){const n=new DataView(t.buffer,t.byteOffset,t.byteLength),i=[];for(let c=0;c<8;c++)i[c]=n.getUint32(c*4);const o=new ao(i);return e.G2.fromRng(o)}async function hd(e,t){if(!t[1])throw new Error(e.fileName+": File has no  header");if(t[1].length>1)throw new Error(e.fileName+": File has more than one header");e.pos=t[1][0].p;const n=await e.readULE32(),i=await e.read(n),o=se.fromRprLE(i),a=await Nn(o);if(a.F1.n64*8!=n)throw new Error(e.fileName+": Invalid size");const c=await e.readULE32(),d=await e.readULE32();if(e.pos-t[1][0].p!=t[1][0].size)throw new Error("Invalid PTau header size");return{curve:a,power:c,ceremonyPower:d}}async function gd(e,t,n,i,o,a,c,d,h,u){const s=1<<16,_=o[a],L=_.F.n8*2,g=t[i][0].size/L;await Ne(e,t,i),await fe(n,i);let F=c;for(let T=0;T<g;T+=s){u&&u.debug(`Applying key: ${h}: ${T}/${g}`);const C=Math.min(g-T,s);let U;U=await e.read(C*L),U=await _.batchApplyKey(U,F,d),await n.write(U),F=o.Fr.mul(F,o.Fr.exp(d,C))}await he(n),await qe(e)}se.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),se.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const gn=262144,ky={get:function(e,t){return isNaN(t)?e[t]:e.getElement(t)},set:function(e,t,n){return isNaN(t)?(e[t]=n,!0):e.setElement(t,n)}};class Qy{constructor(t){this.length=t||0,this.arr=new Array(gn);for(let n=0;n<t;n+=gn)this.arr[n/gn]=new Array(Math.min(gn,t-n));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,n){const i=new Array(n-t);for(let o=t;o<n;o++)i[o-t]=this.getElement(o);return i}getElement(t){t=parseInt(t);const n=Math.floor(t/gn),i=t%gn;return this.arr[n]?this.arr[n][i]:void 0}setElement(t,n){t=parseInt(t);const i=Math.floor(t/gn);this.arr[i]||(this.arr[i]=new Array(gn));const o=t%gn;return this.arr[i][o]=n,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new pn;for(let n=0;n<this.arr.length;n++)if(this.arr[n])for(let i=0;i<this.arr[n].length;i++)typeof this.arr[n][i]!="undefined"&&t.push(n*gn+i);return t}}class pn{constructor(t){const n=new Qy(t);return new Proxy(n,ky)}}async function pd(e,t,n,i){const o=0,a=1,c=2,d=3;await tn.ready();const h=tn(64),{fd:u,sections:s}=await We(t,"ptau",1),{curve:_,power:L}=await hd(u,s),{fd:g,sections:F}=await We(e,"r1cs",1),T=await zo(g,F,!1),C=await hr(n,"zkey",1,10,1<<22,1<<24),U=_.G1.F.n8*2,x=_.G2.F.n8*2;if(T.prime!=_.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;const V=Vo(T.nConstraints+T.nPubInputs+T.nOutputs+1-1)+1;if(V>L)return i&&i.error(`circuit too big for this power of tau ceremony. ${T.nConstraints}*2 > 2**${L}`),-1;if(!s[12])return i&&i.error("Powers of tau is not prepared."),-1;const D=T.nOutputs+T.nPubInputs,$=2**V;await fe(C,1),await C.writeULE32(1),await he(C),await fe(C,2);const v=_.q,m=(Math.floor((se.bitLength(v)-1)/64)+1)*8,y=_.r,G=(Math.floor((se.bitLength(y)-1)/64)+1)*8,k=se.mod(se.shl(1,G*8),y),N=_.Fr.e(se.mod(se.mul(k,k),y));await C.writeULE32(m),await bi(C,v,m),await C.writeULE32(G),await bi(C,y,G),await C.writeULE32(T.nVars),await C.writeULE32(D),await C.writeULE32($);let R;R=await u.read(U,s[4][0].p),await C.write(R),R=await _.G1.batchLEMtoU(R),h.update(R);let E;E=await u.read(U,s[5][0].p),await C.write(E),E=await _.G1.batchLEMtoU(E),h.update(E);let z;z=await u.read(x,s[6][0].p),await C.write(z),z=await _.G2.batchLEMtoU(z),h.update(z);const tt=new Uint8Array(U);_.G1.toRprLEM(tt,0,_.G1.g);const at=new Uint8Array(x);_.G2.toRprLEM(at,0,_.G2.g);const it=new Uint8Array(U);_.G1.toRprUncompressed(it,0,_.G1.g);const Z=new Uint8Array(x);_.G2.toRprUncompressed(Z,0,_.G2.g),await C.write(at),await C.write(tt),await C.write(at),h.update(Z),h.update(it),h.update(Z),await he(C),i&&i.info("Reading r1cs");let ot=await Cn(g,F,2);const nt=new pn(T.nVars),gt=new pn(T.nVars),xt=new pn(T.nVars),pt=new pn(T.nVars-D-1),yt=new Array(D+1);i&&i.info("Reading tauG1");let w=await Cn(u,s,12,($-1)*U,$*U);i&&i.info("Reading tauG2");let f=await Cn(u,s,13,($-1)*x,$*x);i&&i.info("Reading alphatauG1");let O=await Cn(u,s,14,($-1)*U,$*U);i&&i.info("Reading betatauG1");let p=await Cn(u,s,15,($-1)*U,$*U);await I(),await J(3,"G1",yt,"IC"),await q(),await lt(),await J(8,"G1",pt,"C"),await J(5,"G1",nt,"A"),await J(6,"G1",gt,"B1"),await J(7,"G2",xt,"B2");const W=h.digest();return await fe(C,10),await C.write(W),await C.writeULE32(0),await he(C),i&&i.info(co(W,"Circuit hash: ")),await C.close(),await g.close(),await u.close(),W;async function q(){await fe(C,9);const Ft=new Kt($*U);if(V<_.Fr.s){let Ct=await Cn(u,s,12,($*2-1)*U,$*2*U);for(let Lt=0;Lt<$;Lt++){i&&Lt%1e4==0&&i.debug(`spliting buffer: ${Lt}/${$}`);const Et=Ct.slice((Lt*2+1)*U,(Lt*2+1)*U+U);Ft.set(Et,Lt*U)}}else if(V==_.Fr.s){const Ct=s[12][0].p+(2**(V+1)-1)*U;await u.readToBuffer(Ft,0,$*U,Ct+$*U)}else throw i&&i.error("Circuit too big"),new Error("Circuit too big for this curve");await C.write(Ft),await he(C)}async function I(){const Ft=new Uint8Array(12+_.Fr.n8),Ct=new DataView(Ft.buffer),Lt=new Uint8Array(_.Fr.n8);_.Fr.toRprLE(Lt,0,_.Fr.e(1));let Et=0;function Bt(){const j=ot.slice(Et,Et+4);return Et+=4,new DataView(j.buffer).getUint32(0,!0)}const Pt=new pn;for(let j=0;j<T.nConstraints;j++){i&&j%1e4==0&&i.debug(`processing constraints: ${j}/${T.nConstraints}`);const rt=Bt();for(let b=0;b<rt;b++){const r=Bt(),l=Et;Et+=_.Fr.n8;const A=o,S=U*j,P=d,Q=U*j;typeof nt[r]=="undefined"&&(nt[r]=[]),nt[r].push([A,S,l]),r<=D?(typeof yt[r]=="undefined"&&(yt[r]=[]),yt[r].push([P,Q,l])):(typeof pt[r-D-1]=="undefined"&&(pt[r-D-1]=[]),pt[r-D-1].push([P,Q,l])),Pt.push([0,j,r,l])}const et=Bt();for(let b=0;b<et;b++){const r=Bt(),l=Et;Et+=_.Fr.n8;const A=o,S=U*j,P=a,Q=x*j,Y=c,st=U*j;typeof gt[r]=="undefined"&&(gt[r]=[]),gt[r].push([A,S,l]),typeof xt[r]=="undefined"&&(xt[r]=[]),xt[r].push([P,Q,l]),r<=D?(typeof yt[r]=="undefined"&&(yt[r]=[]),yt[r].push([Y,st,l])):(typeof pt[r-D-1]=="undefined"&&(pt[r-D-1]=[]),pt[r-D-1].push([Y,st,l])),Pt.push([1,j,r,l])}const ct=Bt();for(let b=0;b<ct;b++){const r=Bt(),l=Et;Et+=_.Fr.n8;const A=o,S=U*j;r<=D?(typeof yt[r]=="undefined"&&(yt[r]=[]),yt[r].push([A,S,l])):(typeof pt[r-D-1]=="undefined"&&(pt[r-D-1]=[]),pt[r-D-1].push([A,S,l]))}}for(let j=0;j<=D;j++){const rt=o,et=U*(T.nConstraints+j),ct=d,b=U*(T.nConstraints+j);typeof nt[j]=="undefined"&&(nt[j]=[]),nt[j].push([rt,et,-1]),typeof yt[j]=="undefined"&&(yt[j]=[]),yt[j].push([ct,b,-1]),Pt.push([0,T.nConstraints+j,j,-1])}await fe(C,4);const vt=new Kt(Pt.length*(12+_.Fr.n8)+4),Wt=new Uint8Array(4);new DataView(Wt.buffer).setUint32(0,Pt.length,!0),vt.set(Wt);let M=4;for(let j=0;j<Pt.length;j++)i&&j%1e5==0&&i.debug(`writing coeffs: ${j}/${Pt.length}`),H(Pt[j]);await C.write(vt),await he(C);function H(j){Ct.setUint32(0,j[0],!0),Ct.setUint32(4,j[1],!0),Ct.setUint32(8,j[2],!0);let rt;j[3]>=0?rt=_.Fr.fromRprLE(ot.slice(j[3],j[3]+_.Fr.n8),0):rt=_.Fr.fromRprLE(Lt,0);const et=_.Fr.mul(rt,N);_.Fr.toRprLE(Ft,12,et),vt.set(Ft,M),M+=Ft.length}}async function J(Ft,Ct,Lt,Et){const Bt=1<<15,Pt=_[Ct];Ot(Lt.length),await fe(C,Ft);let vt=[],Wt=0;for(;Wt<Lt.length;){let B=0;for(;Wt<Lt.length&&B<_.tm.concurrency;){i&&i.debug(`Writing points start ${Et}: ${Wt}/${Lt.length}`);let H=1,j=Lt[Wt]?Lt[Wt].length:0;for(;Wt+H<Lt.length&&j+(Lt[Wt+H]?Lt[Wt+H].length:0)<Bt&&H<Bt;)j+=Lt[Wt+H]?Lt[Wt+H].length:0,H++;const rt=Lt.slice(Wt,Wt+H),et=Wt;vt.push(dt(Ct,rt,i,Et).then(ct=>(i&&i.debug(`Writing points end ${Et}: ${et}/${Lt.length}`),ct))),Wt+=H,B++}const M=await Promise.all(vt);for(let H=0;H<M.length;H++){await C.write(M[H][0]);const j=await Pt.batchLEMtoU(M[H][0]);h.update(j)}vt=[]}await he(C)}async function dt(Ft,Ct,Lt,Et){const Bt=_[Ft],Pt=Bt.F.n8*2,vt=Bt.F.n8*3,Wt=Bt.F.n8*2;let B,M,H,j;if(Ft=="G1")B="g1m_timesScalarAffine",M="g1m_multiexpAffine",H="g1m_batchToAffine",j="g1m_zero";else if(Ft=="G2")B="g2m_timesScalarAffine",M="g2m_multiexpAffine",H="g2m_batchToAffine",j="g2m_zero";else throw new Error("Invalid group");let rt=0;for(let P=0;P<Ct.length;P++)rt+=Ct[P]?Ct[P].length:0;let et,ct;rt>2<<14?(et=new Kt(rt*Pt),ct=new Kt(rt*_.Fr.n8)):(et=new Uint8Array(rt*Pt),ct=new Uint8Array(rt*_.Fr.n8));let b=0,r=0;const l=[w,f,O,p],A=new Uint8Array(_.Fr.n8);_.Fr.toRprLE(A,0,_.Fr.e(1));let S=0;for(let P=0;P<Ct.length;P++)if(!!Ct[P])for(let Q=0;Q<Ct[P].length;Q++)Lt&&Q&&Q%1e4==0&&Lt.debug(`Configuring big array ${Et}: ${Q}/${Ct[P].length}`),et.set(l[Ct[P][Q][0]].slice(Ct[P][Q][1],Ct[P][Q][1]+Pt),S*Pt),Ct[P][Q][2]>=0?ct.set(ot.slice(Ct[P][Q][2],Ct[P][Q][2]+_.Fr.n8),S*_.Fr.n8):ct.set(A,S*_.Fr.n8),S++;if(Ct.length>1){const P=[];P.push({cmd:"ALLOCSET",var:0,buff:et}),P.push({cmd:"ALLOCSET",var:1,buff:ct}),P.push({cmd:"ALLOC",var:2,len:Ct.length*vt}),b=0,r=0;let Q=0;for(let st=0;st<Ct.length;st++){if(!Ct[st]){P.push({cmd:"CALL",fnName:j,params:[{var:2,offset:Q}]}),Q+=vt;continue}Ct[st].length==1?P.push({cmd:"CALL",fnName:B,params:[{var:0,offset:b},{var:1,offset:r},{val:_.Fr.n8},{var:2,offset:Q}]}):P.push({cmd:"CALL",fnName:M,params:[{var:0,offset:b},{var:1,offset:r},{val:_.Fr.n8},{val:Ct[st].length},{var:2,offset:Q}]}),b+=Pt*Ct[st].length,r+=_.Fr.n8*Ct[st].length,Q+=vt}return P.push({cmd:"CALL",fnName:H,params:[{var:2},{val:Ct.length},{var:2}]}),P.push({cmd:"GET",out:0,var:2,len:Ct.length*Wt}),await _.tm.queueAction(P)}else{let P=await Bt.multiExpAffine(et,ct,Lt,Et);return P=[Bt.toAffine(P)],P}}async function lt(){const Ft=1<<14;Ot($-1);for(let Ct=0;Ct<$-1;Ct+=Ft){i&&i.debug(`HashingHPoints: ${Ct}/${$}`);const Lt=Math.min($-1,Ft);await It(Ct,Lt)}}async function It(Ft,Ct){const Lt=await u.read(Ct*U,s[2][0].p+(Ft+$)*U),Et=await u.read(Ct*U,s[2][0].p+Ft*U),Bt=_.tm.concurrency,Pt=Math.floor(Ct/Bt),vt=[];for(let B=0;B<Bt;B++){let M;if(B<Bt-1?M=Pt:M=Ct-B*Pt,M==0)continue;const H=Lt.slice(B*Pt*U,(B*Pt+M)*U),j=Et.slice(B*Pt*U,(B*Pt+M)*U);vt.push(Ut(H,j))}const Wt=await Promise.all(vt);for(let B=0;B<Wt.length;B++)h.update(Wt[B][0])}async function Ut(Ft,Ct){const Lt=Ft.byteLength/U,Et=_.G1.F.n8*3,Bt=[];Bt.push({cmd:"ALLOCSET",var:0,buff:Ft}),Bt.push({cmd:"ALLOCSET",var:1,buff:Ct}),Bt.push({cmd:"ALLOC",var:2,len:Lt*Et});for(let vt=0;vt<Lt;vt++)Bt.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:vt*U},{var:1,offset:vt*U},{var:2,offset:vt*Et}]});return Bt.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:Lt},{var:2}]}),Bt.push({cmd:"CALL",fnName:"g1m_batchLEMtoU",params:[{var:2},{val:Lt},{var:2}]}),Bt.push({cmd:"GET",out:0,var:2,len:Lt*U}),await _.tm.queueAction(Bt)}function Ot(Ft){const Ct=new Uint8Array(4);new DataView(Ct.buffer,Ct.byteOffset,Ct.byteLength).setUint32(0,Ft,!1),h.update(Ct)}}const uo=xy;async function Wy(e,t,n,i){let o;await tn.ready();const{fd:a,sections:c}=await We(n,"zkey",2),d=await Yo(a,c,!1);if(d.protocol!="groth16")throw new Error("zkey file is not groth16");const h=await Nn(d.q),u=h.G1.F.n8*2,s=await ts(a,h,c),_=tn(64);_.update(s.csHash);let L=h.G1.g;for(let v=0;v<s.contributions.length;v++){const m=s.contributions[v],y=By(_);if(ii(y,h,m.delta.g1_s),ii(y,h,m.delta.g1_sx),!dd(y.digest(),m.transcript))return console.log(`INVALID(${v}): Inconsistent transcript `),!1;const G=fd(h,m.transcript);if(o=await uo(h,m.delta.g1_s,m.delta.g1_sx,G,m.delta.g2_spx),o!==!0)return console.log(`INVALID(${v}): public key G1 and G2 do not have the same ration `),!1;if(o=await uo(h,L,m.deltaAfter,G,m.delta.g2_spx),o!==!0)return console.log(`INVALID(${v}): deltaAfter does not fillow the public key `),!1;if(m.type==1){const N=Py(m.beaconHash,m.numIterationsExp),R=h.Fr.fromRng(N),E=h.G1.toAffine(h.G1.fromRng(N)),z=h.G1.toAffine(h.G1.timesFr(E,R));if(h.G1.eq(E,m.delta.g1_s)!==!0)return console.log(`INVALID(${v}): Key of the beacon does not match. g1_s `),!1;if(h.G1.eq(z,m.delta.g1_sx)!==!0)return console.log(`INVALID(${v}): Key of the beacon does not match. g1_sx `),!1}Zo(_,h,m);const k=tn(64);Zo(k,h,m),m.contributionHash=k.digest(),L=m.deltaAfter}const{fd:g,sections:F}=await We(e,"zkey",2),T=await Yo(g,F,!1);if(T.protocol!="groth16")throw new Error("zkeyinit file is not groth16");if(!se.eq(T.q,d.q)||!se.eq(T.r,d.r)||T.n8q!=d.n8q||T.n8r!=d.n8r)return i&&i.error("INVALID:  Different curves"),!1;if(T.nVars!=d.nVars||T.nPublic!=d.nPublic||T.domainSize!=d.domainSize)return i&&i.error("INVALID:  Different circuit parameters"),!1;if(!h.G1.eq(d.vk_alpha_1,T.vk_alpha_1))return i&&i.error("INVALID:  Invalid alpha1"),!1;if(!h.G1.eq(d.vk_beta_1,T.vk_beta_1))return i&&i.error("INVALID:  Invalid beta1"),!1;if(!h.G2.eq(d.vk_beta_2,T.vk_beta_2))return i&&i.error("INVALID:  Invalid beta2"),!1;if(!h.G2.eq(d.vk_gamma_2,T.vk_gamma_2))return i&&i.error("INVALID:  Invalid gamma2"),!1;if(!h.G1.eq(d.vk_delta_1,L))return i&&i.error("INVALID:  Invalid delta1"),!1;if(o=await uo(h,h.G1.g,L,h.G2.g,d.vk_delta_2),o!==!0)return i&&i.error("INVALID:  Invalid delta2"),!1;const C=await ts(g,h,F);if(!dd(s.csHash,C.csHash))return i&&i.error("INVALID:  Circuit does not match"),!1;if(c[8][0].size!=u*(d.nVars-d.nPublic-1))return i&&i.error("INVALID:  Invalid L section size"),!1;if(c[9][0].size!=u*d.domainSize)return i&&i.error("INVALID:  Invalid H section size"),!1;let U;if(U=await io(a,c,g,F,3),!U)return i&&i.error("INVALID:  IC section is not identical"),!1;if(U=await io(a,c,g,F,4),!U)return i&&i.error("Coeffs section is not identical"),!1;if(U=await io(a,c,g,F,5),!U)return i&&i.error("A section is not identical"),!1;if(U=await io(a,c,g,F,6),!U)return i&&i.error("B1 section is not identical"),!1;if(U=await io(a,c,g,F,7),!U)return i&&i.error("B2 section is not identical"),!1;if(o=await x("G1",g,F,a,c,8,d.vk_delta_2,T.vk_delta_2,"L section"),o!==!0)return i&&i.error("L section does not match"),!1;if(o=await V(),o!==!0)return i&&i.error("H section does not match"),!1;i&&i.info(co(s.csHash,"Circuit Hash: ")),await a.close(),await g.close();for(let v=s.contributions.length-1;v>=0;v--){const m=s.contributions[v];i&&i.info("-------------------------"),i&&i.info(co(m.contributionHash,`contribution #${v+1} ${m.name?m.name:""}:`)),m.type==1&&(i&&i.info(`Beacon generator: ${Ry(m.beaconHash)}`),i&&i.info(`Beacon iterations Exp: ${m.numIterationsExp}`))}return i&&i.info("-------------------------"),i&&i.info("ZKey Ok!"),!0;async function x(v,m,y,G,k,N,R,E,z){const tt=1<<20,at=h[v],it=at.F.n8*2;await Ne(m,y,N),await Ne(G,k,N);let Z=at.zero,ot=at.zero;const nt=y[N][0].size/it;for(let gt=0;gt<nt;gt+=tt){i&&i.debug(`Same ratio check ${z}:  ${gt}/${nt}`);const xt=Math.min(nt-gt,tt),pt=await m.read(xt*it),yt=await G.read(xt*it),w=new Uint8Array(4*xt);Oo.randomFillSync(w);const f=await at.multiExpAffine(pt,w),O=await at.multiExpAffine(yt,w);Z=at.add(Z,f),ot=at.add(ot,O)}return await qe(m),await qe(G),nt==0?!0:(o=await uo(h,Z,ot,R,E),o===!0)}async function V(){const v=1<<20,m=h.G1,y=h.Fr,G=m.F.n8*2,{fd:k,sections:N}=await We(t,"ptau",1);let R=new Kt(d.domainSize*d.n8r);const E=new Array(8);for(let ot=0;ot<8;ot++)E[ot]=Oo.randomBytes(4).readUInt32BE(0,!0);const z=new ao(E);for(let ot=0;ot<d.domainSize-1;ot++){const nt=y.fromRng(z);y.toRprLE(R,ot*d.n8r,nt)}y.toRprLE(R,(d.domainSize-1)*d.n8r,y.zero);let tt=m.zero;for(let ot=0;ot<d.domainSize;ot+=v){i&&i.debug(`H Verificaition(tau):  ${ot}/${d.domainSize}`);const nt=Math.min(d.domainSize-ot,v),gt=await k.read(G*nt,N[2][0].p+d.domainSize*G+ot*G),xt=await k.read(G*nt,N[2][0].p+ot*G),pt=await D(gt,xt),yt=R.slice(ot*d.n8r,(ot+nt)*d.n8r),w=await m.multiExpAffine(pt,yt);tt=m.add(tt,w)}R=await y.batchToMontgomery(R);let at;if(d.power<y.s)at=y.neg(y.e(2));else{const ot=2**y.s,nt=y.exp(y.shift,ot);at=y.sub(nt,y.one)}const it=d.power<y.s?y.w[d.power+1]:y.shift;R=await y.batchApplyKey(R,at,it),R=await y.fft(R),R=await y.batchFromMontgomery(R),await Ne(a,c,9);let Z=m.zero;for(let ot=0;ot<d.domainSize;ot+=v){i&&i.debug(`H Verificaition(lagrange):  ${ot}/${d.domainSize}`);const nt=Math.min(d.domainSize-ot,v),gt=await a.read(G*nt),xt=R.slice(ot*d.n8r,(ot+nt)*d.n8r),pt=await m.multiExpAffine(gt,xt);Z=m.add(Z,pt)}return await qe(a),o=await uo(h,tt,Z,d.vk_delta_2,T.vk_delta_2),o===!0}async function D(v,m){const y=h.G1.F.n8*2,G=v.byteLength/y,k=h.tm.concurrency,N=Math.floor(G/k),R=[];for(let at=0;at<k;at++){let it;if(at<k-1?it=N:it=G-at*N,it==0)continue;const Z=v.slice(at*N*u,(at*N+it)*u),ot=m.slice(at*N*u,(at*N+it)*u);R.push($(Z,ot))}const E=await Promise.all(R),z=new Uint8Array(G*y);let tt=0;for(let at=0;at<E.length;at++)z.set(E[at][0],tt),tt+=E[at][0].byteLength;return z}async function $(v,m){const y=h.G1.F.n8*2,G=h.G1.F.n8*3,k=v.byteLength/y,N=[];N.push({cmd:"ALLOCSET",var:0,buff:v}),N.push({cmd:"ALLOCSET",var:1,buff:m}),N.push({cmd:"ALLOC",var:2,len:k*G});for(let E=0;E<k;E++)N.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:E*y},{var:1,offset:E*y},{var:2,offset:E*G}]});return N.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:k},{var:2}]}),N.push({cmd:"GET",out:0,var:2,len:k*y}),await h.tm.queueAction(N)}}async function $y(e,t,n,i,o){await tn.ready();const{fd:a,sections:c}=await We(e,"zkey",2),d=await Yo(a,c);if(d.protocol!="groth16")throw new Error("zkey file is not groth16");const h=await Nn(d.q),u=await ts(a,h,c),s=await hr(t,"zkey",1,10),_=await Ty(i),L=tn(64);L.update(u.csHash);for(let U=0;U<u.contributions.length;U++)Zo(L,h,u.contributions[U]);const g={};g.delta={},g.delta.prvKey=h.Fr.fromRng(_),g.delta.g1_s=h.G1.toAffine(h.G1.fromRng(_)),g.delta.g1_sx=h.G1.toAffine(h.G1.timesFr(g.delta.g1_s,g.delta.prvKey)),ii(L,h,g.delta.g1_s),ii(L,h,g.delta.g1_sx),g.transcript=L.digest(),g.delta.g2_sp=fd(h,g.transcript),g.delta.g2_spx=h.G2.toAffine(h.G2.timesFr(g.delta.g2_sp,g.delta.prvKey)),d.vk_delta_1=h.G1.timesFr(d.vk_delta_1,g.delta.prvKey),d.vk_delta_2=h.G2.timesFr(d.vk_delta_2,g.delta.prvKey),g.deltaAfter=d.vk_delta_1,g.type=0,n&&(g.name=n),u.contributions.push(g),await Uy(s,d),await no(a,c,s,3),await no(a,c,s,4),await no(a,c,s,5),await no(a,c,s,6),await no(a,c,s,7);const F=h.Fr.inv(g.delta.prvKey);await gd(a,c,s,8,h,"G1",F,h.Fr.e(1),"L Section",o),await gd(a,c,s,9,h,"G1",F,h.Fr.e(1),"H Section",o),await zy(s,h,u),await a.close(),await s.close();const T=tn(64);Zo(T,h,g);const C=T.digest();return o&&o.info(co(u.csHash,"Circuit Hash: ")),o&&o.info(co(C,"Contribution Hash: ")),C}const{stringifyBigInts:_d}=xL;async function es(e){const{fd:t,sections:n}=await We(e,"zkey",2),i=await Yo(t,n);let o;if(i.protocol=="groth16")o=await Hy(i,t,n);else if(i.protocol=="plonk")o=await jy(i);else throw new Error("zkey file is not groth16");return await t.close(),o}async function Hy(e,t,n){const i=await Nn(e.q),o=i.G1.F.n8*2,a=await i.pairing(e.vk_alpha_1,e.vk_beta_2);let c={protocol:e.protocol,curve:i.name,nPublic:e.nPublic,vk_alpha_1:i.G1.toObject(e.vk_alpha_1),vk_beta_2:i.G2.toObject(e.vk_beta_2),vk_gamma_2:i.G2.toObject(e.vk_gamma_2),vk_delta_2:i.G2.toObject(e.vk_delta_2),vk_alphabeta_12:i.Gt.toObject(a)};await Ne(t,n,3),c.IC=[];for(let d=0;d<=e.nPublic;d++){const h=await t.read(o),u=i.G1.toObject(h);c.IC.push(u)}return await qe(t),c=_d(c),c}async function jy(e){const t=await Nn(e.q);let n={protocol:e.protocol,curve:t.name,nPublic:e.nPublic,power:e.power,k1:t.Fr.toObject(e.k1),k2:t.Fr.toObject(e.k2),Qm:t.G1.toObject(e.Qm),Ql:t.G1.toObject(e.Ql),Qr:t.G1.toObject(e.Qr),Qo:t.G1.toObject(e.Qo),Qc:t.G1.toObject(e.Qc),S1:t.G1.toObject(e.S1),S2:t.G1.toObject(e.S2),S3:t.G1.toObject(e.S3),X_2:t.G2.toObject(e.X_2),w:t.Fr.toObject(t.Fr.w[e.power])};return n=_d(n),n}var md={},Ld=Cs(f_),yd={};(function(e){var t=/[|\\{}()[\]^$+*?.]/g,n=Object.prototype.hasOwnProperty,i=function(h,u){return n.apply(h,[u])};e.escapeRegExpChars=function(h){return h?String(h).replace(t,"\\$&"):""};var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},a=/[&<>'"]/g;function c(h){return o[h]||h}var d=`var _ENCODE_HTML_RULES = {
      "&": "&amp;"
    , "<": "&lt;"
    , ">": "&gt;"
    , '"': "&#34;"
    , "'": "&#39;"
    }
  , _MATCH_HTML = /[&<>'"]/g;
function encode_char(c) {
  return _ENCODE_HTML_RULES[c] || c;
};
`;e.escapeXML=function(h){return h==null?"":String(h).replace(a,c)},e.escapeXML.toString=function(){return Function.prototype.toString.call(this)+`;
`+d},e.shallowCopy=function(h,u){if(u=u||{},h!=null)for(var s in u)!i(u,s)||s==="__proto__"||s==="constructor"||(h[s]=u[s]);return h},e.shallowCopyFromList=function(h,u,s){if(s=s||[],u=u||{},h!=null)for(var _=0;_<s.length;_++){var L=s[_];if(typeof u[L]!="undefined"){if(!i(u,L)||L==="__proto__"||L==="constructor")continue;h[L]=u[L]}}return h},e.cache={_data:{},set:function(h,u){this._data[h]=u},get:function(h){return this._data[h]},remove:function(h){delete this._data[h]},reset:function(){this._data={}}},e.hyphenToCamel=function(h){return h.replace(/-[a-z]/g,function(u){return u[1].toUpperCase()})},e.createNullProtoObjWherePossible=function(){return typeof Object.create=="function"?function(){return Object.create(null)}:{__proto__:null}instanceof Object?function(){return{}}:function(){return{__proto__:null}}}()})(yd);var Vy={name:"ejs",description:"Embedded JavaScript templates",keywords:["template","engine","ejs"],version:"3.1.8",author:"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)",license:"Apache-2.0",bin:{ejs:"./bin/cli.js"},main:"./lib/ejs.js",jsdelivr:"ejs.min.js",unpkg:"ejs.min.js",repository:{type:"git",url:"git://github.com/mde/ejs.git"},bugs:"https://github.com/mde/ejs/issues",homepage:"https://github.com/mde/ejs",dependencies:{jake:"^10.8.5"},devDependencies:{browserify:"^16.5.1",eslint:"^6.8.0","git-directory-deploy":"^1.5.1",jsdoc:"^3.6.7","lru-cache":"^4.0.1",mocha:"^7.1.1","uglify-js":"^3.3.16"},engines:{node:">=0.10.0"},scripts:{test:"mocha"}};(function(e){/**
 * @file Embedded JavaScript templating engine. {@link http://ejs.co}
 * @author Matthew Eernisse <mde@fleegix.org>
 * @author Tiancheng "Timothy" Gu <timothygu99@gmail.com>
 * @project EJS
 * @license {@link http://www.apache.org/licenses/LICENSE-2.0 Apache License, Version 2.0}
 */var t=Ld,n=Ld,i=yd,o=!1,a=Vy.version,c="<",d=">",h="%",u="locals",s="ejs",_="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",L=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],g=L.concat("cache"),F=/^\uFEFF/,T=/^[a-zA-Z_$][0-9a-zA-Z_$]*$/;e.cache=i.cache,e.fileLoader=t.readFileSync,e.localsName=u,e.promiseImpl=new Function("return this;")().Promise,e.resolveInclude=function(G,k,N){var R=n.dirname,E=n.extname,z=n.resolve,tt=z(N?k:R(k),G),at=E(G);return at||(tt+=".ejs"),tt};function C(G,k){var N;if(k.some(function(R){return N=e.resolveInclude(G,R,!0),t.existsSync(N)}))return N}function U(G,k){var N,R,E=k.views,z=/^[A-Za-z]+:\\|^\//.exec(G);if(z&&z.length)G=G.replace(/^\/*/,""),Array.isArray(k.root)?N=C(G,k.root):N=e.resolveInclude(G,k.root||"/",!0);else if(k.filename&&(R=e.resolveInclude(G,k.filename),t.existsSync(R)&&(N=R)),!N&&Array.isArray(E)&&(N=C(G,E)),!N&&typeof k.includer!="function")throw new Error('Could not find the include file "'+k.escapeFunction(G)+'"');return N}function x(G,k){var N,R=G.filename,E=arguments.length>1;if(G.cache){if(!R)throw new Error("cache option requires a filename");if(N=e.cache.get(R),N)return N;E||(k=D(R).toString().replace(F,""))}else if(!E){if(!R)throw new Error("Internal EJS error: no file name or template provided");k=D(R).toString().replace(F,"")}return N=e.compile(k,G),G.cache&&e.cache.set(R,N),N}function V(G,k,N){var R;if(N){try{R=x(G)(k)}catch(E){return N(E)}N(null,R)}else{if(typeof e.promiseImpl=="function")return new e.promiseImpl(function(E,z){try{R=x(G)(k),E(R)}catch(tt){z(tt)}});throw new Error("Please provide a callback function")}}function D(G){return e.fileLoader(G)}function $(G,k){var N=i.shallowCopy(i.createNullProtoObjWherePossible(),k);if(N.filename=U(G,N),typeof k.includer=="function"){var R=k.includer(G,N.filename);if(R&&(R.filename&&(N.filename=R.filename),R.template))return x(N,R.template)}return x(N)}function v(G,k,N,R,E){var z=k.split(`
`),tt=Math.max(R-3,0),at=Math.min(z.length,R+3),it=E(N),Z=z.slice(tt,at).map(function(ot,nt){var gt=nt+tt+1;return(gt==R?" >> ":"    ")+gt+"| "+ot}).join(`
`);throw G.path=it,G.message=(it||"ejs")+":"+R+`
`+Z+`

`+G.message,G}function m(G){return G.replace(/;(\s*$)/,"$1")}e.compile=function(k,N){var R;return N&&N.scope&&(o||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),o=!0),N.context||(N.context=N.scope),delete N.scope),R=new y(k,N),R.compile()},e.render=function(G,k,N){var R=k||i.createNullProtoObjWherePossible(),E=N||i.createNullProtoObjWherePossible();return arguments.length==2&&i.shallowCopyFromList(E,R,L),x(E,G)(R)},e.renderFile=function(){var G=Array.prototype.slice.call(arguments),k=G.shift(),N,R={filename:k},E,z;return typeof arguments[arguments.length-1]=="function"&&(N=G.pop()),G.length?(E=G.shift(),G.length?i.shallowCopy(R,G.pop()):(E.settings&&(E.settings.views&&(R.views=E.settings.views),E.settings["view cache"]&&(R.cache=!0),z=E.settings["view options"],z&&i.shallowCopy(R,z)),i.shallowCopyFromList(R,E,g)),R.filename=k):E=i.createNullProtoObjWherePossible(),V(R,E,N)},e.Template=y,e.clearCache=function(){e.cache.reset()};function y(G,k){k=k||i.createNullProtoObjWherePossible();var N=i.createNullProtoObjWherePossible();this.templateText=G,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",N.client=k.client||!1,N.escapeFunction=k.escape||k.escapeFunction||i.escapeXML,N.compileDebug=k.compileDebug!==!1,N.debug=!!k.debug,N.filename=k.filename,N.openDelimiter=k.openDelimiter||e.openDelimiter||c,N.closeDelimiter=k.closeDelimiter||e.closeDelimiter||d,N.delimiter=k.delimiter||e.delimiter||h,N.strict=k.strict||!1,N.context=k.context,N.cache=k.cache||!1,N.rmWhitespace=k.rmWhitespace,N.root=k.root,N.includer=k.includer,N.outputFunctionName=k.outputFunctionName,N.localsName=k.localsName||e.localsName||u,N.views=k.views,N.async=k.async,N.destructuredLocals=k.destructuredLocals,N.legacyInclude=typeof k.legacyInclude!="undefined"?!!k.legacyInclude:!0,N.strict?N._with=!1:N._with=typeof k._with!="undefined"?k._with:!0,this.opts=N,this.regex=this.createRegex()}y.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},y.prototype={createRegex:function(){var G=_,k=i.escapeRegExpChars(this.opts.delimiter),N=i.escapeRegExpChars(this.opts.openDelimiter),R=i.escapeRegExpChars(this.opts.closeDelimiter);return G=G.replace(/%/g,k).replace(/</g,N).replace(/>/g,R),new RegExp(G)},compile:function(){var G,k,N=this.opts,R="",E="",z=N.escapeFunction,tt,at=N.filename?JSON.stringify(N.filename):"undefined";if(!this.source){if(this.generateSource(),R+=`  var __output = "";
  function __append(s) { if (s !== undefined && s !== null) __output += s }
`,N.outputFunctionName){if(!T.test(N.outputFunctionName))throw new Error("outputFunctionName is not a valid JS identifier.");R+="  var "+N.outputFunctionName+` = __append;
`}if(N.localsName&&!T.test(N.localsName))throw new Error("localsName is not a valid JS identifier.");if(N.destructuredLocals&&N.destructuredLocals.length){for(var it="  var __locals = ("+N.localsName+` || {}),
`,Z=0;Z<N.destructuredLocals.length;Z++){var ot=N.destructuredLocals[Z];if(!T.test(ot))throw new Error("destructuredLocals["+Z+"] is not a valid JS identifier.");Z>0&&(it+=`,
  `),it+=ot+" = __locals."+ot}R+=it+`;
`}N._with!==!1&&(R+="  with ("+N.localsName+` || {}) {
`,E+=`  }
`),E+=`  return __output;
`,this.source=R+this.source+E}N.compileDebug?G=`var __line = 1
  , __lines = `+JSON.stringify(this.templateText)+`
  , __filename = `+at+`;
try {
`+this.source+`} catch (e) {
  rethrow(e, __lines, __filename, __line, escapeFn);
}
`:G=this.source,N.client&&(G="escapeFn = escapeFn || "+z.toString()+`;
`+G,N.compileDebug&&(G="rethrow = rethrow || "+v.toString()+`;
`+G)),N.strict&&(G=`"use strict";
`+G),N.debug&&console.log(G),N.compileDebug&&N.filename&&(G=G+`
//# sourceURL=`+at+`
`);try{if(N.async)try{tt=new Function("return (async function(){}).constructor;")()}catch(pt){throw pt instanceof SyntaxError?new Error("This environment does not support async/await"):pt}else tt=Function;k=new tt(N.localsName+", escapeFn, include, rethrow",G)}catch(pt){throw pt instanceof SyntaxError&&(N.filename&&(pt.message+=" in "+N.filename),pt.message+=` while compiling ejs

`,pt.message+=`If the above error is not helpful, you may want to try EJS-Lint:
`,pt.message+="https://github.com/RyanZim/EJS-Lint",N.async||(pt.message+=`
`,pt.message+="Or, if you meant to create an async function, pass `async: true` as an option.")),pt}var nt=N.client?k:function(yt){var w=function(f,O){var p=i.shallowCopy(i.createNullProtoObjWherePossible(),yt);return O&&(p=i.shallowCopy(p,O)),$(f,N)(p)};return k.apply(N.context,[yt||i.createNullProtoObjWherePossible(),z,w,v])};if(N.filename&&typeof Object.defineProperty=="function"){var gt=N.filename,xt=n.basename(gt,n.extname(gt));try{Object.defineProperty(nt,"name",{value:xt,writable:!1,enumerable:!1,configurable:!0})}catch{}}return nt},generateSource:function(){var G=this.opts;G.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,`
`).replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var k=this,N=this.parseTemplateText(),R=this.opts.delimiter,E=this.opts.openDelimiter,z=this.opts.closeDelimiter;N&&N.length&&N.forEach(function(tt,at){var it;if(tt.indexOf(E+R)===0&&tt.indexOf(E+R+R)!==0&&(it=N[at+2],!(it==R+z||it=="-"+R+z||it=="_"+R+z)))throw new Error('Could not find matching close tag for "'+tt+'".');k.scanLine(tt)})},parseTemplateText:function(){for(var G=this.templateText,k=this.regex,N=k.exec(G),R=[],E;N;)E=N.index,E!==0&&(R.push(G.substring(0,E)),G=G.slice(E)),R.push(N[0]),G=G.slice(N[0].length),N=k.exec(G);return G&&R.push(G),R},_addOutput:function(G){if(this.truncate&&(G=G.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!G)return G;G=G.replace(/\\/g,"\\\\"),G=G.replace(/\n/g,"\\n"),G=G.replace(/\r/g,"\\r"),G=G.replace(/"/g,'\\"'),this.source+='    ; __append("'+G+`")
`},scanLine:function(G){var k=this,N=this.opts.delimiter,R=this.opts.openDelimiter,E=this.opts.closeDelimiter,z=0;switch(z=G.split(`
`).length-1,G){case R+N:case R+N+"_":this.mode=y.modes.EVAL;break;case R+N+"=":this.mode=y.modes.ESCAPED;break;case R+N+"-":this.mode=y.modes.RAW;break;case R+N+"#":this.mode=y.modes.COMMENT;break;case R+N+N:this.mode=y.modes.LITERAL,this.source+='    ; __append("'+G.replace(R+N+N,R+N)+`")
`;break;case N+N+E:this.mode=y.modes.LITERAL,this.source+='    ; __append("'+G.replace(N+N+E,N+E)+`")
`;break;case N+E:case"-"+N+E:case"_"+N+E:this.mode==y.modes.LITERAL&&this._addOutput(G),this.mode=null,this.truncate=G.indexOf("-")===0||G.indexOf("_")===0;break;default:if(this.mode){switch(this.mode){case y.modes.EVAL:case y.modes.ESCAPED:case y.modes.RAW:G.lastIndexOf("//")>G.lastIndexOf(`
`)&&(G+=`
`)}switch(this.mode){case y.modes.EVAL:this.source+="    ; "+G+`
`;break;case y.modes.ESCAPED:this.source+="    ; __append(escapeFn("+m(G)+`))
`;break;case y.modes.RAW:this.source+="    ; __append("+m(G)+`)
`;break;case y.modes.COMMENT:break;case y.modes.LITERAL:this._addOutput(G);break}}else this._addOutput(G)}k.opts.compileDebug&&z&&(this.currentLine+=z,this.source+="    ; __line = "+this.currentLine+`
`)}},e.escapeXML=i.escapeXML,e.__express=e.renderFile,e.VERSION=a,e.name=s,typeof window!="undefined"&&(window.ejs=e)})(md);async function Ad(e,t,n){const i=await es(e);let o=t[i.protocol];return md.render(o,i)}async function Ky(e,t,n,i){globalThis.gc&&globalThis.gc(),await tn.ready();const{fd:o,sections:a}=await We(t,"ptau",1),{curve:c,power:d}=await hd(o,a),{fd:h,sections:u}=await We(e,"r1cs",1),s=await zo(h,u,!1),_=c.G1.F.n8*2,L=c.G1,g=c.G2.F.n8*2,F=c.Fr,T=c.Fr.n8;i&&i.info("Reading r1cs");let C=await Cn(h,u,2);const U=new pn,x=new pn;let V=s.nVars;const D=s.nOutputs+s.nPubInputs;await z(),globalThis.gc&&globalThis.gc();const $=await hr(n,"zkey",1,14,1<<22,1<<24);if(s.prime!=c.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;let v=Vo(U.length-1)+1;v<3&&(v=3);const m=2**v;if(i&&i.info("Plonk constraints: "+U.length),v>d)return i&&i.error(`circuit too big for this power of tau ceremony. ${U.length} > 2**${d}`),-1;if(!a[12])return i&&i.error("Powers of tau is not prepared."),-1;const y=new Kt(m*_),G=a[12][0].p+(2**v-1)*_;await o.readToBuffer(y,0,m*_,G);const[k,N]=xt(),R={};await Z(3,"Additions"),globalThis.gc&&globalThis.gc(),await tt(4,0,"Amap"),globalThis.gc&&globalThis.gc(),await tt(5,1,"Bmap"),globalThis.gc&&globalThis.gc(),await tt(6,2,"Cmap"),globalThis.gc&&globalThis.gc(),await at(7,3,"Qm"),globalThis.gc&&globalThis.gc(),await at(8,4,"Ql"),globalThis.gc&&globalThis.gc(),await at(9,5,"Qr"),globalThis.gc&&globalThis.gc(),await at(10,6,"Qo"),globalThis.gc&&globalThis.gc(),await at(11,7,"Qc"),globalThis.gc&&globalThis.gc(),await ot(12,"sigma"),globalThis.gc&&globalThis.gc(),await nt(13,"lagrange polynomials"),globalThis.gc&&globalThis.gc(),await fe($,14);const E=new Kt((m+6)*_);await o.readToBuffer(E,0,(m+6)*_,a[2][0].p),await $.write(E),await he($),globalThis.gc&&globalThis.gc(),await gt(),await $.close(),await h.close(),await o.close(),i&&i.info("Setup Finished");return;async function z(){let pt=0;function yt(){const p=C.slice(pt,pt+4);return pt+=4,new DataView(p.buffer).getUint32(0,!0)}function w(){const p=F.fromRprLE(C.slice(pt,pt+c.Fr.n8));return pt+=c.Fr.n8,p}function f(){const p=[],W={k:c.Fr.zero},q=yt();for(let J=0;J<q;J++){const dt=yt(),lt=w();dt==0?W.k=lt:p.push([dt,lt])}const I=O(p);return W.s=I[0],W.coef=I[1],W}function O(p){if(p.length==0)return[0,c.Fr.zero];if(p.length==1)return p[0];const W=p.slice(0,p.length>>1),q=p.slice(p.length>>1),I=O(W),J=O(q),dt=I[0],lt=J[0],It=V++,Ut=c.Fr.zero,Ot=F.neg(I[1]),Ft=F.neg(J[1]),Ct=c.Fr.one,Lt=c.Fr.zero;return U.push([dt,lt,It,Ut,Ot,Ft,Ct,Lt]),x.push([dt,lt,I[1],J[1]]),[It,c.Fr.one]}for(let p=1;p<=D;p++){const W=p,q=0,I=0,J=c.Fr.zero,dt=c.Fr.one,lt=c.Fr.zero,It=c.Fr.zero,Ut=c.Fr.zero;U.push([W,q,I,J,dt,lt,It,Ut])}for(let p=0;p<s.nConstraints;p++){i&&p%1e4==0&&i.debug(`processing constraints: ${p}/${s.nConstraints}`);const W=f(),q=f(),I=f(),J=W.s,dt=q.s,lt=I.s,It=c.Fr.mul(W.coef,q.coef),Ut=c.Fr.mul(W.coef,q.k),Ot=c.Fr.mul(W.k,q.coef),Ft=c.Fr.neg(I.coef),Ct=c.Fr.sub(c.Fr.mul(W.k,q.k),I.k);U.push([J,dt,lt,It,Ut,Ot,Ft,Ct])}}async function tt(pt,yt,w){await fe($,pt);for(let f=0;f<U.length;f++)await $.writeULE32(U[f][yt]),i&&f%1e6==0&&i.debug(`writing ${w}: ${f}/${U.length}`);await he($)}async function at(pt,yt,w){let f=new Kt(m*T);for(let O=0;O<U.length;O++)f.set(U[O][yt],O*T),i&&O%1e6==0&&i.debug(`writing ${w}: ${O}/${U.length}`);await fe($,pt),await it(f),await he($),f=await F.batchFromMontgomery(f),R[w]=await c.G1.multiExpAffine(y,f,i,"multiexp "+w)}async function it(pt){const yt=await F.ifft(pt),w=new Kt(m*T*4);w.set(yt,0);const f=await F.fft(w);await $.write(yt),await $.write(f)}async function Z(pt,yt){await fe($,pt);const w=new Uint8Array(2*4+2*T),f=new DataView(w.buffer);for(let O=0;O<x.length;O++){const p=x[O];let W=0;f.setUint32(W,p[0],!0),W+=4,f.setUint32(W,p[1],!0),W+=4,w.set(p[2],W),W+=T,w.set(p[3],W),W+=T,await $.write(w),i&&O%1e6==0&&i.debug(`writing ${yt}: ${O}/${x.length}`)}await he($)}async function ot(pt,yt){const w=new Kt(T*m*3),f=new pn(V),O=new pn(V);let p=F.one;for(let dt=0;dt<m;dt++)dt<U.length?(J(U[dt][0],dt),J(U[dt][1],m+dt),J(U[dt][2],m*2+dt)):(J(0,dt),J(0,m+dt),J(0,m*2+dt)),p=F.mul(p,F.w[v]),i&&dt%1e6==0&&i.debug(`writing ${yt} phase1: ${dt}/${U.length}`);for(let dt=0;dt<V;dt++)typeof O[dt]!="undefined"?w.set(f[dt],O[dt]*T):console.log("Variable not used"),i&&dt%1e6==0&&i.debug(`writing ${yt} phase2: ${dt}/${V}`);globalThis.gc&&globalThis.gc(),await fe($,pt);let W=w.slice(0,m*T);await it(W),globalThis.gc&&globalThis.gc();let q=w.slice(m*T,m*T*2);await it(q),globalThis.gc&&globalThis.gc();let I=w.slice(m*T*2,m*T*3);await it(I),globalThis.gc&&globalThis.gc(),await he($),W=await F.batchFromMontgomery(W),q=await F.batchFromMontgomery(q),I=await F.batchFromMontgomery(I),R.S1=await c.G1.multiExpAffine(y,W,i,"multiexp S1"),globalThis.gc&&globalThis.gc(),R.S2=await c.G1.multiExpAffine(y,q,i,"multiexp S2"),globalThis.gc&&globalThis.gc(),R.S3=await c.G1.multiExpAffine(y,I,i,"multiexp S3"),globalThis.gc&&globalThis.gc();function J(dt,lt){typeof f[dt]=="undefined"?O[dt]=lt:w.set(f[dt],lt*T);let It;lt<m?It=p:lt<2*m?It=F.mul(p,k):It=F.mul(p,N),f[dt]=It}}async function nt(pt,yt){await fe($,pt);const w=Math.max(D,1);for(let f=0;f<w;f++){let O=new Kt(m*T);O.set(F.one,f*T),await it(O),i&&i.debug(`writing ${yt} ${f}/${w}`)}await he($)}async function gt(){await fe($,1),await $.writeULE32(2),await he($),await fe($,2);const pt=c.q,yt=(Math.floor((se.bitLength(pt)-1)/64)+1)*8,w=c.r,f=(Math.floor((se.bitLength(w)-1)/64)+1)*8;await $.writeULE32(yt),await bi($,pt,yt),await $.writeULE32(f),await bi($,w,f),await $.writeULE32(V),await $.writeULE32(D),await $.writeULE32(m),await $.writeULE32(x.length),await $.writeULE32(U.length),await $.write(k),await $.write(N),await $.write(L.toAffine(R.Qm)),await $.write(L.toAffine(R.Ql)),await $.write(L.toAffine(R.Qr)),await $.write(L.toAffine(R.Qo)),await $.write(L.toAffine(R.Qc)),await $.write(L.toAffine(R.S1)),await $.write(L.toAffine(R.S2)),await $.write(L.toAffine(R.S3));let O;O=await o.read(g,a[3][0].p+g),await $.write(O),await he($)}function xt(){let pt=F.two;for(;w(pt,[],v);)F.add(pt,F.one);let yt=F.add(pt,F.one);for(;w(yt,[pt],v);)F.add(yt,F.one);return[pt,yt];function w(f,O,p){const W=2**p;let q=F.one;for(let I=0;I<W;I++){if(F.eq(f,q))return!0;for(let J=0;J<O.length;J++)if(F.eq(f,F.mul(O[J],q)))return!0;q=F.mul(q,F.w[p])}return!1}}}var Yy={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(e){(function(){var t="input is invalid type",n="finalize already called",i=typeof window=="object",o=i?window:{};o.JS_SHA3_NO_WINDOW&&(i=!1);var a=!i&&typeof self=="object",c=!o.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;c?o=ra:a&&(o=self);var d=!o.JS_SHA3_NO_COMMON_JS&&!0&&e.exports,h=!o.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",u="0123456789abcdef".split(""),s=[31,7936,2031616,520093696],_=[4,1024,262144,67108864],L=[1,256,65536,16777216],g=[6,1536,393216,100663296],F=[0,8,16,24],T=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],C=[224,256,384,512],U=[128,256],x=["hex","buffer","arrayBuffer","array","digest"],V={"128":168,"256":136};(o.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(w){return Object.prototype.toString.call(w)==="[object Array]"}),h&&(o.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(w){return typeof w=="object"&&w.buffer&&w.buffer.constructor===ArrayBuffer});for(var D=function(w,f,O){return function(p){return new xt(w,f,w).update(p)[O]()}},$=function(w,f,O){return function(p,W){return new xt(w,f,W).update(p)[O]()}},v=function(w,f,O){return function(p,W,q,I){return z["cshake"+w].update(p,W,q,I)[O]()}},m=function(w,f,O){return function(p,W,q,I){return z["kmac"+w].update(p,W,q,I)[O]()}},y=function(w,f,O,p){for(var W=0;W<x.length;++W){var q=x[W];w[q]=f(O,p,q)}return w},G=function(w,f){var O=D(w,f,"hex");return O.create=function(){return new xt(w,f,w)},O.update=function(p){return O.create().update(p)},y(O,D,w,f)},k=function(w,f){var O=$(w,f,"hex");return O.create=function(p){return new xt(w,f,p)},O.update=function(p,W){return O.create(W).update(p)},y(O,$,w,f)},N=function(w,f){var O=V[w],p=v(w,f,"hex");return p.create=function(W,q,I){return!q&&!I?z["shake"+w].create(W):new xt(w,f,W).bytepad([q,I],O)},p.update=function(W,q,I,J){return p.create(q,I,J).update(W)},y(p,v,w,f)},R=function(w,f){var O=V[w],p=m(w,f,"hex");return p.create=function(W,q,I){return new pt(w,f,q).bytepad(["KMAC",I],O).bytepad([W],O)},p.update=function(W,q,I,J){return p.create(W,I,J).update(q)},y(p,m,w,f)},E=[{name:"keccak",padding:L,bits:C,createMethod:G},{name:"sha3",padding:g,bits:C,createMethod:G},{name:"shake",padding:s,bits:U,createMethod:k},{name:"cshake",padding:_,bits:U,createMethod:N},{name:"kmac",padding:_,bits:U,createMethod:R}],z={},tt=[],at=0;at<E.length;++at)for(var it=E[at],Z=it.bits,ot=0;ot<Z.length;++ot){var nt=it.name+"_"+Z[ot];if(tt.push(nt),z[nt]=it.createMethod(Z[ot],it.padding),it.name!=="sha3"){var gt=it.name+Z[ot];tt.push(gt),z[gt]=z[nt]}}function xt(w,f,O){this.blocks=[],this.s=[],this.padding=f,this.outputBits=O,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(w<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=O>>5,this.extraBytes=(O&31)>>3;for(var p=0;p<50;++p)this.s[p]=0}xt.prototype.update=function(w){if(this.finalized)throw new Error(n);var f,O=typeof w;if(O!=="string"){if(O==="object"){if(w===null)throw new Error(t);if(h&&w.constructor===ArrayBuffer)w=new Uint8Array(w);else if(!Array.isArray(w)&&(!h||!ArrayBuffer.isView(w)))throw new Error(t)}else throw new Error(t);f=!0}for(var p=this.blocks,W=this.byteCount,q=w.length,I=this.blockCount,J=0,dt=this.s,lt,It;J<q;){if(this.reset)for(this.reset=!1,p[0]=this.block,lt=1;lt<I+1;++lt)p[lt]=0;if(f)for(lt=this.start;J<q&&lt<W;++J)p[lt>>2]|=w[J]<<F[lt++&3];else for(lt=this.start;J<q&&lt<W;++J)It=w.charCodeAt(J),It<128?p[lt>>2]|=It<<F[lt++&3]:It<2048?(p[lt>>2]|=(192|It>>6)<<F[lt++&3],p[lt>>2]|=(128|It&63)<<F[lt++&3]):It<55296||It>=57344?(p[lt>>2]|=(224|It>>12)<<F[lt++&3],p[lt>>2]|=(128|It>>6&63)<<F[lt++&3],p[lt>>2]|=(128|It&63)<<F[lt++&3]):(It=65536+((It&1023)<<10|w.charCodeAt(++J)&1023),p[lt>>2]|=(240|It>>18)<<F[lt++&3],p[lt>>2]|=(128|It>>12&63)<<F[lt++&3],p[lt>>2]|=(128|It>>6&63)<<F[lt++&3],p[lt>>2]|=(128|It&63)<<F[lt++&3]);if(this.lastByteIndex=lt,lt>=W){for(this.start=lt-W,this.block=p[I],lt=0;lt<I;++lt)dt[lt]^=p[lt];yt(dt),this.reset=!0}else this.start=lt}return this},xt.prototype.encode=function(w,f){var O=w&255,p=1,W=[O];for(w=w>>8,O=w&255;O>0;)W.unshift(O),w=w>>8,O=w&255,++p;return f?W.push(p):W.unshift(p),this.update(W),W.length},xt.prototype.encodeString=function(w){var f,O=typeof w;if(O!=="string"){if(O==="object"){if(w===null)throw new Error(t);if(h&&w.constructor===ArrayBuffer)w=new Uint8Array(w);else if(!Array.isArray(w)&&(!h||!ArrayBuffer.isView(w)))throw new Error(t)}else throw new Error(t);f=!0}var p=0,W=w.length;if(f)p=W;else for(var q=0;q<w.length;++q){var I=w.charCodeAt(q);I<128?p+=1:I<2048?p+=2:I<55296||I>=57344?p+=3:(I=65536+((I&1023)<<10|w.charCodeAt(++q)&1023),p+=4)}return p+=this.encode(p*8),this.update(w),p},xt.prototype.bytepad=function(w,f){for(var O=this.encode(f),p=0;p<w.length;++p)O+=this.encodeString(w[p]);var W=f-O%f,q=[];return q.length=W,this.update(q),this},xt.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var w=this.blocks,f=this.lastByteIndex,O=this.blockCount,p=this.s;if(w[f>>2]|=this.padding[f&3],this.lastByteIndex===this.byteCount)for(w[0]=w[O],f=1;f<O+1;++f)w[f]=0;for(w[O-1]|=2147483648,f=0;f<O;++f)p[f]^=w[f];yt(p)}},xt.prototype.toString=xt.prototype.hex=function(){this.finalize();for(var w=this.blockCount,f=this.s,O=this.outputBlocks,p=this.extraBytes,W=0,q=0,I="",J;q<O;){for(W=0;W<w&&q<O;++W,++q)J=f[W],I+=u[J>>4&15]+u[J&15]+u[J>>12&15]+u[J>>8&15]+u[J>>20&15]+u[J>>16&15]+u[J>>28&15]+u[J>>24&15];q%w==0&&(yt(f),W=0)}return p&&(J=f[W],I+=u[J>>4&15]+u[J&15],p>1&&(I+=u[J>>12&15]+u[J>>8&15]),p>2&&(I+=u[J>>20&15]+u[J>>16&15])),I},xt.prototype.arrayBuffer=function(){this.finalize();var w=this.blockCount,f=this.s,O=this.outputBlocks,p=this.extraBytes,W=0,q=0,I=this.outputBits>>3,J;p?J=new ArrayBuffer(O+1<<2):J=new ArrayBuffer(I);for(var dt=new Uint32Array(J);q<O;){for(W=0;W<w&&q<O;++W,++q)dt[q]=f[W];q%w==0&&yt(f)}return p&&(dt[W]=f[W],J=J.slice(0,I)),J},xt.prototype.buffer=xt.prototype.arrayBuffer,xt.prototype.digest=xt.prototype.array=function(){this.finalize();for(var w=this.blockCount,f=this.s,O=this.outputBlocks,p=this.extraBytes,W=0,q=0,I=[],J,dt;q<O;){for(W=0;W<w&&q<O;++W,++q)J=q<<2,dt=f[W],I[J]=dt&255,I[J+1]=dt>>8&255,I[J+2]=dt>>16&255,I[J+3]=dt>>24&255;q%w==0&&yt(f)}return p&&(J=q<<2,dt=f[W],I[J]=dt&255,p>1&&(I[J+1]=dt>>8&255),p>2&&(I[J+2]=dt>>16&255)),I};function pt(w,f,O){xt.call(this,w,f,O)}pt.prototype=new xt,pt.prototype.finalize=function(){return this.encode(this.outputBits,!0),xt.prototype.finalize.call(this)};var yt=function(w){var f,O,p,W,q,I,J,dt,lt,It,Ut,Ot,Ft,Ct,Lt,Et,Bt,Pt,vt,Wt,B,M,H,j,rt,et,ct,b,r,l,A,S,P,Q,Y,st,ft,_t,ut,wt,Rt,Tt,St,Gt,Nt,Ht,qt,zt,Mt,Yt,Ce,je,Bi,qn,zn,xi,Dn,kn,Oi,Sn,_n,oi,Xo;for(p=0;p<48;p+=2)W=w[0]^w[10]^w[20]^w[30]^w[40],q=w[1]^w[11]^w[21]^w[31]^w[41],I=w[2]^w[12]^w[22]^w[32]^w[42],J=w[3]^w[13]^w[23]^w[33]^w[43],dt=w[4]^w[14]^w[24]^w[34]^w[44],lt=w[5]^w[15]^w[25]^w[35]^w[45],It=w[6]^w[16]^w[26]^w[36]^w[46],Ut=w[7]^w[17]^w[27]^w[37]^w[47],Ot=w[8]^w[18]^w[28]^w[38]^w[48],Ft=w[9]^w[19]^w[29]^w[39]^w[49],f=Ot^(I<<1|J>>>31),O=Ft^(J<<1|I>>>31),w[0]^=f,w[1]^=O,w[10]^=f,w[11]^=O,w[20]^=f,w[21]^=O,w[30]^=f,w[31]^=O,w[40]^=f,w[41]^=O,f=W^(dt<<1|lt>>>31),O=q^(lt<<1|dt>>>31),w[2]^=f,w[3]^=O,w[12]^=f,w[13]^=O,w[22]^=f,w[23]^=O,w[32]^=f,w[33]^=O,w[42]^=f,w[43]^=O,f=I^(It<<1|Ut>>>31),O=J^(Ut<<1|It>>>31),w[4]^=f,w[5]^=O,w[14]^=f,w[15]^=O,w[24]^=f,w[25]^=O,w[34]^=f,w[35]^=O,w[44]^=f,w[45]^=O,f=dt^(Ot<<1|Ft>>>31),O=lt^(Ft<<1|Ot>>>31),w[6]^=f,w[7]^=O,w[16]^=f,w[17]^=O,w[26]^=f,w[27]^=O,w[36]^=f,w[37]^=O,w[46]^=f,w[47]^=O,f=It^(W<<1|q>>>31),O=Ut^(q<<1|W>>>31),w[8]^=f,w[9]^=O,w[18]^=f,w[19]^=O,w[28]^=f,w[29]^=O,w[38]^=f,w[39]^=O,w[48]^=f,w[49]^=O,Ct=w[0],Lt=w[1],Ht=w[11]<<4|w[10]>>>28,qt=w[10]<<4|w[11]>>>28,b=w[20]<<3|w[21]>>>29,r=w[21]<<3|w[20]>>>29,Sn=w[31]<<9|w[30]>>>23,_n=w[30]<<9|w[31]>>>23,Tt=w[40]<<18|w[41]>>>14,St=w[41]<<18|w[40]>>>14,Q=w[2]<<1|w[3]>>>31,Y=w[3]<<1|w[2]>>>31,Et=w[13]<<12|w[12]>>>20,Bt=w[12]<<12|w[13]>>>20,zt=w[22]<<10|w[23]>>>22,Mt=w[23]<<10|w[22]>>>22,l=w[33]<<13|w[32]>>>19,A=w[32]<<13|w[33]>>>19,oi=w[42]<<2|w[43]>>>30,Xo=w[43]<<2|w[42]>>>30,qn=w[5]<<30|w[4]>>>2,zn=w[4]<<30|w[5]>>>2,st=w[14]<<6|w[15]>>>26,ft=w[15]<<6|w[14]>>>26,Pt=w[25]<<11|w[24]>>>21,vt=w[24]<<11|w[25]>>>21,Yt=w[34]<<15|w[35]>>>17,Ce=w[35]<<15|w[34]>>>17,S=w[45]<<29|w[44]>>>3,P=w[44]<<29|w[45]>>>3,j=w[6]<<28|w[7]>>>4,rt=w[7]<<28|w[6]>>>4,xi=w[17]<<23|w[16]>>>9,Dn=w[16]<<23|w[17]>>>9,_t=w[26]<<25|w[27]>>>7,ut=w[27]<<25|w[26]>>>7,Wt=w[36]<<21|w[37]>>>11,B=w[37]<<21|w[36]>>>11,je=w[47]<<24|w[46]>>>8,Bi=w[46]<<24|w[47]>>>8,Gt=w[8]<<27|w[9]>>>5,Nt=w[9]<<27|w[8]>>>5,et=w[18]<<20|w[19]>>>12,ct=w[19]<<20|w[18]>>>12,kn=w[29]<<7|w[28]>>>25,Oi=w[28]<<7|w[29]>>>25,wt=w[38]<<8|w[39]>>>24,Rt=w[39]<<8|w[38]>>>24,M=w[48]<<14|w[49]>>>18,H=w[49]<<14|w[48]>>>18,w[0]=Ct^~Et&Pt,w[1]=Lt^~Bt&vt,w[10]=j^~et&b,w[11]=rt^~ct&r,w[20]=Q^~st&_t,w[21]=Y^~ft&ut,w[30]=Gt^~Ht&zt,w[31]=Nt^~qt&Mt,w[40]=qn^~xi&kn,w[41]=zn^~Dn&Oi,w[2]=Et^~Pt&Wt,w[3]=Bt^~vt&B,w[12]=et^~b&l,w[13]=ct^~r&A,w[22]=st^~_t&wt,w[23]=ft^~ut&Rt,w[32]=Ht^~zt&Yt,w[33]=qt^~Mt&Ce,w[42]=xi^~kn&Sn,w[43]=Dn^~Oi&_n,w[4]=Pt^~Wt&M,w[5]=vt^~B&H,w[14]=b^~l&S,w[15]=r^~A&P,w[24]=_t^~wt&Tt,w[25]=ut^~Rt&St,w[34]=zt^~Yt&je,w[35]=Mt^~Ce&Bi,w[44]=kn^~Sn&oi,w[45]=Oi^~_n&Xo,w[6]=Wt^~M&Ct,w[7]=B^~H&Lt,w[16]=l^~S&j,w[17]=A^~P&rt,w[26]=wt^~Tt&Q,w[27]=Rt^~St&Y,w[36]=Yt^~je&Gt,w[37]=Ce^~Bi&Nt,w[46]=Sn^~oi&qn,w[47]=_n^~Xo&zn,w[8]=M^~Ct&Et,w[9]=H^~Lt&Bt,w[18]=S^~j&et,w[19]=P^~rt&ct,w[28]=Tt^~Q&st,w[29]=St^~Y&ft,w[38]=je^~Gt&Ht,w[39]=Bi^~Nt&qt,w[48]=oi^~qn&xi,w[49]=Xo^~zn&Dn,w[0]^=T[p],w[1]^=T[p+1]};if(d)e.exports=z;else for(at=0;at<tt.length;++at)o[tt[at]]=z[tt[at]]})()})(Yy);let Jo,ie;async function Zy(e){var V,D,$;const t=await Vi,n=performance.now();for(var i of e)t.fs.writeFileSync(i.name,hl(i.value));const o=((V=e.find(v=>v.active&&v.value.includes("component main")))==null?void 0:V.name)||((D=e.find(v=>v.name==="main.circom"))==null?void 0:D.name)||(($=e.find(v=>v.value.includes("component main")))==null?void 0:$.name)||"main.circom";ie=o.replace(/\..*$/,"");const a=e.find(v=>v.name===o).value,c=/\/\/\s*zkrepl:\s*(.*)/i.exec(a),d=c?c[1].split(/[\s,]+/):[],h={nowasm:d.includes("nowasm"),nor1cs:d.includes("nor1cs"),nosym:d.includes("nosym"),nowtns:d.includes("nowtns")};await h2(o,h);const u=t.fs.readFileSync("/dev/stderr","utf8");u&&postMessage({type:"stderr",text:u});let s=await t.getStdOut();postMessage({type:"stdout",text:s+`Compiled in ${((performance.now()-n)/1e3).toFixed(2)}s`});let _,L=[],g,F;h.nowasm||(g=t.fs.readFileSync(`${ie}_js/${ie}.wasm`),h.nowtns||(_=await Fe(g,{log(v){L.push(v.toString())}})));let T;if(!h.nor1cs){F=t.fs.readFileSync(`${ie}.r1cs`);const{fd:v,sections:m}=await We(F,"r1cs",1);T=await zo(v,m,!0),await v.close()}const C=/\/*\s*INPUT\s*=\s*(\{[\s\S]+\})\s*\*\//.exec(a);let U={};if(C?U=JSON.parse(C[1]):T&&T.nPrvInputs+T.nPubInputs>0&&postMessage({type:"stderr",text:`To specify inputs, add to your circuit: 

INPUT = { "a": "1234" }`}),_&&(Jo=await _.calculateWTNSBin(U,!0)),L.length>0&&postMessage({type:"log",text:L.join(`
`)}),T&&T.nOutputs>0){const{fd:v,sections:m}=await We(Jo,"wtns",2),y=await as(v,m),G=await Cn(v,m,2);let k={};if(!h.nosym){const R=t.fs.readFileSync(`${ie}.sym`);let E=0,z=new TextDecoder("utf-8");for(let tt=0;tt<R.length;tt++)if(R[tt]===10){let at=z.decode(R.slice(E,tt)),it=+at.split(",")[0];it<=T.nOutputs&&(k[it]=at.split(",")[3].replace("main.","")+" = "),E=tt}}let N=[];for(let R=1;R<=T.nOutputs;R++){const E=G.slice(R*y.n8,R*y.n8+y.n8),z=k[R]||"";N.push(z+bu.fromRprLE(E).toString())}postMessage({type:"Output",text:N.join(`
`)}),await v.close()}postMessage({type:"Artifacts",text:"",files:Object.fromEntries(Object.entries({[`${ie}.wasm`]:g,[`${ie}.js`]:g&&t.fs.readFileSync(`${ie}_js/witness_calculator.js`),[`${ie}.wtns`]:!h.nowtns&&!h.nowasm&&Jo,[`${ie}.r1cs`]:F,[`${ie}.sym`]:!h.nosym&&t.fs.readFileSync(`${ie}.sym`)}).filter(([v,m])=>m))});const x=performance.now()-n;postMessage({type:"done",time:x,text:`Finished in ${(x/1e3).toFixed(2)}s`})}function Jy(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}async function Xy(e){const t=await Vi;let n=new RegExp("\\b"+Jy(e)+"(\\b|$)"),i=h=>n.test(h),o=[];const a=t.fs.readFileSync(`${ie}.sym`);let c=0,d=new TextDecoder("utf-8");for(let h=0;h<a.length;h++){if(a[h]!==10)continue;const s=d.decode(a.slice(c,h)).split(",");if(s[3]&&i(s[3])){const{fd:_,sections:L}=await We(Jo,"wtns",2),g=await as(_,L),F=await Cn(_,L,2),T=parseInt(s[1]);if(T!==-1){const C=F.slice(T*g.n8,T*g.n8+g.n8);o.push("*"+s[3].replace("main.","")+" =* "+bu.fromRprLE(C).toString())}if(await _.close(),o.length>3){o.push("...");break}}c=h+1}postMessage({type:"hover",text:o.join(`

`)})}onmessage=e=>{const t=e.data;t.type==="run"?Zy(t.files).catch(n=>{postMessage({type:"fail",text:n.message})}):t.type==="hover"?Xy(t.symbol).catch(n=>{console.log("hover err",n),postMessage({type:"hover",text:""})}):t.type==="groth16"?nA().catch(n=>{postMessage({type:"fail",text:n.message})}):t.type==="plonk"?eA().catch(n=>{postMessage({type:"fail",text:n.message})}):t.type==="verify"&&tA(t.data).catch(n=>{postMessage({type:"fail",text:n.message})})};async function tA(e){const{r1cs:t,r1csFile:n}=await ns(),i=await os(t.nConstraints),[o,a]=is(),c={type:"bigMem"};for(await pd(n,i,c,o);a.pop(););const d=await Wy(c,i,new Uint8Array(e),o);postMessage({type:"verified",text:d?"\u2705 Successfully verified zkey matches circuit":"\u274C Circuit does not match zkey"}),a.length>0&&postMessage({type:"log",text:a.join(`
`)})}async function ns(){const t=(await Vi).fs.readFileSync(`${ie}.r1cs`),{fd:n,sections:i}=await We(t,"r1cs",1),o=await zo(n,i,!0);return await n.close(),{r1cs:o,r1csFile:t}}async function eA(){const{r1cs:e,r1csFile:t}=await ns(),n=await os(4*3*e.nConstraints+e.nPubInputs+e.nOutputs),i={type:"mem",data:null},[o,a]=is();await Ky(t,n,i,o);const c=JSON.stringify(await es(i.data),null,"  "),d=await Ad(i.data,{plonk:o3});postMessage({type:"keys",files:{[ie+".plonk.zkey"]:i.data,[ie+".plonk.vkey.json"]:c,[ie+".plonk.sol"]:d}})}function is(){const e=[];return[{info(n){e.push(n),console.log("INFO",n)},warn(n){console.log("WARN",n)},debug(n){},error(n){console.log("ERROR",n)}},e]}async function nA(){const{r1cs:e,r1csFile:t}=await ns(),n=await os(e.nConstraints),i={type:"mem",data:null},[o,a]=is(),c=await pd(t,n,i,o),d={type:"mem",data:null},h=globalThis.crypto.getRandomValues(new Uint8Array(512)),u=await $y(i.data,d,"zkrepl",h);console.log("ZKEY",c,d,u);const s=JSON.stringify(await es(d.data),null,"  "),_=await Ad(d.data,{groth16:i3}),L=await Vi;postMessage({type:"keys",files:{[ie+".groth16.zkey"]:d.data,[ie+".groth16.vkey.json"]:s,[ie+".groth16.sol"]:_,[ie+".html"]:r3.replace("/* {{SNARKJS}} */",a3).replace("{{ZKEY_DATA}}","data:application/octet-stream;base64,"+Buffer.from(d.data).toString("base64")).replace("{{VKEY_DATA}}",s).replace("{{WASM_URL}}","data:application/wasm;base64,"+Buffer.from(L.fs.readFileSync(`${ie}_js/${ie}.wasm`)).toString("base64"))}})}async function os(e){const n=[{url:"https://cloudflare-ipfs.com/ipfs/bafybeierwc3pmc2id2zfpgb42njkzvvvj4s333dcq4gr5ri2ixa6vuxi6a",name:"powersOfTau28_hez_final_11.ptau",maxConstraints:1<<11,size:2442392},{url:"https://cloudflare-ipfs.com/ipfs/bafybeibyoizq4sfp7sfomoofgczak3lgispbvviljjgdpchsxjrb4p6qsi",name:"powersOfTau28_hez_final_12.ptau",maxConstraints:1<<12,size:4801688},{url:"https://cloudflare-ipfs.com/ipfs/bafybeiderqjodw2mc6m5fqnc7edsun5eu4niupyw3cdsiruospa66y5vam",name:"powersOfTau28_hez_final_13.ptau",maxConstraints:1<<13,size:9520280},{url:"https://cloudflare-ipfs.com/ipfs/bafybeihuh2cuustfaraum3txs2scrl5vaukkc6u5ztf27jlyx5xhtsz5ti",name:"powersOfTau28_hez_final_14.ptau",maxConstraints:1<<14,size:18957464},{url:"https://dweb.link/ipfs/bafybeihfv3pmjkfmefpwdxwmxxqtsax4ljshnhl3qai4v62q5r2wszix34",name:"powersOfTau28_hez_final_15.ptau",maxConstraints:1<<15,size:37831832},{url:"https://cloudflare-ipfs.com/ipfs/bafybeiajy6lpqym5fvszu4klbzoqzljwhv4ocxvqmwvlwrg6pd6rieggd4",name:"powersOfTau28_hez_final_16.ptau",maxConstraints:1<<16,size:75580568},{url:"https://dweb.link/ipfs/bafybeib6a55iwy4666wxcwo7vy756sn36cwyx7u2u5idqcjxopwa7wpb3m",name:"powersOfTau28_hez_final_17.ptau",maxConstraints:1<<17,size:151078040},{url:"https://dweb.link/ipfs/bafybeidmnn4gwlirvok6vllpu4b7hkgheyemmptmeqgmhk3ony6aanv77e",name:"powersOfTau28_hez_final_18.ptau",maxConstraints:1<<18,size:302072984}].find(d=>d.maxConstraints>=e);if(!n)throw new Error("No powers of tau supported for "+e+" constraints");console.log(e,n),postMessage({type:"progress",fraction:null});const i=await fetch(n.url);let o=0;const a=new Response(new ReadableStream({async start(d){const h=i.body.getReader();for(;;){const{done:u,value:s}=await h.read();if(u)break;o+=s.byteLength,postMessage({type:"progress",fraction:o/n.size}),d.enqueue(s)}d.close()}}));return new Uint8Array(await a.arrayBuffer())}async function as(e,t){await Ne(e,t,1);const n=await e.readULE32(),i=await Ei(e,n),o=await e.readULE32();return await qe(e),{n8:n,q:i,nWitness:o}}return ve.readWtnsHeader=as,Object.defineProperty(ve,"__esModule",{value:!0}),ve})({});
