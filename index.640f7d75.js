import{l as h,R as L,w as I,a as t,e as v,K as N,b as x,U as w,_ as P,c as K}from"./vendor.74e29366.js";const _=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))u(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&u(c)}).observe(document,{childList:!0,subtree:!0});function d(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(r){if(r.ep)return;r.ep=!0;const o=d(r);fetch(r.href,o)}};_();h.register({id:"circom"});let $=p=>{};h.registerHoverProvider("circom",{provideHover:async function(p,i){if(!M||M.running)return null;const d=p.getLineContent(i.lineNumber),u=/([a-z$_][a-z0-9$_]*)(\.[a-z$_][a-z0-9$_]*)*(\[\d+\])?/g,r=i.column;let o;if(o=/(include\s+)"([^"]+)"/g.exec(d),o){let c=[];return o[2].startsWith("circomlib/")?c.push({value:`[View Source](https://github.com/iden3/circomlib/blob/master/circuits/${o[2].replace("circomlib/","")})`}):o[2].startsWith("gist:")?c.push({value:`[View Source](https://gist.github.com/${o[2].replace("gist:","")})`}):(o[2].startsWith("http://")||o[2].startsWith("https://"))&&c.push({value:`[View Source](${o[2]})`}),{range:new L(i.lineNumber,1+o.index+o[1].length,i.lineNumber,1+o.index+o[0].length),contents:c}}for(;(o=u.exec(d))&&!(o.index>r);){if(o.index+o[0].length<r)continue;const c=o[0],f=await new Promise(l=>{$=k=>{l(k.text),$=()=>{}},M.postMessage({type:"hover",symbol:c})});return{range:new L(i.lineNumber,1+o.index,i.lineNumber,1+o.index+o[0].length),contents:[{value:f}]}}return null}});h.setLanguageConfiguration("circom",{wordPattern:/(-?\d*\.\d\w*)|([^\`\~\!\@\#\%\^\&\*\(\)\-\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\?\s]+)/g,comments:{lineComment:"//",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],onEnterRules:[{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:h.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:h.IndentAction.None,appendText:" * "}},{beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:h.IndentAction.None,appendText:"* "}},{beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/,action:{indentAction:h.IndentAction.None,removeText:1}}],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"',notIn:["string"]},{open:"'",close:"'",notIn:["string","comment"]},{open:"`",close:"`",notIn:["string","comment"]},{open:"/**",close:" */",notIn:["string"]}],folding:{markers:{start:new RegExp("^\\s*//\\s*#?region\\b"),end:new RegExp("^\\s*//\\s*#?endregion\\b")}}});h.setMonarchTokensProvider("circom",{keywords:["signal","input","output","public","template","component","var","function","return","if","else","for","while","do","log","assert","include","pragma"],typeKeywords:["input","output","public"],operators:["!","~","-","||","&&","==","!=","<",">","<=",">=","|","&","<<",">>","+","-","*","/","\\","%","**","^","=","<--","<=="],escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,tokenizer:{root:[[/[a-z_$][\w$]*/,{cases:{"@typeKeywords":"keyword","@keywords":"keyword","@default":"identifier"}}],[/[A-Z][\w\$]*/,"type.identifier"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/@\s*[a-zA-Z_\$][\w\$]*/,{token:"annotation",log:"annotation token: $0"}],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F]+/,"number.hex"],[/\d+/,"number"],[/[;,.]/,"delimiter"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/"/,{token:"string.quote",bracket:"@open",next:"@string"}],[/'[^\\']'/,"string"],[/(')(@escapes)(')/,["string","string.escape","string"]],[/'/,"string.invalid"]],comment:[[/[^\/*]+/,"comment"],[/\/\*/,"comment","@push"],["\\*/","comment","@pop"],[/[\/*]/,"comment"]],string:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]]}});var C=`pragma circom 2.0.3;

include "circomlib/poseidon.circom";
//include "https://github.com/0xPARC/circom-secp256k1/blob/master/circuits/bigint.circom";

template Example () {
    signal input a;
    signal input b;
    signal output c;
    
    c <== a * b;

    assert(a > 2);
    
    component hash = Poseidon(2);
    hash.inputs[0] <== a;
    hash.inputs[1] <== b;

    log(hash.out);
}

component main { public [ a ] } = Example();

/* INPUT = {
    "a": "5",
    "b": "77"
} */`;function G(){return new Worker("worker.bb482fef.js",{type:"module"})}var F="circomlib.acbc52cb.zip";console.log(F,I);var M;function U(){const[p,i]=t.useState(!1),[d,u]=t.useState([]),[r,o]=t.useState(null),c=t.useRef([]),f=t.useRef(null),l=t.useRef(null),[k,T]=t.useState(1),R=t.useRef({}),y=new URLSearchParams(location.search).get("gist"),b=()=>{(!l.current||l.current.running)&&(l.current&&(l.current.terminate(),l.current=null),l.current=new G,M=l.current,l.current.onmessage=e=>{const s=e.data;if(s.type==="fail")i(!1),l.current.running=!1;else if(s.type==="done")i(!1),l.current.running=!1;else if(s.type==="keys")i(!1),l.current.running=!1;else{if(s.type==="hover")return $(s);if(s.type==="debug")console.log(s.text);else if(s.type==="progress"){T(s.fraction);return}}u(n=>[...n,s])},l.current.onerror=e=>{console.error(e),u(s=>[...s,{type:"error",text:e.message}])}),l.current.running=!0,i(Math.random()+1),u([]),l.current.postMessage({type:"run",files:O(c.current)})},O=e=>e.map(s=>({value:s.getValue(),name:s.uri.path.slice(1),active:s.isAttachedToEditor()})),A=(e,s)=>{const n=[];for(const a in s==null?void 0:s.files){if(a==="about_zkrepl.md")continue;const m=v.createModel((s==null?void 0:s.files[a].content)||"// Unable to load gist","circom",new w().with({path:a}));n.push(m)}c.current=n,e.setModel(n[0])},E=()=>{const e={};for(const s of O(c.current))e[s.name]={content:s.value};return{files:e}},S=()=>{const e=new URLSearchParams(location.search).get("gist"),s=()=>{localStorage.GithubNavigationCodeSnapshot=JSON.stringify(E()),location.href="https://github.com/login/oauth/authorize?client_id=85123c5a3a8a8f73f015&scope=gist"};if(history.state===JSON.stringify(E()))console.log("Already saved!");else if(localStorage.GithubAccessToken){i(Math.random()+1);const n=async a=>{const m=E();return a&&(m.files["about_zkrepl.md"]={content:`Open this in [zkREPL \u2192](https://zkrepl.dev/?gist=${a})

This file can be included into other zkREPLs with \`\`\`include "gist:`+a+'";```'}),fetch(a?"https://api.github.com/gists/"+a:"https://api.github.com/gists",{method:"POST",body:JSON.stringify(m),headers:{Authorization:"token "+localStorage.GithubAccessToken}}).then(g=>g.json())};n(e).then(a=>a.id&&!e?n(a.id):a).then(a=>{a.id?(history.replaceState(JSON.stringify(E()),"","/?gist="+a.id),u(m=>[...m,{type:"save",url:`https://gist.github.com/${a.id}`,text:"Saved to Github"}])):a.message==="Bad credentials"?s():a.message==="Not Found"&&e&&(history.replaceState(null,"","/"),S()),i(!1)})}else s()};t.useEffect(()=>{if(f&&!r){const e=v.create(f.current,{language:"circom",theme:"vs",automaticLayout:!0,hover:{enabled:!0}});window.addEventListener("beforeunload",()=>{sessionStorage.ZKReplState=JSON.stringify(E())}),window.addEventListener("keydown",n=>{(n.metaKey||n.ctrlKey)&&n.key==="r"&&n.preventDefault()}),e.addCommand(N.CtrlCmd|x.KeyS,S),e.addCommand(N.CtrlCmd|x.Enter,b),e.addCommand(N.Shift|x.Enter,b),e.addCommand(N.CtrlCmd|x.Period,function(){console.log("Abort kernel!"),i(!1),u(n=>[...n,{type:"abort",text:"Execution manually interrupted"}]),l.current&&(l.current.terminate(),l.current=null)});const s=new URLSearchParams(location.search).get("code");if(s)history.replaceState(null,"","/"),fetch("https://kikks470wl.execute-api.us-west-1.amazonaws.com/access_token?code="+s,{method:"POST"}).then(n=>n.formData()).then(n=>{n.get("access_token")?(localStorage.GithubAccessToken=n.get("access_token"),A(e,JSON.parse(localStorage.GithubNavigationCodeSnapshot)),S()):alert("Failed to get access token")});else if(sessionStorage.ZKReplState)A(e,JSON.parse(sessionStorage.ZKReplState)),delete sessionStorage.ZKReplState,b();else if(y)fetch("https://api.github.com/gists/"+y).then(n=>n.json()).then(n=>{A(e,n),b()});else{const n=[],a={"main.circom":C};for(const m in a){const g=v.createModel(a[m],"circom",new w().with({path:m}));n.push(g)}c.current=n,e.setModel(n[0]),b()}o(e)}return()=>r==null?void 0:r.dispose()},[f.current]);const z=e=>{const s=r==null?void 0:r.saveViewState();s&&(r==null?void 0:r.getModel())&&(R.current[r==null?void 0:r.getModel().uri.path]=s),r==null||r.setModel(e),R.current[e.uri.path]&&(r==null||r.restoreViewState(R.current[e.uri.path])),u(n=>n.slice(0))};return t.createElement("div",{className:"layout"},t.createElement("div",{className:"primary"},t.createElement("div",{className:"tabs"},c.current.map((e,s)=>t.createElement("div",{className:"tab "+((r==null?void 0:r.getModel().uri.path)===e.uri.path?"active":"inactive"),onClick:n=>z(e),key:s},t.createElement("input",{value:e.uri.path.slice(1),spellCheck:!1,onChange:n=>{const a=n.target.value;if(!c.current.some(g=>g.uri.path==="/"+a)){const g=v.createModel(e.getValue(),"circom",new w().with({path:a}));e.dispose(),c.current.splice(s,1,g),r==null||r.setModel(g)}n.target.style.width="0px",n.target.style.width=n.target.scrollWidth+2+"px",u(g=>g.slice(0))},ref:n=>{n&&(n.style.width="0px",n.style.width=n.scrollWidth+2+"px")}}),t.createElement("div",{className:"x",onClick:n=>{var a;if((((a=e==null?void 0:e.getValue())==null?void 0:a.length)||0)<30||(e==null?void 0:e.getValue())===C||confirm(`Are you sure you want to remove "${e.uri.path.slice(1)}"?`)){if(c.current.length==1){const m=v.createModel(C,"circom",new w().with({path:"main.circom"}));c.current.push(m),r.setModel(m)}e.dispose(),c.current.splice(s,1),r==null||r.setModel(c.current[0]),u(m=>m.slice(0)),n.stopPropagation()}}},t.createElement("div",null,"\xD7")))),t.createElement("div",{className:"add",onClick:()=>{let e="untitled.circom";for(let n=2;c.current.some(a=>a.uri.path=="/"+e);n++)e=`untitled${n}.circom`;const s=v.createModel(C,"circom",new w().with({path:e}));c.current.push(s),r.setModel(s),u(d.slice(0))}},"+ Add File")),t.createElement("div",{className:"editor",ref:f})),t.createElement("div",{className:"sidebar"},t.createElement("div",{className:"output"},t.createElement("div",{className:"heading"},t.createElement("div",{className:"description"},t.createElement("b",null,"Shift-Enter")," to"," ",t.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),b()}},"run")," ",t.createElement("br",null),t.createElement("b",null,"Cmd-S")," to"," ",t.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),S()}},"save")," ","as"," ",y?t.createElement("a",{href:`https://gist.github.com/${y}`,target:"_blank"},"Github Gist"):"Github Gist"),t.createElement("img",{className:"logo",src:new URL("logo.effa8f98.png",self.location).toString(),alt:"zkrepl"})),t.createElement("br",null),d.map((e,s)=>t.createElement("div",{key:s,className:"message"},t.createElement("div",{className:"label"},e.type,": "),e.url?t.createElement("a",{href:e.url},t.createElement(P,null,e.text)):t.createElement(P,null,e.text),e.type==="save"&&t.createElement("div",{className:"embed-snippet"},t.createElement("textarea",{readOnly:!0,onClick:n=>{n.target.select(),document.execCommand("copy")},value:`<iframe src="https://zkrepl.dev/?gist=${y}" height="400" width="1000" style="border:1px solid #ddd"></iframe>`})),e.files&&t.createElement("div",{className:"files"},Object.entries(e.files).map(([n,a])=>t.createElement("li",{key:n},t.createElement("a",{href:URL.createObjectURL(new Blob([a],{type:"application/octet-stream"})),download:n},n)," ","(",(a.length/1e3).toFixed(2),"KB)"))))),d.some(e=>e.type==="done")&&!d.some(e=>e.type==="keys")&&!p&&l.current&&t.createElement("div",null,t.createElement("div",{className:"label"},"Prove/Verify Keys: "),t.createElement("div",{className:"phase2"},t.createElement("button",{onClick:()=>{l.current.postMessage({type:"groth16"}),i(Math.random())}},"Groth16"),t.createElement("button",{onClick:()=>{l.current.postMessage({type:"plonk"}),i(Math.random())}},"PLONK"))),k!==1&&t.createElement("div",{className:"progress-container"},t.createElement("progress",{value:k})),p?t.createElement(D,{key:p}):null)))}function D(){const[p,i]=t.useState(0);return t.useEffect(()=>{const d=Date.now(),u=setInterval(()=>{i(Date.now()-d)},16);return()=>clearInterval(u)},[]),t.createElement("div",{className:"loading"},t.createElement("div",{className:"lds-ellipsis"},t.createElement("div",null),t.createElement("div",null),t.createElement("div",null),t.createElement("div",null)),p>200&&t.createElement("div",{className:"time"},(p/1e3).toFixed(2),"s"),t.createElement("div",{className:"time"},t.createElement("small",null,t.createElement("b",null,"Cmd-.")," to interrupt")))}K.createRoot(document.getElementById("root")).render(t.createElement(U,null));
