(function(){"use strict";function Cd(e,t){return t.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(i){if(i!=="default"&&!(i in e)){var a=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:function(){return n[i]}})}})}),Object.freeze(e)}async function Sd(e,t){t=t||{};let n;try{n=await WebAssembly.compile(e)}catch(l){throw t.log(l),t.log(`
Try to run circom --c in order to generate c++ code instead
`),new Error(l)}let i,a="",o="";const s=await WebAssembly.instantiate(n,{runtime:{exceptionHandler:function(l){let m;throw l==1?m=`Signal not found.
`:l==2?m=`Too many signals set.
`:l==3?m=`Signal already set.
`:l==4?m=`Assert Failed.
`:l==5?m=`Not enough memory.
`:l==6?m=`Input signal array access exceeds the size.
`:m=`Unknown error.
`,new Error(m+a)},printErrorMessage:function(){a+=h()+`
`},writeBufferMessage:function(){const l=h();l===`
`?(t.log(o),o=""):(o!==""&&(o+=" "),o+=l)},showSharedRWMemory:function(){f()}}}),d=t;return i=new Fd(s,d),i;function h(){for(var l="",m=s.exports.getMessageChar();m!=0;)l+=String.fromCharCode(m),m=s.exports.getMessageChar();return l}function f(){const l=s.exports.getFieldNumLen32(),m=new Uint32Array(l);for(let I=0;I<l;I++)m[l-1-I]=s.exports.readSharedRWMemory(I);o!==""&&(o+=" "),o+=va(m).toString()}}class Fd{constructor(t,n){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const i=new Uint32Array(this.n32);for(let a=0;a<this.n32;a++)i[this.n32-1-a]=this.instance.exports.readSharedRWMemory(a);this.prime=va(i),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=n}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,n){this.instance.exports.init(this.sanityCheck||n?1:0);const i=Object.keys(t);var a=0;if(i.forEach(o=>{const s=xd(o),d=parseInt(s.slice(0,8),16),h=parseInt(s.slice(8,16),16),f=Bd(t[o]);let l=this.instance.exports.getInputSignalSize(d,h);if(l<0)throw new Error(`Signal ${o} not found
`);if(f.length<l)throw new Error(`Not enough values for input signal ${o}
`);if(f.length>l)throw new Error(`Too many values for input signal ${o}
`);for(let m=0;m<f.length;m++){const I=vd(BigInt(f[m])%this.prime,this.n32);for(let g=0;g<this.n32;g++)this.instance.exports.writeSharedRWMemory(g,I[this.n32-1-g]);try{this.instance.exports.setInputSignal(d,h,m),a++}catch(g){throw new Error(g)}}}),a<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${a} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,n){const i=[];await this._doCalculateWitness(t,n);for(let a=0;a<this.witnessSize;a++){this.instance.exports.getWitness(a);const o=new Uint32Array(this.n32);for(let s=0;s<this.n32;s++)o[this.n32-1-s]=this.instance.exports.readSharedRWMemory(s);i.push(va(o))}return i}async calculateBinWitness(t,n){const i=new Uint32Array(this.witnessSize*this.n32),a=new Uint8Array(i.buffer);await this._doCalculateWitness(t,n);for(let o=0;o<this.witnessSize;o++){this.instance.exports.getWitness(o);const s=o*this.n32;for(let d=0;d<this.n32;d++)i[s+d]=this.instance.exports.readSharedRWMemory(d)}return a}async calculateWTNSBin(t,n){const i=new Uint32Array(this.witnessSize*this.n32+this.n32+11),a=new Uint8Array(i.buffer);await this._doCalculateWitness(t,n),a[0]="w".charCodeAt(0),a[1]="t".charCodeAt(0),a[2]="n".charCodeAt(0),a[3]="s".charCodeAt(0),i[1]=2,i[2]=2,i[3]=1;const o=this.n32*4,d=(8+o).toString(16);i[4]=parseInt(d.slice(0,8),16),i[5]=parseInt(d.slice(8,16),16),i[6]=o,this.instance.exports.getRawPrime();var h=7;for(let m=0;m<this.n32;m++)i[h+m]=this.instance.exports.readSharedRWMemory(m);h+=this.n32,i[h]=this.witnessSize,h++,i[h]=2,h++;const l=(o*this.witnessSize).toString(16);i[h]=parseInt(l.slice(0,8),16),i[h+1]=parseInt(l.slice(8,16),16),h+=2;for(let m=0;m<this.witnessSize;m++){this.instance.exports.getWitness(m);for(let I=0;I<this.n32;I++)i[h+I]=this.instance.exports.readSharedRWMemory(I);h+=this.n32}return a}}function vd(e,t){const n=[],i=BigInt(4294967296);for(;e;)n.unshift(Number(e%i)),e=e/i;if(t)for(var a=t-n.length;a>0;)n.unshift(0),a--;return n}function va(e){var t=BigInt(0);const n=BigInt(4294967296);for(let i=0;i<e.length;i++)t=t*n+BigInt(e[i]);return t}function Bd(e){var t=[];return n(t,e),t;function n(i,a){if(Array.isArray(a))for(let o=0;o<a.length;o++)n(i,a[o]);else i.push(a)}}function xd(e){const t=BigInt(2)**BigInt(64);let n=BigInt("0xCBF29CE484222325");for(var i=0;i<e.length;i++)n^=BigInt(e[i].charCodeAt()),n*=BigInt(1099511628211),n%=t;let a=n.toString(16),o=16-a.length;return a="0".repeat(o).concat(a),a}var De=[],Oe=[],Td=typeof Uint8Array<"u"?Uint8Array:Array,Ba=!1;function gr(){Ba=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)De[t]=e[t],Oe[e.charCodeAt(t)]=t;Oe["-".charCodeAt(0)]=62,Oe["_".charCodeAt(0)]=63}function Pd(e){Ba||gr();var t,n,i,a,o,s,d=e.length;if(d%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o=e[d-2]==="="?2:e[d-1]==="="?1:0,s=new Td(d*3/4-o),i=o>0?d-4:d;var h=0;for(t=0,n=0;t<i;t+=4,n+=3)a=Oe[e.charCodeAt(t)]<<18|Oe[e.charCodeAt(t+1)]<<12|Oe[e.charCodeAt(t+2)]<<6|Oe[e.charCodeAt(t+3)],s[h++]=a>>16&255,s[h++]=a>>8&255,s[h++]=a&255;return o===2?(a=Oe[e.charCodeAt(t)]<<2|Oe[e.charCodeAt(t+1)]>>4,s[h++]=a&255):o===1&&(a=Oe[e.charCodeAt(t)]<<10|Oe[e.charCodeAt(t+1)]<<4|Oe[e.charCodeAt(t+2)]>>2,s[h++]=a>>8&255,s[h++]=a&255),s}function Od(e){return De[e>>18&63]+De[e>>12&63]+De[e>>6&63]+De[e&63]}function Rd(e,t,n){for(var i,a=[],o=t;o<n;o+=3)i=(e[o]<<16)+(e[o+1]<<8)+e[o+2],a.push(Od(i));return a.join("")}function pr(e){Ba||gr();for(var t,n=e.length,i=n%3,a="",o=[],s=16383,d=0,h=n-i;d<h;d+=s)o.push(Rd(e,d,d+s>h?h:d+s));return i===1?(t=e[n-1],a+=De[t>>2],a+=De[t<<4&63],a+="=="):i===2&&(t=(e[n-2]<<8)+e[n-1],a+=De[t>>10],a+=De[t>>4&63],a+=De[t<<2&63],a+="="),o.push(a),o.join("")}function Ki(e,t,n,i,a){var o,s,d=a*8-i-1,h=(1<<d)-1,f=h>>1,l=-7,m=n?a-1:0,I=n?-1:1,g=e[t+m];for(m+=I,o=g&(1<<-l)-1,g>>=-l,l+=d;l>0;o=o*256+e[t+m],m+=I,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=i;l>0;s=s*256+e[t+m],m+=I,l-=8);if(o===0)o=1-f;else{if(o===h)return s?NaN:(g?-1:1)*(1/0);s=s+Math.pow(2,i),o=o-f}return(g?-1:1)*s*Math.pow(2,o-i)}function mr(e,t,n,i,a,o){var s,d,h,f=o*8-a-1,l=(1<<f)-1,m=l>>1,I=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=i?0:o-1,B=i?1:-1,P=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(d=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-s))<1&&(s--,h*=2),s+m>=1?t+=I/h:t+=I*Math.pow(2,1-m),t*h>=2&&(s++,h/=2),s+m>=l?(d=0,s=l):s+m>=1?(d=(t*h-1)*Math.pow(2,a),s=s+m):(d=t*Math.pow(2,m-1)*Math.pow(2,a),s=0));a>=8;e[n+g]=d&255,g+=B,d/=256,a-=8);for(s=s<<a|d,f+=a;f>0;e[n+g]=s&255,g+=B,s/=256,f-=8);e[n+g-B]|=P*128}var Ud={}.toString,Lr=Array.isArray||function(e){return Ud.call(e)=="[object Array]"};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */var Gd=50;pt.TYPED_ARRAY_SUPPORT=!0,Vi();function Vi(){return pt.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Ze(e,t){if(Vi()<t)throw new RangeError("Invalid typed array length");return pt.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=pt.prototype):(e===null&&(e=new pt(t)),e.length=t),e}function pt(e,t,n){if(!pt.TYPED_ARRAY_SUPPORT&&!(this instanceof pt))return new pt(e,t,n);if(typeof e=="number"){if(typeof t=="string")throw new Error("If encoding is specified then the first argument must be a string");return xa(this,e)}return Ar(this,e,t,n)}pt.poolSize=8192,pt._augment=function(e){return e.__proto__=pt.prototype,e};function Ar(e,t,n,i){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer?Nd(e,t,n,i):typeof t=="string"?Dd(e,t,n):kd(e,t)}pt.from=function(e,t,n){return Ar(null,e,t,n)},pt.TYPED_ARRAY_SUPPORT&&(pt.prototype.__proto__=Uint8Array.prototype,pt.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&pt[Symbol.species]);function yr(e){if(typeof e!="number")throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function Md(e,t,n,i){return yr(t),t<=0?Ze(e,t):n!==void 0?typeof i=="string"?Ze(e,t).fill(n,i):Ze(e,t).fill(n):Ze(e,t)}pt.alloc=function(e,t,n){return Md(null,e,t,n)};function xa(e,t){if(yr(t),e=Ze(e,t<0?0:Pa(t)|0),!pt.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}pt.allocUnsafe=function(e){return xa(null,e)},pt.allocUnsafeSlow=function(e){return xa(null,e)};function Dd(e,t,n){if((typeof n!="string"||n==="")&&(n="utf8"),!pt.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=wr(t,n)|0;e=Ze(e,i);var a=e.write(t,n);return a!==i&&(e=e.slice(0,a)),e}function Ta(e,t){var n=t.length<0?0:Pa(t.length)|0;e=Ze(e,n);for(var i=0;i<n;i+=1)e[i]=t[i]&255;return e}function Nd(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return n===void 0&&i===void 0?t=new Uint8Array(t):i===void 0?t=new Uint8Array(t,n):t=new Uint8Array(t,n,i),pt.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=pt.prototype):e=Ta(e,t),e}function kd(e,t){if(Ne(t)){var n=Pa(t.length)|0;return e=Ze(e,n),e.length===0||t.copy(e,0,0,n),e}if(t){if(typeof ArrayBuffer<"u"&&t.buffer instanceof ArrayBuffer||"length"in t)return typeof t.length!="number"||ou(t.length)?Ze(e,0):Ta(e,t);if(t.type==="Buffer"&&Lr(t.data))return Ta(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Pa(e){if(e>=Vi())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Vi().toString(16)+" bytes");return e|0}pt.isBuffer=ru;function Ne(e){return!!(e!=null&&e._isBuffer)}pt.compare=function(t,n){if(!Ne(t)||!Ne(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var i=t.length,a=n.length,o=0,s=Math.min(i,a);o<s;++o)if(t[o]!==n[o]){i=t[o],a=n[o];break}return i<a?-1:a<i?1:0},pt.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},pt.concat=function(t,n){if(!Lr(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return pt.alloc(0);var i;if(n===void 0)for(n=0,i=0;i<t.length;++i)n+=t[i].length;var a=pt.allocUnsafe(n),o=0;for(i=0;i<t.length;++i){var s=t[i];if(!Ne(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(a,o),o+=s.length}return a};function wr(e,t){if(Ne(e))return e.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;typeof e!="string"&&(e=""+e);var n=e.length;if(n===0)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return $i(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n*2;case"hex":return n>>>1;case"base64":return xr(e).length;default:if(i)return $i(e).length;t=(""+t).toLowerCase(),i=!0}}pt.byteLength=wr;function zd(e,t,n){var i=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((n===void 0||n>this.length)&&(n=this.length),n<=0)||(n>>>=0,t>>>=0,n<=t))return"";for(e||(e="utf8");;)switch(e){case"hex":return Zd(this,t,n);case"utf8":case"utf-8":return Cr(this,t,n);case"ascii":return Yd(this,t,n);case"latin1":case"binary":return $d(this,t,n);case"base64":return Vd(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Jd(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}pt.prototype._isBuffer=!0;function In(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}pt.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<t;n+=2)In(this,n,n+1);return this},pt.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<t;n+=4)In(this,n,n+3),In(this,n+1,n+2);return this},pt.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<t;n+=8)In(this,n,n+7),In(this,n+1,n+6),In(this,n+2,n+5),In(this,n+3,n+4);return this},pt.prototype.toString=function(){var t=this.length|0;return t===0?"":arguments.length===0?Cr(this,0,t):zd.apply(this,arguments)},pt.prototype.equals=function(t){if(!Ne(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:pt.compare(this,t)===0},pt.prototype.inspect=function(){var t="",n=Gd;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},pt.prototype.compare=function(t,n,i,a,o){if(!Ne(t))throw new TypeError("Argument must be a Buffer");if(n===void 0&&(n=0),i===void 0&&(i=t?t.length:0),a===void 0&&(a=0),o===void 0&&(o=this.length),n<0||i>t.length||a<0||o>this.length)throw new RangeError("out of range index");if(a>=o&&n>=i)return 0;if(a>=o)return-1;if(n>=i)return 1;if(n>>>=0,i>>>=0,a>>>=0,o>>>=0,this===t)return 0;for(var s=o-a,d=i-n,h=Math.min(s,d),f=this.slice(a,o),l=t.slice(n,i),m=0;m<h;++m)if(f[m]!==l[m]){s=f[m],d=l[m];break}return s<d?-1:d<s?1:0};function Ir(e,t,n,i,a){if(e.length===0)return-1;if(typeof n=="string"?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0)if(a)n=0;else return-1;if(typeof t=="string"&&(t=pt.from(t,i)),Ne(t))return t.length===0?-1:Er(e,t,n,i,a);if(typeof t=="number")return t=t&255,pt.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):Er(e,[t],n,i,a);throw new TypeError("val must be string, number or Buffer")}function Er(e,t,n,i,a){var o=1,s=e.length,d=t.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(e.length<2||t.length<2)return-1;o=2,s/=2,d/=2,n/=2}function h(g,B){return o===1?g[B]:g.readUInt16BE(B*o)}var f;if(a){var l=-1;for(f=n;f<s;f++)if(h(e,f)===h(t,l===-1?0:f-l)){if(l===-1&&(l=f),f-l+1===d)return l*o}else l!==-1&&(f-=f-l),l=-1}else for(n+d>s&&(n=s-d),f=n;f>=0;f--){for(var m=!0,I=0;I<d;I++)if(h(e,f+I)!==h(t,I)){m=!1;break}if(m)return f}return-1}pt.prototype.includes=function(t,n,i){return this.indexOf(t,n,i)!==-1},pt.prototype.indexOf=function(t,n,i){return Ir(this,t,n,i,!0)},pt.prototype.lastIndexOf=function(t,n,i){return Ir(this,t,n,i,!1)};function qd(e,t,n,i){n=Number(n)||0;var a=e.length-n;i?(i=Number(i),i>a&&(i=a)):i=a;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var s=0;s<i;++s){var d=parseInt(t.substr(s*2,2),16);if(isNaN(d))return s;e[n+s]=d}return s}function Qd(e,t,n,i){return Zi($i(t,e.length-n),e,n,i)}function br(e,t,n,i){return Zi(iu(t),e,n,i)}function Hd(e,t,n,i){return br(e,t,n,i)}function Wd(e,t,n,i){return Zi(xr(t),e,n,i)}function Kd(e,t,n,i){return Zi(au(t,e.length-n),e,n,i)}pt.prototype.write=function(t,n,i,a){if(n===void 0)a="utf8",i=this.length,n=0;else if(i===void 0&&typeof n=="string")a=n,i=this.length,n=0;else if(isFinite(n))n=n|0,isFinite(i)?(i=i|0,a===void 0&&(a="utf8")):(a=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-n;if((i===void 0||i>o)&&(i=o),t.length>0&&(i<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var s=!1;;)switch(a){case"hex":return qd(this,t,n,i);case"utf8":case"utf-8":return Qd(this,t,n,i);case"ascii":return br(this,t,n,i);case"latin1":case"binary":return Hd(this,t,n,i);case"base64":return Wd(this,t,n,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Kd(this,t,n,i);default:if(s)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),s=!0}},pt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Vd(e,t,n){return t===0&&n===e.length?pr(e):pr(e.slice(t,n))}function Cr(e,t,n){n=Math.min(e.length,n);for(var i=[],a=t;a<n;){var o=e[a],s=null,d=o>239?4:o>223?3:o>191?2:1;if(a+d<=n){var h,f,l,m;switch(d){case 1:o<128&&(s=o);break;case 2:h=e[a+1],(h&192)===128&&(m=(o&31)<<6|h&63,m>127&&(s=m));break;case 3:h=e[a+1],f=e[a+2],(h&192)===128&&(f&192)===128&&(m=(o&15)<<12|(h&63)<<6|f&63,m>2047&&(m<55296||m>57343)&&(s=m));break;case 4:h=e[a+1],f=e[a+2],l=e[a+3],(h&192)===128&&(f&192)===128&&(l&192)===128&&(m=(o&15)<<18|(h&63)<<12|(f&63)<<6|l&63,m>65535&&m<1114112&&(s=m))}}s===null?(s=65533,d=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),a+=d}return jd(i)}var Sr=4096;function jd(e){var t=e.length;if(t<=Sr)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=Sr));return n}function Yd(e,t,n){var i="";n=Math.min(e.length,n);for(var a=t;a<n;++a)i+=String.fromCharCode(e[a]&127);return i}function $d(e,t,n){var i="";n=Math.min(e.length,n);for(var a=t;a<n;++a)i+=String.fromCharCode(e[a]);return i}function Zd(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var a="",o=t;o<n;++o)a+=nu(e[o]);return a}function Jd(e,t,n){for(var i=e.slice(t,n),a="",o=0;o<i.length;o+=2)a+=String.fromCharCode(i[o]+i[o+1]*256);return a}pt.prototype.slice=function(t,n){var i=this.length;t=~~t,n=n===void 0?i:~~n,t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),n<0?(n+=i,n<0&&(n=0)):n>i&&(n=i),n<t&&(n=t);var a;if(pt.TYPED_ARRAY_SUPPORT)a=this.subarray(t,n),a.__proto__=pt.prototype;else{var o=n-t;a=new pt(o,void 0);for(var s=0;s<o;++s)a[s]=this[s+t]}return a};function le(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}pt.prototype.readUIntLE=function(t,n,i){t=t|0,n=n|0,i||le(t,n,this.length);for(var a=this[t],o=1,s=0;++s<n&&(o*=256);)a+=this[t+s]*o;return a},pt.prototype.readUIntBE=function(t,n,i){t=t|0,n=n|0,i||le(t,n,this.length);for(var a=this[t+--n],o=1;n>0&&(o*=256);)a+=this[t+--n]*o;return a},pt.prototype.readUInt8=function(t,n){return n||le(t,1,this.length),this[t]},pt.prototype.readUInt16LE=function(t,n){return n||le(t,2,this.length),this[t]|this[t+1]<<8},pt.prototype.readUInt16BE=function(t,n){return n||le(t,2,this.length),this[t]<<8|this[t+1]},pt.prototype.readUInt32LE=function(t,n){return n||le(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216},pt.prototype.readUInt32BE=function(t,n){return n||le(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])},pt.prototype.readIntLE=function(t,n,i){t=t|0,n=n|0,i||le(t,n,this.length);for(var a=this[t],o=1,s=0;++s<n&&(o*=256);)a+=this[t+s]*o;return o*=128,a>=o&&(a-=Math.pow(2,8*n)),a},pt.prototype.readIntBE=function(t,n,i){t=t|0,n=n|0,i||le(t,n,this.length);for(var a=n,o=1,s=this[t+--a];a>0&&(o*=256);)s+=this[t+--a]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*n)),s},pt.prototype.readInt8=function(t,n){return n||le(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]},pt.prototype.readInt16LE=function(t,n){n||le(t,2,this.length);var i=this[t]|this[t+1]<<8;return i&32768?i|4294901760:i},pt.prototype.readInt16BE=function(t,n){n||le(t,2,this.length);var i=this[t+1]|this[t]<<8;return i&32768?i|4294901760:i},pt.prototype.readInt32LE=function(t,n){return n||le(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},pt.prototype.readInt32BE=function(t,n){return n||le(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},pt.prototype.readFloatLE=function(t,n){return n||le(t,4,this.length),Ki(this,t,!0,23,4)},pt.prototype.readFloatBE=function(t,n){return n||le(t,4,this.length),Ki(this,t,!1,23,4)},pt.prototype.readDoubleLE=function(t,n){return n||le(t,8,this.length),Ki(this,t,!0,52,8)},pt.prototype.readDoubleBE=function(t,n){return n||le(t,8,this.length),Ki(this,t,!1,52,8)};function Ee(e,t,n,i,a,o){if(!Ne(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}pt.prototype.writeUIntLE=function(t,n,i,a){if(t=+t,n=n|0,i=i|0,!a){var o=Math.pow(2,8*i)-1;Ee(this,t,n,i,o,0)}var s=1,d=0;for(this[n]=t&255;++d<i&&(s*=256);)this[n+d]=t/s&255;return n+i},pt.prototype.writeUIntBE=function(t,n,i,a){if(t=+t,n=n|0,i=i|0,!a){var o=Math.pow(2,8*i)-1;Ee(this,t,n,i,o,0)}var s=i-1,d=1;for(this[n+s]=t&255;--s>=0&&(d*=256);)this[n+s]=t/d&255;return n+i},pt.prototype.writeUInt8=function(t,n,i){return t=+t,n=n|0,i||Ee(this,t,n,1,255,0),pt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=t&255,n+1};function ji(e,t,n,i){t<0&&(t=65535+t+1);for(var a=0,o=Math.min(e.length-n,2);a<o;++a)e[n+a]=(t&255<<8*(i?a:1-a))>>>(i?a:1-a)*8}pt.prototype.writeUInt16LE=function(t,n,i){return t=+t,n=n|0,i||Ee(this,t,n,2,65535,0),pt.TYPED_ARRAY_SUPPORT?(this[n]=t&255,this[n+1]=t>>>8):ji(this,t,n,!0),n+2},pt.prototype.writeUInt16BE=function(t,n,i){return t=+t,n=n|0,i||Ee(this,t,n,2,65535,0),pt.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=t&255):ji(this,t,n,!1),n+2};function Yi(e,t,n,i){t<0&&(t=4294967295+t+1);for(var a=0,o=Math.min(e.length-n,4);a<o;++a)e[n+a]=t>>>(i?a:3-a)*8&255}pt.prototype.writeUInt32LE=function(t,n,i){return t=+t,n=n|0,i||Ee(this,t,n,4,4294967295,0),pt.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=t&255):Yi(this,t,n,!0),n+4},pt.prototype.writeUInt32BE=function(t,n,i){return t=+t,n=n|0,i||Ee(this,t,n,4,4294967295,0),pt.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=t&255):Yi(this,t,n,!1),n+4},pt.prototype.writeIntLE=function(t,n,i,a){if(t=+t,n=n|0,!a){var o=Math.pow(2,8*i-1);Ee(this,t,n,i,o-1,-o)}var s=0,d=1,h=0;for(this[n]=t&255;++s<i&&(d*=256);)t<0&&h===0&&this[n+s-1]!==0&&(h=1),this[n+s]=(t/d>>0)-h&255;return n+i},pt.prototype.writeIntBE=function(t,n,i,a){if(t=+t,n=n|0,!a){var o=Math.pow(2,8*i-1);Ee(this,t,n,i,o-1,-o)}var s=i-1,d=1,h=0;for(this[n+s]=t&255;--s>=0&&(d*=256);)t<0&&h===0&&this[n+s+1]!==0&&(h=1),this[n+s]=(t/d>>0)-h&255;return n+i},pt.prototype.writeInt8=function(t,n,i){return t=+t,n=n|0,i||Ee(this,t,n,1,127,-128),pt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=t&255,n+1},pt.prototype.writeInt16LE=function(t,n,i){return t=+t,n=n|0,i||Ee(this,t,n,2,32767,-32768),pt.TYPED_ARRAY_SUPPORT?(this[n]=t&255,this[n+1]=t>>>8):ji(this,t,n,!0),n+2},pt.prototype.writeInt16BE=function(t,n,i){return t=+t,n=n|0,i||Ee(this,t,n,2,32767,-32768),pt.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=t&255):ji(this,t,n,!1),n+2},pt.prototype.writeInt32LE=function(t,n,i){return t=+t,n=n|0,i||Ee(this,t,n,4,2147483647,-2147483648),pt.TYPED_ARRAY_SUPPORT?(this[n]=t&255,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):Yi(this,t,n,!0),n+4},pt.prototype.writeInt32BE=function(t,n,i){return t=+t,n=n|0,i||Ee(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),pt.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=t&255):Yi(this,t,n,!1),n+4};function Fr(e,t,n,i,a,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function vr(e,t,n,i,a){return a||Fr(e,t,n,4),mr(e,t,n,i,23,4),n+4}pt.prototype.writeFloatLE=function(t,n,i){return vr(this,t,n,!0,i)},pt.prototype.writeFloatBE=function(t,n,i){return vr(this,t,n,!1,i)};function Br(e,t,n,i,a){return a||Fr(e,t,n,8),mr(e,t,n,i,52,8),n+8}pt.prototype.writeDoubleLE=function(t,n,i){return Br(this,t,n,!0,i)},pt.prototype.writeDoubleBE=function(t,n,i){return Br(this,t,n,!1,i)},pt.prototype.copy=function(t,n,i,a){if(i||(i=0),!a&&a!==0&&(a=this.length),n>=t.length&&(n=t.length),n||(n=0),a>0&&a<i&&(a=i),a===i||t.length===0||this.length===0)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),t.length-n<a-i&&(a=t.length-n+i);var o=a-i,s;if(this===t&&i<n&&n<a)for(s=o-1;s>=0;--s)t[s+n]=this[s+i];else if(o<1e3||!pt.TYPED_ARRAY_SUPPORT)for(s=0;s<o;++s)t[s+n]=this[s+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),n);return o},pt.prototype.fill=function(t,n,i,a){if(typeof t=="string"){if(typeof n=="string"?(a=n,n=0,i=this.length):typeof i=="string"&&(a=i,i=this.length),t.length===1){var o=t.charCodeAt(0);o<256&&(t=o)}if(a!==void 0&&typeof a!="string")throw new TypeError("encoding must be a string");if(typeof a=="string"&&!pt.isEncoding(a))throw new TypeError("Unknown encoding: "+a)}else typeof t=="number"&&(t=t&255);if(n<0||this.length<n||this.length<i)throw new RangeError("Out of range index");if(i<=n)return this;n=n>>>0,i=i===void 0?this.length:i>>>0,t||(t=0);var s;if(typeof t=="number")for(s=n;s<i;++s)this[s]=t;else{var d=Ne(t)?t:$i(new pt(t,a).toString()),h=d.length;for(s=0;s<i-n;++s)this[s+n]=d[s%h]}return this};var Xd=/[^+\/0-9A-Za-z-_]/g;function tu(e){if(e=eu(e).replace(Xd,""),e.length<2)return"";for(;e.length%4!==0;)e=e+"=";return e}function eu(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function nu(e){return e<16?"0"+e.toString(16):e.toString(16)}function $i(e,t){t=t||1/0;for(var n,i=e.length,a=null,o=[],s=0;s<i;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}else if(s+1===i){(t-=3)>-1&&o.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),a=n;continue}n=(a-55296<<10|n-56320)+65536}else a&&(t-=3)>-1&&o.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,n&63|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,n&63|128)}else if(n<1114112){if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw new Error("Invalid code point")}return o}function iu(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n)&255);return t}function au(e,t){for(var n,i,a,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),i=n>>8,a=n%256,o.push(a),o.push(i);return o}function xr(e){return Pd(tu(e))}function Zi(e,t,n,i){for(var a=0;a<i&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function ou(e){return e!==e}function ru(e){return e!=null&&(!!e._isBuffer||Tr(e)||su(e))}function Tr(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function su(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&Tr(e.slice(0,0))}var Oa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ra(e){var t=e.default;if(typeof t=="function"){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var a=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(n,i,a.get?a:{enumerable:!0,get:function(){return e[i]}})}),n}var Dn={},ui={};Object.defineProperty(ui,"__esModule",{value:!0});const cu=typeof globalThis<"u"?globalThis:typeof Oa<"u"?Oa:{};ui.BigIntPolyfill=typeof BigInt<"u"?BigInt:cu.BigInt||Number;var Ua={};Object.defineProperty(Ua,"__esModule",{value:!0});const lu=ui;let Ji=DataView;Ji.prototype.setBigUint64||(Ji.prototype.setBigUint64=function(e,t,n){let i,a;if(t<2**32)i=Number(t),a=0;else{for(var o=t.toString(2),s="",d=0;d<64-o.length;d++)s+="0";s+=o,a=parseInt(s.substring(0,32),2),i=parseInt(s.substring(32),2)}this.setUint32(e+(n?0:4),i,n),this.setUint32(e+(n?4:0),a,n)},Ji.prototype.getBigUint64=function(e,t){let n=this.getUint32(e+(t?0:4),t),i=this.getUint32(e+(t?4:0),t);for(var a=n.toString(2),o=i.toString(2),s="",d=0;d<32-a.length;d++)s+="0";return s+=a,lu.BigIntPolyfill("0b"+o+s)}),Ua.DataViewPolyfill=Ji,typeof document>"u"&&Object.assign(globalThis,{document:{currentScript:{src:self.location.href}}});var du=Object.freeze({__proto__:null,default:pt}),uu=Ra(du),Pr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ui;e.WASI_ESUCCESS=0,e.WASI_E2BIG=1,e.WASI_EACCES=2,e.WASI_EADDRINUSE=3,e.WASI_EADDRNOTAVAIL=4,e.WASI_EAFNOSUPPORT=5,e.WASI_EAGAIN=6,e.WASI_EALREADY=7,e.WASI_EBADF=8,e.WASI_EBADMSG=9,e.WASI_EBUSY=10,e.WASI_ECANCELED=11,e.WASI_ECHILD=12,e.WASI_ECONNABORTED=13,e.WASI_ECONNREFUSED=14,e.WASI_ECONNRESET=15,e.WASI_EDEADLK=16,e.WASI_EDESTADDRREQ=17,e.WASI_EDOM=18,e.WASI_EDQUOT=19,e.WASI_EEXIST=20,e.WASI_EFAULT=21,e.WASI_EFBIG=22,e.WASI_EHOSTUNREACH=23,e.WASI_EIDRM=24,e.WASI_EILSEQ=25,e.WASI_EINPROGRESS=26,e.WASI_EINTR=27,e.WASI_EINVAL=28,e.WASI_EIO=29,e.WASI_EISCONN=30,e.WASI_EISDIR=31,e.WASI_ELOOP=32,e.WASI_EMFILE=33,e.WASI_EMLINK=34,e.WASI_EMSGSIZE=35,e.WASI_EMULTIHOP=36,e.WASI_ENAMETOOLONG=37,e.WASI_ENETDOWN=38,e.WASI_ENETRESET=39,e.WASI_ENETUNREACH=40,e.WASI_ENFILE=41,e.WASI_ENOBUFS=42,e.WASI_ENODEV=43,e.WASI_ENOENT=44,e.WASI_ENOEXEC=45,e.WASI_ENOLCK=46,e.WASI_ENOLINK=47,e.WASI_ENOMEM=48,e.WASI_ENOMSG=49,e.WASI_ENOPROTOOPT=50,e.WASI_ENOSPC=51,e.WASI_ENOSYS=52,e.WASI_ENOTCONN=53,e.WASI_ENOTDIR=54,e.WASI_ENOTEMPTY=55,e.WASI_ENOTRECOVERABLE=56,e.WASI_ENOTSOCK=57,e.WASI_ENOTSUP=58,e.WASI_ENOTTY=59,e.WASI_ENXIO=60,e.WASI_EOVERFLOW=61,e.WASI_EOWNERDEAD=62,e.WASI_EPERM=63,e.WASI_EPIPE=64,e.WASI_EPROTO=65,e.WASI_EPROTONOSUPPORT=66,e.WASI_EPROTOTYPE=67,e.WASI_ERANGE=68,e.WASI_EROFS=69,e.WASI_ESPIPE=70,e.WASI_ESRCH=71,e.WASI_ESTALE=72,e.WASI_ETIMEDOUT=73,e.WASI_ETXTBSY=74,e.WASI_EXDEV=75,e.WASI_ENOTCAPABLE=76,e.WASI_SIGABRT=0,e.WASI_SIGALRM=1,e.WASI_SIGBUS=2,e.WASI_SIGCHLD=3,e.WASI_SIGCONT=4,e.WASI_SIGFPE=5,e.WASI_SIGHUP=6,e.WASI_SIGILL=7,e.WASI_SIGINT=8,e.WASI_SIGKILL=9,e.WASI_SIGPIPE=10,e.WASI_SIGQUIT=11,e.WASI_SIGSEGV=12,e.WASI_SIGSTOP=13,e.WASI_SIGTERM=14,e.WASI_SIGTRAP=15,e.WASI_SIGTSTP=16,e.WASI_SIGTTIN=17,e.WASI_SIGTTOU=18,e.WASI_SIGURG=19,e.WASI_SIGUSR1=20,e.WASI_SIGUSR2=21,e.WASI_SIGVTALRM=22,e.WASI_SIGXCPU=23,e.WASI_SIGXFSZ=24,e.WASI_FILETYPE_UNKNOWN=0,e.WASI_FILETYPE_BLOCK_DEVICE=1,e.WASI_FILETYPE_CHARACTER_DEVICE=2,e.WASI_FILETYPE_DIRECTORY=3,e.WASI_FILETYPE_REGULAR_FILE=4,e.WASI_FILETYPE_SOCKET_DGRAM=5,e.WASI_FILETYPE_SOCKET_STREAM=6,e.WASI_FILETYPE_SYMBOLIC_LINK=7,e.WASI_FDFLAG_APPEND=1,e.WASI_FDFLAG_DSYNC=2,e.WASI_FDFLAG_NONBLOCK=4,e.WASI_FDFLAG_RSYNC=8,e.WASI_FDFLAG_SYNC=16,e.WASI_RIGHT_FD_DATASYNC=t.BigIntPolyfill(1),e.WASI_RIGHT_FD_READ=t.BigIntPolyfill(2),e.WASI_RIGHT_FD_SEEK=t.BigIntPolyfill(4),e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS=t.BigIntPolyfill(8),e.WASI_RIGHT_FD_SYNC=t.BigIntPolyfill(16),e.WASI_RIGHT_FD_TELL=t.BigIntPolyfill(32),e.WASI_RIGHT_FD_WRITE=t.BigIntPolyfill(64),e.WASI_RIGHT_FD_ADVISE=t.BigIntPolyfill(128),e.WASI_RIGHT_FD_ALLOCATE=t.BigIntPolyfill(256),e.WASI_RIGHT_PATH_CREATE_DIRECTORY=t.BigIntPolyfill(512),e.WASI_RIGHT_PATH_CREATE_FILE=t.BigIntPolyfill(1024),e.WASI_RIGHT_PATH_LINK_SOURCE=t.BigIntPolyfill(2048),e.WASI_RIGHT_PATH_LINK_TARGET=t.BigIntPolyfill(4096),e.WASI_RIGHT_PATH_OPEN=t.BigIntPolyfill(8192),e.WASI_RIGHT_FD_READDIR=t.BigIntPolyfill(16384),e.WASI_RIGHT_PATH_READLINK=t.BigIntPolyfill(32768),e.WASI_RIGHT_PATH_RENAME_SOURCE=t.BigIntPolyfill(65536),e.WASI_RIGHT_PATH_RENAME_TARGET=t.BigIntPolyfill(131072),e.WASI_RIGHT_PATH_FILESTAT_GET=t.BigIntPolyfill(262144),e.WASI_RIGHT_PATH_FILESTAT_SET_SIZE=t.BigIntPolyfill(524288),e.WASI_RIGHT_PATH_FILESTAT_SET_TIMES=t.BigIntPolyfill(1048576),e.WASI_RIGHT_FD_FILESTAT_GET=t.BigIntPolyfill(2097152),e.WASI_RIGHT_FD_FILESTAT_SET_SIZE=t.BigIntPolyfill(4194304),e.WASI_RIGHT_FD_FILESTAT_SET_TIMES=t.BigIntPolyfill(8388608),e.WASI_RIGHT_PATH_SYMLINK=t.BigIntPolyfill(16777216),e.WASI_RIGHT_PATH_REMOVE_DIRECTORY=t.BigIntPolyfill(33554432),e.WASI_RIGHT_PATH_UNLINK_FILE=t.BigIntPolyfill(67108864),e.WASI_RIGHT_POLL_FD_READWRITE=t.BigIntPolyfill(134217728),e.WASI_RIGHT_SOCK_SHUTDOWN=t.BigIntPolyfill(268435456),e.RIGHTS_ALL=e.WASI_RIGHT_FD_DATASYNC|e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_SEEK|e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|e.WASI_RIGHT_FD_SYNC|e.WASI_RIGHT_FD_TELL|e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_ADVISE|e.WASI_RIGHT_FD_ALLOCATE|e.WASI_RIGHT_PATH_CREATE_DIRECTORY|e.WASI_RIGHT_PATH_CREATE_FILE|e.WASI_RIGHT_PATH_LINK_SOURCE|e.WASI_RIGHT_PATH_LINK_TARGET|e.WASI_RIGHT_PATH_OPEN|e.WASI_RIGHT_FD_READDIR|e.WASI_RIGHT_PATH_READLINK|e.WASI_RIGHT_PATH_RENAME_SOURCE|e.WASI_RIGHT_PATH_RENAME_TARGET|e.WASI_RIGHT_PATH_FILESTAT_GET|e.WASI_RIGHT_PATH_FILESTAT_SET_SIZE|e.WASI_RIGHT_PATH_FILESTAT_SET_TIMES|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_FD_FILESTAT_SET_TIMES|e.WASI_RIGHT_FD_FILESTAT_SET_SIZE|e.WASI_RIGHT_PATH_SYMLINK|e.WASI_RIGHT_PATH_UNLINK_FILE|e.WASI_RIGHT_PATH_REMOVE_DIRECTORY|e.WASI_RIGHT_POLL_FD_READWRITE|e.WASI_RIGHT_SOCK_SHUTDOWN,e.RIGHTS_BLOCK_DEVICE_BASE=e.RIGHTS_ALL,e.RIGHTS_BLOCK_DEVICE_INHERITING=e.RIGHTS_ALL,e.RIGHTS_CHARACTER_DEVICE_BASE=e.RIGHTS_ALL,e.RIGHTS_CHARACTER_DEVICE_INHERITING=e.RIGHTS_ALL,e.RIGHTS_REGULAR_FILE_BASE=e.WASI_RIGHT_FD_DATASYNC|e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_SEEK|e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|e.WASI_RIGHT_FD_SYNC|e.WASI_RIGHT_FD_TELL|e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_ADVISE|e.WASI_RIGHT_FD_ALLOCATE|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_FD_FILESTAT_SET_SIZE|e.WASI_RIGHT_FD_FILESTAT_SET_TIMES|e.WASI_RIGHT_POLL_FD_READWRITE,e.RIGHTS_REGULAR_FILE_INHERITING=t.BigIntPolyfill(0),e.RIGHTS_DIRECTORY_BASE=e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|e.WASI_RIGHT_FD_SYNC|e.WASI_RIGHT_FD_ADVISE|e.WASI_RIGHT_PATH_CREATE_DIRECTORY|e.WASI_RIGHT_PATH_CREATE_FILE|e.WASI_RIGHT_PATH_LINK_SOURCE|e.WASI_RIGHT_PATH_LINK_TARGET|e.WASI_RIGHT_PATH_OPEN|e.WASI_RIGHT_FD_READDIR|e.WASI_RIGHT_PATH_READLINK|e.WASI_RIGHT_PATH_RENAME_SOURCE|e.WASI_RIGHT_PATH_RENAME_TARGET|e.WASI_RIGHT_PATH_FILESTAT_GET|e.WASI_RIGHT_PATH_FILESTAT_SET_SIZE|e.WASI_RIGHT_PATH_FILESTAT_SET_TIMES|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_FD_FILESTAT_SET_TIMES|e.WASI_RIGHT_PATH_SYMLINK|e.WASI_RIGHT_PATH_UNLINK_FILE|e.WASI_RIGHT_PATH_REMOVE_DIRECTORY|e.WASI_RIGHT_POLL_FD_READWRITE,e.RIGHTS_DIRECTORY_INHERITING=e.RIGHTS_DIRECTORY_BASE|e.RIGHTS_REGULAR_FILE_BASE,e.RIGHTS_SOCKET_BASE=e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_POLL_FD_READWRITE|e.WASI_RIGHT_SOCK_SHUTDOWN,e.RIGHTS_SOCKET_INHERITING=e.RIGHTS_ALL,e.RIGHTS_TTY_BASE=e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_POLL_FD_READWRITE,e.RIGHTS_TTY_INHERITING=t.BigIntPolyfill(0),e.WASI_CLOCK_REALTIME=0,e.WASI_CLOCK_MONOTONIC=1,e.WASI_CLOCK_PROCESS_CPUTIME_ID=2,e.WASI_CLOCK_THREAD_CPUTIME_ID=3,e.WASI_EVENTTYPE_CLOCK=0,e.WASI_EVENTTYPE_FD_READ=1,e.WASI_EVENTTYPE_FD_WRITE=2,e.WASI_FILESTAT_SET_ATIM=1<<0,e.WASI_FILESTAT_SET_ATIM_NOW=1<<1,e.WASI_FILESTAT_SET_MTIM=1<<2,e.WASI_FILESTAT_SET_MTIM_NOW=1<<3,e.WASI_O_CREAT=1<<0,e.WASI_O_DIRECTORY=1<<1,e.WASI_O_EXCL=1<<2,e.WASI_O_TRUNC=1<<3,e.WASI_PREOPENTYPE_DIR=0,e.WASI_DIRCOOKIE_START=0,e.WASI_STDIN_FILENO=0,e.WASI_STDOUT_FILENO=1,e.WASI_STDERR_FILENO=2,e.WASI_WHENCE_SET=0,e.WASI_WHENCE_CUR=1,e.WASI_WHENCE_END=2,e.ERROR_MAP={E2BIG:e.WASI_E2BIG,EACCES:e.WASI_EACCES,EADDRINUSE:e.WASI_EADDRINUSE,EADDRNOTAVAIL:e.WASI_EADDRNOTAVAIL,EAFNOSUPPORT:e.WASI_EAFNOSUPPORT,EALREADY:e.WASI_EALREADY,EAGAIN:e.WASI_EAGAIN,EBADF:e.WASI_EBADF,EBADMSG:e.WASI_EBADMSG,EBUSY:e.WASI_EBUSY,ECANCELED:e.WASI_ECANCELED,ECHILD:e.WASI_ECHILD,ECONNABORTED:e.WASI_ECONNABORTED,ECONNREFUSED:e.WASI_ECONNREFUSED,ECONNRESET:e.WASI_ECONNRESET,EDEADLOCK:e.WASI_EDEADLK,EDESTADDRREQ:e.WASI_EDESTADDRREQ,EDOM:e.WASI_EDOM,EDQUOT:e.WASI_EDQUOT,EEXIST:e.WASI_EEXIST,EFAULT:e.WASI_EFAULT,EFBIG:e.WASI_EFBIG,EHOSTDOWN:e.WASI_EHOSTUNREACH,EHOSTUNREACH:e.WASI_EHOSTUNREACH,EIDRM:e.WASI_EIDRM,EILSEQ:e.WASI_EILSEQ,EINPROGRESS:e.WASI_EINPROGRESS,EINTR:e.WASI_EINTR,EINVAL:e.WASI_EINVAL,EIO:e.WASI_EIO,EISCONN:e.WASI_EISCONN,EISDIR:e.WASI_EISDIR,ELOOP:e.WASI_ELOOP,EMFILE:e.WASI_EMFILE,EMLINK:e.WASI_EMLINK,EMSGSIZE:e.WASI_EMSGSIZE,EMULTIHOP:e.WASI_EMULTIHOP,ENAMETOOLONG:e.WASI_ENAMETOOLONG,ENETDOWN:e.WASI_ENETDOWN,ENETRESET:e.WASI_ENETRESET,ENETUNREACH:e.WASI_ENETUNREACH,ENFILE:e.WASI_ENFILE,ENOBUFS:e.WASI_ENOBUFS,ENODEV:e.WASI_ENODEV,ENOENT:e.WASI_ENOENT,ENOEXEC:e.WASI_ENOEXEC,ENOLCK:e.WASI_ENOLCK,ENOLINK:e.WASI_ENOLINK,ENOMEM:e.WASI_ENOMEM,ENOMSG:e.WASI_ENOMSG,ENOPROTOOPT:e.WASI_ENOPROTOOPT,ENOSPC:e.WASI_ENOSPC,ENOSYS:e.WASI_ENOSYS,ENOTCONN:e.WASI_ENOTCONN,ENOTDIR:e.WASI_ENOTDIR,ENOTEMPTY:e.WASI_ENOTEMPTY,ENOTRECOVERABLE:e.WASI_ENOTRECOVERABLE,ENOTSOCK:e.WASI_ENOTSOCK,ENOTTY:e.WASI_ENOTTY,ENXIO:e.WASI_ENXIO,EOVERFLOW:e.WASI_EOVERFLOW,EOWNERDEAD:e.WASI_EOWNERDEAD,EPERM:e.WASI_EPERM,EPIPE:e.WASI_EPIPE,EPROTO:e.WASI_EPROTO,EPROTONOSUPPORT:e.WASI_EPROTONOSUPPORT,EPROTOTYPE:e.WASI_EPROTOTYPE,ERANGE:e.WASI_ERANGE,EROFS:e.WASI_EROFS,ESPIPE:e.WASI_ESPIPE,ESRCH:e.WASI_ESRCH,ESTALE:e.WASI_ESTALE,ETIMEDOUT:e.WASI_ETIMEDOUT,ETXTBSY:e.WASI_ETXTBSY,EXDEV:e.WASI_EXDEV},e.SIGNAL_MAP={[e.WASI_SIGHUP]:"SIGHUP",[e.WASI_SIGINT]:"SIGINT",[e.WASI_SIGQUIT]:"SIGQUIT",[e.WASI_SIGILL]:"SIGILL",[e.WASI_SIGTRAP]:"SIGTRAP",[e.WASI_SIGABRT]:"SIGABRT",[e.WASI_SIGBUS]:"SIGBUS",[e.WASI_SIGFPE]:"SIGFPE",[e.WASI_SIGKILL]:"SIGKILL",[e.WASI_SIGUSR1]:"SIGUSR1",[e.WASI_SIGSEGV]:"SIGSEGV",[e.WASI_SIGUSR2]:"SIGUSR2",[e.WASI_SIGPIPE]:"SIGPIPE",[e.WASI_SIGALRM]:"SIGALRM",[e.WASI_SIGTERM]:"SIGTERM",[e.WASI_SIGCHLD]:"SIGCHLD",[e.WASI_SIGCONT]:"SIGCONT",[e.WASI_SIGSTOP]:"SIGSTOP",[e.WASI_SIGTSTP]:"SIGTSTP",[e.WASI_SIGTTIN]:"SIGTTIN",[e.WASI_SIGTTOU]:"SIGTTOU",[e.WASI_SIGURG]:"SIGURG",[e.WASI_SIGXCPU]:"SIGXCPU",[e.WASI_SIGXFSZ]:"SIGXFSZ",[e.WASI_SIGVTALRM]:"SIGVTALRM"}})(Pr),Object.defineProperty(Dn,"__esModule",{value:!0});const Ot=ui,fu=Ua,te=uu;let Or;const H=Pr,_u=H.WASI_RIGHT_FD_DATASYNC|H.WASI_RIGHT_FD_READ|H.WASI_RIGHT_FD_SYNC|H.WASI_RIGHT_FD_ADVISE|H.WASI_RIGHT_FD_FILESTAT_GET|H.WASI_RIGHT_POLL_FD_READWRITE,Rr=H.WASI_RIGHT_FD_DATASYNC|H.WASI_RIGHT_FD_WRITE|H.WASI_RIGHT_FD_SYNC|H.WASI_RIGHT_FD_ADVISE|H.WASI_RIGHT_FD_FILESTAT_GET|H.WASI_RIGHT_POLL_FD_READWRITE,hu=Rr,En=e=>{const t=Math.trunc(e),n=Ot.BigIntPolyfill(Math.round((e-t)*1e6));return Ot.BigIntPolyfill(t)*Ot.BigIntPolyfill(1e6)+n},Nn=e=>{typeof e=="number"&&(e=Math.trunc(e));const t=Ot.BigIntPolyfill(e);return Number(t/Ot.BigIntPolyfill(1e6))},jt=e=>(...t)=>{try{return e(...t)}catch(n){if(n&&n.code&&typeof n.code=="string")return H.ERROR_MAP[n.code]||H.WASI_EINVAL;if(n instanceof kn)return n.errno;throw n}},Ur=(e,t)=>{const n=e.FD_MAP.get(t);if(!n)throw new kn(H.WASI_EBADF);if(n.filetype===void 0){const i=e.bindings.fs.fstatSync(n.real),{filetype:a,rightsBase:o,rightsInheriting:s}=Gr(e,t,i);n.filetype=a,n.rights||(n.rights={base:o,inheriting:s})}return n},Gr=(e,t,n)=>{switch(!0){case n.isBlockDevice():return{filetype:H.WASI_FILETYPE_BLOCK_DEVICE,rightsBase:H.RIGHTS_BLOCK_DEVICE_BASE,rightsInheriting:H.RIGHTS_BLOCK_DEVICE_INHERITING};case n.isCharacterDevice():{const i=H.WASI_FILETYPE_CHARACTER_DEVICE;return t!==void 0&&e.bindings.isTTY(t)?{filetype:i,rightsBase:H.RIGHTS_TTY_BASE,rightsInheriting:H.RIGHTS_TTY_INHERITING}:{filetype:i,rightsBase:H.RIGHTS_CHARACTER_DEVICE_BASE,rightsInheriting:H.RIGHTS_CHARACTER_DEVICE_INHERITING}}case n.isDirectory():return{filetype:H.WASI_FILETYPE_DIRECTORY,rightsBase:H.RIGHTS_DIRECTORY_BASE,rightsInheriting:H.RIGHTS_DIRECTORY_INHERITING};case n.isFIFO():return{filetype:H.WASI_FILETYPE_SOCKET_STREAM,rightsBase:H.RIGHTS_SOCKET_BASE,rightsInheriting:H.RIGHTS_SOCKET_INHERITING};case n.isFile():return{filetype:H.WASI_FILETYPE_REGULAR_FILE,rightsBase:H.RIGHTS_REGULAR_FILE_BASE,rightsInheriting:H.RIGHTS_REGULAR_FILE_INHERITING};case n.isSocket():return{filetype:H.WASI_FILETYPE_SOCKET_STREAM,rightsBase:H.RIGHTS_SOCKET_BASE,rightsInheriting:H.RIGHTS_SOCKET_INHERITING};case n.isSymbolicLink():return{filetype:H.WASI_FILETYPE_SYMBOLIC_LINK,rightsBase:Ot.BigIntPolyfill(0),rightsInheriting:Ot.BigIntPolyfill(0)};default:return{filetype:H.WASI_FILETYPE_UNKNOWN,rightsBase:Ot.BigIntPolyfill(0),rightsInheriting:Ot.BigIntPolyfill(0)}}};class kn extends Error{constructor(t){super(),this.errno=t,Object.setPrototypeOf(this,kn.prototype)}}Dn.WASIError=kn;class Ga extends Error{constructor(t){super(`WASI Exit error: ${t}`),this.code=t,Object.setPrototypeOf(this,Ga.prototype)}}var gu=Dn.WASIExitError=Ga;class Ma extends Error{constructor(t){super(`WASI Kill signal: ${t}`),this.signal=t,Object.setPrototypeOf(this,Ma.prototype)}}var pu=Dn.WASIKillError=Ma;class Da{constructor(t){let n={};t&&t.preopens?n=t.preopens:t&&t.preopenDirectories&&(n=t.preopenDirectories);let i={};t&&t.env&&(i=t.env);let a=[];t&&t.args&&(a=t.args);let o=Or;t&&t.bindings&&(o=t.bindings),this.memory=void 0,this.view=void 0,this.bindings=o,this.FD_MAP=new Map([[H.WASI_STDIN_FILENO,{real:0,filetype:H.WASI_FILETYPE_CHARACTER_DEVICE,rights:{base:_u,inheriting:Ot.BigIntPolyfill(0)},path:void 0}],[H.WASI_STDOUT_FILENO,{real:1,filetype:H.WASI_FILETYPE_CHARACTER_DEVICE,rights:{base:Rr,inheriting:Ot.BigIntPolyfill(0)},path:void 0}],[H.WASI_STDERR_FILENO,{real:2,filetype:H.WASI_FILETYPE_CHARACTER_DEVICE,rights:{base:hu,inheriting:Ot.BigIntPolyfill(0)},path:void 0}]]);let s=this.bindings.fs,d=this.bindings.path;for(const[I,g]of Object.entries(n)){const B=s.openSync(g,s.constants.O_RDONLY),P=[...this.FD_MAP.keys()].reverse()[0]+1;this.FD_MAP.set(P,{real:B,filetype:H.WASI_FILETYPE_DIRECTORY,rights:{base:H.RIGHTS_DIRECTORY_BASE,inheriting:H.RIGHTS_DIRECTORY_INHERITING},fakePath:I,path:g})}const h=(I,g)=>(this.refreshMemory(),Array.from({length:g},(P,C)=>{const N=I+C*8,T=this.view.getUint32(N,!0),K=this.view.getUint32(N+4,!0);return new Uint8Array(this.memory.buffer,T,K)})),f=(I,g)=>{const B=Ur(this,I);if(g!==Ot.BigIntPolyfill(0)&&(B.rights.base&g)===Ot.BigIntPolyfill(0))throw new kn(H.WASI_EPERM);return B},l=o.hrtime(),m=I=>{switch(I){case H.WASI_CLOCK_MONOTONIC:return o.hrtime();case H.WASI_CLOCK_REALTIME:return En(Date.now());case H.WASI_CLOCK_PROCESS_CPUTIME_ID:case H.WASI_CLOCK_THREAD_CPUTIME_ID:return o.hrtime()-l;default:return null}};this.wasiImport={args_get:(I,g)=>{this.refreshMemory();let B=I,P=g;return a.forEach(C=>{this.view.setUint32(B,P,!0),B+=4,P+=te.default.from(this.memory.buffer).write(`${C}\0`,P)}),H.WASI_ESUCCESS},args_sizes_get:(I,g)=>{this.refreshMemory(),this.view.setUint32(I,a.length,!0);const B=a.reduce((P,C)=>P+te.default.byteLength(C)+1,0);return this.view.setUint32(g,B,!0),H.WASI_ESUCCESS},environ_get:(I,g)=>{this.refreshMemory();let B=I,P=g;return Object.entries(i).forEach(([C,N])=>{this.view.setUint32(B,P,!0),B+=4,P+=te.default.from(this.memory.buffer).write(`${C}=${N}\0`,P)}),H.WASI_ESUCCESS},environ_sizes_get:(I,g)=>{this.refreshMemory();const B=Object.entries(i).map(([C,N])=>`${C}=${N}\0`),P=B.reduce((C,N)=>C+te.default.byteLength(N),0);return this.view.setUint32(I,B.length,!0),this.view.setUint32(g,P,!0),H.WASI_ESUCCESS},clock_res_get:(I,g)=>{let B;switch(I){case H.WASI_CLOCK_MONOTONIC:case H.WASI_CLOCK_PROCESS_CPUTIME_ID:case H.WASI_CLOCK_THREAD_CPUTIME_ID:{B=Ot.BigIntPolyfill(1);break}case H.WASI_CLOCK_REALTIME:{B=Ot.BigIntPolyfill(1e3);break}}return this.view.setBigUint64(g,B),H.WASI_ESUCCESS},clock_time_get:(I,g,B)=>{this.refreshMemory();const P=m(I);return P===null?H.WASI_EINVAL:(this.view.setBigUint64(B,Ot.BigIntPolyfill(P),!0),H.WASI_ESUCCESS)},fd_advise:jt((I,g,B,P)=>(f(I,H.WASI_RIGHT_FD_ADVISE),H.WASI_ENOSYS)),fd_allocate:jt((I,g,B)=>(f(I,H.WASI_RIGHT_FD_ALLOCATE),H.WASI_ENOSYS)),fd_close:jt(I=>{const g=f(I,Ot.BigIntPolyfill(0));return s.closeSync(g.real),this.FD_MAP.delete(I),H.WASI_ESUCCESS}),fd_datasync:jt(I=>{const g=f(I,H.WASI_RIGHT_FD_DATASYNC);return s.fdatasyncSync(g.real),H.WASI_ESUCCESS}),fd_fdstat_get:jt((I,g)=>{const B=f(I,Ot.BigIntPolyfill(0));return this.refreshMemory(),this.view.setUint8(g,B.filetype),this.view.setUint16(g+2,0,!0),this.view.setUint16(g+4,0,!0),this.view.setBigUint64(g+8,Ot.BigIntPolyfill(B.rights.base),!0),this.view.setBigUint64(g+8+8,Ot.BigIntPolyfill(B.rights.inheriting),!0),H.WASI_ESUCCESS}),fd_fdstat_set_flags:jt((I,g)=>(f(I,H.WASI_RIGHT_FD_FDSTAT_SET_FLAGS),H.WASI_ENOSYS)),fd_fdstat_set_rights:jt((I,g,B)=>{const P=f(I,Ot.BigIntPolyfill(0));return(P.rights.base|g)>P.rights.base||(P.rights.inheriting|B)>P.rights.inheriting?H.WASI_EPERM:(P.rights.base=g,P.rights.inheriting=B,H.WASI_ESUCCESS)}),fd_filestat_get:jt((I,g)=>{const B=f(I,H.WASI_RIGHT_FD_FILESTAT_GET),P=s.fstatSync(B.real);return this.refreshMemory(),this.view.setBigUint64(g,Ot.BigIntPolyfill(P.dev),!0),g+=8,this.view.setBigUint64(g,Ot.BigIntPolyfill(P.ino),!0),g+=8,this.view.setUint8(g,B.filetype),g+=8,this.view.setBigUint64(g,Ot.BigIntPolyfill(P.nlink),!0),g+=8,this.view.setBigUint64(g,Ot.BigIntPolyfill(P.size),!0),g+=8,this.view.setBigUint64(g,En(P.atimeMs),!0),g+=8,this.view.setBigUint64(g,En(P.mtimeMs),!0),g+=8,this.view.setBigUint64(g,En(P.ctimeMs),!0),H.WASI_ESUCCESS}),fd_filestat_set_size:jt((I,g)=>{const B=f(I,H.WASI_RIGHT_FD_FILESTAT_SET_SIZE);return s.ftruncateSync(B.real,Number(g)),H.WASI_ESUCCESS}),fd_filestat_set_times:jt((I,g,B,P)=>{const C=f(I,H.WASI_RIGHT_FD_FILESTAT_SET_TIMES),N=s.fstatSync(C.real);let T=N.atime,K=N.mtime;const M=Nn(m(H.WASI_CLOCK_REALTIME)),V=H.WASI_FILESTAT_SET_ATIM|H.WASI_FILESTAT_SET_ATIM_NOW;if((P&V)===V)return H.WASI_EINVAL;const v=H.WASI_FILESTAT_SET_MTIM|H.WASI_FILESTAT_SET_MTIM_NOW;return(P&v)===v?H.WASI_EINVAL:((P&H.WASI_FILESTAT_SET_ATIM)===H.WASI_FILESTAT_SET_ATIM?T=Nn(g):(P&H.WASI_FILESTAT_SET_ATIM_NOW)===H.WASI_FILESTAT_SET_ATIM_NOW&&(T=M),(P&H.WASI_FILESTAT_SET_MTIM)===H.WASI_FILESTAT_SET_MTIM?K=Nn(B):(P&H.WASI_FILESTAT_SET_MTIM_NOW)===H.WASI_FILESTAT_SET_MTIM_NOW&&(K=M),s.futimesSync(C.real,new Date(T),new Date(K)),H.WASI_ESUCCESS)}),fd_prestat_get:jt((I,g)=>{const B=f(I,Ot.BigIntPolyfill(0));return B.path?(this.refreshMemory(),this.view.setUint8(g,H.WASI_PREOPENTYPE_DIR),this.view.setUint32(g+4,te.default.byteLength(B.fakePath),!0),H.WASI_ESUCCESS):H.WASI_EINVAL}),fd_prestat_dir_name:jt((I,g,B)=>{const P=f(I,Ot.BigIntPolyfill(0));return P.path?(this.refreshMemory(),te.default.from(this.memory.buffer).write(P.fakePath,g,B,"utf8"),H.WASI_ESUCCESS):H.WASI_EINVAL}),fd_pwrite:jt((I,g,B,P,C)=>{const N=f(I,H.WASI_RIGHT_FD_WRITE|H.WASI_RIGHT_FD_SEEK);let T=0;return h(g,B).forEach(K=>{let M=0;for(;M<K.byteLength;)M+=s.writeSync(N.real,K,M,K.byteLength-M,Number(P)+T+M);T+=M}),this.view.setUint32(C,T,!0),H.WASI_ESUCCESS}),fd_write:jt((I,g,B,P)=>{const C=f(I,H.WASI_RIGHT_FD_WRITE);let N=0;return h(g,B).forEach(T=>{let K=0;for(;K<T.byteLength;){const M=s.writeSync(C.real,T,K,T.byteLength-K,C.offset!==void 0?Number(C.offset):null);C.offset!==void 0&&(C.offset+=Ot.BigIntPolyfill(M)),K+=M}N+=K}),this.view.setUint32(P,N,!0),H.WASI_ESUCCESS}),fd_pread:jt((I,g,B,P,C)=>{const N=f(I,H.WASI_RIGHT_FD_READ|H.WASI_RIGHT_FD_SEEK);let T=0;t:for(const K of h(g,B)){let M=0;for(;M<K.byteLength;){const V=K.byteLength-M,v=s.readSync(N.real,K,M,K.byteLength-M,Number(P)+T+M);if(M+=v,T+=v,v===0||v<V)break t}T+=M}return this.view.setUint32(C,T,!0),H.WASI_ESUCCESS}),fd_read:jt((I,g,B,P)=>{const C=f(I,H.WASI_RIGHT_FD_READ),N=C.real===0;let T=0;t:for(const K of h(g,B)){let M=0;for(;M<K.byteLength;){let V=K.byteLength-M,v=N||C.offset===void 0?null:Number(C.offset),p=s.readSync(C.real,K,M,V,v);if(N||(C.offset=(C.offset?C.offset:Ot.BigIntPolyfill(0))+Ot.BigIntPolyfill(p)),M+=p,T+=p,p===0||p<V)break t}}return this.view.setUint32(P,T,!0),H.WASI_ESUCCESS}),fd_readdir:jt((I,g,B,P,C)=>{const N=f(I,H.WASI_RIGHT_FD_READDIR);this.refreshMemory();const T=s.readdirSync(N.path,{withFileTypes:!0}),K=g;for(let V=Number(P);V<T.length;V+=1){const v=T[V];let p=te.default.byteLength(v.name);if(g-K>B||(this.view.setBigUint64(g,Ot.BigIntPolyfill(V+1),!0),g+=8,g-K>B))break;const L=s.statSync(d.resolve(N.path,v.name));if(this.view.setBigUint64(g,Ot.BigIntPolyfill(L.ino),!0),g+=8,g-K>B||(this.view.setUint32(g,p,!0),g+=4,g-K>B))break;let U;switch(!0){case L.isBlockDevice():U=H.WASI_FILETYPE_BLOCK_DEVICE;break;case L.isCharacterDevice():U=H.WASI_FILETYPE_CHARACTER_DEVICE;break;case L.isDirectory():U=H.WASI_FILETYPE_DIRECTORY;break;case L.isFIFO():U=H.WASI_FILETYPE_SOCKET_STREAM;break;case L.isFile():U=H.WASI_FILETYPE_REGULAR_FILE;break;case L.isSocket():U=H.WASI_FILETYPE_SOCKET_STREAM;break;case L.isSymbolicLink():U=H.WASI_FILETYPE_SYMBOLIC_LINK;break;default:U=H.WASI_FILETYPE_UNKNOWN;break}if(this.view.setUint8(g,U),g+=1,g+=3,g+p>=K+B)break;te.default.from(this.memory.buffer).write(v.name,g),g+=p}const M=g-K;return this.view.setUint32(C,Math.min(M,B),!0),H.WASI_ESUCCESS}),fd_renumber:jt((I,g)=>(f(I,Ot.BigIntPolyfill(0)),f(g,Ot.BigIntPolyfill(0)),s.closeSync(this.FD_MAP.get(I).real),this.FD_MAP.set(I,this.FD_MAP.get(g)),this.FD_MAP.delete(g),H.WASI_ESUCCESS)),fd_seek:jt((I,g,B,P)=>{const C=f(I,H.WASI_RIGHT_FD_SEEK);switch(this.refreshMemory(),B){case H.WASI_WHENCE_CUR:C.offset=(C.offset?C.offset:Ot.BigIntPolyfill(0))+Ot.BigIntPolyfill(g);break;case H.WASI_WHENCE_END:const{size:N}=s.fstatSync(C.real);C.offset=Ot.BigIntPolyfill(N)+Ot.BigIntPolyfill(g);break;case H.WASI_WHENCE_SET:C.offset=Ot.BigIntPolyfill(g);break}return this.view.setBigUint64(P,C.offset,!0),H.WASI_ESUCCESS}),fd_tell:jt((I,g)=>{const B=f(I,H.WASI_RIGHT_FD_TELL);return this.refreshMemory(),B.offset||(B.offset=Ot.BigIntPolyfill(0)),this.view.setBigUint64(g,B.offset,!0),H.WASI_ESUCCESS}),fd_sync:jt(I=>{const g=f(I,H.WASI_RIGHT_FD_SYNC);return s.fsyncSync(g.real),H.WASI_ESUCCESS}),path_create_directory:jt((I,g,B)=>{const P=f(I,H.WASI_RIGHT_PATH_CREATE_DIRECTORY);if(!P.path)return H.WASI_EINVAL;this.refreshMemory();const C=te.default.from(this.memory.buffer,g,B).toString();return s.mkdirSync(d.resolve(P.path,C)),H.WASI_ESUCCESS}),path_filestat_get:jt((I,g,B,P,C)=>{const N=f(I,H.WASI_RIGHT_PATH_FILESTAT_GET);if(!N.path)return H.WASI_EINVAL;this.refreshMemory();const T=te.default.from(this.memory.buffer,B,P).toString(),K=s.statSync(d.resolve(N.path,T));return this.view.setBigUint64(C,Ot.BigIntPolyfill(K.dev),!0),C+=8,this.view.setBigUint64(C,Ot.BigIntPolyfill(K.ino),!0),C+=8,this.view.setUint8(C,Gr(this,void 0,K).filetype),C+=8,this.view.setBigUint64(C,Ot.BigIntPolyfill(K.nlink),!0),C+=8,this.view.setBigUint64(C,Ot.BigIntPolyfill(K.size),!0),C+=8,this.view.setBigUint64(C,En(K.atimeMs),!0),C+=8,this.view.setBigUint64(C,En(K.mtimeMs),!0),C+=8,this.view.setBigUint64(C,En(K.ctimeMs),!0),H.WASI_ESUCCESS}),path_filestat_set_times:jt((I,g,B,P,C,N,T)=>{const K=f(I,H.WASI_RIGHT_PATH_FILESTAT_SET_TIMES);if(!K.path)return H.WASI_EINVAL;this.refreshMemory();const M=s.fstatSync(K.real);let V=M.atime,v=M.mtime;const p=Nn(m(H.WASI_CLOCK_REALTIME)),L=H.WASI_FILESTAT_SET_ATIM|H.WASI_FILESTAT_SET_ATIM_NOW;if((T&L)===L)return H.WASI_EINVAL;const U=H.WASI_FILESTAT_SET_MTIM|H.WASI_FILESTAT_SET_MTIM_NOW;if((T&U)===U)return H.WASI_EINVAL;(T&H.WASI_FILESTAT_SET_ATIM)===H.WASI_FILESTAT_SET_ATIM?V=Nn(C):(T&H.WASI_FILESTAT_SET_ATIM_NOW)===H.WASI_FILESTAT_SET_ATIM_NOW&&(V=p),(T&H.WASI_FILESTAT_SET_MTIM)===H.WASI_FILESTAT_SET_MTIM?v=Nn(N):(T&H.WASI_FILESTAT_SET_MTIM_NOW)===H.WASI_FILESTAT_SET_MTIM_NOW&&(v=p);const q=te.default.from(this.memory.buffer,B,P).toString();return s.utimesSync(d.resolve(K.path,q),new Date(V),new Date(v)),H.WASI_ESUCCESS}),path_link:jt((I,g,B,P,C,N,T)=>{const K=f(I,H.WASI_RIGHT_PATH_LINK_SOURCE),M=f(C,H.WASI_RIGHT_PATH_LINK_TARGET);if(!K.path||!M.path)return H.WASI_EINVAL;this.refreshMemory();const V=te.default.from(this.memory.buffer,B,P).toString(),v=te.default.from(this.memory.buffer,N,T).toString();return s.linkSync(d.resolve(K.path,V),d.resolve(M.path,v)),H.WASI_ESUCCESS}),path_open:jt((I,g,B,P,C,N,T,K,M)=>{const V=f(I,H.WASI_RIGHT_PATH_OPEN);N=Ot.BigIntPolyfill(N),T=Ot.BigIntPolyfill(T);const v=(N&(H.WASI_RIGHT_FD_READ|H.WASI_RIGHT_FD_READDIR))!==Ot.BigIntPolyfill(0),p=(N&(H.WASI_RIGHT_FD_DATASYNC|H.WASI_RIGHT_FD_WRITE|H.WASI_RIGHT_FD_ALLOCATE|H.WASI_RIGHT_FD_FILESTAT_SET_SIZE))!==Ot.BigIntPolyfill(0);let L;p&&v?L=s.constants.O_RDWR:v?L=s.constants.O_RDONLY:p&&(L=s.constants.O_WRONLY);let U=N|H.WASI_RIGHT_PATH_OPEN,q=N|T;(C&H.WASI_O_CREAT)!==0&&(L|=s.constants.O_CREAT,U|=H.WASI_RIGHT_PATH_CREATE_FILE),(C&H.WASI_O_DIRECTORY)!==0&&(L|=s.constants.O_DIRECTORY),(C&H.WASI_O_EXCL)!==0&&(L|=s.constants.O_EXCL),(C&H.WASI_O_TRUNC)!==0&&(L|=s.constants.O_TRUNC,U|=H.WASI_RIGHT_PATH_FILESTAT_SET_SIZE),(K&H.WASI_FDFLAG_APPEND)!==0&&(L|=s.constants.O_APPEND),(K&H.WASI_FDFLAG_DSYNC)!==0&&(s.constants.O_DSYNC?L|=s.constants.O_DSYNC:L|=s.constants.O_SYNC,q|=H.WASI_RIGHT_FD_DATASYNC),(K&H.WASI_FDFLAG_NONBLOCK)!==0&&(L|=s.constants.O_NONBLOCK),(K&H.WASI_FDFLAG_RSYNC)!==0&&(s.constants.O_RSYNC?L|=s.constants.O_RSYNC:L|=s.constants.O_SYNC,q|=H.WASI_RIGHT_FD_SYNC),(K&H.WASI_FDFLAG_SYNC)!==0&&(L|=s.constants.O_SYNC,q|=H.WASI_RIGHT_FD_SYNC),p&&(L&(s.constants.O_APPEND|s.constants.O_TRUNC))===0&&(q|=H.WASI_RIGHT_FD_SEEK),this.refreshMemory();const O=te.default.from(this.memory.buffer,B,P).toString(),R=d.resolve(V.path,O);if(d.relative(V.path,R).startsWith(".."))return H.WASI_ENOTCAPABLE;let b;try{if(b=s.realpathSync(R),d.relative(V.path,b).startsWith(".."))return H.WASI_ENOTCAPABLE}catch(tt){if(tt.code==="ENOENT")b=R;else throw tt}let D;try{D=s.statSync(b).isDirectory()}catch{}let j;!p&&D?j=s.openSync(b,s.constants.O_RDONLY):j=s.openSync(b,L);const J=[...this.FD_MAP.keys()].reverse()[0]+1;return this.FD_MAP.set(J,{real:j,filetype:void 0,offset:BigInt(0),rights:{base:U,inheriting:q},path:b}),Ur(this,J),this.view.setUint32(M,J,!0),H.WASI_ESUCCESS}),path_readlink:jt((I,g,B,P,C,N)=>{const T=f(I,H.WASI_RIGHT_PATH_READLINK);if(!T.path)return H.WASI_EINVAL;this.refreshMemory();const K=te.default.from(this.memory.buffer,g,B).toString(),M=d.resolve(T.path,K),V=s.readlinkSync(M),v=te.default.from(this.memory.buffer).write(V,P,C);return this.view.setUint32(N,v,!0),H.WASI_ESUCCESS}),path_remove_directory:jt((I,g,B)=>{const P=f(I,H.WASI_RIGHT_PATH_REMOVE_DIRECTORY);if(!P.path)return H.WASI_EINVAL;this.refreshMemory();const C=te.default.from(this.memory.buffer,g,B).toString();return s.rmdirSync(d.resolve(P.path,C)),H.WASI_ESUCCESS}),path_rename:jt((I,g,B,P,C,N)=>{const T=f(I,H.WASI_RIGHT_PATH_RENAME_SOURCE),K=f(P,H.WASI_RIGHT_PATH_RENAME_TARGET);if(!T.path||!K.path)return H.WASI_EINVAL;this.refreshMemory();const M=te.default.from(this.memory.buffer,g,B).toString(),V=te.default.from(this.memory.buffer,C,N).toString();return s.renameSync(d.resolve(T.path,M),d.resolve(K.path,V)),H.WASI_ESUCCESS}),path_symlink:jt((I,g,B,P,C)=>{const N=f(B,H.WASI_RIGHT_PATH_SYMLINK);if(!N.path)return H.WASI_EINVAL;this.refreshMemory();const T=te.default.from(this.memory.buffer,I,g).toString(),K=te.default.from(this.memory.buffer,P,C).toString();return s.symlinkSync(T,d.resolve(N.path,K)),H.WASI_ESUCCESS}),path_unlink_file:jt((I,g,B)=>{const P=f(I,H.WASI_RIGHT_PATH_UNLINK_FILE);if(!P.path)return H.WASI_EINVAL;this.refreshMemory();const C=te.default.from(this.memory.buffer,g,B).toString();return s.unlinkSync(d.resolve(P.path,C)),H.WASI_ESUCCESS}),poll_oneoff:(I,g,B,P)=>{let C=0,N=0;this.refreshMemory();for(let T=0;T<B;T+=1){const K=this.view.getBigUint64(I,!0);I+=8;const M=this.view.getUint8(I);switch(I+=1,M){case H.WASI_EVENTTYPE_CLOCK:{I+=7,this.view.getBigUint64(I,!0),I+=8;const V=this.view.getUint32(I,!0);I+=4,I+=4;const v=this.view.getBigUint64(I,!0);I+=8,this.view.getBigUint64(I,!0),I+=8;const p=this.view.getUint16(I,!0);I+=2,I+=6;const L=p===1;let U=H.WASI_ESUCCESS;const q=Ot.BigIntPolyfill(m(V));if(q===null)U=H.WASI_EINVAL;else{const O=L?v:q+v;N=O>N?O:N}this.view.setBigUint64(g,K,!0),g+=8,this.view.setUint16(g,U,!0),g+=2,this.view.setUint8(g,H.WASI_EVENTTYPE_CLOCK),g+=1,g+=5,C+=1;break}case H.WASI_EVENTTYPE_FD_READ:case H.WASI_EVENTTYPE_FD_WRITE:{I+=3,this.view.getUint32(I,!0),I+=4,this.view.setBigUint64(g,K,!0),g+=8,this.view.setUint16(g,H.WASI_ENOSYS,!0),g+=2,this.view.setUint8(g,M),g+=1,g+=5,C+=1;break}default:return H.WASI_EINVAL}}for(this.view.setUint32(P,C,!0);o.hrtime()<N;);return H.WASI_ESUCCESS},proc_exit:I=>(o.exit(I),H.WASI_ESUCCESS),proc_raise:I=>I in H.SIGNAL_MAP?(o.kill(H.SIGNAL_MAP[I]),H.WASI_ESUCCESS):H.WASI_EINVAL,random_get:(I,g)=>(this.refreshMemory(),o.randomFillSync(new Uint8Array(this.memory.buffer),I,g),H.WASI_ESUCCESS),sched_yield(){return H.WASI_ESUCCESS},sock_recv(){return H.WASI_ENOSYS},sock_send(){return H.WASI_ENOSYS},sock_shutdown(){return H.WASI_ENOSYS}},t.traceSyscalls&&Object.keys(this.wasiImport).forEach(I=>{const g=this.wasiImport[I];this.wasiImport[I]=function(...B){console.log(`WASI: wasiImport called: ${I} (${B})`);try{let P=g(...B);return console.log(`WASI:  => ${P}`),P}catch(P){throw console.log(`Catched error: ${P}`),P}}})}refreshMemory(){(!this.view||this.view.buffer.byteLength===0)&&(this.view=new fu.DataViewPolyfill(this.memory.buffer))}setMemory(t){this.memory=t}start(t){const n=t.exports;if(n===null||typeof n!="object")throw new Error(`instance.exports must be an Object. Received ${n}.`);const{memory:i}=n;if(!(i instanceof WebAssembly.Memory))throw new Error(`instance.exports.memory must be a WebAssembly.Memory. Recceived ${i}.`);this.setMemory(i),n._start&&n._start()}getImportNamespace(t){let n=null;for(let i of WebAssembly.Module.imports(t))if(i.kind==="function"&&!!i.module.startsWith("wasi_")){if(!n)n=i.module;else if(n!==i.module)throw new Error("Multiple namespaces detected.")}return n}getImports(t){switch(this.getImportNamespace(t)){case"wasi_unstable":return{wasi_unstable:this.wasiImport};case"wasi_snapshot_preview1":return{wasi_snapshot_preview1:this.wasiImport};default:throw new Error("Can't detect a WASI namespace for the WebAssembly Module")}}}Dn.default=Da,Da.defaultBindings=Or;var Mr=Dn.WASI=Da;function ke(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function Dr(e,t){for(var n="",i=0,a=-1,o=0,s,d=0;d<=e.length;++d){if(d<e.length)s=e.charCodeAt(d);else{if(s===47)break;s=47}if(s===47){if(!(a===d-1||o===1))if(a!==d-1&&o===2){if(n.length<2||i!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var h=n.lastIndexOf("/");if(h!==n.length-1){h===-1?(n="",i=0):(n=n.slice(0,h),i=n.length-1-n.lastIndexOf("/")),a=d,o=0;continue}}else if(n.length===2||n.length===1){n="",i=0,a=d,o=0;continue}}t&&(n.length>0?n+="/..":n="..",i=2)}else n.length>0?n+="/"+e.slice(a+1,d):n=e.slice(a+1,d),i=d-a-1;a=d,o=0}else s===46&&o!==-1?++o:o=-1}return n}function mu(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+e+i:i}var zn={resolve:function(){for(var t="",n=!1,i,a=arguments.length-1;a>=-1&&!n;a--){var o;a>=0?o=arguments[a]:(i===void 0&&(i=process.cwd()),o=i),ke(o),o.length!==0&&(t=o+"/"+t,n=o.charCodeAt(0)===47)}return t=Dr(t,!n),n?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(t){if(ke(t),t.length===0)return".";var n=t.charCodeAt(0)===47,i=t.charCodeAt(t.length-1)===47;return t=Dr(t,!n),t.length===0&&!n&&(t="."),t.length>0&&i&&(t+="/"),n?"/"+t:t},isAbsolute:function(t){return ke(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,n=0;n<arguments.length;++n){var i=arguments[n];ke(i),i.length>0&&(t===void 0?t=i:t+="/"+i)}return t===void 0?".":zn.normalize(t)},relative:function(t,n){if(ke(t),ke(n),t===n||(t=zn.resolve(t),n=zn.resolve(n),t===n))return"";for(var i=1;i<t.length&&t.charCodeAt(i)===47;++i);for(var a=t.length,o=a-i,s=1;s<n.length&&n.charCodeAt(s)===47;++s);for(var d=n.length,h=d-s,f=o<h?o:h,l=-1,m=0;m<=f;++m){if(m===f){if(h>f){if(n.charCodeAt(s+m)===47)return n.slice(s+m+1);if(m===0)return n.slice(s+m)}else o>f&&(t.charCodeAt(i+m)===47?l=m:m===0&&(l=0));break}var I=t.charCodeAt(i+m),g=n.charCodeAt(s+m);if(I!==g)break;I===47&&(l=m)}var B="";for(m=i+l+1;m<=a;++m)(m===a||t.charCodeAt(m)===47)&&(B.length===0?B+="..":B+="/..");return B.length>0?B+n.slice(s+l):(s+=l,n.charCodeAt(s)===47&&++s,n.slice(s))},_makeLong:function(t){return t},dirname:function(t){if(ke(t),t.length===0)return".";for(var n=t.charCodeAt(0),i=n===47,a=-1,o=!0,s=t.length-1;s>=1;--s)if(n=t.charCodeAt(s),n===47){if(!o){a=s;break}}else o=!1;return a===-1?i?"/":".":i&&a===1?"//":t.slice(0,a)},basename:function(t,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');ke(t);var i=0,a=-1,o=!0,s;if(n!==void 0&&n.length>0&&n.length<=t.length){if(n.length===t.length&&n===t)return"";var d=n.length-1,h=-1;for(s=t.length-1;s>=0;--s){var f=t.charCodeAt(s);if(f===47){if(!o){i=s+1;break}}else h===-1&&(o=!1,h=s+1),d>=0&&(f===n.charCodeAt(d)?--d===-1&&(a=s):(d=-1,a=h))}return i===a?a=h:a===-1&&(a=t.length),t.slice(i,a)}else{for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!o){i=s+1;break}}else a===-1&&(o=!1,a=s+1);return a===-1?"":t.slice(i,a)}},extname:function(t){ke(t);for(var n=-1,i=0,a=-1,o=!0,s=0,d=t.length-1;d>=0;--d){var h=t.charCodeAt(d);if(h===47){if(!o){i=d+1;break}continue}a===-1&&(o=!1,a=d+1),h===46?n===-1?n=d:s!==1&&(s=1):n!==-1&&(s=-1)}return n===-1||a===-1||s===0||s===1&&n===a-1&&n===i+1?"":t.slice(n,a)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return mu("/",t)},parse:function(t){ke(t);var n={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return n;var i=t.charCodeAt(0),a=i===47,o;a?(n.root="/",o=1):o=0;for(var s=-1,d=0,h=-1,f=!0,l=t.length-1,m=0;l>=o;--l){if(i=t.charCodeAt(l),i===47){if(!f){d=l+1;break}continue}h===-1&&(f=!1,h=l+1),i===46?s===-1?s=l:m!==1&&(m=1):s!==-1&&(m=-1)}return s===-1||h===-1||m===0||m===1&&s===h-1&&s===d+1?h!==-1&&(d===0&&a?n.base=n.name=t.slice(1,h):n.base=n.name=t.slice(d,h)):(d===0&&a?(n.name=t.slice(1,s),n.base=t.slice(1,h)):(n.name=t.slice(d,s),n.base=t.slice(d,h)),n.ext=t.slice(s,h)),d>0?n.dir=t.slice(0,d-1):a&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};zn.posix=zn;var Na=zn,Lu=Cd({__proto__:null,default:Na},[Na]);function Au(e,t,n,i){return new(n||(n=Promise))(function(a,o){function s(f){try{h(i.next(f))}catch(l){o(l)}}function d(f){try{h(i.throw(f))}catch(l){o(l)}}function h(f){f.done?a(f.value):new n(function(l){l(f.value)}).then(s,d)}h((i=i.apply(e,t||[])).next())})}function yu(e,t){function n(f){return function(l){return i([f,l])}}function i(f){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,s&&(d=f[0]&2?s.return:f[0]?s.throw||((d=s.return)&&d.call(s),0):s.next)&&!(d=d.call(s,f[1])).done)return d;switch(s=0,d&&(f=[f[0]&2,d.value]),f[0]){case 0:case 1:d=f;break;case 4:return a.label++,{value:f[1],done:!1};case 5:a.label++,s=f[1],f=[0];continue;case 7:f=a.ops.pop(),a.trys.pop();continue;default:if(d=a.trys,!(d=0<d.length&&d[d.length-1])&&(f[0]===6||f[0]===2)){a=0;continue}if(f[0]===3&&(!d||f[1]>d[0]&&f[1]<d[3]))a.label=f[1];else if(f[0]===6&&a.label<d[1])a.label=d[1],d=f;else if(d&&a.label<d[2])a.label=d[2],a.ops.push(f);else{d[2]&&a.ops.pop(),a.trys.pop();continue}}f=t.call(e,a)}catch(l){f=[6,l],s=0}finally{o=d=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}var a={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},o,s,d,h;return h={next:n(0),throw:n(1),return:n(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h}function ka(e){var t=typeof Symbol=="function"&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function wu(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;e=n.call(e);var i,a=[];try{for(;(t===void 0||0<t--)&&!(i=e.next()).done;)a.push(i.value)}catch(s){var o={error:s}}finally{try{i&&!i.done&&(n=e.return)&&n.call(e)}finally{if(o)throw o.error}}return a}function Iu(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(wu(arguments[t]));return e}var ae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Le(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function _e(e,t){return t={exports:{}},e(t,t.exports),t.exports}var zt=_e(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.constants={O_RDONLY:0,O_WRONLY:1,O_RDWR:2,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,UV_FS_COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_EXCL:1,COPYFILE_FICLONE:2,COPYFILE_FICLONE_FORCE:4}});Le(zt);var Eu=_e(function(e,t){t.default=typeof BigInt=="function"?BigInt:function(){throw Error("BigInt is not supported in this environment.")}}),qn=_e(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=zt.constants.S_IFMT,i=zt.constants.S_IFDIR,a=zt.constants.S_IFREG,o=zt.constants.S_IFBLK,s=zt.constants.S_IFCHR,d=zt.constants.S_IFLNK,h=zt.constants.S_IFIFO,f=zt.constants.S_IFSOCK;e=function(){function l(){}return l.build=function(m,I){I===void 0&&(I=!1);var g=new l,B=m.gid,P=m.atime,C=m.mtime,N=m.ctime;return I=I?Eu.default:function(T){return T},g.uid=I(m.uid),g.gid=I(B),g.rdev=I(0),g.blksize=I(4096),g.ino=I(m.ino),g.size=I(m.getSize()),g.blocks=I(1),g.atime=P,g.mtime=C,g.ctime=N,g.birthtime=N,g.atimeMs=I(P.getTime()),g.mtimeMs=I(C.getTime()),B=I(N.getTime()),g.ctimeMs=B,g.birthtimeMs=B,g.dev=I(0),g.mode=I(m.mode),g.nlink=I(m.nlink),g},l.prototype._checkModeProperty=function(m){return(Number(this.mode)&n)===m},l.prototype.isDirectory=function(){return this._checkModeProperty(i)},l.prototype.isFile=function(){return this._checkModeProperty(a)},l.prototype.isBlockDevice=function(){return this._checkModeProperty(o)},l.prototype.isCharacterDevice=function(){return this._checkModeProperty(s)},l.prototype.isSymbolicLink=function(){return this._checkModeProperty(d)},l.prototype.isFIFO=function(){return this._checkModeProperty(h)},l.prototype.isSocket=function(){return this._checkModeProperty(f)},l}(),t.Stats=e,t.default=e});Le(qn);var bn=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},ze=[],Re=[],bu=typeof Uint8Array<"u"?Uint8Array:Array,za=!1;function Nr(){za=!0;for(var e=0;64>e;++e)ze[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e],Re["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;Re[45]=62,Re[95]=63}function Cu(e,t,n){for(var i=[],a=t;a<n;a+=3)t=(e[a]<<16)+(e[a+1]<<8)+e[a+2],i.push(ze[t>>18&63]+ze[t>>12&63]+ze[t>>6&63]+ze[t&63]);return i.join("")}function kr(e){za||Nr();for(var t=e.length,n=t%3,i="",a=[],o=0,s=t-n;o<s;o+=16383)a.push(Cu(e,o,o+16383>s?s:o+16383));return n===1?(e=e[t-1],i+=ze[e>>2],i+=ze[e<<4&63],i+="=="):n===2&&(e=(e[t-2]<<8)+e[t-1],i+=ze[e>>10],i+=ze[e>>4&63],i+=ze[e<<2&63],i+="="),a.push(i),a.join("")}function Xi(e,t,n,i,a){var o=8*a-i-1,s=(1<<o)-1,d=s>>1,h=-7;a=n?a-1:0;var f=n?-1:1,l=e[t+a];for(a+=f,n=l&(1<<-h)-1,l>>=-h,h+=o;0<h;n=256*n+e[t+a],a+=f,h-=8);for(o=n&(1<<-h)-1,n>>=-h,h+=i;0<h;o=256*o+e[t+a],a+=f,h-=8);if(n===0)n=1-d;else{if(n===s)return o?NaN:1/0*(l?-1:1);o+=Math.pow(2,i),n-=d}return(l?-1:1)*o*Math.pow(2,n-i)}function ta(e,t,n,i,a,o){var s,d=8*o-a-1,h=(1<<d)-1,f=h>>1,l=a===23?Math.pow(2,-24)-Math.pow(2,-77):0;o=i?0:o-1;var m=i?1:-1,I=0>t||t===0&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(t=isNaN(t)?1:0,i=h):(i=Math.floor(Math.log(t)/Math.LN2),1>t*(s=Math.pow(2,-i))&&(i--,s*=2),t=1<=i+f?t+l/s:t+l*Math.pow(2,1-f),2<=t*s&&(i++,s/=2),i+f>=h?(t=0,i=h):1<=i+f?(t=(t*s-1)*Math.pow(2,a),i+=f):(t=t*Math.pow(2,f-1)*Math.pow(2,a),i=0));8<=a;e[n+o]=t&255,o+=m,t/=256,a-=8);for(i=i<<a|t,d+=a;0<d;e[n+o]=i&255,o+=m,i/=256,d-=8);e[n+o-m]|=128*I}var Su={}.toString,zr=Array.isArray||function(e){return Su.call(e)=="[object Array]"};lt.TYPED_ARRAY_SUPPORT=bn.TYPED_ARRAY_SUPPORT!==void 0?bn.TYPED_ARRAY_SUPPORT:!0;var Fu=lt.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function Je(e,t){if((lt.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<t)throw new RangeError("Invalid typed array length");return lt.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=lt.prototype):(e===null&&(e=new lt(t)),e.length=t),e}function lt(e,t,n){if(!(lt.TYPED_ARRAY_SUPPORT||this instanceof lt))return new lt(e,t,n);if(typeof e=="number"){if(typeof t=="string")throw Error("If encoding is specified then the first argument must be a string");return qa(this,e)}return qr(this,e,t,n)}lt.poolSize=8192,lt._augment=function(e){return e.__proto__=lt.prototype,e};function qr(e,t,n,i){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer){if(t.byteLength,0>n||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=n===void 0&&i===void 0?new Uint8Array(t):i===void 0?new Uint8Array(t,n):new Uint8Array(t,n,i),lt.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=lt.prototype):e=Qa(e,t),e}if(typeof t=="string"){if(i=e,e=n,(typeof e!="string"||e==="")&&(e="utf8"),!lt.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');return n=Hr(t,e)|0,i=Je(i,n),t=i.write(t,e),t!==n&&(i=i.slice(0,t)),i}return vu(e,t)}lt.from=function(e,t,n){return qr(null,e,t,n)},lt.TYPED_ARRAY_SUPPORT&&(lt.prototype.__proto__=Uint8Array.prototype,lt.__proto__=Uint8Array);function Qr(e){if(typeof e!="number")throw new TypeError('"size" argument must be a number');if(0>e)throw new RangeError('"size" argument must not be negative')}lt.alloc=function(e,t,n){return Qr(e),e=0>=e?Je(null,e):t!==void 0?typeof n=="string"?Je(null,e).fill(t,n):Je(null,e).fill(t):Je(null,e),e};function qa(e,t){if(Qr(t),e=Je(e,0>t?0:Ha(t)|0),!lt.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}lt.allocUnsafe=function(e){return qa(null,e)},lt.allocUnsafeSlow=function(e){return qa(null,e)};function Qa(e,t){var n=0>t.length?0:Ha(t.length)|0;e=Je(e,n);for(var i=0;i<n;i+=1)e[i]=t[i]&255;return e}function vu(e,t){if(qe(t)){var n=Ha(t.length)|0;return e=Je(e,n),e.length===0||t.copy(e,0,0,n),e}if(t){if(typeof ArrayBuffer<"u"&&t.buffer instanceof ArrayBuffer||"length"in t)return(n=typeof t.length!="number")||(n=t.length,n=n!==n),n?Je(e,0):Qa(e,t);if(t.type==="Buffer"&&zr(t.data))return Qa(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Ha(e){if(e>=(lt.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(lt.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return e|0}lt.isBuffer=Xe;function qe(e){return!(e==null||!e._isBuffer)}lt.compare=function(e,t){if(!qe(e)||!qe(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,a=0,o=Math.min(n,i);a<o;++a)if(e[a]!==t[a]){n=e[a],i=t[a];break}return n<i?-1:i<n?1:0},lt.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},lt.concat=function(e,t){if(!zr(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return lt.alloc(0);var n;if(t===void 0)for(n=t=0;n<e.length;++n)t+=e[n].length;t=lt.allocUnsafe(t);var i=0;for(n=0;n<e.length;++n){var a=e[n];if(!qe(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(t,i),i+=a.length}return t};function Hr(e,t){if(qe(e))return e.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;typeof e!="string"&&(e=""+e);var n=e.length;if(n===0)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return aa(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $r(e).length;default:if(i)return aa(e).length;t=(""+t).toLowerCase(),i=!0}}lt.byteLength=Hr;function Bu(e,t,n){var i=!1;if((t===void 0||0>t)&&(t=0),t>this.length||((n===void 0||n>this.length)&&(n=this.length),0>=n)||(n>>>=0,t>>>=0,n<=t))return"";for(e||(e="utf8");;)switch(e){case"hex":for(e=t,t=n,n=this.length,(!e||0>e)&&(e=0),(!t||0>t||t>n)&&(t=n),i="",n=e;n<t;++n)e=i,i=this[n],i=16>i?"0"+i.toString(16):i.toString(16),i=e+i;return i;case"utf8":case"utf-8":return Vr(this,t,n);case"ascii":for(e="",n=Math.min(this.length,n);t<n;++t)e+=String.fromCharCode(this[t]&127);return e;case"latin1":case"binary":for(e="",n=Math.min(this.length,n);t<n;++t)e+=String.fromCharCode(this[t]);return e;case"base64":return t=t===0&&n===this.length?kr(this):kr(this.slice(t,n)),t;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(t=this.slice(t,n),n="",e=0;e<t.length;e+=2)n+=String.fromCharCode(t[e]+256*t[e+1]);return n;default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}lt.prototype._isBuffer=!0;function Cn(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}lt.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Cn(this,t,t+1);return this},lt.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Cn(this,t,t+3),Cn(this,t+1,t+2);return this},lt.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Cn(this,t,t+7),Cn(this,t+1,t+6),Cn(this,t+2,t+5),Cn(this,t+3,t+4);return this},lt.prototype.toString=function(){var e=this.length|0;return e===0?"":arguments.length===0?Vr(this,0,e):Bu.apply(this,arguments)},lt.prototype.equals=function(e){if(!qe(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:lt.compare(this,e)===0},lt.prototype.inspect=function(){var e="";return 0<this.length&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(e+=" ... ")),"<Buffer "+e+">"},lt.prototype.compare=function(e,t,n,i,a){if(!qe(e))throw new TypeError("Argument must be a Buffer");if(t===void 0&&(t=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),a===void 0&&(a=this.length),0>t||n>e.length||0>i||a>this.length)throw new RangeError("out of range index");if(i>=a&&t>=n)return 0;if(i>=a)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,a>>>=0,this===e)return 0;var o=a-i,s=n-t,d=Math.min(o,s);for(i=this.slice(i,a),e=e.slice(t,n),t=0;t<d;++t)if(i[t]!==e[t]){o=i[t],s=e[t];break}return o<s?-1:s<o?1:0};function Wr(e,t,n,i,a){if(e.length===0)return-1;if(typeof n=="string"?(i=n,n=0):2147483647<n?n=2147483647:-2147483648>n&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),0>n&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(0>n)if(a)n=0;else return-1;if(typeof t=="string"&&(t=lt.from(t,i)),qe(t))return t.length===0?-1:Kr(e,t,n,i,a);if(typeof t=="number")return t&=255,lt.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):Kr(e,[t],n,i,a);throw new TypeError("val must be string, number or Buffer")}function Kr(e,t,n,i,a){function o(f,l){return s===1?f[l]:f.readUInt16BE(l*s)}var s=1,d=e.length,h=t.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(2>e.length||2>t.length)return-1;s=2,d/=2,h/=2,n/=2}if(a)for(i=-1;n<d;n++)if(o(e,n)===o(t,i===-1?0:n-i)){if(i===-1&&(i=n),n-i+1===h)return i*s}else i!==-1&&(n-=n-i),i=-1;else for(n+h>d&&(n=d-h);0<=n;n--){for(d=!0,i=0;i<h;i++)if(o(e,n+i)!==o(t,i)){d=!1;break}if(d)return n}return-1}lt.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1},lt.prototype.indexOf=function(e,t,n){return Wr(this,e,t,n,!0)},lt.prototype.lastIndexOf=function(e,t,n){return Wr(this,e,t,n,!1)},lt.prototype.write=function(e,t,n,i){if(t===void 0)i="utf8",n=this.length,t=0;else if(n===void 0&&typeof t=="string")i=t,n=this.length,t=0;else if(isFinite(t))t|=0,isFinite(n)?(n|=0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var a=this.length-t;if((n===void 0||n>a)&&(n=a),0<e.length&&(0>n||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");for(i||(i="utf8"),a=!1;;)switch(i){case"hex":t:{if(t=Number(t)||0,i=this.length-t,n?(n=Number(n),n>i&&(n=i)):n=i,i=e.length,i%2!==0)throw new TypeError("Invalid hex string");for(n>i/2&&(n=i/2),i=0;i<n;++i){if(a=parseInt(e.substr(2*i,2),16),isNaN(a)){e=i;break t}this[t+i]=a}e=i}return e;case"utf8":case"utf-8":return fi(aa(e,this.length-t),this,t,n);case"ascii":return fi(Yr(e),this,t,n);case"latin1":case"binary":return fi(Yr(e),this,t,n);case"base64":return fi($r(e),this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=e,a=this.length-t;for(var o=[],s=0;s<i.length&&!(0>(a-=2));++s){var d=i.charCodeAt(s);e=d>>8,d%=256,o.push(d),o.push(e)}return fi(o,this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},lt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Vr(e,t,n){n=Math.min(e.length,n);for(var i=[];t<n;){var a=e[t],o=null,s=239<a?4:223<a?3:191<a?2:1;if(t+s<=n)switch(s){case 1:128>a&&(o=a);break;case 2:var d=e[t+1];(d&192)===128&&(a=(a&31)<<6|d&63,127<a&&(o=a));break;case 3:d=e[t+1];var h=e[t+2];(d&192)===128&&(h&192)===128&&(a=(a&15)<<12|(d&63)<<6|h&63,2047<a&&(55296>a||57343<a)&&(o=a));break;case 4:d=e[t+1],h=e[t+2];var f=e[t+3];(d&192)===128&&(h&192)===128&&(f&192)===128&&(a=(a&15)<<18|(d&63)<<12|(h&63)<<6|f&63,65535<a&&1114112>a&&(o=a))}o===null?(o=65533,s=1):65535<o&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),t+=s}if(e=i.length,e<=jr)i=String.fromCharCode.apply(String,i);else{for(n="",t=0;t<e;)n+=String.fromCharCode.apply(String,i.slice(t,t+=jr));i=n}return i}var jr=4096;lt.prototype.slice=function(e,t){var n=this.length;if(e=~~e,t=t===void 0?n:~~t,0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),t<e&&(t=e),lt.TYPED_ARRAY_SUPPORT)t=this.subarray(e,t),t.__proto__=lt.prototype;else{n=t-e,t=new lt(n,void 0);for(var i=0;i<n;++i)t[i]=this[i+e]}return t};function de(e,t,n){if(e%1!==0||0>e)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}lt.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||de(e,t,this.length),n=this[e];for(var i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n},lt.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||de(e,t,this.length),n=this[e+--t];for(var i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},lt.prototype.readUInt8=function(e,t){return t||de(e,1,this.length),this[e]},lt.prototype.readUInt16LE=function(e,t){return t||de(e,2,this.length),this[e]|this[e+1]<<8},lt.prototype.readUInt16BE=function(e,t){return t||de(e,2,this.length),this[e]<<8|this[e+1]},lt.prototype.readUInt32LE=function(e,t){return t||de(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},lt.prototype.readUInt32BE=function(e,t){return t||de(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},lt.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||de(e,t,this.length),n=this[e];for(var i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n>=128*i&&(n-=Math.pow(2,8*t)),n},lt.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||de(e,t,this.length),n=t;for(var i=1,a=this[e+--n];0<n&&(i*=256);)a+=this[e+--n]*i;return a>=128*i&&(a-=Math.pow(2,8*t)),a},lt.prototype.readInt8=function(e,t){return t||de(e,1,this.length),this[e]&128?-1*(255-this[e]+1):this[e]},lt.prototype.readInt16LE=function(e,t){return t||de(e,2,this.length),e=this[e]|this[e+1]<<8,e&32768?e|4294901760:e},lt.prototype.readInt16BE=function(e,t){return t||de(e,2,this.length),e=this[e+1]|this[e]<<8,e&32768?e|4294901760:e},lt.prototype.readInt32LE=function(e,t){return t||de(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},lt.prototype.readInt32BE=function(e,t){return t||de(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},lt.prototype.readFloatLE=function(e,t){return t||de(e,4,this.length),Xi(this,e,!0,23,4)},lt.prototype.readFloatBE=function(e,t){return t||de(e,4,this.length),Xi(this,e,!1,23,4)},lt.prototype.readDoubleLE=function(e,t){return t||de(e,8,this.length),Xi(this,e,!0,52,8)},lt.prototype.readDoubleBE=function(e,t){return t||de(e,8,this.length),Xi(this,e,!1,52,8)};function be(e,t,n,i,a,o){if(!qe(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}lt.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||be(this,e,t,n,Math.pow(2,8*n)-1,0),i=1;var a=0;for(this[t]=e&255;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},lt.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||be(this,e,t,n,Math.pow(2,8*n)-1,0),i=n-1;var a=1;for(this[t+i]=e&255;0<=--i&&(a*=256);)this[t+i]=e/a&255;return t+n},lt.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||be(this,e,t,1,255,0),lt.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=e&255,t+1};function ea(e,t,n,i){0>t&&(t=65535+t+1);for(var a=0,o=Math.min(e.length-n,2);a<o;++a)e[n+a]=(t&255<<8*(i?a:1-a))>>>8*(i?a:1-a)}lt.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||be(this,e,t,2,65535,0),lt.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8):ea(this,e,t,!0),t+2},lt.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||be(this,e,t,2,65535,0),lt.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=e&255):ea(this,e,t,!1),t+2};function na(e,t,n,i){0>t&&(t=4294967295+t+1);for(var a=0,o=Math.min(e.length-n,4);a<o;++a)e[n+a]=t>>>8*(i?a:3-a)&255}lt.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||be(this,e,t,4,4294967295,0),lt.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255):na(this,e,t,!0),t+4},lt.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||be(this,e,t,4,4294967295,0),lt.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255):na(this,e,t,!1),t+4},lt.prototype.writeIntLE=function(e,t,n,i){e=+e,t|=0,i||(i=Math.pow(2,8*n-1),be(this,e,t,n,i-1,-i)),i=0;var a=1,o=0;for(this[t]=e&255;++i<n&&(a*=256);)0>e&&o===0&&this[t+i-1]!==0&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+n},lt.prototype.writeIntBE=function(e,t,n,i){e=+e,t|=0,i||(i=Math.pow(2,8*n-1),be(this,e,t,n,i-1,-i)),i=n-1;var a=1,o=0;for(this[t+i]=e&255;0<=--i&&(a*=256);)0>e&&o===0&&this[t+i+1]!==0&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+n},lt.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||be(this,e,t,1,127,-128),lt.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[t]=e&255,t+1},lt.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||be(this,e,t,2,32767,-32768),lt.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8):ea(this,e,t,!0),t+2},lt.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||be(this,e,t,2,32767,-32768),lt.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=e&255):ea(this,e,t,!1),t+2},lt.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||be(this,e,t,4,2147483647,-2147483648),lt.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):na(this,e,t,!0),t+4},lt.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||be(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),lt.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255):na(this,e,t,!1),t+4};function ia(e,t,n,i){if(n+i>e.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}lt.prototype.writeFloatLE=function(e,t,n){return n||ia(this,e,t,4),ta(this,e,t,!0,23,4),t+4},lt.prototype.writeFloatBE=function(e,t,n){return n||ia(this,e,t,4),ta(this,e,t,!1,23,4),t+4},lt.prototype.writeDoubleLE=function(e,t,n){return n||ia(this,e,t,8),ta(this,e,t,!0,52,8),t+8},lt.prototype.writeDoubleBE=function(e,t,n){return n||ia(this,e,t,8),ta(this,e,t,!1,52,8),t+8},lt.prototype.copy=function(e,t,n,i){if(n||(n=0),i||i===0||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),0<i&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>i)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var a=i-n;if(this===e&&n<t&&t<i)for(i=a-1;0<=i;--i)e[i+t]=this[i+n];else if(1e3>a||!lt.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},lt.prototype.fill=function(e,t,n,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),e.length===1){var a=e.charCodeAt(0);256>a&&(e=a)}if(i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!lt.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else typeof e=="number"&&(e&=255);if(0>t||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=n===void 0?this.length:n>>>0,e||(e=0),typeof e=="number")for(i=t;i<n;++i)this[i]=e;else for(e=qe(e)?e:aa(new lt(e,i).toString()),a=e.length,i=0;i<n-t;++i)this[i+t]=e[i%a];return this};var xu=/[^+\/0-9A-Za-z-_]/g;function aa(e,t){t=t||1/0;for(var n,i=e.length,a=null,o=[],s=0;s<i;++s){if(n=e.charCodeAt(s),55295<n&&57344>n){if(!a){if(56319<n){-1<(t-=3)&&o.push(239,191,189);continue}else if(s+1===i){-1<(t-=3)&&o.push(239,191,189);continue}a=n;continue}if(56320>n){-1<(t-=3)&&o.push(239,191,189),a=n;continue}n=(a-55296<<10|n-56320)+65536}else a&&-1<(t-=3)&&o.push(239,191,189);if(a=null,128>n){if(0>--t)break;o.push(n)}else if(2048>n){if(0>(t-=2))break;o.push(n>>6|192,n&63|128)}else if(65536>n){if(0>(t-=3))break;o.push(n>>12|224,n>>6&63|128,n&63|128)}else if(1114112>n){if(0>(t-=4))break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw Error("Invalid code point")}return o}function Yr(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n)&255);return t}function $r(e){if(e=(e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(xu,""),2>e.length)e="";else for(;e.length%4!==0;)e+="=";za||Nr();var t=e.length;if(0<t%4)throw Error("Invalid string. Length must be a multiple of 4");var n=e[t-2]==="="?2:e[t-1]==="="?1:0,i=new bu(3*t/4-n),a=0<n?t-4:t,o=0;for(t=0;t<a;t+=4){var s=Re[e.charCodeAt(t)]<<18|Re[e.charCodeAt(t+1)]<<12|Re[e.charCodeAt(t+2)]<<6|Re[e.charCodeAt(t+3)];i[o++]=s>>16&255,i[o++]=s>>8&255,i[o++]=s&255}return n===2?(s=Re[e.charCodeAt(t)]<<2|Re[e.charCodeAt(t+1)]>>4,i[o++]=s&255):n===1&&(s=Re[e.charCodeAt(t)]<<10|Re[e.charCodeAt(t+1)]<<4|Re[e.charCodeAt(t+2)]>>2,i[o++]=s>>8&255,i[o++]=s&255),i}function fi(e,t,n,i){for(var a=0;a<i&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function Xe(e){return e!=null&&(!!e._isBuffer||Zr(e)||typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&Zr(e.slice(0,0)))}function Zr(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}var _i=Object.freeze({__proto__:null,INSPECT_MAX_BYTES:50,kMaxLength:Fu,Buffer:lt,SlowBuffer:function(e){return+e!=e&&(e=0),lt.alloc(+e)},isBuffer:Xe}),Xt=_e(function(e,t){function n(a){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];return new(_i.Buffer.bind.apply(_i.Buffer,i([void 0,a],o)))}var i=ae&&ae.__spreadArrays||function(){for(var a=0,o=0,s=arguments.length;o<s;o++)a+=arguments[o].length;a=Array(a);var d=0;for(o=0;o<s;o++)for(var h=arguments[o],f=0,l=h.length;f<l;f++,d++)a[d]=h[f];return a};Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=_i.Buffer,t.bufferAllocUnsafe=_i.Buffer.allocUnsafe||n,t.bufferFrom=_i.Buffer.from||n});Le(Xt);function Jr(){throw Error("setTimeout has not been defined")}function Xr(){throw Error("clearTimeout has not been defined")}var ln=Jr,dn=Xr;typeof bn.setTimeout=="function"&&(ln=setTimeout),typeof bn.clearTimeout=="function"&&(dn=clearTimeout);function ts(e){if(ln===setTimeout)return setTimeout(e,0);if((ln===Jr||!ln)&&setTimeout)return ln=setTimeout,setTimeout(e,0);try{return ln(e,0)}catch{try{return ln.call(null,e,0)}catch{return ln.call(this,e,0)}}}function Tu(e){if(dn===clearTimeout)return clearTimeout(e);if((dn===Xr||!dn)&&clearTimeout)return dn=clearTimeout,clearTimeout(e);try{return dn(e)}catch{try{return dn.call(null,e)}catch{return dn.call(this,e)}}}var tn=[],Qn=!1,Sn,oa=-1;function Pu(){Qn&&Sn&&(Qn=!1,Sn.length?tn=Sn.concat(tn):oa=-1,tn.length&&es())}function es(){if(!Qn){var e=ts(Pu);Qn=!0;for(var t=tn.length;t;){for(Sn=tn,tn=[];++oa<t;)Sn&&Sn[oa].run();oa=-1,t=tn.length}Sn=null,Qn=!1,Tu(e)}}function ve(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];tn.push(new ns(e,t)),tn.length!==1||Qn||ts(es)}function ns(e,t){this.fun=e,this.array=t}ns.prototype.run=function(){this.fun.apply(null,this.array)};function Fn(){}var Hn=bn.performance||{},Ou=Hn.now||Hn.mozNow||Hn.msNow||Hn.oNow||Hn.webkitNow||function(){return new Date().getTime()},Ru=new Date,Wn={nextTick:ve,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:Fn,addListener:Fn,once:Fn,off:Fn,removeListener:Fn,removeAllListeners:Fn,emit:Fn,binding:function(){throw Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(){throw Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*Ou.call(Hn),n=Math.floor(t);return t=Math.floor(t%1*1e9),e&&(n-=e[0],t-=e[1],0>t&&(n--,t+=1e9)),[n,t]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Ru)/1e3}},un=typeof Object.create=="function"?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){function n(){}e.super_=t,n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},Uu=/%[sdj%]/g;function Wa(e){if(!vn(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(Qe(arguments[n]));return t.join(" ")}n=1;var i=arguments,a=i.length;t=String(e).replace(Uu,function(s){if(s==="%%")return"%";if(n>=a)return s;switch(s){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch{return"[Circular]"}default:return s}});for(var o=i[n];n<a;o=i[++n])t=o!==null&&fn(o)?t+(" "+Qe(o)):t+(" "+o);return t}function Ka(e,t){if(en(bn.process))return function(){return Ka(e,t).apply(this,arguments)};if(Wn.noDeprecation===!0)return e;var n=!1;return function(){if(!n){if(Wn.throwDeprecation)throw Error(t);Wn.traceDeprecation?console.trace(t):console.error(t),n=!0}return e.apply(this,arguments)}}var ra={},Va;function is(e){return en(Va)&&(Va=Wn.env.NODE_DEBUG||""),e=e.toUpperCase(),ra[e]||(new RegExp("\\b"+e+"\\b","i").test(Va)?ra[e]=function(){var t=Wa.apply(null,arguments);console.error("%s %d: %s",e,0,t)}:ra[e]=function(){}),ra[e]}function Qe(e,t){var n={seen:[],stylize:Mu};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),$a(t)?n.showHidden=t:t&&rs(n,t),en(n.showHidden)&&(n.showHidden=!1),en(n.depth)&&(n.depth=2),en(n.colors)&&(n.colors=!1),en(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Gu),sa(n,e,n.depth)}Qe.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Qe.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Gu(e,t){return(t=Qe.styles[t])?"\x1B["+Qe.colors[t][0]+"m"+e+"\x1B["+Qe.colors[t][1]+"m":e}function Mu(e){return e}function Du(e){var t={};return e.forEach(function(n){t[n]=!0}),t}function sa(e,t,n){if(e.customInspect&&t&&Vn(t.inspect)&&t.inspect!==Qe&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return vn(i)||(i=sa(e,i,n)),i}if(i=Nu(e,t))return i;var a=Object.keys(t),o=Du(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),gi(t)&&(0<=a.indexOf("message")||0<=a.indexOf("description")))return ja(t);if(a.length===0){if(Vn(t))return e.stylize("[Function"+(t.name?": "+t.name:"")+"]","special");if(Kn(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(hi(t))return e.stylize(Date.prototype.toString.call(t),"date");if(gi(t))return ja(t)}i="";var s=!1,d=["{","}"];return as(t)&&(s=!0,d=["[","]"]),Vn(t)&&(i=" [Function"+(t.name?": "+t.name:"")+"]"),Kn(t)&&(i=" "+RegExp.prototype.toString.call(t)),hi(t)&&(i=" "+Date.prototype.toUTCString.call(t)),gi(t)&&(i=" "+ja(t)),a.length===0&&(!s||t.length==0)?d[0]+i+d[1]:0>n?Kn(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),a=s?ku(e,t,n,o,a):a.map(function(h){return Ya(e,t,n,o,h,s)}),e.seen.pop(),zu(a,i,d))}function Nu(e,t){if(en(t))return e.stylize("undefined","undefined");if(vn(t))return t="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",e.stylize(t,"string");if(os(t))return e.stylize(""+t,"number");if($a(t))return e.stylize(""+t,"boolean");if(t===null)return e.stylize("null","null")}function ja(e){return"["+Error.prototype.toString.call(e)+"]"}function ku(e,t,n,i,a){for(var o=[],s=0,d=t.length;s<d;++s)Object.prototype.hasOwnProperty.call(t,String(s))?o.push(Ya(e,t,n,i,String(s),!0)):o.push("");return a.forEach(function(h){h.match(/^\d+$/)||o.push(Ya(e,t,n,i,h,!0))}),o}function Ya(e,t,n,i,a,o){var s,d;if(t=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]},t.get?d=t.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):t.set&&(d=e.stylize("[Setter]","special")),Object.prototype.hasOwnProperty.call(i,a)||(s="["+a+"]"),d||(0>e.seen.indexOf(t.value)?(d=n===null?sa(e,t.value,null):sa(e,t.value,n-1),-1<d.indexOf(`
`)&&(d=o?d.split(`
`).map(function(h){return"  "+h}).join(`
`).substr(2):`
`+d.split(`
`).map(function(h){return"   "+h}).join(`
`))):d=e.stylize("[Circular]","special")),en(s)){if(o&&a.match(/^\d+$/))return d;s=JSON.stringify(""+a),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+d}function zu(e,t,n){return 60<e.reduce(function(i,a){return a.indexOf(`
`),i+a.replace(/\u001b\[\d\d?m/g,"").length+1},0)?n[0]+(t===""?"":t+`
 `)+" "+e.join(`,
  `)+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function as(e){return Array.isArray(e)}function $a(e){return typeof e=="boolean"}function os(e){return typeof e=="number"}function vn(e){return typeof e=="string"}function en(e){return e===void 0}function Kn(e){return fn(e)&&Object.prototype.toString.call(e)==="[object RegExp]"}function fn(e){return typeof e=="object"&&e!==null}function hi(e){return fn(e)&&Object.prototype.toString.call(e)==="[object Date]"}function gi(e){return fn(e)&&(Object.prototype.toString.call(e)==="[object Error]"||e instanceof Error)}function Vn(e){return typeof e=="function"}function Za(e){return e===null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||typeof e=="symbol"||typeof e>"u"}function Ja(e){return 10>e?"0"+e.toString(10):e.toString(10)}var qu="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");function Qu(){var e=new Date,t=[Ja(e.getHours()),Ja(e.getMinutes()),Ja(e.getSeconds())].join(":");return[e.getDate(),qu[e.getMonth()],t].join(" ")}function rs(e,t){if(!t||!fn(t))return e;for(var n=Object.keys(t),i=n.length;i--;)e[n[i]]=t[n[i]];return e}var pi={inherits:un,_extend:rs,log:function(){console.log("%s - %s",Qu(),Wa.apply(null,arguments))},isBuffer:function(e){return Xe(e)},isPrimitive:Za,isFunction:Vn,isError:gi,isDate:hi,isObject:fn,isRegExp:Kn,isUndefined:en,isSymbol:function(e){return typeof e=="symbol"},isString:vn,isNumber:os,isNullOrUndefined:function(e){return e==null},isNull:function(e){return e===null},isBoolean:$a,isArray:as,inspect:Qe,deprecate:Ka,format:Wa,debuglog:is};function ss(e,t){if(e===t)return 0;for(var n=e.length,i=t.length,a=0,o=Math.min(n,i);a<o;++a)if(e[a]!==t[a]){n=e[a],i=t[a];break}return n<i?-1:i<n?1:0}var Hu=Object.prototype.hasOwnProperty,cs=Object.keys||function(e){var t=[],n;for(n in e)Hu.call(e,n)&&t.push(n);return t},ls=Array.prototype.slice,Xa;function ds(){return typeof Xa<"u"?Xa:Xa=function(){return function(){}.name==="foo"}()}function us(e){return Xe(e)||typeof bn.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e?!!(e instanceof DataView||e.buffer&&e.buffer instanceof ArrayBuffer):!1}function ee(e,t){e||Ce(e,!0,t,"==",eo)}var Wu=/\s*function\s+([^\(\s]*)\s*/;function fs(e){if(Vn(e))return ds()?e.name:(e=e.toString().match(Wu))&&e[1]}ee.AssertionError=to;function to(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=_s(hs(this.actual),128)+" "+this.operator+" "+_s(hs(this.expected),128),this.generatedMessage=!0);var t=e.stackStartFunction||Ce;Error.captureStackTrace?Error.captureStackTrace(this,t):(e=Error(),e.stack&&(e=e.stack,t=fs(t),t=e.indexOf(`
`+t),0<=t&&(t=e.indexOf(`
`,t+1),e=e.substring(t+1)),this.stack=e))}un(to,Error);function _s(e,t){return typeof e=="string"?e.length<t?e:e.slice(0,t):e}function hs(e){return ds()||!Vn(e)?Qe(e):(e=fs(e),"[Function"+(e?": "+e:"")+"]")}function Ce(e,t,n,i,a){throw new to({message:n,actual:e,expected:t,operator:i,stackStartFunction:a})}ee.fail=Ce;function eo(e,t){e||Ce(e,!0,t,"==",eo)}ee.ok=eo,ee.equal=gs;function gs(e,t,n){e!=t&&Ce(e,t,n,"==",gs)}ee.notEqual=ps;function ps(e,t,n){e==t&&Ce(e,t,n,"!=",ps)}ee.deepEqual=ms;function ms(e,t,n){jn(e,t,!1)||Ce(e,t,n,"deepEqual",ms)}ee.deepStrictEqual=Ls;function Ls(e,t,n){jn(e,t,!0)||Ce(e,t,n,"deepStrictEqual",Ls)}function jn(e,t,n,i){if(e===t)return!0;if(Xe(e)&&Xe(t))return ss(e,t)===0;if(hi(e)&&hi(t))return e.getTime()===t.getTime();if(Kn(e)&&Kn(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(e!==null&&typeof e=="object"||t!==null&&typeof t=="object"){if(!us(e)||!us(t)||Object.prototype.toString.call(e)!==Object.prototype.toString.call(t)||e instanceof Float32Array||e instanceof Float64Array){if(Xe(e)!==Xe(t))return!1;i=i||{actual:[],expected:[]};var a=i.actual.indexOf(e);return a!==-1&&a===i.expected.indexOf(t)?!0:(i.actual.push(e),i.expected.push(t),Ku(e,t,n,i))}return ss(new Uint8Array(e.buffer),new Uint8Array(t.buffer))===0}return n?e===t:e==t}function As(e){return Object.prototype.toString.call(e)=="[object Arguments]"}function Ku(e,t,n,i){if(e==null||t===null||t===void 0)return!1;if(Za(e)||Za(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var a=As(e),o=As(t);if(a&&!o||!a&&o)return!1;if(a)return e=ls.call(e),t=ls.call(t),jn(e,t,n);a=cs(e);var s=cs(t);if(a.length!==s.length)return!1;for(a.sort(),s.sort(),o=a.length-1;0<=o;o--)if(a[o]!==s[o])return!1;for(o=a.length-1;0<=o;o--)if(s=a[o],!jn(e[s],t[s],n,i))return!1;return!0}ee.notDeepEqual=ys;function ys(e,t,n){jn(e,t,!1)&&Ce(e,t,n,"notDeepEqual",ys)}ee.notDeepStrictEqual=ws;function ws(e,t,n){jn(e,t,!0)&&Ce(e,t,n,"notDeepStrictEqual",ws)}ee.strictEqual=Is;function Is(e,t,n){e!==t&&Ce(e,t,n,"===",Is)}ee.notStrictEqual=Es;function Es(e,t,n){e===t&&Ce(e,t,n,"!==",Es)}function bs(e,t){if(!e||!t)return!1;if(Object.prototype.toString.call(t)=="[object RegExp]")return t.test(e);try{if(e instanceof t)return!0}catch{}return Error.isPrototypeOf(t)?!1:t.call({},e)===!0}function Cs(e,t,n,i){if(typeof t!="function")throw new TypeError('"block" argument must be a function');typeof n=="string"&&(i=n,n=null);try{t()}catch(d){var a=d}t=a,i=(n&&n.name?" ("+n.name+").":".")+(i?" "+i:"."),e&&!t&&Ce(t,n,"Missing expected exception"+i),a=typeof i=="string";var o=!e&&gi(t),s=!e&&t&&!n;if((o&&a&&bs(t,n)||s)&&Ce(t,n,"Got unwanted exception"+i),e&&t&&n&&!bs(t,n)||!e&&t)throw t}ee.throws=Vu;function Vu(e,t,n){Cs(!0,e,t,n)}ee.doesNotThrow=ju;function ju(e,t,n){Cs(!1,e,t,n)}ee.ifError=Yu;function Yu(e){if(e)throw e}var mi=_e(function(e,t){function n(f){return function(l){function m(I){for(var g=[],B=1;B<arguments.length;B++)g[B-1]=arguments[B];return g=l.call(this,i(I,g))||this,g.code=I,g[d]=I,g.name=l.prototype.name+" ["+g[d]+"]",g}return s(m,l),m}(f)}function i(f,l){ee.strictEqual(typeof f,"string");var m=h[f];if(ee(m,"An invalid error message key was used: "+f+"."),typeof m=="function")f=m;else{if(f=pi.format,l===void 0||l.length===0)return m;l.unshift(m)}return String(f.apply(null,l))}function a(f,l){h[f]=typeof l=="function"?l:String(l)}function o(f,l){if(ee(f,"expected is required"),ee(typeof l=="string","thing is required"),Array.isArray(f)){var m=f.length;return ee(0<m,"At least one expected value needs to be specified"),f=f.map(function(I){return String(I)}),2<m?"one of "+l+" "+f.slice(0,m-1).join(", ")+", or "+f[m-1]:m===2?"one of "+l+" "+f[0]+" or "+f[1]:"of "+l+" "+f[0]}return"of "+l+" "+String(f)}var s=ae&&ae.__extends||function(){function f(l,m){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,g){I.__proto__=g}||function(I,g){for(var B in g)g.hasOwnProperty(B)&&(I[B]=g[B])},f(l,m)}return function(l,m){function I(){this.constructor=l}f(l,m),l.prototype=m===null?Object.create(m):(I.prototype=m.prototype,new I)}}();Object.defineProperty(t,"__esModule",{value:!0});var d=typeof Symbol>"u"?"_kCode":Symbol("code"),h={};e=function(f){function l(m){if(typeof m!="object"||m===null)throw new t.TypeError("ERR_INVALID_ARG_TYPE","options","object");var I=m.message?f.call(this,m.message)||this:f.call(this,pi.inspect(m.actual).slice(0,128)+" "+(m.operator+" "+pi.inspect(m.expected).slice(0,128)))||this;return I.generatedMessage=!m.message,I.name="AssertionError [ERR_ASSERTION]",I.code="ERR_ASSERTION",I.actual=m.actual,I.expected=m.expected,I.operator=m.operator,t.Error.captureStackTrace(I,m.stackStartFunction),I}return s(l,f),l}(ae.Error),t.AssertionError=e,t.message=i,t.E=a,t.Error=n(ae.Error),t.TypeError=n(ae.TypeError),t.RangeError=n(ae.RangeError),a("ERR_ARG_NOT_ITERABLE","%s must be iterable"),a("ERR_ASSERTION","%s"),a("ERR_BUFFER_OUT_OF_BOUNDS",function(f,l){return l?"Attempt to write outside buffer bounds":'"'+f+'" is outside of buffer bounds'}),a("ERR_CHILD_CLOSED_BEFORE_REPLY","Child closed before reply received"),a("ERR_CONSOLE_WRITABLE_STREAM","Console expects a writable stream instance for %s"),a("ERR_CPU_USAGE","Unable to obtain cpu usage %s"),a("ERR_DNS_SET_SERVERS_FAILED",function(f,l){return'c-ares failed to set servers: "'+f+'" ['+l+"]"}),a("ERR_FALSY_VALUE_REJECTION","Promise was rejected with falsy value"),a("ERR_ENCODING_NOT_SUPPORTED",function(f){return'The "'+f+'" encoding is not supported'}),a("ERR_ENCODING_INVALID_ENCODED_DATA",function(f){return"The encoded data was not valid for encoding "+f}),a("ERR_HTTP_HEADERS_SENT","Cannot render headers after they are sent to the client"),a("ERR_HTTP_INVALID_STATUS_CODE","Invalid status code: %s"),a("ERR_HTTP_TRAILER_INVALID","Trailers are invalid with this transfer encoding"),a("ERR_INDEX_OUT_OF_RANGE","Index out of range"),a("ERR_INVALID_ARG_TYPE",function(f,l,m){if(ee(f,"name is required"),l.includes("not ")){var I="must not be";l=l.split("not ")[1]}else I="must be";if(Array.isArray(f))I="The "+f.map(function(B){return'"'+B+'"'}).join(", ")+" arguments "+I+" "+o(l,"type");else if(f.includes(" argument"))I="The "+f+" "+I+" "+o(l,"type");else{var g=f.includes(".")?"property":"argument";I='The "'+f+'" '+g+" "+I+" "+o(l,"type")}return 3<=arguments.length&&(I+=". Received type "+(m!==null?typeof m:"null")),I}),a("ERR_INVALID_ARRAY_LENGTH",function(f,l,m){return ee.strictEqual(typeof m,"number"),'The array "'+f+'" (length '+m+") must be of length "+l+"."}),a("ERR_INVALID_BUFFER_SIZE","Buffer size must be a multiple of %s"),a("ERR_INVALID_CALLBACK","Callback must be a function"),a("ERR_INVALID_CHAR","Invalid character in %s"),a("ERR_INVALID_CURSOR_POS","Cannot set cursor row without setting its column"),a("ERR_INVALID_FD",'"fd" must be a positive integer: %s'),a("ERR_INVALID_FILE_URL_HOST",'File URL host must be "localhost" or empty on %s'),a("ERR_INVALID_FILE_URL_PATH","File URL path %s"),a("ERR_INVALID_HANDLE_TYPE","This handle type cannot be sent"),a("ERR_INVALID_IP_ADDRESS","Invalid IP address: %s"),a("ERR_INVALID_OPT_VALUE",function(f,l){return'The value "'+String(l)+'" is invalid for option "'+f+'"'}),a("ERR_INVALID_OPT_VALUE_ENCODING",function(f){return'The value "'+String(f)+'" is invalid for option "encoding"'}),a("ERR_INVALID_REPL_EVAL_CONFIG",'Cannot specify both "breakEvalOnSigint" and "eval" for REPL'),a("ERR_INVALID_SYNC_FORK_INPUT","Asynchronous forks do not support Buffer, Uint8Array or string input: %s"),a("ERR_INVALID_THIS",'Value of "this" must be of type %s'),a("ERR_INVALID_TUPLE","%s must be an iterable %s tuple"),a("ERR_INVALID_URL","Invalid URL: %s"),a("ERR_INVALID_URL_SCHEME",function(f){return"The URL must be "+o(f,"scheme")}),a("ERR_IPC_CHANNEL_CLOSED","Channel closed"),a("ERR_IPC_DISCONNECTED","IPC channel is already disconnected"),a("ERR_IPC_ONE_PIPE","Child process can have only one IPC pipe"),a("ERR_IPC_SYNC_FORK","IPC cannot be used with synchronous forks"),a("ERR_MISSING_ARGS",function(){for(var f=[],l=0;l<arguments.length;l++)f[l]=arguments[l];ee(0<f.length,"At least one arg needs to be specified"),l="The ";var m=f.length;switch(f=f.map(function(I){return'"'+I+'"'}),m){case 1:l+=f[0]+" argument";break;case 2:l+=f[0]+" and "+f[1]+" arguments";break;default:l+=f.slice(0,m-1).join(", "),l+=", and "+f[m-1]+" arguments"}return l+" must be specified"}),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_NAPI_CONS_FUNCTION","Constructor must be a function"),a("ERR_NAPI_CONS_PROTOTYPE_OBJECT","Constructor.prototype must be an object"),a("ERR_NO_CRYPTO","Node.js is not compiled with OpenSSL crypto support"),a("ERR_NO_LONGER_SUPPORTED","%s is no longer supported"),a("ERR_PARSE_HISTORY_DATA","Could not parse history data in %s"),a("ERR_SOCKET_ALREADY_BOUND","Socket is already bound"),a("ERR_SOCKET_BAD_PORT","Port should be > 0 and < 65536"),a("ERR_SOCKET_BAD_TYPE","Bad socket type specified. Valid types are: udp4, udp6"),a("ERR_SOCKET_CANNOT_SEND","Unable to send data"),a("ERR_SOCKET_CLOSED","Socket is closed"),a("ERR_SOCKET_DGRAM_NOT_RUNNING","Not running"),a("ERR_STDERR_CLOSE","process.stderr cannot be closed"),a("ERR_STDOUT_CLOSE","process.stdout cannot be closed"),a("ERR_STREAM_WRAP","Stream has StringDecoder set or is in objectMode"),a("ERR_TLS_CERT_ALTNAME_INVALID","Hostname/IP does not match certificate's altnames: %s"),a("ERR_TLS_DH_PARAM_SIZE",function(f){return"DH parameter size "+f+" is less than 2048"}),a("ERR_TLS_HANDSHAKE_TIMEOUT","TLS handshake timeout"),a("ERR_TLS_RENEGOTIATION_FAILED","Failed to renegotiate"),a("ERR_TLS_REQUIRED_SERVER_NAME",'"servername" is required parameter for Server.addContext'),a("ERR_TLS_SESSION_ATTACK","TSL session renegotiation attack detected"),a("ERR_TRANSFORM_ALREADY_TRANSFORMING","Calling transform done when still transforming"),a("ERR_TRANSFORM_WITH_LENGTH_0","Calling transform done when writableState.length != 0"),a("ERR_UNKNOWN_ENCODING","Unknown encoding: %s"),a("ERR_UNKNOWN_SIGNAL","Unknown signal: %s"),a("ERR_UNKNOWN_STDIN_TYPE","Unknown stdin file type"),a("ERR_UNKNOWN_STREAM_TYPE","Unknown stream file type"),a("ERR_V8BREAKITERATOR","Full ICU data not installed. See https://github.com/nodejs/node/wiki/Intl")});Le(mi);var Ue=_e(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ENCODING_UTF8="utf8",t.assertEncoding=function(n){if(n&&!Xt.Buffer.isEncoding(n))throw new mi.TypeError("ERR_INVALID_OPT_VALUE_ENCODING",n)},t.strToEncoding=function(n,i){return i&&i!==t.ENCODING_UTF8?i==="buffer"?new Xt.Buffer(n):new Xt.Buffer(n).toString(i):n}});Le(Ue);var no=_e(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=zt.constants.S_IFMT,i=zt.constants.S_IFDIR,a=zt.constants.S_IFREG,o=zt.constants.S_IFBLK,s=zt.constants.S_IFCHR,d=zt.constants.S_IFLNK,h=zt.constants.S_IFIFO,f=zt.constants.S_IFSOCK;e=function(){function l(){this.name="",this.mode=0}return l.build=function(m,I){var g=new l,B=m.getNode().mode;return g.name=Ue.strToEncoding(m.getName(),I),g.mode=B,g},l.prototype._checkModeProperty=function(m){return(this.mode&n)===m},l.prototype.isDirectory=function(){return this._checkModeProperty(i)},l.prototype.isFile=function(){return this._checkModeProperty(a)},l.prototype.isBlockDevice=function(){return this._checkModeProperty(o)},l.prototype.isCharacterDevice=function(){return this._checkModeProperty(s)},l.prototype.isSymbolicLink=function(){return this._checkModeProperty(d)},l.prototype.isFIFO=function(){return this._checkModeProperty(h)},l.prototype.isSocket=function(){return this._checkModeProperty(f)},l}(),t.Dirent=e,t.default=e});Le(no);function Ss(e,t){for(var n=0,i=e.length-1;0<=i;i--){var a=e[i];a==="."?e.splice(i,1):a===".."?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var io=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function ao(){for(var e="",t=!1,n=arguments.length-1;-1<=n&&!t;n--){var i=0<=n?arguments[n]:"/";if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,t=i.charAt(0)==="/")}return e=Ss(so(e.split("/"),function(a){return!!a}),!t).join("/"),(t?"/":"")+e||"."}function Fs(e){var t=vs(e),n=$u(e,-1)==="/";return(e=Ss(so(e.split("/"),function(i){return!!i}),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e}function vs(e){return e.charAt(0)==="/"}function oo(e,t){function n(s){for(var d=0;d<s.length&&s[d]==="";d++);for(var h=s.length-1;0<=h&&s[h]==="";h--);return d>h?[]:s.slice(d,h-d+1)}e=ao(e).substr(1),t=ao(t).substr(1),e=n(e.split("/")),t=n(t.split("/"));for(var i=Math.min(e.length,t.length),a=i,o=0;o<i;o++)if(e[o]!==t[o]){a=o;break}for(i=[],o=a;o<e.length;o++)i.push("..");return i=i.concat(t.slice(a)),i.join("/")}var ro={extname:function(e){return io.exec(e).slice(1)[3]},basename:function(e,t){return e=io.exec(e).slice(1)[2],t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},dirname:function(e){var t=io.exec(e).slice(1);return e=t[0],t=t[1],!e&&!t?".":(t&&(t=t.substr(0,t.length-1)),e+t)},sep:"/",delimiter:":",relative:oo,join:function(){var e=Array.prototype.slice.call(arguments,0);return Fs(so(e,function(t){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},isAbsolute:vs,normalize:Fs,resolve:ao};function so(e,t){if(e.filter)return e.filter(t);for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}var $u="ab".substr(-1)==="b"?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return 0>t&&(t=e.length+t),e.substr(t,n)},Yn=_e(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),e=typeof setImmediate=="function"?setImmediate.bind(ae):setTimeout.bind(ae),t.default=e});Le(Yn);var Ae=_e(function(e,t){function n(){var i=Wn||{};return i.getuid||(i.getuid=function(){return 0}),i.getgid||(i.getgid=function(){return 0}),i.cwd||(i.cwd=function(){return"/"}),i.nextTick||(i.nextTick=Yn.default),i.emitWarning||(i.emitWarning=function(a,o){console.warn(""+o+(o?": ":"")+a)}),i.env||(i.env={}),i}Object.defineProperty(t,"__esModule",{value:!0}),t.createProcess=n,t.default=n()});Le(Ae);function _n(){}_n.prototype=Object.create(null);function qt(){qt.init.call(this)}qt.EventEmitter=qt,qt.usingDomains=!1,qt.prototype.domain=void 0,qt.prototype._events=void 0,qt.prototype._maxListeners=void 0,qt.defaultMaxListeners=10,qt.init=function(){this.domain=null,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new _n,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},qt.prototype.setMaxListeners=function(e){if(typeof e!="number"||0>e||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},qt.prototype.getMaxListeners=function(){return this._maxListeners===void 0?qt.defaultMaxListeners:this._maxListeners},qt.prototype.emit=function(e){var t,n,i=e==="error";if(t=this._events)i=i&&t.error==null;else if(!i)return!1;var a=this.domain;if(i){if(t=arguments[1],a)t||(t=Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t);else throw t instanceof Error?t:(a=Error('Uncaught, unspecified "error" event. ('+t+")"),a.context=t,a);return!1}if(a=t[e],!a)return!1;t=typeof a=="function";var o=arguments.length;switch(o){case 1:if(t)a.call(this);else for(t=a.length,a=Li(a,t),i=0;i<t;++i)a[i].call(this);break;case 2:if(i=arguments[1],t)a.call(this,i);else for(t=a.length,a=Li(a,t),o=0;o<t;++o)a[o].call(this,i);break;case 3:if(i=arguments[1],o=arguments[2],t)a.call(this,i,o);else for(t=a.length,a=Li(a,t),n=0;n<t;++n)a[n].call(this,i,o);break;case 4:if(i=arguments[1],o=arguments[2],n=arguments[3],t)a.call(this,i,o,n);else{t=a.length,a=Li(a,t);for(var s=0;s<t;++s)a[s].call(this,i,o,n)}break;default:for(i=Array(o-1),n=1;n<o;n++)i[n-1]=arguments[n];if(t)a.apply(this,i);else for(t=a.length,a=Li(a,t),o=0;o<t;++o)a[o].apply(this,i)}return!0};function Bs(e,t,n,i){var a;if(typeof n!="function")throw new TypeError('"listener" argument must be a function');if(a=e._events){a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events);var o=a[t]}else a=e._events=new _n,e._eventsCount=0;return o?(typeof o=="function"?o=a[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),o.warned||(n=e._maxListeners===void 0?qt.defaultMaxListeners:e._maxListeners)&&0<n&&o.length>n&&(o.warned=!0,n=Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit"),n.name="MaxListenersExceededWarning",n.emitter=e,n.type=t,n.count=o.length,typeof console.warn=="function"?console.warn(n):console.log(n))):(a[t]=n,++e._eventsCount),e}qt.prototype.addListener=function(e,t){return Bs(this,e,t,!1)},qt.prototype.on=qt.prototype.addListener,qt.prototype.prependListener=function(e,t){return Bs(this,e,t,!0)};function xs(e,t,n){function i(){e.removeListener(t,i),a||(a=!0,n.apply(e,arguments))}var a=!1;return i.listener=n,i}qt.prototype.once=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.on(e,xs(this,e,t)),this},qt.prototype.prependOnceListener=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(e,xs(this,e,t)),this},qt.prototype.removeListener=function(e,t){var n;if(typeof t!="function")throw new TypeError('"listener" argument must be a function');var i=this._events;if(!i)return this;var a=i[e];if(!a)return this;if(a===t||a.listener&&a.listener===t)--this._eventsCount===0?this._events=new _n:(delete i[e],i.removeListener&&this.emit("removeListener",e,a.listener||t));else if(typeof a!="function"){var o=-1;for(n=a.length;0<n--;)if(a[n]===t||a[n].listener&&a[n].listener===t){var s=a[n].listener;o=n;break}if(0>o)return this;if(a.length===1){if(a[0]=void 0,--this._eventsCount===0)return this._events=new _n,this;delete i[e]}else{n=o+1;for(var d=a.length;n<d;o+=1,n+=1)a[o]=a[n];a.pop()}i.removeListener&&this.emit("removeListener",e,s||t)}return this},qt.prototype.removeAllListeners=function(e){var t=this._events;if(!t)return this;if(!t.removeListener)return arguments.length===0?(this._events=new _n,this._eventsCount=0):t[e]&&(--this._eventsCount===0?this._events=new _n:delete t[e]),this;if(arguments.length===0){t=Object.keys(t);for(var n=0,i;n<t.length;++n)i=t[n],i!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new _n,this._eventsCount=0,this}if(t=t[e],typeof t=="function")this.removeListener(e,t);else if(t)do this.removeListener(e,t[t.length-1]);while(t[0]);return this},qt.prototype.listeners=function(e){var t=this._events;if(t)if(e=t[e])if(typeof e=="function")e=[e.listener||e];else{t=Array(e.length);for(var n=0;n<t.length;++n)t[n]=e[n].listener||e[n];e=t}else e=[];else e=[];return e},qt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Ts.call(e,t)},qt.prototype.listenerCount=Ts;function Ts(e){var t=this._events;if(t){if(e=t[e],typeof e=="function")return 1;if(e)return e.length}return 0}qt.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};function Li(e,t){for(var n=Array(t);t--;)n[t]=e[t];return n}var Ai=_e(function(e,t){var n=ae&&ae.__extends||function(){function h(f,l){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,I){m.__proto__=I}||function(m,I){for(var g in I)I.hasOwnProperty(g)&&(m[g]=I[g])},h(f,l)}return function(f,l){function m(){this.constructor=f}h(f,l),f.prototype=l===null?Object.create(l):(m.prototype=l.prototype,new m)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=zt.constants.S_IFMT,a=zt.constants.S_IFDIR,o=zt.constants.S_IFREG,s=zt.constants.S_IFLNK,d=zt.constants.O_APPEND;t.SEP="/",e=function(h){function f(l,m){m===void 0&&(m=438);var I=h.call(this)||this;return I.uid=Ae.default.getuid(),I.gid=Ae.default.getgid(),I.atime=new Date,I.mtime=new Date,I.ctime=new Date,I.perm=438,I.mode=o,I.nlink=1,I.perm=m,I.mode|=m,I.ino=l,I}return n(f,h),f.prototype.getString=function(l){return l===void 0&&(l="utf8"),this.getBuffer().toString(l)},f.prototype.setString=function(l){this.buf=Xt.bufferFrom(l,"utf8"),this.touch()},f.prototype.getBuffer=function(){return this.buf||this.setBuffer(Xt.bufferAllocUnsafe(0)),Xt.bufferFrom(this.buf)},f.prototype.setBuffer=function(l){this.buf=Xt.bufferFrom(l),this.touch()},f.prototype.getSize=function(){return this.buf?this.buf.length:0},f.prototype.setModeProperty=function(l){this.mode=this.mode&~i|l},f.prototype.setIsFile=function(){this.setModeProperty(o)},f.prototype.setIsDirectory=function(){this.setModeProperty(a)},f.prototype.setIsSymlink=function(){this.setModeProperty(s)},f.prototype.isFile=function(){return(this.mode&i)===o},f.prototype.isDirectory=function(){return(this.mode&i)===a},f.prototype.isSymlink=function(){return(this.mode&i)===s},f.prototype.makeSymlink=function(l){this.symlink=l,this.setIsSymlink()},f.prototype.write=function(l,m,I,g){if(m===void 0&&(m=0),I===void 0&&(I=l.length),g===void 0&&(g=0),this.buf||(this.buf=Xt.bufferAllocUnsafe(0)),g+I>this.buf.length){var B=Xt.bufferAllocUnsafe(g+I);this.buf.copy(B,0,0,this.buf.length),this.buf=B}return l.copy(this.buf,g,m,m+I),this.touch(),I},f.prototype.read=function(l,m,I,g){return m===void 0&&(m=0),I===void 0&&(I=l.byteLength),g===void 0&&(g=0),this.buf||(this.buf=Xt.bufferAllocUnsafe(0)),I>l.byteLength&&(I=l.byteLength),I+g>this.buf.length&&(I=this.buf.length-g),this.buf.copy(l,m,g,g+I),I},f.prototype.truncate=function(l){if(l===void 0&&(l=0),l)if(this.buf||(this.buf=Xt.bufferAllocUnsafe(0)),l<=this.buf.length)this.buf=this.buf.slice(0,l);else{var m=Xt.bufferAllocUnsafe(0);this.buf.copy(m),m.fill(0,l)}else this.buf=Xt.bufferAllocUnsafe(0);this.touch()},f.prototype.chmod=function(l){this.perm=l,this.mode=this.mode&-512|l,this.touch()},f.prototype.chown=function(l,m){this.uid=l,this.gid=m,this.touch()},f.prototype.touch=function(){this.mtime=new Date,this.emit("change",this)},f.prototype.canRead=function(l,m){return l===void 0&&(l=Ae.default.getuid()),m===void 0&&(m=Ae.default.getgid()),!!(this.perm&4||m===this.gid&&this.perm&32||l===this.uid&&this.perm&256)},f.prototype.canWrite=function(l,m){return l===void 0&&(l=Ae.default.getuid()),m===void 0&&(m=Ae.default.getgid()),!!(this.perm&2||m===this.gid&&this.perm&16||l===this.uid&&this.perm&128)},f.prototype.del=function(){this.emit("delete",this)},f.prototype.toJSON=function(){return{ino:this.ino,uid:this.uid,gid:this.gid,atime:this.atime.getTime(),mtime:this.mtime.getTime(),ctime:this.ctime.getTime(),perm:this.perm,mode:this.mode,nlink:this.nlink,symlink:this.symlink,data:this.getString()}},f}(qt.EventEmitter),t.Node=e,e=function(h){function f(l,m,I){var g=h.call(this)||this;return g.children={},g.steps=[],g.ino=0,g.length=0,g.vol=l,g.parent=m,g.steps=m?m.steps.concat([I]):[I],g}return n(f,h),f.prototype.setNode=function(l){this.node=l,this.ino=l.ino},f.prototype.getNode=function(){return this.node},f.prototype.createChild=function(l,m){m===void 0&&(m=this.vol.createNode());var I=new f(this.vol,this,l);return I.setNode(m),m.isDirectory(),this.setChild(l,I),I},f.prototype.setChild=function(l,m){return m===void 0&&(m=new f(this.vol,this,l)),this.children[l]=m,m.parent=this,this.length++,this.emit("child:add",m,this),m},f.prototype.deleteChild=function(l){delete this.children[l.getName()],this.length--,this.emit("child:delete",l,this)},f.prototype.getChild=function(l){if(Object.hasOwnProperty.call(this.children,l))return this.children[l]},f.prototype.getPath=function(){return this.steps.join(t.SEP)},f.prototype.getName=function(){return this.steps[this.steps.length-1]},f.prototype.walk=function(l,m,I){if(m===void 0&&(m=l.length),I===void 0&&(I=0),I>=l.length||I>=m)return this;var g=this.getChild(l[I]);return g?g.walk(l,m,I+1):null},f.prototype.toJSON=function(){return{steps:this.steps,ino:this.ino,children:Object.keys(this.children)}},f}(qt.EventEmitter),t.Link=e,e=function(){function h(f,l,m,I){this.position=0,this.link=f,this.node=l,this.flags=m,this.fd=I}return h.prototype.getString=function(){return this.node.getString()},h.prototype.setString=function(f){this.node.setString(f)},h.prototype.getBuffer=function(){return this.node.getBuffer()},h.prototype.setBuffer=function(f){this.node.setBuffer(f)},h.prototype.getSize=function(){return this.node.getSize()},h.prototype.truncate=function(f){this.node.truncate(f)},h.prototype.seekTo=function(f){this.position=f},h.prototype.stats=function(){return qn.default.build(this.node)},h.prototype.write=function(f,l,m,I){return l===void 0&&(l=0),m===void 0&&(m=f.length),typeof I!="number"&&(I=this.position),this.flags&d&&(I=this.getSize()),f=this.node.write(f,l,m,I),this.position=I+f,f},h.prototype.read=function(f,l,m,I){return l===void 0&&(l=0),m===void 0&&(m=f.byteLength),typeof I!="number"&&(I=this.position),f=this.node.read(f,l,m,I),this.position=I+f,f},h.prototype.chmod=function(f){this.node.chmod(f)},h.prototype.chown=function(f,l){this.node.chown(f,l)},h}(),t.File=e});Le(Ai);var Zu=Ai.Node,Ps=_e(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(n,i,a){var o=setTimeout.apply(null,arguments);return o&&typeof o=="object"&&typeof o.unref=="function"&&o.unref(),o}});Le(Ps);function Bn(){this.tail=this.head=null,this.length=0}Bn.prototype.push=function(e){e={data:e,next:null},0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length},Bn.prototype.unshift=function(e){e={data:e,next:this.head},this.length===0&&(this.tail=e),this.head=e,++this.length},Bn.prototype.shift=function(){if(this.length!==0){var e=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,e}},Bn.prototype.clear=function(){this.head=this.tail=null,this.length=0},Bn.prototype.join=function(e){if(this.length===0)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},Bn.prototype.concat=function(e){if(this.length===0)return lt.alloc(0);if(this.length===1)return this.head.data;e=lt.allocUnsafe(e>>>0);for(var t=this.head,n=0;t;)t.data.copy(e,n),n+=t.data.length,t=t.next;return e};var Ju=lt.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function yi(e){if(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),e&&!Ju(e))throw Error("Unknown encoding: "+e);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=tf;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=ef;break;default:this.write=Xu;return}this.charBuffer=new lt(6),this.charLength=this.charReceived=0}yi.prototype.write=function(e){for(var t="";this.charLength;){if(t=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length,e.copy(this.charBuffer,this.charReceived,0,t),this.charReceived+=t,this.charReceived<this.charLength)return"";e=e.slice(t,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var n=t.charCodeAt(t.length-1);if(55296<=n&&56319>=n)this.charLength+=this.surrogateSize,t="";else{if(this.charReceived=this.charLength=0,e.length===0)return t;break}}this.detectIncompleteChar(e);var i=e.length;return this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i),i=t.length-1,n=t.charCodeAt(i),55296<=n&&56319>=n?(n=this.surrogateSize,this.charLength+=n,this.charReceived+=n,this.charBuffer.copy(this.charBuffer,n,0,n),e.copy(this.charBuffer,0,0,n),t.substring(0,i)):t},yi.prototype.detectIncompleteChar=function(e){for(var t=3<=e.length?3:e.length;0<t;t--){var n=e[e.length-t];if(t==1&&n>>5==6){this.charLength=2;break}if(2>=t&&n>>4==14){this.charLength=3;break}if(3>=t&&n>>3==30){this.charLength=4;break}}this.charReceived=t},yi.prototype.end=function(e){var t="";return e&&e.length&&(t=this.write(e)),this.charReceived&&(e=this.encoding,t+=this.charBuffer.slice(0,this.charReceived).toString(e)),t};function Xu(e){return e.toString(this.encoding)}function tf(e){this.charLength=(this.charReceived=e.length%2)?2:0}function ef(e){this.charLength=(this.charReceived=e.length%3)?3:0}ne.ReadableState=Os;var $t=is("stream");un(ne,qt);function nf(e,t,n){if(typeof e.prependListener=="function")return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}function Os(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Ge&&(this.objectMode=this.objectMode||!!e.readableObjectMode),t=e.highWaterMark;var n=this.objectMode?16:16384;this.highWaterMark=t||t===0?t:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new Bn,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.reading=this.endEmitted=this.ended=!1,this.sync=!0,this.resumeScheduled=this.readableListening=this.emittedReadable=this.needReadable=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.encoding=this.decoder=null,e.encoding&&(this.decoder=new yi(e.encoding),this.encoding=e.encoding)}function ne(e){if(!(this instanceof ne))return new ne(e);this._readableState=new Os(e,this),this.readable=!0,e&&typeof e.read=="function"&&(this._read=e.read),qt.call(this)}ne.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||typeof e!="string"||(t=t||n.defaultEncoding,t!==n.encoding&&(e=lt.from(e,t),t="")),Rs(this,n,e,t,!1)},ne.prototype.unshift=function(e){return Rs(this,this._readableState,e,"",!0)},ne.prototype.isPaused=function(){return this._readableState.flowing===!1};function Rs(e,t,n,i,a){var o=n,s=null;if(Xe(o)||typeof o=="string"||o===null||o===void 0||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),o=s)e.emit("error",o);else if(n===null)t.reading=!1,t.ended||(t.decoder&&(n=t.decoder.end())&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length),t.ended=!0,ca(e));else if(t.objectMode||n&&0<n.length)if(t.ended&&!a)e.emit("error",Error("stream.push() after EOF"));else if(t.endEmitted&&a)e.emit("error",Error("stream.unshift() after end event"));else{if(t.decoder&&!a&&!i){n=t.decoder.write(n);var d=!t.objectMode&&n.length===0}a||(t.reading=!1),d||(t.flowing&&t.length===0&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,a?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&ca(e))),t.readingMore||(t.readingMore=!0,ve(af,e,t))}else a||(t.reading=!1);return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}ne.prototype.setEncoding=function(e){return this._readableState.decoder=new yi(e),this._readableState.encoding=e,this};function Us(e,t){if(0>=e||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(e!==e)return t.flowing&&t.length?t.buffer.head.data.length:t.length;if(e>t.highWaterMark){var n=e;8388608<=n?n=8388608:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),t.highWaterMark=n}return e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0)}ne.prototype.read=function(e){$t("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(e!==0&&(t.emittedReadable=!1),e===0&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return $t("read: emitReadable",t.length,t.ended),t.length===0&&t.ended?lo(this):ca(this),null;if(e=Us(e,t),e===0&&t.ended)return t.length===0&&lo(this),null;var i=t.needReadable;return $t("need readable",i),(t.length===0||t.length-e<t.highWaterMark)&&(i=!0,$t("length less than watermark",i)),t.ended||t.reading?$t("reading or ended",!1):i&&($t("do read"),t.reading=!0,t.sync=!0,t.length===0&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=Us(n,t))),i=0<e?Ms(e,t):null,i===null?(t.needReadable=!0,e=0):t.length-=e,t.length===0&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&lo(this)),i!==null&&this.emit("data",i),i};function ca(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||($t("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?ve(Gs,e):Gs(e))}function Gs(e){$t("emit readable"),e.emit("readable"),co(e)}function af(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&($t("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}ne.prototype._read=function(){this.emit("error",Error("not implemented"))},ne.prototype.pipe=function(e,t){function n(P){$t("onunpipe"),P===l&&a()}function i(){$t("onend"),e.end()}function a(){$t("cleanup"),e.removeListener("close",d),e.removeListener("finish",h),e.removeListener("drain",I),e.removeListener("error",s),e.removeListener("unpipe",n),l.removeListener("end",i),l.removeListener("end",a),l.removeListener("data",o),g=!0,!m.awaitDrain||e._writableState&&!e._writableState.needDrain||I()}function o(P){$t("ondata"),B=!1,e.write(P)!==!1||B||((m.pipesCount===1&&m.pipes===e||1<m.pipesCount&&Ds(m.pipes,e)!==-1)&&!g&&($t("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,B=!0),l.pause())}function s(P){$t("onerror",P),f(),e.removeListener("error",s),e.listeners("error").length===0&&e.emit("error",P)}function d(){e.removeListener("finish",h),f()}function h(){$t("onfinish"),e.removeListener("close",d),f()}function f(){$t("unpipe"),l.unpipe(e)}var l=this,m=this._readableState;switch(m.pipesCount){case 0:m.pipes=e;break;case 1:m.pipes=[m.pipes,e];break;default:m.pipes.push(e)}m.pipesCount+=1,$t("pipe count=%d opts=%j",m.pipesCount,t),t=t&&t.end===!1?a:i,m.endEmitted?ve(t):l.once("end",t),e.on("unpipe",n);var I=of(l);e.on("drain",I);var g=!1,B=!1;return l.on("data",o),nf(e,"error",s),e.once("close",d),e.once("finish",h),e.emit("pipe",l),m.flowing||($t("pipe resume"),l.resume()),e};function of(e){return function(){var t=e._readableState;$t("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&e.listeners("data").length&&(t.flowing=!0,co(e))}}ne.prototype.unpipe=function(e){var t=this._readableState;if(t.pipesCount===0)return this;if(t.pipesCount===1)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){e=t.pipes;var n=t.pipesCount;for(t.pipes=null,t.pipesCount=0,t.flowing=!1,t=0;t<n;t++)e[t].emit("unpipe",this);return this}return n=Ds(t.pipes,e),n===-1?this:(t.pipes.splice(n,1),--t.pipesCount,t.pipesCount===1&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},ne.prototype.on=function(e,t){return t=qt.prototype.on.call(this,e,t),e==="data"?this._readableState.flowing!==!1&&this.resume():e==="readable"&&(e=this._readableState,e.endEmitted||e.readableListening||(e.readableListening=e.needReadable=!0,e.emittedReadable=!1,e.reading?e.length&&ca(this):ve(rf,this))),t},ne.prototype.addListener=ne.prototype.on;function rf(e){$t("readable nexttick read 0"),e.read(0)}ne.prototype.resume=function(){var e=this._readableState;return e.flowing||($t("resume"),e.flowing=!0,e.resumeScheduled||(e.resumeScheduled=!0,ve(sf,this,e))),this};function sf(e,t){t.reading||($t("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),co(e),t.flowing&&!t.reading&&e.read(0)}ne.prototype.pause=function(){return $t("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&($t("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function co(e){var t=e._readableState;for($t("flow",t.flowing);t.flowing&&e.read()!==null;);}ne.prototype.wrap=function(e){var t=this._readableState,n=!1,i=this;e.on("end",function(){if($t("wrapped end"),t.decoder&&!t.ended){var o=t.decoder.end();o&&o.length&&i.push(o)}i.push(null)}),e.on("data",function(o){$t("wrapped data"),t.decoder&&(o=t.decoder.write(o)),t.objectMode&&o==null||!(t.objectMode||o&&o.length)||i.push(o)||(n=!0,e.pause())});for(var a in e)this[a]===void 0&&typeof e[a]=="function"&&(this[a]=function(o){return function(){return e[o].apply(e,arguments)}}(a));return lf(["error","close","destroy","pause","resume"],function(o){e.on(o,i.emit.bind(i,o))}),i._read=function(o){$t("wrapped _read",o),n&&(n=!1,e.resume())},i},ne._fromList=Ms;function Ms(e,t){if(t.length===0)return null;if(t.objectMode)var n=t.buffer.shift();else if(!e||e>=t.length)n=t.decoder?t.buffer.join(""):t.buffer.length===1?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear();else{if(n=t.buffer,t=t.decoder,e<n.head.data.length)t=n.head.data.slice(0,e),n.head.data=n.head.data.slice(e);else{if(e===n.head.data.length)n=n.shift();else if(t){t=n.head;var i=1,a=t.data;for(e-=a.length;t=t.next;){var o=t.data,s=e>o.length?o.length:e;if(a=s===o.length?a+o:a+o.slice(0,e),e-=s,e===0){s===o.length?(++i,n.head=t.next?t.next:n.tail=null):(n.head=t,t.data=o.slice(s));break}++i}n.length-=i,n=a}else{for(t=lt.allocUnsafe(e),i=n.head,a=1,i.data.copy(t),e-=i.data.length;i=i.next;){if(o=i.data,s=e>o.length?o.length:e,o.copy(t,t.length-e,0,s),e-=s,e===0){s===o.length?(++a,n.head=i.next?i.next:n.tail=null):(n.head=i,i.data=o.slice(s));break}++a}n.length-=a,n=t}t=n}n=t}return n}function lo(e){var t=e._readableState;if(0<t.length)throw Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,ve(cf,t,e))}function cf(e,t){e.endEmitted||e.length!==0||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function lf(e,t){for(var n=0,i=e.length;n<i;n++)t(e[n],n)}function Ds(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}he.WritableState=uo,un(he,qt);function df(){}function uf(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function uo(e,t){Object.defineProperty(this,"buffer",{get:Ka(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Ge&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||n===0?n:i,this.highWaterMark=~~this.highWaterMark,this.finished=this.ended=this.ending=this.needDrain=!1,this.decodeStrings=e.decodeStrings!==!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){var o=t._writableState,s=o.sync,d=o.writecb;o.writing=!1,o.writecb=null,o.length-=o.writelen,o.writelen=0,a?(--o.pendingcb,s?ve(d,a):d(a),t._writableState.errorEmitted=!0,t.emit("error",a)):((a=zs(o))||o.corked||o.bufferProcessing||!o.bufferedRequest||ks(t,o),s?ve(Ns,t,o,a,d):Ns(t,o,a,d))},this.writecb=null,this.writelen=0,this.lastBufferedRequest=this.bufferedRequest=null,this.pendingcb=0,this.errorEmitted=this.prefinished=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Qs(this)}uo.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};function he(e){if(!(this instanceof he||this instanceof Ge))return new he(e);this._writableState=new uo(e,this),this.writable=!0,e&&(typeof e.write=="function"&&(this._write=e.write),typeof e.writev=="function"&&(this._writev=e.writev)),qt.call(this)}he.prototype.pipe=function(){this.emit("error",Error("Cannot pipe, not readable"))},he.prototype.write=function(e,t,n){var i=this._writableState,a=!1;if(typeof t=="function"&&(n=t,t=null),lt.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),typeof n!="function"&&(n=df),i.ended)i=n,e=Error("write after end"),this.emit("error",e),ve(i,e);else{var o=n,s=!0,d=!1;e===null?d=new TypeError("May not write null values to stream"):lt.isBuffer(e)||typeof e=="string"||e===void 0||i.objectMode||(d=new TypeError("Invalid non-string/buffer chunk")),d&&(this.emit("error",d),ve(o,d),s=!1),s&&(i.pendingcb++,a=t,i.objectMode||i.decodeStrings===!1||typeof e!="string"||(e=lt.from(e,a)),lt.isBuffer(e)&&(a="buffer"),o=i.objectMode?1:e.length,i.length+=o,t=i.length<i.highWaterMark,t||(i.needDrain=!0),i.writing||i.corked?(o=i.lastBufferedRequest,i.lastBufferedRequest=new uf(e,a,n),o?o.next=i.lastBufferedRequest:i.bufferedRequest=i.lastBufferedRequest,i.bufferedRequestCount+=1):fo(this,i,!1,o,e,a,n),a=t)}return a},he.prototype.cork=function(){this._writableState.corked++},he.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||ks(this,e))},he.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(-1<"hex utf8 utf-8 ascii binary base64 ucs2 ucs-2 utf16le utf-16le raw".split(" ").indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function fo(e,t,n,i,a,o,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(a,t.onwrite):e._write(a,o,t.onwrite),t.sync=!1}function Ns(e,t,n,i){!n&&t.length===0&&t.needDrain&&(t.needDrain=!1,e.emit("drain")),t.pendingcb--,i(),qs(e,t)}function ks(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=Array(t.bufferedRequestCount),a=t.corkedRequestsFree;a.entry=n;for(var o=0;n;)i[o]=n,n=n.next,o+=1;fo(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new Qs(t)}else{for(;n&&(i=n.chunk,fo(e,t,!1,t.objectMode?1:i.length,i,n.encoding,n.callback),n=n.next,!t.writing););n===null&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}he.prototype._write=function(e,t,n){n(Error("not implemented"))},he.prototype._writev=null,he.prototype.end=function(e,t,n){var i=this._writableState;typeof e=="function"?(n=e,t=e=null):typeof t=="function"&&(n=t,t=null),e!=null&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),!i.ending&&!i.finished&&(e=n,i.ending=!0,qs(this,i),e&&(i.finished?ve(e):this.once("finish",e)),i.ended=!0,this.writable=!1)};function zs(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function qs(e,t){var n=zs(t);return n&&(t.pendingcb===0?(t.prefinished||(t.prefinished=!0,e.emit("prefinish")),t.finished=!0,e.emit("finish")):t.prefinished||(t.prefinished=!0,e.emit("prefinish"))),n}function Qs(e){var t=this;this.entry=this.next=null,this.finish=function(n){var i=t.entry;for(t.entry=null;i;){var a=i.callback;e.pendingcb--,a(n),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}un(Ge,ne);for(var Hs=Object.keys(he.prototype),_o=0;_o<Hs.length;_o++){var ho=Hs[_o];Ge.prototype[ho]||(Ge.prototype[ho]=he.prototype[ho])}function Ge(e){if(!(this instanceof Ge))return new Ge(e);ne.call(this,e),he.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",ff)}function ff(){this.allowHalfOpen||this._writableState.ended||ve(_f,this)}function _f(e){e.end()}un(He,Ge);function hf(e){this.afterTransform=function(t,n){var i=e._transformState;i.transforming=!1;var a=i.writecb;return a?(i.writechunk=null,i.writecb=null,n!=null&&e.push(n),a(t),t=e._readableState,t.reading=!1,(t.needReadable||t.length<t.highWaterMark)&&e._read(t.highWaterMark),t=void 0):t=e.emit("error",Error("no writecb in Transform class")),t},this.transforming=this.needTransform=!1,this.writeencoding=this.writechunk=this.writecb=null}function He(e){if(!(this instanceof He))return new He(e);Ge.call(this,e),this._transformState=new hf(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(n){Ws(t,n)}):Ws(t)})}He.prototype.push=function(e,t){return this._transformState.needTransform=!1,Ge.prototype.push.call(this,e,t)},He.prototype._transform=function(){throw Error("Not implemented")},He.prototype._write=function(e,t,n){var i=this._transformState;i.writecb=n,i.writechunk=e,i.writeencoding=t,i.transforming||(e=this._readableState,(i.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark))},He.prototype._read=function(){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};function Ws(e,t){if(t)return e.emit("error",t);if(t=e._transformState,e._writableState.length)throw Error("Calling transform done when ws.length != 0");if(t.transforming)throw Error("Calling transform done when still transforming");return e.push(null)}un(wi,He);function wi(e){if(!(this instanceof wi))return new wi(e);He.call(this,e)}wi.prototype._transform=function(e,t,n){n(null,e)},un(Be,qt),Be.Readable=ne,Be.Writable=he,Be.Duplex=Ge,Be.Transform=He,Be.PassThrough=wi,Be.Stream=Be;function Be(){qt.call(this)}Be.prototype.pipe=function(e,t){function n(l){e.writable&&e.write(l)===!1&&h.pause&&h.pause()}function i(){h.readable&&h.resume&&h.resume()}function a(){f||(f=!0,e.end())}function o(){f||(f=!0,typeof e.destroy=="function"&&e.destroy())}function s(l){if(d(),qt.listenerCount(this,"error")===0)throw l}function d(){h.removeListener("data",n),e.removeListener("drain",i),h.removeListener("end",a),h.removeListener("close",o),h.removeListener("error",s),e.removeListener("error",s),h.removeListener("end",d),h.removeListener("close",d),e.removeListener("close",d)}var h=this;h.on("data",n),e.on("drain",i),e._isStdio||t&&t.end===!1||(h.on("end",a),h.on("close",o));var f=!1;return h.on("error",s),e.on("error",s),h.on("end",d),h.on("close",d),e.on("close",d),e.emit("pipe",h),e};var gf=Array.prototype.slice,pf={extend:function e(t,n){for(var i in n)t[i]=n[i];return 3>arguments.length?t:e.apply(null,[t].concat(gf.call(arguments,2)))}},Ks=_e(function(e,t){function n(o,s,d){return d===void 0&&(d=function(h){return h}),function(){for(var h=[],f=0;f<arguments.length;f++)h[f]=arguments[f];return new Promise(function(l,m){o[s].bind(o).apply(void 0,i(h,[function(I,g){return I?m(I):l(d(g))}]))})}}var i=ae&&ae.__spreadArrays||function(){for(var o=0,s=0,d=arguments.length;s<d;s++)o+=arguments[s].length;o=Array(o);var h=0;for(s=0;s<d;s++)for(var f=arguments[s],l=0,m=f.length;l<m;l++,h++)o[h]=f[l];return o};Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function o(s,d){this.vol=s,this.fd=d}return o.prototype.appendFile=function(s,d){return n(this.vol,"appendFile")(this.fd,s,d)},o.prototype.chmod=function(s){return n(this.vol,"fchmod")(this.fd,s)},o.prototype.chown=function(s,d){return n(this.vol,"fchown")(this.fd,s,d)},o.prototype.close=function(){return n(this.vol,"close")(this.fd)},o.prototype.datasync=function(){return n(this.vol,"fdatasync")(this.fd)},o.prototype.read=function(s,d,h,f){return n(this.vol,"read",function(l){return{bytesRead:l,buffer:s}})(this.fd,s,d,h,f)},o.prototype.readFile=function(s){return n(this.vol,"readFile")(this.fd,s)},o.prototype.stat=function(s){return n(this.vol,"fstat")(this.fd,s)},o.prototype.sync=function(){return n(this.vol,"fsync")(this.fd)},o.prototype.truncate=function(s){return n(this.vol,"ftruncate")(this.fd,s)},o.prototype.utimes=function(s,d){return n(this.vol,"futimes")(this.fd,s,d)},o.prototype.write=function(s,d,h,f){return n(this.vol,"write",function(l){return{bytesWritten:l,buffer:s}})(this.fd,s,d,h,f)},o.prototype.writeFile=function(s,d){return n(this.vol,"writeFile")(this.fd,s,d)},o}();t.FileHandle=a,t.default=function(o){return typeof Promise>"u"?null:{FileHandle:a,access:function(s,d){return n(o,"access")(s,d)},appendFile:function(s,d,h){return n(o,"appendFile")(s instanceof a?s.fd:s,d,h)},chmod:function(s,d){return n(o,"chmod")(s,d)},chown:function(s,d,h){return n(o,"chown")(s,d,h)},copyFile:function(s,d,h){return n(o,"copyFile")(s,d,h)},lchmod:function(s,d){return n(o,"lchmod")(s,d)},lchown:function(s,d,h){return n(o,"lchown")(s,d,h)},link:function(s,d){return n(o,"link")(s,d)},lstat:function(s,d){return n(o,"lstat")(s,d)},mkdir:function(s,d){return n(o,"mkdir")(s,d)},mkdtemp:function(s,d){return n(o,"mkdtemp")(s,d)},open:function(s,d,h){return n(o,"open",function(f){return new a(o,f)})(s,d,h)},readdir:function(s,d){return n(o,"readdir")(s,d)},readFile:function(s,d){return n(o,"readFile")(s instanceof a?s.fd:s,d)},readlink:function(s,d){return n(o,"readlink")(s,d)},realpath:function(s,d){return n(o,"realpath")(s,d)},rename:function(s,d){return n(o,"rename")(s,d)},rmdir:function(s){return n(o,"rmdir")(s)},stat:function(s,d){return n(o,"stat")(s,d)},symlink:function(s,d,h){return n(o,"symlink")(s,d,h)},truncate:function(s,d){return n(o,"truncate")(s,d)},unlink:function(s){return n(o,"unlink")(s)},utimes:function(s,d,h){return n(o,"utimes")(s,d,h)},writeFile:function(s,d,h){return n(o,"writeFile")(s instanceof a?s.fd:s,d,h)}}}});Le(Ks);var mf=/[^\x20-\x7E]/,Lf=/[\x2E\u3002\uFF0E\uFF61]/g,Vs={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},$n=Math.floor,go=String.fromCharCode;function Af(e,t){var n=e.split("@"),i="";1<n.length&&(i=n[0]+"@",e=n[1]),e=e.replace(Lf,"."),e=e.split("."),n=e.length;for(var a=[];n--;)a[n]=t(e[n]);return t=a.join("."),i+t}function js(e,t){return e+22+75*(26>e)-((t!=0)<<5)}function yf(e){return Af(e,function(t){if(mf.test(t)){var n,i=[],a=[],o=0;for(n=t.length;o<n;){var s=t.charCodeAt(o++);if(55296<=s&&56319>=s&&o<n){var d=t.charCodeAt(o++);(d&64512)==56320?a.push(((s&1023)<<10)+(d&1023)+65536):(a.push(s),o--)}else a.push(s)}t=a,d=t.length,a=128;var h=0,f=72;for(s=0;s<d;++s){var l=t[s];128>l&&i.push(go(l))}for((o=n=i.length)&&i.push("-");o<d;){var m=2147483647;for(s=0;s<d;++s)l=t[s],l>=a&&l<m&&(m=l);var I=o+1;if(m-a>$n((2147483647-h)/I))throw new RangeError(Vs.overflow);for(h+=(m-a)*I,a=m,s=0;s<d;++s){if(l=t[s],l<a&&2147483647<++h)throw new RangeError(Vs.overflow);if(l==a){var g=h;for(m=36;l=m<=f?1:m>=f+26?26:m-f,!(g<l);m+=36){var B=g-l;g=36-l,i.push(go(js(l+B%g,0))),g=$n(B/g)}for(i.push(go(js(g,0))),f=I,m=0,h=o==n?$n(h/700):h>>1,h+=$n(h/f);455<h;m+=36)h=$n(h/35);f=$n(m+36*h/(h+38)),h=0,++o}}++h,++a}i="xn--"+i.join("")}else i=t;return i})}var Ys=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function Ii(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function wf(e,t,n,i){return t=t||"&",n=n||"=",e===null&&(e=void 0),typeof e=="object"?$s(If(e),function(a){var o=encodeURIComponent(Ii(a))+n;return Ys(e[a])?$s(e[a],function(s){return o+encodeURIComponent(Ii(s))}).join(t):o+encodeURIComponent(Ii(e[a]))}).join(t):i?encodeURIComponent(Ii(i))+n+encodeURIComponent(Ii(e)):""}function $s(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var If=Object.keys||function(e){var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t};function Zs(e,t,n,i){n=n||"=";var a={};if(typeof e!="string"||e.length===0)return a;var o=/\+/g;for(e=e.split(t||"&"),t=1e3,i&&typeof i.maxKeys=="number"&&(t=i.maxKeys),i=e.length,0<t&&i>t&&(i=t),t=0;t<i;++t){var s=e[t].replace(o,"%20"),d=s.indexOf(n);if(0<=d){var h=s.substr(0,d);s=s.substr(d+1)}else h=s,s="";h=decodeURIComponent(h),s=decodeURIComponent(s),Object.prototype.hasOwnProperty.call(a,h)?Ys(a[h])?a[h].push(s):a[h]=[a[h],s]:a[h]=s}return a}var Ef={parse:la,resolve:Pf,resolveObject:Of,format:Tf,Url:We};function We(){this.href=this.path=this.pathname=this.query=this.search=this.hash=this.hostname=this.port=this.host=this.auth=this.slashes=this.protocol=null}var bf=/^([a-z0-9.+-]+:)/i,Cf=/:[0-9]*$/,Sf=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Ff="{}|\\^`".split("").concat('<>"` \r\n	'.split("")),po=["'"].concat(Ff),Js=["%","/","?",";","#"].concat(po),Xs=["/","?","#"],vf=255,tc=/^[+a-z0-9A-Z_-]{0,63}$/,Bf=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,xf={javascript:!0,"javascript:":!0},mo={javascript:!0,"javascript:":!0},Zn={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function la(e,t,n){if(e&&fn(e)&&e instanceof We)return e;var i=new We;return i.parse(e,t,n),i}We.prototype.parse=function(e,t,n){return ec(this,e,t,n)};function ec(e,t,n,i){if(!vn(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var a=t.indexOf("?");if(a=a!==-1&&a<t.indexOf("#")?"?":"#",t=t.split(a),t[0]=t[0].replace(/\\/g,"/"),t=t.join(a),a=t.trim(),!i&&t.split("#").length===1&&(t=Sf.exec(a)))return e.path=a,e.href=a,e.pathname=t[1],t[2]?(e.search=t[2],e.query=n?Zs(e.search.substr(1)):e.search.substr(1)):n&&(e.search="",e.query={}),e;if(t=bf.exec(a)){t=t[0];var o=t.toLowerCase();e.protocol=o,a=a.substr(t.length)}if(i||t||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var s=a.substr(0,2)==="//";!s||t&&mo[t]||(a=a.substr(2),e.slashes=!0)}if(!mo[t]&&(s||t&&!Zn[t])){for(t=-1,i=0;i<Xs.length;i++)s=a.indexOf(Xs[i]),s!==-1&&(t===-1||s<t)&&(t=s);for(s=t===-1?a.lastIndexOf("@"):a.lastIndexOf("@",t),s!==-1&&(i=a.slice(0,s),a=a.slice(s+1),e.auth=decodeURIComponent(i)),t=-1,i=0;i<Js.length;i++)s=a.indexOf(Js[i]),s!==-1&&(t===-1||s<t)&&(t=s);if(t===-1&&(t=a.length),e.host=a.slice(0,t),a=a.slice(t),nc(e),e.hostname=e.hostname||"",s=e.hostname[0]==="["&&e.hostname[e.hostname.length-1]==="]",!s){var d=e.hostname.split(/\./);for(i=0,t=d.length;i<t;i++){var h=d[i];if(h&&!h.match(tc)){for(var f="",l=0,m=h.length;l<m;l++)f=127<h.charCodeAt(l)?f+"x":f+h[l];if(!f.match(tc)){t=d.slice(0,i),i=d.slice(i+1),(h=h.match(Bf))&&(t.push(h[1]),i.unshift(h[2])),i.length&&(a="/"+i.join(".")+a),e.hostname=t.join(".");break}}}}e.hostname=e.hostname.length>vf?"":e.hostname.toLowerCase(),s||(e.hostname=yf(e.hostname)),i=e.port?":"+e.port:"",e.host=(e.hostname||"")+i,e.href+=e.host,s&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!xf[o])for(i=0,t=po.length;i<t;i++)s=po[i],a.indexOf(s)!==-1&&(h=encodeURIComponent(s),h===s&&(h=escape(s)),a=a.split(s).join(h));return i=a.indexOf("#"),i!==-1&&(e.hash=a.substr(i),a=a.slice(0,i)),i=a.indexOf("?"),i!==-1?(e.search=a.substr(i),e.query=a.substr(i+1),n&&(e.query=Zs(e.query)),a=a.slice(0,i)):n&&(e.search="",e.query={}),a&&(e.pathname=a),Zn[o]&&e.hostname&&!e.pathname&&(e.pathname="/"),(e.pathname||e.search)&&(i=e.pathname||"",e.path=i+(e.search||"")),e.href=Lo(e),e}function Tf(e){return vn(e)&&(e=ec({},e)),Lo(e)}function Lo(e){var t=e.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var n=e.protocol||"",i=e.pathname||"",a=e.hash||"",o=!1,s="";return e.host?o=t+e.host:e.hostname&&(o=t+(e.hostname.indexOf(":")===-1?e.hostname:"["+this.hostname+"]"),e.port&&(o+=":"+e.port)),e.query&&fn(e.query)&&Object.keys(e.query).length&&(s=wf(e.query)),t=e.search||s&&"?"+s||"",n&&n.substr(-1)!==":"&&(n+=":"),e.slashes||(!n||Zn[n])&&o!==!1?(o="//"+(o||""),i&&i.charAt(0)!=="/"&&(i="/"+i)):o||(o=""),a&&a.charAt(0)!=="#"&&(a="#"+a),t&&t.charAt(0)!=="?"&&(t="?"+t),i=i.replace(/[?#]/g,function(d){return encodeURIComponent(d)}),t=t.replace("#","%23"),n+o+i+t+a}We.prototype.format=function(){return Lo(this)};function Pf(e,t){return la(e,!1,!0).resolve(t)}We.prototype.resolve=function(e){return this.resolveObject(la(e,!1,!0)).format()};function Of(e,t){return e?la(e,!1,!0).resolveObject(t):t}We.prototype.resolveObject=function(e){if(vn(e)){var t=new We;t.parse(e,!1,!0),e=t}t=new We;for(var n=Object.keys(this),i=0;i<n.length;i++){var a=n[i];t[a]=this[a]}if(t.hash=e.hash,e.href==="")return t.href=t.format(),t;if(e.slashes&&!e.protocol){for(n=Object.keys(e),i=0;i<n.length;i++)a=n[i],a!=="protocol"&&(t[a]=e[a]);return Zn[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t}var o;if(e.protocol&&e.protocol!==t.protocol){if(!Zn[e.protocol]){for(n=Object.keys(e),i=0;i<n.length;i++)a=n[i],t[a]=e[a];return t.href=t.format(),t}if(t.protocol=e.protocol,e.host||mo[e.protocol])t.pathname=e.pathname;else{for(o=(e.pathname||"").split("/");o.length&&!(e.host=o.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),o[0]!==""&&o.unshift(""),2>o.length&&o.unshift(""),t.pathname=o.join("/")}return t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,(t.pathname||t.search)&&(t.path=(t.pathname||"")+(t.search||"")),t.slashes=t.slashes||e.slashes,t.href=t.format(),t}n=t.pathname&&t.pathname.charAt(0)==="/";var s=e.host||e.pathname&&e.pathname.charAt(0)==="/",d=n=s||n||t.host&&e.pathname;if(i=t.pathname&&t.pathname.split("/")||[],a=t.protocol&&!Zn[t.protocol],o=e.pathname&&e.pathname.split("/")||[],a&&(t.hostname="",t.port=null,t.host&&(i[0]===""?i[0]=t.host:i.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(o[0]===""?o[0]=e.host:o.unshift(e.host)),e.host=null),n=n&&(o[0]===""||i[0]==="")),s)t.host=e.host||e.host===""?e.host:t.host,t.hostname=e.hostname||e.hostname===""?e.hostname:t.hostname,t.search=e.search,t.query=e.query,i=o;else if(o.length)i||(i=[]),i.pop(),i=i.concat(o),t.search=e.search,t.query=e.query;else if(e.search!=null)return a&&(t.hostname=t.host=i.shift(),a=t.host&&0<t.host.indexOf("@")?t.host.split("@"):!1)&&(t.auth=a.shift(),t.host=t.hostname=a.shift()),t.search=e.search,t.query=e.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t;if(!i.length)return t.pathname=null,t.path=t.search?"/"+t.search:null,t.href=t.format(),t;s=i.slice(-1)[0],o=(t.host||e.host||1<i.length)&&(s==="."||s==="..")||s==="";for(var h=0,f=i.length;0<=f;f--)s=i[f],s==="."?i.splice(f,1):s===".."?(i.splice(f,1),h++):h&&(i.splice(f,1),h--);if(!n&&!d)for(;h--;h)i.unshift("..");return!n||i[0]===""||i[0]&&i[0].charAt(0)==="/"||i.unshift(""),o&&i.join("/").substr(-1)!=="/"&&i.push(""),d=i[0]===""||i[0]&&i[0].charAt(0)==="/",a&&(t.hostname=t.host=d?"":i.length?i.shift():"",a=t.host&&0<t.host.indexOf("@")?t.host.split("@"):!1)&&(t.auth=a.shift(),t.host=t.hostname=a.shift()),(n=n||t.host&&i.length)&&!d&&i.unshift(""),i.length?t.pathname=i.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes,t.href=t.format(),t},We.prototype.parseHost=function(){return nc(this)};function nc(e){var t=e.host,n=Cf.exec(t);n&&(n=n[0],n!==":"&&(e.port=n.substr(1)),t=t.substr(0,t.length-n.length)),t&&(e.hostname=t)}var ic=_e(function(e,t){function n(o,s){return o=o[s],0<s&&(o==="/"||a&&o==="\\")}function i(o){var s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0;if(a){var d=o;if(typeof d!="string")throw new TypeError("expected a string");if(d=d.replace(/[\\\/]+/g,"/"),s!==!1)if(s=d,d=s.length-1,2>d)d=s;else{for(;n(s,d);)d--;d=s.substr(0,d+1)}return d.replace(/^([a-zA-Z]+:|\.\/)/,"")}return o}Object.defineProperty(t,"__esModule",{value:!0}),t.unixify=i,t.correctPath=function(o){return i(o.replace(/^\\\\\?\\.:\\/,"\\"))};var a=Wn.platform==="win32"});Le(ic);var xn=_e(function(e,t){function n(E,r){return r===void 0&&(r=Ae.default.cwd()),j(r,E)}function i(E,r){return typeof E=="function"?[a(),E]:[a(E),m(r)]}function a(E){return E===void 0&&(E={}),D({},Kt,E)}function o(E){return typeof E=="number"?D({},Et,{mode:E}):D({},Et,E)}function s(E,r,c,y){r===void 0&&(r=""),c===void 0&&(c=""),y===void 0&&(y="");var S="";switch(c&&(S=" '"+c+"'"),y&&(S+=" -> '"+y+"'"),E){case"ENOENT":return"ENOENT: no such file or directory, "+r+S;case"EBADF":return"EBADF: bad file descriptor, "+r+S;case"EINVAL":return"EINVAL: invalid argument, "+r+S;case"EPERM":return"EPERM: operation not permitted, "+r+S;case"EPROTO":return"EPROTO: protocol error, "+r+S;case"EEXIST":return"EEXIST: file already exists, "+r+S;case"ENOTDIR":return"ENOTDIR: not a directory, "+r+S;case"EISDIR":return"EISDIR: illegal operation on a directory, "+r+S;case"EACCES":return"EACCES: permission denied, "+r+S;case"ENOTEMPTY":return"ENOTEMPTY: directory not empty, "+r+S;case"EMFILE":return"EMFILE: too many open files, "+r+S;case"ENOSYS":return"ENOSYS: function not implemented, "+r+S;default:return E+": error occurred, "+r+S}}function d(E,r,c,y,S){return r===void 0&&(r=""),c===void 0&&(c=""),y===void 0&&(y=""),S===void 0&&(S=Error),r=new S(s(E,r,c,y)),r.code=E,r}function h(E){if(typeof E=="number")return E;if(typeof E=="string"){var r=k[E];if(typeof r<"u")return r}throw new mi.TypeError("ERR_INVALID_OPT_VALUE","flags",E)}function f(E,r){if(r){var c=typeof r;switch(c){case"string":E=D({},E,{encoding:r});break;case"object":E=D({},E,r);break;default:throw TypeError("Expected options to be either an object or a string, but got "+c+" instead")}}else return E;return E.encoding!=="buffer"&&Ue.assertEncoding(E.encoding),E}function l(E){return function(r){return f(E,r)}}function m(E){if(typeof E!="function")throw TypeError(w.CB);return E}function I(E){return function(r,c){return typeof r=="function"?[E(),r]:[E(r),m(c)]}}function g(E){if(typeof E!="string"&&!Xt.Buffer.isBuffer(E)){try{if(!(E instanceof Ef.URL))throw new TypeError(w.PATH_STR)}catch{throw new TypeError(w.PATH_STR)}if(E.hostname!=="")throw new mi.TypeError("ERR_INVALID_FILE_URL_HOST",Ae.default.platform);E=E.pathname;for(var r=0;r<E.length;r++)if(E[r]==="%"){var c=E.codePointAt(r+2)|32;if(E[r+1]==="2"&&c===102)throw new mi.TypeError("ERR_INVALID_FILE_URL_PATH","must not include encoded / characters")}E=decodeURIComponent(E)}return E=String(E),T(E),E}function B(E,r){return(E=n(E,r).substr(1))?E.split(_):[]}function P(E){return B(g(E))}function C(E,r){return r===void 0&&(r=Ue.ENCODING_UTF8),Xt.Buffer.isBuffer(E)?E:E instanceof Uint8Array?Xt.bufferFrom(E):Xt.bufferFrom(String(E),r)}function N(E,r){return r&&r!=="buffer"?E.toString(r):E}function T(E,r){if((""+E).indexOf("\0")!==-1){if(E=Error("Path must be a string without null bytes"),E.code="ENOENT",typeof r!="function")throw E;return Ae.default.nextTick(r,E),!1}return!0}function K(E,r){if(E=typeof E=="number"?E:typeof E=="string"?parseInt(E,8):r?K(r):void 0,typeof E!="number"||isNaN(E))throw new TypeError(w.MODE_INT);return E}function M(E){if(E>>>0!==E)throw TypeError(w.FD)}function V(E){if(typeof E=="string"&&+E==E)return+E;if(E instanceof Date)return E.getTime()/1e3;if(isFinite(E))return 0>E?Date.now()/1e3:E;throw Error("Cannot parse time: "+E)}function v(E){if(typeof E!="number")throw TypeError(w.UID)}function p(E){if(typeof E!="number")throw TypeError(w.GID)}function L(E){E.emit("stop")}function U(E,r,c){if(!(this instanceof U))return new U(E,r,c);if(this._vol=E,c=D({},f(c,{})),c.highWaterMark===void 0&&(c.highWaterMark=65536),Be.Readable.call(this,c),this.path=g(r),this.fd=c.fd===void 0?null:c.fd,this.flags=c.flags===void 0?"r":c.flags,this.mode=c.mode===void 0?438:c.mode,this.start=c.start,this.end=c.end,this.autoClose=c.autoClose===void 0?!0:c.autoClose,this.pos=void 0,this.bytesRead=0,this.start!==void 0){if(typeof this.start!="number")throw new TypeError('"start" option must be a Number');if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw new TypeError('"end" option must be a Number');if(this.start>this.end)throw Error('"start" option must be <= "end" option');this.pos=this.start}typeof this.fd!="number"&&this.open(),this.on("end",function(){this.autoClose&&this.destroy&&this.destroy()})}function q(){this.close()}function O(E,r,c){if(!(this instanceof O))return new O(E,r,c);if(this._vol=E,c=D({},f(c,{})),Be.Writable.call(this,c),this.path=g(r),this.fd=c.fd===void 0?null:c.fd,this.flags=c.flags===void 0?"w":c.flags,this.mode=c.mode===void 0?438:c.mode,this.start=c.start,this.autoClose=c.autoClose===void 0?!0:!!c.autoClose,this.pos=void 0,this.bytesWritten=0,this.start!==void 0){if(typeof this.start!="number")throw new TypeError('"start" option must be a Number');if(0>this.start)throw Error('"start" must be >= zero');this.pos=this.start}c.encoding&&this.setDefaultEncoding(c.encoding),typeof this.fd!="number"&&this.open(),this.once("finish",function(){this.autoClose&&this.close()})}var R=ae&&ae.__extends||function(){function E(r,c){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,S){y.__proto__=S}||function(y,S){for(var x in S)S.hasOwnProperty(x)&&(y[x]=S[x])},E(r,c)}return function(r,c){function y(){this.constructor=r}E(r,c),r.prototype=c===null?Object.create(c):(y.prototype=c.prototype,new y)}}(),b=ae&&ae.__spreadArrays||function(){for(var E=0,r=0,c=arguments.length;r<c;r++)E+=arguments[r].length;E=Array(E);var y=0;for(r=0;r<c;r++)for(var S=arguments[r],x=0,z=S.length;x<z;x++,y++)E[y]=S[x];return E};Object.defineProperty(t,"__esModule",{value:!0});var D=pf.extend,j=ro.resolve,J=zt.constants.O_RDONLY,tt=zt.constants.O_WRONLY,$=zt.constants.O_RDWR,et=zt.constants.O_CREAT,X=zt.constants.O_EXCL,dt=zt.constants.O_TRUNC,rt=zt.constants.O_APPEND,mt=zt.constants.O_SYNC,gt=zt.constants.O_DIRECTORY,A=zt.constants.F_OK,u=zt.constants.COPYFILE_EXCL,F=zt.constants.COPYFILE_FICLONE_FORCE,_=ro.sep,Q=ro.relative,G=Ae.default.platform==="win32",w={PATH_STR:"path must be a string or Buffer",FD:"fd must be a file descriptor",MODE_INT:"mode must be an int",CB:"callback must be a function",UID:"uid must be an unsigned int",GID:"gid must be an unsigned int",LEN:"len must be an integer",ATIME:"atime must be an integer",MTIME:"mtime must be an integer",PREFIX:"filename prefix is required",BUFFER:"buffer must be an instance of Buffer or StaticBuffer",OFFSET:"offset must be an integer",LENGTH:"length must be an integer",POSITION:"position must be an integer"},k;(function(E){E[E.r=J]="r",E[E["r+"]=$]="r+",E[E.rs=J|mt]="rs",E[E.sr=E.rs]="sr",E[E["rs+"]=$|mt]="rs+",E[E["sr+"]=E["rs+"]]="sr+",E[E.w=tt|et|dt]="w",E[E.wx=tt|et|dt|X]="wx",E[E.xw=E.wx]="xw",E[E["w+"]=$|et|dt]="w+",E[E["wx+"]=$|et|dt|X]="wx+",E[E["xw+"]=E["wx+"]]="xw+",E[E.a=tt|rt|et]="a",E[E.ax=tt|rt|et|X]="ax",E[E.xa=E.ax]="xa",E[E["a+"]=$|rt|et]="a+",E[E["ax+"]=$|rt|et|X]="ax+",E[E["xa+"]=E["ax+"]]="xa+"})(k=t.FLAGS||(t.FLAGS={})),t.flagsToNumber=h,e={encoding:"utf8"};var ot=l(e),Y=I(ot),nt=l({flag:"r"}),ft={encoding:"utf8",mode:438,flag:k[k.w]},Lt=l(ft),At={encoding:"utf8",mode:438,flag:k[k.a]},ht=l(At),ct=I(ht),_t=l(e),wt=I(_t),Et={mode:511,recursive:!1},Tt={recursive:!1},Nt=l({encoding:"utf8",withFileTypes:!1}),kt=I(Nt),Kt={bigint:!1};if(t.pathToFilename=g,G){var Mt=n,bt=ic.unixify;n=function(E,r){return bt(Mt(E,r))}}t.filenameToSteps=B,t.pathToSteps=P,t.dataToStr=function(E,r){return r===void 0&&(r=Ue.ENCODING_UTF8),Xt.Buffer.isBuffer(E)?E.toString(r):E instanceof Uint8Array?Xt.bufferFrom(E).toString(r):String(E)},t.dataToBuffer=C,t.bufferToEncoding=N,t.toUnixTimestamp=V,e=function(){function E(r){r===void 0&&(r={}),this.ino=0,this.inodes={},this.releasedInos=[],this.fds={},this.releasedFds=[],this.maxFiles=1e4,this.openFiles=0,this.promisesApi=Ks.default(this),this.statWatchers={},this.props=D({Node:Ai.Node,Link:Ai.Link,File:Ai.File},r),r=this.createLink(),r.setNode(this.createNode(!0));var c=this;this.StatWatcher=function(y){function S(){return y.call(this,c)||this}return R(S,y),S}(Ht),this.ReadStream=function(y){function S(){for(var x=[],z=0;z<arguments.length;z++)x[z]=arguments[z];return y.apply(this,b([c],x))||this}return R(S,y),S}(U),this.WriteStream=function(y){function S(){for(var x=[],z=0;z<arguments.length;z++)x[z]=arguments[z];return y.apply(this,b([c],x))||this}return R(S,y),S}(O),this.FSWatcher=function(y){function S(){return y.call(this,c)||this}return R(S,y),S}(Yt),this.root=r}return E.fromJSON=function(r,c){var y=new E;return y.fromJSON(r,c),y},Object.defineProperty(E.prototype,"promises",{get:function(){if(this.promisesApi===null)throw Error("Promise is not supported in this environment.");return this.promisesApi},enumerable:!0,configurable:!0}),E.prototype.createLink=function(r,c,y,S){if(y===void 0&&(y=!1),!r)return new this.props.Link(this,null,"");if(!c)throw Error("createLink: name cannot be empty");return r.createChild(c,this.createNode(y,S))},E.prototype.deleteLink=function(r){var c=r.parent;return c?(c.deleteChild(r),!0):!1},E.prototype.newInoNumber=function(){var r=this.releasedInos.pop();return r||(this.ino=(this.ino+1)%4294967295)},E.prototype.newFdNumber=function(){var r=this.releasedFds.pop();return typeof r=="number"?r:E.fd--},E.prototype.createNode=function(r,c){return r===void 0&&(r=!1),c=new this.props.Node(this.newInoNumber(),c),r&&c.setIsDirectory(),this.inodes[c.ino]=c},E.prototype.getNode=function(r){return this.inodes[r]},E.prototype.deleteNode=function(r){r.del(),delete this.inodes[r.ino],this.releasedInos.push(r.ino)},E.prototype.genRndStr=function(){var r=(Math.random()+1).toString(36).substr(2,6);return r.length===6?r:this.genRndStr()},E.prototype.getLink=function(r){return this.root.walk(r)},E.prototype.getLinkOrThrow=function(r,c){var y=B(r);if(y=this.getLink(y),!y)throw d("ENOENT",c,r);return y},E.prototype.getResolvedLink=function(r){r=typeof r=="string"?B(r):r;for(var c=this.root,y=0;y<r.length;){if(c=c.getChild(r[y]),!c)return null;var S=c.getNode();S.isSymlink()?(r=S.symlink.concat(r.slice(y+1)),c=this.root,y=0):y++}return c},E.prototype.getResolvedLinkOrThrow=function(r,c){var y=this.getResolvedLink(r);if(!y)throw d("ENOENT",c,r);return y},E.prototype.resolveSymlinks=function(r){return this.getResolvedLink(r.steps.slice(1))},E.prototype.getLinkAsDirOrThrow=function(r,c){var y=this.getLinkOrThrow(r,c);if(!y.getNode().isDirectory())throw d("ENOTDIR",c,r);return y},E.prototype.getLinkParent=function(r){return this.root.walk(r,r.length-1)},E.prototype.getLinkParentAsDirOrThrow=function(r,c){r=r instanceof Array?r:B(r);var y=this.getLinkParent(r);if(!y)throw d("ENOENT",c,_+r.join(_));if(!y.getNode().isDirectory())throw d("ENOTDIR",c,_+r.join(_));return y},E.prototype.getFileByFd=function(r){return this.fds[String(r)]},E.prototype.getFileByFdOrThrow=function(r,c){if(r>>>0!==r)throw TypeError(w.FD);if(r=this.getFileByFd(r),!r)throw d("EBADF",c);return r},E.prototype.getNodeByIdOrCreate=function(r,c,y){if(typeof r=="number"){if(r=this.getFileByFd(r),!r)throw Error("File nto found");return r.node}var S=P(r),x=this.getLink(S);if(x)return x.getNode();if(c&et&&(c=this.getLinkParent(S)))return x=this.createLink(c,S[S.length-1],!1,y),x.getNode();throw d("ENOENT","getNodeByIdOrCreate",g(r))},E.prototype.wrapAsync=function(r,c,y){var S=this;m(y),Yn.default(function(){try{y(null,r.apply(S,c))}catch(x){y(x)}})},E.prototype._toJSON=function(r,c,y){var S;r===void 0&&(r=this.root),c===void 0&&(c={});var x=!0,z=r.children;r.getNode().isFile()&&(z=(S={},S[r.getName()]=r.parent.getChild(r.getName()),S),r=r.parent);for(var W in z){if(x=!1,z=r.getChild(W),!z)throw Error("_toJSON: unexpected undefined");S=z.getNode(),S.isFile()?(z=z.getPath(),y&&(z=Q(y,z)),c[z]=S.getString()):S.isDirectory()&&this._toJSON(z,c,y)}return r=r.getPath(),y&&(r=Q(y,r)),r&&x&&(c[r]=null),c},E.prototype.toJSON=function(r,c,y){c===void 0&&(c={}),y===void 0&&(y=!1);var S=[];if(r){r instanceof Array||(r=[r]);for(var x=0;x<r.length;x++){var z=g(r[x]);(z=this.getResolvedLink(z))&&S.push(z)}}else S.push(this.root);if(!S.length)return c;for(x=0;x<S.length;x++)z=S[x],this._toJSON(z,c,y?z.getPath():"");return c},E.prototype.fromJSON=function(r,c){c===void 0&&(c=Ae.default.cwd());for(var y in r){var S=r[y];if(typeof S=="string"){y=n(y,c);var x=B(y);1<x.length&&(x=_+x.slice(0,x.length-1).join(_),this.mkdirpBase(x,511)),this.writeFileSync(y,S)}else this.mkdirpBase(y,511)}},E.prototype.reset=function(){this.ino=0,this.inodes={},this.releasedInos=[],this.fds={},this.releasedFds=[],this.openFiles=0,this.root=this.createLink(),this.root.setNode(this.createNode(!0))},E.prototype.mountSync=function(r,c){this.fromJSON(c,r)},E.prototype.openLink=function(r,c,y){if(y===void 0&&(y=!0),this.openFiles>=this.maxFiles)throw d("EMFILE","open",r.getPath());var S=r;if(y&&(S=this.resolveSymlinks(r)),!S)throw d("ENOENT","open",r.getPath());if(y=S.getNode(),y.isDirectory()){if((c&(J|$|tt))!==J)throw d("EISDIR","open",r.getPath())}else if(c&gt)throw d("ENOTDIR","open",r.getPath());if(!(c&tt||y.canRead()))throw d("EACCES","open",r.getPath());return r=new this.props.File(r,y,c,this.newFdNumber()),this.fds[r.fd]=r,this.openFiles++,c&dt&&r.truncate(),r},E.prototype.openFile=function(r,c,y,S){S===void 0&&(S=!0);var x=B(r),z=S?this.getResolvedLink(x):this.getLink(x);if(!z&&c&et){var W=this.getResolvedLink(x.slice(0,x.length-1));if(!W)throw d("ENOENT","open",_+x.join(_));c&et&&typeof y=="number"&&(z=this.createLink(W,x[x.length-1],!1,y))}if(z)return this.openLink(z,c,S);throw d("ENOENT","open",r)},E.prototype.openBase=function(r,c,y,S){if(S===void 0&&(S=!0),c=this.openFile(r,c,y,S),!c)throw d("ENOENT","open",r);return c.fd},E.prototype.openSync=function(r,c,y){return y===void 0&&(y=438),y=K(y),r=g(r),c=h(c),this.openBase(r,c,y)},E.prototype.open=function(r,c,y,S){var x=y;typeof y=="function"&&(x=438,S=y),y=K(x||438),r=g(r),c=h(c),this.wrapAsync(this.openBase,[r,c,y],S)},E.prototype.closeFile=function(r){this.fds[r.fd]&&(this.openFiles--,delete this.fds[r.fd],this.releasedFds.push(r.fd))},E.prototype.closeSync=function(r){M(r),r=this.getFileByFdOrThrow(r,"close"),this.closeFile(r)},E.prototype.close=function(r,c){M(r),this.wrapAsync(this.closeSync,[r],c)},E.prototype.openFileOrGetById=function(r,c,y){if(typeof r=="number"){if(r=this.fds[r],!r)throw d("ENOENT");return r}return this.openFile(g(r),c,y)},E.prototype.readBase=function(r,c,y,S,x){return this.getFileByFdOrThrow(r).read(c,Number(y),Number(S),x)},E.prototype.readSync=function(r,c,y,S,x){return M(r),this.readBase(r,c,y,S,x)},E.prototype.read=function(r,c,y,S,x,z){var W=this;if(m(z),S===0)return Ae.default.nextTick(function(){z&&z(null,0,c)});Yn.default(function(){try{var Z=W.readBase(r,c,y,S,x);z(null,Z,c)}catch(at){z(at)}})},E.prototype.readFileBase=function(r,c,y){var S=typeof r=="number"&&r>>>0===r;if(!S){var x=g(r);if(x=B(x),(x=this.getResolvedLink(x))&&x.getNode().isDirectory())throw d("EISDIR","open",x.getPath());r=this.openSync(r,c)}try{var z=N(this.getFileByFdOrThrow(r).getBuffer(),y)}finally{S||this.closeSync(r)}return z},E.prototype.readFileSync=function(r,c){c=nt(c);var y=h(c.flag);return this.readFileBase(r,y,c.encoding)},E.prototype.readFile=function(r,c,y){y=I(nt)(c,y),c=y[0],y=y[1];var S=h(c.flag);this.wrapAsync(this.readFileBase,[r,S,c.encoding],y)},E.prototype.writeBase=function(r,c,y,S,x){return this.getFileByFdOrThrow(r,"write").write(c,y,S,x)},E.prototype.writeSync=function(r,c,y,S,x){M(r);var z=typeof c!="string";if(z){var W=(y||0)|0,Z=S;y=x}else var at=S;return c=C(c,at),z?typeof Z>"u"&&(Z=c.length):(W=0,Z=c.length),this.writeBase(r,c,W,Z,y)},E.prototype.write=function(r,c,y,S,x,z){var W=this;M(r);var Z=typeof c,at=typeof y,st=typeof S,it=typeof x;if(Z!=="string")if(at==="function")var ut=y;else if(st==="function"){var Ct=y|0;ut=S}else if(it==="function"){Ct=y|0;var It=S;ut=x}else{Ct=y|0,It=S;var yt=x;ut=z}else if(at==="function")ut=y;else if(st==="function")yt=y,ut=S;else if(it==="function"){yt=y;var Ft=S;ut=x}var vt=C(c,Ft);Z!=="string"?typeof It>"u"&&(It=vt.length):(Ct=0,It=vt.length);var Dt=m(ut);Yn.default(function(){try{var Bt=W.writeBase(r,vt,Ct,It,yt);Z!=="string"?Dt(null,Bt,vt):Dt(null,Bt,c)}catch(xt){Dt(xt)}})},E.prototype.writeFileBase=function(r,c,y,S){var x=typeof r=="number";r=x?r:this.openBase(g(r),y,S),S=0;var z=c.length;y=y&rt?void 0:0;try{for(;0<z;){var W=this.writeSync(r,c,S,z,y);S+=W,z-=W,y!==void 0&&(y+=W)}}finally{x||this.closeSync(r)}},E.prototype.writeFileSync=function(r,c,y){var S=Lt(y);y=h(S.flag);var x=K(S.mode);c=C(c,S.encoding),this.writeFileBase(r,c,y,x)},E.prototype.writeFile=function(r,c,y,S){var x=y;typeof y=="function"&&(x=ft,S=y),y=m(S);var z=Lt(x);x=h(z.flag),S=K(z.mode),c=C(c,z.encoding),this.wrapAsync(this.writeFileBase,[r,c,x,S],y)},E.prototype.linkBase=function(r,c){var y=B(r),S=this.getLink(y);if(!S)throw d("ENOENT","link",r,c);var x=B(c);if(y=this.getLinkParent(x),!y)throw d("ENOENT","link",r,c);if(x=x[x.length-1],y.getChild(x))throw d("EEXIST","link",r,c);r=S.getNode(),r.nlink++,y.createChild(x,r)},E.prototype.copyFileBase=function(r,c,y){var S=this.readFileSync(r);if(y&u&&this.existsSync(c))throw d("EEXIST","copyFile",r,c);if(y&F)throw d("ENOSYS","copyFile",r,c);this.writeFileBase(c,S,k.w,438)},E.prototype.copyFileSync=function(r,c,y){return r=g(r),c=g(c),this.copyFileBase(r,c,(y||0)|0)},E.prototype.copyFile=function(r,c,y,S){if(r=g(r),c=g(c),typeof y=="function")var x=0;else x=y,y=S;m(y),this.wrapAsync(this.copyFileBase,[r,c,x],y)},E.prototype.linkSync=function(r,c){r=g(r),c=g(c),this.linkBase(r,c)},E.prototype.link=function(r,c,y){r=g(r),c=g(c),this.wrapAsync(this.linkBase,[r,c],y)},E.prototype.unlinkBase=function(r){var c=B(r);if(c=this.getLink(c),!c)throw d("ENOENT","unlink",r);if(c.length)throw Error("Dir not empty...");this.deleteLink(c),r=c.getNode(),r.nlink--,0>=r.nlink&&this.deleteNode(r)},E.prototype.unlinkSync=function(r){r=g(r),this.unlinkBase(r)},E.prototype.unlink=function(r,c){r=g(r),this.wrapAsync(this.unlinkBase,[r],c)},E.prototype.symlinkBase=function(r,c){var y=B(c),S=this.getLinkParent(y);if(!S)throw d("ENOENT","symlink",r,c);if(y=y[y.length-1],S.getChild(y))throw d("EEXIST","symlink",r,c);return c=S.createChild(y),c.getNode().makeSymlink(B(r)),c},E.prototype.symlinkSync=function(r,c){r=g(r),c=g(c),this.symlinkBase(r,c)},E.prototype.symlink=function(r,c,y,S){y=m(typeof y=="function"?y:S),r=g(r),c=g(c),this.wrapAsync(this.symlinkBase,[r,c],y)},E.prototype.realpathBase=function(r,c){var y=B(r);if(y=this.getResolvedLink(y),!y)throw d("ENOENT","realpath",r);return Ue.strToEncoding(y.getPath(),c)},E.prototype.realpathSync=function(r,c){return this.realpathBase(g(r),_t(c).encoding)},E.prototype.realpath=function(r,c,y){y=wt(c,y),c=y[0],y=y[1],r=g(r),this.wrapAsync(this.realpathBase,[r,c.encoding],y)},E.prototype.lstatBase=function(r,c){c===void 0&&(c=!1);var y=this.getLink(B(r));if(!y)throw d("ENOENT","lstat",r);return qn.default.build(y.getNode(),c)},E.prototype.lstatSync=function(r,c){return this.lstatBase(g(r),a(c).bigint)},E.prototype.lstat=function(r,c,y){y=i(c,y),c=y[0],y=y[1],this.wrapAsync(this.lstatBase,[g(r),c.bigint],y)},E.prototype.statBase=function(r,c){c===void 0&&(c=!1);var y=this.getResolvedLink(B(r));if(!y)throw d("ENOENT","stat",r);return qn.default.build(y.getNode(),c)},E.prototype.statSync=function(r,c){return this.statBase(g(r),a(c).bigint)},E.prototype.stat=function(r,c,y){y=i(c,y),c=y[0],y=y[1],this.wrapAsync(this.statBase,[g(r),c.bigint],y)},E.prototype.fstatBase=function(r,c){if(c===void 0&&(c=!1),r=this.getFileByFd(r),!r)throw d("EBADF","fstat");return qn.default.build(r.node,c)},E.prototype.fstatSync=function(r,c){return this.fstatBase(r,a(c).bigint)},E.prototype.fstat=function(r,c,y){c=i(c,y),this.wrapAsync(this.fstatBase,[r,c[0].bigint],c[1])},E.prototype.renameBase=function(r,c){var y=this.getLink(B(r));if(!y)throw d("ENOENT","rename",r,c);var S=B(c),x=this.getLinkParent(S);if(!x)throw d("ENOENT","rename",r,c);(r=y.parent)&&r.deleteChild(y),y.steps=b(x.steps,[S[S.length-1]]),x.setChild(y.getName(),y)},E.prototype.renameSync=function(r,c){r=g(r),c=g(c),this.renameBase(r,c)},E.prototype.rename=function(r,c,y){r=g(r),c=g(c),this.wrapAsync(this.renameBase,[r,c],y)},E.prototype.existsBase=function(r){return!!this.statBase(r)},E.prototype.existsSync=function(r){try{return this.existsBase(g(r))}catch{return!1}},E.prototype.exists=function(r,c){var y=this,S=g(r);if(typeof c!="function")throw Error(w.CB);Yn.default(function(){try{c(y.existsBase(S))}catch{c(!1)}})},E.prototype.accessBase=function(r){this.getLinkOrThrow(r,"access")},E.prototype.accessSync=function(r,c){c===void 0&&(c=A),r=g(r),this.accessBase(r,c|0)},E.prototype.access=function(r,c,y){var S=A;typeof c!="function"&&(S=c|0,c=m(y)),r=g(r),this.wrapAsync(this.accessBase,[r,S],c)},E.prototype.appendFileSync=function(r,c,y){y===void 0&&(y=At),y=ht(y),y.flag&&r>>>0!==r||(y.flag="a"),this.writeFileSync(r,c,y)},E.prototype.appendFile=function(r,c,y,S){S=ct(y,S),y=S[0],S=S[1],y.flag&&r>>>0!==r||(y.flag="a"),this.writeFile(r,c,y,S)},E.prototype.readdirBase=function(r,c){var y=B(r);if(y=this.getResolvedLink(y),!y)throw d("ENOENT","readdir",r);if(!y.getNode().isDirectory())throw d("ENOTDIR","scandir",r);if(c.withFileTypes){var S=[];for(x in y.children)(r=y.getChild(x))&&S.push(no.default.build(r,c.encoding));return G||c.encoding==="buffer"||S.sort(function(z,W){return z.name<W.name?-1:z.name>W.name?1:0}),S}var x=[];for(S in y.children)x.push(Ue.strToEncoding(S,c.encoding));return G||c.encoding==="buffer"||x.sort(),x},E.prototype.readdirSync=function(r,c){return c=Nt(c),r=g(r),this.readdirBase(r,c)},E.prototype.readdir=function(r,c,y){y=kt(c,y),c=y[0],y=y[1],r=g(r),this.wrapAsync(this.readdirBase,[r,c],y)},E.prototype.readlinkBase=function(r,c){var y=this.getLinkOrThrow(r,"readlink").getNode();if(!y.isSymlink())throw d("EINVAL","readlink",r);return r=_+y.symlink.join(_),Ue.strToEncoding(r,c)},E.prototype.readlinkSync=function(r,c){return c=ot(c),r=g(r),this.readlinkBase(r,c.encoding)},E.prototype.readlink=function(r,c,y){y=Y(c,y),c=y[0],y=y[1],r=g(r),this.wrapAsync(this.readlinkBase,[r,c.encoding],y)},E.prototype.fsyncBase=function(r){this.getFileByFdOrThrow(r,"fsync")},E.prototype.fsyncSync=function(r){this.fsyncBase(r)},E.prototype.fsync=function(r,c){this.wrapAsync(this.fsyncBase,[r],c)},E.prototype.fdatasyncBase=function(r){this.getFileByFdOrThrow(r,"fdatasync")},E.prototype.fdatasyncSync=function(r){this.fdatasyncBase(r)},E.prototype.fdatasync=function(r,c){this.wrapAsync(this.fdatasyncBase,[r],c)},E.prototype.ftruncateBase=function(r,c){this.getFileByFdOrThrow(r,"ftruncate").truncate(c)},E.prototype.ftruncateSync=function(r,c){this.ftruncateBase(r,c)},E.prototype.ftruncate=function(r,c,y){var S=typeof c=="number"?c:0;c=m(typeof c=="number"?y:c),this.wrapAsync(this.ftruncateBase,[r,S],c)},E.prototype.truncateBase=function(r,c){r=this.openSync(r,"r+");try{this.ftruncateSync(r,c)}finally{this.closeSync(r)}},E.prototype.truncateSync=function(r,c){if(r>>>0===r)return this.ftruncateSync(r,c);this.truncateBase(r,c)},E.prototype.truncate=function(r,c,y){var S=typeof c=="number"?c:0;if(c=m(typeof c=="number"?y:c),r>>>0===r)return this.ftruncate(r,S,c);this.wrapAsync(this.truncateBase,[r,S],c)},E.prototype.futimesBase=function(r,c,y){r=this.getFileByFdOrThrow(r,"futimes").node,r.atime=new Date(1e3*c),r.mtime=new Date(1e3*y)},E.prototype.futimesSync=function(r,c,y){this.futimesBase(r,V(c),V(y))},E.prototype.futimes=function(r,c,y,S){this.wrapAsync(this.futimesBase,[r,V(c),V(y)],S)},E.prototype.utimesBase=function(r,c,y){r=this.openSync(r,"r+");try{this.futimesBase(r,c,y)}finally{this.closeSync(r)}},E.prototype.utimesSync=function(r,c,y){this.utimesBase(g(r),V(c),V(y))},E.prototype.utimes=function(r,c,y,S){this.wrapAsync(this.utimesBase,[g(r),V(c),V(y)],S)},E.prototype.mkdirBase=function(r,c){var y=B(r);if(!y.length)throw d("EISDIR","mkdir",r);var S=this.getLinkParentAsDirOrThrow(r,"mkdir");if(y=y[y.length-1],S.getChild(y))throw d("EEXIST","mkdir",r);S.createChild(y,this.createNode(!0,c))},E.prototype.mkdirpBase=function(r,c){r=B(r);for(var y=this.root,S=0;S<r.length;S++){var x=r[S];if(!y.getNode().isDirectory())throw d("ENOTDIR","mkdir",y.getPath());var z=y.getChild(x);if(z)if(z.getNode().isDirectory())y=z;else throw d("ENOTDIR","mkdir",z.getPath());else y=y.createChild(x,this.createNode(!0,c))}},E.prototype.mkdirSync=function(r,c){c=o(c);var y=K(c.mode,511);r=g(r),c.recursive?this.mkdirpBase(r,y):this.mkdirBase(r,y)},E.prototype.mkdir=function(r,c,y){var S=o(c);c=m(typeof c=="function"?c:y),y=K(S.mode,511),r=g(r),S.recursive?this.wrapAsync(this.mkdirpBase,[r,y],c):this.wrapAsync(this.mkdirBase,[r,y],c)},E.prototype.mkdirpSync=function(r,c){this.mkdirSync(r,{mode:c,recursive:!0})},E.prototype.mkdirp=function(r,c,y){var S=typeof c=="function"?void 0:c;c=m(typeof c=="function"?c:y),this.mkdir(r,{mode:S,recursive:!0},c)},E.prototype.mkdtempBase=function(r,c,y){y===void 0&&(y=5);var S=r+this.genRndStr();try{return this.mkdirBase(S,511),Ue.strToEncoding(S,c)}catch(x){if(x.code==="EEXIST"){if(1<y)return this.mkdtempBase(r,c,y-1);throw Error("Could not create temp dir.")}throw x}},E.prototype.mkdtempSync=function(r,c){if(c=ot(c).encoding,!r||typeof r!="string")throw new TypeError("filename prefix is required");return T(r),this.mkdtempBase(r,c)},E.prototype.mkdtemp=function(r,c,y){if(y=Y(c,y),c=y[0].encoding,y=y[1],!r||typeof r!="string")throw new TypeError("filename prefix is required");T(r)&&this.wrapAsync(this.mkdtempBase,[r,c],y)},E.prototype.rmdirBase=function(r,c){c=D({},Tt,c);var y=this.getLinkAsDirOrThrow(r,"rmdir");if(y.length&&!c.recursive)throw d("ENOTEMPTY","rmdir",r);this.deleteLink(y)},E.prototype.rmdirSync=function(r,c){this.rmdirBase(g(r),c)},E.prototype.rmdir=function(r,c,y){var S=D({},Tt,c);c=m(typeof c=="function"?c:y),this.wrapAsync(this.rmdirBase,[g(r),S],c)},E.prototype.fchmodBase=function(r,c){this.getFileByFdOrThrow(r,"fchmod").chmod(c)},E.prototype.fchmodSync=function(r,c){this.fchmodBase(r,K(c))},E.prototype.fchmod=function(r,c,y){this.wrapAsync(this.fchmodBase,[r,K(c)],y)},E.prototype.chmodBase=function(r,c){r=this.openSync(r,"r+");try{this.fchmodBase(r,c)}finally{this.closeSync(r)}},E.prototype.chmodSync=function(r,c){c=K(c),r=g(r),this.chmodBase(r,c)},E.prototype.chmod=function(r,c,y){c=K(c),r=g(r),this.wrapAsync(this.chmodBase,[r,c],y)},E.prototype.lchmodBase=function(r,c){r=this.openBase(r,$,0,!1);try{this.fchmodBase(r,c)}finally{this.closeSync(r)}},E.prototype.lchmodSync=function(r,c){c=K(c),r=g(r),this.lchmodBase(r,c)},E.prototype.lchmod=function(r,c,y){c=K(c),r=g(r),this.wrapAsync(this.lchmodBase,[r,c],y)},E.prototype.fchownBase=function(r,c,y){this.getFileByFdOrThrow(r,"fchown").chown(c,y)},E.prototype.fchownSync=function(r,c,y){v(c),p(y),this.fchownBase(r,c,y)},E.prototype.fchown=function(r,c,y,S){v(c),p(y),this.wrapAsync(this.fchownBase,[r,c,y],S)},E.prototype.chownBase=function(r,c,y){this.getResolvedLinkOrThrow(r,"chown").getNode().chown(c,y)},E.prototype.chownSync=function(r,c,y){v(c),p(y),this.chownBase(g(r),c,y)},E.prototype.chown=function(r,c,y,S){v(c),p(y),this.wrapAsync(this.chownBase,[g(r),c,y],S)},E.prototype.lchownBase=function(r,c,y){this.getLinkOrThrow(r,"lchown").getNode().chown(c,y)},E.prototype.lchownSync=function(r,c,y){v(c),p(y),this.lchownBase(g(r),c,y)},E.prototype.lchown=function(r,c,y,S){v(c),p(y),this.wrapAsync(this.lchownBase,[g(r),c,y],S)},E.prototype.watchFile=function(r,c,y){r=g(r);var S=c;if(typeof S=="function"&&(y=c,S=null),typeof y!="function")throw Error('"watchFile()" requires a listener function');c=5007;var x=!0;return S&&typeof S=="object"&&(typeof S.interval=="number"&&(c=S.interval),typeof S.persistent=="boolean"&&(x=S.persistent)),S=this.statWatchers[r],S||(S=new this.StatWatcher,S.start(r,x,c),this.statWatchers[r]=S),S.addListener("change",y),S},E.prototype.unwatchFile=function(r,c){r=g(r);var y=this.statWatchers[r];y&&(typeof c=="function"?y.removeListener("change",c):y.removeAllListeners("change"),y.listenerCount("change")===0&&(y.stop(),delete this.statWatchers[r]))},E.prototype.createReadStream=function(r,c){return new this.ReadStream(r,c)},E.prototype.createWriteStream=function(r,c){return new this.WriteStream(r,c)},E.prototype.watch=function(r,c,y){r=g(r);var S=c;typeof c=="function"&&(y=c,S=null);var x=ot(S);c=x.persistent,S=x.recursive,x=x.encoding,c===void 0&&(c=!0),S===void 0&&(S=!1);var z=new this.FSWatcher;return z.start(r,c,S,x),y&&z.addListener("change",y),z},E.fd=2147483647,E}(),t.Volume=e;var Ht=function(E){function r(c){var y=E.call(this)||this;return y.onInterval=function(){try{var S=y.vol.statSync(y.filename);y.hasChanged(S)&&(y.emit("change",S,y.prev),y.prev=S)}finally{y.loop()}},y.vol=c,y}return R(r,E),r.prototype.loop=function(){this.timeoutRef=this.setTimeout(this.onInterval,this.interval)},r.prototype.hasChanged=function(c){return c.mtimeMs>this.prev.mtimeMs||c.nlink!==this.prev.nlink},r.prototype.start=function(c,y,S){y===void 0&&(y=!0),S===void 0&&(S=5007),this.filename=g(c),this.setTimeout=y?setTimeout:Ps.default,this.interval=S,this.prev=this.vol.statSync(this.filename),this.loop()},r.prototype.stop=function(){clearTimeout(this.timeoutRef),Ae.default.nextTick(L,this)},r}(qt.EventEmitter);t.StatWatcher=Ht;var Qt;pi.inherits(U,Be.Readable),t.ReadStream=U,U.prototype.open=function(){var E=this;this._vol.open(this.path,this.flags,this.mode,function(r,c){r?(E.autoClose&&E.destroy&&E.destroy(),E.emit("error",r)):(E.fd=c,E.emit("open",c),E.read())})},U.prototype._read=function(E){if(typeof this.fd!="number")return this.once("open",function(){this._read(E)});if(!this.destroyed){(!Qt||128>Qt.length-Qt.used)&&(Qt=Xt.bufferAllocUnsafe(this._readableState.highWaterMark),Qt.used=0);var r=Qt,c=Math.min(Qt.length-Qt.used,E),y=Qt.used;if(this.pos!==void 0&&(c=Math.min(this.end-this.pos+1,c)),0>=c)return this.push(null);var S=this;this._vol.read(this.fd,Qt,Qt.used,c,this.pos,function(x,z){x?(S.autoClose&&S.destroy&&S.destroy(),S.emit("error",x)):(x=null,0<z&&(S.bytesRead+=z,x=r.slice(y,y+z)),S.push(x))}),this.pos!==void 0&&(this.pos+=c),Qt.used+=c}},U.prototype._destroy=function(E,r){this.close(function(c){r(E||c)})},U.prototype.close=function(E){var r=this;if(E&&this.once("close",E),this.closed||typeof this.fd!="number"){if(typeof this.fd!="number"){this.once("open",q);return}return Ae.default.nextTick(function(){return r.emit("close")})}this.closed=!0,this._vol.close(this.fd,function(c){c?r.emit("error",c):r.emit("close")}),this.fd=null},pi.inherits(O,Be.Writable),t.WriteStream=O,O.prototype.open=function(){this._vol.open(this.path,this.flags,this.mode,function(E,r){E?(this.autoClose&&this.destroy&&this.destroy(),this.emit("error",E)):(this.fd=r,this.emit("open",r))}.bind(this))},O.prototype._write=function(E,r,c){if(!(E instanceof Xt.Buffer))return this.emit("error",Error("Invalid data"));if(typeof this.fd!="number")return this.once("open",function(){this._write(E,r,c)});var y=this;this._vol.write(this.fd,E,0,E.length,this.pos,function(S,x){if(S)return y.autoClose&&y.destroy&&y.destroy(),c(S);y.bytesWritten+=x,c()}),this.pos!==void 0&&(this.pos+=E.length)},O.prototype._writev=function(E,r){if(typeof this.fd!="number")return this.once("open",function(){this._writev(E,r)});for(var c=this,y=E.length,S=Array(y),x=0,z=0;z<y;z++){var W=E[z].chunk;S[z]=W,x+=W.length}y=Xt.Buffer.concat(S),this._vol.write(this.fd,y,0,y.length,this.pos,function(Z,at){if(Z)return c.destroy&&c.destroy(),r(Z);c.bytesWritten+=at,r()}),this.pos!==void 0&&(this.pos+=x)},O.prototype._destroy=U.prototype._destroy,O.prototype.close=U.prototype.close,O.prototype.destroySoon=O.prototype.end;var Yt=function(E){function r(c){var y=E.call(this)||this;return y._filename="",y._filenameEncoded="",y._recursive=!1,y._encoding=Ue.ENCODING_UTF8,y._onNodeChange=function(){y._emit("change")},y._onParentChild=function(S){S.getName()===y._getName()&&y._emit("rename")},y._emit=function(S){y.emit("change",S,y._filenameEncoded)},y._persist=function(){y._timer=setTimeout(y._persist,1e6)},y._vol=c,y}return R(r,E),r.prototype._getName=function(){return this._steps[this._steps.length-1]},r.prototype.start=function(c,y,S,x){y===void 0&&(y=!0),S===void 0&&(S=!1),x===void 0&&(x=Ue.ENCODING_UTF8),this._filename=g(c),this._steps=B(this._filename),this._filenameEncoded=Ue.strToEncoding(this._filename),this._recursive=S,this._encoding=x;try{this._link=this._vol.getLinkOrThrow(this._filename,"FSWatcher")}catch(z){throw y=Error("watch "+this._filename+" "+z.code),y.code=z.code,y.errno=z.code,y}this._link.getNode().on("change",this._onNodeChange),this._link.on("child:add",this._onNodeChange),this._link.on("child:delete",this._onNodeChange),(c=this._link.parent)&&(c.setMaxListeners(c.getMaxListeners()+1),c.on("child:delete",this._onParentChild)),y&&this._persist()},r.prototype.close=function(){clearTimeout(this._timer),this._link.getNode().removeListener("change",this._onNodeChange);var c=this._link.parent;c&&c.removeListener("child:delete",this._onParentChild)},r}(qt.EventEmitter);t.FSWatcher=Yt});Le(xn);var Rf=xn.pathToFilename,Uf=xn.filenameToSteps,ac=xn.Volume,Ao=_e(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fsProps="constants F_OK R_OK W_OK X_OK Stats".split(" "),t.fsSyncMethods="renameSync ftruncateSync truncateSync chownSync fchownSync lchownSync chmodSync fchmodSync lchmodSync statSync lstatSync fstatSync linkSync symlinkSync readlinkSync realpathSync unlinkSync rmdirSync mkdirSync mkdirpSync readdirSync closeSync openSync utimesSync futimesSync fsyncSync writeSync readSync readFileSync writeFileSync appendFileSync existsSync accessSync fdatasyncSync mkdtempSync copyFileSync createReadStream createWriteStream".split(" "),t.fsAsyncMethods="rename ftruncate truncate chown fchown lchown chmod fchmod lchmod stat lstat fstat link symlink readlink realpath unlink rmdir mkdir mkdirp readdir close open utimes futimes fsync write read readFile writeFile appendFile exists access fdatasync mkdtemp copyFile watchFile unwatchFile watch".split(" ")});Le(Ao);var oc=_e(function(e,t){function n(l){for(var m={F_OK:s,R_OK:d,W_OK:h,X_OK:f,constants:zt.constants,Stats:qn.default,Dirent:no.default},I=0,g=a;I<g.length;I++){var B=g[I];typeof l[B]=="function"&&(m[B]=l[B].bind(l))}for(I=0,g=o;I<g.length;I++)B=g[I],typeof l[B]=="function"&&(m[B]=l[B].bind(l));return m.StatWatcher=l.StatWatcher,m.FSWatcher=l.FSWatcher,m.WriteStream=l.WriteStream,m.ReadStream=l.ReadStream,m.promises=l.promises,m._toUnixTimestamp=xn.toUnixTimestamp,m}var i=ae&&ae.__assign||function(){return i=Object.assign||function(l){for(var m,I=1,g=arguments.length;I<g;I++){m=arguments[I];for(var B in m)Object.prototype.hasOwnProperty.call(m,B)&&(l[B]=m[B])}return l},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=Ao.fsSyncMethods,o=Ao.fsAsyncMethods,s=zt.constants.F_OK,d=zt.constants.R_OK,h=zt.constants.W_OK,f=zt.constants.X_OK;t.Volume=xn.Volume,t.vol=new xn.Volume,t.createFsFromVolume=n,t.fs=n(t.vol),e.exports=i(i({},e.exports),t.fs),e.exports.semantic=!0});Le(oc);var rc=oc.createFsFromVolume;Zu.prototype.emit=function(e){for(var t,n,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];a=this.listeners(e);try{for(var o=ka(a),s=o.next();!s.done;s=o.next()){var d=s.value;try{d.apply(void 0,Iu(i))}catch(h){console.error(h)}}}catch(h){t={error:h}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return 0<a.length};var Gf=function(){function e(){this.volume=new ac,this.fs=rc(this.volume),this.fromJSON({"/dev/stdin":"","/dev/stdout":"","/dev/stderr":""})}return e.prototype._toJSON=function(t,n,i){n===void 0&&(n={});var a=!0,o;for(o in t.children){a=!1;var s=t.getChild(o);if(s){var d=s.getNode();d&&d.isFile()?(s=s.getPath(),i&&(s=oo(i,s)),n[s]=d.getBuffer()):d&&d.isDirectory()&&this._toJSON(s,n,i)}}return t=t.getPath(),i&&(t=oo(i,t)),t&&a&&(n[t]=null),n},e.prototype.toJSON=function(t,n,i){var a,o;n===void 0&&(n={}),i===void 0&&(i=!1);var s=[];if(t){t instanceof Array||(t=[t]);try{for(var d=ka(t),h=d.next();!h.done;h=d.next()){var f=Rf(h.value),l=this.volume.getResolvedLink(f);l&&s.push(l)}}catch(P){var m={error:P}}finally{try{h&&!h.done&&(a=d.return)&&a.call(d)}finally{if(m)throw m.error}}}else s.push(this.volume.root);if(!s.length)return n;try{for(var I=ka(s),g=I.next();!g.done;g=I.next())l=g.value,this._toJSON(l,n,i?l.getPath():"")}catch(P){var B={error:P}}finally{try{g&&!g.done&&(o=I.return)&&o.call(I)}finally{if(B)throw B.error}}return n},e.prototype.fromJSONFixed=function(t,n){for(var i in n){var a=n[i];if(a?Object.getPrototypeOf(a)!==null:a!==null){var o=Uf(i);1<o.length&&(o="/"+o.slice(0,o.length-1).join("/"),t.mkdirpBase(o,511)),t.writeFileSync(i,a||"")}else t.mkdirpBase(i,511)}},e.prototype.fromJSON=function(t){this.volume=new ac,this.fromJSONFixed(this.volume,t),this.fs=rc(this.volume),this.volume.releasedFds=[0,1,2],t=this.volume.openSync("/dev/stderr","w");var n=this.volume.openSync("/dev/stdout","w"),i=this.volume.openSync("/dev/stdin","r");if(t!==2)throw Error("invalid handle for stderr: "+t);if(n!==1)throw Error("invalid handle for stdout: "+n);if(i!==0)throw Error("invalid handle for stdin: "+i)},e.prototype.getStdOut=function(){return Au(this,void 0,void 0,function(){var t,n=this;return yu(this,function(){return t=new Promise(function(i){i(n.fs.readFileSync("/dev/stdout","utf8"))}),[2,t]})})},e}();function sc(e){return e.arrayBuffer?e.arrayBuffer():new Promise((t,n)=>{const i=new FileReader;i.addEventListener("loadend",()=>{t(i.result)}),i.addEventListener("error",n),i.readAsArrayBuffer(e)})}async function Mf(e){const t=await sc(e);return new Uint8Array(t)}function cc(e){return typeof Blob<"u"&&e instanceof Blob}function Ei(e){return typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer}const Df=typeof process<"u"&&process.versions&&typeof process.versions.node<"u"&&typeof process.versions.electron>"u";function Nf(e){return e.byteOffset===0&&e.byteLength===e.buffer.byteLength}class lc{constructor(t){this.typedArray=t instanceof ArrayBuffer||Ei(t)?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}async getLength(){return this.typedArray.byteLength}async read(t,n){return new Uint8Array(this.typedArray.buffer,this.typedArray.byteOffset+t,n)}}class dc{constructor(t){this.blob=t}async getLength(){return this.blob.size}async read(t,n){const i=this.blob.slice(t,t+n),a=await sc(i);return new Uint8Array(a)}async sliceAsBlob(t,n,i=""){return this.blob.slice(t,t+n,i)}}function kf(e,t){var n=Uint8Array;if(e[0]==3&&e[1]==0)return t||new n(0);var i=qf,a=_c,o=zf,s=hc,d=t==null;d&&(t=new n(e.length>>>2<<3));for(var h=0,f=0,l=0,m=0,I=0,g=0,B=0,P=0,C=0,N,T;h==0;){if(h=i(e,C,1),f=i(e,C+1,2),C+=3,f==0){(C&7)!=0&&(C+=8-(C&7));var K=(C>>>3)+4,M=e[K-4]|e[K-3]<<8;d&&(t=yo(t,P+M)),t.set(new n(e.buffer,e.byteOffset+K,M),P),C=K+M<<3,P+=M;continue}if(d&&(t=yo(t,P+(1<<17))),f==1&&(N=Pt.flmap,T=Pt.fdmap,g=(1<<9)-1,B=(1<<5)-1),f==2){l=a(e,C,5)+257,m=a(e,C+5,5)+1,I=a(e,C+10,4)+4,C+=14;for(var V=0;V<38;V+=2)Pt.itree[V]=0,Pt.itree[V+1]=0;for(var v=1,V=0;V<I;V++){var p=a(e,C+V*3,3);Pt.itree[(Pt.ordr[V]<<1)+1]=p,p>v&&(v=p)}C+=3*I,bi(Pt.itree,v),Ci(Pt.itree,v,Pt.imap),N=Pt.lmap,T=Pt.dmap,C=o(Pt.imap,(1<<v)-1,l+m,e,C,Pt.ttree);var L=uc(Pt.ttree,0,l,Pt.ltree);g=(1<<L)-1;var U=uc(Pt.ttree,l,m,Pt.dtree);B=(1<<U)-1,bi(Pt.ltree,L),Ci(Pt.ltree,L,N),bi(Pt.dtree,U),Ci(Pt.dtree,U,T)}for(;;){var q=N[s(e,C)&g];C+=q&15;var O=q>>>4;if(O>>>8==0)t[P++]=O;else{if(O==256)break;var R=P+O-254;if(O>264){var b=Pt.ldef[O-257];R=P+(b>>>3)+a(e,C,b&7),C+=b&7}var D=T[s(e,C)&B];C+=D&15;var j=D>>>4,J=Pt.ddef[j],tt=(J>>>4)+i(e,C,J&15);for(C+=J&15,d&&(t=yo(t,P+(1<<17)));P<R;)t[P]=t[P++-tt],t[P]=t[P++-tt],t[P]=t[P++-tt],t[P]=t[P++-tt];P=R}}}return t.length==P?t:t.slice(0,P)}function yo(e,t){var n=e.length;if(t<=n)return e;var i=new Uint8Array(Math.max(n<<1,t));return i.set(e,0),i}function zf(e,t,n,i,a,o){for(var s=_c,d=hc,h=0;h<n;){var f=e[d(i,a)&t];a+=f&15;var l=f>>>4;if(l<=15)o[h]=l,h++;else{var m=0,I=0;l==16?(I=3+s(i,a,2),a+=2,m=o[h-1]):l==17?(I=3+s(i,a,3),a+=3):l==18&&(I=11+s(i,a,7),a+=7);for(var g=h+I;h<g;)o[h]=m,h++}}return a}function uc(e,t,n,i){for(var a=0,o=0,s=i.length>>>1;o<n;){var d=e[o+t];i[o<<1]=0,i[(o<<1)+1]=d,d>a&&(a=d),o++}for(;o<s;)i[o<<1]=0,i[(o<<1)+1]=0,o++;return a}function bi(e,t){for(var n=e.length,i,a,o,s,d,h=Pt.bl_count,s=0;s<=t;s++)h[s]=0;for(s=1;s<n;s+=2)h[e[s]]++;var f=Pt.next_code;for(i=0,h[0]=0,a=1;a<=t;a++)i=i+h[a-1]<<1,f[a]=i;for(o=0;o<n;o+=2)d=e[o+1],d!=0&&(e[o]=f[d],f[d]++)}function Ci(e,t,n){for(var i=e.length,a=Pt.rev15,o=0;o<i;o+=2)if(e[o+1]!=0)for(var s=o>>1,d=e[o+1],h=s<<4|d,f=t-d,l=e[o]<<f,m=l+(1<<f);l!=m;){var I=a[l]>>>15-t;n[I]=h,l++}}function fc(e,t){for(var n=Pt.rev15,i=15-t,a=0;a<e.length;a+=2){var o=e[a]<<t-e[a+1];e[a]=n[o]>>>i}}function _c(e,t,n){return(e[t>>>3]|e[(t>>>3)+1]<<8)>>>(t&7)&(1<<n)-1}function qf(e,t,n){return(e[t>>>3]|e[(t>>>3)+1]<<8|e[(t>>>3)+2]<<16)>>>(t&7)&(1<<n)-1}function hc(e,t){return(e[t>>>3]|e[(t>>>3)+1]<<8|e[(t>>>3)+2]<<16)>>>(t&7)}const Pt=function(){var e=Uint16Array,t=Uint32Array;return{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new t(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(1<<15),lhst:new t(286),dhst:new t(30),ihst:new t(19),lits:new t(15e3),strt:new e(1<<16),prev:new e(1<<15)}}();(function(){for(var e=32768,t=0;t<e;t++){var n=t;n=(n&2863311530)>>>1|(n&1431655765)<<1,n=(n&3435973836)>>>2|(n&858993459)<<2,n=(n&4042322160)>>>4|(n&252645135)<<4,n=(n&4278255360)>>>8|(n&16711935)<<8,Pt.rev15[t]=(n>>>16|n<<16)>>>17}function i(a,o,s){for(;o--!=0;)a.push(0,s)}for(var t=0;t<32;t++)Pt.ldef[t]=Pt.of0[t]<<3|Pt.exb[t],Pt.ddef[t]=Pt.df0[t]<<4|Pt.dxb[t];i(Pt.fltree,144,8),i(Pt.fltree,255-143,9),i(Pt.fltree,279-255,7),i(Pt.fltree,287-279,8),bi(Pt.fltree,9),Ci(Pt.fltree,9,Pt.flmap),fc(Pt.fltree,9),i(Pt.fdtree,32,5),bi(Pt.fdtree,5),Ci(Pt.fdtree,5,Pt.fdmap),fc(Pt.fdtree,5),i(Pt.itree,19,0),i(Pt.ltree,286,0),i(Pt.dtree,30,0),i(Pt.ttree,320,0)})();const gc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var n=t,i=0;i<8;i++)n&1?n=3988292384^n>>>1:n=n>>>1;e[t]=n}return e}(),update:function(e,t,n,i){for(var a=0;a<i;a++)e=gc.table[(e^t[n+a])&255]^e>>>8;return e},crc:function(e,t,n){return gc.update(4294967295,e,t,n)^4294967295}};function Qf(e,t){return kf(e,t)}const pc={numWorkers:1,workerURL:"",useWorkers:!1};let Hf=0;const da=[];function wo(e){return new Promise((t,n)=>{const i=new Worker(e);i.onmessage=a=>{a.data==="start"?(i.onerror=void 0,i.onmessage=void 0,t(i)):n(new Error(`unexpected message: ${a.data}`))},i.onerror=n})}function Wf(e,t){return e.require(t)}(function(){if(Df){const{Worker:e}=Wf(module,"worker_threads");return{async createWorker(t){return new e(t)},addEventListener(t,n){t.on("message",i=>{n({target:t,data:i})})},async terminate(t){await t.terminate()}}}else return{async createWorker(e){try{return await wo(e)}catch{console.warn("could not load worker:",e)}let t;try{const n=await fetch(e,{mode:"cors"});if(!n.ok)throw new Error(`could not load: ${e}`);t=await n.text(),e=URL.createObjectURL(new Blob([t],{type:"application/javascript"}));const i=await wo(e);return pc.workerURL=e,i}catch{console.warn("could not load worker via fetch:",e)}if(t!==void 0)try{e=`data:application/javascript;base64,${btoa(t)}`;const n=await wo(e);return pc.workerURL=e,n}catch{console.warn("could not load worker via dataURI")}throw console.warn("workers will not be used"),new Error("can not start workers")},addEventListener(e,t){e.addEventListener("message",t)},async terminate(e){e.terminate()}}})();function Kf(e,t,n,i){const a=new Uint8Array(t);Qf(e,a),i(n?new Blob([a],{type:n}):a.buffer)}async function Vf(){if(da.length!==0)for(;da.length;){const{src:e,uncompressedSize:t,type:n,resolve:i}=da.shift();let a=e;cc(e)&&(a=await Mf(e)),Kf(a,t,n,i)}}function mc(e,t,n){return new Promise((i,a)=>{da.push({src:e,uncompressedSize:t,type:n,resolve:i,reject:a,id:Hf++}),Vf()})}function jf(e,t){const n=e&31,i=(e>>5&15)-1,a=(e>>9&127)+1980,o=0,s=(t&31)*2,d=t>>5&63,h=t>>11&31;return new Date(a,i,n,h,d,s,o)}class Yf{constructor(t,n){this._reader=t,this._rawEntry=n,this.name=n.name,this.nameBytes=n.nameBytes,this.size=n.uncompressedSize,this.compressedSize=n.compressedSize,this.comment=n.comment,this.commentBytes=n.commentBytes,this.compressionMethod=n.compressionMethod,this.lastModDate=jf(n.lastModFileDate,n.lastModFileTime),this.isDirectory=n.uncompressedSize===0&&n.name.endsWith("/"),this.encrypted=!!(n.generalPurposeBitFlag&1),this.externalFileAttributes=n.externalFileAttributes,this.versionMadeBy=n.versionMadeBy}async blob(t="application/octet-stream"){return await r2(this._reader,this._rawEntry,t)}async arrayBuffer(){return await o2(this._reader,this._rawEntry)}async text(){const t=await this.arrayBuffer();return Si(new Uint8Array(t))}async json(){const t=await this.text();return JSON.parse(t)}}const Io=22,$f=65535,Zf=101010256,Jf=101075792;async function Jn(e,t,n){return await e.read(t,n)}async function Eo(e,t,n,i){return e.sliceAsBlob?await e.sliceAsBlob(t,n,i):await e.read(t,n)}const Xf={unsigned(){return 0}};function ue(e,t){return e[t]+e[t+1]*256}function ye(e,t){return e[t]+e[t+1]*256+e[t+2]*65536+e[t+3]*16777216}function Tn(e,t){return ye(e,t)+ye(e,t+4)*4294967296}const t2=new TextDecoder;function Si(e,t){return Ei(e.buffer)&&(e=new Uint8Array(e)),t2.decode(e)}async function e2(e,t){const n=Math.min(Io+$f,t),i=t-n,a=await Jn(e,i,n);for(let o=n-Io;o>=0;--o){if(ye(a,o)!==Zf)continue;const s=new Uint8Array(a.buffer,a.byteOffset+o,a.byteLength-o),d=ue(s,4);if(d!==0)throw new Error(`multi-volume zip files are not supported. This is volume: ${d}`);const h=ue(s,10),f=ye(s,12),l=ye(s,16),m=ue(s,20),I=s.length-Io;if(m!==I)throw new Error(`invalid comment length. expected: ${I}, actual: ${m}`);const g=new Uint8Array(s.buffer,s.byteOffset+22,m),B=Si(g);return h===65535||l===4294967295?await i2(e,i+o,B,g):await Lc(e,l,f,h,B,g)}throw new Error("could not find end of central directory. maybe not zip file")}const n2=117853008;async function i2(e,t,n,i){const a=t-20,o=await Jn(e,a,20);if(ye(o,0)!==n2)throw new Error("invalid zip64 end of central directory locator signature");const s=Tn(o,8),d=await Jn(e,s,56);if(ye(d,0)!==Jf)throw new Error("invalid zip64 end of central directory record signature");const h=Tn(d,32),f=Tn(d,40),l=Tn(d,48);return Lc(e,l,f,h,n,i)}const a2=33639248;async function Lc(e,t,n,i,a,o){let s=0;const d=await Jn(e,t,n),h=[];for(let l=0;l<i;++l){const m=d.subarray(s,s+46),I=ye(m,0);if(I!==a2)throw new Error(`invalid central directory file header signature: 0x${I.toString(16)}`);const g={versionMadeBy:ue(m,4),versionNeededToExtract:ue(m,6),generalPurposeBitFlag:ue(m,8),compressionMethod:ue(m,10),lastModFileTime:ue(m,12),lastModFileDate:ue(m,14),crc32:ye(m,16),compressedSize:ye(m,20),uncompressedSize:ye(m,24),fileNameLength:ue(m,28),extraFieldLength:ue(m,30),fileCommentLength:ue(m,32),internalFileAttributes:ue(m,36),externalFileAttributes:ye(m,38),relativeOffsetOfLocalHeader:ye(m,42)};if(g.generalPurposeBitFlag&64)throw new Error("strong encryption is not supported");s+=46;const B=d.subarray(s,s+g.fileNameLength+g.extraFieldLength+g.fileCommentLength);g.nameBytes=B.slice(0,g.fileNameLength),g.name=Si(g.nameBytes);const P=g.fileNameLength+g.extraFieldLength,C=B.slice(g.fileNameLength,P);g.extraFields=[];let N=0;for(;N<C.length-3;){const K=ue(C,N+0),M=ue(C,N+2),V=N+4,v=V+M;if(v>C.length)throw new Error("extra field length exceeds extra field buffer size");g.extraFields.push({id:K,data:C.slice(V,v)}),N=v}if(g.commentBytes=B.slice(P,P+g.fileCommentLength),g.comment=Si(g.commentBytes),s+=B.length,g.uncompressedSize===4294967295||g.compressedSize===4294967295||g.relativeOffsetOfLocalHeader===4294967295){const K=g.extraFields.find(v=>v.id===1);if(!K)throw new Error("expected zip64 extended information extra field");const M=K.data;let V=0;if(g.uncompressedSize===4294967295){if(V+8>M.length)throw new Error("zip64 extended information extra field does not include uncompressed size");g.uncompressedSize=Tn(M,V),V+=8}if(g.compressedSize===4294967295){if(V+8>M.length)throw new Error("zip64 extended information extra field does not include compressed size");g.compressedSize=Tn(M,V),V+=8}if(g.relativeOffsetOfLocalHeader===4294967295){if(V+8>M.length)throw new Error("zip64 extended information extra field does not include relative header offset");g.relativeOffsetOfLocalHeader=Tn(M,V),V+=8}}const T=g.extraFields.find(K=>K.id===28789&&K.data.length>=6&&K.data[0]===1&&ye(K.data,1),Xf.unsigned(g.nameBytes));if(T&&(g.fileName=Si(T.data.slice(5))),g.compressionMethod===0){let K=g.uncompressedSize;if((g.generalPurposeBitFlag&1)!==0&&(K+=12),g.compressedSize!==K)throw new Error(`compressed size mismatch for stored file: ${g.compressedSize} != ${K}`)}h.push(g)}return{zip:{comment:a,commentBytes:o},entries:h.map(l=>new Yf(e,l))}}async function Ac(e,t){if(t.generalPurposeBitFlag&1)throw new Error("encrypted entries not supported");const n=await Jn(e,t.relativeOffsetOfLocalHeader,30),i=await e.getLength(),a=ye(n,0);if(a!==67324752)throw new Error(`invalid local file header signature: 0x${a.toString(16)}`);const o=ue(n,26),s=ue(n,28),d=t.relativeOffsetOfLocalHeader+n.length+o+s;let h;if(t.compressionMethod===0)h=!1;else if(t.compressionMethod===8)h=!0;else throw new Error(`unsupported compression method: ${t.compressionMethod}`);const f=d,l=f+t.compressedSize;if(t.compressedSize!==0&&l>i)throw new Error(`file data overflows file bounds: ${f} +  ${t.compressedSize}  > ${i}`);return{decompress:h,fileDataStart:f}}async function o2(e,t){const{decompress:n,fileDataStart:i}=await Ac(e,t);if(!n){const s=await Jn(e,i,t.compressedSize);return Nf(s)?s.buffer:s.slice().buffer}const a=await Eo(e,i,t.compressedSize);return await mc(a,t.uncompressedSize)}async function r2(e,t,n){const{decompress:i,fileDataStart:a}=await Ac(e,t);if(!i){const d=await Eo(e,a,t.compressedSize,n);return cc(d)?d:new Blob([Ei(d.buffer)?new Uint8Array(d):d],{type:n})}const o=await Eo(e,a,t.compressedSize);return await mc(o,t.uncompressedSize,n)}async function s2(e){let t;if(typeof Blob<"u"&&e instanceof Blob)t=new dc(e);else if(e instanceof ArrayBuffer||e&&e.buffer&&e.buffer instanceof ArrayBuffer)t=new lc(e);else if(Ei(e)||Ei(e.buffer))t=new lc(e);else if(typeof e=="string"){const i=await fetch(e);if(!i.ok)throw new Error(`failed http request ${e}, status: ${i.status}: ${i.statusText}`);const a=await i.blob();t=new dc(a)}else if(typeof e.getLength=="function"&&typeof e.read=="function")t=e;else throw new Error("unsupported source type");const n=await t.getLength();if(n>Number.MAX_SAFE_INTEGER)throw new Error(`file too large. size: ${n}. Only file sizes up 4503599627370496 bytes are supported`);return await e2(t,n)}async function c2(e){const{zip:t,entries:n}=await s2(e);return{zip:t,entries:Object.fromEntries(n.map(i=>[i.name,i]))}}var l2=""+new URL("circomspect.516050fc.wasm",document.currentScript&&document.currentScript.src||document.baseURI).href,d2=""+new URL("circomlib.acbc52cb.zip",document.currentScript&&document.currentScript.src||document.baseURI).href,u2=""+new URL("circom.45e397a1.wasm",document.currentScript&&document.currentScript.src||document.baseURI).href;globalThis.process={cwd(){return""}},globalThis.Buffer=pt;const f2=Math.floor((Date.now()-performance.now())*.001);function _2(){let e=performance.now()*.001,t=Math.floor(e)+f2,n=Math.floor(e%1*1e9);return t*1e9+n}function h2(e,t,n){if(e instanceof Uint8Array)for(let i=t;i<t+n;i++)e[i]=Math.floor(Math.random()*256);return e}const yc={hrtime:_2,exit:e=>{throw new gu(e)},kill:e=>{throw new pu(e)},randomFillSync:h2,isTTY:()=>!0,path:Lu,fs:null};async function wc(e){const t=await fetch(e),n=t.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&n.startsWith("application/wasm"))return await WebAssembly.compileStreaming(t);{const i=await t.arrayBuffer();return await WebAssembly.compile(i)}}async function g2(){const e=new Gf,{entries:t}=await c2(d2);for(const[n,i]of Object.entries(t)){const a=await t[n].arrayBuffer();e.fs.writeFileSync(n.replace("circomlib-master/circuits/","circomlib/"),new Uint8Array(a)),e.fs.writeFileSync(n.replace("circomlib-master/circuits/","circomlib/circuits/"),new Uint8Array(a))}return e}const Xn=g2();function Ic(e){return e.replace(/(include\s+")([^"]+)"/g,(t,n,i)=>i.startsWith("gist:")?n+i.replace("gist:","external/https/gist.github.com/")+'"':t.replace(/(include\s+")(\w+):\/\//,"$1external/$2/"))}async function Ec(){const e=await Xn;let t=10*1024*1024,n=new Uint8Array(t),i=-1,a=0,o=0,s;const d={...e.fs,realpathSync(h){const f=h.replace(/.*circomlib\//,"circomlib/");return h.includes("circomlib/")&&e.fs.existsSync(f)?f:(h.startsWith("external/")&&!e.fs.existsSync(h)&&(s=h),e.fs.realpathSync(h))},writeSync(h,f,l,m,I){return i===h&&a+m<t&&I===o+a?(n.set(f,a),a+=m,m):(i>=0&&e.fs.writeSync(i,n,0,a,o),i=h,a=0,n.set(f,a),a+=m,o=I,m)},closeSync(h){if(i>=0&&(e.fs.writeSync(i,n,0,a,o),i=-1,a=0,o=0),h>=0)return e.fs.closeSync(h)}};return async h=>{for(;;){if(s=void 0,d.writeFileSync("/dev/stderr",""),d.writeFileSync("/dev/stdout",""),await h(d),d.closeSync(-1),s){console.log("Fetching",s);const f=await A2(s),l=Ic(L2(f));d.mkdirSync(Na.dirname(s),{recursive:!0}),d.writeFileSync(s,l);continue}break}}}async function p2(e="main.circom"){const t=await Ec(),n=await wc(l2);await t(async i=>{let a=new Mr({args:["circomspect",e,"--sarif-file","__circomspect.sarif","--allow","P1003"],env:{RUST_BACKTRACE:"1"},preopens:{".":"."},bindings:{...yc,fs:i}}),o=await WebAssembly.instantiate(n,{...a.getImports(n)});console.log("starting circomspect");try{a.start(o)}catch(s){console.log(s)}})}async function m2(e="main.circom",t={nosym:!1,nowasm:!1,nor1cs:!1}){const n=await Ec(),i=await wc(u2);await n(async a=>{let o=new Mr({args:["circom2",e,!t.nor1cs&&"--r1cs",!t.nowasm&&"--wasm",!t.nosym&&"--sym"].filter(d=>d!==!1),env:{RUST_BACKTRACE:"1"},preopens:{".":"."},bindings:{...yc,fs:a}}),s=await WebAssembly.instantiate(i,{...o.getImports(i)});try{o.start(s)}catch(d){console.log(d)}})}function L2(e){return e.replace(/(component\s+main[^;]+;)/,"/* $1 */")}async function Fi(e){let t;try{t=await fetch(e)}catch{throw new Error(`Failed to fetch ${e}`)}if(t.status!==200)throw new Error(`Error ${t.status}: ${e}`);return await t.text()}async function bc(e){const n=await(await fetch(`https://api.github.com/gists/${e}`)).json();if(n.files["main.circom"])return n.files["main.circom"].content;const i=Object.keys(n.files).find(a=>a.endsWith(".circom"));return i?n.files[i].content:Object.values(n.files)[0].content}async function A2(e){let t=[];const n=i=>t=i.exec(e);if(n(/^external\/https\/gist\.github\.com\/([^/]+)\/([\da-f]{32})/))return bc(t[2]);if(n(/^external\/https\/gist\.github\.com\/([\da-f]{32})/))return bc(t[1]);if(n(/^external\/https\/github\.com\/([^/]+)\/([^/]+)\/blob\/([^/]+)\/(.*)/))return Fi(`https://raw.githubusercontent.com/${t[1]}/${t[2]}/${t[3]}/${t[4]}`);if(n(/^external\/ipfs\/(.*)$/))return Fi(`https://cloudflare-ipfs.com/ipfs/${t[1]}`);if(n(/^external\/dweb\/ipfs\/(.*)$/))return Fi(`https://cloudflare-ipfs.com/ipfs/${t[1]}`);if(n(/^external\/https\/(.*)$/))return Fi(`https://${t[1]}`);if(n(/^external\/http\/(.*)$/))return Fi(`http://${t[1]}`)}const y2=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function ua(e,t){if(!t||t==10)return BigInt(e);if(t==16)return e.slice(0,2)=="0x"?BigInt(e):BigInt("0x"+e)}const ie=ua;function w2(e,t){let n=BigInt(0);t=BigInt(t);for(let i=0;i<e.length;i++)n=n*t+BigInt(e[i]);return n}function vi(e){const t=e.toString(16);return(t.length-1)*4+y2[parseInt(t[0],16)]}function Cc(e){return BigInt(e)<BigInt(0)}function Sc(e){return!e}function fa(e,t){return BigInt(e)<<BigInt(t)}function ti(e,t){return BigInt(e)>>BigInt(t)}const I2=fa,E2=ti;function bo(e){return(BigInt(e)&BigInt(1))==BigInt(1)}function b2(e){let t=BigInt(e);const n=[];for(;t;){if(t&BigInt(1)){const i=2-Number(t%BigInt(4));n.push(i),t=t-BigInt(i)}else n.push(0);t=t>>BigInt(1)}return n}function Fc(e){let t=BigInt(e);const n=[];for(;t;)t&BigInt(1)?n.push(1):n.push(0),t=t>>BigInt(1);return n}function vc(e){if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(e)}function C2(e,t){const n=[];let i=BigInt(e);for(t=BigInt(t);i;)n.unshift(Number(i%t)),i=i/t;return n}function Co(e,t){return BigInt(e)+BigInt(t)}function nn(e,t){return BigInt(e)-BigInt(t)}function Bc(e){return-BigInt(e)}function xc(e,t){return BigInt(e)*BigInt(t)}function S2(e){return BigInt(e)*BigInt(e)}function Bi(e,t){return BigInt(e)**BigInt(t)}function F2(e,t){return BigInt(e)**BigInt(t)}function v2(e){return BigInt(e)>=0?BigInt(e):-BigInt(e)}function ei(e,t){return BigInt(e)/BigInt(t)}function Ke(e,t){return BigInt(e)%BigInt(t)}function an(e,t){return BigInt(e)==BigInt(t)}function B2(e,t){return BigInt(e)!=BigInt(t)}function x2(e,t){return BigInt(e)<BigInt(t)}function So(e,t){return BigInt(e)>BigInt(t)}function T2(e,t){return BigInt(e)<=BigInt(t)}function Tc(e,t){return BigInt(e)>=BigInt(t)}function Fo(e,t){return BigInt(e)&BigInt(t)}function P2(e,t){return BigInt(e)|BigInt(t)}function O2(e,t){return BigInt(e)^BigInt(t)}function R2(e,t){return BigInt(e)&&BigInt(t)}function U2(e,t){return BigInt(e)||BigInt(t)}function G2(e){return!BigInt(e)}function xi(e,t,n,i){const a="0000000"+n.toString(16),o=new Uint32Array(e.buffer,t,i/4),s=((a.length-7)*4-1>>5)+1;for(let d=0;d<s;d++)o[d]=parseInt(a.substring(a.length-8*d-8,a.length-8*d),16);for(let d=s;d<o.length;d++)o[d]=0;for(let d=o.length*4;d<i;d++)e[d]=vc(Fo(ti(n,d*8),255))}function Pc(e,t,n,i){const a="0000000"+n.toString(16),o=new DataView(e.buffer,e.byteOffset+t,i),s=((a.length-7)*4-1>>5)+1;for(let d=0;d<s;d++)o.setUint32(i-d*4-4,parseInt(a.substring(a.length-8*d-8,a.length-8*d),16),!1);for(let d=0;d<i/4-s;d++)o[d]=0}function Ti(e,t,n){n=n||e.byteLength,t=t||0;const i=new Uint32Array(e.buffer,t,n/4),a=new Array(n/4);return i.forEach((o,s)=>a[a.length-s-1]=o.toString(16).padStart(8,"0")),ua(a.join(""),16)}function Oc(e,t,n){n=n||e.byteLength,t=t||0;const i=new DataView(e.buffer,e.byteOffset+t,n),a=new Array(n/4);for(let o=0;o<n/4;o++)a[o]=i.getUint32(o*4,!1).toString(16).padStart(8,"0");return ua(a.join(""),16)}function vo(e,t){return e.toString(t)}function ni(e){const t=new Uint8Array(Math.floor((vi(e)-1)/8)+1);return xi(t,0,e,t.byteLength),t}const Rc=ie(0),Pn=ie(1);var M2=Object.freeze({__proto__:null,fromString:ua,e:ie,fromArray:w2,bitLength:vi,isNegative:Cc,isZero:Sc,shiftLeft:fa,shiftRight:ti,shl:I2,shr:E2,isOdd:bo,naf:b2,bits:Fc,toNumber:vc,toArray:C2,add:Co,sub:nn,neg:Bc,mul:xc,square:S2,pow:Bi,exp:F2,abs:v2,div:ei,mod:Ke,eq:an,neq:B2,lt:x2,gt:So,leq:T2,geq:Tc,band:Fo,bor:P2,bxor:O2,land:R2,lor:U2,lnot:G2,toRprLE:xi,toRprBE:Pc,fromRprLE:Ti,fromRprBE:Oc,toString:vo,toLEBuff:ni,zero:Rc,one:Pn});function Uc(e,t,n){if(Sc(n))return e.one;const i=Fc(n);if(i.length==0)return e.one;let a=t;for(let o=i.length-2;o>=0;o--)a=e.square(a),i[o]&&(a=e.mul(a,t));return a}function D2(e){if(e.m%2==1)if(an(Ke(e.p,4),1))if(an(Ke(e.p,8),1))if(an(Ke(e.p,16),1))N2(e);else if(an(Ke(e.p,16),9))k2(e);else throw new Error("Field withot sqrt");else if(an(Ke(e.p,8),5))z2(e);else throw new Error("Field withot sqrt");else an(Ke(e.p,4),3)&&q2(e);else{const t=Ke(Bi(e.p,e.m/2),4);t==1?Q2(e):t==3?H2(e):W2(e)}}function N2(e){for(e.sqrt_q=Bi(e.p,e.m),e.sqrt_s=0,e.sqrt_t=nn(e.sqrt_q,1);!bo(e.sqrt_t);)e.sqrt_s=e.sqrt_s+1,e.sqrt_t=ei(e.sqrt_t,2);let t=e.one;for(;e.eq(t,e.one);){const n=e.random();e.sqrt_z=e.pow(n,e.sqrt_t),t=e.pow(e.sqrt_z,2**(e.sqrt_s-1))}e.sqrt_tm1d2=ei(nn(e.sqrt_t,1),2),e.sqrt=function(n){const i=this;if(i.isZero(n))return i.zero;let a=i.pow(n,i.sqrt_tm1d2);const o=i.pow(i.mul(i.square(a),n),2**(i.sqrt_s-1));if(i.eq(o,i.negone))return null;let s=i.sqrt_s,d=i.mul(n,a),h=i.mul(d,a),f=i.sqrt_z;for(;!i.eq(h,i.one);){let l=i.square(h),m=1;for(;!i.eq(l,i.one);)l=i.square(l),m++;a=f;for(let I=0;I<s-m-1;I++)a=i.square(a);f=i.square(a),h=i.mul(h,f),d=i.mul(d,a),s=m}return i.geq(d,i.zero)?d:i.neg(d)}}function k2(e){e.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}function z2(e){e.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}function q2(e){e.sqrt_q=Bi(e.p,e.m),e.sqrt_e1=ei(nn(e.sqrt_q,3),4),e.sqrt=function(t){if(this.isZero(t))return this.zero;const n=this.pow(t,this.sqrt_e1),i=this.mul(this.square(n),t);if(this.eq(i,this.negone))return null;const a=this.mul(n,t);return e.geq(a,e.zero)?a:e.neg(a)}}function Q2(e){e.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}function H2(e){e.sqrt_q=Bi(e.p,e.m/2),e.sqrt_e34=ei(nn(e.sqrt_q,3),4),e.sqrt_e12=ei(nn(e.sqrt_q,1),2),e.frobenius=function(t,n){return t%2==1?e.conjugate(n):n},e.sqrt=function(t){const n=this,i=n.pow(t,n.sqrt_e34),a=n.mul(n.square(i),t),o=n.mul(n.frobenius(1,a),a);if(n.eq(o,n.negone))return null;const s=n.mul(i,t);let d;if(n.eq(a,n.negone))d=n.mul(s,[n.F.zero,n.F.one]);else{const h=n.pow(n.add(n.one,a),n.sqrt_e12);d=n.mul(h,s)}return n.geq(d,n.zero)?d:n.neg(d)}}function W2(e){e.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}function hn(e,t,n,i,a){e[t]=e[t]+e[n]>>>0,e[a]=(e[a]^e[t])>>>0,e[a]=(e[a]<<16|e[a]>>>16&65535)>>>0,e[i]=e[i]+e[a]>>>0,e[n]=(e[n]^e[i])>>>0,e[n]=(e[n]<<12|e[n]>>>20&4095)>>>0,e[t]=e[t]+e[n]>>>0,e[a]=(e[a]^e[t])>>>0,e[a]=(e[a]<<8|e[a]>>>24&255)>>>0,e[i]=e[i]+e[a]>>>0,e[n]=(e[n]^e[i])>>>0,e[n]=(e[n]<<7|e[n]>>>25&127)>>>0}function K2(e){hn(e,0,4,8,12),hn(e,1,5,9,13),hn(e,2,6,10,14),hn(e,3,7,11,15),hn(e,0,5,10,15),hn(e,1,6,11,12),hn(e,2,7,8,13),hn(e,3,4,9,14)}class Pi{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return this.idx==16&&this.update(),this.buff[this.idx++]}nextU64(){return Co(xc(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(this.nextU32()&1)==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let t=0;t<10;t++)K2(this.buff);for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,this.state[12]==0&&(this.state[13]=this.state[13]+1>>>0,this.state[13]==0&&(this.state[14]=this.state[14]+1>>>0,this.state[14]==0&&(this.state[15]=this.state[15]+1>>>0)))}}function V2(e){return Buffer.from(crypto.getRandomValues(new Uint8Array(e)))}function j2(e){return crypto.getRandomValues(e)}var _a={randomBytes:V2,randomFillSync:j2};function Gc(e){let t=new Uint8Array(e);if(typeof globalThis.crypto<"u")globalThis.crypto.getRandomValues(t);else for(let n=0;n<e;n++)t[n]=Math.random()*4294967296>>>0;return t}function Y2(){const e=Gc(32),t=new Uint32Array(e.buffer),n=[];for(let i=0;i<8;i++)n.push(t[i]);return n}let ha=null;function Bo(){return ha||(ha=new Pi(Y2()),ha)}class $2{constructor(t,n,i){this.F=n,this.G=t,this.opMulGF=i;let a=n.sqrt_t||n.t,o=n.sqrt_s||n.s,s=n.one;for(;n.eq(n.pow(s,n.half),n.one);)s=n.add(s,n.one);this.w=new Array(o+1),this.wi=new Array(o+1),this.w[o]=this.F.pow(s,a),this.wi[o]=this.F.inv(this.w[o]);let d=o-1;for(;d>=0;)this.w[d]=this.F.square(this.w[d+1]),this.wi[d]=this.F.square(this.wi[d+1]),d--;this.roots=[],this._setRoots(Math.min(o,15))}_setRoots(t){for(let n=t;n>=0&&!this.roots[n];n--){let i=this.F.one;const a=1<<n,o=new Array(a);for(let s=0;s<a;s++)o[s]=i,i=this.F.mul(i,this.w[n]);this.roots[n]=o}}fft(t){if(t.length<=1)return t;const n=Mc(t.length-1)+1;this._setRoots(n);const i=1<<n;if(t.length!=i)throw new Error("Size must be multiple of 2");return ga(this,t,n,0,1)}ifft(t){if(t.length<=1)return t;const n=Mc(t.length-1)+1;this._setRoots(n);const i=1<<n;if(t.length!=i)throw new Error("Size must be multiple of 2");const a=ga(this,t,n,0,1),o=this.F.inv(this.F.mulScalar(this.F.one,i)),s=new Array(i);for(let d=0;d<i;d++)s[d]=this.opMulGF(a[(i-d)%i],o);return s}}function Mc(e){return((e&4294901760)!==0?(e&=4294901760,16):0)|((e&4278255360)!==0?(e&=4278255360,8):0)|((e&4042322160)!==0?(e&=4042322160,4):0)|((e&3435973836)!==0?(e&=3435973836,2):0)|(e&2863311530)!==0}function ga(e,t,n,i,a){const o=1<<n;if(o==1)return[t[i]];if(o==2)return[e.G.add(t[i],t[i+a]),e.G.sub(t[i],t[i+a])];const s=o>>1,d=ga(e,t,n-1,i,a*2),h=ga(e,t,n-1,i+a,a*2),f=new Array(o);for(let l=0;l<s;l++)f[l]=e.G.add(d[l],e.opMulGF(h[l],e.roots[n][l])),f[l+s]=e.G.sub(d[l],e.opMulGF(h[l],e.roots[n][l]));return f}class Dc{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=vi(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=this.n64*2,this.n8=this.n64*8,this.R=this.e(this.one<<BigInt(this.n64*64)),this.Ri=this.inv(this.R);const n=this.negone>>this.one;this.nqr=this.two;let i=this.pow(this.nqr,n);for(;!this.eq(i,this.negone);)this.nqr=this.nqr+this.one,i=this.pow(this.nqr,n);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),D2(this),this.FFT=new $2(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,n){let i;if(n?n==16&&(i=BigInt("0x"+t)):i=BigInt(t),i<0){let a=-i;return a>=this.p&&(a=a%this.p),this.p-a}else return i>=this.p?i%this.p:i}add(t,n){const i=t+n;return i>=this.p?i-this.p:i}sub(t,n){return t>=n?t-n:this.p-n+t}neg(t){return t&&this.p-t}mul(t,n){return t*n%this.p}mulScalar(t,n){return t*this.e(n)%this.p}square(t){return t*t%this.p}eq(t,n){return t==n}neq(t,n){return t!=n}lt(t,n){const i=t>this.half?t-this.p:t,a=n>this.half?n-this.p:n;return i<a}gt(t,n){const i=t>this.half?t-this.p:t,a=n>this.half?n-this.p:n;return i>a}leq(t,n){const i=t>this.half?t-this.p:t,a=n>this.half?n-this.p:n;return i<=a}geq(t,n){const i=t>this.half?t-this.p:t,a=n>this.half?n-this.p:n;return i>=a}div(t,n){return this.mul(t,this.inv(n))}idiv(t,n){if(!n)throw new Error("Division by zero");return t/n}inv(t){if(!t)throw new Error("Division by zero");let n=this.zero,i=this.p,a=this.one,o=t%this.p;for(;o;){let s=i/o;[n,a]=[a,n-s*a],[i,o]=[o,i-s*o]}return n<this.zero&&(n+=this.p),n}mod(t,n){return t%n}pow(t,n){return Uc(this,t,n)}exp(t,n){return Uc(this,t,n)}band(t,n){const i=t&n&this.mask;return i>=this.p?i-this.p:i}bor(t,n){const i=(t|n)&this.mask;return i>=this.p?i-this.p:i}bxor(t,n){const i=(t^n)&this.mask;return i>=this.p?i-this.p:i}bnot(t){const n=t^this.mask;return n>=this.p?n-this.p:n}shl(t,n){if(Number(n)<this.bitLength){const i=t<<n&this.mask;return i>=this.p?i-this.p:i}else{const i=this.p-n;return Number(i)<this.bitLength?t>>i:this.zero}}shr(t,n){if(Number(n)<this.bitLength)return t>>n;{const i=this.p-n;if(Number(i)<this.bitLength){const a=t<<i&this.mask;return a>=this.p?a-this.p:a}else return 0}}land(t,n){return t&&n?this.one:this.zero}lor(t,n){return t||n?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let i=this.s,a=this.nqr_to_t,o=this.pow(t,this.t),s=this.pow(t,this.add(this.t,this.one)>>this.one);for(;o!=this.one;){let d=this.square(o),h=1;for(;d!=this.one;)h++,d=this.square(d);let f=a;for(let l=0;l<i-h-1;l++)f=this.square(f);i=h,a=this.square(f),o=this.mul(o,a),s=this.mul(s,f)}return s>this.p>>this.one&&(s=this.neg(s)),s}normalize(t,n){if(t=BigInt(t,n),t<0){let i=-t;return i>=this.p&&(i=i%this.p),this.p-i}else return t>=this.p?t%this.p:t}random(){const t=this.bitLength*2/8;let n=this.zero;for(let i=0;i<t;i++)n=(n<<BigInt(8))+BigInt(Gc(1)[0]);return n%this.p}toString(t,n){n=n||10;let i;return t>this.half&&n==10?i="-"+(this.p-t).toString(n):i=t.toString(n),i}isZero(t){return t==this.zero}fromRng(t){let n;do{n=this.zero;for(let i=0;i<this.n64;i++)n+=t.nextU64()<<BigInt(64*i);n&=this.mask}while(n>=this.p);return n=n*this.Ri%this.p,n}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,n,i){xi(t,n,i,this.n64*8)}toRprBE(t,n,i){Pc(t,n,i,this.n64*8)}toRprBEM(t,n,i){return this.toRprBE(t,n,this.mul(this.R,i))}toRprLEM(t,n,i){return this.toRprLE(t,n,this.mul(this.R,i))}fromRprLE(t,n){return Ti(t,n,this.n8)}fromRprBE(t,n){return Oc(t,n,this.n8)}fromRprLEM(t,n){return this.mul(this.fromRprLE(t,n),this.Ri)}fromRprBEM(t,n){return this.mul(this.fromRprBE(t,n),this.Ri)}toObject(t){return t}}var gn={};gn.bigInt2BytesLE=function(t,n){const i=Array(n);let a=BigInt(t);for(let o=0;o<n;o++)i[o]=Number(a&0xFFn),a=a>>8n;return i},gn.bigInt2U32LE=function(t,n){const i=Array(n);let a=BigInt(t);for(let o=0;o<n;o++)i[o]=Number(a&0xFFFFFFFFn),a=a>>32n;return i},gn.isOcamNum=function(e){return!(!Array.isArray(e)||e.length!=3||typeof e[0]!="number"||typeof e[1]!="number"||!Array.isArray(e[2]))};var Z2=function(t,n,i){const a=i||"int";if(t.modules[a])return a;t.modules[a]={};const o=n*2,s=n*8;function d(){const v=t.addFunction(a+"_copy");v.addParam("px","i32"),v.addParam("pr","i32");const p=v.getCodeBuilder();for(let L=0;L<n;L++)v.addCode(p.i64_store(p.getLocal("pr"),L*8,p.i64_load(p.getLocal("px"),L*8)))}function h(){const v=t.addFunction(a+"_zero");v.addParam("pr","i32");const p=v.getCodeBuilder();for(let L=0;L<n;L++)v.addCode(p.i64_store(p.getLocal("pr"),L*8,p.i64_const(0)))}function f(){const v=t.addFunction(a+"_one");v.addParam("pr","i32");const p=v.getCodeBuilder();v.addCode(p.i64_store(p.getLocal("pr"),0,p.i64_const(1)));for(let L=1;L<n;L++)v.addCode(p.i64_store(p.getLocal("pr"),L*8,p.i64_const(0)))}function l(){const v=t.addFunction(a+"_isZero");v.addParam("px","i32"),v.setReturnType("i32");const p=v.getCodeBuilder();function L(U){return U==0?p.ret(p.i64_eqz(p.i64_load(p.getLocal("px")))):p.if(p.i64_eqz(p.i64_load(p.getLocal("px"),U*8)),L(U-1),p.ret(p.i32_const(0)))}v.addCode(L(n-1)),v.addCode(p.ret(p.i32_const(0)))}function m(){const v=t.addFunction(a+"_eq");v.addParam("px","i32"),v.addParam("py","i32"),v.setReturnType("i32");const p=v.getCodeBuilder();function L(U){return U==0?p.ret(p.i64_eq(p.i64_load(p.getLocal("px")),p.i64_load(p.getLocal("py")))):p.if(p.i64_eq(p.i64_load(p.getLocal("px"),U*8),p.i64_load(p.getLocal("py"),U*8)),L(U-1),p.ret(p.i32_const(0)))}v.addCode(L(n-1)),v.addCode(p.ret(p.i32_const(0)))}function I(){const v=t.addFunction(a+"_gte");v.addParam("px","i32"),v.addParam("py","i32"),v.setReturnType("i32");const p=v.getCodeBuilder();function L(U){return U==0?p.ret(p.i64_ge_u(p.i64_load(p.getLocal("px")),p.i64_load(p.getLocal("py")))):p.if(p.i64_lt_u(p.i64_load(p.getLocal("px"),U*8),p.i64_load(p.getLocal("py"),U*8)),p.ret(p.i32_const(0)),p.if(p.i64_gt_u(p.i64_load(p.getLocal("px"),U*8),p.i64_load(p.getLocal("py"),U*8)),p.ret(p.i32_const(1)),L(U-1)))}v.addCode(L(n-1)),v.addCode(p.ret(p.i32_const(0)))}function g(){const v=t.addFunction(a+"_add");v.addParam("x","i32"),v.addParam("y","i32"),v.addParam("r","i32"),v.setReturnType("i32"),v.addLocal("c","i64");const p=v.getCodeBuilder();v.addCode(p.setLocal("c",p.i64_add(p.i64_load32_u(p.getLocal("x")),p.i64_load32_u(p.getLocal("y"))))),v.addCode(p.i64_store32(p.getLocal("r"),p.getLocal("c")));for(let L=1;L<o;L++)v.addCode(p.setLocal("c",p.i64_add(p.i64_add(p.i64_load32_u(p.getLocal("x"),4*L),p.i64_load32_u(p.getLocal("y"),4*L)),p.i64_shr_u(p.getLocal("c"),p.i64_const(32))))),v.addCode(p.i64_store32(p.getLocal("r"),L*4,p.getLocal("c")));v.addCode(p.i32_wrap_i64(p.i64_shr_u(p.getLocal("c"),p.i64_const(32))))}function B(){const v=t.addFunction(a+"_sub");v.addParam("x","i32"),v.addParam("y","i32"),v.addParam("r","i32"),v.setReturnType("i32"),v.addLocal("c","i64");const p=v.getCodeBuilder();v.addCode(p.setLocal("c",p.i64_sub(p.i64_load32_u(p.getLocal("x")),p.i64_load32_u(p.getLocal("y"))))),v.addCode(p.i64_store32(p.getLocal("r"),p.i64_and(p.getLocal("c"),p.i64_const("0xFFFFFFFF"))));for(let L=1;L<o;L++)v.addCode(p.setLocal("c",p.i64_add(p.i64_sub(p.i64_load32_u(p.getLocal("x"),4*L),p.i64_load32_u(p.getLocal("y"),4*L)),p.i64_shr_s(p.getLocal("c"),p.i64_const(32))))),v.addCode(p.i64_store32(p.getLocal("r"),L*4,p.i64_and(p.getLocal("c"),p.i64_const("0xFFFFFFFF"))));v.addCode(p.i32_wrap_i64(p.i64_shr_s(p.getLocal("c"),p.i64_const(32))))}function P(){const v=t.addFunction(a+"_mul");v.addParam("x","i32"),v.addParam("y","i32"),v.addParam("r","i32"),v.addLocal("c0","i64"),v.addLocal("c1","i64");for(let b=0;b<o;b++)v.addLocal("x"+b,"i64"),v.addLocal("y"+b,"i64");const p=v.getCodeBuilder(),L=[],U=[];function q(b,D){let j,J;return L[b]?j=p.getLocal("x"+b):(j=p.teeLocal("x"+b,p.i64_load32_u(p.getLocal("x"),b*4)),L[b]=!0),U[D]?J=p.getLocal("y"+D):(J=p.teeLocal("y"+D,p.i64_load32_u(p.getLocal("y"),D*4)),U[D]=!0),p.i64_mul(j,J)}let O="c0",R="c1";for(let b=0;b<o*2-1;b++){for(let D=Math.max(0,b-o+1);D<=b&&D<o;D++){const j=b-D;v.addCode(p.setLocal(O,p.i64_add(p.i64_and(p.getLocal(O),p.i64_const(4294967295)),q(D,j)))),v.addCode(p.setLocal(R,p.i64_add(p.getLocal(R),p.i64_shr_u(p.getLocal(O),p.i64_const(32)))))}v.addCode(p.i64_store32(p.getLocal("r"),b*4,p.getLocal(O))),[O,R]=[R,O],v.addCode(p.setLocal(R,p.i64_shr_u(p.getLocal(O),p.i64_const(32))))}v.addCode(p.i64_store32(p.getLocal("r"),o*4*2-4,p.getLocal(O)))}function C(){const v=t.addFunction(a+"_square");v.addParam("x","i32"),v.addParam("r","i32"),v.addLocal("c0","i64"),v.addLocal("c1","i64"),v.addLocal("c0_old","i64"),v.addLocal("c1_old","i64");for(let D=0;D<o;D++)v.addLocal("x"+D,"i64");const p=v.getCodeBuilder(),L=[];function U(D,j){let J,tt;return L[D]?J=p.getLocal("x"+D):(J=p.teeLocal("x"+D,p.i64_load32_u(p.getLocal("x"),D*4)),L[D]=!0),L[j]?tt=p.getLocal("x"+j):(tt=p.teeLocal("x"+j,p.i64_load32_u(p.getLocal("x"),j*4)),L[j]=!0),p.i64_mul(J,tt)}let q="c0",O="c1",R="c0_old",b="c1_old";for(let D=0;D<o*2-1;D++){v.addCode(p.setLocal(q,p.i64_const(0)),p.setLocal(O,p.i64_const(0)));for(let j=Math.max(0,D-o+1);j<D+1>>1&&j<o;j++){const J=D-j;v.addCode(p.setLocal(q,p.i64_add(p.i64_and(p.getLocal(q),p.i64_const(4294967295)),U(j,J)))),v.addCode(p.setLocal(O,p.i64_add(p.getLocal(O),p.i64_shr_u(p.getLocal(q),p.i64_const(32)))))}v.addCode(p.setLocal(q,p.i64_shl(p.i64_and(p.getLocal(q),p.i64_const(4294967295)),p.i64_const(1)))),v.addCode(p.setLocal(O,p.i64_add(p.i64_shl(p.getLocal(O),p.i64_const(1)),p.i64_shr_u(p.getLocal(q),p.i64_const(32))))),D%2==0&&(v.addCode(p.setLocal(q,p.i64_add(p.i64_and(p.getLocal(q),p.i64_const(4294967295)),U(D>>1,D>>1)))),v.addCode(p.setLocal(O,p.i64_add(p.getLocal(O),p.i64_shr_u(p.getLocal(q),p.i64_const(32)))))),D>0&&(v.addCode(p.setLocal(q,p.i64_add(p.i64_and(p.getLocal(q),p.i64_const(4294967295)),p.i64_and(p.getLocal(R),p.i64_const(4294967295))))),v.addCode(p.setLocal(O,p.i64_add(p.i64_add(p.getLocal(O),p.i64_shr_u(p.getLocal(q),p.i64_const(32))),p.getLocal(b))))),v.addCode(p.i64_store32(p.getLocal("r"),D*4,p.getLocal(q))),v.addCode(p.setLocal(R,p.getLocal(O)),p.setLocal(b,p.i64_shr_u(p.getLocal(R),p.i64_const(32))))}v.addCode(p.i64_store32(p.getLocal("r"),o*4*2-4,p.getLocal(R)))}function N(){const v=t.addFunction(a+"_squareOld");v.addParam("x","i32"),v.addParam("r","i32");const p=v.getCodeBuilder();v.addCode(p.call(a+"_mul",p.getLocal("x"),p.getLocal("x"),p.getLocal("r")))}function T(){const v=t.addFunction(a+"__mul1");v.addParam("px","i32"),v.addParam("y","i64"),v.addParam("pr","i32"),v.addLocal("c","i64");const p=v.getCodeBuilder();v.addCode(p.setLocal("c",p.i64_mul(p.i64_load32_u(p.getLocal("px"),0,0),p.getLocal("y")))),v.addCode(p.i64_store32(p.getLocal("pr"),0,0,p.getLocal("c")));for(let L=1;L<o;L++)v.addCode(p.setLocal("c",p.i64_add(p.i64_mul(p.i64_load32_u(p.getLocal("px"),4*L,0),p.getLocal("y")),p.i64_shr_u(p.getLocal("c"),p.i64_const(32))))),v.addCode(p.i64_store32(p.getLocal("pr"),L*4,0,p.getLocal("c")))}function K(){const v=t.addFunction(a+"__add1");v.addParam("x","i32"),v.addParam("y","i64"),v.addLocal("c","i64"),v.addLocal("px","i32");const p=v.getCodeBuilder();v.addCode(p.setLocal("px",p.getLocal("x"))),v.addCode(p.setLocal("c",p.i64_add(p.i64_load32_u(p.getLocal("px"),0,0),p.getLocal("y")))),v.addCode(p.i64_store32(p.getLocal("px"),0,0,p.getLocal("c"))),v.addCode(p.setLocal("c",p.i64_shr_u(p.getLocal("c"),p.i64_const(32)))),v.addCode(p.block(p.loop(p.br_if(1,p.i64_eqz(p.getLocal("c"))),p.setLocal("px",p.i32_add(p.getLocal("px"),p.i32_const(4))),p.setLocal("c",p.i64_add(p.i64_load32_u(p.getLocal("px"),0,0),p.getLocal("c"))),p.i64_store32(p.getLocal("px"),0,0,p.getLocal("c")),p.setLocal("c",p.i64_shr_u(p.getLocal("c"),p.i64_const(32))),p.br(0))))}function M(){T(),K();const v=t.addFunction(a+"_div");v.addParam("x","i32"),v.addParam("y","i32"),v.addParam("c","i32"),v.addParam("r","i32"),v.addLocal("rr","i32"),v.addLocal("cc","i32"),v.addLocal("eX","i32"),v.addLocal("eY","i32"),v.addLocal("sy","i64"),v.addLocal("sx","i64"),v.addLocal("ec","i32");const p=v.getCodeBuilder(),L=p.i32_const(t.alloc(s)),U=p.i32_const(t.alloc(s)),q=p.i32_const(t.alloc(s)),O=p.getLocal("cc"),R=p.getLocal("rr"),b=t.alloc(s*2),D=p.i32_const(b),j=p.i32_const(b+s);v.addCode(p.if(p.getLocal("c"),p.setLocal("cc",p.getLocal("c")),p.setLocal("cc",U))),v.addCode(p.if(p.getLocal("r"),p.setLocal("rr",p.getLocal("r")),p.setLocal("rr",q))),v.addCode(p.call(a+"_copy",p.getLocal("x"),R)),v.addCode(p.call(a+"_copy",p.getLocal("y"),L)),v.addCode(p.call(a+"_zero",O)),v.addCode(p.call(a+"_zero",D)),v.addCode(p.setLocal("eX",p.i32_const(s-1))),v.addCode(p.setLocal("eY",p.i32_const(s-1))),v.addCode(p.block(p.loop(p.br_if(1,p.i32_or(p.i32_load8_u(p.i32_add(L,p.getLocal("eY")),0,0),p.i32_eq(p.getLocal("eY"),p.i32_const(3)))),p.setLocal("eY",p.i32_sub(p.getLocal("eY"),p.i32_const(1))),p.br(0)))),v.addCode(p.setLocal("sy",p.i64_add(p.i64_load32_u(p.i32_sub(p.i32_add(L,p.getLocal("eY")),p.i32_const(3)),0,0),p.i64_const(1)))),v.addCode(p.if(p.i64_eq(p.getLocal("sy"),p.i64_const(1)),p.drop(p.i64_div_u(p.i64_const(0),p.i64_const(0))))),v.addCode(p.block(p.loop(p.block(p.loop(p.br_if(1,p.i32_or(p.i32_load8_u(p.i32_add(R,p.getLocal("eX")),0,0),p.i32_eq(p.getLocal("eX"),p.i32_const(7)))),p.setLocal("eX",p.i32_sub(p.getLocal("eX"),p.i32_const(1))),p.br(0))),p.setLocal("sx",p.i64_load(p.i32_sub(p.i32_add(R,p.getLocal("eX")),p.i32_const(7)),0,0)),p.setLocal("sx",p.i64_div_u(p.getLocal("sx"),p.getLocal("sy"))),p.setLocal("ec",p.i32_sub(p.i32_sub(p.getLocal("eX"),p.getLocal("eY")),p.i32_const(4))),p.block(p.loop(p.br_if(1,p.i32_and(p.i64_eqz(p.i64_and(p.getLocal("sx"),p.i64_const("0xFFFFFFFF00000000"))),p.i32_ge_s(p.getLocal("ec"),p.i32_const(0)))),p.setLocal("sx",p.i64_shr_u(p.getLocal("sx"),p.i64_const(8))),p.setLocal("ec",p.i32_add(p.getLocal("ec"),p.i32_const(1))),p.br(0))),p.if(p.i64_eqz(p.getLocal("sx")),[...p.br_if(2,p.i32_eqz(p.call(a+"_gte",R,L))),...p.setLocal("sx",p.i64_const(1)),...p.setLocal("ec",p.i32_const(0))]),p.call(a+"__mul1",L,p.getLocal("sx"),j),p.drop(p.call(a+"_sub",R,p.i32_sub(j,p.getLocal("ec")),R)),p.call(a+"__add1",p.i32_add(O,p.getLocal("ec")),p.getLocal("sx")),p.br(0))))}function V(){const v=t.addFunction(a+"_inverseMod");v.addParam("px","i32"),v.addParam("pm","i32"),v.addParam("pr","i32"),v.addLocal("t","i32"),v.addLocal("newt","i32"),v.addLocal("r","i32"),v.addLocal("qq","i32"),v.addLocal("qr","i32"),v.addLocal("newr","i32"),v.addLocal("swp","i32"),v.addLocal("x","i32"),v.addLocal("signt","i32"),v.addLocal("signnewt","i32"),v.addLocal("signx","i32");const p=v.getCodeBuilder(),L=p.i32_const(t.alloc(s)),U=p.i32_const(t.alloc(s)),q=p.i32_const(t.alloc(s)),O=p.i32_const(t.alloc(s)),R=p.i32_const(t.alloc(s)),b=p.i32_const(t.alloc(s)),D=p.i32_const(t.alloc(s*2)),j=p.i32_const(t.alloc(s));v.addCode(p.setLocal("t",L),p.call(a+"_zero",L),p.setLocal("signt",p.i32_const(0))),v.addCode(p.setLocal("r",U),p.call(a+"_copy",p.getLocal("pm"),U)),v.addCode(p.setLocal("newt",q),p.call(a+"_one",q),p.setLocal("signnewt",p.i32_const(0))),v.addCode(p.setLocal("newr",O),p.call(a+"_copy",p.getLocal("px"),O)),v.addCode(p.setLocal("qq",R)),v.addCode(p.setLocal("qr",b)),v.addCode(p.setLocal("x",j)),v.addCode(p.block(p.loop(p.br_if(1,p.call(a+"_isZero",p.getLocal("newr"))),p.call(a+"_div",p.getLocal("r"),p.getLocal("newr"),p.getLocal("qq"),p.getLocal("qr")),p.call(a+"_mul",p.getLocal("qq"),p.getLocal("newt"),D),p.if(p.getLocal("signt"),p.if(p.getLocal("signnewt"),p.if(p.call(a+"_gte",D,p.getLocal("t")),[...p.drop(p.call(a+"_sub",D,p.getLocal("t"),p.getLocal("x"))),...p.setLocal("signx",p.i32_const(0))],[...p.drop(p.call(a+"_sub",p.getLocal("t"),D,p.getLocal("x"))),...p.setLocal("signx",p.i32_const(1))]),[...p.drop(p.call(a+"_add",D,p.getLocal("t"),p.getLocal("x"))),...p.setLocal("signx",p.i32_const(1))]),p.if(p.getLocal("signnewt"),[...p.drop(p.call(a+"_add",D,p.getLocal("t"),p.getLocal("x"))),...p.setLocal("signx",p.i32_const(0))],p.if(p.call(a+"_gte",p.getLocal("t"),D),[...p.drop(p.call(a+"_sub",p.getLocal("t"),D,p.getLocal("x"))),...p.setLocal("signx",p.i32_const(0))],[...p.drop(p.call(a+"_sub",D,p.getLocal("t"),p.getLocal("x"))),...p.setLocal("signx",p.i32_const(1))]))),p.setLocal("swp",p.getLocal("t")),p.setLocal("t",p.getLocal("newt")),p.setLocal("newt",p.getLocal("x")),p.setLocal("x",p.getLocal("swp")),p.setLocal("signt",p.getLocal("signnewt")),p.setLocal("signnewt",p.getLocal("signx")),p.setLocal("swp",p.getLocal("r")),p.setLocal("r",p.getLocal("newr")),p.setLocal("newr",p.getLocal("qr")),p.setLocal("qr",p.getLocal("swp")),p.br(0)))),v.addCode(p.if(p.getLocal("signt"),p.drop(p.call(a+"_sub",p.getLocal("pm"),p.getLocal("t"),p.getLocal("pr"))),p.call(a+"_copy",p.getLocal("t"),p.getLocal("pr"))))}return d(),h(),l(),f(),m(),I(),g(),B(),P(),C(),N(),M(),V(),t.exportFunction(a+"_copy"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_gte"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_square"),t.exportFunction(a+"_squareOld"),t.exportFunction(a+"_div"),t.exportFunction(a+"_inverseMod"),a},xo=function(t,n,i,a,o,s,d){const h=t.addFunction(n);h.addParam("base","i32"),h.addParam("scalar","i32"),h.addParam("scalarLength","i32"),h.addParam("r","i32"),h.addLocal("i","i32"),h.addLocal("b","i32");const f=h.getCodeBuilder(),l=f.i32_const(t.alloc(i));h.addCode(f.if(f.i32_eqz(f.getLocal("scalarLength")),[...f.call(d,f.getLocal("r")),...f.ret([])])),h.addCode(f.call(s,f.getLocal("base"),l)),h.addCode(f.call(d,f.getLocal("r"))),h.addCode(f.setLocal("i",f.getLocal("scalarLength"))),h.addCode(f.block(f.loop(f.setLocal("i",f.i32_sub(f.getLocal("i"),f.i32_const(1))),f.setLocal("b",f.i32_load8_u(f.i32_add(f.getLocal("scalar"),f.getLocal("i")))),...m(),f.br_if(1,f.i32_eqz(f.getLocal("i"))),f.br(0))));function m(){const I=[];for(let g=0;g<8;g++)I.push(...f.call(o,f.getLocal("r"),f.getLocal("r")),...f.if(f.i32_ge_u(f.getLocal("b"),f.i32_const(128>>g)),[...f.setLocal("b",f.i32_sub(f.getLocal("b"),f.i32_const(128>>g))),...f.call(a,f.getLocal("r"),l,f.getLocal("r"))]));return I}},To=J2;function J2(e,t){const n=e.modules[t].n64*8,i=e.addFunction(t+"_batchInverse");i.addParam("pIn","i32"),i.addParam("inStep","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addParam("outStep","i32"),i.addLocal("itAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");const a=i.getCodeBuilder(),o=a.i32_const(e.alloc(n));i.addCode(a.setLocal("itAux",a.i32_load(a.i32_const(0))),a.i32_store(a.i32_const(0),a.i32_add(a.getLocal("itAux"),a.i32_mul(a.i32_add(a.getLocal("n"),a.i32_const(1)),a.i32_const(n))))),i.addCode(a.call(t+"_one",a.getLocal("itAux")),a.setLocal("itIn",a.getLocal("pIn")),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("i",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("i"),a.getLocal("n"))),a.if(a.call(t+"_isZero",a.getLocal("itIn")),a.call(t+"_copy",a.i32_sub(a.getLocal("itAux"),a.i32_const(n)),a.getLocal("itAux")),a.call(t+"_mul",a.getLocal("itIn"),a.i32_sub(a.getLocal("itAux"),a.i32_const(n)),a.getLocal("itAux"))),a.setLocal("itIn",a.i32_add(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))),a.setLocal("itIn",a.i32_sub(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itAux",a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("itOut",a.i32_add(a.getLocal("pOut"),a.i32_mul(a.i32_sub(a.getLocal("n"),a.i32_const(1)),a.getLocal("outStep")))),a.call(t+"_inverse",a.getLocal("itAux"),a.getLocal("itAux")),a.block(a.loop(a.br_if(1,a.i32_eqz(a.getLocal("i"))),a.if(a.call(t+"_isZero",a.getLocal("itIn")),[...a.call(t+"_copy",a.getLocal("itAux"),a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),...a.call(t+"_zero",a.getLocal("itOut"))],[...a.call(t+"_copy",a.i32_sub(a.getLocal("itAux"),a.i32_const(n)),o),...a.call(t+"_mul",a.getLocal("itAux"),a.getLocal("itIn"),a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),...a.call(t+"_mul",a.getLocal("itAux"),o,a.getLocal("itOut"))]),a.setLocal("itIn",a.i32_sub(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itOut",a.i32_sub(a.getLocal("itOut"),a.getLocal("outStep"))),a.setLocal("itAux",a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("i",a.i32_sub(a.getLocal("i"),a.i32_const(1))),a.br(0)))),i.addCode(a.i32_store(a.i32_const(0),a.getLocal("itAux")))}var Nc=X2;function X2(e,t,n,i,a,o){typeof o>"u"&&(i<a?o=!0:o=!1);const s=e.addFunction(t);s.addParam("pIn","i32"),s.addParam("n","i32"),s.addParam("pOut","i32"),s.addLocal("i","i32"),s.addLocal("itIn","i32"),s.addLocal("itOut","i32");const d=s.getCodeBuilder();o?s.addCode(d.setLocal("itIn",d.i32_add(d.getLocal("pIn"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(i)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_sub(d.getLocal("itIn"),d.i32_const(i))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(a))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):s.addCode(d.setLocal("itIn",d.getLocal("pIn")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_add(d.getLocal("itIn"),d.i32_const(i))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(a))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}var t_=e_;function e_(e,t,n,i,a,o){typeof o>"u"&&(i<a?o=!0:o=!1);const s=e.addFunction(t);s.addParam("pIn1","i32"),s.addParam("pIn2","i32"),s.addParam("n","i32"),s.addParam("pOut","i32"),s.addLocal("i","i32"),s.addLocal("itIn1","i32"),s.addLocal("itIn2","i32"),s.addLocal("itOut","i32");const d=s.getCodeBuilder();o?s.addCode(d.setLocal("itIn1",d.i32_add(d.getLocal("pIn1"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(i)))),d.setLocal("itIn2",d.i32_add(d.getLocal("pIn2"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(i)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_sub(d.getLocal("itIn1"),d.i32_const(i))),d.setLocal("itIn2",d.i32_sub(d.getLocal("itIn2"),d.i32_const(i))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(a))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):s.addCode(d.setLocal("itIn1",d.getLocal("pIn1")),d.setLocal("itIn2",d.getLocal("pIn2")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_add(d.getLocal("itIn1"),d.i32_const(i))),d.setLocal("itIn2",d.i32_add(d.getLocal("itIn2"),d.i32_const(i))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(a))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}var we={};function kc(e,t){return e===t?0:e>t?1:-1}function Po(e){return e*e}function zc(e){return e%2n!==0n}function Oo(e){return e%2n===0n}function pa(e){return e<0n}function n_(e){return e>0n}function qc(e){return pa(e)?e.toString(2).length-1:e.toString(2).length}function Oi(e){return e<0n?-e:e}function ii(e){return Oi(e)===1n}function Qc(e,t){for(var n=0n,i=1n,a=t,o=Oi(e),s,d,h;o!==0n;)s=a/o,d=n,h=a,n=i,a=o,i=d-s*i,o=h-s*o;if(!ii(a))throw new Error(e.toString()+" and "+t.toString()+" are not co-prime");return kc(n,0n)===-1&&(n=n+t),pa(e)?-n:n}function Hc(e,t,n){if(n===0n)throw new Error("Cannot take modPow with modulus 0");var i=1n,a=e%n;for(pa(t)&&(t=t*-1n,a=Qc(a,n));n_(t);){if(a===0n)return 0n;zc(t)&&(i=i*a%n),t=t/2n,a=Po(a)%n}return i}function i_(e,t){return e=e>=0n?e:-e,t=t>=0n?t:-t,e===t?0:e>t?1:-1}function Wc(e,t){return t===0n?!1:ii(t)?!0:i_(t,2n)===0?Oo(e):e%t===0n}function a_(e){var t=Oi(e);if(ii(t))return!1;if(t===2n||t===3n||t===5n)return!0;if(Oo(t)||Wc(t,3n)||Wc(t,5n))return!1;if(t<49n)return!0}function o_(e){return e-1n}function Kc(e,t){for(var n=o_(e),i=n,a=0,o,s,d;Oo(i);)i=i/2n,a++;t:for(s=0;s<t.length;s++)if(!(e<t[s])&&(d=Hc(BigInt(t[s]),i,e),!(ii(d)||d===n))){for(o=a-1;o!=0;o--){if(d=Po(d)%e,ii(d))return!1;if(d===n)continue t}return!1}return!0}function r_(e){var t=a_(e);if(t!==void 0)return t;var n=Oi(e),i=qc(n);if(i<=64)return Kc(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var a=Math.log(2)*Number(i),o=Math.ceil(a),s=[],d=0;d<o;d++)s.push(BigInt(d+2));return Kc(n,s)}we.bitLength=qc,we.isOdd=zc,we.isNegative=pa,we.abs=Oi,we.isUnit=ii,we.compare=kc,we.modInv=Qc,we.modPow=Hc,we.isPrime=r_,we.square=Po;const s_=Z2,on=gn,c_=xo,l_=To,Ro=Nc,Uo=t_,{bitLength:d_,modInv:Go,modPow:Vc,isPrime:jc,isOdd:u_,square:f_}=we;var Mo=function(t,n,i,a){const o=BigInt(n),s=Math.floor((d_(o-1n)-1)/64)+1,d=s*2,h=s*8,f=i||"f1m";if(t.modules[f])return f;const l=s_(t,s,a),m=t.alloc(h,on.bigInt2BytesLE(o,h)),I=t.alloc(on.bigInt2BytesLE(f_(1n<<BigInt(s*64))%o,h)),g=t.alloc(on.bigInt2BytesLE((1n<<BigInt(s*64))%o,h)),B=t.alloc(on.bigInt2BytesLE(0n,h)),P=o-1n,C=P>>1n,N=t.alloc(h,on.bigInt2BytesLE(C,h)),T=C+1n,K=t.alloc(h,on.bigInt2BytesLE(T,h));t.modules[f]={pq:m,pR2:I,n64:s,q:o,pOne:g,pZero:B,pePlusOne:K};function M(){const G=t.addFunction(f+"_one");G.addParam("pr","i32");const w=G.getCodeBuilder();G.addCode(w.call(l+"_copy",w.i32_const(g),w.getLocal("pr")))}function V(){const G=t.addFunction(f+"_add");G.addParam("x","i32"),G.addParam("y","i32"),G.addParam("r","i32");const w=G.getCodeBuilder();G.addCode(w.if(w.call(l+"_add",w.getLocal("x"),w.getLocal("y"),w.getLocal("r")),w.drop(w.call(l+"_sub",w.getLocal("r"),w.i32_const(m),w.getLocal("r"))),w.if(w.call(l+"_gte",w.getLocal("r"),w.i32_const(m)),w.drop(w.call(l+"_sub",w.getLocal("r"),w.i32_const(m),w.getLocal("r"))))))}function v(){const G=t.addFunction(f+"_sub");G.addParam("x","i32"),G.addParam("y","i32"),G.addParam("r","i32");const w=G.getCodeBuilder();G.addCode(w.if(w.call(l+"_sub",w.getLocal("x"),w.getLocal("y"),w.getLocal("r")),w.drop(w.call(l+"_add",w.getLocal("r"),w.i32_const(m),w.getLocal("r")))))}function p(){const G=t.addFunction(f+"_neg");G.addParam("x","i32"),G.addParam("r","i32");const w=G.getCodeBuilder();G.addCode(w.call(f+"_sub",w.i32_const(B),w.getLocal("x"),w.getLocal("r")))}function L(){const G=t.addFunction(f+"_isNegative");G.addParam("x","i32"),G.setReturnType("i32");const w=G.getCodeBuilder(),k=w.i32_const(t.alloc(h));G.addCode(w.call(f+"_fromMontgomery",w.getLocal("x"),k),w.call(l+"_gte",k,w.i32_const(K)))}function U(){const G=t.addFunction(f+"_sign");G.addParam("x","i32"),G.setReturnType("i32");const w=G.getCodeBuilder(),k=w.i32_const(t.alloc(h));G.addCode(w.if(w.call(l+"_isZero",w.getLocal("x")),w.ret(w.i32_const(0))),w.call(f+"_fromMontgomery",w.getLocal("x"),k),w.if(w.call(l+"_gte",k,w.i32_const(K)),w.ret(w.i32_const(-1))),w.ret(w.i32_const(1)))}function q(){const G=t.alloc(d*d*8),w=t.addFunction(f+"_mReduct");w.addParam("t","i32"),w.addParam("r","i32"),w.addLocal("np32","i64"),w.addLocal("c","i64"),w.addLocal("m","i64");const k=w.getCodeBuilder(),ot=Number(0x100000000n-Go(o,0x100000000n));w.addCode(k.setLocal("np32",k.i64_const(ot)));for(let Y=0;Y<d;Y++){w.addCode(k.setLocal("c",k.i64_const(0))),w.addCode(k.setLocal("m",k.i64_and(k.i64_mul(k.i64_load32_u(k.getLocal("t"),Y*4),k.getLocal("np32")),k.i64_const("0xFFFFFFFF"))));for(let nt=0;nt<d;nt++)w.addCode(k.setLocal("c",k.i64_add(k.i64_add(k.i64_load32_u(k.getLocal("t"),(Y+nt)*4),k.i64_shr_u(k.getLocal("c"),k.i64_const(32))),k.i64_mul(k.i64_load32_u(k.i32_const(m),nt*4),k.getLocal("m"))))),w.addCode(k.i64_store32(k.getLocal("t"),(Y+nt)*4,k.getLocal("c")));w.addCode(k.i64_store32(k.i32_const(G),Y*4,k.i64_shr_u(k.getLocal("c"),k.i64_const(32))))}w.addCode(k.call(f+"_add",k.i32_const(G),k.i32_add(k.getLocal("t"),k.i32_const(d*4)),k.getLocal("r")))}function O(){const G=t.addFunction(f+"_mul");G.addParam("x","i32"),G.addParam("y","i32"),G.addParam("r","i32"),G.addLocal("c0","i64"),G.addLocal("c1","i64"),G.addLocal("np32","i64");for(let ct=0;ct<d;ct++)G.addLocal("x"+ct,"i64"),G.addLocal("y"+ct,"i64"),G.addLocal("m"+ct,"i64"),G.addLocal("q"+ct,"i64");const w=G.getCodeBuilder(),k=Number(0x100000000n-Go(o,0x100000000n));G.addCode(w.setLocal("np32",w.i64_const(k)));const ot=[],Y=[],nt=[];function ft(ct,_t){let wt,Et;return ot[ct]?wt=w.getLocal("x"+ct):(wt=w.teeLocal("x"+ct,w.i64_load32_u(w.getLocal("x"),ct*4)),ot[ct]=!0),Y[_t]?Et=w.getLocal("y"+_t):(Et=w.teeLocal("y"+_t,w.i64_load32_u(w.getLocal("y"),_t*4)),Y[_t]=!0),w.i64_mul(wt,Et)}function Lt(ct,_t){let wt,Et;return nt[ct]?wt=w.getLocal("q"+ct):(wt=w.teeLocal("q"+ct,w.i64_load32_u(w.i32_const(0),m+ct*4)),nt[ct]=!0),Et=w.getLocal("m"+_t),w.i64_mul(wt,Et)}let At="c0",ht="c1";for(let ct=0;ct<d*2-1;ct++){for(let _t=Math.max(0,ct-d+1);_t<=ct&&_t<d;_t++){const wt=ct-_t;G.addCode(w.setLocal(At,w.i64_add(w.i64_and(w.getLocal(At),w.i64_const(4294967295)),ft(_t,wt)))),G.addCode(w.setLocal(ht,w.i64_add(w.getLocal(ht),w.i64_shr_u(w.getLocal(At),w.i64_const(32)))))}for(let _t=Math.max(1,ct-d+1);_t<=ct&&_t<d;_t++){const wt=ct-_t;G.addCode(w.setLocal(At,w.i64_add(w.i64_and(w.getLocal(At),w.i64_const(4294967295)),Lt(_t,wt)))),G.addCode(w.setLocal(ht,w.i64_add(w.getLocal(ht),w.i64_shr_u(w.getLocal(At),w.i64_const(32)))))}ct<d&&(G.addCode(w.setLocal("m"+ct,w.i64_and(w.i64_mul(w.i64_and(w.getLocal(At),w.i64_const(4294967295)),w.getLocal("np32")),w.i64_const("0xFFFFFFFF")))),G.addCode(w.setLocal(At,w.i64_add(w.i64_and(w.getLocal(At),w.i64_const(4294967295)),Lt(0,ct)))),G.addCode(w.setLocal(ht,w.i64_add(w.getLocal(ht),w.i64_shr_u(w.getLocal(At),w.i64_const(32)))))),ct>=d&&G.addCode(w.i64_store32(w.getLocal("r"),(ct-d)*4,w.getLocal(At))),[At,ht]=[ht,At],G.addCode(w.setLocal(ht,w.i64_shr_u(w.getLocal(At),w.i64_const(32))))}G.addCode(w.i64_store32(w.getLocal("r"),d*4-4,w.getLocal(At))),G.addCode(w.if(w.i32_wrap_i64(w.getLocal(ht)),w.drop(w.call(l+"_sub",w.getLocal("r"),w.i32_const(m),w.getLocal("r"))),w.if(w.call(l+"_gte",w.getLocal("r"),w.i32_const(m)),w.drop(w.call(l+"_sub",w.getLocal("r"),w.i32_const(m),w.getLocal("r"))))))}function R(){const G=t.addFunction(f+"_square");G.addParam("x","i32"),G.addParam("r","i32"),G.addLocal("c0","i64"),G.addLocal("c1","i64"),G.addLocal("c0_old","i64"),G.addLocal("c1_old","i64"),G.addLocal("np32","i64");for(let _t=0;_t<d;_t++)G.addLocal("x"+_t,"i64"),G.addLocal("m"+_t,"i64"),G.addLocal("q"+_t,"i64");const w=G.getCodeBuilder(),k=Number(0x100000000n-Go(o,0x100000000n));G.addCode(w.setLocal("np32",w.i64_const(k)));const ot=[],Y=[];function nt(_t,wt){let Et,Tt;return ot[_t]?Et=w.getLocal("x"+_t):(Et=w.teeLocal("x"+_t,w.i64_load32_u(w.getLocal("x"),_t*4)),ot[_t]=!0),ot[wt]?Tt=w.getLocal("x"+wt):(Tt=w.teeLocal("x"+wt,w.i64_load32_u(w.getLocal("x"),wt*4)),ot[wt]=!0),w.i64_mul(Et,Tt)}function ft(_t,wt){let Et,Tt;return Y[_t]?Et=w.getLocal("q"+_t):(Et=w.teeLocal("q"+_t,w.i64_load32_u(w.i32_const(0),m+_t*4)),Y[_t]=!0),Tt=w.getLocal("m"+wt),w.i64_mul(Et,Tt)}let Lt="c0",At="c1",ht="c0_old",ct="c1_old";for(let _t=0;_t<d*2-1;_t++){G.addCode(w.setLocal(Lt,w.i64_const(0)),w.setLocal(At,w.i64_const(0)));for(let wt=Math.max(0,_t-d+1);wt<_t+1>>1&&wt<d;wt++){const Et=_t-wt;G.addCode(w.setLocal(Lt,w.i64_add(w.i64_and(w.getLocal(Lt),w.i64_const(4294967295)),nt(wt,Et)))),G.addCode(w.setLocal(At,w.i64_add(w.getLocal(At),w.i64_shr_u(w.getLocal(Lt),w.i64_const(32)))))}G.addCode(w.setLocal(Lt,w.i64_shl(w.i64_and(w.getLocal(Lt),w.i64_const(4294967295)),w.i64_const(1)))),G.addCode(w.setLocal(At,w.i64_add(w.i64_shl(w.getLocal(At),w.i64_const(1)),w.i64_shr_u(w.getLocal(Lt),w.i64_const(32))))),_t%2==0&&(G.addCode(w.setLocal(Lt,w.i64_add(w.i64_and(w.getLocal(Lt),w.i64_const(4294967295)),nt(_t>>1,_t>>1)))),G.addCode(w.setLocal(At,w.i64_add(w.getLocal(At),w.i64_shr_u(w.getLocal(Lt),w.i64_const(32)))))),_t>0&&(G.addCode(w.setLocal(Lt,w.i64_add(w.i64_and(w.getLocal(Lt),w.i64_const(4294967295)),w.i64_and(w.getLocal(ht),w.i64_const(4294967295))))),G.addCode(w.setLocal(At,w.i64_add(w.i64_add(w.getLocal(At),w.i64_shr_u(w.getLocal(Lt),w.i64_const(32))),w.getLocal(ct)))));for(let wt=Math.max(1,_t-d+1);wt<=_t&&wt<d;wt++){const Et=_t-wt;G.addCode(w.setLocal(Lt,w.i64_add(w.i64_and(w.getLocal(Lt),w.i64_const(4294967295)),ft(wt,Et)))),G.addCode(w.setLocal(At,w.i64_add(w.getLocal(At),w.i64_shr_u(w.getLocal(Lt),w.i64_const(32)))))}_t<d&&(G.addCode(w.setLocal("m"+_t,w.i64_and(w.i64_mul(w.i64_and(w.getLocal(Lt),w.i64_const(4294967295)),w.getLocal("np32")),w.i64_const("0xFFFFFFFF")))),G.addCode(w.setLocal(Lt,w.i64_add(w.i64_and(w.getLocal(Lt),w.i64_const(4294967295)),ft(0,_t)))),G.addCode(w.setLocal(At,w.i64_add(w.getLocal(At),w.i64_shr_u(w.getLocal(Lt),w.i64_const(32)))))),_t>=d&&G.addCode(w.i64_store32(w.getLocal("r"),(_t-d)*4,w.getLocal(Lt))),G.addCode(w.setLocal(ht,w.getLocal(At)),w.setLocal(ct,w.i64_shr_u(w.getLocal(ht),w.i64_const(32))))}G.addCode(w.i64_store32(w.getLocal("r"),d*4-4,w.getLocal(ht))),G.addCode(w.if(w.i32_wrap_i64(w.getLocal(ct)),w.drop(w.call(l+"_sub",w.getLocal("r"),w.i32_const(m),w.getLocal("r"))),w.if(w.call(l+"_gte",w.getLocal("r"),w.i32_const(m)),w.drop(w.call(l+"_sub",w.getLocal("r"),w.i32_const(m),w.getLocal("r"))))))}function b(){const G=t.addFunction(f+"_squareOld");G.addParam("x","i32"),G.addParam("r","i32");const w=G.getCodeBuilder();G.addCode(w.call(f+"_mul",w.getLocal("x"),w.getLocal("x"),w.getLocal("r")))}function D(){const G=t.addFunction(f+"_toMontgomery");G.addParam("x","i32"),G.addParam("r","i32");const w=G.getCodeBuilder();G.addCode(w.call(f+"_mul",w.getLocal("x"),w.i32_const(I),w.getLocal("r")))}function j(){const G=t.alloc(h*2),w=t.addFunction(f+"_fromMontgomery");w.addParam("x","i32"),w.addParam("r","i32");const k=w.getCodeBuilder();w.addCode(k.call(l+"_copy",k.getLocal("x"),k.i32_const(G))),w.addCode(k.call(l+"_zero",k.i32_const(G+h))),w.addCode(k.call(f+"_mReduct",k.i32_const(G),k.getLocal("r")))}function J(){const G=t.addFunction(f+"_inverse");G.addParam("x","i32"),G.addParam("r","i32");const w=G.getCodeBuilder();G.addCode(w.call(f+"_fromMontgomery",w.getLocal("x"),w.getLocal("r"))),G.addCode(w.call(l+"_inverseMod",w.getLocal("r"),w.i32_const(m),w.getLocal("r"))),G.addCode(w.call(f+"_toMontgomery",w.getLocal("r"),w.getLocal("r")))}let tt=2n;if(jc(o))for(;Vc(tt,C,o)!==P;)tt=tt+1n;let $=0,et=P;for(;!u_(et)&&et!==0n;)$++,et=et>>1n;const X=t.alloc(h,on.bigInt2BytesLE(et,h)),dt=Vc(tt,et,o),rt=t.alloc(on.bigInt2BytesLE((dt<<BigInt(s*64))%o,h)),mt=et+1n>>1n,gt=t.alloc(h,on.bigInt2BytesLE(mt,h));function A(){const G=t.addFunction(f+"_sqrt");G.addParam("n","i32"),G.addParam("r","i32"),G.addLocal("m","i32"),G.addLocal("i","i32"),G.addLocal("j","i32");const w=G.getCodeBuilder(),k=w.i32_const(g),ot=w.i32_const(t.alloc(h)),Y=w.i32_const(t.alloc(h)),nt=w.i32_const(t.alloc(h)),ft=w.i32_const(t.alloc(h)),Lt=w.i32_const(t.alloc(h));G.addCode(w.if(w.call(f+"_isZero",w.getLocal("n")),w.ret(w.call(f+"_zero",w.getLocal("r")))),w.setLocal("m",w.i32_const($)),w.call(f+"_copy",w.i32_const(rt),ot),w.call(f+"_exp",w.getLocal("n"),w.i32_const(X),w.i32_const(h),Y),w.call(f+"_exp",w.getLocal("n"),w.i32_const(gt),w.i32_const(h),nt),w.block(w.loop(w.br_if(1,w.call(f+"_eq",Y,k)),w.call(f+"_square",Y,ft),w.setLocal("i",w.i32_const(1)),w.block(w.loop(w.br_if(1,w.call(f+"_eq",ft,k)),w.call(f+"_square",ft,ft),w.setLocal("i",w.i32_add(w.getLocal("i"),w.i32_const(1))),w.br(0))),w.call(f+"_copy",ot,Lt),w.setLocal("j",w.i32_sub(w.i32_sub(w.getLocal("m"),w.getLocal("i")),w.i32_const(1))),w.block(w.loop(w.br_if(1,w.i32_eqz(w.getLocal("j"))),w.call(f+"_square",Lt,Lt),w.setLocal("j",w.i32_sub(w.getLocal("j"),w.i32_const(1))),w.br(0))),w.setLocal("m",w.getLocal("i")),w.call(f+"_square",Lt,ot),w.call(f+"_mul",Y,ot,Y),w.call(f+"_mul",nt,Lt,nt),w.br(0))),w.if(w.call(f+"_isNegative",nt),w.call(f+"_neg",nt,w.getLocal("r")),w.call(f+"_copy",nt,w.getLocal("r"))))}function u(){const G=t.addFunction(f+"_isSquare");G.addParam("n","i32"),G.setReturnType("i32");const w=G.getCodeBuilder(),k=w.i32_const(g),ot=w.i32_const(t.alloc(h));G.addCode(w.if(w.call(f+"_isZero",w.getLocal("n")),w.ret(w.i32_const(1))),w.call(f+"_exp",w.getLocal("n"),w.i32_const(N),w.i32_const(h),ot),w.call(f+"_eq",ot,k))}function F(){const G=t.addFunction(f+"_load");G.addParam("scalar","i32"),G.addParam("scalarLen","i32"),G.addParam("r","i32"),G.addLocal("p","i32"),G.addLocal("l","i32"),G.addLocal("i","i32"),G.addLocal("j","i32");const w=G.getCodeBuilder(),k=w.i32_const(t.alloc(h)),ot=t.alloc(h),Y=w.i32_const(ot);G.addCode(w.call(l+"_zero",w.getLocal("r")),w.setLocal("i",w.i32_const(h)),w.setLocal("p",w.getLocal("scalar")),w.block(w.loop(w.br_if(1,w.i32_gt_u(w.getLocal("i"),w.getLocal("scalarLen"))),w.if(w.i32_eq(w.getLocal("i"),w.i32_const(h)),w.call(f+"_one",k),w.call(f+"_mul",k,w.i32_const(I),k)),w.call(f+"_mul",w.getLocal("p"),k,Y),w.call(f+"_add",w.getLocal("r"),Y,w.getLocal("r")),w.setLocal("p",w.i32_add(w.getLocal("p"),w.i32_const(h))),w.setLocal("i",w.i32_add(w.getLocal("i"),w.i32_const(h))),w.br(0))),w.setLocal("l",w.i32_rem_u(w.getLocal("scalarLen"),w.i32_const(h))),w.if(w.i32_eqz(w.getLocal("l")),w.ret([])),w.call(l+"_zero",Y),w.setLocal("j",w.i32_const(0)),w.block(w.loop(w.br_if(1,w.i32_eq(w.getLocal("j"),w.getLocal("l"))),w.i32_store8(w.getLocal("j"),ot,w.i32_load8_u(w.getLocal("p"))),w.setLocal("p",w.i32_add(w.getLocal("p"),w.i32_const(1))),w.setLocal("j",w.i32_add(w.getLocal("j"),w.i32_const(1))),w.br(0))),w.if(w.i32_eq(w.getLocal("i"),w.i32_const(h)),w.call(f+"_one",k),w.call(f+"_mul",k,w.i32_const(I),k)),w.call(f+"_mul",Y,k,Y),w.call(f+"_add",w.getLocal("r"),Y,w.getLocal("r")))}function _(){const G=t.addFunction(f+"_timesScalar");G.addParam("x","i32"),G.addParam("scalar","i32"),G.addParam("scalarLen","i32"),G.addParam("r","i32");const w=G.getCodeBuilder(),k=w.i32_const(t.alloc(h));G.addCode(w.call(f+"_load",w.getLocal("scalar"),w.getLocal("scalarLen"),k),w.call(f+"_toMontgomery",k,k),w.call(f+"_mul",w.getLocal("x"),k,w.getLocal("r")))}function Q(){const G=t.addFunction(f+"_isOne");G.addParam("x","i32"),G.setReturnType("i32");const w=G.getCodeBuilder();G.addCode(w.ret(w.call(l+"_eq",w.getLocal("x"),w.i32_const(g))))}return t.exportFunction(l+"_copy",f+"_copy"),t.exportFunction(l+"_zero",f+"_zero"),t.exportFunction(l+"_isZero",f+"_isZero"),t.exportFunction(l+"_eq",f+"_eq"),Q(),V(),v(),p(),q(),O(),R(),b(),D(),j(),L(),U(),J(),M(),F(),_(),l_(t,f),Ro(t,f+"_batchToMontgomery",f+"_toMontgomery",h,h),Ro(t,f+"_batchFromMontgomery",f+"_fromMontgomery",h,h),Ro(t,f+"_batchNeg",f+"_neg",h,h),Uo(t,f+"_batchAdd",f+"_add",h,h),Uo(t,f+"_batchSub",f+"_sub",h,h),Uo(t,f+"_batchMul",f+"_mul",h,h),t.exportFunction(f+"_add"),t.exportFunction(f+"_sub"),t.exportFunction(f+"_neg"),t.exportFunction(f+"_isNegative"),t.exportFunction(f+"_isOne"),t.exportFunction(f+"_sign"),t.exportFunction(f+"_mReduct"),t.exportFunction(f+"_mul"),t.exportFunction(f+"_square"),t.exportFunction(f+"_squareOld"),t.exportFunction(f+"_fromMontgomery"),t.exportFunction(f+"_toMontgomery"),t.exportFunction(f+"_inverse"),t.exportFunction(f+"_one"),t.exportFunction(f+"_load"),t.exportFunction(f+"_timesScalar"),c_(t,f+"_exp",h,f+"_mul",f+"_square",l+"_copy",f+"_one"),t.exportFunction(f+"_exp"),t.exportFunction(f+"_batchInverse"),jc(o)&&(A(),u(),t.exportFunction(f+"_sqrt"),t.exportFunction(f+"_isSquare")),t.exportFunction(f+"_batchToMontgomery"),t.exportFunction(f+"_batchFromMontgomery"),f};const __=Mo,{bitLength:h_}=we;var Yc=function(t,n,i,a,o){const s=BigInt(n),d=Math.floor((h_(s-1n)-1)/64)+1,h=d*8,f=i||"f1";if(t.modules[f])return f;t.modules[f]={n64:d};const l=o||"int",m=__(t,s,a,l),I=t.modules[m].pR2,g=t.modules[m].pq,B=t.modules[m].pePlusOne;function P(){const K=t.alloc(h),M=t.addFunction(f+"_mul");M.addParam("x","i32"),M.addParam("y","i32"),M.addParam("r","i32");const V=M.getCodeBuilder();M.addCode(V.call(m+"_mul",V.getLocal("x"),V.getLocal("y"),V.i32_const(K))),M.addCode(V.call(m+"_mul",V.i32_const(K),V.i32_const(I),V.getLocal("r")))}function C(){const K=t.addFunction(f+"_square");K.addParam("x","i32"),K.addParam("r","i32");const M=K.getCodeBuilder();K.addCode(M.call(f+"_mul",M.getLocal("x"),M.getLocal("x"),M.getLocal("r")))}function N(){const K=t.addFunction(f+"_inverse");K.addParam("x","i32"),K.addParam("r","i32");const M=K.getCodeBuilder();K.addCode(M.call(l+"_inverseMod",M.getLocal("x"),M.i32_const(g),M.getLocal("r")))}function T(){const K=t.addFunction(f+"_isNegative");K.addParam("x","i32"),K.setReturnType("i32");const M=K.getCodeBuilder();K.addCode(M.call(l+"_gte",M.getLocal("x"),M.i32_const(B)))}return P(),C(),N(),T(),t.exportFunction(m+"_add",f+"_add"),t.exportFunction(m+"_sub",f+"_sub"),t.exportFunction(m+"_neg",f+"_neg"),t.exportFunction(f+"_mul"),t.exportFunction(f+"_square"),t.exportFunction(f+"_inverse"),t.exportFunction(f+"_isNegative"),t.exportFunction(m+"_copy",f+"_copy"),t.exportFunction(m+"_zero",f+"_zero"),t.exportFunction(m+"_one",f+"_one"),t.exportFunction(m+"_isZero",f+"_isZero"),t.exportFunction(m+"_eq",f+"_eq"),f};const g_=xo,p_=To,Do=gn;var $c=function(t,n,i,a){if(t.modules[i])return i;const o=t.modules[a].n64*8,s=t.modules[a].q;t.modules[i]={n64:t.modules[a].n64*2};function d(){const R=t.addFunction(i+"_add");R.addParam("x","i32"),R.addParam("y","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("y"),tt=b.i32_add(b.getLocal("y"),b.i32_const(o)),$=b.getLocal("r"),et=b.i32_add(b.getLocal("r"),b.i32_const(o));R.addCode(b.call(a+"_add",D,J,$),b.call(a+"_add",j,tt,et))}function h(){const R=t.addFunction(i+"_timesScalar");R.addParam("x","i32"),R.addParam("scalar","i32"),R.addParam("scalarLen","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(o));R.addCode(b.call(a+"_timesScalar",D,b.getLocal("scalar"),b.getLocal("scalarLen"),J),b.call(a+"_timesScalar",j,b.getLocal("scalar"),b.getLocal("scalarLen"),tt))}function f(){const R=t.addFunction(i+"_sub");R.addParam("x","i32"),R.addParam("y","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("y"),tt=b.i32_add(b.getLocal("y"),b.i32_const(o)),$=b.getLocal("r"),et=b.i32_add(b.getLocal("r"),b.i32_const(o));R.addCode(b.call(a+"_sub",D,J,$),b.call(a+"_sub",j,tt,et))}function l(){const R=t.addFunction(i+"_neg");R.addParam("x","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(o));R.addCode(b.call(a+"_neg",D,J),b.call(a+"_neg",j,tt))}function m(){const R=t.addFunction(i+"_conjugate");R.addParam("x","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(o));R.addCode(b.call(a+"_copy",D,J),b.call(a+"_neg",j,tt))}function I(){const R=t.addFunction(i+"_isNegative");R.addParam("x","i32"),R.setReturnType("i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o));R.addCode(b.if(b.call(a+"_isZero",j),b.ret(b.call(a+"_isNegative",D))),b.ret(b.call(a+"_isNegative",j)))}function g(){const R=t.addFunction(i+"_mul");R.addParam("x","i32"),R.addParam("y","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("y"),tt=b.i32_add(b.getLocal("y"),b.i32_const(o)),$=b.getLocal("r"),et=b.i32_add(b.getLocal("r"),b.i32_const(o)),X=b.i32_const(t.alloc(o)),dt=b.i32_const(t.alloc(o)),rt=b.i32_const(t.alloc(o)),mt=b.i32_const(t.alloc(o));R.addCode(b.call(a+"_mul",D,J,X),b.call(a+"_mul",j,tt,dt),b.call(a+"_add",D,j,rt),b.call(a+"_add",J,tt,mt),b.call(a+"_mul",rt,mt,rt),b.call(n,dt,$),b.call(a+"_add",X,$,$),b.call(a+"_add",X,dt,et),b.call(a+"_sub",rt,et,et))}function B(){const R=t.addFunction(i+"_mul1");R.addParam("x","i32"),R.addParam("y","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("y"),tt=b.getLocal("r"),$=b.i32_add(b.getLocal("r"),b.i32_const(o));R.addCode(b.call(a+"_mul",D,J,tt),b.call(a+"_mul",j,J,$))}function P(){const R=t.addFunction(i+"_square");R.addParam("x","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(o)),$=b.i32_const(t.alloc(o)),et=b.i32_const(t.alloc(o)),X=b.i32_const(t.alloc(o)),dt=b.i32_const(t.alloc(o));R.addCode(b.call(a+"_mul",D,j,$),b.call(a+"_add",D,j,et),b.call(n,j,X),b.call(a+"_add",D,X,X),b.call(n,$,dt),b.call(a+"_add",dt,$,dt),b.call(a+"_mul",et,X,J),b.call(a+"_sub",J,dt,J),b.call(a+"_add",$,$,tt))}function C(){const R=t.addFunction(i+"_toMontgomery");R.addParam("x","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(o));R.addCode(b.call(a+"_toMontgomery",D,J),b.call(a+"_toMontgomery",j,tt))}function N(){const R=t.addFunction(i+"_fromMontgomery");R.addParam("x","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(o));R.addCode(b.call(a+"_fromMontgomery",D,J),b.call(a+"_fromMontgomery",j,tt))}function T(){const R=t.addFunction(i+"_copy");R.addParam("x","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(o));R.addCode(b.call(a+"_copy",D,J),b.call(a+"_copy",j,tt))}function K(){const R=t.addFunction(i+"_zero");R.addParam("x","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o));R.addCode(b.call(a+"_zero",D),b.call(a+"_zero",j))}function M(){const R=t.addFunction(i+"_one");R.addParam("x","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o));R.addCode(b.call(a+"_one",D),b.call(a+"_zero",j))}function V(){const R=t.addFunction(i+"_eq");R.addParam("x","i32"),R.addParam("y","i32"),R.setReturnType("i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("y"),tt=b.i32_add(b.getLocal("y"),b.i32_const(o));R.addCode(b.i32_and(b.call(a+"_eq",D,J),b.call(a+"_eq",j,tt)))}function v(){const R=t.addFunction(i+"_isZero");R.addParam("x","i32"),R.setReturnType("i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o));R.addCode(b.i32_and(b.call(a+"_isZero",D),b.call(a+"_isZero",j)))}function p(){const R=t.addFunction(i+"_inverse");R.addParam("x","i32"),R.addParam("r","i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o)),J=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(o)),$=b.i32_const(t.alloc(o)),et=b.i32_const(t.alloc(o)),X=b.i32_const(t.alloc(o)),dt=b.i32_const(t.alloc(o));R.addCode(b.call(a+"_square",D,$),b.call(a+"_square",j,et),b.call(n,et,X),b.call(a+"_sub",$,X,X),b.call(a+"_inverse",X,dt),b.call(a+"_mul",D,dt,J),b.call(a+"_mul",j,dt,tt),b.call(a+"_neg",tt,tt))}function L(){const R=t.addFunction(i+"_sign");R.addParam("x","i32"),R.addLocal("s","i32"),R.setReturnType("i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o));R.addCode(b.setLocal("s",b.call(a+"_sign",j)),b.if(b.getLocal("s"),b.ret(b.getLocal("s"))),b.ret(b.call(a+"_sign",D)))}function U(){const R=t.addFunction(i+"_isOne");R.addParam("x","i32"),R.setReturnType("i32");const b=R.getCodeBuilder(),D=b.getLocal("x"),j=b.i32_add(b.getLocal("x"),b.i32_const(o));R.addCode(b.ret(b.i32_and(b.call(a+"_isOne",D),b.call(a+"_isZero",j))))}function q(){const R=t.addFunction(i+"_sqrt");R.addParam("a","i32"),R.addParam("pr","i32");const b=R.getCodeBuilder(),D=b.i32_const(t.alloc(Do.bigInt2BytesLE((BigInt(s||0)-3n)/4n,o))),j=b.i32_const(t.alloc(Do.bigInt2BytesLE((BigInt(s||0)-1n)/2n,o))),J=b.getLocal("a"),tt=b.i32_const(t.alloc(o*2)),$=b.i32_const(t.alloc(o*2)),et=b.i32_const(t.alloc(o*2)),X=t.alloc(o*2),dt=b.i32_const(X),rt=b.i32_const(X),mt=b.i32_const(X+o),gt=b.i32_const(t.alloc(o*2)),A=b.i32_const(t.alloc(o*2));R.addCode(b.call(i+"_one",dt),b.call(i+"_neg",dt,dt),b.call(i+"_exp",J,D,b.i32_const(o),tt),b.call(i+"_square",tt,$),b.call(i+"_mul",J,$,$),b.call(i+"_conjugate",$,et),b.call(i+"_mul",et,$,et),b.if(b.call(i+"_eq",et,dt),b.unreachable()),b.call(i+"_mul",tt,J,gt),b.if(b.call(i+"_eq",$,dt),[...b.call(a+"_zero",rt),...b.call(a+"_one",mt),...b.call(i+"_mul",dt,gt,b.getLocal("pr"))],[...b.call(i+"_one",A),...b.call(i+"_add",A,$,A),...b.call(i+"_exp",A,j,b.i32_const(o),A),...b.call(i+"_mul",A,gt,b.getLocal("pr"))]))}function O(){const R=t.addFunction(i+"_isSquare");R.addParam("a","i32"),R.setReturnType("i32");const b=R.getCodeBuilder(),D=b.i32_const(t.alloc(Do.bigInt2BytesLE((BigInt(s||0)-3n)/4n,o))),j=b.getLocal("a"),J=b.i32_const(t.alloc(o*2)),tt=b.i32_const(t.alloc(o*2)),$=b.i32_const(t.alloc(o*2)),et=t.alloc(o*2),X=b.i32_const(et);R.addCode(b.call(i+"_one",X),b.call(i+"_neg",X,X),b.call(i+"_exp",j,D,b.i32_const(o),J),b.call(i+"_square",J,tt),b.call(i+"_mul",j,tt,tt),b.call(i+"_conjugate",tt,$),b.call(i+"_mul",$,tt,$),b.if(b.call(i+"_eq",$,X),b.ret(b.i32_const(0))),b.ret(b.i32_const(1)))}return v(),U(),K(),M(),T(),g(),B(),P(),d(),f(),l(),m(),C(),N(),V(),p(),h(),L(),I(),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_isOne"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_copy"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_mul1"),t.exportFunction(i+"_square"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_neg"),t.exportFunction(i+"_sign"),t.exportFunction(i+"_conjugate"),t.exportFunction(i+"_fromMontgomery"),t.exportFunction(i+"_toMontgomery"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_inverse"),p_(t,i),g_(t,i+"_exp",o*2,i+"_mul",i+"_square",i+"_copy",i+"_one"),q(),O(),t.exportFunction(i+"_exp"),t.exportFunction(i+"_timesScalar"),t.exportFunction(i+"_batchInverse"),t.exportFunction(i+"_sqrt"),t.exportFunction(i+"_isSquare"),t.exportFunction(i+"_isNegative"),i};const m_=xo,L_=To;var Zc=function(t,n,i,a){if(t.modules[i])return i;const o=t.modules[a].n64*8;t.modules[i]={n64:t.modules[a].n64*3};function s(){const p=t.addFunction(i+"_add");p.addParam("x","i32"),p.addParam("y","i32"),p.addParam("r","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("y"),b=L.i32_add(L.getLocal("y"),L.i32_const(o)),D=L.i32_add(L.getLocal("y"),L.i32_const(2*o)),j=L.getLocal("r"),J=L.i32_add(L.getLocal("r"),L.i32_const(o)),tt=L.i32_add(L.getLocal("r"),L.i32_const(2*o));p.addCode(L.call(a+"_add",U,R,j),L.call(a+"_add",q,b,J),L.call(a+"_add",O,D,tt))}function d(){const p=t.addFunction(i+"_timesScalar");p.addParam("x","i32"),p.addParam("scalar","i32"),p.addParam("scalarLen","i32"),p.addParam("r","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("r"),b=L.i32_add(L.getLocal("r"),L.i32_const(o)),D=L.i32_add(L.getLocal("r"),L.i32_const(2*o));p.addCode(L.call(a+"_timesScalar",U,L.getLocal("scalar"),L.getLocal("scalarLen"),R),L.call(a+"_timesScalar",q,L.getLocal("scalar"),L.getLocal("scalarLen"),b),L.call(a+"_timesScalar",O,L.getLocal("scalar"),L.getLocal("scalarLen"),D))}function h(){const p=t.addFunction(i+"_sub");p.addParam("x","i32"),p.addParam("y","i32"),p.addParam("r","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("y"),b=L.i32_add(L.getLocal("y"),L.i32_const(o)),D=L.i32_add(L.getLocal("y"),L.i32_const(2*o)),j=L.getLocal("r"),J=L.i32_add(L.getLocal("r"),L.i32_const(o)),tt=L.i32_add(L.getLocal("r"),L.i32_const(2*o));p.addCode(L.call(a+"_sub",U,R,j),L.call(a+"_sub",q,b,J),L.call(a+"_sub",O,D,tt))}function f(){const p=t.addFunction(i+"_neg");p.addParam("x","i32"),p.addParam("r","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("r"),b=L.i32_add(L.getLocal("r"),L.i32_const(o)),D=L.i32_add(L.getLocal("r"),L.i32_const(2*o));p.addCode(L.call(a+"_neg",U,R),L.call(a+"_neg",q,b),L.call(a+"_neg",O,D))}function l(){const p=t.addFunction(i+"_isNegative");p.addParam("x","i32"),p.setReturnType("i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o));p.addCode(L.if(L.call(a+"_isZero",O),L.if(L.call(a+"_isZero",q),L.ret(L.call(a+"_isNegative",U)),L.ret(L.call(a+"_isNegative",q)))),L.ret(L.call(a+"_isNegative",O)))}function m(){const p=t.addFunction(i+"_mul");p.addParam("x","i32"),p.addParam("y","i32"),p.addParam("r","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("y"),b=L.i32_add(L.getLocal("y"),L.i32_const(o)),D=L.i32_add(L.getLocal("y"),L.i32_const(2*o)),j=L.getLocal("r"),J=L.i32_add(L.getLocal("r"),L.i32_const(o)),tt=L.i32_add(L.getLocal("r"),L.i32_const(2*o)),$=L.i32_const(t.alloc(o)),et=L.i32_const(t.alloc(o)),X=L.i32_const(t.alloc(o)),dt=L.i32_const(t.alloc(o)),rt=L.i32_const(t.alloc(o)),mt=L.i32_const(t.alloc(o)),gt=L.i32_const(t.alloc(o)),A=L.i32_const(t.alloc(o)),u=L.i32_const(t.alloc(o)),F=L.i32_const(t.alloc(o)),_=L.i32_const(t.alloc(o)),Q=L.i32_const(t.alloc(o)),G=L.i32_const(t.alloc(o));p.addCode(L.call(a+"_mul",U,R,$),L.call(a+"_mul",q,b,et),L.call(a+"_mul",O,D,X),L.call(a+"_add",U,q,dt),L.call(a+"_add",R,b,rt),L.call(a+"_add",U,O,mt),L.call(a+"_add",R,D,gt),L.call(a+"_add",q,O,A),L.call(a+"_add",b,D,u),L.call(a+"_add",$,et,F),L.call(a+"_add",$,X,_),L.call(a+"_add",et,X,Q),L.call(a+"_mul",A,u,j),L.call(a+"_sub",j,Q,j),L.call(n,j,j),L.call(a+"_add",$,j,j),L.call(a+"_mul",dt,rt,J),L.call(a+"_sub",J,F,J),L.call(n,X,G),L.call(a+"_add",J,G,J),L.call(a+"_mul",mt,gt,tt),L.call(a+"_sub",tt,_,tt),L.call(a+"_add",tt,et,tt))}function I(){const p=t.addFunction(i+"_square");p.addParam("x","i32"),p.addParam("r","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("r"),b=L.i32_add(L.getLocal("r"),L.i32_const(o)),D=L.i32_add(L.getLocal("r"),L.i32_const(2*o)),j=L.i32_const(t.alloc(o)),J=L.i32_const(t.alloc(o)),tt=L.i32_const(t.alloc(o)),$=L.i32_const(t.alloc(o)),et=L.i32_const(t.alloc(o)),X=L.i32_const(t.alloc(o)),dt=L.i32_const(t.alloc(o));p.addCode(L.call(a+"_square",U,j),L.call(a+"_mul",U,q,J),L.call(a+"_add",J,J,tt),L.call(a+"_sub",U,q,$),L.call(a+"_add",$,O,$),L.call(a+"_square",$,$),L.call(a+"_mul",q,O,et),L.call(a+"_add",et,et,X),L.call(a+"_square",O,dt),L.call(n,X,R),L.call(a+"_add",j,R,R),L.call(n,dt,b),L.call(a+"_add",tt,b,b),L.call(a+"_add",j,dt,D),L.call(a+"_sub",X,D,D),L.call(a+"_add",$,D,D),L.call(a+"_add",tt,D,D))}function g(){const p=t.addFunction(i+"_toMontgomery");p.addParam("x","i32"),p.addParam("r","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("r"),b=L.i32_add(L.getLocal("r"),L.i32_const(o)),D=L.i32_add(L.getLocal("r"),L.i32_const(2*o));p.addCode(L.call(a+"_toMontgomery",U,R),L.call(a+"_toMontgomery",q,b),L.call(a+"_toMontgomery",O,D))}function B(){const p=t.addFunction(i+"_fromMontgomery");p.addParam("x","i32"),p.addParam("r","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("r"),b=L.i32_add(L.getLocal("r"),L.i32_const(o)),D=L.i32_add(L.getLocal("r"),L.i32_const(2*o));p.addCode(L.call(a+"_fromMontgomery",U,R),L.call(a+"_fromMontgomery",q,b),L.call(a+"_fromMontgomery",O,D))}function P(){const p=t.addFunction(i+"_copy");p.addParam("x","i32"),p.addParam("r","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("r"),b=L.i32_add(L.getLocal("r"),L.i32_const(o)),D=L.i32_add(L.getLocal("r"),L.i32_const(2*o));p.addCode(L.call(a+"_copy",U,R),L.call(a+"_copy",q,b),L.call(a+"_copy",O,D))}function C(){const p=t.addFunction(i+"_zero");p.addParam("x","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o));p.addCode(L.call(a+"_zero",U),L.call(a+"_zero",q),L.call(a+"_zero",O))}function N(){const p=t.addFunction(i+"_one");p.addParam("x","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o));p.addCode(L.call(a+"_one",U),L.call(a+"_zero",q),L.call(a+"_zero",O))}function T(){const p=t.addFunction(i+"_eq");p.addParam("x","i32"),p.addParam("y","i32"),p.setReturnType("i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("y"),b=L.i32_add(L.getLocal("y"),L.i32_const(o)),D=L.i32_add(L.getLocal("y"),L.i32_const(2*o));p.addCode(L.i32_and(L.i32_and(L.call(a+"_eq",U,R),L.call(a+"_eq",q,b)),L.call(a+"_eq",O,D)))}function K(){const p=t.addFunction(i+"_isZero");p.addParam("x","i32"),p.setReturnType("i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o));p.addCode(L.i32_and(L.i32_and(L.call(a+"_isZero",U),L.call(a+"_isZero",q)),L.call(a+"_isZero",O)))}function M(){const p=t.addFunction(i+"_inverse");p.addParam("x","i32"),p.addParam("r","i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o)),R=L.getLocal("r"),b=L.i32_add(L.getLocal("r"),L.i32_const(o)),D=L.i32_add(L.getLocal("r"),L.i32_const(2*o)),j=L.i32_const(t.alloc(o)),J=L.i32_const(t.alloc(o)),tt=L.i32_const(t.alloc(o)),$=L.i32_const(t.alloc(o)),et=L.i32_const(t.alloc(o)),X=L.i32_const(t.alloc(o)),dt=L.i32_const(t.alloc(o)),rt=L.i32_const(t.alloc(o)),mt=L.i32_const(t.alloc(o)),gt=L.i32_const(t.alloc(o)),A=L.i32_const(t.alloc(o));p.addCode(L.call(a+"_square",U,j),L.call(a+"_square",q,J),L.call(a+"_square",O,tt),L.call(a+"_mul",U,q,$),L.call(a+"_mul",U,O,et),L.call(a+"_mul",q,O,X),L.call(n,X,dt),L.call(a+"_sub",j,dt,dt),L.call(n,tt,rt),L.call(a+"_sub",rt,$,rt),L.call(a+"_sub",J,et,mt),L.call(a+"_mul",O,rt,gt),L.call(a+"_mul",q,mt,A),L.call(a+"_add",gt,A,gt),L.call(n,gt,gt),L.call(a+"_mul",U,dt,A),L.call(a+"_add",A,gt,gt),L.call(a+"_inverse",gt,gt),L.call(a+"_mul",gt,dt,R),L.call(a+"_mul",gt,rt,b),L.call(a+"_mul",gt,mt,D))}function V(){const p=t.addFunction(i+"_sign");p.addParam("x","i32"),p.addLocal("s","i32"),p.setReturnType("i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(2*o));p.addCode(L.setLocal("s",L.call(a+"_sign",O)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.setLocal("s",L.call(a+"_sign",q)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.ret(L.call(a+"_sign",U)))}function v(){const p=t.addFunction(i+"_isOne");p.addParam("x","i32"),p.setReturnType("i32");const L=p.getCodeBuilder(),U=L.getLocal("x"),q=L.i32_add(L.getLocal("x"),L.i32_const(o)),O=L.i32_add(L.getLocal("x"),L.i32_const(o*2));p.addCode(L.ret(L.i32_and(L.i32_and(L.call(a+"_isOne",U),L.call(a+"_isZero",q)),L.call(a+"_isZero",O))))}return K(),v(),C(),N(),P(),m(),I(),s(),h(),f(),V(),g(),B(),T(),M(),d(),l(),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_isOne"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_copy"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_square"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_neg"),t.exportFunction(i+"_sign"),t.exportFunction(i+"_fromMontgomery"),t.exportFunction(i+"_toMontgomery"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_inverse"),L_(t,i),m_(t,i+"_exp",o*3,i+"_mul",i+"_square",i+"_copy",i+"_one"),t.exportFunction(i+"_exp"),t.exportFunction(i+"_timesScalar"),t.exportFunction(i+"_batchInverse"),t.exportFunction(i+"_isNegative"),i},A_=function(t,n,i,a,o,s,d,h){const f=t.addFunction(n);f.addParam("base","i32"),f.addParam("scalar","i32"),f.addParam("scalarLength","i32"),f.addParam("r","i32"),f.addLocal("old0","i32"),f.addLocal("nbits","i32"),f.addLocal("i","i32"),f.addLocal("last","i32"),f.addLocal("cur","i32"),f.addLocal("carry","i32"),f.addLocal("p","i32");const l=f.getCodeBuilder(),m=l.i32_const(t.alloc(i));function I(B){return l.i32_and(l.i32_shr_u(l.i32_load(l.i32_add(l.getLocal("scalar"),l.i32_and(l.i32_shr_u(B,l.i32_const(3)),l.i32_const(4294967292)))),l.i32_and(B,l.i32_const(31))),l.i32_const(1))}function g(B){return[...l.i32_store8(l.getLocal("p"),l.i32_const(B)),...l.setLocal("p",l.i32_add(l.getLocal("p"),l.i32_const(1)))]}f.addCode(l.if(l.i32_eqz(l.getLocal("scalarLength")),[...l.call(h,l.getLocal("r")),...l.ret([])]),l.setLocal("nbits",l.i32_shl(l.getLocal("scalarLength"),l.i32_const(3))),l.setLocal("old0",l.i32_load(l.i32_const(0))),l.setLocal("p",l.getLocal("old0")),l.i32_store(l.i32_const(0),l.i32_and(l.i32_add(l.i32_add(l.getLocal("old0"),l.i32_const(32)),l.getLocal("nbits")),l.i32_const(4294967288))),l.setLocal("i",l.i32_const(1)),l.setLocal("last",I(l.i32_const(0))),l.setLocal("carry",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("nbits"))),l.setLocal("cur",I(l.getLocal("i"))),l.if(l.getLocal("last"),l.if(l.getLocal("cur"),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...g(1)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...g(255)]),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...g(255)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(0)),...g(1)])),l.if(l.getLocal("cur"),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...g(0)],[...l.setLocal("last",l.i32_const(1)),...l.setLocal("carry",l.i32_const(0)),...g(0)]),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(1)),...l.setLocal("carry",l.i32_const(0)),...g(0)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(0)),...g(0)]))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))),l.if(l.getLocal("last"),l.if(l.getLocal("carry"),[...g(255),...g(0),...g(1)],[...g(1)]),l.if(l.getLocal("carry"),[...g(0),...g(1)])),l.setLocal("p",l.i32_sub(l.getLocal("p"),l.i32_const(1))),l.call(d,l.getLocal("base"),m),l.call(h,l.getLocal("r")),l.block(l.loop(l.call(o,l.getLocal("r"),l.getLocal("r")),l.setLocal("cur",l.i32_load8_u(l.getLocal("p"))),l.if(l.getLocal("cur"),l.if(l.i32_eq(l.getLocal("cur"),l.i32_const(1)),l.call(a,l.getLocal("r"),m,l.getLocal("r")),l.call(s,l.getLocal("r"),m,l.getLocal("r")))),l.br_if(1,l.i32_eq(l.getLocal("old0"),l.getLocal("p"))),l.setLocal("p",l.i32_sub(l.getLocal("p"),l.i32_const(1))),l.br(0))),l.i32_store(l.i32_const(0),l.getLocal("old0")))},y_=function(t,n,i,a,o){const d=t.modules[n].n64*8;function h(){const I=t.addFunction(i+"_getChunk");I.addParam("pScalar","i32"),I.addParam("scalarSize","i32"),I.addParam("startBit","i32"),I.addParam("chunkSize","i32"),I.addLocal("bitsToEnd","i32"),I.addLocal("mask","i32"),I.setReturnType("i32");const g=I.getCodeBuilder();I.addCode(g.setLocal("bitsToEnd",g.i32_sub(g.i32_mul(g.getLocal("scalarSize"),g.i32_const(8)),g.getLocal("startBit"))),g.if(g.i32_gt_s(g.getLocal("chunkSize"),g.getLocal("bitsToEnd")),g.setLocal("mask",g.i32_sub(g.i32_shl(g.i32_const(1),g.getLocal("bitsToEnd")),g.i32_const(1))),g.setLocal("mask",g.i32_sub(g.i32_shl(g.i32_const(1),g.getLocal("chunkSize")),g.i32_const(1)))),g.i32_and(g.i32_shr_u(g.i32_load(g.i32_add(g.getLocal("pScalar"),g.i32_shr_u(g.getLocal("startBit"),g.i32_const(3))),0,0),g.i32_and(g.getLocal("startBit"),g.i32_const(7))),g.getLocal("mask")))}function f(){const I=t.addFunction(i+"_chunk");I.addParam("pBases","i32"),I.addParam("pScalars","i32"),I.addParam("scalarSize","i32"),I.addParam("n","i32"),I.addParam("startBit","i32"),I.addParam("chunkSize","i32"),I.addParam("pr","i32"),I.addLocal("nChunks","i32"),I.addLocal("itScalar","i32"),I.addLocal("endScalar","i32"),I.addLocal("itBase","i32"),I.addLocal("i","i32"),I.addLocal("j","i32"),I.addLocal("nTable","i32"),I.addLocal("pTable","i32"),I.addLocal("idx","i32"),I.addLocal("pIdxTable","i32");const g=I.getCodeBuilder();I.addCode(g.if(g.i32_eqz(g.getLocal("n")),[...g.call(n+"_zero",g.getLocal("pr")),...g.ret([])]),g.setLocal("nTable",g.i32_shl(g.i32_const(1),g.getLocal("chunkSize"))),g.setLocal("pTable",g.i32_load(g.i32_const(0))),g.i32_store(g.i32_const(0),g.i32_add(g.getLocal("pTable"),g.i32_mul(g.getLocal("nTable"),g.i32_const(d)))),g.setLocal("j",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("j"),g.getLocal("nTable"))),g.call(n+"_zero",g.i32_add(g.getLocal("pTable"),g.i32_mul(g.getLocal("j"),g.i32_const(d)))),g.setLocal("j",g.i32_add(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.setLocal("itBase",g.getLocal("pBases")),g.setLocal("itScalar",g.getLocal("pScalars")),g.setLocal("endScalar",g.i32_add(g.getLocal("pScalars"),g.i32_mul(g.getLocal("n"),g.getLocal("scalarSize")))),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("itScalar"),g.getLocal("endScalar"))),g.setLocal("idx",g.call(i+"_getChunk",g.getLocal("itScalar"),g.getLocal("scalarSize"),g.getLocal("startBit"),g.getLocal("chunkSize"))),g.if(g.getLocal("idx"),[...g.setLocal("pIdxTable",g.i32_add(g.getLocal("pTable"),g.i32_mul(g.i32_sub(g.getLocal("idx"),g.i32_const(1)),g.i32_const(d)))),...g.call(a,g.getLocal("pIdxTable"),g.getLocal("itBase"),g.getLocal("pIdxTable"))]),g.setLocal("itScalar",g.i32_add(g.getLocal("itScalar"),g.getLocal("scalarSize"))),g.setLocal("itBase",g.i32_add(g.getLocal("itBase"),g.i32_const(o))),g.br(0))),g.call(i+"_reduceTable",g.getLocal("pTable"),g.getLocal("chunkSize")),g.call(n+"_copy",g.getLocal("pTable"),g.getLocal("pr")),g.i32_store(g.i32_const(0),g.getLocal("pTable")))}function l(){const I=t.addFunction(i);I.addParam("pBases","i32"),I.addParam("pScalars","i32"),I.addParam("scalarSize","i32"),I.addParam("n","i32"),I.addParam("pr","i32"),I.addLocal("chunkSize","i32"),I.addLocal("nChunks","i32"),I.addLocal("itScalar","i32"),I.addLocal("endScalar","i32"),I.addLocal("itBase","i32"),I.addLocal("itBit","i32"),I.addLocal("i","i32"),I.addLocal("j","i32"),I.addLocal("nTable","i32"),I.addLocal("pTable","i32"),I.addLocal("idx","i32"),I.addLocal("pIdxTable","i32");const g=I.getCodeBuilder(),B=g.i32_const(t.alloc(d)),P=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);I.addCode(g.call(n+"_zero",g.getLocal("pr")),g.if(g.i32_eqz(g.getLocal("n")),g.ret([])),g.setLocal("chunkSize",g.i32_load8_u(g.i32_clz(g.getLocal("n")),P)),g.setLocal("nChunks",g.i32_add(g.i32_div_u(g.i32_sub(g.i32_shl(g.getLocal("scalarSize"),g.i32_const(3)),g.i32_const(1)),g.getLocal("chunkSize")),g.i32_const(1))),g.setLocal("itBit",g.i32_mul(g.i32_sub(g.getLocal("nChunks"),g.i32_const(1)),g.getLocal("chunkSize"))),g.block(g.loop(g.br_if(1,g.i32_lt_s(g.getLocal("itBit"),g.i32_const(0))),g.if(g.i32_eqz(g.call(n+"_isZero",g.getLocal("pr"))),[...g.setLocal("j",g.i32_const(0)),...g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("j"),g.getLocal("chunkSize"))),g.call(n+"_double",g.getLocal("pr"),g.getLocal("pr")),g.setLocal("j",g.i32_add(g.getLocal("j"),g.i32_const(1))),g.br(0)))]),g.call(i+"_chunk",g.getLocal("pBases"),g.getLocal("pScalars"),g.getLocal("scalarSize"),g.getLocal("n"),g.getLocal("itBit"),g.getLocal("chunkSize"),B),g.call(n+"_add",g.getLocal("pr"),B,g.getLocal("pr")),g.setLocal("itBit",g.i32_sub(g.getLocal("itBit"),g.getLocal("chunkSize"))),g.br(0))))}function m(){const I=t.addFunction(i+"_reduceTable");I.addParam("pTable","i32"),I.addParam("p","i32"),I.addLocal("half","i32"),I.addLocal("it1","i32"),I.addLocal("it2","i32"),I.addLocal("pAcc","i32");const g=I.getCodeBuilder();I.addCode(g.if(g.i32_eq(g.getLocal("p"),g.i32_const(1)),g.ret([])),g.setLocal("half",g.i32_shl(g.i32_const(1),g.i32_sub(g.getLocal("p"),g.i32_const(1)))),g.setLocal("it1",g.getLocal("pTable")),g.setLocal("it2",g.i32_add(g.getLocal("pTable"),g.i32_mul(g.getLocal("half"),g.i32_const(d)))),g.setLocal("pAcc",g.i32_sub(g.getLocal("it2"),g.i32_const(d))),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("it1"),g.getLocal("pAcc"))),g.call(n+"_add",g.getLocal("it1"),g.getLocal("it2"),g.getLocal("it1")),g.call(n+"_add",g.getLocal("pAcc"),g.getLocal("it2"),g.getLocal("pAcc")),g.setLocal("it1",g.i32_add(g.getLocal("it1"),g.i32_const(d))),g.setLocal("it2",g.i32_add(g.getLocal("it2"),g.i32_const(d))),g.br(0))),g.call(i+"_reduceTable",g.getLocal("pTable"),g.i32_sub(g.getLocal("p"),g.i32_const(1))),g.setLocal("p",g.i32_sub(g.getLocal("p"),g.i32_const(1))),g.block(g.loop(g.br_if(1,g.i32_eqz(g.getLocal("p"))),g.call(n+"_double",g.getLocal("pAcc"),g.getLocal("pAcc")),g.setLocal("p",g.i32_sub(g.getLocal("p"),g.i32_const(1))),g.br(0))),g.call(n+"_add",g.getLocal("pTable"),g.getLocal("pAcc"),g.getLocal("pTable")))}h(),m(),f(),l(),t.exportFunction(i),t.exportFunction(i+"_chunk")};const Jc=A_,Ri=Nc,Xc=y_;var tl=function(t,n,i,a){const o=t.modules[i].n64,s=o*8;if(t.modules[n])return n;t.modules[n]={n64:o*3};function d(){const A=t.addFunction(n+"_isZero");A.addParam("p1","i32"),A.setReturnType("i32");const u=A.getCodeBuilder();A.addCode(u.call(i+"_isZero",u.i32_add(u.getLocal("p1"),u.i32_const(s*2))))}function h(){const A=t.addFunction(n+"_isZeroAffine");A.addParam("p1","i32"),A.setReturnType("i32");const u=A.getCodeBuilder();A.addCode(u.i32_and(u.call(i+"_isZero",u.getLocal("p1")),u.call(i+"_isZero",u.i32_add(u.getLocal("p1"),u.i32_const(s)))))}function f(){const A=t.addFunction(n+"_copy");A.addParam("ps","i32"),A.addParam("pd","i32");const u=A.getCodeBuilder();for(let F=0;F<o*3;F++)A.addCode(u.i64_store(u.getLocal("pd"),F*8,u.i64_load(u.getLocal("ps"),F*8)))}function l(){const A=t.addFunction(n+"_copyAffine");A.addParam("ps","i32"),A.addParam("pd","i32");const u=A.getCodeBuilder();for(let F=0;F<o*2;F++)A.addCode(u.i64_store(u.getLocal("pd"),F*8,u.i64_load(u.getLocal("ps"),F*8)))}function m(){const A=t.addFunction(n+"_zero");A.addParam("pr","i32");const u=A.getCodeBuilder();A.addCode(u.call(i+"_zero",u.getLocal("pr"))),A.addCode(u.call(i+"_one",u.i32_add(u.getLocal("pr"),u.i32_const(s)))),A.addCode(u.call(i+"_zero",u.i32_add(u.getLocal("pr"),u.i32_const(s*2))))}function I(){const A=t.addFunction(n+"_zeroAffine");A.addParam("pr","i32");const u=A.getCodeBuilder();A.addCode(u.call(i+"_zero",u.getLocal("pr"))),A.addCode(u.call(i+"_zero",u.i32_add(u.getLocal("pr"),u.i32_const(s))))}function g(){const A=t.addFunction(n+"_eq");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32"),A.addLocal("z2","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s));A.addCode(u.setLocal("z1",u.i32_add(u.getLocal("p1"),u.i32_const(s*2))));const Q=u.getLocal("z1"),G=u.getLocal("p2"),w=u.i32_add(u.getLocal("p2"),u.i32_const(s));A.addCode(u.setLocal("z2",u.i32_add(u.getLocal("p2"),u.i32_const(s*2))));const k=u.getLocal("z2"),ot=u.i32_const(t.alloc(s)),Y=u.i32_const(t.alloc(s)),nt=u.i32_const(t.alloc(s)),ft=u.i32_const(t.alloc(s)),Lt=u.i32_const(t.alloc(s)),At=u.i32_const(t.alloc(s)),ht=u.i32_const(t.alloc(s)),ct=u.i32_const(t.alloc(s));A.addCode(u.if(u.call(n+"_isZero",u.getLocal("p1")),u.ret(u.call(n+"_isZero",u.getLocal("p2")))),u.if(u.call(n+"_isZero",u.getLocal("p2")),u.ret(u.i32_const(0))),u.if(u.call(i+"_isOne",Q),u.ret(u.call(n+"_eqMixed",u.getLocal("p2"),u.getLocal("p1")))),u.if(u.call(i+"_isOne",k),u.ret(u.call(n+"_eqMixed",u.getLocal("p1"),u.getLocal("p2")))),u.call(i+"_square",Q,ot),u.call(i+"_square",k,Y),u.call(i+"_mul",F,Y,nt),u.call(i+"_mul",G,ot,ft),u.call(i+"_mul",Q,ot,Lt),u.call(i+"_mul",k,Y,At),u.call(i+"_mul",_,At,ht),u.call(i+"_mul",w,Lt,ct),u.if(u.call(i+"_eq",nt,ft),u.if(u.call(i+"_eq",ht,ct),u.ret(u.i32_const(1)))),u.ret(u.i32_const(0)))}function B(){const A=t.addFunction(n+"_eqMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s));A.addCode(u.setLocal("z1",u.i32_add(u.getLocal("p1"),u.i32_const(s*2))));const Q=u.getLocal("z1"),G=u.getLocal("p2"),w=u.i32_add(u.getLocal("p2"),u.i32_const(s)),k=u.i32_const(t.alloc(s)),ot=u.i32_const(t.alloc(s)),Y=u.i32_const(t.alloc(s)),nt=u.i32_const(t.alloc(s));A.addCode(u.if(u.call(n+"_isZero",u.getLocal("p1")),u.ret(u.call(n+"_isZeroAffine",u.getLocal("p2")))),u.if(u.call(n+"_isZeroAffine",u.getLocal("p2")),u.ret(u.i32_const(0))),u.if(u.call(i+"_isOne",Q),u.ret(u.call(n+"_eqAffine",u.getLocal("p1"),u.getLocal("p2")))),u.call(i+"_square",Q,k),u.call(i+"_mul",G,k,ot),u.call(i+"_mul",Q,k,Y),u.call(i+"_mul",w,Y,nt),u.if(u.call(i+"_eq",F,ot),u.if(u.call(i+"_eq",_,nt),u.ret(u.i32_const(1)))),u.ret(u.i32_const(0)))}function P(){const A=t.addFunction(n+"_double");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s)),Q=u.i32_add(u.getLocal("p1"),u.i32_const(s*2)),G=u.getLocal("pr"),w=u.i32_add(u.getLocal("pr"),u.i32_const(s)),k=u.i32_add(u.getLocal("pr"),u.i32_const(s*2)),ot=u.i32_const(t.alloc(s)),Y=u.i32_const(t.alloc(s)),nt=u.i32_const(t.alloc(s)),ft=u.i32_const(t.alloc(s)),Lt=u.i32_const(t.alloc(s)),At=u.i32_const(t.alloc(s)),ht=u.i32_const(t.alloc(s)),ct=u.i32_const(t.alloc(s));A.addCode(u.if(u.call(n+"_isZero",u.getLocal("p1")),[...u.call(n+"_copy",u.getLocal("p1"),u.getLocal("pr")),...u.ret([])]),u.if(u.call(i+"_isOne",Q),[...u.ret(u.call(n+"_doubleAffine",u.getLocal("p1"),u.getLocal("pr"))),...u.ret([])]),u.call(i+"_square",F,ot),u.call(i+"_square",_,Y),u.call(i+"_square",Y,nt),u.call(i+"_add",F,Y,ft),u.call(i+"_square",ft,ft),u.call(i+"_sub",ft,ot,ft),u.call(i+"_sub",ft,nt,ft),u.call(i+"_add",ft,ft,ft),u.call(i+"_add",ot,ot,Lt),u.call(i+"_add",Lt,ot,Lt),u.call(i+"_square",Lt,At),u.call(i+"_mul",_,Q,ht),u.call(i+"_add",ft,ft,G),u.call(i+"_sub",At,G,G),u.call(i+"_add",nt,nt,ct),u.call(i+"_add",ct,ct,ct),u.call(i+"_add",ct,ct,ct),u.call(i+"_sub",ft,G,w),u.call(i+"_mul",w,Lt,w),u.call(i+"_sub",w,ct,w),u.call(i+"_add",ht,ht,k))}function C(){const A=t.addFunction(n+"_doubleAffine");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s)),Q=u.getLocal("pr"),G=u.i32_add(u.getLocal("pr"),u.i32_const(s)),w=u.i32_add(u.getLocal("pr"),u.i32_const(s*2)),k=u.i32_const(t.alloc(s)),ot=u.i32_const(t.alloc(s)),Y=u.i32_const(t.alloc(s)),nt=u.i32_const(t.alloc(s)),ft=u.i32_const(t.alloc(s)),Lt=u.i32_const(t.alloc(s));A.addCode(u.if(u.call(n+"_isZeroAffine",u.getLocal("p1")),[...u.call(n+"_toJacobian",u.getLocal("p1"),u.getLocal("pr")),...u.ret([])]),u.call(i+"_square",F,k),u.call(i+"_square",_,ot),u.call(i+"_square",ot,Y),u.call(i+"_add",F,ot,nt),u.call(i+"_square",nt,nt),u.call(i+"_sub",nt,k,nt),u.call(i+"_sub",nt,Y,nt),u.call(i+"_add",nt,nt,nt),u.call(i+"_add",k,k,ft),u.call(i+"_add",ft,k,ft),u.call(i+"_add",_,_,w),u.call(i+"_square",ft,Q),u.call(i+"_sub",Q,nt,Q),u.call(i+"_sub",Q,nt,Q),u.call(i+"_add",Y,Y,Lt),u.call(i+"_add",Lt,Lt,Lt),u.call(i+"_add",Lt,Lt,Lt),u.call(i+"_sub",nt,Q,G),u.call(i+"_mul",G,ft,G),u.call(i+"_sub",G,Lt,G))}function N(){const A=t.addFunction(n+"_eqAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32");const u=A.getCodeBuilder();A.addCode(u.ret(u.i32_and(u.call(i+"_eq",u.getLocal("p1"),u.getLocal("p2")),u.call(i+"_eq",u.i32_add(u.getLocal("p1"),u.i32_const(s)),u.i32_add(u.getLocal("p2"),u.i32_const(s))))))}function T(){const A=t.addFunction(n+"_toMontgomery");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder();A.addCode(u.call(i+"_toMontgomery",u.getLocal("p1"),u.getLocal("pr")));for(let F=1;F<3;F++)A.addCode(u.call(i+"_toMontgomery",u.i32_add(u.getLocal("p1"),u.i32_const(F*s)),u.i32_add(u.getLocal("pr"),u.i32_const(F*s))))}function K(){const A=t.addFunction(n+"_toMontgomeryAffine");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder();A.addCode(u.call(i+"_toMontgomery",u.getLocal("p1"),u.getLocal("pr")));for(let F=1;F<2;F++)A.addCode(u.call(i+"_toMontgomery",u.i32_add(u.getLocal("p1"),u.i32_const(F*s)),u.i32_add(u.getLocal("pr"),u.i32_const(F*s))))}function M(){const A=t.addFunction(n+"_fromMontgomery");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder();A.addCode(u.call(i+"_fromMontgomery",u.getLocal("p1"),u.getLocal("pr")));for(let F=1;F<3;F++)A.addCode(u.call(i+"_fromMontgomery",u.i32_add(u.getLocal("p1"),u.i32_const(F*s)),u.i32_add(u.getLocal("pr"),u.i32_const(F*s))))}function V(){const A=t.addFunction(n+"_fromMontgomeryAffine");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder();A.addCode(u.call(i+"_fromMontgomery",u.getLocal("p1"),u.getLocal("pr")));for(let F=1;F<2;F++)A.addCode(u.call(i+"_fromMontgomery",u.i32_add(u.getLocal("p1"),u.i32_const(F*s)),u.i32_add(u.getLocal("pr"),u.i32_const(F*s))))}function v(){const A=t.addFunction(n+"_add");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32"),A.addLocal("z2","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s));A.addCode(u.setLocal("z1",u.i32_add(u.getLocal("p1"),u.i32_const(s*2))));const Q=u.getLocal("z1"),G=u.getLocal("p2"),w=u.i32_add(u.getLocal("p2"),u.i32_const(s));A.addCode(u.setLocal("z2",u.i32_add(u.getLocal("p2"),u.i32_const(s*2))));const k=u.getLocal("z2"),ot=u.getLocal("pr"),Y=u.i32_add(u.getLocal("pr"),u.i32_const(s)),nt=u.i32_add(u.getLocal("pr"),u.i32_const(s*2)),ft=u.i32_const(t.alloc(s)),Lt=u.i32_const(t.alloc(s)),At=u.i32_const(t.alloc(s)),ht=u.i32_const(t.alloc(s)),ct=u.i32_const(t.alloc(s)),_t=u.i32_const(t.alloc(s)),wt=u.i32_const(t.alloc(s)),Et=u.i32_const(t.alloc(s)),Tt=u.i32_const(t.alloc(s)),Nt=u.i32_const(t.alloc(s)),kt=u.i32_const(t.alloc(s)),Kt=u.i32_const(t.alloc(s)),Mt=u.i32_const(t.alloc(s)),bt=u.i32_const(t.alloc(s)),Ht=u.i32_const(t.alloc(s)),Qt=u.i32_const(t.alloc(s)),Yt=u.i32_const(t.alloc(s));A.addCode(u.if(u.call(n+"_isZero",u.getLocal("p1")),[...u.call(n+"_copy",u.getLocal("p2"),u.getLocal("pr")),...u.ret([])]),u.if(u.call(n+"_isZero",u.getLocal("p2")),[...u.call(n+"_copy",u.getLocal("p1"),u.getLocal("pr")),...u.ret([])]),u.if(u.call(i+"_isOne",Q),[...u.call(n+"_addMixed",G,F,ot),...u.ret([])]),u.if(u.call(i+"_isOne",k),[...u.call(n+"_addMixed",F,G,ot),...u.ret([])]),u.call(i+"_square",Q,ft),u.call(i+"_square",k,Lt),u.call(i+"_mul",F,Lt,At),u.call(i+"_mul",G,ft,ht),u.call(i+"_mul",Q,ft,ct),u.call(i+"_mul",k,Lt,_t),u.call(i+"_mul",_,_t,wt),u.call(i+"_mul",w,ct,Et),u.if(u.call(i+"_eq",At,ht),u.if(u.call(i+"_eq",wt,Et),[...u.call(n+"_double",u.getLocal("p1"),u.getLocal("pr")),...u.ret([])])),u.call(i+"_sub",ht,At,Tt),u.call(i+"_sub",Et,wt,Nt),u.call(i+"_add",Tt,Tt,kt),u.call(i+"_square",kt,kt),u.call(i+"_mul",Tt,kt,Kt),u.call(i+"_add",Nt,Nt,Mt),u.call(i+"_mul",At,kt,Ht),u.call(i+"_square",Mt,bt),u.call(i+"_add",Ht,Ht,Qt),u.call(i+"_sub",bt,Kt,ot),u.call(i+"_sub",ot,Qt,ot),u.call(i+"_mul",wt,Kt,Yt),u.call(i+"_add",Yt,Yt,Yt),u.call(i+"_sub",Ht,ot,Y),u.call(i+"_mul",Y,Mt,Y),u.call(i+"_sub",Y,Yt,Y),u.call(i+"_add",Q,k,nt),u.call(i+"_square",nt,nt),u.call(i+"_sub",nt,ft,nt),u.call(i+"_sub",nt,Lt,nt),u.call(i+"_mul",nt,Tt,nt))}function p(){const A=t.addFunction(n+"_addMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s));A.addCode(u.setLocal("z1",u.i32_add(u.getLocal("p1"),u.i32_const(s*2))));const Q=u.getLocal("z1"),G=u.getLocal("p2"),w=u.i32_add(u.getLocal("p2"),u.i32_const(s)),k=u.getLocal("pr"),ot=u.i32_add(u.getLocal("pr"),u.i32_const(s)),Y=u.i32_add(u.getLocal("pr"),u.i32_const(s*2)),nt=u.i32_const(t.alloc(s)),ft=u.i32_const(t.alloc(s)),Lt=u.i32_const(t.alloc(s)),At=u.i32_const(t.alloc(s)),ht=u.i32_const(t.alloc(s)),ct=u.i32_const(t.alloc(s)),_t=u.i32_const(t.alloc(s)),wt=u.i32_const(t.alloc(s)),Et=u.i32_const(t.alloc(s)),Tt=u.i32_const(t.alloc(s)),Nt=u.i32_const(t.alloc(s)),kt=u.i32_const(t.alloc(s)),Kt=u.i32_const(t.alloc(s)),Mt=u.i32_const(t.alloc(s));A.addCode(u.if(u.call(n+"_isZero",u.getLocal("p1")),[...u.call(n+"_copyAffine",u.getLocal("p2"),u.getLocal("pr")),...u.call(i+"_one",u.i32_add(u.getLocal("pr"),u.i32_const(s*2))),...u.ret([])]),u.if(u.call(n+"_isZeroAffine",u.getLocal("p2")),[...u.call(n+"_copy",u.getLocal("p1"),u.getLocal("pr")),...u.ret([])]),u.if(u.call(i+"_isOne",Q),[...u.call(n+"_addAffine",F,G,k),...u.ret([])]),u.call(i+"_square",Q,nt),u.call(i+"_mul",G,nt,ft),u.call(i+"_mul",Q,nt,Lt),u.call(i+"_mul",w,Lt,At),u.if(u.call(i+"_eq",F,ft),u.if(u.call(i+"_eq",_,At),[...u.call(n+"_doubleAffine",u.getLocal("p2"),u.getLocal("pr")),...u.ret([])])),u.call(i+"_sub",ft,F,ht),u.call(i+"_sub",At,_,_t),u.call(i+"_square",ht,ct),u.call(i+"_add",ct,ct,wt),u.call(i+"_add",wt,wt,wt),u.call(i+"_mul",ht,wt,Et),u.call(i+"_add",_t,_t,Tt),u.call(i+"_mul",F,wt,kt),u.call(i+"_square",Tt,Nt),u.call(i+"_add",kt,kt,Kt),u.call(i+"_sub",Nt,Et,k),u.call(i+"_sub",k,Kt,k),u.call(i+"_mul",_,Et,Mt),u.call(i+"_add",Mt,Mt,Mt),u.call(i+"_sub",kt,k,ot),u.call(i+"_mul",ot,Tt,ot),u.call(i+"_sub",ot,Mt,ot),u.call(i+"_add",Q,ht,Y),u.call(i+"_square",Y,Y),u.call(i+"_sub",Y,nt,Y),u.call(i+"_sub",Y,ct,Y))}function L(){const A=t.addFunction(n+"_addAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s));A.addCode(u.setLocal("z1",u.i32_add(u.getLocal("p1"),u.i32_const(s*2))));const Q=u.getLocal("p2"),G=u.i32_add(u.getLocal("p2"),u.i32_const(s)),w=u.getLocal("pr"),k=u.i32_add(u.getLocal("pr"),u.i32_const(s)),ot=u.i32_add(u.getLocal("pr"),u.i32_const(s*2)),Y=u.i32_const(t.alloc(s)),nt=u.i32_const(t.alloc(s)),ft=u.i32_const(t.alloc(s)),Lt=u.i32_const(t.alloc(s)),At=u.i32_const(t.alloc(s)),ht=u.i32_const(t.alloc(s)),ct=u.i32_const(t.alloc(s)),_t=u.i32_const(t.alloc(s)),wt=u.i32_const(t.alloc(s)),Et=u.i32_const(t.alloc(s));A.addCode(u.if(u.call(n+"_isZeroAffine",u.getLocal("p1")),[...u.call(n+"_copyAffine",u.getLocal("p2"),u.getLocal("pr")),...u.call(i+"_one",u.i32_add(u.getLocal("pr"),u.i32_const(s*2))),...u.ret([])]),u.if(u.call(n+"_isZeroAffine",u.getLocal("p2")),[...u.call(n+"_copyAffine",u.getLocal("p1"),u.getLocal("pr")),...u.call(i+"_one",u.i32_add(u.getLocal("pr"),u.i32_const(s*2))),...u.ret([])]),u.if(u.call(i+"_eq",F,Q),u.if(u.call(i+"_eq",_,G),[...u.call(n+"_doubleAffine",u.getLocal("p2"),u.getLocal("pr")),...u.ret([])])),u.call(i+"_sub",Q,F,Y),u.call(i+"_sub",G,_,ft),u.call(i+"_square",Y,nt),u.call(i+"_add",nt,nt,Lt),u.call(i+"_add",Lt,Lt,Lt),u.call(i+"_mul",Y,Lt,At),u.call(i+"_add",ft,ft,ht),u.call(i+"_mul",F,Lt,_t),u.call(i+"_square",ht,ct),u.call(i+"_add",_t,_t,wt),u.call(i+"_sub",ct,At,w),u.call(i+"_sub",w,wt,w),u.call(i+"_mul",_,At,Et),u.call(i+"_add",Et,Et,Et),u.call(i+"_sub",_t,w,k),u.call(i+"_mul",k,ht,k),u.call(i+"_sub",k,Et,k),u.call(i+"_add",Y,Y,ot))}function U(){const A=t.addFunction(n+"_neg");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s)),Q=u.i32_add(u.getLocal("p1"),u.i32_const(s*2)),G=u.getLocal("pr"),w=u.i32_add(u.getLocal("pr"),u.i32_const(s)),k=u.i32_add(u.getLocal("pr"),u.i32_const(s*2));A.addCode(u.call(i+"_copy",F,G),u.call(i+"_neg",_,w),u.call(i+"_copy",Q,k))}function q(){const A=t.addFunction(n+"_negAffine");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s)),Q=u.getLocal("pr"),G=u.i32_add(u.getLocal("pr"),u.i32_const(s));A.addCode(u.call(i+"_copy",F,Q),u.call(i+"_neg",_,G))}function O(){const A=t.addFunction(n+"_sub");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder(),F=u.i32_const(t.alloc(s*3));A.addCode(u.call(n+"_neg",u.getLocal("p2"),F),u.call(n+"_add",u.getLocal("p1"),F,u.getLocal("pr")))}function R(){const A=t.addFunction(n+"_subMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder(),F=u.i32_const(t.alloc(s*3));A.addCode(u.call(n+"_negAffine",u.getLocal("p2"),F),u.call(n+"_addMixed",u.getLocal("p1"),F,u.getLocal("pr")))}function b(){const A=t.addFunction(n+"_subAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder(),F=u.i32_const(t.alloc(s*3));A.addCode(u.call(n+"_negAffine",u.getLocal("p2"),F),u.call(n+"_addAffine",u.getLocal("p1"),F,u.getLocal("pr")))}function D(){const A=t.addFunction(n+"_normalize");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s)),Q=u.i32_add(u.getLocal("p1"),u.i32_const(s*2)),G=u.getLocal("pr"),w=u.i32_add(u.getLocal("pr"),u.i32_const(s)),k=u.i32_add(u.getLocal("pr"),u.i32_const(s*2)),ot=u.i32_const(t.alloc(s)),Y=u.i32_const(t.alloc(s)),nt=u.i32_const(t.alloc(s));A.addCode(u.if(u.call(n+"_isZero",u.getLocal("p1")),u.call(n+"_zero",u.getLocal("pr")),[...u.call(i+"_inverse",Q,ot),...u.call(i+"_square",ot,Y),...u.call(i+"_mul",ot,Y,nt),...u.call(i+"_mul",F,Y,G),...u.call(i+"_mul",_,nt,w),...u.call(i+"_one",k)]))}function j(){const A=t.addFunction(n+"_toAffine");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s)),Q=u.i32_add(u.getLocal("p1"),u.i32_const(s*2)),G=u.getLocal("pr"),w=u.i32_add(u.getLocal("pr"),u.i32_const(s)),k=u.i32_const(t.alloc(s)),ot=u.i32_const(t.alloc(s)),Y=u.i32_const(t.alloc(s));A.addCode(u.if(u.call(n+"_isZero",u.getLocal("p1")),[...u.call(i+"_zero",G),...u.call(i+"_zero",w)],[...u.call(i+"_inverse",Q,k),...u.call(i+"_square",k,ot),...u.call(i+"_mul",k,ot,Y),...u.call(i+"_mul",F,ot,G),...u.call(i+"_mul",_,Y,w)]))}function J(){const A=t.addFunction(n+"_toJacobian");A.addParam("p1","i32"),A.addParam("pr","i32");const u=A.getCodeBuilder(),F=u.getLocal("p1"),_=u.i32_add(u.getLocal("p1"),u.i32_const(s)),Q=u.getLocal("pr"),G=u.i32_add(u.getLocal("pr"),u.i32_const(s)),w=u.i32_add(u.getLocal("pr"),u.i32_const(s*2));A.addCode(u.if(u.call(n+"_isZeroAffine",u.getLocal("p1")),u.call(n+"_zero",u.getLocal("pr")),[...u.call(i+"_one",w),...u.call(i+"_copy",_,G),...u.call(i+"_copy",F,Q)]))}function tt(){const A=t.addFunction(n+"_batchToAffine");A.addParam("pIn","i32"),A.addParam("n","i32"),A.addParam("pOut","i32"),A.addLocal("pAux","i32"),A.addLocal("itIn","i32"),A.addLocal("itAux","i32"),A.addLocal("itOut","i32"),A.addLocal("i","i32");const u=A.getCodeBuilder(),F=u.i32_const(t.alloc(s));A.addCode(u.setLocal("pAux",u.i32_load(u.i32_const(0))),u.i32_store(u.i32_const(0),u.i32_add(u.getLocal("pAux"),u.i32_mul(u.getLocal("n"),u.i32_const(s)))),u.call(i+"_batchInverse",u.i32_add(u.getLocal("pIn"),u.i32_const(s*2)),u.i32_const(s*3),u.getLocal("n"),u.getLocal("pAux"),u.i32_const(s)),u.setLocal("itIn",u.getLocal("pIn")),u.setLocal("itAux",u.getLocal("pAux")),u.setLocal("itOut",u.getLocal("pOut")),u.setLocal("i",u.i32_const(0)),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("i"),u.getLocal("n"))),u.if(u.call(i+"_isZero",u.getLocal("itAux")),[...u.call(i+"_zero",u.getLocal("itOut")),...u.call(i+"_zero",u.i32_add(u.getLocal("itOut"),u.i32_const(s)))],[...u.call(i+"_mul",u.getLocal("itAux"),u.i32_add(u.getLocal("itIn"),u.i32_const(s)),F),...u.call(i+"_square",u.getLocal("itAux"),u.getLocal("itAux")),...u.call(i+"_mul",u.getLocal("itAux"),u.getLocal("itIn"),u.getLocal("itOut")),...u.call(i+"_mul",u.getLocal("itAux"),F,u.i32_add(u.getLocal("itOut"),u.i32_const(s)))]),u.setLocal("itIn",u.i32_add(u.getLocal("itIn"),u.i32_const(s*3))),u.setLocal("itOut",u.i32_add(u.getLocal("itOut"),u.i32_const(s*2))),u.setLocal("itAux",u.i32_add(u.getLocal("itAux"),u.i32_const(s))),u.setLocal("i",u.i32_add(u.getLocal("i"),u.i32_const(1))),u.br(0))),u.i32_store(u.i32_const(0),u.getLocal("pAux")))}function $(){const A=t.addFunction(n+"__reverseBytes");A.addParam("pIn","i32"),A.addParam("n","i32"),A.addParam("pOut","i32"),A.addLocal("itOut","i32"),A.addLocal("itIn","i32");const u=A.getCodeBuilder();A.addCode(u.setLocal("itOut",u.i32_sub(u.i32_add(u.getLocal("pOut"),u.getLocal("n")),u.i32_const(1))),u.setLocal("itIn",u.getLocal("pIn")),u.block(u.loop(u.br_if(1,u.i32_lt_s(u.getLocal("itOut"),u.getLocal("pOut"))),u.i32_store8(u.getLocal("itOut"),u.i32_load8_u(u.getLocal("itIn"))),u.setLocal("itOut",u.i32_sub(u.getLocal("itOut"),u.i32_const(1))),u.setLocal("itIn",u.i32_add(u.getLocal("itIn"),u.i32_const(1))),u.br(0))))}function et(){const A=t.addFunction(n+"_LEMtoC");A.addParam("pIn","i32"),A.addParam("pOut","i32");const u=A.getCodeBuilder(),F=u.i32_const(t.alloc(s));A.addCode(u.if(u.call(n+"_isZero",u.getLocal("pIn")),[...u.call(i+"_zero",u.getLocal("pOut")),...u.i32_store8(u.getLocal("pOut"),u.i32_const(64)),...u.ret([])]),u.call(i+"_fromMontgomery",u.getLocal("pIn"),F),u.call(n+"__reverseBytes",F,u.i32_const(s),u.getLocal("pOut")),u.if(u.i32_eq(u.call(i+"_sign",u.i32_add(u.getLocal("pIn"),u.i32_const(s))),u.i32_const(-1)),u.i32_store8(u.getLocal("pOut"),u.i32_or(u.i32_load8_u(u.getLocal("pOut")),u.i32_const(128)))))}function X(){const A=t.addFunction(n+"_LEMtoU");A.addParam("pIn","i32"),A.addParam("pOut","i32");const u=A.getCodeBuilder(),F=t.alloc(s*2),_=u.i32_const(F),Q=u.i32_const(F),G=u.i32_const(F+s);A.addCode(u.if(u.call(n+"_isZeroAffine",u.getLocal("pIn")),[...u.call(n+"_zeroAffine",u.getLocal("pOut")),...u.i32_store8(u.getLocal("pOut"),u.i32_const(64)),...u.ret([])]),u.call(n+"_fromMontgomeryAffine",u.getLocal("pIn"),_),u.call(n+"__reverseBytes",Q,u.i32_const(s),u.getLocal("pOut")),u.call(n+"__reverseBytes",G,u.i32_const(s),u.i32_add(u.getLocal("pOut"),u.i32_const(s))))}function dt(){const A=t.addFunction(n+"_UtoLEM");A.addParam("pIn","i32"),A.addParam("pOut","i32");const u=A.getCodeBuilder(),F=t.alloc(s*2),_=u.i32_const(F),Q=u.i32_const(F),G=u.i32_const(F+s);A.addCode(u.if(u.i32_and(u.i32_load8_u(u.getLocal("pIn")),u.i32_const(64)),[...u.call(n+"_zeroAffine",u.getLocal("pOut")),...u.ret([])]),u.call(n+"__reverseBytes",u.getLocal("pIn"),u.i32_const(s),Q),u.call(n+"__reverseBytes",u.i32_add(u.getLocal("pIn"),u.i32_const(s)),u.i32_const(s),G),u.call(n+"_toMontgomeryAffine",_,u.getLocal("pOut")))}function rt(){const A=t.addFunction(n+"_CtoLEM");A.addParam("pIn","i32"),A.addParam("pOut","i32"),A.addLocal("firstByte","i32"),A.addLocal("greatest","i32");const u=A.getCodeBuilder(),F=t.alloc(s*2),_=u.i32_const(F),Q=u.i32_const(F+s);A.addCode(u.setLocal("firstByte",u.i32_load8_u(u.getLocal("pIn"))),u.if(u.i32_and(u.getLocal("firstByte"),u.i32_const(64)),[...u.call(n+"_zeroAffine",u.getLocal("pOut")),...u.ret([])]),u.setLocal("greatest",u.i32_and(u.getLocal("firstByte"),u.i32_const(128))),u.call(i+"_copy",u.getLocal("pIn"),Q),u.i32_store8(Q,u.i32_and(u.getLocal("firstByte"),u.i32_const(63))),u.call(n+"__reverseBytes",Q,u.i32_const(s),_),u.call(i+"_toMontgomery",_,u.getLocal("pOut")),u.call(i+"_square",u.getLocal("pOut"),Q),u.call(i+"_mul",u.getLocal("pOut"),Q,Q),u.call(i+"_add",Q,u.i32_const(a),Q),u.call(i+"_sqrt",Q,Q),u.call(i+"_neg",Q,_),u.if(u.i32_eq(u.call(i+"_sign",Q),u.i32_const(-1)),u.if(u.getLocal("greatest"),u.call(i+"_copy",Q,u.i32_add(u.getLocal("pOut"),u.i32_const(s))),u.call(i+"_neg",Q,u.i32_add(u.getLocal("pOut"),u.i32_const(s)))),u.if(u.getLocal("greatest"),u.call(i+"_neg",Q,u.i32_add(u.getLocal("pOut"),u.i32_const(s))),u.call(i+"_copy",Q,u.i32_add(u.getLocal("pOut"),u.i32_const(s))))))}function mt(){const A=t.addFunction(n+"_inCurveAffine");A.addParam("pIn","i32"),A.setReturnType("i32");const u=A.getCodeBuilder(),F=u.getLocal("pIn"),_=u.i32_add(u.getLocal("pIn"),u.i32_const(s)),Q=u.i32_const(t.alloc(s)),G=u.i32_const(t.alloc(s));A.addCode(u.call(i+"_square",_,Q),u.call(i+"_square",F,G),u.call(i+"_mul",F,G,G),u.call(i+"_add",G,u.i32_const(a),G),u.ret(u.call(i+"_eq",Q,G)))}function gt(){const A=t.addFunction(n+"_inCurve");A.addParam("pIn","i32"),A.setReturnType("i32");const u=A.getCodeBuilder(),F=u.i32_const(t.alloc(s*2));A.addCode(u.call(n+"_toAffine",u.getLocal("pIn"),F),u.ret(u.call(n+"_inCurveAffine",F)))}return h(),d(),I(),m(),l(),f(),J(),N(),B(),g(),C(),P(),L(),p(),v(),q(),U(),b(),R(),O(),V(),M(),K(),T(),j(),mt(),gt(),tt(),D(),$(),X(),et(),dt(),rt(),Ri(t,n+"_batchLEMtoU",n+"_LEMtoU",s*2,s*2),Ri(t,n+"_batchLEMtoC",n+"_LEMtoC",s*2,s),Ri(t,n+"_batchUtoLEM",n+"_UtoLEM",s*2,s*2),Ri(t,n+"_batchCtoLEM",n+"_CtoLEM",s,s*2,!0),Ri(t,n+"_batchToJacobian",n+"_toJacobian",s*2,s*3,!0),Xc(t,n,n+"_multiexp",n+"_add",s*3),Xc(t,n,n+"_multiexpAffine",n+"_addMixed",s*2),Jc(t,n+"_timesScalar",s*3,n+"_add",n+"_double",n+"_sub",n+"_copy",n+"_zero"),Jc(t,n+"_timesScalarAffine",s*2,n+"_addMixed",n+"_double",n+"_subMixed",n+"_copyAffine",n+"_zero"),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_isZeroAffine"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_eqMixed"),t.exportFunction(n+"_eqAffine"),t.exportFunction(n+"_copy"),t.exportFunction(n+"_copyAffine"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_zeroAffine"),t.exportFunction(n+"_double"),t.exportFunction(n+"_doubleAffine"),t.exportFunction(n+"_add"),t.exportFunction(n+"_addMixed"),t.exportFunction(n+"_addAffine"),t.exportFunction(n+"_neg"),t.exportFunction(n+"_negAffine"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_subMixed"),t.exportFunction(n+"_subAffine"),t.exportFunction(n+"_fromMontgomery"),t.exportFunction(n+"_fromMontgomeryAffine"),t.exportFunction(n+"_toMontgomery"),t.exportFunction(n+"_toMontgomeryAffine"),t.exportFunction(n+"_timesScalar"),t.exportFunction(n+"_timesScalarAffine"),t.exportFunction(n+"_normalize"),t.exportFunction(n+"_LEMtoU"),t.exportFunction(n+"_LEMtoC"),t.exportFunction(n+"_UtoLEM"),t.exportFunction(n+"_CtoLEM"),t.exportFunction(n+"_batchLEMtoU"),t.exportFunction(n+"_batchLEMtoC"),t.exportFunction(n+"_batchUtoLEM"),t.exportFunction(n+"_batchCtoLEM"),t.exportFunction(n+"_toAffine"),t.exportFunction(n+"_toJacobian"),t.exportFunction(n+"_batchToAffine"),t.exportFunction(n+"_batchToJacobian"),t.exportFunction(n+"_inCurve"),t.exportFunction(n+"_inCurveAffine"),n};const{isOdd:w_,modInv:el,modPow:Ui}=we,ma=gn;var nl=function(t,n,i,a,o){const d=t.modules[a].n64*8,f=t.modules[i].n64*8,l=t.modules[a].q;let m=l-1n,I=0;for(;!w_(m);)I++,m=m>>1n;let g=2n;for(;Ui(g,l>>1n,l)===1n;)g=g+1n;const B=new Array(I+1);B[I]=Ui(g,m,l);let P=I-1;for(;P>=0;)B[P]=Ui(B[P+1],2n,l),P--;const C=[],N=(1n<<BigInt(d*8))%l;for(let F=0;F<B.length;F++){const _=B[F]*N%l;C.push(...ma.bigInt2BytesLE(_,d))}const T=t.alloc(C),K=new Array(I+1);K[0]=1n;for(let F=1;F<=I;F++)K[F]=K[F-1]*2n;const M=[];for(let F=0;F<=I;F++){const _=el(K[F],l)*N%l;M.push(...ma.bigInt2BytesLE(_,d))}const V=t.alloc(M),v=Ui(g,2n,l),p=[],L=[];for(let F=0;F<=I;F++){const _=Ui(v,2n**BigInt(F),l),Q=el(l+1n-_,l);p.push(...ma.bigInt2BytesLE(_*N%l,d)),L.push(...ma.bigInt2BytesLE(Q*N%l,d))}const U=t.alloc(p),q=t.alloc(L);function O(F){let _=0;for(let Q=0;Q<8;Q++)F&1<<Q&&(_=_|128>>Q);return _}const R=Array(256);for(let F=0;F<256;F++)R[F]=O(F);const b=t.alloc(R);function D(){const F=t.addFunction(n+"__log2");F.addParam("n","i32"),F.setReturnType("i32"),F.addLocal("bits","i32"),F.addLocal("aux","i32");const _=F.getCodeBuilder();F.addCode(_.setLocal("aux",_.i32_shr_u(_.getLocal("n"),_.i32_const(1)))),F.addCode(_.setLocal("bits",_.i32_const(0))),F.addCode(_.block(_.loop(_.br_if(1,_.i32_eqz(_.getLocal("aux"))),_.setLocal("aux",_.i32_shr_u(_.getLocal("aux"),_.i32_const(1))),_.setLocal("bits",_.i32_add(_.getLocal("bits"),_.i32_const(1))),_.br(0)))),F.addCode(_.if(_.i32_ne(_.getLocal("n"),_.i32_shl(_.i32_const(1),_.getLocal("bits"))),_.unreachable())),F.addCode(_.if(_.i32_gt_u(_.getLocal("bits"),_.i32_const(I)),_.unreachable())),F.addCode(_.getLocal("bits"))}function j(){const F=t.addFunction(n+"_fft");F.addParam("px","i32"),F.addParam("n","i32"),F.addLocal("bits","i32");const _=F.getCodeBuilder(),Q=_.i32_const(t.alloc(d));F.addCode(_.setLocal("bits",_.call(n+"__log2",_.getLocal("n"))),_.call(a+"_one",Q),_.call(n+"_rawfft",_.getLocal("px"),_.getLocal("bits"),_.i32_const(0),Q))}function J(){const F=t.addFunction(n+"_ifft");F.addParam("px","i32"),F.addParam("n","i32"),F.addLocal("bits","i32"),F.addLocal("pInv2","i32");const _=F.getCodeBuilder();F.addCode(_.setLocal("bits",_.call(n+"__log2",_.getLocal("n"))),_.setLocal("pInv2",_.i32_add(_.i32_const(V),_.i32_mul(_.getLocal("bits"),_.i32_const(d)))),_.call(n+"_rawfft",_.getLocal("px"),_.getLocal("bits"),_.i32_const(1),_.getLocal("pInv2")))}function tt(){const F=t.addFunction(n+"_rawfft");F.addParam("px","i32"),F.addParam("bits","i32"),F.addParam("reverse","i32"),F.addParam("mulFactor","i32"),F.addLocal("s","i32"),F.addLocal("k","i32"),F.addLocal("j","i32"),F.addLocal("m","i32"),F.addLocal("mdiv2","i32"),F.addLocal("n","i32"),F.addLocal("pwm","i32"),F.addLocal("idx1","i32"),F.addLocal("idx2","i32");const _=F.getCodeBuilder(),Q=_.i32_const(t.alloc(d)),G=_.i32_const(t.alloc(f)),w=_.i32_const(t.alloc(f));F.addCode(_.call(n+"__reversePermutation",_.getLocal("px"),_.getLocal("bits")),_.setLocal("n",_.i32_shl(_.i32_const(1),_.getLocal("bits"))),_.setLocal("s",_.i32_const(1)),_.block(_.loop(_.br_if(1,_.i32_gt_u(_.getLocal("s"),_.getLocal("bits"))),_.setLocal("m",_.i32_shl(_.i32_const(1),_.getLocal("s"))),_.setLocal("pwm",_.i32_add(_.i32_const(T),_.i32_mul(_.getLocal("s"),_.i32_const(d)))),_.setLocal("k",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_ge_u(_.getLocal("k"),_.getLocal("n"))),_.call(a+"_one",Q),_.setLocal("mdiv2",_.i32_shr_u(_.getLocal("m"),_.i32_const(1))),_.setLocal("j",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_ge_u(_.getLocal("j"),_.getLocal("mdiv2"))),_.setLocal("idx1",_.i32_add(_.getLocal("px"),_.i32_mul(_.i32_add(_.getLocal("k"),_.getLocal("j")),_.i32_const(f)))),_.setLocal("idx2",_.i32_add(_.getLocal("idx1"),_.i32_mul(_.getLocal("mdiv2"),_.i32_const(f)))),_.call(o,_.getLocal("idx2"),Q,G),_.call(i+"_copy",_.getLocal("idx1"),w),_.call(i+"_add",w,G,_.getLocal("idx1")),_.call(i+"_sub",w,G,_.getLocal("idx2")),_.call(a+"_mul",Q,_.getLocal("pwm"),Q),_.setLocal("j",_.i32_add(_.getLocal("j"),_.i32_const(1))),_.br(0))),_.setLocal("k",_.i32_add(_.getLocal("k"),_.getLocal("m"))),_.br(0))),_.setLocal("s",_.i32_add(_.getLocal("s"),_.i32_const(1))),_.br(0))),_.call(n+"__fftFinal",_.getLocal("px"),_.getLocal("bits"),_.getLocal("reverse"),_.getLocal("mulFactor")))}function $(){const F=t.addFunction(n+"__fftFinal");F.addParam("px","i32"),F.addParam("bits","i32"),F.addParam("reverse","i32"),F.addParam("mulFactor","i32"),F.addLocal("n","i32"),F.addLocal("ndiv2","i32"),F.addLocal("pInv2","i32"),F.addLocal("i","i32"),F.addLocal("mask","i32"),F.addLocal("idx1","i32"),F.addLocal("idx2","i32");const _=F.getCodeBuilder(),Q=_.i32_const(t.alloc(f));F.addCode(_.if(_.i32_and(_.i32_eqz(_.getLocal("reverse")),_.call(a+"_isOne",_.getLocal("mulFactor"))),_.ret([])),_.setLocal("n",_.i32_shl(_.i32_const(1),_.getLocal("bits"))),_.setLocal("mask",_.i32_sub(_.getLocal("n"),_.i32_const(1))),_.setLocal("i",_.i32_const(1)),_.setLocal("ndiv2",_.i32_shr_u(_.getLocal("n"),_.i32_const(1))),_.block(_.loop(_.br_if(1,_.i32_ge_u(_.getLocal("i"),_.getLocal("ndiv2"))),_.setLocal("idx1",_.i32_add(_.getLocal("px"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.setLocal("idx2",_.i32_add(_.getLocal("px"),_.i32_mul(_.i32_sub(_.getLocal("n"),_.getLocal("i")),_.i32_const(f)))),_.if(_.getLocal("reverse"),_.if(_.call(a+"_isOne",_.getLocal("mulFactor")),[..._.call(i+"_copy",_.getLocal("idx1"),Q),..._.call(i+"_copy",_.getLocal("idx2"),_.getLocal("idx1")),..._.call(i+"_copy",Q,_.getLocal("idx2"))],[..._.call(i+"_copy",_.getLocal("idx1"),Q),..._.call(o,_.getLocal("idx2"),_.getLocal("mulFactor"),_.getLocal("idx1")),..._.call(o,Q,_.getLocal("mulFactor"),_.getLocal("idx2"))]),_.if(_.call(a+"_isOne",_.getLocal("mulFactor")),[],[..._.call(o,_.getLocal("idx1"),_.getLocal("mulFactor"),_.getLocal("idx1")),..._.call(o,_.getLocal("idx2"),_.getLocal("mulFactor"),_.getLocal("idx2"))])),_.setLocal("i",_.i32_add(_.getLocal("i"),_.i32_const(1))),_.br(0))),_.if(_.call(a+"_isOne",_.getLocal("mulFactor")),[],[..._.call(o,_.getLocal("px"),_.getLocal("mulFactor"),_.getLocal("px")),..._.setLocal("idx2",_.i32_add(_.getLocal("px"),_.i32_mul(_.getLocal("ndiv2"),_.i32_const(f)))),..._.call(o,_.getLocal("idx2"),_.getLocal("mulFactor"),_.getLocal("idx2"))]))}function et(){const F=t.addFunction(n+"__reversePermutation");F.addParam("px","i32"),F.addParam("bits","i32"),F.addLocal("n","i32"),F.addLocal("i","i32"),F.addLocal("ri","i32"),F.addLocal("idx1","i32"),F.addLocal("idx2","i32");const _=F.getCodeBuilder(),Q=_.i32_const(t.alloc(f));F.addCode(_.setLocal("n",_.i32_shl(_.i32_const(1),_.getLocal("bits"))),_.setLocal("i",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("i"),_.getLocal("n"))),_.setLocal("idx1",_.i32_add(_.getLocal("px"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.setLocal("ri",_.call(n+"__rev",_.getLocal("i"),_.getLocal("bits"))),_.setLocal("idx2",_.i32_add(_.getLocal("px"),_.i32_mul(_.getLocal("ri"),_.i32_const(f)))),_.if(_.i32_lt_u(_.getLocal("i"),_.getLocal("ri")),[..._.call(i+"_copy",_.getLocal("idx1"),Q),..._.call(i+"_copy",_.getLocal("idx2"),_.getLocal("idx1")),..._.call(i+"_copy",Q,_.getLocal("idx2"))]),_.setLocal("i",_.i32_add(_.getLocal("i"),_.i32_const(1))),_.br(0))))}function X(){const F=t.addFunction(n+"__rev");F.addParam("x","i32"),F.addParam("bits","i32"),F.setReturnType("i32");const _=F.getCodeBuilder();F.addCode(_.i32_rotl(_.i32_add(_.i32_add(_.i32_shl(_.i32_load8_u(_.i32_and(_.getLocal("x"),_.i32_const(255)),b,0),_.i32_const(24)),_.i32_shl(_.i32_load8_u(_.i32_and(_.i32_shr_u(_.getLocal("x"),_.i32_const(8)),_.i32_const(255)),b,0),_.i32_const(16))),_.i32_add(_.i32_shl(_.i32_load8_u(_.i32_and(_.i32_shr_u(_.getLocal("x"),_.i32_const(16)),_.i32_const(255)),b,0),_.i32_const(8)),_.i32_load8_u(_.i32_and(_.i32_shr_u(_.getLocal("x"),_.i32_const(24)),_.i32_const(255)),b,0))),_.getLocal("bits")))}function dt(){const F=t.addFunction(n+"_fftJoin");F.addParam("pBuff1","i32"),F.addParam("pBuff2","i32"),F.addParam("n","i32"),F.addParam("first","i32"),F.addParam("inc","i32"),F.addLocal("idx1","i32"),F.addLocal("idx2","i32"),F.addLocal("i","i32");const _=F.getCodeBuilder(),Q=_.i32_const(t.alloc(d)),G=_.i32_const(t.alloc(f)),w=_.i32_const(t.alloc(f));F.addCode(_.call(a+"_copy",_.getLocal("first"),Q),_.setLocal("i",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("i"),_.getLocal("n"))),_.setLocal("idx1",_.i32_add(_.getLocal("pBuff1"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.setLocal("idx2",_.i32_add(_.getLocal("pBuff2"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.call(o,_.getLocal("idx2"),Q,G),_.call(i+"_copy",_.getLocal("idx1"),w),_.call(i+"_add",w,G,_.getLocal("idx1")),_.call(i+"_sub",w,G,_.getLocal("idx2")),_.call(a+"_mul",Q,_.getLocal("inc"),Q),_.setLocal("i",_.i32_add(_.getLocal("i"),_.i32_const(1))),_.br(0))))}function rt(){const F=t.addFunction(n+"_fftJoinExt");F.addParam("pBuff1","i32"),F.addParam("pBuff2","i32"),F.addParam("n","i32"),F.addParam("first","i32"),F.addParam("inc","i32"),F.addParam("totalBits","i32"),F.addLocal("idx1","i32"),F.addLocal("idx2","i32"),F.addLocal("i","i32"),F.addLocal("pShiftToM","i32");const _=F.getCodeBuilder(),Q=_.i32_const(t.alloc(d)),G=_.i32_const(t.alloc(f));F.addCode(_.setLocal("pShiftToM",_.i32_add(_.i32_const(U),_.i32_mul(_.getLocal("totalBits"),_.i32_const(d)))),_.call(a+"_copy",_.getLocal("first"),Q),_.setLocal("i",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("i"),_.getLocal("n"))),_.setLocal("idx1",_.i32_add(_.getLocal("pBuff1"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.setLocal("idx2",_.i32_add(_.getLocal("pBuff2"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.call(i+"_add",_.getLocal("idx1"),_.getLocal("idx2"),G),_.call(o,_.getLocal("idx2"),_.getLocal("pShiftToM"),_.getLocal("idx2")),_.call(i+"_add",_.getLocal("idx1"),_.getLocal("idx2"),_.getLocal("idx2")),_.call(o,_.getLocal("idx2"),Q,_.getLocal("idx2")),_.call(i+"_copy",G,_.getLocal("idx1")),_.call(a+"_mul",Q,_.getLocal("inc"),Q),_.setLocal("i",_.i32_add(_.getLocal("i"),_.i32_const(1))),_.br(0))))}function mt(){const F=t.addFunction(n+"_fftJoinExtInv");F.addParam("pBuff1","i32"),F.addParam("pBuff2","i32"),F.addParam("n","i32"),F.addParam("first","i32"),F.addParam("inc","i32"),F.addParam("totalBits","i32"),F.addLocal("idx1","i32"),F.addLocal("idx2","i32"),F.addLocal("i","i32"),F.addLocal("pShiftToM","i32"),F.addLocal("pSConst","i32");const _=F.getCodeBuilder(),Q=_.i32_const(t.alloc(d)),G=_.i32_const(t.alloc(f));F.addCode(_.setLocal("pShiftToM",_.i32_add(_.i32_const(U),_.i32_mul(_.getLocal("totalBits"),_.i32_const(d)))),_.setLocal("pSConst",_.i32_add(_.i32_const(q),_.i32_mul(_.getLocal("totalBits"),_.i32_const(d)))),_.call(a+"_copy",_.getLocal("first"),Q),_.setLocal("i",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("i"),_.getLocal("n"))),_.setLocal("idx1",_.i32_add(_.getLocal("pBuff1"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.setLocal("idx2",_.i32_add(_.getLocal("pBuff2"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.call(o,_.getLocal("idx2"),Q,G),_.call(i+"_sub",_.getLocal("idx1"),G,_.getLocal("idx2")),_.call(o,_.getLocal("idx2"),_.getLocal("pSConst"),_.getLocal("idx2")),_.call(o,_.getLocal("idx1"),_.getLocal("pShiftToM"),_.getLocal("idx1")),_.call(i+"_sub",G,_.getLocal("idx1"),_.getLocal("idx1")),_.call(o,_.getLocal("idx1"),_.getLocal("pSConst"),_.getLocal("idx1")),_.call(a+"_mul",Q,_.getLocal("inc"),Q),_.setLocal("i",_.i32_add(_.getLocal("i"),_.i32_const(1))),_.br(0))))}function gt(){const F=t.addFunction(n+"_prepareLagrangeEvaluation");F.addParam("pBuff1","i32"),F.addParam("pBuff2","i32"),F.addParam("n","i32"),F.addParam("first","i32"),F.addParam("inc","i32"),F.addParam("totalBits","i32"),F.addLocal("idx1","i32"),F.addLocal("idx2","i32"),F.addLocal("i","i32"),F.addLocal("pShiftToM","i32"),F.addLocal("pSConst","i32");const _=F.getCodeBuilder(),Q=_.i32_const(t.alloc(d)),G=_.i32_const(t.alloc(f));F.addCode(_.setLocal("pShiftToM",_.i32_add(_.i32_const(U),_.i32_mul(_.getLocal("totalBits"),_.i32_const(d)))),_.setLocal("pSConst",_.i32_add(_.i32_const(q),_.i32_mul(_.getLocal("totalBits"),_.i32_const(d)))),_.call(a+"_copy",_.getLocal("first"),Q),_.setLocal("i",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("i"),_.getLocal("n"))),_.setLocal("idx1",_.i32_add(_.getLocal("pBuff1"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.setLocal("idx2",_.i32_add(_.getLocal("pBuff2"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.call(o,_.getLocal("idx1"),_.getLocal("pShiftToM"),G),_.call(i+"_sub",_.getLocal("idx2"),G,G),_.call(i+"_sub",_.getLocal("idx1"),_.getLocal("idx2"),_.getLocal("idx2")),_.call(o,G,_.getLocal("pSConst"),_.getLocal("idx1")),_.call(o,_.getLocal("idx2"),Q,_.getLocal("idx2")),_.call(a+"_mul",Q,_.getLocal("inc"),Q),_.setLocal("i",_.i32_add(_.getLocal("i"),_.i32_const(1))),_.br(0))))}function A(){const F=t.addFunction(n+"_fftMix");F.addParam("pBuff","i32"),F.addParam("n","i32"),F.addParam("exp","i32"),F.addLocal("nGroups","i32"),F.addLocal("nPerGroup","i32"),F.addLocal("nPerGroupDiv2","i32"),F.addLocal("pairOffset","i32"),F.addLocal("idx1","i32"),F.addLocal("idx2","i32"),F.addLocal("i","i32"),F.addLocal("j","i32"),F.addLocal("pwm","i32");const _=F.getCodeBuilder(),Q=_.i32_const(t.alloc(d)),G=_.i32_const(t.alloc(f)),w=_.i32_const(t.alloc(f));F.addCode(_.setLocal("nPerGroup",_.i32_shl(_.i32_const(1),_.getLocal("exp"))),_.setLocal("nPerGroupDiv2",_.i32_shr_u(_.getLocal("nPerGroup"),_.i32_const(1))),_.setLocal("nGroups",_.i32_shr_u(_.getLocal("n"),_.getLocal("exp"))),_.setLocal("pairOffset",_.i32_mul(_.getLocal("nPerGroupDiv2"),_.i32_const(f))),_.setLocal("pwm",_.i32_add(_.i32_const(T),_.i32_mul(_.getLocal("exp"),_.i32_const(d)))),_.setLocal("i",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("i"),_.getLocal("nGroups"))),_.call(a+"_one",Q),_.setLocal("j",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("j"),_.getLocal("nPerGroupDiv2"))),_.setLocal("idx1",_.i32_add(_.getLocal("pBuff"),_.i32_mul(_.i32_add(_.i32_mul(_.getLocal("i"),_.getLocal("nPerGroup")),_.getLocal("j")),_.i32_const(f)))),_.setLocal("idx2",_.i32_add(_.getLocal("idx1"),_.getLocal("pairOffset"))),_.call(o,_.getLocal("idx2"),Q,G),_.call(i+"_copy",_.getLocal("idx1"),w),_.call(i+"_add",w,G,_.getLocal("idx1")),_.call(i+"_sub",w,G,_.getLocal("idx2")),_.call(a+"_mul",Q,_.getLocal("pwm"),Q),_.setLocal("j",_.i32_add(_.getLocal("j"),_.i32_const(1))),_.br(0))),_.setLocal("i",_.i32_add(_.getLocal("i"),_.i32_const(1))),_.br(0))))}function u(){const F=t.addFunction(n+"_fftFinal");F.addParam("pBuff","i32"),F.addParam("n","i32"),F.addParam("factor","i32"),F.addLocal("idx1","i32"),F.addLocal("idx2","i32"),F.addLocal("i","i32"),F.addLocal("ndiv2","i32");const _=F.getCodeBuilder(),Q=_.i32_const(t.alloc(f));F.addCode(_.setLocal("ndiv2",_.i32_shr_u(_.getLocal("n"),_.i32_const(1))),_.if(_.i32_and(_.getLocal("n"),_.i32_const(1)),_.call(o,_.i32_add(_.getLocal("pBuff"),_.i32_mul(_.getLocal("ndiv2"),_.i32_const(f))),_.getLocal("factor"),_.i32_add(_.getLocal("pBuff"),_.i32_mul(_.getLocal("ndiv2"),_.i32_const(f))))),_.setLocal("i",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_ge_u(_.getLocal("i"),_.getLocal("ndiv2"))),_.setLocal("idx1",_.i32_add(_.getLocal("pBuff"),_.i32_mul(_.getLocal("i"),_.i32_const(f)))),_.setLocal("idx2",_.i32_add(_.getLocal("pBuff"),_.i32_mul(_.i32_sub(_.i32_sub(_.getLocal("n"),_.i32_const(1)),_.getLocal("i")),_.i32_const(f)))),_.call(o,_.getLocal("idx2"),_.getLocal("factor"),Q),_.call(o,_.getLocal("idx1"),_.getLocal("factor"),_.getLocal("idx2")),_.call(i+"_copy",Q,_.getLocal("idx1")),_.setLocal("i",_.i32_add(_.getLocal("i"),_.i32_const(1))),_.br(0))))}X(),et(),$(),tt(),D(),j(),J(),dt(),rt(),mt(),A(),u(),gt(),t.exportFunction(n+"_fft"),t.exportFunction(n+"_ifft"),t.exportFunction(n+"_rawfft"),t.exportFunction(n+"_fftJoin"),t.exportFunction(n+"_fftJoinExt"),t.exportFunction(n+"_fftJoinExtInv"),t.exportFunction(n+"_fftMix"),t.exportFunction(n+"_fftFinal"),t.exportFunction(n+"_prepareLagrangeEvaluation")},il=function(t,n,i){const o=t.modules[i].n64*8;function s(){const h=t.addFunction(n+"_zero");h.addParam("px","i32"),h.addParam("n","i32"),h.addLocal("lastp","i32"),h.addLocal("p","i32");const f=h.getCodeBuilder();h.addCode(f.setLocal("p",f.getLocal("px")),f.setLocal("lastp",f.i32_add(f.getLocal("px"),f.i32_mul(f.getLocal("n"),f.i32_const(o)))),f.block(f.loop(f.br_if(1,f.i32_eq(f.getLocal("p"),f.getLocal("lastp"))),f.call(i+"_zero",f.getLocal("p")),f.setLocal("p",f.i32_add(f.getLocal("p"),f.i32_const(o))),f.br(0))))}function d(){const h=t.addFunction(n+"_constructLC");h.addParam("ppolynomials","i32"),h.addParam("psignals","i32"),h.addParam("nSignals","i32"),h.addParam("pres","i32"),h.addLocal("i","i32"),h.addLocal("j","i32"),h.addLocal("pp","i32"),h.addLocal("ps","i32"),h.addLocal("pd","i32"),h.addLocal("ncoefs","i32");const f=h.getCodeBuilder(),l=f.i32_const(t.alloc(o));h.addCode(f.setLocal("i",f.i32_const(0)),f.setLocal("pp",f.getLocal("ppolynomials")),f.setLocal("ps",f.getLocal("psignals")),f.block(f.loop(f.br_if(1,f.i32_eq(f.getLocal("i"),f.getLocal("nSignals"))),f.setLocal("ncoefs",f.i32_load(f.getLocal("pp"))),f.setLocal("pp",f.i32_add(f.getLocal("pp"),f.i32_const(4))),f.setLocal("j",f.i32_const(0)),f.block(f.loop(f.br_if(1,f.i32_eq(f.getLocal("j"),f.getLocal("ncoefs"))),f.setLocal("pd",f.i32_add(f.getLocal("pres"),f.i32_mul(f.i32_load(f.getLocal("pp")),f.i32_const(o)))),f.setLocal("pp",f.i32_add(f.getLocal("pp"),f.i32_const(4))),f.call(i+"_mul",f.getLocal("ps"),f.getLocal("pp"),l),f.call(i+"_add",l,f.getLocal("pd"),f.getLocal("pd")),f.setLocal("pp",f.i32_add(f.getLocal("pp"),f.i32_const(o))),f.setLocal("j",f.i32_add(f.getLocal("j"),f.i32_const(1))),f.br(0))),f.setLocal("ps",f.i32_add(f.getLocal("ps"),f.i32_const(o))),f.setLocal("i",f.i32_add(f.getLocal("i"),f.i32_const(1))),f.br(0))))}return s(),d(),t.exportFunction(n+"_zero"),t.exportFunction(n+"_constructLC"),n},al=function(t,n,i){const o=t.modules[i].n64*8;function s(){const f=t.addFunction(n+"_buildABC");f.addParam("pCoefs","i32"),f.addParam("nCoefs","i32"),f.addParam("pWitness","i32"),f.addParam("pA","i32"),f.addParam("pB","i32"),f.addParam("pC","i32"),f.addParam("offsetOut","i32"),f.addParam("nOut","i32"),f.addParam("offsetWitness","i32"),f.addParam("nWitness","i32"),f.addLocal("it","i32"),f.addLocal("ita","i32"),f.addLocal("itb","i32"),f.addLocal("last","i32"),f.addLocal("m","i32"),f.addLocal("c","i32"),f.addLocal("s","i32"),f.addLocal("pOut","i32");const l=f.getCodeBuilder(),m=l.i32_const(t.alloc(o));f.addCode(l.setLocal("ita",l.getLocal("pA")),l.setLocal("itb",l.getLocal("pB")),l.setLocal("last",l.i32_add(l.getLocal("pA"),l.i32_mul(l.getLocal("nOut"),l.i32_const(o)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("ita"),l.getLocal("last"))),l.call(i+"_zero",l.getLocal("ita")),l.call(i+"_zero",l.getLocal("itb")),l.setLocal("ita",l.i32_add(l.getLocal("ita"),l.i32_const(o))),l.setLocal("itb",l.i32_add(l.getLocal("itb"),l.i32_const(o))),l.br(0))),l.setLocal("it",l.getLocal("pCoefs")),l.setLocal("last",l.i32_add(l.getLocal("pCoefs"),l.i32_mul(l.getLocal("nCoefs"),l.i32_const(o+12)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("it"),l.getLocal("last"))),l.setLocal("s",l.i32_load(l.getLocal("it"),8)),l.if(l.i32_or(l.i32_lt_u(l.getLocal("s"),l.getLocal("offsetWitness")),l.i32_ge_u(l.getLocal("s"),l.i32_add(l.getLocal("offsetWitness"),l.getLocal("nWitness")))),[...l.setLocal("it",l.i32_add(l.getLocal("it"),l.i32_const(o+12))),...l.br(1)]),l.setLocal("m",l.i32_load(l.getLocal("it"))),l.if(l.i32_eq(l.getLocal("m"),l.i32_const(0)),l.setLocal("pOut",l.getLocal("pA")),l.if(l.i32_eq(l.getLocal("m"),l.i32_const(1)),l.setLocal("pOut",l.getLocal("pB")),[...l.setLocal("it",l.i32_add(l.getLocal("it"),l.i32_const(o+12))),...l.br(1)])),l.setLocal("c",l.i32_load(l.getLocal("it"),4)),l.if(l.i32_or(l.i32_lt_u(l.getLocal("c"),l.getLocal("offsetOut")),l.i32_ge_u(l.getLocal("c"),l.i32_add(l.getLocal("offsetOut"),l.getLocal("nOut")))),[...l.setLocal("it",l.i32_add(l.getLocal("it"),l.i32_const(o+12))),...l.br(1)]),l.setLocal("pOut",l.i32_add(l.getLocal("pOut"),l.i32_mul(l.i32_sub(l.getLocal("c"),l.getLocal("offsetOut")),l.i32_const(o)))),l.call(i+"_mul",l.i32_add(l.getLocal("pWitness"),l.i32_mul(l.i32_sub(l.getLocal("s"),l.getLocal("offsetWitness")),l.i32_const(o))),l.i32_add(l.getLocal("it"),l.i32_const(12)),m),l.call(i+"_add",l.getLocal("pOut"),m,l.getLocal("pOut")),l.setLocal("it",l.i32_add(l.getLocal("it"),l.i32_const(o+12))),l.br(0))),l.setLocal("ita",l.getLocal("pA")),l.setLocal("itb",l.getLocal("pB")),l.setLocal("it",l.getLocal("pC")),l.setLocal("last",l.i32_add(l.getLocal("pA"),l.i32_mul(l.getLocal("nOut"),l.i32_const(o)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("ita"),l.getLocal("last"))),l.call(i+"_mul",l.getLocal("ita"),l.getLocal("itb"),l.getLocal("it")),l.setLocal("ita",l.i32_add(l.getLocal("ita"),l.i32_const(o))),l.setLocal("itb",l.i32_add(l.getLocal("itb"),l.i32_const(o))),l.setLocal("it",l.i32_add(l.getLocal("it"),l.i32_const(o))),l.br(0))))}function d(){const f=t.addFunction(n+"_joinABC");f.addParam("pA","i32"),f.addParam("pB","i32"),f.addParam("pC","i32"),f.addParam("n","i32"),f.addParam("pP","i32"),f.addLocal("ita","i32"),f.addLocal("itb","i32"),f.addLocal("itc","i32"),f.addLocal("itp","i32"),f.addLocal("last","i32");const l=f.getCodeBuilder(),m=l.i32_const(t.alloc(o));f.addCode(l.setLocal("ita",l.getLocal("pA")),l.setLocal("itb",l.getLocal("pB")),l.setLocal("itc",l.getLocal("pC")),l.setLocal("itp",l.getLocal("pP")),l.setLocal("last",l.i32_add(l.getLocal("pA"),l.i32_mul(l.getLocal("n"),l.i32_const(o)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("ita"),l.getLocal("last"))),l.call(i+"_mul",l.getLocal("ita"),l.getLocal("itb"),m),l.call(i+"_sub",m,l.getLocal("itc"),l.getLocal("itp")),l.setLocal("ita",l.i32_add(l.getLocal("ita"),l.i32_const(o))),l.setLocal("itb",l.i32_add(l.getLocal("itb"),l.i32_const(o))),l.setLocal("itc",l.i32_add(l.getLocal("itc"),l.i32_const(o))),l.setLocal("itp",l.i32_add(l.getLocal("itp"),l.i32_const(o))),l.br(0))))}function h(){const f=t.addFunction(n+"_batchAdd");f.addParam("pa","i32"),f.addParam("pb","i32"),f.addParam("n","i32"),f.addParam("pr","i32"),f.addLocal("ita","i32"),f.addLocal("itb","i32"),f.addLocal("itr","i32"),f.addLocal("last","i32");const l=f.getCodeBuilder();f.addCode(l.setLocal("ita",l.getLocal("pa")),l.setLocal("itb",l.getLocal("pb")),l.setLocal("itr",l.getLocal("pr")),l.setLocal("last",l.i32_add(l.getLocal("pa"),l.i32_mul(l.getLocal("n"),l.i32_const(o)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("ita"),l.getLocal("last"))),l.call(i+"_add",l.getLocal("ita"),l.getLocal("itb"),l.getLocal("itr")),l.setLocal("ita",l.i32_add(l.getLocal("ita"),l.i32_const(o))),l.setLocal("itb",l.i32_add(l.getLocal("itb"),l.i32_const(o))),l.setLocal("itr",l.i32_add(l.getLocal("itr"),l.i32_const(o))),l.br(0))))}return s(),d(),h(),t.exportFunction(n+"_buildABC"),t.exportFunction(n+"_joinABC"),t.exportFunction(n+"_batchAdd"),n},ol=function(t,n,i,a,o,s,d,h){const f=t.addFunction(n);f.addParam("pIn","i32"),f.addParam("n","i32"),f.addParam("pFirst","i32"),f.addParam("pInc","i32"),f.addParam("pOut","i32"),f.addLocal("pOldFree","i32"),f.addLocal("i","i32"),f.addLocal("pFrom","i32"),f.addLocal("pTo","i32");const l=f.getCodeBuilder(),m=l.i32_const(t.alloc(d));f.addCode(l.setLocal("pFrom",l.getLocal("pIn")),l.setLocal("pTo",l.getLocal("pOut"))),f.addCode(l.call(a+"_copy",l.getLocal("pFirst"),m)),f.addCode(l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(h,l.getLocal("pFrom"),m,l.getLocal("pTo")),l.setLocal("pFrom",l.i32_add(l.getLocal("pFrom"),l.i32_const(o))),l.setLocal("pTo",l.i32_add(l.getLocal("pTo"),l.i32_const(s))),l.call(a+"_mul",m,l.getLocal("pInc"),m),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0)))),t.exportFunction(n)};const Gt=gn,I_=Mo,E_=Yc,rl=$c,b_=Zc,sl=tl,No=nl,C_=il,S_=al,Gi=ol,{bitLength:F_,modInv:v_,isOdd:cl,isNegative:B_}=we;var x_=function(t,n){const i=n||"bn128";if(t.modules[i])return i;const a=21888242871839275222246405745257275088696311157297823662689037894645226208583n,o=21888242871839275222246405745257275088548364400416034343698204186575808495617n,s=Math.floor((F_(a-1n)-1)/64)+1,d=s*8,h=d,f=d,l=f*2,m=f*12,I=t.alloc(Gt.bigInt2BytesLE(o,h)),g=I_(t,a,"f1m");E_(t,o,"fr","frm");const B=t.alloc(Gt.bigInt2BytesLE(M(3n),f)),P=sl(t,"g1m","f1m",B);No(t,"frm","frm","frm","frm_mul"),C_(t,"pol","frm"),S_(t,"qap","frm");const C=rl(t,"f1m_neg","f2m","f1m"),N=t.alloc([...Gt.bigInt2BytesLE(M(19485874751759354771024239261021720505790618469301721065564631296452457478373n),f),...Gt.bigInt2BytesLE(M(266929791119991161246907387137283842545076965332900288569378510910307636690n),f)]),T=sl(t,"g2m","f2m",N);function K(E,r){const c=t.addFunction(E);c.addParam("pG","i32"),c.addParam("pFr","i32"),c.addParam("pr","i32");const y=c.getCodeBuilder(),S=y.i32_const(t.alloc(d));c.addCode(y.call("frm_fromMontgomery",y.getLocal("pFr"),S),y.call(r,y.getLocal("pG"),S,y.i32_const(d),y.getLocal("pr"))),t.exportFunction(E)}K("g1m_timesFr","g1m_timesScalar"),No(t,"g1m","g1m","frm","g1m_timesFr"),K("g2m_timesFr","g2m_timesScalar"),No(t,"g2m","g2m","frm","g2m_timesFr"),K("g1m_timesFrAffine","g1m_timesScalarAffine"),K("g2m_timesFrAffine","g2m_timesScalarAffine"),Gi(t,"frm_batchApplyKey","fmr","frm",d,d,d,"frm_mul"),Gi(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,d,"g1m_timesFr"),Gi(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,d,"g1m_timesFrAffine"),Gi(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,d,"g2m_timesFr"),Gi(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,d,"g2m_timesFrAffine");function M(E){return BigInt(E)*(1n<<BigInt(f*8))%a}const V=[1n,2n,1n],v=t.alloc([...Gt.bigInt2BytesLE(M(V[0]),f),...Gt.bigInt2BytesLE(M(V[1]),f),...Gt.bigInt2BytesLE(M(V[2]),f)]),p=[0n,1n,0n],L=t.alloc([...Gt.bigInt2BytesLE(M(p[0]),f),...Gt.bigInt2BytesLE(M(p[1]),f),...Gt.bigInt2BytesLE(M(p[2]),f)]),U=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],q=t.alloc([...Gt.bigInt2BytesLE(M(U[0][0]),f),...Gt.bigInt2BytesLE(M(U[0][1]),f),...Gt.bigInt2BytesLE(M(U[1][0]),f),...Gt.bigInt2BytesLE(M(U[1][1]),f),...Gt.bigInt2BytesLE(M(U[2][0]),f),...Gt.bigInt2BytesLE(M(U[2][1]),f)]),O=[[0n,0n],[1n,0n],[0n,0n]],R=t.alloc([...Gt.bigInt2BytesLE(M(O[0][0]),f),...Gt.bigInt2BytesLE(M(O[0][1]),f),...Gt.bigInt2BytesLE(M(O[1][0]),f),...Gt.bigInt2BytesLE(M(O[1][1]),f),...Gt.bigInt2BytesLE(M(O[2][0]),f),...Gt.bigInt2BytesLE(M(O[2][1]),f)]),b=t.alloc([...Gt.bigInt2BytesLE(M(1),f),...Gt.bigInt2BytesLE(M(0),f),...Gt.bigInt2BytesLE(M(0),f),...Gt.bigInt2BytesLE(M(0),f),...Gt.bigInt2BytesLE(M(0),f),...Gt.bigInt2BytesLE(M(0),f),...Gt.bigInt2BytesLE(M(0),f),...Gt.bigInt2BytesLE(M(0),f),...Gt.bigInt2BytesLE(M(0),f),...Gt.bigInt2BytesLE(M(0),f),...Gt.bigInt2BytesLE(M(0),f),...Gt.bigInt2BytesLE(M(0),f)]),D=t.alloc([...Gt.bigInt2BytesLE(M(9),f),...Gt.bigInt2BytesLE(M(1),f)]),j=t.alloc([...Gt.bigInt2BytesLE(M(v_(2n,a)),f),...Gt.bigInt2BytesLE(0n,f)]),J=D,tt=t.alloc([...Gt.bigInt2BytesLE(M(19485874751759354771024239261021720505790618469301721065564631296452457478373n),f),...Gt.bigInt2BytesLE(M(266929791119991161246907387137283842545076965332900288569378510910307636690n),f)]);function $(){const E=t.addFunction(i+"_mulNR6");E.addParam("x","i32"),E.addParam("pr","i32");const r=E.getCodeBuilder();E.addCode(r.call(C+"_mul",r.i32_const(D),r.getLocal("x"),r.getLocal("pr")))}$();const et=b_(t,i+"_mulNR6","f6m","f2m");function X(){const E=t.addFunction(i+"_mulNR12");E.addParam("x","i32"),E.addParam("pr","i32");const r=E.getCodeBuilder();E.addCode(r.call(C+"_mul",r.i32_const(D),r.i32_add(r.getLocal("x"),r.i32_const(d*4)),r.getLocal("pr")),r.call(C+"_copy",r.getLocal("x"),r.i32_add(r.getLocal("pr"),r.i32_const(d*2))),r.call(C+"_copy",r.i32_add(r.getLocal("x"),r.i32_const(d*2)),r.i32_add(r.getLocal("pr"),r.i32_const(d*4))))}X();const dt=rl(t,i+"_mulNR12","ftm",et),mt=ot(29793968203157093288n),gt=t.alloc(mt),A=3*l,u=mt.length-1,_=mt.reduce((E,r)=>E+(r!=0?1:0),0)+u+1,Q=3*2*d,G=3*d*2+_*A;t.modules[i]={n64:s,pG1gen:v,pG1zero:L,pG1b:B,pG2gen:q,pG2zero:R,pG2b:N,pq:t.modules.f1m.pq,pr:I,pOneT:b,prePSize:Q,preQSize:G,r:o.toString(),q:a.toString()};const w=4965661367192848881n;function k(E){let r=E;const c=[];for(;r>0n;){if(cl(r)){const y=2-Number(r%4n);c.push(y),r=r-BigInt(y)}else c.push(0);r=r>>1n}return c}function ot(E){let r=E;const c=[];for(;r>0n;)cl(r)?c.push(1):c.push(0),r=r>>1n;return c}function Y(){const E=t.addFunction(i+"_prepareG1");E.addParam("pP","i32"),E.addParam("ppreP","i32");const r=E.getCodeBuilder();E.addCode(r.call(P+"_normalize",r.getLocal("pP"),r.getLocal("ppreP")))}function nt(){const E=t.addFunction(i+"_prepAddStep");E.addParam("pQ","i32"),E.addParam("pR","i32"),E.addParam("pCoef","i32");const r=E.getCodeBuilder(),c=r.getLocal("pQ"),y=r.i32_add(r.getLocal("pQ"),r.i32_const(l)),S=r.getLocal("pR"),x=r.i32_add(r.getLocal("pR"),r.i32_const(l)),z=r.i32_add(r.getLocal("pR"),r.i32_const(2*l)),W=r.getLocal("pCoef"),Z=r.i32_add(r.getLocal("pCoef"),r.i32_const(l)),at=r.i32_add(r.getLocal("pCoef"),r.i32_const(2*l)),st=Z,it=r.i32_const(t.alloc(l)),ut=r.i32_const(t.alloc(l)),Ct=r.i32_const(t.alloc(l)),It=r.i32_const(t.alloc(l)),yt=r.i32_const(t.alloc(l)),Ft=r.i32_const(t.alloc(l)),vt=r.i32_const(t.alloc(l));E.addCode(r.call(C+"_mul",c,z,st),r.call(C+"_sub",S,st,st),r.call(C+"_mul",y,z,it),r.call(C+"_sub",x,it,it),r.call(C+"_square",st,ut),r.call(C+"_square",it,Ct),r.call(C+"_mul",st,ut,It),r.call(C+"_mul",S,ut,yt),r.call(C+"_add",yt,yt,vt),r.call(C+"_mul",z,Ct,Ft),r.call(C+"_add",It,Ft,Ft),r.call(C+"_sub",Ft,vt,Ft),r.call(C+"_mul",st,Ft,S),r.call(C+"_mul",It,x,x),r.call(C+"_sub",yt,Ft,vt),r.call(C+"_mul",it,vt,vt),r.call(C+"_sub",vt,x,x),r.call(C+"_mul",z,It,z),r.call(C+"_mul",st,y,vt),r.call(C+"_mul",it,c,W),r.call(C+"_sub",W,vt,W),r.call(C+"_mul",W,r.i32_const(J),W),r.call(C+"_neg",it,at))}function ft(){const E=t.addFunction(i+"_prepDblStep");E.addParam("pR","i32"),E.addParam("pCoef","i32");const r=E.getCodeBuilder(),c=r.getLocal("pR"),y=r.i32_add(r.getLocal("pR"),r.i32_const(l)),S=r.i32_add(r.getLocal("pR"),r.i32_const(2*l)),x=r.getLocal("pCoef"),z=r.i32_add(r.getLocal("pCoef"),r.i32_const(l)),W=r.i32_add(r.getLocal("pCoef"),r.i32_const(2*l)),Z=r.i32_const(t.alloc(l)),at=r.i32_const(t.alloc(l)),st=r.i32_const(t.alloc(l)),it=r.i32_const(t.alloc(l)),ut=r.i32_const(t.alloc(l)),Ct=r.i32_const(t.alloc(l)),It=r.i32_const(t.alloc(l)),yt=r.i32_const(t.alloc(l)),Ft=r.i32_const(t.alloc(l)),vt=r.i32_const(t.alloc(l)),Dt=r.i32_const(t.alloc(l)),Bt=r.i32_const(t.alloc(l));E.addCode(r.call(C+"_mul",y,r.i32_const(j),Z),r.call(C+"_mul",c,Z,Z),r.call(C+"_square",y,at),r.call(C+"_square",S,st),r.call(C+"_add",st,st,it),r.call(C+"_add",it,st,it),r.call(C+"_mul",r.i32_const(tt),it,ut),r.call(C+"_add",ut,ut,Ct),r.call(C+"_add",ut,Ct,Ct),r.call(C+"_add",at,Ct,It),r.call(C+"_mul",It,r.i32_const(j),It),r.call(C+"_add",at,st,Bt),r.call(C+"_add",y,S,yt),r.call(C+"_square",yt,yt),r.call(C+"_sub",yt,Bt,yt),r.call(C+"_sub",ut,at,Ft),r.call(C+"_square",c,vt),r.call(C+"_square",ut,Dt),r.call(C+"_sub",at,Ct,Bt),r.call(C+"_mul",Z,Bt,c),r.call(C+"_add",Dt,Dt,Bt),r.call(C+"_add",Dt,Bt,Bt),r.call(C+"_square",It,y),r.call(C+"_sub",y,Bt,y),r.call(C+"_mul",at,yt,S),r.call(C+"_mul",r.i32_const(J),Ft,x),r.call(C+"_neg",yt,z),r.call(C+"_add",vt,vt,W),r.call(C+"_add",vt,W,W))}function Lt(){const E=t.addFunction(i+"_mulByQ");E.addParam("p1","i32"),E.addParam("pr","i32");const r=E.getCodeBuilder(),c=r.getLocal("p1"),y=r.i32_add(r.getLocal("p1"),r.i32_const(l)),S=r.i32_add(r.getLocal("p1"),r.i32_const(l*2)),x=r.getLocal("pr"),z=r.i32_add(r.getLocal("pr"),r.i32_const(l)),W=r.i32_add(r.getLocal("pr"),r.i32_const(l*2)),Z=r.i32_const(t.alloc([...Gt.bigInt2BytesLE(M("21575463638280843010398324269430826099269044274347216827212613867836435027261"),f),...Gt.bigInt2BytesLE(M("10307601595873709700152284273816112264069230130616436755625194854815875713954"),f)])),at=r.i32_const(t.alloc([...Gt.bigInt2BytesLE(M("2821565182194536844548159561693502659359617185244120367078079554186484126554"),f),...Gt.bigInt2BytesLE(M("3505843767911556378687030309984248845540243509899259641013678093033130930403"),f)]));E.addCode(r.call(C+"_conjugate",c,x),r.call(C+"_mul",Z,x,x),r.call(C+"_conjugate",y,z),r.call(C+"_mul",at,z,z),r.call(C+"_conjugate",S,W))}function At(){Lt();const E=t.addFunction(i+"_prepareG2");E.addParam("pQ","i32"),E.addParam("ppreQ","i32"),E.addLocal("pCoef","i32"),E.addLocal("i","i32");const r=E.getCodeBuilder(),c=r.getLocal("pQ"),y=t.alloc(l*3),S=r.i32_const(y),x=r.i32_const(y),z=r.i32_const(y+l),W=r.i32_const(y+2*l),Z=r.i32_add(r.getLocal("ppreQ"),r.i32_const(0)),at=r.i32_add(r.getLocal("ppreQ"),r.i32_const(l)),st=t.alloc(l*3),it=r.i32_const(st),ut=t.alloc(l*3),Ct=r.i32_const(ut),It=r.i32_const(ut+l);E.addCode(r.call(T+"_normalize",c,Z),r.call(C+"_copy",Z,x),r.call(C+"_copy",at,z),r.call(C+"_one",W)),E.addCode(r.setLocal("pCoef",r.i32_add(r.getLocal("ppreQ"),r.i32_const(l*3))),r.setLocal("i",r.i32_const(mt.length-2)),r.block(r.loop(r.call(i+"_prepDblStep",S,r.getLocal("pCoef")),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(A))),r.if(r.i32_load8_s(r.getLocal("i"),gt),[...r.call(i+"_prepAddStep",Z,S,r.getLocal("pCoef")),...r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(A)))]),r.br_if(1,r.i32_eqz(r.getLocal("i"))),r.setLocal("i",r.i32_sub(r.getLocal("i"),r.i32_const(1))),r.br(0)))),E.addCode(r.call(i+"_mulByQ",Z,it),r.call(i+"_mulByQ",it,Ct)),E.addCode(r.call(C+"_neg",It,It),r.call(i+"_prepAddStep",it,S,r.getLocal("pCoef")),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(A))),r.call(i+"_prepAddStep",Ct,S,r.getLocal("pCoef")),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(A))))}function ht(){const E=t.addFunction(i+"__mulBy024Old");E.addParam("pEll0","i32"),E.addParam("pEllVW","i32"),E.addParam("pEllVV","i32"),E.addParam("pR","i32");const r=E.getCodeBuilder(),c=r.getLocal("pEll0"),y=r.getLocal("pEllVV"),S=r.getLocal("pEllVW"),x=r.getLocal("pR"),z=t.alloc(m),W=r.i32_const(z),Z=r.i32_const(z),at=r.i32_const(z+l),st=r.i32_const(z+l*2),it=r.i32_const(z+l*3),ut=r.i32_const(z+l*4),Ct=r.i32_const(z+l*5);E.addCode(r.call(C+"_copy",c,Z),r.call(C+"_zero",at),r.call(C+"_copy",y,st),r.call(C+"_zero",it),r.call(C+"_copy",S,ut),r.call(C+"_zero",Ct),r.call(dt+"_mul",W,x,x))}function ct(){const E=t.addFunction(i+"__mulBy024");E.addParam("pEll0","i32"),E.addParam("pEllVW","i32"),E.addParam("pEllVV","i32"),E.addParam("pR","i32");const r=E.getCodeBuilder(),c=r.getLocal("pEll0"),y=r.getLocal("pEllVV"),S=r.getLocal("pEllVW"),x=r.getLocal("pR"),z=r.i32_add(r.getLocal("pR"),r.i32_const(2*d)),W=r.i32_add(r.getLocal("pR"),r.i32_const(4*d)),Z=r.i32_add(r.getLocal("pR"),r.i32_const(6*d)),at=r.i32_add(r.getLocal("pR"),r.i32_const(8*d)),st=r.i32_add(r.getLocal("pR"),r.i32_const(10*d)),it=r.i32_const(t.alloc(l)),ut=r.i32_const(t.alloc(l)),Ct=r.i32_const(t.alloc(l)),It=r.i32_const(t.alloc(l)),yt=r.i32_const(t.alloc(l)),Ft=r.i32_const(t.alloc(l)),vt=r.i32_const(t.alloc(l)),Dt=r.i32_const(t.alloc(l)),Bt=r.i32_const(t.alloc(l)),xt=r.i32_const(t.alloc(l)),St=r.i32_const(t.alloc(l));E.addCode(r.call(C+"_mul",x,c,vt),r.call(C+"_mul",W,y,Dt),r.call(C+"_mul",at,S,Bt),r.call(C+"_add",x,at,Ct),r.call(C+"_add",x,W,ut),r.call(C+"_add",z,Z,It),r.call(C+"_add",It,st,It),r.call(C+"_mul",z,y,xt),r.call(C+"_add",xt,Bt,yt),r.call(C+"_mul",r.i32_const(D),yt,Ft),r.call(C+"_add",Ft,vt,x),r.call(C+"_mul",st,S,yt),r.call(C+"_add",xt,yt,xt),r.call(C+"_add",yt,Dt,yt),r.call(C+"_mul",r.i32_const(D),yt,Ft),r.call(C+"_mul",z,c,yt),r.call(C+"_add",xt,yt,xt),r.call(C+"_add",Ft,yt,z),r.call(C+"_add",c,y,it),r.call(C+"_mul",ut,it,yt),r.call(C+"_add",vt,Dt,St),r.call(C+"_sub",yt,St,yt),r.call(C+"_mul",Z,S,Ft),r.call(C+"_add",xt,Ft,xt),r.call(C+"_add",W,at,it),r.call(C+"_add",yt,Ft,W),r.call(C+"_add",y,S,ut),r.call(C+"_mul",ut,it,yt),r.call(C+"_add",Dt,Bt,St),r.call(C+"_sub",yt,St,yt),r.call(C+"_mul",r.i32_const(D),yt,Ft),r.call(C+"_mul",Z,c,yt),r.call(C+"_add",xt,yt,xt),r.call(C+"_add",Ft,yt,Z),r.call(C+"_mul",st,y,yt),r.call(C+"_add",xt,yt,xt),r.call(C+"_mul",r.i32_const(D),yt,Ft),r.call(C+"_add",c,S,it),r.call(C+"_mul",Ct,it,yt),r.call(C+"_add",vt,Bt,St),r.call(C+"_sub",yt,St,yt),r.call(C+"_add",Ft,yt,at),r.call(C+"_add",c,y,it),r.call(C+"_add",it,S,it),r.call(C+"_mul",It,it,yt),r.call(C+"_sub",yt,xt,st))}function _t(){const E=t.addFunction(i+"_millerLoop");E.addParam("ppreP","i32"),E.addParam("ppreQ","i32"),E.addParam("r","i32"),E.addLocal("pCoef","i32"),E.addLocal("i","i32");const r=E.getCodeBuilder(),c=r.getLocal("ppreP"),y=r.i32_add(r.getLocal("ppreP"),r.i32_const(f)),S=r.getLocal("pCoef"),x=r.i32_add(r.getLocal("pCoef"),r.i32_const(l)),z=r.i32_add(r.getLocal("pCoef"),r.i32_const(2*l)),W=t.alloc(l),Z=r.i32_const(W),at=t.alloc(l),st=r.i32_const(at),it=r.getLocal("r");E.addCode(r.call(dt+"_one",it),r.setLocal("pCoef",r.i32_add(r.getLocal("ppreQ"),r.i32_const(l*3))),r.setLocal("i",r.i32_const(mt.length-2)),r.block(r.loop(r.call(dt+"_square",it,it),r.call(C+"_mul1",x,y,Z),r.call(C+"_mul1",z,c,st),r.call(i+"__mulBy024",S,Z,st,it),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(A))),r.if(r.i32_load8_s(r.getLocal("i"),gt),[...r.call(C+"_mul1",x,y,Z),...r.call(C+"_mul1",z,c,st),...r.call(i+"__mulBy024",S,Z,st,it),...r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(A)))]),r.br_if(1,r.i32_eqz(r.getLocal("i"))),r.setLocal("i",r.i32_sub(r.getLocal("i"),r.i32_const(1))),r.br(0)))),E.addCode(r.call(C+"_mul1",x,y,Z),r.call(C+"_mul1",z,c,st),r.call(i+"__mulBy024",S,Z,st,it),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(A))),r.call(C+"_mul1",x,y,Z),r.call(C+"_mul1",z,c,st),r.call(i+"__mulBy024",S,Z,st,it),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(A))))}function wt(E){const r=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],c=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],y=t.addFunction(i+"__frobeniusMap"+E);y.addParam("x","i32"),y.addParam("r","i32");const S=y.getCodeBuilder();for(let z=0;z<6;z++){const W=z==0?S.getLocal("x"):S.i32_add(S.getLocal("x"),S.i32_const(z*l)),Z=W,at=S.i32_add(S.getLocal("x"),S.i32_const(z*l+f)),st=z==0?S.getLocal("r"):S.i32_add(S.getLocal("r"),S.i32_const(z*l)),it=st,ut=S.i32_add(S.getLocal("r"),S.i32_const(z*l+f)),Ct=x(r[Math.floor(z/3)][E%12],c[z%3][E%6]),It=t.alloc([...Gt.bigInt2BytesLE(M(Ct[0]),32),...Gt.bigInt2BytesLE(M(Ct[1]),32)]);E%2==1?y.addCode(S.call(g+"_copy",Z,it),S.call(g+"_neg",at,ut),S.call(C+"_mul",st,S.i32_const(It),st)):y.addCode(S.call(C+"_mul",W,S.i32_const(It),st))}function x(z,W){const Z=BigInt(z[0]),at=BigInt(z[1]),st=BigInt(W[0]),it=BigInt(W[1]),ut=[(Z*st-at*it)%a,(Z*it+at*st)%a];return B_(ut[0])&&(ut[0]=ut[0]+a),ut}}function Et(){const E=t.addFunction(i+"__finalExponentiationFirstChunk");E.addParam("x","i32"),E.addParam("r","i32");const r=E.getCodeBuilder(),c=r.getLocal("x"),y=c,S=r.i32_add(c,r.i32_const(d*6)),x=r.getLocal("r"),z=t.alloc(m),W=r.i32_const(z),Z=W,at=r.i32_const(z+d*6),st=r.i32_const(t.alloc(m)),it=r.i32_const(t.alloc(m)),ut=r.i32_const(t.alloc(m));E.addCode(r.call(et+"_copy",y,Z),r.call(et+"_neg",S,at),r.call(dt+"_inverse",c,st),r.call(dt+"_mul",W,st,it),r.call(i+"__frobeniusMap2",it,ut),r.call(dt+"_mul",it,ut,x))}function Tt(){const E=t.addFunction(i+"__cyclotomicSquare");E.addParam("x","i32"),E.addParam("r","i32");const r=E.getCodeBuilder(),c=r.getLocal("x"),y=r.i32_add(r.getLocal("x"),r.i32_const(l)),S=r.i32_add(r.getLocal("x"),r.i32_const(2*l)),x=r.i32_add(r.getLocal("x"),r.i32_const(3*l)),z=r.i32_add(r.getLocal("x"),r.i32_const(4*l)),W=r.i32_add(r.getLocal("x"),r.i32_const(5*l)),Z=r.getLocal("r"),at=r.i32_add(r.getLocal("r"),r.i32_const(l)),st=r.i32_add(r.getLocal("r"),r.i32_const(2*l)),it=r.i32_add(r.getLocal("r"),r.i32_const(3*l)),ut=r.i32_add(r.getLocal("r"),r.i32_const(4*l)),Ct=r.i32_add(r.getLocal("r"),r.i32_const(5*l)),It=r.i32_const(t.alloc(l)),yt=r.i32_const(t.alloc(l)),Ft=r.i32_const(t.alloc(l)),vt=r.i32_const(t.alloc(l)),Dt=r.i32_const(t.alloc(l)),Bt=r.i32_const(t.alloc(l)),xt=r.i32_const(t.alloc(l)),St=r.i32_const(t.alloc(l));E.addCode(r.call(C+"_mul",c,z,xt),r.call(C+"_mul",z,r.i32_const(D),It),r.call(C+"_add",c,It,It),r.call(C+"_add",c,z,St),r.call(C+"_mul",St,It,It),r.call(C+"_mul",r.i32_const(D),xt,St),r.call(C+"_add",xt,St,St),r.call(C+"_sub",It,St,It),r.call(C+"_add",xt,xt,yt),r.call(C+"_mul",x,S,xt),r.call(C+"_mul",S,r.i32_const(D),Ft),r.call(C+"_add",x,Ft,Ft),r.call(C+"_add",x,S,St),r.call(C+"_mul",St,Ft,Ft),r.call(C+"_mul",r.i32_const(D),xt,St),r.call(C+"_add",xt,St,St),r.call(C+"_sub",Ft,St,Ft),r.call(C+"_add",xt,xt,vt),r.call(C+"_mul",y,W,xt),r.call(C+"_mul",W,r.i32_const(D),Dt),r.call(C+"_add",y,Dt,Dt),r.call(C+"_add",y,W,St),r.call(C+"_mul",St,Dt,Dt),r.call(C+"_mul",r.i32_const(D),xt,St),r.call(C+"_add",xt,St,St),r.call(C+"_sub",Dt,St,Dt),r.call(C+"_add",xt,xt,Bt),r.call(C+"_sub",It,c,Z),r.call(C+"_add",Z,Z,Z),r.call(C+"_add",It,Z,Z),r.call(C+"_add",yt,z,ut),r.call(C+"_add",ut,ut,ut),r.call(C+"_add",yt,ut,ut),r.call(C+"_mul",Bt,r.i32_const(J),St),r.call(C+"_add",St,x,it),r.call(C+"_add",it,it,it),r.call(C+"_add",St,it,it),r.call(C+"_sub",Dt,S,st),r.call(C+"_add",st,st,st),r.call(C+"_add",Dt,st,st),r.call(C+"_sub",Ft,y,at),r.call(C+"_add",at,at,at),r.call(C+"_add",Ft,at,at),r.call(C+"_add",vt,W,Ct),r.call(C+"_add",Ct,Ct,Ct),r.call(C+"_add",vt,Ct,Ct))}function Nt(E,r){const c=k(E).map(at=>at==-1?255:at),y=t.alloc(c),S=t.addFunction(i+"__cyclotomicExp_"+r);S.addParam("x","i32"),S.addParam("r","i32"),S.addLocal("bit","i32"),S.addLocal("i","i32");const x=S.getCodeBuilder(),z=x.getLocal("x"),W=x.getLocal("r"),Z=x.i32_const(t.alloc(m));S.addCode(x.call(dt+"_conjugate",z,Z),x.call(dt+"_one",W),x.if(x.teeLocal("bit",x.i32_load8_s(x.i32_const(c.length-1),y)),x.if(x.i32_eq(x.getLocal("bit"),x.i32_const(1)),x.call(dt+"_mul",W,z,W),x.call(dt+"_mul",W,Z,W))),x.setLocal("i",x.i32_const(c.length-2)),x.block(x.loop(x.call(i+"__cyclotomicSquare",W,W),x.if(x.teeLocal("bit",x.i32_load8_s(x.getLocal("i"),y)),x.if(x.i32_eq(x.getLocal("bit"),x.i32_const(1)),x.call(dt+"_mul",W,z,W),x.call(dt+"_mul",W,Z,W))),x.br_if(1,x.i32_eqz(x.getLocal("i"))),x.setLocal("i",x.i32_sub(x.getLocal("i"),x.i32_const(1))),x.br(0))))}function kt(){Tt(),Nt(w,"w0");const E=t.addFunction(i+"__finalExponentiationLastChunk");E.addParam("x","i32"),E.addParam("r","i32");const r=E.getCodeBuilder(),c=r.getLocal("x"),y=r.getLocal("r"),S=r.i32_const(t.alloc(m)),x=r.i32_const(t.alloc(m)),z=r.i32_const(t.alloc(m)),W=r.i32_const(t.alloc(m)),Z=r.i32_const(t.alloc(m)),at=r.i32_const(t.alloc(m)),st=r.i32_const(t.alloc(m)),it=r.i32_const(t.alloc(m)),ut=r.i32_const(t.alloc(m)),Ct=r.i32_const(t.alloc(m)),It=r.i32_const(t.alloc(m)),yt=r.i32_const(t.alloc(m)),Ft=r.i32_const(t.alloc(m)),vt=r.i32_const(t.alloc(m)),Dt=r.i32_const(t.alloc(m)),Bt=r.i32_const(t.alloc(m)),xt=r.i32_const(t.alloc(m)),St=r.i32_const(t.alloc(m)),Vt=r.i32_const(t.alloc(m)),me=r.i32_const(t.alloc(m)),Pe=r.i32_const(t.alloc(m));E.addCode(r.call(i+"__cyclotomicExp_w0",c,S),r.call(dt+"_conjugate",S,S),r.call(i+"__cyclotomicSquare",S,x),r.call(i+"__cyclotomicSquare",x,z),r.call(dt+"_mul",z,x,W),r.call(i+"__cyclotomicExp_w0",W,Z),r.call(dt+"_conjugate",Z,Z),r.call(i+"__cyclotomicSquare",Z,at),r.call(i+"__cyclotomicExp_w0",at,st),r.call(dt+"_conjugate",st,st),r.call(dt+"_conjugate",W,it),r.call(dt+"_conjugate",st,ut),r.call(dt+"_mul",ut,Z,Ct),r.call(dt+"_mul",Ct,it,It),r.call(dt+"_mul",It,x,yt),r.call(dt+"_mul",It,Z,Ft),r.call(dt+"_mul",Ft,c,vt),r.call(i+"__frobeniusMap1",yt,Dt),r.call(dt+"_mul",Dt,vt,Bt),r.call(i+"__frobeniusMap2",It,xt),r.call(dt+"_mul",xt,Bt,St),r.call(dt+"_conjugate",c,Vt),r.call(dt+"_mul",Vt,yt,me),r.call(i+"__frobeniusMap3",me,Pe),r.call(dt+"_mul",Pe,St,y))}function Kt(){Et(),kt();const E=t.addFunction(i+"_finalExponentiation");E.addParam("x","i32"),E.addParam("r","i32");const r=E.getCodeBuilder(),c=r.getLocal("x"),y=r.getLocal("r"),S=r.i32_const(t.alloc(m));E.addCode(r.call(i+"__finalExponentiationFirstChunk",c,S),r.call(i+"__finalExponentiationLastChunk",S,y))}function Mt(){const E=t.addFunction(i+"_finalExponentiationOld");E.addParam("x","i32"),E.addParam("r","i32");const r=552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,c=t.alloc(Gt.bigInt2BytesLE(r,352)),y=E.getCodeBuilder();E.addCode(y.call(dt+"_exp",y.getLocal("x"),y.i32_const(c),y.i32_const(352),y.getLocal("r")))}const bt=t.alloc(Q),Ht=t.alloc(G);function Qt(E){const r=t.addFunction(i+"_pairingEq"+E);for(let x=0;x<E;x++)r.addParam("p_"+x,"i32"),r.addParam("q_"+x,"i32");r.addParam("c","i32"),r.setReturnType("i32");const c=r.getCodeBuilder(),y=c.i32_const(t.alloc(m)),S=c.i32_const(t.alloc(m));r.addCode(c.call(dt+"_one",y));for(let x=0;x<E;x++)r.addCode(c.call(i+"_prepareG1",c.getLocal("p_"+x),c.i32_const(bt))),r.addCode(c.call(i+"_prepareG2",c.getLocal("q_"+x),c.i32_const(Ht))),r.addCode(c.call(i+"_millerLoop",c.i32_const(bt),c.i32_const(Ht),S)),r.addCode(c.call(dt+"_mul",y,S,y));r.addCode(c.call(i+"_finalExponentiation",y,y)),r.addCode(c.call(dt+"_eq",y,c.getLocal("c")))}function Yt(){const E=t.addFunction(i+"_pairing");E.addParam("p","i32"),E.addParam("q","i32"),E.addParam("r","i32");const r=E.getCodeBuilder(),c=r.i32_const(t.alloc(m));E.addCode(r.call(i+"_prepareG1",r.getLocal("p"),r.i32_const(bt))),E.addCode(r.call(i+"_prepareG2",r.getLocal("q"),r.i32_const(Ht))),E.addCode(r.call(i+"_millerLoop",r.i32_const(bt),r.i32_const(Ht),c)),E.addCode(r.call(i+"_finalExponentiation",c,r.getLocal("r")))}nt(),ft(),Y(),At(),ct(),ht(),_t();for(let E=0;E<10;E++)wt(E),t.exportFunction(i+"__frobeniusMap"+E);Mt(),Kt();for(let E=1;E<=5;E++)Qt(E),t.exportFunction(i+"_pairingEq"+E);Yt(),t.exportFunction(i+"_pairing"),t.exportFunction(i+"_prepareG1"),t.exportFunction(i+"_prepareG2"),t.exportFunction(i+"_millerLoop"),t.exportFunction(i+"_finalExponentiation"),t.exportFunction(i+"_finalExponentiationOld"),t.exportFunction(i+"__mulBy024"),t.exportFunction(i+"__mulBy024Old"),t.exportFunction(i+"__cyclotomicSquare"),t.exportFunction(i+"__cyclotomicExp_w0")};const Rt=gn,T_=Mo,P_=Yc,ll=$c,O_=Zc,dl=tl,ko=nl,R_=il,U_=al,Mi=ol,{bitLength:ul,isOdd:fl,isNegative:G_}=we;var M_=function(t,n){const i=n||"bls12381";if(t.modules[i])return i;const a=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,o=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,s=Math.floor((ul(a-1n)-1)/64)+1,d=s*8,h=d,f=h*2,l=h*12,m=Math.floor((ul(o-1n)-1)/64)+1,I=m*8,g=I,B=t.alloc(Rt.bigInt2BytesLE(o,g)),P=T_(t,a,"f1m","intq");P_(t,o,"fr","frm","intr");const C=t.alloc(Rt.bigInt2BytesLE(v(4n),h)),N=dl(t,"g1m","f1m",C);ko(t,"frm","frm","frm","frm_mul"),R_(t,"pol","frm"),U_(t,"qap","frm");const T=ll(t,"f1m_neg","f2m","f1m"),K=t.alloc([...Rt.bigInt2BytesLE(v(4n),h),...Rt.bigInt2BytesLE(v(4n),h)]),M=dl(t,"g2m","f2m",K);function V(r,c){const y=t.addFunction(r);y.addParam("pG","i32"),y.addParam("pFr","i32"),y.addParam("pr","i32");const S=y.getCodeBuilder(),x=S.i32_const(t.alloc(I));y.addCode(S.call("frm_fromMontgomery",S.getLocal("pFr"),x),S.call(c,S.getLocal("pG"),x,S.i32_const(I),S.getLocal("pr"))),t.exportFunction(r)}V("g1m_timesFr","g1m_timesScalar"),ko(t,"g1m","g1m","frm","g1m_timesFr"),V("g2m_timesFr","g2m_timesScalar"),ko(t,"g2m","g2m","frm","g2m_timesFr"),V("g1m_timesFrAffine","g1m_timesScalarAffine"),V("g2m_timesFrAffine","g2m_timesScalarAffine"),Mi(t,"frm_batchApplyKey","fmr","frm",I,I,I,"frm_mul"),Mi(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,I,"g1m_timesFr"),Mi(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,I,"g1m_timesFrAffine"),Mi(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,I,"g2m_timesFr"),Mi(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,I,"g2m_timesFrAffine");function v(r){return BigInt(r)*(1n<<BigInt(h*8))%a}const p=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],L=t.alloc([...Rt.bigInt2BytesLE(v(p[0]),h),...Rt.bigInt2BytesLE(v(p[1]),h),...Rt.bigInt2BytesLE(v(p[2]),h)]),U=[0n,1n,0n],q=t.alloc([...Rt.bigInt2BytesLE(v(U[0]),h),...Rt.bigInt2BytesLE(v(U[1]),h),...Rt.bigInt2BytesLE(v(U[2]),h)]),O=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],R=t.alloc([...Rt.bigInt2BytesLE(v(O[0][0]),h),...Rt.bigInt2BytesLE(v(O[0][1]),h),...Rt.bigInt2BytesLE(v(O[1][0]),h),...Rt.bigInt2BytesLE(v(O[1][1]),h),...Rt.bigInt2BytesLE(v(O[2][0]),h),...Rt.bigInt2BytesLE(v(O[2][1]),h)]),b=[[0n,0n],[1n,0n],[0n,0n]],D=t.alloc([...Rt.bigInt2BytesLE(v(b[0][0]),h),...Rt.bigInt2BytesLE(v(b[0][1]),h),...Rt.bigInt2BytesLE(v(b[1][0]),h),...Rt.bigInt2BytesLE(v(b[1][1]),h),...Rt.bigInt2BytesLE(v(b[2][0]),h),...Rt.bigInt2BytesLE(v(b[2][1]),h)]),j=t.alloc([...Rt.bigInt2BytesLE(v(1n),h),...Rt.bigInt2BytesLE(v(0n),h),...Rt.bigInt2BytesLE(v(0n),h),...Rt.bigInt2BytesLE(v(0n),h),...Rt.bigInt2BytesLE(v(0n),h),...Rt.bigInt2BytesLE(v(0n),h),...Rt.bigInt2BytesLE(v(0n),h),...Rt.bigInt2BytesLE(v(0n),h),...Rt.bigInt2BytesLE(v(0n),h),...Rt.bigInt2BytesLE(v(0n),h),...Rt.bigInt2BytesLE(v(0n),h),...Rt.bigInt2BytesLE(v(0n),h)]),J=t.alloc([...Rt.bigInt2BytesLE(v(1n),h),...Rt.bigInt2BytesLE(v(1n),h)]);function tt(){const r=t.addFunction(T+"_mulNR");r.addParam("x","i32"),r.addParam("pr","i32");const c=r.getCodeBuilder(),y=c.i32_const(t.alloc(h)),S=c.getLocal("x"),x=c.i32_add(c.getLocal("x"),c.i32_const(h)),z=c.getLocal("pr"),W=c.i32_add(c.getLocal("pr"),c.i32_const(h));r.addCode(c.call(P+"_copy",S,y),c.call(P+"_sub",S,x,z),c.call(P+"_add",y,x,W))}tt();const $=O_(t,T+"_mulNR","f6m","f2m");function et(){const r=t.addFunction($+"_mulNR");r.addParam("x","i32"),r.addParam("pr","i32");const c=r.getCodeBuilder(),y=c.i32_const(t.alloc(h*2));r.addCode(c.call(T+"_copy",c.getLocal("x"),y),c.call(T+"_mulNR",c.i32_add(c.getLocal("x"),c.i32_const(d*4)),c.getLocal("pr")),c.call(T+"_copy",c.i32_add(c.getLocal("x"),c.i32_const(d*2)),c.i32_add(c.getLocal("pr"),c.i32_const(d*4))),c.call(T+"_copy",y,c.i32_add(c.getLocal("pr"),c.i32_const(d*2))))}et();const X=ll(t,$+"_mulNR","ftm",$),rt=ot(0xd201000000010000n),mt=t.alloc(rt),gt=3*f,A=rt.length-1,F=rt.reduce((r,c)=>r+(c!=0?1:0),0)+A+1,_=3*2*d,Q=3*d*2+F*gt,G=!0,w=15132376222941642752n;t.modules[i]={n64q:s,n64r:m,n8q:d,n8r:I,pG1gen:L,pG1zero:q,pG1b:C,pG2gen:R,pG2zero:D,pG2b:K,pq:t.modules.f1m.pq,pr:B,pOneT:j,r:o,q:a,prePSize:_,preQSize:Q};function k(r){let c=r;const y=[];for(;c>0n;){if(fl(c)){const S=2-Number(c%4n);y.push(S),c=c-BigInt(S)}else y.push(0);c=c>>1n}return y}function ot(r){let c=r;const y=[];for(;c>0n;)fl(c)?y.push(1):y.push(0),c=c>>1n;return y}function Y(){const r=t.addFunction(i+"_prepareG1");r.addParam("pP","i32"),r.addParam("ppreP","i32");const c=r.getCodeBuilder();r.addCode(c.call(N+"_normalize",c.getLocal("pP"),c.getLocal("ppreP")))}function nt(){const r=t.addFunction(i+"_prepDblStep");r.addParam("R","i32"),r.addParam("r","i32");const c=r.getCodeBuilder(),y=c.getLocal("R"),S=c.i32_add(c.getLocal("R"),c.i32_const(2*d)),x=c.i32_add(c.getLocal("R"),c.i32_const(4*d)),z=c.getLocal("r"),W=c.i32_add(c.getLocal("r"),c.i32_const(2*d)),Z=c.i32_add(c.getLocal("r"),c.i32_const(4*d)),at=c.i32_const(t.alloc(f)),st=c.i32_const(t.alloc(f)),it=c.i32_const(t.alloc(f)),ut=c.i32_const(t.alloc(f)),Ct=c.i32_const(t.alloc(f));r.addCode(c.call(T+"_square",y,z),c.call(T+"_square",S,st),c.call(T+"_square",st,it),c.call(T+"_add",st,y,W),c.call(T+"_square",W,W),c.call(T+"_sub",W,z,W),c.call(T+"_sub",W,it,W),c.call(T+"_add",W,W,W),c.call(T+"_add",z,z,ut),c.call(T+"_add",ut,z,ut),c.call(T+"_add",y,ut,Z),c.call(T+"_square",ut,Ct),c.call(T+"_square",x,at),c.call(T+"_sub",Ct,W,y),c.call(T+"_sub",y,W,y),c.call(T+"_add",x,S,x),c.call(T+"_square",x,x),c.call(T+"_sub",x,st,x),c.call(T+"_sub",x,at,x),c.call(T+"_sub",W,y,S),c.call(T+"_mul",S,ut,S),c.call(T+"_add",it,it,it),c.call(T+"_add",it,it,it),c.call(T+"_add",it,it,it),c.call(T+"_sub",S,it,S),c.call(T+"_mul",ut,at,W),c.call(T+"_add",W,W,W),c.call(T+"_neg",W,W),c.call(T+"_square",Z,Z),c.call(T+"_sub",Z,z,Z),c.call(T+"_sub",Z,Ct,Z),c.call(T+"_add",st,st,st),c.call(T+"_add",st,st,st),c.call(T+"_sub",Z,st,Z),c.call(T+"_mul",x,at,z),c.call(T+"_add",z,z,z))}function ft(){const r=t.addFunction(i+"_prepAddStep");r.addParam("R","i32"),r.addParam("Q","i32"),r.addParam("r","i32");const c=r.getCodeBuilder(),y=c.getLocal("R"),S=c.i32_add(c.getLocal("R"),c.i32_const(2*d)),x=c.i32_add(c.getLocal("R"),c.i32_const(4*d)),z=c.getLocal("Q"),W=c.i32_add(c.getLocal("Q"),c.i32_const(2*d)),Z=c.getLocal("r"),at=c.i32_add(c.getLocal("r"),c.i32_const(2*d)),st=c.i32_add(c.getLocal("r"),c.i32_const(4*d)),it=c.i32_const(t.alloc(f)),ut=c.i32_const(t.alloc(f)),Ct=c.i32_const(t.alloc(f)),It=c.i32_const(t.alloc(f)),yt=c.i32_const(t.alloc(f)),Ft=c.i32_const(t.alloc(f)),vt=c.i32_const(t.alloc(f)),Dt=c.i32_const(t.alloc(f)),Bt=c.i32_const(t.alloc(f)),xt=c.i32_const(t.alloc(f)),St=c.i32_const(t.alloc(f));r.addCode(c.call(T+"_square",x,it),c.call(T+"_square",W,ut),c.call(T+"_mul",it,z,It),c.call(T+"_add",W,x,at),c.call(T+"_square",at,at),c.call(T+"_sub",at,ut,at),c.call(T+"_sub",at,it,at),c.call(T+"_mul",at,it,at),c.call(T+"_sub",It,y,yt),c.call(T+"_square",yt,Ft),c.call(T+"_add",Ft,Ft,vt),c.call(T+"_add",vt,vt,vt),c.call(T+"_mul",vt,yt,Dt),c.call(T+"_sub",at,S,Bt),c.call(T+"_sub",Bt,S,Bt),c.call(T+"_mul",Bt,z,st),c.call(T+"_mul",vt,y,xt),c.call(T+"_square",Bt,y),c.call(T+"_sub",y,Dt,y),c.call(T+"_sub",y,xt,y),c.call(T+"_sub",y,xt,y),c.call(T+"_add",x,yt,x),c.call(T+"_square",x,x),c.call(T+"_sub",x,it,x),c.call(T+"_sub",x,Ft,x),c.call(T+"_add",W,x,Z),c.call(T+"_sub",xt,y,St),c.call(T+"_mul",St,Bt,St),c.call(T+"_mul",S,Dt,It),c.call(T+"_add",It,It,It),c.call(T+"_sub",St,It,S),c.call(T+"_square",Z,Z),c.call(T+"_sub",Z,ut,Z),c.call(T+"_square",x,Ct),c.call(T+"_sub",Z,Ct,Z),c.call(T+"_add",st,st,st),c.call(T+"_sub",st,Z,st),c.call(T+"_add",x,x,Z),c.call(T+"_neg",Bt,Bt),c.call(T+"_add",Bt,Bt,at))}function Lt(){const r=t.addFunction(i+"_prepareG2");r.addParam("pQ","i32"),r.addParam("ppreQ","i32"),r.addLocal("pCoef","i32"),r.addLocal("i","i32");const c=r.getCodeBuilder(),y=c.getLocal("pQ"),S=t.alloc(f*3),x=c.i32_const(S),z=c.getLocal("ppreQ");r.addCode(c.call(M+"_normalize",y,z),c.if(c.call(M+"_isZero",z),c.ret([])),c.call(M+"_copy",z,x),c.setLocal("pCoef",c.i32_add(c.getLocal("ppreQ"),c.i32_const(f*3)))),r.addCode(c.setLocal("i",c.i32_const(rt.length-2)),c.block(c.loop(c.call(i+"_prepDblStep",x,c.getLocal("pCoef")),c.setLocal("pCoef",c.i32_add(c.getLocal("pCoef"),c.i32_const(gt))),c.if(c.i32_load8_s(c.getLocal("i"),mt),[...c.call(i+"_prepAddStep",x,z,c.getLocal("pCoef")),...c.setLocal("pCoef",c.i32_add(c.getLocal("pCoef"),c.i32_const(gt)))]),c.br_if(1,c.i32_eqz(c.getLocal("i"))),c.setLocal("i",c.i32_sub(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function At(){const r=t.addFunction($+"_mul1");r.addParam("pA","i32"),r.addParam("pC1","i32"),r.addParam("pR","i32");const c=r.getCodeBuilder(),y=c.getLocal("pA"),S=c.i32_add(c.getLocal("pA"),c.i32_const(h*2)),x=c.i32_add(c.getLocal("pA"),c.i32_const(h*4)),z=c.getLocal("pC1"),W=c.getLocal("pR"),Z=c.i32_add(c.getLocal("pR"),c.i32_const(h*2)),at=c.i32_add(c.getLocal("pR"),c.i32_const(h*4)),st=c.i32_const(t.alloc(h*2)),it=c.i32_const(t.alloc(h*2));r.addCode(c.call(T+"_add",y,S,st),c.call(T+"_add",S,x,it),c.call(T+"_mul",S,z,at),c.call(T+"_mul",it,z,W),c.call(T+"_sub",W,at,W),c.call(T+"_mulNR",W,W),c.call(T+"_mul",st,z,Z),c.call(T+"_sub",Z,at,Z))}At();function ht(){const r=t.addFunction($+"_mul01");r.addParam("pA","i32"),r.addParam("pC0","i32"),r.addParam("pC1","i32"),r.addParam("pR","i32");const c=r.getCodeBuilder(),y=c.getLocal("pA"),S=c.i32_add(c.getLocal("pA"),c.i32_const(h*2)),x=c.i32_add(c.getLocal("pA"),c.i32_const(h*4)),z=c.getLocal("pC0"),W=c.getLocal("pC1"),Z=c.getLocal("pR"),at=c.i32_add(c.getLocal("pR"),c.i32_const(h*2)),st=c.i32_add(c.getLocal("pR"),c.i32_const(h*4)),it=c.i32_const(t.alloc(h*2)),ut=c.i32_const(t.alloc(h*2)),Ct=c.i32_const(t.alloc(h*2)),It=c.i32_const(t.alloc(h*2));r.addCode(c.call(T+"_mul",y,z,it),c.call(T+"_mul",S,W,ut),c.call(T+"_add",y,S,Ct),c.call(T+"_add",y,x,It),c.call(T+"_add",S,x,Z),c.call(T+"_mul",Z,W,Z),c.call(T+"_sub",Z,ut,Z),c.call(T+"_mulNR",Z,Z),c.call(T+"_add",Z,it,Z),c.call(T+"_add",z,W,at),c.call(T+"_mul",at,Ct,at),c.call(T+"_sub",at,it,at),c.call(T+"_sub",at,ut,at),c.call(T+"_mul",It,z,st),c.call(T+"_sub",st,it,st),c.call(T+"_add",st,ut,st))}ht();function ct(){const r=t.addFunction(X+"_mul014");r.addParam("pA","i32"),r.addParam("pC0","i32"),r.addParam("pC1","i32"),r.addParam("pC4","i32"),r.addParam("pR","i32");const c=r.getCodeBuilder(),y=c.getLocal("pA"),S=c.i32_add(c.getLocal("pA"),c.i32_const(h*6)),x=c.getLocal("pC0"),z=c.getLocal("pC1"),W=c.getLocal("pC4"),Z=c.i32_const(t.alloc(h*6)),at=c.i32_const(t.alloc(h*6)),st=c.i32_const(t.alloc(h*2)),it=c.getLocal("pR"),ut=c.i32_add(c.getLocal("pR"),c.i32_const(h*6));r.addCode(c.call($+"_mul01",y,x,z,Z),c.call($+"_mul1",S,W,at),c.call(T+"_add",z,W,st),c.call($+"_add",S,y,ut),c.call($+"_mul01",ut,x,st,ut),c.call($+"_sub",ut,Z,ut),c.call($+"_sub",ut,at,ut),c.call($+"_copy",at,it),c.call($+"_mulNR",it,it),c.call($+"_add",it,Z,it))}ct();function _t(){const r=t.addFunction(i+"_ell");r.addParam("pP","i32"),r.addParam("pCoefs","i32"),r.addParam("pF","i32");const c=r.getCodeBuilder(),y=c.getLocal("pP"),S=c.i32_add(c.getLocal("pP"),c.i32_const(d)),x=c.getLocal("pF"),z=c.getLocal("pCoefs"),W=c.i32_add(c.getLocal("pCoefs"),c.i32_const(h)),Z=c.i32_add(c.getLocal("pCoefs"),c.i32_const(h*2)),at=c.i32_add(c.getLocal("pCoefs"),c.i32_const(h*3)),st=c.i32_add(c.getLocal("pCoefs"),c.i32_const(h*4)),it=t.alloc(h*2),ut=c.i32_const(it),Ct=c.i32_const(it),It=c.i32_const(it+h),yt=t.alloc(h*2),Ft=c.i32_const(yt),vt=c.i32_const(yt),Dt=c.i32_const(yt+h);r.addCode(c.call(P+"_mul",z,S,Ct),c.call(P+"_mul",W,S,It),c.call(P+"_mul",Z,y,vt),c.call(P+"_mul",at,y,Dt),c.call(X+"_mul014",x,st,Ft,ut,x))}_t();function wt(){const r=t.addFunction(i+"_millerLoop");r.addParam("ppreP","i32"),r.addParam("ppreQ","i32"),r.addParam("r","i32"),r.addLocal("pCoef","i32"),r.addLocal("i","i32");const c=r.getCodeBuilder(),y=c.getLocal("ppreP"),S=c.getLocal("pCoef"),x=c.getLocal("r");r.addCode(c.call(X+"_one",x),c.if(c.call(N+"_isZero",y),c.ret([])),c.if(c.call(N+"_isZero",c.getLocal("ppreQ")),c.ret([])),c.setLocal("pCoef",c.i32_add(c.getLocal("ppreQ"),c.i32_const(f*3))),c.setLocal("i",c.i32_const(rt.length-2)),c.block(c.loop(c.call(i+"_ell",y,S,x),c.setLocal("pCoef",c.i32_add(c.getLocal("pCoef"),c.i32_const(gt))),c.if(c.i32_load8_s(c.getLocal("i"),mt),[...c.call(i+"_ell",y,S,x),...c.setLocal("pCoef",c.i32_add(c.getLocal("pCoef"),c.i32_const(gt)))]),c.call(X+"_square",x,x),c.br_if(1,c.i32_eq(c.getLocal("i"),c.i32_const(1))),c.setLocal("i",c.i32_sub(c.getLocal("i"),c.i32_const(1))),c.br(0))),c.call(i+"_ell",y,S,x)),r.addCode(c.call(X+"_conjugate",x,x))}function Et(r){const c=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],y=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],S=t.addFunction(X+"_frobeniusMap"+r);S.addParam("x","i32"),S.addParam("r","i32");const x=S.getCodeBuilder();for(let W=0;W<6;W++){const Z=W==0?x.getLocal("x"):x.i32_add(x.getLocal("x"),x.i32_const(W*f)),at=Z,st=x.i32_add(x.getLocal("x"),x.i32_const(W*f+h)),it=W==0?x.getLocal("r"):x.i32_add(x.getLocal("r"),x.i32_const(W*f)),ut=it,Ct=x.i32_add(x.getLocal("r"),x.i32_const(W*f+h)),It=z(c[Math.floor(W/3)][r%12],y[W%3][r%6]),yt=t.alloc([...Rt.bigInt2BytesLE(v(It[0]),d),...Rt.bigInt2BytesLE(v(It[1]),d)]);r%2==1?S.addCode(x.call(P+"_copy",at,ut),x.call(P+"_neg",st,Ct),x.call(T+"_mul",it,x.i32_const(yt),it)):S.addCode(x.call(T+"_mul",Z,x.i32_const(yt),it))}function z(W,Z){const at=W[0],st=W[1],it=Z[0],ut=Z[1],Ct=[(at*it-st*ut)%a,(at*ut+st*it)%a];return G_(Ct[0])&&(Ct[0]=Ct[0]+a),Ct}}function Tt(){const r=t.addFunction(i+"__cyclotomicSquare");r.addParam("x","i32"),r.addParam("r","i32");const c=r.getCodeBuilder(),y=c.getLocal("x"),S=c.i32_add(c.getLocal("x"),c.i32_const(f)),x=c.i32_add(c.getLocal("x"),c.i32_const(2*f)),z=c.i32_add(c.getLocal("x"),c.i32_const(3*f)),W=c.i32_add(c.getLocal("x"),c.i32_const(4*f)),Z=c.i32_add(c.getLocal("x"),c.i32_const(5*f)),at=c.getLocal("r"),st=c.i32_add(c.getLocal("r"),c.i32_const(f)),it=c.i32_add(c.getLocal("r"),c.i32_const(2*f)),ut=c.i32_add(c.getLocal("r"),c.i32_const(3*f)),Ct=c.i32_add(c.getLocal("r"),c.i32_const(4*f)),It=c.i32_add(c.getLocal("r"),c.i32_const(5*f)),yt=c.i32_const(t.alloc(f)),Ft=c.i32_const(t.alloc(f)),vt=c.i32_const(t.alloc(f)),Dt=c.i32_const(t.alloc(f)),Bt=c.i32_const(t.alloc(f)),xt=c.i32_const(t.alloc(f)),St=c.i32_const(t.alloc(f)),Vt=c.i32_const(t.alloc(f));r.addCode(c.call(T+"_mul",y,W,St),c.call(T+"_mulNR",W,yt),c.call(T+"_add",y,yt,yt),c.call(T+"_add",y,W,Vt),c.call(T+"_mul",Vt,yt,yt),c.call(T+"_mulNR",St,Vt),c.call(T+"_add",St,Vt,Vt),c.call(T+"_sub",yt,Vt,yt),c.call(T+"_add",St,St,Ft),c.call(T+"_mul",z,x,St),c.call(T+"_mulNR",x,vt),c.call(T+"_add",z,vt,vt),c.call(T+"_add",z,x,Vt),c.call(T+"_mul",Vt,vt,vt),c.call(T+"_mulNR",St,Vt),c.call(T+"_add",St,Vt,Vt),c.call(T+"_sub",vt,Vt,vt),c.call(T+"_add",St,St,Dt),c.call(T+"_mul",S,Z,St),c.call(T+"_mulNR",Z,Bt),c.call(T+"_add",S,Bt,Bt),c.call(T+"_add",S,Z,Vt),c.call(T+"_mul",Vt,Bt,Bt),c.call(T+"_mulNR",St,Vt),c.call(T+"_add",St,Vt,Vt),c.call(T+"_sub",Bt,Vt,Bt),c.call(T+"_add",St,St,xt),c.call(T+"_sub",yt,y,at),c.call(T+"_add",at,at,at),c.call(T+"_add",yt,at,at),c.call(T+"_add",Ft,W,Ct),c.call(T+"_add",Ct,Ct,Ct),c.call(T+"_add",Ft,Ct,Ct),c.call(T+"_mul",xt,c.i32_const(J),Vt),c.call(T+"_add",Vt,z,ut),c.call(T+"_add",ut,ut,ut),c.call(T+"_add",Vt,ut,ut),c.call(T+"_sub",Bt,x,it),c.call(T+"_add",it,it,it),c.call(T+"_add",Bt,it,it),c.call(T+"_sub",vt,S,st),c.call(T+"_add",st,st,st),c.call(T+"_add",vt,st,st),c.call(T+"_add",Dt,Z,It),c.call(T+"_add",It,It,It),c.call(T+"_add",Dt,It,It))}function Nt(r,c,y){const S=k(r).map(it=>it==-1?255:it),x=t.alloc(S),z=t.addFunction(i+"__cyclotomicExp_"+y);z.addParam("x","i32"),z.addParam("r","i32"),z.addLocal("bit","i32"),z.addLocal("i","i32");const W=z.getCodeBuilder(),Z=W.getLocal("x"),at=W.getLocal("r"),st=W.i32_const(t.alloc(l));z.addCode(W.call(X+"_conjugate",Z,st),W.call(X+"_one",at),W.if(W.teeLocal("bit",W.i32_load8_s(W.i32_const(S.length-1),x)),W.if(W.i32_eq(W.getLocal("bit"),W.i32_const(1)),W.call(X+"_mul",at,Z,at),W.call(X+"_mul",at,st,at))),W.setLocal("i",W.i32_const(S.length-2)),W.block(W.loop(W.call(i+"__cyclotomicSquare",at,at),W.if(W.teeLocal("bit",W.i32_load8_s(W.getLocal("i"),x)),W.if(W.i32_eq(W.getLocal("bit"),W.i32_const(1)),W.call(X+"_mul",at,Z,at),W.call(X+"_mul",at,st,at))),W.br_if(1,W.i32_eqz(W.getLocal("i"))),W.setLocal("i",W.i32_sub(W.getLocal("i"),W.i32_const(1))),W.br(0)))),c&&z.addCode(W.call(X+"_conjugate",at,at))}function kt(){Tt(),Nt(w,G,"w0");const r=t.addFunction(i+"_finalExponentiation");r.addParam("x","i32"),r.addParam("r","i32");const c=r.getCodeBuilder(),y=c.getLocal("x"),S=c.getLocal("r"),x=c.i32_const(t.alloc(l)),z=c.i32_const(t.alloc(l)),W=c.i32_const(t.alloc(l)),Z=c.i32_const(t.alloc(l)),at=c.i32_const(t.alloc(l)),st=c.i32_const(t.alloc(l)),it=c.i32_const(t.alloc(l));r.addCode(c.call(X+"_frobeniusMap6",y,x),c.call(X+"_inverse",y,z),c.call(X+"_mul",x,z,W),c.call(X+"_copy",W,z),c.call(X+"_frobeniusMap2",W,W),c.call(X+"_mul",W,z,W),c.call(i+"__cyclotomicSquare",W,z),c.call(X+"_conjugate",z,z),c.call(i+"__cyclotomicExp_w0",W,Z),c.call(i+"__cyclotomicSquare",Z,at),c.call(X+"_mul",z,Z,st),c.call(i+"__cyclotomicExp_w0",st,z),c.call(i+"__cyclotomicExp_w0",z,x),c.call(i+"__cyclotomicExp_w0",x,it),c.call(X+"_mul",it,at,it),c.call(i+"__cyclotomicExp_w0",it,at),c.call(X+"_conjugate",st,st),c.call(X+"_mul",at,st,at),c.call(X+"_mul",at,W,at),c.call(X+"_conjugate",W,st),c.call(X+"_mul",z,W,z),c.call(X+"_frobeniusMap3",z,z),c.call(X+"_mul",it,st,it),c.call(X+"_frobeniusMap1",it,it),c.call(X+"_mul",Z,x,Z),c.call(X+"_frobeniusMap2",Z,Z),c.call(X+"_mul",Z,z,Z),c.call(X+"_mul",Z,it,Z),c.call(X+"_mul",Z,at,S))}function Kt(){const r=t.addFunction(i+"_finalExponentiationOld");r.addParam("x","i32"),r.addParam("r","i32");const c=322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,y=t.alloc(Rt.bigInt2BytesLE(c,544)),S=r.getCodeBuilder();r.addCode(S.call(X+"_exp",S.getLocal("x"),S.i32_const(y),S.i32_const(544),S.getLocal("r")))}const Mt=t.alloc(_),bt=t.alloc(Q);function Ht(r){const c=t.addFunction(i+"_pairingEq"+r);for(let z=0;z<r;z++)c.addParam("p_"+z,"i32"),c.addParam("q_"+z,"i32");c.addParam("c","i32"),c.setReturnType("i32");const y=c.getCodeBuilder(),S=y.i32_const(t.alloc(l)),x=y.i32_const(t.alloc(l));c.addCode(y.call(X+"_one",S));for(let z=0;z<r;z++)c.addCode(y.call(i+"_prepareG1",y.getLocal("p_"+z),y.i32_const(Mt))),c.addCode(y.call(i+"_prepareG2",y.getLocal("q_"+z),y.i32_const(bt))),c.addCode(y.if(y.i32_eqz(y.call(N+"_inGroupAffine",y.i32_const(Mt))),y.ret(y.i32_const(0))),y.if(y.i32_eqz(y.call(M+"_inGroupAffine",y.i32_const(bt))),y.ret(y.i32_const(0)))),c.addCode(y.call(i+"_millerLoop",y.i32_const(Mt),y.i32_const(bt),x)),c.addCode(y.call(X+"_mul",S,x,S));c.addCode(y.call(i+"_finalExponentiation",S,S)),c.addCode(y.call(X+"_eq",S,y.getLocal("c")))}function Qt(){const r=t.addFunction(i+"_pairing");r.addParam("p","i32"),r.addParam("q","i32"),r.addParam("r","i32");const c=r.getCodeBuilder(),y=c.i32_const(t.alloc(l));r.addCode(c.call(i+"_prepareG1",c.getLocal("p"),c.i32_const(Mt))),r.addCode(c.call(i+"_prepareG2",c.getLocal("q"),c.i32_const(bt))),r.addCode(c.call(i+"_millerLoop",c.i32_const(Mt),c.i32_const(bt),y)),r.addCode(c.call(i+"_finalExponentiation",y,c.getLocal("r")))}function Yt(){const r=t.addFunction(M+"_inGroupAffine");r.addParam("p","i32"),r.setReturnType("i32");const c=r.getCodeBuilder(),y=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],S=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,x=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],z=c.i32_const(t.alloc([...Rt.bigInt2BytesLE(v(y[0]),d),...Rt.bigInt2BytesLE(v(y[1]),d)])),W=c.i32_const(t.alloc(Rt.bigInt2BytesLE(v(S),d))),Z=c.i32_const(t.alloc([...Rt.bigInt2BytesLE(v(x[0]),d),...Rt.bigInt2BytesLE(v(x[1]),d)])),at=c.i32_const(t.alloc(Rt.bigInt2BytesLE(w,8))),st=c.getLocal("p"),it=c.i32_add(c.getLocal("p"),c.i32_const(f)),ut=c.i32_const(t.alloc(h)),Ct=c.i32_const(t.alloc(f)),It=c.i32_const(t.alloc(f)),yt=t.alloc(f*2),Ft=c.i32_const(yt),vt=c.i32_const(yt),Dt=c.i32_const(yt),Bt=c.i32_const(yt+h),xt=c.i32_const(yt+f),St=c.i32_const(yt+f),Vt=c.i32_const(yt+f+h),me=t.alloc(f*3),Pe=c.i32_const(me),ci=c.i32_const(me),Ln=c.i32_const(me),An=c.i32_const(me+h),li=c.i32_const(me+f),yn=c.i32_const(me+f),wn=c.i32_const(me+f+h),di=c.i32_const(me+f*2);r.addCode(c.if(c.call(M+"_isZeroAffine",c.getLocal("p")),c.ret(c.i32_const(1))),c.if(c.i32_eqz(c.call(M+"_inCurveAffine",c.getLocal("p"))),c.ret(c.i32_const(0))),c.call(T+"_mul",st,z,Ct),c.call(T+"_mul",it,z,It),c.call(T+"_mul1",Ct,W,vt),c.call(T+"_neg",It,xt),c.call(T+"_neg",Ct,ci),c.call(T+"_mul",It,Z,li),c.call(P+"_sub",Dt,Bt,ut),c.call(P+"_add",Dt,Bt,Bt),c.call(P+"_copy",ut,Dt),c.call(P+"_sub",St,Vt,ut),c.call(P+"_add",St,Vt,Vt),c.call(P+"_copy",ut,St),c.call(P+"_add",Ln,An,ut),c.call(P+"_sub",Ln,An,An),c.call(P+"_copy",ut,Ln),c.call(P+"_sub",wn,yn,ut),c.call(P+"_add",yn,wn,wn),c.call(P+"_copy",ut,yn),c.call(T+"_one",di),c.call(M+"_timesScalar",Pe,at,c.i32_const(8),Pe),c.call(M+"_addMixed",Pe,Ft,Pe),c.ret(c.call(M+"_eqMixed",Pe,c.getLocal("p"))));const cn=t.addFunction(M+"_inGroup");cn.addParam("pIn","i32"),cn.setReturnType("i32");const $e=cn.getCodeBuilder(),Mn=$e.i32_const(t.alloc(f*2));cn.addCode($e.call(M+"_toAffine",$e.getLocal("pIn"),Mn),$e.ret($e.call(M+"_inGroupAffine",Mn)))}function E(){const r=t.addFunction(N+"_inGroupAffine");r.addParam("p","i32"),r.setReturnType("i32");const c=r.getCodeBuilder(),y=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,S=793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,x=(w*w-1n)/3n,z=c.i32_const(t.alloc(Rt.bigInt2BytesLE(v(y),d))),W=c.i32_const(t.alloc(Rt.bigInt2BytesLE(v(S),d))),Z=c.i32_const(t.alloc(Rt.bigInt2BytesLE(x,16))),at=c.getLocal("p"),st=c.i32_add(c.getLocal("p"),c.i32_const(h)),it=t.alloc(h*3),ut=c.i32_const(it),Ct=c.i32_const(it),It=c.i32_const(it+h),yt=t.alloc(h*2),Ft=c.i32_const(yt),vt=c.i32_const(yt),Dt=c.i32_const(yt+h);r.addCode(c.if(c.call(N+"_isZeroAffine",c.getLocal("p")),c.ret(c.i32_const(1))),c.if(c.i32_eqz(c.call(N+"_inCurveAffine",c.getLocal("p"))),c.ret(c.i32_const(0))),c.call(P+"_mul",at,z,Ct),c.call(P+"_copy",st,It),c.call(P+"_mul",at,W,vt),c.call(P+"_copy",st,Dt),c.call(N+"_doubleAffine",ut,ut),c.call(N+"_subMixed",ut,c.getLocal("p"),ut),c.call(N+"_subMixed",ut,Ft,ut),c.call(N+"_timesScalar",ut,Z,c.i32_const(16),ut),c.ret(c.call(N+"_eqMixed",ut,Ft)));const Bt=t.addFunction(N+"_inGroup");Bt.addParam("pIn","i32"),Bt.setReturnType("i32");const xt=Bt.getCodeBuilder(),St=xt.i32_const(t.alloc(h*2));Bt.addCode(xt.call(N+"_toAffine",xt.getLocal("pIn"),St),xt.ret(xt.call(N+"_inGroupAffine",St)))}for(let r=0;r<10;r++)Et(r),t.exportFunction(X+"_frobeniusMap"+r);E(),Yt(),ft(),nt(),Y(),Lt(),wt(),Kt(),kt();for(let r=1;r<=5;r++)Ht(r),t.exportFunction(i+"_pairingEq"+r);Qt(),t.exportFunction(i+"_pairing"),t.exportFunction(i+"_prepareG1"),t.exportFunction(i+"_prepareG2"),t.exportFunction(i+"_millerLoop"),t.exportFunction(i+"_finalExponentiation"),t.exportFunction(i+"_finalExponentiationOld"),t.exportFunction(i+"__cyclotomicSquare"),t.exportFunction(i+"__cyclotomicExp_w0"),t.exportFunction($+"_mul1"),t.exportFunction($+"_mul01"),t.exportFunction(X+"_mul014"),t.exportFunction(N+"_inGroupAffine"),t.exportFunction(N+"_inGroup"),t.exportFunction(M+"_inGroupAffine"),t.exportFunction(M+"_inGroup")},D_=x_,N_=M_;function zo(e){if(typeof e=="bigint"||e.eq!==void 0)return e.toString(10);if(e instanceof Uint8Array)return Ti(e,0);if(Array.isArray(e))return e.map(zo);if(typeof e=="object"){const t={};return Object.keys(e).forEach(i=>{t[i]=zo(e[i])}),t}else return e}function qo(e){if(typeof e=="string"&&/^[0-9]+$/.test(e))return BigInt(e);if(typeof e=="string"&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(qo);if(typeof e=="object"){if(e===null)return null;const t={};return Object.keys(e).forEach(i=>{t[i]=qo(e[i])}),t}else return e}function k_(e){let t=BigInt(0),n=e.length,i=0;const a=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n>0;)n>=4?(n-=4,t+=BigInt(a.getUint32(n))<<BigInt(i*8),i+=4):n>=2?(n-=2,t+=BigInt(a.getUint16(n))<<BigInt(i*8),i+=2):(n-=1,t+=BigInt(a.getUint8(n))<<BigInt(i*8),i+=1);return t}function z_(e,t){let n=e;const i=new Uint8Array(t),a=new DataView(i.buffer);let o=t;for(;o>0;)o-4>=0?(o-=4,a.setUint32(o,Number(n&BigInt(4294967295))),n=n>>BigInt(32)):o-2>=0?(o-=2,a.setUint16(o,Number(n&BigInt(65535))),n=n>>BigInt(16)):(o-=1,a.setUint8(o,Number(n&BigInt(255))),n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function q_(e){let t=BigInt(0),n=0;const i=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n<e.length;)n+4<=e.length?(t+=BigInt(i.getUint32(n,!0))<<BigInt(n*8),n+=4):n+4<=e.length?(t+=BigInt(i.getUint16(n,!0))<<BigInt(n*8),n+=2):(t+=BigInt(i.getUint8(n,!0))<<BigInt(n*8),n+=1);return t}function _l(e,t){let n=e;typeof t>"u"&&(t=Math.floor((vi(e)-1)/8)+1,t==0&&(t=1));const i=new Uint8Array(t),a=new DataView(i.buffer);let o=0;for(;o<t;)o+4<=t?(a.setUint32(o,Number(n&BigInt(4294967295)),!0),o+=4,n=n>>BigInt(32)):o+2<=t?(a.setUint16(Number(o,n&BigInt(65535)),!0),o+=2,n=n>>BigInt(16)):(a.setUint8(Number(o,n&BigInt(255)),!0),o+=1,n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}function Qo(e,t){if(typeof t=="bigint"||t.eq!==void 0)return t.toString(10);if(t instanceof Uint8Array)return e.toString(e.e(t));if(Array.isArray(t))return t.map(Qo.bind(this,e));if(typeof t=="object"){const n={};return Object.keys(t).forEach(a=>{n[a]=Qo(e,t[a])}),n}else return t}function Ho(e,t){if(typeof t=="string"&&/^[0-9]+$/.test(t))return e.e(t);if(typeof t=="string"&&/^0x[0-9a-fA-F]+$/.test(t))return e.e(t);if(Array.isArray(t))return t.map(Ho.bind(this,e));if(typeof t=="object"){if(t===null)return null;const n={};return Object.keys(t).forEach(a=>{n[a]=Ho(e,t[a])}),n}else return t}const Di=[];for(let e=0;e<256;e++)Di[e]=Q_(e,8);function Q_(e,t){let n=0,i=e;for(let a=0;a<t;a++)n<<=1,n=n|i&1,i>>=1;return n}function hl(e,t){return(Di[e>>>24]|Di[e>>>16&255]<<8|Di[e>>>8&255]<<16|Di[e&255]<<24)>>>32-t}function Se(e){return((e&4294901760)!==0?(e&=4294901760,16):0)|((e&4278255360)!==0?(e&=4278255360,8):0)|((e&4042322160)!==0?(e&=4042322160,4):0)|((e&3435973836)!==0?(e&=3435973836,2):0)|(e&2863311530)!==0}function gl(e,t){const n=e.byteLength/t,i=Se(n);if(n!=1<<i)throw new Error("Invalid number of pointers");for(let a=0;a<n;a++){const o=hl(a,i);if(a>o){const s=e.slice(a*t,(a+1)*t);e.set(e.slice(o*t,(o+1)*t),a*t),e.set(s,o*t)}}}function Wo(e,t){const n=new Uint8Array(t*e.length);for(let i=0;i<e.length;i++)n.set(e[i],i*t);return n}function La(e,t){const n=e.byteLength/t,i=new Array(n);for(let a=0;a<n;a++)i[a]=e.slice(a*t,a*t+t);return i}var H_=Object.freeze({__proto__:null,stringifyBigInts:zo,unstringifyBigInts:qo,beBuff2int:k_,beInt2Buff:z_,leBuff2int:q_,leInt2Buff:_l,stringifyFElements:Qo,unstringifyFElements:Ho,bitReverse:hl,log2:Se,buffReverseBits:gl,array2buffer:Wo,buffer2array:La});const fe=1<<30;class Wt{constructor(t){this.buffers=[],this.byteLength=t;for(let n=0;n<t;n+=fe){const i=Math.min(t-n,fe);this.buffers.push(new Uint8Array(i))}}slice(t,n){n===void 0&&(n=this.byteLength),t===void 0&&(t=0);const i=n-t,a=Math.floor(t/fe),o=Math.floor((t+i-1)/fe);if(a==o||i==0)return this.buffers[a].slice(t%fe,t%fe+i);let s,d=a,h=t%fe,f=i;for(;f>0;){const l=h+f>fe?fe-h:f,m=new Uint8Array(this.buffers[d].buffer,this.buffers[d].byteOffset+h,l);if(l==i)return m.slice();s||(i<=fe?s=new Uint8Array(i):s=new Wt(i)),s.set(m,i-f),f=f-l,d++,h=0}return s}set(t,n){n===void 0&&(n=0);const i=t.byteLength;if(i==0)return;const a=Math.floor(n/fe),o=Math.floor((n+i-1)/fe);if(a==o)return t instanceof Wt&&t.buffers.length==1?this.buffers[a].set(t.buffers[0],n%fe):this.buffers[a].set(t,n%fe);let s=a,d=n%fe,h=i;for(;h>0;){const f=d+h>fe?fe-d:h,l=t.slice(i-h,i-h+f);new Uint8Array(this.buffers[s].buffer,this.buffers[s].byteOffset+d,f).set(l),h=h-f,s++,d=0}}}function pn(e,t,n,i){return async function(o){const s=Math.floor(o.byteLength/n);if(s*n!==o.byteLength)throw new Error("Invalid buffer size");const d=Math.floor(s/e.concurrency),h=[];for(let I=0;I<e.concurrency;I++){let g;if(I<e.concurrency-1?g=d:g=s-I*d,g==0)continue;const P=[{cmd:"ALLOCSET",var:0,buff:o.slice(I*d*n,I*d*n+g*n)},{cmd:"ALLOC",var:1,len:i*g},{cmd:"CALL",fnName:t,params:[{var:0},{val:g},{var:1}]},{cmd:"GET",out:0,var:1,len:i*g}];h.push(e.queueAction(P))}const f=await Promise.all(h);let l;o instanceof Wt?l=new Wt(s*i):l=new Uint8Array(s*i);let m=0;for(let I=0;I<f.length;I++)l.set(f[I][0],m),m+=f[I][0].byteLength;return l}}class pl{constructor(t,n,i,a){if(this.tm=t,this.prefix=n,this.p=a,this.n8=i,this.type="F1",this.m=1,this.half=ti(a,Pn),this.bitLength=vi(a),this.mask=nn(fa(Pn,this.bitLength),Pn),this.pOp1=t.alloc(i),this.pOp2=t.alloc(i),this.pOp3=t.alloc(i),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(i/8),this.n32=Math.floor(i/4),this.n64*8!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=ti(this.p,Pn),this.nqr=this.two;let o=this.exp(this.nqr,this.half);for(;!this.eq(o,this.negone);)this.nqr=this.add(this.nqr,this.one),o=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let s=nn(this.p,Pn);for(;!bo(s);)this.s=this.s+1,s=ti(s,Pn);this.w=[],this.w[this.s]=this.exp(this.nqr,s);for(let d=this.s-1;d>=0;d--)this.w[d]=this.square(this.w[d+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=pn(t,n+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=pn(t,n+"_batchFromMontgomery",this.n8,this.n8)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=ni(ie(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,n){if(t instanceof Uint8Array)return t;let i=ie(t,n);Cc(i)?(i=Bc(i),So(i,this.p)&&(i=Ke(i,this.p)),i=nn(this.p,i)):So(i,this.p)&&(i=Ke(i,this.p));const a=_l(i,this.n8);return this.toMontgomery(a)}toString(t,n){const i=this.fromMontgomery(t),a=Ti(i,0);return vo(a,n)}fromRng(t){let n;const i=new Uint8Array(this.n8);do{n=Rc;for(let a=0;a<this.n64;a++)n=Co(n,fa(t.nextU64(),64*a));n=Fo(n,this.mask)}while(Tc(n,this.p));return xi(i,0,n,this.n8),i}random(){return this.fromRng(Bo())}toObject(t){const n=this.fromMontgomery(t);return Ti(n,0)}fromObject(t){const n=new Uint8Array(this.n8);return xi(n,0,t,this.n8),this.toMontgomery(n)}toRprLE(t,n,i){t.set(this.fromMontgomery(i),n)}toRprBE(t,n,i){const a=this.fromMontgomery(i);for(let o=0;o<this.n8/2;o++){const s=a[o];a[o]=a[this.n8-1-o],a[this.n8-1-o]=s}t.set(a,n)}fromRprLE(t,n){n=n||0;const i=t.slice(n,n+this.n8);return this.toMontgomery(i)}async batchInverse(t){let n=!1;const i=this.n8,a=this.n8;Array.isArray(t)?(t=Wo(t,i),n=!0):t=t.slice(0,t.byteLength);const o=Math.floor(t.byteLength/i);if(o*i!==t.byteLength)throw new Error("Invalid buffer size");const s=Math.floor(o/this.tm.concurrency),d=[];for(let m=0;m<this.tm.concurrency;m++){let I;if(m<this.tm.concurrency-1?I=s:I=o-m*s,I==0)continue;const B=[{cmd:"ALLOCSET",var:0,buff:t.slice(m*s*i,m*s*i+I*i)},{cmd:"ALLOC",var:1,len:a*I},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:i},{val:I},{var:1},{val:a}]},{cmd:"GET",out:0,var:1,len:a*I}];d.push(this.tm.queueAction(B))}const h=await Promise.all(d);let f;t instanceof Wt?f=new Wt(o*a):f=new Uint8Array(o*a);let l=0;for(let m=0;m<h.length;m++)f.set(h[m][0],l),l+=h[m][0].byteLength;return n?La(f,a):f}}class ml{constructor(t,n,i){this.tm=t,this.prefix=n,this.F=i,this.type="F2",this.m=i.m*2,this.n8=this.F.n8*2,this.n32=this.F.n32*2,this.n64=this.F.n64*2,this.pOp1=t.alloc(i.n8*2),this.pOp2=t.alloc(i.n8*2),this.pOp3=t.alloc(i.n8*2),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}mul1(t,n){return this.op2("_mul1",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=ni(ie(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==2){const i=this.F.e(t[0],n),a=this.F.e(t[1],n),o=new Uint8Array(this.F.n8*2);return o.set(i),o.set(a,this.F.n8*2),o}else throw new Error("invalid F2")}toString(t,n){const i=this.F.toString(t.slice(0,this.F.n8),n),a=this.F.toString(t.slice(this.F.n8),n);return`[${i}, ${a}]`}fromRng(t){const n=this.F.fromRng(t),i=this.F.fromRng(t),a=new Uint8Array(this.F.n8*2);return a.set(n),a.set(i,this.F.n8),a}random(){return this.fromRng(Bo())}toObject(t){const n=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));return[n,i]}fromObject(t){const n=new Uint8Array(this.F.n8*2),i=this.F.fromObject(t[0]),a=this.F.fromObject(t[1]);return n.set(i),n.set(a,this.F.n8),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class W_{constructor(t,n,i){this.tm=t,this.prefix=n,this.F=i,this.type="F3",this.m=i.m*3,this.n8=this.F.n8*3,this.n32=this.F.n32*3,this.n64=this.F.n64*3,this.pOp1=t.alloc(i.n8*3),this.pOp2=t.alloc(i.n8*3),this.pOp3=t.alloc(i.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}add(t,n){return this.op2("_add",t,n)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=ni(ie(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==3){const i=this.F.e(t[0],n),a=this.F.e(t[1],n),o=this.F.e(t[2],n),s=new Uint8Array(this.F.n8*3);return s.set(i),s.set(a,this.F.n8),s.set(o,this.F.n8*2),s}else throw new Error("invalid F3")}toString(t,n){const i=this.F.toString(t.slice(0,this.F.n8),n),a=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),o=this.F.toString(t.slice(this.F.n8*2),n);return`[${i}, ${a}, ${o}]`}fromRng(t){const n=this.F.fromRng(t),i=this.F.fromRng(t),a=this.F.fromRng(t),o=new Uint8Array(this.F.n8*3);return o.set(n),o.set(i,this.F.n8),o.set(a,this.F.n8*2),o}random(){return this.fromRng(Bo())}toObject(t){const n=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),a=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3));return[n,i,a]}fromObject(t){const n=new Uint8Array(this.F.n8*3),i=this.F.fromObject(t[0]),a=this.F.fromObject(t[1]),o=this.F.fromObject(t[2]);return n.set(i),n.set(a,this.F.n8),n.set(o,this.F.n8*2),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,this.F.n8*2)}c3(t){return t.slice(this.F.n8*2)}}class Ll{constructor(t,n,i,a,o,s){this.tm=t,this.prefix=n,this.F=i,this.pOp1=t.alloc(i.n8*3),this.pOp2=t.alloc(i.n8*3),this.pOp3=t.alloc(i.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,i.n8*3),this.tm.instance.exports[n+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,i.n8*2),this.one=this.tm.getBuff(a,i.n8*3),this.g=this.one,this.oneAffine=this.tm.getBuff(a,i.n8*2),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(o,i.n8),s&&(this.cofactor=ni(s)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=pn(t,n+"_batchLEMtoC",i.n8*2,i.n8),this.batchLEMtoU=pn(t,n+"_batchLEMtoU",i.n8*2,i.n8*2),this.batchCtoLEM=pn(t,n+"_batchCtoLEM",i.n8,i.n8*2),this.batchUtoLEM=pn(t,n+"_batchUtoLEM",i.n8*2,i.n8*2),this.batchToJacobian=pn(t,n+"_batchToJacobian",i.n8*2,i.n8*3),this.batchToAffine=pn(t,n+"_batchToAffine",i.n8*3,i.n8*2)}op2(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op2bool(t,n,i){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op1Affine(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*2)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_add",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_addMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_addMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_addAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}sub(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_sub",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_subMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_subMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_subAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}neg(t){if(t.byteLength==this.F.n8*3)return this.op1("_neg",t);if(t.byteLength==this.F.n8*2)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==this.F.n8*3)return this.op1("_double",t);if(t.byteLength==this.F.n8*2)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==this.F.n8*3)return this.op1Bool("_isZero",t);if(t.byteLength==this.F.n8*2)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,n){n instanceof Uint8Array||(n=ni(ie(n)));let i;if(t.byteLength==this.F.n8*3)i=this.prefix+"_timesScalar";else if(t.byteLength==this.F.n8*2)i=this.prefix+"_timesScalarAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[i](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}timesFr(t,n){let i;if(t.byteLength==this.F.n8*3)i=this.prefix+"_timesFr";else if(t.byteLength==this.F.n8*2)i=this.prefix+"_timesFrAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[i](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}eq(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2bool("_eq",t,n);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2bool("_eqMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}toAffine(t){if(t.byteLength==this.F.n8*3)return this.op1Affine("_toAffine",t);if(t.byteLength==this.F.n8*2)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==this.F.n8*3)return t;if(t.byteLength==this.F.n8*2)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,n,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const a=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(a,n)}fromRprUncompressed(t,n){const i=t.slice(n,n+this.F.n8*2);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,this.F.n8*2)}toRprCompressed(t,n,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const a=this.tm.getBuff(this.pOp1,this.F.n8);t.set(a,n)}fromRprCompressed(t,n){const i=t.slice(n,n+this.F.n8);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,this.F.n8*2)}toUncompressed(t){const n=new Uint8Array(this.F.n8*2);return this.toRprUncompressed(n,0,t),n}toRprLEM(t,n,i){if(i.byteLength==this.F.n8*2){t.set(i,n);return}else if(i.byteLength==this.F.n8*3){this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const a=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(a,n)}else throw new Error("invalid point size")}fromRprLEM(t,n){return n=n||0,t.slice(n,n+this.F.n8*2)}toString(t,n){if(t.byteLength==this.F.n8*3){const i=this.F.toString(t.slice(0,this.F.n8),n),a=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),o=this.F.toString(t.slice(this.F.n8*2),n);return`[ ${i}, ${a}, ${o} ]`}else if(t.byteLength==this.F.n8*2){const i=this.F.toString(t.slice(0,this.F.n8),n),a=this.F.toString(t.slice(this.F.n8),n);return`[ ${i}, ${a} ]`}else throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const n=this.F,i=this.toAffine(t),a=i.slice(0,this.F.n8),o=i.slice(this.F.n8,this.F.n8*2),s=n.add(n.mul(n.square(a),a),this.b),d=n.square(o);return n.eq(s,d)}fromRng(t){const n=this.F;let i=[],a,o;do i[0]=n.fromRng(t),a=t.nextBool(),o=n.add(n.mul(n.square(i[0]),i[0]),this.b);while(!n.isSquare(o));i[1]=n.sqrt(o);const s=n.isNegative(i[1]);a^s&&(i[1]=n.neg(i[1]));let d=new Uint8Array(this.F.n8*2);return d.set(i[0]),d.set(i[1],this.F.n8),this.cofactor&&(d=this.timesScalar(d,this.cofactor)),d}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const n=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));let a;return t.byteLength==this.F.n8*3?a=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3)):a=this.F.toObject(this.F.one),[n,i,a]}fromObject(t){const n=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);let a;if(t.length==3?a=this.F.fromObject(t[2]):a=this.F.one,this.F.isZero(a,this.F.one))return this.zeroAffine;if(this.F.eq(a,this.F.one)){const o=new Uint8Array(this.F.n8*2);return o.set(n),o.set(i,this.F.n8),o}else{const o=new Uint8Array(this.F.n8*3);return o.set(n),o.set(i,this.F.n8),o.set(a,this.F.n8*2),o}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function Al(e){let n,i;e&&(e.onmessage=function(l){let m;if(l.data?m=l.data:m=l,m[0].cmd=="INIT")a(m[0]).then(function(){e.postMessage(m.result)});else if(m[0].cmd=="TERMINATE")e.close();else{const I=f(m);e.postMessage(I)}});async function a(l){const m=new Uint8Array(l.code),I=await WebAssembly.compile(m);i=new WebAssembly.Memory({initial:l.init,maximum:32767}),n=await WebAssembly.instantiate(I,{env:{memory:i}})}function o(l){const m=new Uint32Array(i.buffer,0,1);for(;m[0]&3;)m[0]++;const I=m[0];if(m[0]+=l,m[0]+l>i.buffer.byteLength){const g=i.buffer.byteLength/65536;let B=Math.floor((m[0]+l)/65536)+1;B>32767&&(B=32767),i.grow(B-g)}return I}function s(l){const m=o(l.byteLength);return h(m,l),m}function d(l,m){const I=new Uint8Array(i.buffer);return new Uint8Array(I.buffer,I.byteOffset+l,m)}function h(l,m){new Uint8Array(i.buffer).set(new Uint8Array(m),l)}function f(l){if(l[0].cmd=="INIT")return a(l[0]);const m={vars:[],out:[]},g=new Uint32Array(i.buffer,0,1)[0];for(let P=0;P<l.length;P++)switch(l[P].cmd){case"ALLOCSET":m.vars[l[P].var]=s(l[P].buff);break;case"ALLOC":m.vars[l[P].var]=o(l[P].len);break;case"SET":h(m.vars[l[P].var],l[P].buff);break;case"CALL":{const C=[];for(let N=0;N<l[P].params.length;N++){const T=l[P].params[N];typeof T.var<"u"?C.push(m.vars[T.var]+(T.offset||0)):typeof T.val<"u"&&C.push(T.val)}n.exports[l[P].fnName](...C);break}case"GET":m.out[l[P].out]=d(m.vars[l[P].var],l[P].len).slice();break;default:throw new Error("Invalid cmd")}const B=new Uint32Array(i.buffer,0,1);return B[0]=g,m.out}return f}var yl={},K_=Object.freeze({__proto__:null,default:yl});const Ko=25;class wl{constructor(){this.promise=new Promise((t,n)=>{this.reject=n,this.resolve=t})}}function V_(e){return new Promise(t=>setTimeout(t,e))}function j_(e){return globalThis.btoa(e)}const Y_="data:application/javascript;base64,"+j_("("+Al.toString()+")(self)");async function $_(e,t){t=!0;const n=new Z_;n.memory=new WebAssembly.Memory({initial:Ko}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);const i=await WebAssembly.compile(e.code);if(n.instance=await WebAssembly.instantiate(i,{env:{memory:n.memory}}),n.singleThread=t,n.initalPFree=n.u32[0],n.pq=e.pq,n.pr=e.pr,n.pG1gen=e.pG1gen,n.pG1zero=e.pG1zero,n.pG2gen=e.pG2gen,n.pG2zero=e.pG2zero,n.pOneT=e.pOneT,t)n.code=e.code,n.taskManager=Al(),await n.taskManager([{cmd:"INIT",init:Ko,code:n.code.slice()}]),n.concurrency=1;else{n.workers=[],n.pendingDeferreds=[],n.working=[];let o;typeof navigator=="object"&&navigator.hardwareConcurrency?o=navigator.hardwareConcurrency:o=yl.cpus().length,o==0&&(o=2),o>64&&(o=64),n.concurrency=o;for(let d=0;d<o;d++)n.workers[d]=new pt(Y_),n.workers[d].addEventListener("message",a(d)),n.working[d]=!1;const s=[];for(let d=0;d<n.workers.length;d++){const h=e.code.slice();s.push(n.postAction(d,[{cmd:"INIT",init:Ko,code:h}],[h.buffer]))}await Promise.all(s)}return n;function a(o){return function(s){let d;s&&s.data?d=s.data:d=s,n.working[o]=!1,n.pendingDeferreds[o].resolve(d),n.processWorks()}}}class Z_{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(this.oldPFree!=0)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(this.oldPFree==0)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,n,i,a){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=a||new wl,this.workers[t].postMessage(n,i),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(this.working[t]==!1){const n=this.actionQueue.shift();this.postAction(t,n.data,n.transfers,n.deferred)}}queueAction(t,n){const i=new wl;if(this.singleThread){const a=this.taskManager(t);i.resolve(a)}else this.actionQueue.push({data:t,transfers:n,deferred:i}),this.processWorks();return i.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const n=this.alloc(t.byteLength);return this.setBuff(n,t),n}getBuff(t,n){return this.u8.slice(t,t+n)}setBuff(t,n){this.u8.set(new Uint8Array(n),t)}alloc(t){for(;this.u32[0]&3;)this.u32[0]++;const n=this.u32[0];return this.u32[0]+=t,n}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await V_(200)}}function Vo(e,t){const n=e[t],i=e.Fr,a=e.tm;e[t].batchApplyKey=async function(o,s,d,h,f){h=h||"affine",f=f||"affine";let l,m,I,g,B;if(t=="G1")h=="jacobian"?(I=n.F.n8*3,l="g1m_batchApplyKey"):(I=n.F.n8*2,l="g1m_batchApplyKeyMixed"),g=n.F.n8*3,f=="jacobian"?B=n.F.n8*3:(m="g1m_batchToAffine",B=n.F.n8*2);else if(t=="G2")h=="jacobian"?(I=n.F.n8*3,l="g2m_batchApplyKey"):(I=n.F.n8*2,l="g2m_batchApplyKeyMixed"),g=n.F.n8*3,f=="jacobian"?B=n.F.n8*3:(m="g2m_batchToAffine",B=n.F.n8*2);else if(t=="Fr")l="frm_batchApplyKey",I=n.n8,g=n.n8,B=n.n8;else throw new Error("Invalid group: "+t);const P=Math.floor(o.byteLength/I),C=Math.floor(P/a.concurrency),N=[];d=i.e(d);let T=i.e(s);for(let v=0;v<a.concurrency;v++){let p;if(v<a.concurrency-1?p=C:p=P-v*C,p==0)continue;const L=[];L.push({cmd:"ALLOCSET",var:0,buff:o.slice(v*C*I,v*C*I+p*I)}),L.push({cmd:"ALLOCSET",var:1,buff:T}),L.push({cmd:"ALLOCSET",var:2,buff:d}),L.push({cmd:"ALLOC",var:3,len:p*Math.max(g,B)}),L.push({cmd:"CALL",fnName:l,params:[{var:0},{val:p},{var:1},{var:2},{var:3}]}),m&&L.push({cmd:"CALL",fnName:m,params:[{var:3},{val:p},{var:3}]}),L.push({cmd:"GET",out:0,var:3,len:p*B}),N.push(a.queueAction(L)),T=i.mul(T,i.exp(d,p))}const K=await Promise.all(N);let M;o instanceof Wt?M=new Wt(P*B):M=new Uint8Array(P*B);let V=0;for(let v=0;v<K.length;v++)M.set(K[v][0],V),V+=K[v][0].byteLength;return M}}function J_(e){const t=e.tm;e.pairing=function(i,a){t.startSyncOp();const o=t.allocBuff(e.G1.toJacobian(i)),s=t.allocBuff(e.G2.toJacobian(a)),d=t.alloc(e.Gt.n8);t.instance.exports[e.name+"_pairing"](o,s,d);const h=t.getBuff(d,e.Gt.n8);return t.endSyncOp(),h},e.pairingEq=async function(){let i,a;arguments.length%2==1?(i=arguments[arguments.length-1],a=(arguments.length-1)/2):(i=e.Gt.one,a=arguments.length/2);const o=[];for(let l=0;l<a;l++){const m=[],I=e.G1.toJacobian(arguments[l*2]);m.push({cmd:"ALLOCSET",var:0,buff:I}),m.push({cmd:"ALLOC",var:1,len:e.prePSize});const g=e.G2.toJacobian(arguments[l*2+1]);m.push({cmd:"ALLOCSET",var:2,buff:g}),m.push({cmd:"ALLOC",var:3,len:e.preQSize}),m.push({cmd:"ALLOC",var:4,len:e.Gt.n8}),m.push({cmd:"CALL",fnName:e.name+"_prepareG1",params:[{var:0},{var:1}]}),m.push({cmd:"CALL",fnName:e.name+"_prepareG2",params:[{var:2},{var:3}]}),m.push({cmd:"CALL",fnName:e.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),m.push({cmd:"GET",out:0,var:4,len:e.Gt.n8}),o.push(t.queueAction(m))}const s=await Promise.all(o);t.startSyncOp();const d=t.alloc(e.Gt.n8);t.instance.exports.ftm_one(d);for(let l=0;l<s.length;l++){const m=t.allocBuff(s[l][0]);t.instance.exports.ftm_mul(d,m,d)}t.instance.exports[e.name+"_finalExponentiation"](d,d);const h=t.allocBuff(i),f=!!t.instance.exports.ftm_eq(d,h);return t.endSyncOp(),f},e.prepareG1=function(n){this.tm.startSyncOp();const i=this.tm.allocBuff(n),a=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](i,a);const o=this.tm.getBuff(a,this.prePSize);return this.tm.endSyncOp(),o},e.prepareG2=function(n){this.tm.startSyncOp();const i=this.tm.allocBuff(n),a=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](i,a);const o=this.tm.getBuff(a,this.preQSize);return this.tm.endSyncOp(),o},e.millerLoop=function(n,i){this.tm.startSyncOp();const a=this.tm.allocBuff(n),o=this.tm.allocBuff(i),s=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](a,o,s);const d=this.tm.getBuff(s,this.Gt.n8);return this.tm.endSyncOp(),d},e.finalExponentiation=function(n){this.tm.startSyncOp();const i=this.tm.allocBuff(n),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](i,a);const o=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),o}}const Il=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function El(e,t){const n=e[t],i=n.tm;async function a(s,d,h,f,l){if(!(s instanceof Uint8Array))throw f&&f.error(`${l} _multiExpChunk buffBases is not Uint8Array`),new Error(`${l} _multiExpChunk buffBases is not Uint8Array`);if(!(d instanceof Uint8Array))throw f&&f.error(`${l} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${l} _multiExpChunk buffScalars is not Uint8Array`);h=h||"affine";let m,I;if(t=="G1")h=="affine"?(I="g1m_multiexpAffine_chunk",m=n.F.n8*2):(I="g1m_multiexp_chunk",m=n.F.n8*3);else if(t=="G2")h=="affine"?(I="g2m_multiexpAffine_chunk",m=n.F.n8*2):(I="g2m_multiexp_chunk",m=n.F.n8*3);else throw new Error("Invalid group");const g=Math.floor(s.byteLength/m);if(g==0)return n.zero;const B=Math.floor(d.byteLength/g);if(B*g!=d.byteLength)throw new Error("Scalar size does not match");const P=Il[Se(g)],C=Math.floor((B*8-1)/P)+1,N=[];for(let M=0;M<C;M++){const V=[{cmd:"ALLOCSET",var:0,buff:s},{cmd:"ALLOCSET",var:1,buff:d},{cmd:"ALLOC",var:2,len:n.F.n8*3},{cmd:"CALL",fnName:I,params:[{var:0},{var:1},{val:B},{val:g},{val:M*P},{val:Math.min(B*8-M*P,P)},{var:2}]},{cmd:"GET",out:0,var:2,len:n.F.n8*3}];N.push(n.tm.queueAction(V))}const T=await Promise.all(N);let K=n.zero;for(let M=T.length-1;M>=0;M--){if(!n.isZero(K))for(let V=0;V<P;V++)K=n.double(K);K=n.add(K,T[M][0])}return K}async function o(s,d,h,f,l){let g;if(t=="G1")h=="affine"?g=n.F.n8*2:g=n.F.n8*3;else if(t=="G2")h=="affine"?g=n.F.n8*2:g=n.F.n8*3;else throw new Error("Invalid group");const B=Math.floor(s.byteLength/g),P=Math.floor(d.byteLength/B);if(P*B!=d.byteLength)throw new Error("Scalar size does not match");const C=Il[Se(B)],N=Math.floor((P*8-1)/C)+1;let T;T=Math.floor(B/(i.concurrency/N)),T>4194304&&(T=4194304),T<1024&&(T=1024);const K=[];for(let v=0;v<B;v+=T){f&&f.debug(`Multiexp start: ${l}: ${v}/${B}`);const p=Math.min(B-v,T),L=s.slice(v*g,(v+p)*g),U=d.slice(v*P,(v+p)*P);K.push(a(L,U,h,f,l).then(q=>(f&&f.debug(`Multiexp end: ${l}: ${v}/${B}`),q)))}const M=await Promise.all(K);let V=n.zero;for(let v=M.length-1;v>=0;v--)V=n.add(V,M[v]);return V}n.multiExp=async function(d,h,f,l){return await o(d,h,"jacobian",f,l)},n.multiExpAffine=async function(d,h,f,l){return await o(d,h,"affine",f,l)}}function jo(e,t){const n=e[t],i=e.Fr,a=n.tm;async function o(f,l,m,I,g,B){m=m||"affine",I=I||"affine";const P=14;let C,N,T,K,M,V,v,p;t=="G1"?(m=="affine"?(C=n.F.n8*2,K="g1m_batchToJacobian"):C=n.F.n8*3,N=n.F.n8*3,l&&(p="g1m_fftFinal"),v="g1m_fftJoin",V="g1m_fftMix",I=="affine"?(T=n.F.n8*2,M="g1m_batchToAffine"):T=n.F.n8*3):t=="G2"?(m=="affine"?(C=n.F.n8*2,K="g2m_batchToJacobian"):C=n.F.n8*3,N=n.F.n8*3,l&&(p="g2m_fftFinal"),v="g2m_fftJoin",V="g2m_fftMix",I=="affine"?(T=n.F.n8*2,M="g2m_batchToAffine"):T=n.F.n8*3):t=="Fr"&&(C=n.n8,N=n.n8,T=n.n8,l&&(p="frm_fftFinal"),V="frm_fftMix",v="frm_fftJoin");let L=!1;Array.isArray(f)?(f=Wo(f,C),L=!0):f=f.slice(0,f.byteLength);const U=f.byteLength/C,q=Se(U);if(1<<q!=U)throw new Error("fft must be multiple of 2");if(q==i.s+1){let $;return l?$=await d(f,m,I,g,B):$=await s(f,m,I,g,B),L?La($,T):$}let O;l&&(O=i.inv(i.e(U)));let R;gl(f,C);let b,D=Math.min(1<<P,U),j=U/D;for(;j<a.concurrency&&D>=16;)j*=2,D/=2;const J=Se(D),tt=[];for(let $=0;$<j;$++){g&&g.debug(`${B}: fft ${q} mix start: ${$}/${j}`);const et=[];et.push({cmd:"ALLOC",var:0,len:N*D});const X=f.slice(D*$*C,D*($+1)*C);et.push({cmd:"SET",var:0,buff:X}),K&&et.push({cmd:"CALL",fnName:K,params:[{var:0},{val:D},{var:0}]});for(let dt=1;dt<=J;dt++)et.push({cmd:"CALL",fnName:V,params:[{var:0},{val:D},{val:dt}]});J==q?(p&&(et.push({cmd:"ALLOCSET",var:1,buff:O}),et.push({cmd:"CALL",fnName:p,params:[{var:0},{val:D},{var:1}]})),M&&et.push({cmd:"CALL",fnName:M,params:[{var:0},{val:D},{var:0}]}),et.push({cmd:"GET",out:0,var:0,len:D*T})):et.push({cmd:"GET",out:0,var:0,len:N*D}),tt.push(a.queueAction(et).then(dt=>(g&&g.debug(`${B}: fft ${q} mix end: ${$}/${j}`),dt)))}b=await Promise.all(tt);for(let $=0;$<j;$++)b[$]=b[$][0];for(let $=J+1;$<=q;$++){g&&g.debug(`${B}: fft  ${q}  join: ${$}/${q}`);const et=1<<q-$,X=j/et,dt=[];for(let mt=0;mt<et;mt++)for(let gt=0;gt<X/2;gt++){const A=i.exp(i.w[$],gt*D),u=i.w[$],F=mt*X+gt,_=mt*X+gt+X/2,Q=[];Q.push({cmd:"ALLOCSET",var:0,buff:b[F]}),Q.push({cmd:"ALLOCSET",var:1,buff:b[_]}),Q.push({cmd:"ALLOCSET",var:2,buff:A}),Q.push({cmd:"ALLOCSET",var:3,buff:u}),Q.push({cmd:"CALL",fnName:v,params:[{var:0},{var:1},{val:D},{var:2},{var:3}]}),$==q?(p&&(Q.push({cmd:"ALLOCSET",var:4,buff:O}),Q.push({cmd:"CALL",fnName:p,params:[{var:0},{val:D},{var:4}]}),Q.push({cmd:"CALL",fnName:p,params:[{var:1},{val:D},{var:4}]})),M&&(Q.push({cmd:"CALL",fnName:M,params:[{var:0},{val:D},{var:0}]}),Q.push({cmd:"CALL",fnName:M,params:[{var:1},{val:D},{var:1}]})),Q.push({cmd:"GET",out:0,var:0,len:D*T}),Q.push({cmd:"GET",out:1,var:1,len:D*T})):(Q.push({cmd:"GET",out:0,var:0,len:D*N}),Q.push({cmd:"GET",out:1,var:1,len:D*N})),dt.push(a.queueAction(Q).then(G=>(g&&g.debug(`${B}: fft ${q} join  ${$}/${q}  ${mt+1}/${et} ${gt}/${X/2}`),G)))}const rt=await Promise.all(dt);for(let mt=0;mt<et;mt++)for(let gt=0;gt<X/2;gt++){const A=mt*X+gt,u=mt*X+gt+X/2,F=rt.shift();b[A]=F[0],b[u]=F[1]}}if(f instanceof Wt?R=new Wt(U*T):R=new Uint8Array(U*T),l){R.set(b[0].slice((D-1)*T));let $=T;for(let et=j-1;et>0;et--)R.set(b[et],$),$+=D*T,delete b[et];R.set(b[0].slice(0,(D-1)*T),$),delete b[0]}else for(let $=0;$<j;$++)R.set(b[$],D*T*$),delete b[$];return L?La(R,T):R}async function s(f,l,m,I,g){let B,P;B=f.slice(0,f.byteLength/2),P=f.slice(f.byteLength/2,f.byteLength);const C=[];[B,P]=await h(B,P,"fftJoinExt",i.one,i.shift,l,"jacobian",I,g),C.push(o(B,!1,"jacobian",m,I,g)),C.push(o(P,!1,"jacobian",m,I,g));const N=await Promise.all(C);let T;return N[0].byteLength>1<<28?T=new Wt(N[0].byteLength*2):T=new Uint8Array(N[0].byteLength*2),T.set(N[0]),T.set(N[1],N[0].byteLength),T}async function d(f,l,m,I,g){let B,P;B=f.slice(0,f.byteLength/2),P=f.slice(f.byteLength/2,f.byteLength);const C=[];C.push(o(B,!0,l,"jacobian",I,g)),C.push(o(P,!0,l,"jacobian",I,g)),[B,P]=await Promise.all(C);const N=await h(B,P,"fftJoinExtInv",i.one,i.shiftInv,"jacobian",m,I,g);let T;return N[0].byteLength>1<<28?T=new Wt(N[0].byteLength*2):T=new Uint8Array(N[0].byteLength*2),T.set(N[0]),T.set(N[1],N[0].byteLength),T}async function h(f,l,m,I,g,B,P,C,N){let M,V,v,p,L,U;if(t=="G1")B=="affine"?(L=n.F.n8*2,V="g1m_batchToJacobian"):L=n.F.n8*3,U=n.F.n8*3,M="g1m_"+m,P=="affine"?(v="g1m_batchToAffine",p=n.F.n8*2):p=n.F.n8*3;else if(t=="G2")B=="affine"?(L=n.F.n8*2,V="g2m_batchToJacobian"):L=n.F.n8*3,M="g2m_"+m,U=n.F.n8*3,P=="affine"?(v="g2m_batchToAffine",p=n.F.n8*2):p=n.F.n8*3;else if(t=="Fr")L=i.n8,p=i.n8,U=i.n8,M="frm_"+m;else throw new Error("Invalid group");if(f.byteLength!=l.byteLength)throw new Error("Invalid buffer size");const q=Math.floor(f.byteLength/L);if(q!=1<<Se(q))throw new Error("Invalid number of points");let O=Math.floor(q/a.concurrency);O<16&&(O=16),O>65536&&(O=65536);const R=[];for(let tt=0;tt<q;tt+=O){C&&C.debug(`${N}: fftJoinExt Start: ${tt}/${q}`);const $=Math.min(q-tt,O),et=i.mul(I,i.exp(g,tt)),X=[],dt=f.slice(tt*L,(tt+$)*L),rt=l.slice(tt*L,(tt+$)*L);X.push({cmd:"ALLOC",var:0,len:U*$}),X.push({cmd:"SET",var:0,buff:dt}),X.push({cmd:"ALLOC",var:1,len:U*$}),X.push({cmd:"SET",var:1,buff:rt}),X.push({cmd:"ALLOCSET",var:2,buff:et}),X.push({cmd:"ALLOCSET",var:3,buff:g}),V&&(X.push({cmd:"CALL",fnName:V,params:[{var:0},{val:$},{var:0}]}),X.push({cmd:"CALL",fnName:V,params:[{var:1},{val:$},{var:1}]})),X.push({cmd:"CALL",fnName:M,params:[{var:0},{var:1},{val:$},{var:2},{var:3},{val:i.s}]}),v&&(X.push({cmd:"CALL",fnName:v,params:[{var:0},{val:$},{var:0}]}),X.push({cmd:"CALL",fnName:v,params:[{var:1},{val:$},{var:1}]})),X.push({cmd:"GET",out:0,var:0,len:$*p}),X.push({cmd:"GET",out:1,var:1,len:$*p}),R.push(a.queueAction(X).then(mt=>(C&&C.debug(`${N}: fftJoinExt End: ${tt}/${q}`),mt)))}const b=await Promise.all(R);let D,j;q*p>1<<28?(D=new Wt(q*p),j=new Wt(q*p)):(D=new Uint8Array(q*p),j=new Uint8Array(q*p));let J=0;for(let tt=0;tt<b.length;tt++)D.set(b[tt][0],J),j.set(b[tt][1],J),J+=b[tt][0].byteLength;return[D,j]}n.fft=async function(f,l,m,I,g){return await o(f,!1,l,m,I,g)},n.ifft=async function(f,l,m,I,g){return await o(f,!0,l,m,I,g)},n.lagrangeEvaluations=async function(f,l,m,I,g){l=l||"affine",m=m||"affine";let B;if(t=="G1")l=="affine"?B=n.F.n8*2:B=n.F.n8*3;else if(t=="G2")l=="affine"?B=n.F.n8*2:B=n.F.n8*3;else if(t=="Fr")B=i.n8;else throw new Error("Invalid group");const P=f.byteLength/B,C=Se(P);if(2**C*B!=f.byteLength)throw I&&I.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(C<=i.s)return await n.ifft(f,l,m,I,g);if(C>i.s+1)throw I&&I.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let N=f.slice(0,f.byteLength/2),T=f.slice(f.byteLength/2,f.byteLength);const K=i.exp(i.shift,P/2),M=i.inv(i.sub(i.one,K));[N,T]=await h(N,T,"prepareLagrangeEvaluation",M,i.shiftInv,l,"jacobian",I,g+" prep");const V=[];V.push(o(N,!0,"jacobian",m,I,g+" t0")),V.push(o(T,!0,"jacobian",m,I,g+" t1")),[N,T]=await Promise.all(V);let v;return N.byteLength>1<<28?v=new Wt(N.byteLength*2):v=new Uint8Array(N.byteLength*2),v.set(N),v.set(T,N.byteLength),v},n.fftMix=async function(l){const m=n.F.n8*3;let I,g;if(t=="G1")I="g1m_fftMix",g="g1m_fftJoin";else if(t=="G2")I="g2m_fftMix",g="g2m_fftJoin";else if(t=="Fr")I="frm_fftMix",g="frm_fftJoin";else throw new Error("Invalid group");const B=Math.floor(l.byteLength/m),P=Se(B);let C=1<<Se(a.concurrency);B<=C*2&&(C=1);const N=B/C,T=Se(N),K=[];for(let L=0;L<C;L++){const U=[],q=l.slice(L*N*m,(L+1)*N*m);U.push({cmd:"ALLOCSET",var:0,buff:q});for(let O=1;O<=T;O++)U.push({cmd:"CALL",fnName:I,params:[{var:0},{val:N},{val:O}]});U.push({cmd:"GET",out:0,var:0,len:N*m}),K.push(a.queueAction(U))}const M=await Promise.all(K),V=[];for(let L=0;L<M.length;L++)V[L]=M[L][0];for(let L=T+1;L<=P;L++){const U=1<<P-L,q=C/U,O=[];for(let b=0;b<U;b++)for(let D=0;D<q/2;D++){const j=i.exp(i.w[L],D*N),J=i.w[L],tt=b*q+D,$=b*q+D+q/2,et=[];et.push({cmd:"ALLOCSET",var:0,buff:V[tt]}),et.push({cmd:"ALLOCSET",var:1,buff:V[$]}),et.push({cmd:"ALLOCSET",var:2,buff:j}),et.push({cmd:"ALLOCSET",var:3,buff:J}),et.push({cmd:"CALL",fnName:g,params:[{var:0},{var:1},{val:N},{var:2},{var:3}]}),et.push({cmd:"GET",out:0,var:0,len:N*m}),et.push({cmd:"GET",out:1,var:1,len:N*m}),O.push(a.queueAction(et))}const R=await Promise.all(O);for(let b=0;b<U;b++)for(let D=0;D<q/2;D++){const j=b*q+D,J=b*q+D+q/2,tt=R.shift();V[j]=tt[0],V[J]=tt[1]}}let v;l instanceof Wt?v=new Wt(B*m):v=new Uint8Array(B*m);let p=0;for(let L=0;L<C;L++)v.set(V[L],p),p+=V[L].byteLength;return v},n.fftJoin=async function(l,m,I,g){const B=n.F.n8*3;let P;if(t=="G1")P="g1m_fftJoin";else if(t=="G2")P="g2m_fftJoin";else if(t=="Fr")P="frm_fftJoin";else throw new Error("Invalid group");if(l.byteLength!=m.byteLength)throw new Error("Invalid buffer size");const C=Math.floor(l.byteLength/B);if(C!=1<<Se(C))throw new Error("Invalid number of points");let N=1<<Se(a.concurrency);C<=N*2&&(N=1);const T=C/N,K=[];for(let L=0;L<N;L++){const U=[],q=i.mul(I,i.exp(g,L*T)),O=l.slice(L*T*B,(L+1)*T*B),R=m.slice(L*T*B,(L+1)*T*B);U.push({cmd:"ALLOCSET",var:0,buff:O}),U.push({cmd:"ALLOCSET",var:1,buff:R}),U.push({cmd:"ALLOCSET",var:2,buff:q}),U.push({cmd:"ALLOCSET",var:3,buff:g}),U.push({cmd:"CALL",fnName:P,params:[{var:0},{var:1},{val:T},{var:2},{var:3}]}),U.push({cmd:"GET",out:0,var:0,len:T*B}),U.push({cmd:"GET",out:1,var:1,len:T*B}),K.push(a.queueAction(U))}const M=await Promise.all(K);let V,v;l instanceof Wt?(V=new Wt(C*B),v=new Wt(C*B)):(V=new Uint8Array(C*B),v=new Uint8Array(C*B));let p=0;for(let L=0;L<M.length;L++)V.set(M[L][0],p),v.set(M[L][1],p),p+=M[L][0].byteLength;return[V,v]},n.fftFinal=async function(l,m){const I=n.F.n8*3,g=n.F.n8*2;let B,P;if(t=="G1")B="g1m_fftFinal",P="g1m_batchToAffine";else if(t=="G2")B="g2m_fftFinal",P="g2m_batchToAffine";else throw new Error("Invalid group");const C=Math.floor(l.byteLength/I);if(C!=1<<Se(C))throw new Error("Invalid number of points");const N=Math.floor(C/a.concurrency),T=[];for(let v=0;v<a.concurrency;v++){let p;if(v<a.concurrency-1?p=N:p=C-v*N,p==0)continue;const L=[],U=l.slice(v*N*I,(v*N+p)*I);L.push({cmd:"ALLOCSET",var:0,buff:U}),L.push({cmd:"ALLOCSET",var:1,buff:m}),L.push({cmd:"CALL",fnName:B,params:[{var:0},{val:p},{var:1}]}),L.push({cmd:"CALL",fnName:P,params:[{var:0},{val:p},{var:0}]}),L.push({cmd:"GET",out:0,var:0,len:p*g}),T.push(a.queueAction(L))}const K=await Promise.all(T);let M;l instanceof Wt?M=new Wt(C*g):M=new Uint8Array(C*g);let V=0;for(let v=K.length-1;v>=0;v--)M.set(K[v][0],V),V+=K[v][0].byteLength;return M}}async function bl(e){const t=await $_(e.wasm,e.singleThread),n={};return n.q=ie(e.wasm.q.toString()),n.r=ie(e.wasm.r.toString()),n.name=e.name,n.tm=t,n.prePSize=e.wasm.prePSize,n.preQSize=e.wasm.preQSize,n.Fr=new pl(t,"frm",e.n8r,e.r),n.F1=new pl(t,"f1m",e.n8q,e.q),n.F2=new ml(t,"f2m",n.F1),n.G1=new Ll(t,"g1m",n.F1,e.wasm.pG1gen,e.wasm.pG1b,e.cofactorG1),n.G2=new Ll(t,"g2m",n.F2,e.wasm.pG2gen,e.wasm.pG2b,e.cofactorG2),n.F6=new W_(t,"f6m",n.F2),n.F12=new ml(t,"ftm",n.F6),n.Gt=n.F12,Vo(n,"G1"),Vo(n,"G2"),Vo(n,"Fr"),El(n,"G1"),El(n,"G2"),jo(n,"G1"),jo(n,"G2"),jo(n,"Fr"),J_(n),n.array2buffer=function(i,a){const o=new Uint8Array(a*i.length);for(let s=0;s<i.length;s++)o.set(i[s],s*a);return o},n.buffer2array=function(i,a){const o=i.byteLength/a,s=new Array(o);for(let d=0;d<o;d++)s[d]=i.slice(d*a,d*a+a);return s},n}function ai(e){return BigInt(e)}function Cl(e){return e<0n}function X_(e){return e===0n}function th(e){return Cl(e)?e.toString(2).length-1:e.toString(2).length}function Yo(e){const t=[],n=ai(e);return t.push(Number(n&0xFFn)),t.push(Number(n>>8n&0xFFn)),t.push(Number(n>>16n&0xFFn)),t.push(Number(n>>24n&0xFFn)),t}function eh(e){for(var t=[],n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|i&63):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|i&63):(n++,i=65536+((i&1023)<<10|e.charCodeAt(n)&1023),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63))}return t}function Ni(e){const t=eh(e);return[...Ut(t.length),...t]}function Sl(e){const t=[];let n=ai(e);if(Cl(n))throw new Error("Number cannot be negative");for(;!X_(n);)t.push(Number(n&0x7Fn)),n=n>>7n;t.length==0&&t.push(0);for(let i=0;i<t.length-1;i++)t[i]=t[i]|128;return t}function Fl(e){let t,n;const i=th(e);e<0?(n=!0,t=(1n<<BigInt(i))+e):(n=!1,t=ai(e));const a=7-i%7,o=(1n<<BigInt(a))-1n<<BigInt(i),s=(1<<7-a)-1|128,d=Sl(t+o);return n||(d[d.length-1]=d[d.length-1]&s),d}function $o(e){let t=ai(e);if(t>0xFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFn&&(t=t-0x100000000n),t<-2147483648n)throw new Error("Number too small");return Fl(t)}function nh(e){let t=ai(e);if(t>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFFFFFFFFFn&&(t=t-0x10000000000000000n),t<-9223372036854775808n)throw new Error("Number too small");return Fl(t)}function Ut(e){let t=ai(e);if(t>0xFFFFFFFFn)throw new Error("Number too big");return Sl(t)}function vl(e){return Array.from(e,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}class ih{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,n){const i=this.func.localIdxByName[t];if(i===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,33,...Ut(i)]}teeLocal(t,n){const i=this.func.localIdxByName[t];if(i===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,34,...Ut(i)]}getLocal(t){const n=this.func.localIdxByName[t];if(n===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...Ut(n)]}i64_load8_s(t,n,i){const a=n||0,o=i===void 0?0:i;return[...t,48,o,...Ut(a)]}i64_load8_u(t,n,i){const a=n||0,o=i===void 0?0:i;return[...t,49,o,...Ut(a)]}i64_load16_s(t,n,i){const a=n||0,o=i===void 0?1:i;return[...t,50,o,...Ut(a)]}i64_load16_u(t,n,i){const a=n||0,o=i===void 0?1:i;return[...t,51,o,...Ut(a)]}i64_load32_s(t,n,i){const a=n||0,o=i===void 0?2:i;return[...t,52,o,...Ut(a)]}i64_load32_u(t,n,i){const a=n||0,o=i===void 0?2:i;return[...t,53,o,...Ut(a)]}i64_load(t,n,i){const a=n||0,o=i===void 0?3:i;return[...t,41,o,...Ut(a)]}i64_store(t,n,i,a){let o,s,d;return Array.isArray(n)?(o=0,s=3,d=n):Array.isArray(i)?(o=n,s=3,d=i):Array.isArray(a)&&(o=n,s=i,d=a),[...t,...d,55,s,...Ut(o)]}i64_store32(t,n,i,a){let o,s,d;return Array.isArray(n)?(o=0,s=2,d=n):Array.isArray(i)?(o=n,s=2,d=i):Array.isArray(a)&&(o=n,s=i,d=a),[...t,...d,62,s,...Ut(o)]}i64_store16(t,n,i,a){let o,s,d;return Array.isArray(n)?(o=0,s=1,d=n):Array.isArray(i)?(o=n,s=1,d=i):Array.isArray(a)&&(o=n,s=i,d=a),[...t,...d,61,s,...Ut(o)]}i64_store8(t,n,i,a){let o,s,d;return Array.isArray(n)?(o=0,s=0,d=n):Array.isArray(i)?(o=n,s=0,d=i):Array.isArray(a)&&(o=n,s=i,d=a),[...t,...d,60,s,...Ut(o)]}i32_load8_s(t,n,i){const a=n||0,o=i===void 0?0:i;return[...t,44,o,...Ut(a)]}i32_load8_u(t,n,i){const a=n||0,o=i===void 0?0:i;return[...t,45,o,...Ut(a)]}i32_load16_s(t,n,i){const a=n||0,o=i===void 0?1:i;return[...t,46,o,...Ut(a)]}i32_load16_u(t,n,i){const a=n||0,o=i===void 0?1:i;return[...t,47,o,...Ut(a)]}i32_load(t,n,i){const a=n||0,o=i===void 0?2:i;return[...t,40,o,...Ut(a)]}i32_store(t,n,i,a){let o,s,d;return Array.isArray(n)?(o=0,s=2,d=n):Array.isArray(i)?(o=n,s=2,d=i):Array.isArray(a)&&(o=n,s=i,d=a),[...t,...d,54,s,...Ut(o)]}i32_store16(t,n,i,a){let o,s,d;return Array.isArray(n)?(o=0,s=1,d=n):Array.isArray(i)?(o=n,s=1,d=i):Array.isArray(a)&&(o=n,s=i,d=a),[...t,...d,59,s,...Ut(o)]}i32_store8(t,n,i,a){let o,s,d;return Array.isArray(n)?(o=0,s=0,d=n):Array.isArray(i)?(o=n,s=0,d=i):Array.isArray(a)&&(o=n,s=i,d=a),[...t,...d,58,s,...Ut(o)]}call(t,...n){const i=this.module.functionIdxByName[t];if(i===void 0)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...n),16,...Ut(i)]}call_indirect(t,...n){return[...[].concat(...n),...t,17,0,0]}if(t,n,i){return i?[...t,4,64,...n,5,...i,11]:[...t,4,64,...n,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,n){return[...n,13,...Ut(t)]}br(t){return[12,...Ut(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...nh(t)]}i32_const(t){return[65,...$o(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,n){return[...t,...n,81]}i64_ne(t,n){return[...t,...n,82]}i64_lt_s(t,n){return[...t,...n,83]}i64_lt_u(t,n){return[...t,...n,84]}i64_gt_s(t,n){return[...t,...n,85]}i64_gt_u(t,n){return[...t,...n,86]}i64_le_s(t,n){return[...t,...n,87]}i64_le_u(t,n){return[...t,...n,88]}i64_ge_s(t,n){return[...t,...n,89]}i64_ge_u(t,n){return[...t,...n,90]}i64_add(t,n){return[...t,...n,124]}i64_sub(t,n){return[...t,...n,125]}i64_mul(t,n){return[...t,...n,126]}i64_div_s(t,n){return[...t,...n,127]}i64_div_u(t,n){return[...t,...n,128]}i64_rem_s(t,n){return[...t,...n,129]}i64_rem_u(t,n){return[...t,...n,130]}i64_and(t,n){return[...t,...n,131]}i64_or(t,n){return[...t,...n,132]}i64_xor(t,n){return[...t,...n,133]}i64_shl(t,n){return[...t,...n,134]}i64_shr_s(t,n){return[...t,...n,135]}i64_shr_u(t,n){return[...t,...n,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,n){return[...t,...n,70]}i32_ne(t,n){return[...t,...n,71]}i32_lt_s(t,n){return[...t,...n,72]}i32_lt_u(t,n){return[...t,...n,73]}i32_gt_s(t,n){return[...t,...n,74]}i32_gt_u(t,n){return[...t,...n,75]}i32_le_s(t,n){return[...t,...n,76]}i32_le_u(t,n){return[...t,...n,77]}i32_ge_s(t,n){return[...t,...n,78]}i32_ge_u(t,n){return[...t,...n,79]}i32_add(t,n){return[...t,...n,106]}i32_sub(t,n){return[...t,...n,107]}i32_mul(t,n){return[...t,...n,108]}i32_div_s(t,n){return[...t,...n,109]}i32_div_u(t,n){return[...t,...n,110]}i32_rem_s(t,n){return[...t,...n,111]}i32_rem_u(t,n){return[...t,...n,112]}i32_and(t,n){return[...t,...n,113]}i32_or(t,n){return[...t,...n,114]}i32_xor(t,n){return[...t,...n,115]}i32_shl(t,n){return[...t,...n,116]}i32_shr_s(t,n){return[...t,...n,117]}i32_shr_u(t,n){return[...t,...n,118]}i32_rotl(t,n){return[...t,...n,119]}i32_rotr(t,n){return[...t,...n,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}const Zo={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class Bl{constructor(t,n,i,a,o){if(i=="import")this.fnType="import",this.moduleName=a,this.fieldName=o;else if(i=="internal")this.fnType="internal";else throw new Error("Invalid function fnType: "+i);this.module=t,this.fnName=n,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,n){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);const i=this.nextLocal++;this.localIdxByName[t]=i,this.params.push({type:n})}addLocal(t,n,i){const a=i||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);const o=this.nextLocal++;this.localIdxByName[t]=o,this.locals.push({type:n,length:a})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){const t=[...Ut(this.params.length),...this.params.map(i=>Zo[i.type])],n=this.returnType?[1,Zo[this.returnType]]:[0];return[96,...t,...n]}getBody(){const t=this.locals.map(i=>[...Ut(i.length),Zo[i.type]]),n=[...Ut(this.locals.length),...[].concat(...t),...this.code,11];return[...Ut(n.length),...n]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new ih(this)}}class xl{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Yo(1836278016),...Yo(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);const n=this.functions.length;return this.functionIdxByName[t]=n,this.functions.push(new Bl(this,t,"internal")),this.nInternalFunctions++,this.functions[n]}addIimportFunction(t,n,i){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&this.functions[this.functions.length-1].type=="internal")throw new Error(`Import functions must be declared before internal: ${t}`);let a=i||t;const o=this.functions.length;return this.functionIdxByName[t]=o,this.functions.push(new Bl(this,t,"import",n,a)),this.nImportFunctions++,this.functions[o]}setMemory(t,n,i){this.memory={pagesSize:t,moduleName:n||"env",fieldName:i||"memory"}}exportFunction(t,n){const i=n||t;if(typeof this.functionIdxByName[t]>"u")throw new Error(`Function not defined: ${t}`);const a=this.functionIdxByName[t];i!=t&&(this.functionIdxByName[i]=a),this.exports.push({exportName:i,idx:a})}addFunctionToTable(t){const n=this.functionIdxByName[t];this.functionsTable.push(n)}addData(t,n){this.datas.push({offset:t,bytes:n})}alloc(t,n){let i,a;(Array.isArray(t)||ArrayBuffer.isView(t))&&typeof n>"u"?(i=t.length,a=t):(i=t,a=n),i=(i-1>>3)+1<<3;const o=this.free;return this.free+=i,a&&this.addData(o,a),o}allocString(t){const i=new globalThis.TextEncoder().encode(t);return this.alloc([...i,0])}_setSignatures(){this.signatures=[];const t={};if(this.functionsTable.length>0){const n=this.functions[this.functionsTable[0]].getSignature(),i="s_"+vl(n);t[i]=0,this.signatures.push(n)}for(let n=0;n<this.functions.length;n++){const i=this.functions[n].getSignature(),a="s_"+vl(i);typeof t[a]>"u"&&(t[a]=this.signatures.length,this.signatures.push(i)),this.functions[n].signatureIdx=t[a]}}_buildSection(t,n){return[t,...Ut(n.length),...n]}_buildType(){return this._buildSection(1,[...Ut(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const t=[];t.push([...Ni(this.memory.moduleName),...Ni(this.memory.fieldName),2,0,...Ut(this.memory.pagesSize)]);for(let n=0;n<this.nImportFunctions;n++)t.push([...Ni(this.functions[n].moduleName),...Ni(this.functions[n].fieldName),0,...Ut(this.functions[n].signatureIdx)]);return this._buildSection(2,Ut(t.length).concat(...t))}_buildFunctionDeclarations(){const t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(...Ut(this.functions[n].signatureIdx));return this._buildSection(3,[...Ut(t.length),...t])}_buildFunctionsTable(){return this.functionsTable.length==0?[]:this._buildSection(4,[...Ut(1),112,0,...Ut(this.functionsTable.length)])}_buildElements(){if(this.functionsTable.length==0)return[];const t=[];for(let n=0;n<this.functionsTable.length;n++)t.push(...Ut(this.functionsTable[n]));return this._buildSection(9,[...Ut(1),...Ut(0),65,...$o(0),11,...Ut(this.functionsTable.length),...t])}_buildExports(){const t=[];for(let n=0;n<this.exports.length;n++)t.push([...Ni(this.exports[n].exportName),0,...Ut(this.exports[n].idx)]);return this._buildSection(7,Ut(t.length).concat(...t))}_buildCode(){const t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(this.functions[n].getBody());return this._buildSection(10,Ut(t.length).concat(...t))}_buildData(){const t=[];t.push([0,65,0,11,4,...Yo(this.free)]);for(let n=0;n<this.datas.length;n++)t.push([0,65,...$o(this.datas[n].offset),11,...Ut(this.datas[n].bytes.length),...this.datas[n].bytes]);return this._buildSection(11,Ut(t.length).concat(...t))}}globalThis.curve_bn128=null;async function Tl(e,t){const n=new xl;n.setMemory(25),D_(n),t&&t(n);const i={};if(i.code=n.build(),i.pq=n.modules.f1m.pq,i.pr=n.modules.frm.pq,i.pG1gen=n.modules.bn128.pG1gen,i.pG1zero=n.modules.bn128.pG1zero,i.pG1b=n.modules.bn128.pG1b,i.pG2gen=n.modules.bn128.pG2gen,i.pG2zero=n.modules.bn128.pG2zero,i.pG2b=n.modules.bn128.pG2b,i.pOneT=n.modules.bn128.pOneT,i.prePSize=n.modules.bn128.prePSize,i.preQSize=n.modules.bn128.preQSize,i.n8q=32,i.n8r=32,i.q=n.modules.bn128.q,i.r=n.modules.bn128.r,!e&&globalThis.curve_bn128)return globalThis.curve_bn128;const a={name:"bn128",wasm:i,q:ie("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:ie("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:ie("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!e},o=await bl(a);return o.terminate=async function(){a.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},e||(globalThis.curve_bn128=o),o}globalThis.curve_bls12381=null;async function Pl(e,t){const n=new xl;n.setMemory(25),N_(n),t&&t(n);const i={};if(i.code=n.build(),i.pq=n.modules.f1m.pq,i.pr=n.modules.frm.pq,i.pG1gen=n.modules.bls12381.pG1gen,i.pG1zero=n.modules.bls12381.pG1zero,i.pG1b=n.modules.bls12381.pG1b,i.pG2gen=n.modules.bls12381.pG2gen,i.pG2zero=n.modules.bls12381.pG2zero,i.pG2b=n.modules.bls12381.pG2b,i.pOneT=n.modules.bls12381.pOneT,i.prePSize=n.modules.bls12381.prePSize,i.preQSize=n.modules.bls12381.preQSize,i.n8q=48,i.n8r=32,i.q=n.modules.bls12381.q,i.r=n.modules.bls12381.r,!e&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const a={name:"bls12381",wasm:i,q:ie("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:ie("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:ie("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:ie("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!e},o=await bl(a);return o.terminate=async function(){a.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},e||(globalThis.curve_bls12381=o),o}const ah=ie("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),oh=ie("21888242871839275222246405745257275088548364400416034343698204186575808495617");ie("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),ie("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function Ol(e,t,n){let i;if(an(e,oh))i=await Tl(t,n);else if(an(e,ah))i=await Pl(t,n);else throw new Error(`Curve not supported: ${vo(e)}`);return i}const Zt=M2,rh=H_;function Jo(){}var sh=Object.freeze({__proto__:null,default:Jo});async function Rl(e,t,n,i){if(n=n||4096*64,typeof t!="number"&&["w+","wx+","r","ax+","a+"].indexOf(t)<0)throw new Error("Invalid open option");const a=await Jo.promises.open(e,t),o=await a.stat();return new ch(a,o,n,i,e)}class ch{constructor(t,n,i,a,o){for(this.fileName=o,this.fd=t,this.pos=0,this.pageSize=a||1<<8;this.pageSize<n.blksize;)this.pageSize*=2;this.totalSize=n.size,this.totalPages=Math.floor((n.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(i/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){const n=this,i=new Promise((a,o)=>{n.pendingLoads.push({page:t,resolve:a,reject:o})});return n.__statusPage("After Load request: ",t),i}__statusPage(t,n){const i=[],a=this;if(!a.logHistory)return;i.push("=="+t+" "+n);let o="";for(let s=0;s<a.pendingLoads.length;s++)a.pendingLoads[s].page==n&&(o=o+" "+s);if(o&&i.push("Pending loads:"+o),typeof a.pages[n]<"u"){const s=a.pages[n];i.push("Loaded"),i.push("pendingOps: "+s.pendingOps),s.loading&&i.push("loading: "+s.loading),s.writing&&i.push("writing"),s.dirty&&i.push("dirty")}i.push("=="),a.history[n]||(a.history[n]=[]),a.history[n].push(i)}__printHistory(t){const n=this;n.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let i=0;i<n.history[t].length;i++)for(let a=0;a<n.history[t][i].length;a++)console.log("-> "+n.history[t][i][a])}_triggerLoad(){const t=this;if(t.reading||t.pendingLoads.length==0)return;const n=Object.keys(t.pages),i=[];for(let d=0;d<n.length;d++){const h=t.pages[parseInt(n[d])];h.dirty==!1&&h.pendingOps==0&&!h.writing&&!h.loading&&i.push(parseInt(n[d]))}let a=t.maxPagesLoaded-n.length;const o=[];for(;t.pendingLoads.length>0&&(typeof t.pages[t.pendingLoads[0].page]<"u"||a>0||i.length>0);){const d=t.pendingLoads.shift();if(typeof t.pages[d.page]<"u"){t.pages[d.page].pendingOps++;const h=i.indexOf(d.page);h>=0&&i.splice(h,1),t.pages[d.page].loading?t.pages[d.page].loading.push(d):d.resolve(),t.__statusPage("After Load (cached): ",d.page)}else{if(a)a--;else{const h=i.shift();t.__statusPage("Before Unload: ",h),t.avBuffs.unshift(t.pages[h]),delete t.pages[h],t.__statusPage("After Unload: ",h)}d.page>=t.totalPages?(t.pages[d.page]=s(),d.resolve(),t.__statusPage("After Load (new): ",d.page)):(t.reading=!0,t.pages[d.page]=s(),t.pages[d.page].loading=[d],o.push(t.fd.read(t.pages[d.page].buff,0,t.pageSize,d.page*t.pageSize).then(h=>{t.pages[d.page].size=h.bytesRead;const f=t.pages[d.page].loading;delete t.pages[d.page].loading;for(let l=0;l<f.length;l++)f[l].resolve();return t.__statusPage("After Load (loaded): ",d.page),h},h=>{d.reject(h)})),t.__statusPage("After Load (loading): ",d.page))}}Promise.all(o).then(()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()});function s(){if(t.avBuffs.length>0){const d=t.avBuffs.shift();return d.dirty=!1,d.pendingOps=1,d.size=0,d}else return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}}_triggerWrite(){const t=this;if(t.writing)return;const n=Object.keys(t.pages),i=[];for(let a=0;a<n.length;a++){const o=t.pages[parseInt(n[a])];o.dirty&&(o.dirty=!1,o.writing=!0,t.writing=!0,i.push(t.fd.write(o.buff,0,o.size,parseInt(n[a])*t.pageSize).then(()=>{o.writing=!1},s=>{console.log("ERROR Writing: "+s),t.error=s,t._tryClose()})))}t.writing&&Promise.all(i).then(()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))})}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,n){if(t.byteLength==0)return;const i=this;if(typeof n>"u"&&(n=i.pos),i.pos=n+t.byteLength,i.totalSize<n+t.byteLength&&(i.totalSize=n+t.byteLength),i.pendingClose)throw new Error("Writing a closing file");const a=Math.floor(n/i.pageSize),o=Math.floor((n+t.byteLength-1)/i.pageSize),s=[];for(let l=a;l<=o;l++)s.push(i._loadPage(l));i._triggerLoad();let d=a,h=n%i.pageSize,f=t.byteLength;for(;f>0;){await s[d-a];const l=h+f>i.pageSize?i.pageSize-h:f,m=t.slice(t.byteLength-f,t.byteLength-f+l);new Uint8Array(i.pages[d].buff.buffer,h,l).set(m),i.pages[d].dirty=!0,i.pages[d].pendingOps--,i.pages[d].size=Math.max(h+l,i.pages[d].size),d>=i.totalPages&&(i.totalPages=d+1),f=f-l,d++,h=0,i.writing||setImmediate(i._triggerWrite.bind(i))}}async read(t,n){const i=this;let a=new Uint8Array(t);return await i.readToBuffer(a,0,t,n),a}async readToBuffer(t,n,i,a){if(i==0)return;const o=this;if(i>o.pageSize*o.maxPagesLoaded*.8){const I=Math.floor(i*1.1);this.maxPagesLoaded=Math.floor(I/o.pageSize)+1}if(typeof a>"u"&&(a=o.pos),o.pos=a+i,o.pendingClose)throw new Error("Reading a closing file");const s=Math.floor(a/o.pageSize),d=Math.floor((a+i-1)/o.pageSize),h=[];for(let I=s;I<=d;I++)h.push(o._loadPage(I));o._triggerLoad();let f=s,l=a%o.pageSize,m=a+i>o.totalSize?i-(a+i-o.totalSize):i;for(;m>0;){await h[f-s],o.__statusPage("After Await (read): ",f);const I=l+m>o.pageSize?o.pageSize-l:m,g=new Uint8Array(o.pages[f].buff.buffer,o.pages[f].buff.byteOffset+l,I);t.set(g,n+i-m),o.pages[f].pendingOps--,o.__statusPage("After Op done: ",f),m=m-I,f++,l=0,o.pendingLoads.length>0&&setImmediate(o._triggerLoad.bind(o))}this.pos=a+i}_tryClose(){const t=this;!t.pendingClose||(t.error&&t.pendingCloseReject(t.error),t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0)||t.pendingClose()}close(){const t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise((n,i)=>{t.pendingClose=n,t.pendingCloseReject=i,t._tryClose()}).then(()=>{t.fd.close()},n=>{throw t.fd.close(),n})}async discard(){await this.close(),await Jo.promises.unlink(this.fileName)}async writeULE32(t,n){const i=this,a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,t,!0),await i.write(a,n)}async writeUBE32(t,n){const i=this,a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,t,!1),await i.write(a,n)}async writeULE64(t,n){const i=this,a=new Uint8Array(8),o=new DataView(a.buffer);o.setUint32(0,t&4294967295,!0),o.setUint32(4,Math.floor(t/4294967296),!0),await i.write(a,n)}async readULE32(t){const i=await this.read(4,t);return new Uint32Array(i.buffer)[0]}async readUBE32(t){const i=await this.read(4,t);return new DataView(i.buffer).getUint32(0,!1)}async readULE64(t){const i=await this.read(8,t),a=new Uint32Array(i.buffer);return a[1]*4294967296+a[0]}async readString(t){const n=this;if(n.pendingClose)throw new Error("Reading a closing file");let i=typeof t>"u"?n.pos:t,a=Math.floor(i/n.pageSize),o=!1,s="";for(;!o;){let d=n._loadPage(a);n._triggerLoad(),await d,n.__statusPage("After Await (read): ",a);let h=i%n.pageSize;const f=new Uint8Array(n.pages[a].buff.buffer,n.pages[a].buff.byteOffset+h,n.pageSize-h);let l=f.findIndex(m=>m===0);o=l!==-1,o?(s+=new TextDecoder().decode(f.slice(0,l)),n.pos=a*this.pageSize+h+l+1):(s+=new TextDecoder().decode(f),n.pos=a*this.pageSize+h+f.length),n.pages[a].pendingOps--,n.__statusPage("After Op done: ",a),i=n.pos,a++,n.pendingLoads.length>0&&setImmediate(n._triggerLoad.bind(n))}return s}}function lh(e){const t=e.initialSize||1048576,n=new Dl;return n.o=e,n.o.data=new Uint8Array(t),n.allocSize=t,n.totalSize=0,n.readOnly=!1,n.pos=0,n}function dh(e){const t=new Dl;return t.o=e,t.allocSize=e.data.byteLength,t.totalSize=e.data.byteLength,t.readOnly=!0,t.pos=0,t}const Xo=new Uint8Array(4),Ul=new DataView(Xo.buffer),Gl=new Uint8Array(8),Ml=new DataView(Gl.buffer);class Dl{constructor(){this.pageSize=1<<14}_resizeIfNeeded(t){if(t>this.allocSize){const n=Math.max(this.allocSize+1048576,Math.floor(this.allocSize*1.1),t),i=new Uint8Array(n);i.set(this.o.data),this.o.data=i,this.allocSize=n}}async write(t,n){if(typeof n>"u"&&(n=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(n+t.byteLength),this.o.data.set(t.slice(),n),n+t.byteLength>this.totalSize&&(this.totalSize=n+t.byteLength),this.pos=n+t.byteLength}async readToBuffer(t,n,i,a){if(typeof a>"u"&&(a=this.pos),this.readOnly&&a+i>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(a+i);const s=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+a,i);t.set(s,n),this.pos=a+i}async read(t,n){const i=this,a=new Uint8Array(t);return await i.readToBuffer(a,0,t,n),a}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,n){const i=this;Ul.setUint32(0,t,!0),await i.write(Xo,n)}async writeUBE32(t,n){const i=this;Ul.setUint32(0,t,!1),await i.write(Xo,n)}async writeULE64(t,n){const i=this;Ml.setUint32(0,t&4294967295,!0),Ml.setUint32(4,Math.floor(t/4294967296),!0),await i.write(Gl,n)}async readULE32(t){const i=await this.read(4,t);return new Uint32Array(i.buffer)[0]}async readUBE32(t){const i=await this.read(4,t);return new DataView(i.buffer).getUint32(0,!1)}async readULE64(t){const i=await this.read(8,t),a=new Uint32Array(i.buffer);return a[1]*4294967296+a[0]}async readString(t){const n=this;let i=typeof t>"u"?n.pos:t;if(i>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}const a=new Uint8Array(n.o.data.buffer,i,this.totalSize-i);let o=a.findIndex(h=>h===0),s=o!==-1,d="";return s?(d=new TextDecoder().decode(a.slice(0,o)),n.pos=i+o+1):n.pos=i,d}}const re=1<<22;function uh(e){const t=e.initialSize||0,n=new ql;n.o=e;const i=t?Math.floor((t-1)/re)+1:0;n.o.data=[];for(let a=0;a<i-1;a++)n.o.data.push(new Uint8Array(re));return i&&n.o.data.push(new Uint8Array(t-re*(i-1))),n.totalSize=0,n.readOnly=!1,n.pos=0,n}function fh(e){const t=new ql;return t.o=e,t.totalSize=(e.data.length-1)*re+e.data[e.data.length-1].byteLength,t.readOnly=!0,t.pos=0,t}const tr=new Uint8Array(4),Nl=new DataView(tr.buffer),kl=new Uint8Array(8),zl=new DataView(kl.buffer);class ql{constructor(){this.pageSize=1<<14}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const n=Math.floor((t-1)/re)+1;for(let i=Math.max(this.o.data.length-1,0);i<n;i++){const a=i<n-1?re:t-(n-1)*re,o=new Uint8Array(a);i==this.o.data.length-1&&o.set(this.o.data[i]),this.o.data[i]=o}this.totalSize=t}async write(t,n){const i=this;if(typeof n>"u"&&(n=i.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(n+t.byteLength);let o=Math.floor(n/re),s=n%re,d=t.byteLength;for(;d>0;){const h=s+d>re?re-s:d,f=t.slice(t.byteLength-d,t.byteLength-d+h);new Uint8Array(i.o.data[o].buffer,s,h).set(f),d=d-h,o++,s=0}this.pos=n+t.byteLength}async readToBuffer(t,n,i,a){const o=this;if(typeof a>"u"&&(a=o.pos),this.readOnly&&a+i>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(a+i);let d=Math.floor(a/re),h=a%re,f=i;for(;f>0;){const l=h+f>re?re-h:f,m=new Uint8Array(o.o.data[d].buffer,h,l);t.set(m,n+i-f),f=f-l,d++,h=0}this.pos=a+i}async read(t,n){const i=this,a=new Uint8Array(t);return await i.readToBuffer(a,0,t,n),a}close(){}async discard(){}async writeULE32(t,n){const i=this;Nl.setUint32(0,t,!0),await i.write(tr,n)}async writeUBE32(t,n){const i=this;Nl.setUint32(0,t,!1),await i.write(tr,n)}async writeULE64(t,n){const i=this;zl.setUint32(0,t&4294967295,!0),zl.setUint32(4,Math.floor(t/4294967296),!0),await i.write(kl,n)}async readULE32(t){const i=await this.read(4,t);return new Uint32Array(i.buffer)[0]}async readUBE32(t){const i=await this.read(4,t);return new DataView(i.buffer).getUint32(0,!1)}async readULE64(t){const i=await this.read(8,t),a=new Uint32Array(i.buffer);return a[1]*4294967296+a[0]}async readString(t){const n=this,i=2048;let a=typeof t>"u"?n.pos:t;if(a>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}let o=!1,s="";for(;!o;){let d=Math.floor(a/re),h=a%re;if(n.o.data[d]===void 0)throw new Error("ERROR");let f=Math.min(i,n.o.data[d].length-h);const l=new Uint8Array(n.o.data[d].buffer,h,f);let m=l.findIndex(I=>I===0);o=m!==-1,o?(s+=new TextDecoder().decode(l.slice(0,m)),n.pos=d*re+h+m+1):(s+=new TextDecoder().decode(l),n.pos=d*re+h+l.length),a=n.pos}return s}}const _h=0,hh=1,gh=2,ph=4,mh=1<<16,Lh=1<<13;async function Ah(e,t,n){if(typeof e=="string"&&(e={type:"file",fileName:e,cacheSize:t||mh,pageSize:n||Lh}),e.type=="file")return await Rl(e.fileName,_h|hh|gh,e.cacheSize,e.pageSize);if(e.type=="mem")return lh(e);if(e.type=="bigMem")return uh(e);throw new Error("Invalid FastFile type: "+e.type)}async function yh(e,t,n){if(e instanceof Uint8Array&&(e={type:"mem",data:e}),typeof e=="string"&&(e={type:"mem",data:await fetch(e).then(function(a){return a.arrayBuffer()}).then(function(a){return new Uint8Array(a)})}),e.type=="file")return await Rl(e.fileName,ph,e.cacheSize,e.pageSize);if(e.type=="mem")return await dh(e);if(e.type=="bigMem")return await fh(e);throw new Error("Invalid FastFile type: "+e.type)}async function xe(e,t,n,i,a){const o=await yh(e),s=await o.read(4);let d="";for(let m=0;m<4;m++)d+=String.fromCharCode(s[m]);if(d!=t)throw new Error(e+": Invalid File format");if(await o.readULE32()>n)throw new Error("Version not supported");const f=await o.readULE32();let l=[];for(let m=0;m<f;m++){let I=await o.readULE32(),g=await o.readULE64();typeof l[I]>"u"&&(l[I]=[]),l[I].push({p:o.pos,size:g}),o.pos+=g}return{fd:o,sections:l}}async function er(e,t,n,i,a,o){const s=await Ah(e,a,o),d=new Uint8Array(4);for(let h=0;h<4;h++)d[h]=t.charCodeAt(h);return await s.write(d,0),await s.writeULE32(n),await s.writeULE32(i),s}async function se(e,t){if(typeof e.writingSection<"u")throw new Error("Already writing a section");await e.writeULE32(t),e.writingSection={pSectionSize:e.pos},await e.writeULE64(0)}async function ce(e){if(typeof e.writingSection>"u")throw new Error("Not writing a section");const t=e.pos-e.writingSection.pSectionSize-8,n=e.pos;e.pos=e.writingSection.pSectionSize,await e.writeULE64(t),e.pos=n,delete e.writingSection}async function ge(e,t,n){if(typeof e.readingSection<"u")throw new Error("Already reading a section");if(!t[n])throw new Error(e.fileName+": Missing section "+n);if(t[n].length>1)throw new Error(e.fileName+": Section Duplicated "+n);e.pos=t[n][0].p,e.readingSection=t[n][0]}async function pe(e,t){if(typeof e.readingSection>"u")throw new Error("Not reading a section");if(!t&&e.pos-e.readingSection.p!=e.readingSection.size)throw new Error("Invalid section size reading");delete e.readingSection}async function oi(e,t,n,i){const a=new Uint8Array(n);Zt.toRprLE(a,0,t,n),await e.write(a,i)}async function On(e,t,n){const i=await e.read(t,n);return Zt.fromRprLE(i,0,t)}async function ki(e,t,n,i,a){typeof a>"u"&&(a=t[i][0].size);const o=e.pageSize;await ge(e,t,i),await se(n,i);for(let s=0;s<a;s+=o){const d=Math.min(a-s,o),h=await e.read(d);await n.write(h)}await ce(n),await pe(e,a!=t[i][0].size)}async function Me(e,t,n,i,a){if(i=typeof i>"u"?0:i,a=typeof a>"u"?t[n][0].size-i:a,i+a>t[n][0].size)throw new Error("Reading out of the range of the section");let o;return a<1<<30?o=new Uint8Array(a):o=new Wt(a),await e.readToBuffer(o,0,a,t[n][0].p+i),o}async function zi(e,t,n,i,a){const o=e.pageSize*16;if(await ge(e,t,a),await ge(n,i,a),t[a][0].size!=i[a][0].size)return!1;const s=t[a][0].size;for(let d=0;d<s;d+=o){const h=Math.min(s-d,o),f=await e.read(h),l=await n.read(h);for(let m=0;m<h;m++)if(f[m]!=l[m])return!1}return await pe(e),await pe(n),!0}const Ve=262144,wh={get:function(e,t){return isNaN(t)?e[t]:e.getElement(t)},set:function(e,t,n){return isNaN(t)?(e[t]=n,!0):e.setElement(t,n)}};class Ih{constructor(t){this.length=t||0,this.arr=new Array(Ve);for(let n=0;n<t;n+=Ve)this.arr[n/Ve]=new Array(Math.min(Ve,t-n));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,n){const i=new Array(n-t);for(let a=t;a<n;a++)i[a-t]=this.getElement(a);return i}getElement(t){t=parseInt(t);const n=Math.floor(t/Ve),i=t%Ve;return this.arr[n]?this.arr[n][i]:void 0}setElement(t,n){t=parseInt(t);const i=Math.floor(t/Ve);this.arr[i]||(this.arr[i]=new Array(Ve));const a=t%Ve;return this.arr[i][a]=n,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new Aa;for(let n=0;n<this.arr.length;n++)if(this.arr[n])for(let i=0;i<this.arr[n].length;i++)typeof this.arr[n][i]<"u"&&t.push(n*Ve+i);return t}}class Aa{constructor(t){const n=new Ih(t);return new Proxy(n,wh)}}const Ql=4,Hl=5;async function Wl(e,t,n){let i;typeof n=="object"?i=n:typeof n>"u"?i={singleThread:!1}:i={singleThread:n};const a={};if(await ge(e,t,1),a.n8=await e.readULE32(),a.prime=await On(e,a.n8),i.F){if(i.F.p!=a.prime)throw new Error("Different Prime");a.F=i.F}else if(i.getFieldFromPrime)a.F=await i.getFieldFromPrime(a.prime,i.singleThread);else if(i.getCurveFromPrime)a.curve=await i.getCurveFromPrime(a.prime,i.singleThread),a.F=a.curve.Fr;else try{a.curve=await Ol(a.prime,i.singleThread),a.F=a.curve.Fr}catch{a.F=new Dc(a.prime)}return a.nVars=await e.readULE32(),a.nOutputs=await e.readULE32(),a.nPubInputs=await e.readULE32(),a.nPrvInputs=await e.readULE32(),a.nLabels=await e.readULE64(),a.nConstraints=await e.readULE32(),a.useCustomGates=typeof t[Ql]<"u"&&t[Ql]!==null&&typeof t[Hl]<"u"&&t[Hl]!==null,await pe(e),a}var Eh=`//
// Copyright 2017 Christian Reitwiessner
// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
//
// 2019 OKIMS
//      ported to solidity 0.6
//      fixed linter warnings
//      added requiere error messages
//
//
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.6.11;
library Pairing {
    struct G1Point {
        uint X;
        uint Y;
    }
    // Encoding of field elements is: X[0] * z + X[1]
    struct G2Point {
        uint[2] X;
        uint[2] Y;
    }
    /// @return the generator of G1
    function P1() internal pure returns (G1Point memory) {
        return G1Point(1, 2);
    }
    /// @return the generator of G2
    function P2() internal pure returns (G2Point memory) {
        // Original code point
        return G2Point(
            [11559732032986387107991004021392285783925812861821192530917403151452391805634,
             10857046999023057135944570762232829481370756359578518086990519993285655852781],
            [4082367875863433681332203403145435568316851327593401208105741076214120093531,
             8495653923123431417604973247489272438418190587263600148770280649306958101930]
        );

/*
        // Changed by Jordi point
        return G2Point(
            [10857046999023057135944570762232829481370756359578518086990519993285655852781,
             11559732032986387107991004021392285783925812861821192530917403151452391805634],
            [8495653923123431417604973247489272438418190587263600148770280649306958101930,
             4082367875863433681332203403145435568316851327593401208105741076214120093531]
        );
*/
    }
    /// @return r the negation of p, i.e. p.addition(p.negate()) should be zero.
    function negate(G1Point memory p) internal pure returns (G1Point memory r) {
        // The prime q in the base field F_q for G1
        uint q = 21888242871839275222246405745257275088696311157297823662689037894645226208583;
        if (p.X == 0 && p.Y == 0)
            return G1Point(0, 0);
        return G1Point(p.X, q - (p.Y % q));
    }
    /// @return r the sum of two points of G1
    function addition(G1Point memory p1, G1Point memory p2) internal view returns (G1Point memory r) {
        uint[4] memory input;
        input[0] = p1.X;
        input[1] = p1.Y;
        input[2] = p2.X;
        input[3] = p2.Y;
        bool success;
        // solium-disable-next-line security/no-inline-assembly
        assembly {
            success := staticcall(sub(gas(), 2000), 6, input, 0xc0, r, 0x60)
            // Use "invalid" to make gas estimation work
            switch success case 0 { invalid() }
        }
        require(success,"pairing-add-failed");
    }
    /// @return r the product of a point on G1 and a scalar, i.e.
    /// p == p.scalar_mul(1) and p.addition(p) == p.scalar_mul(2) for all points p.
    function scalar_mul(G1Point memory p, uint s) internal view returns (G1Point memory r) {
        uint[3] memory input;
        input[0] = p.X;
        input[1] = p.Y;
        input[2] = s;
        bool success;
        // solium-disable-next-line security/no-inline-assembly
        assembly {
            success := staticcall(sub(gas(), 2000), 7, input, 0x80, r, 0x60)
            // Use "invalid" to make gas estimation work
            switch success case 0 { invalid() }
        }
        require (success,"pairing-mul-failed");
    }
    /// @return the result of computing the pairing check
    /// e(p1[0], p2[0]) *  .... * e(p1[n], p2[n]) == 1
    /// For example pairing([P1(), P1().negate()], [P2(), P2()]) should
    /// return true.
    function pairing(G1Point[] memory p1, G2Point[] memory p2) internal view returns (bool) {
        require(p1.length == p2.length,"pairing-lengths-failed");
        uint elements = p1.length;
        uint inputSize = elements * 6;
        uint[] memory input = new uint[](inputSize);
        for (uint i = 0; i < elements; i++)
        {
            input[i * 6 + 0] = p1[i].X;
            input[i * 6 + 1] = p1[i].Y;
            input[i * 6 + 2] = p2[i].X[0];
            input[i * 6 + 3] = p2[i].X[1];
            input[i * 6 + 4] = p2[i].Y[0];
            input[i * 6 + 5] = p2[i].Y[1];
        }
        uint[1] memory out;
        bool success;
        // solium-disable-next-line security/no-inline-assembly
        assembly {
            success := staticcall(sub(gas(), 2000), 8, add(input, 0x20), mul(inputSize, 0x20), out, 0x20)
            // Use "invalid" to make gas estimation work
            switch success case 0 { invalid() }
        }
        require(success,"pairing-opcode-failed");
        return out[0] != 0;
    }
    /// Convenience method for a pairing check for two pairs.
    function pairingProd2(G1Point memory a1, G2Point memory a2, G1Point memory b1, G2Point memory b2) internal view returns (bool) {
        G1Point[] memory p1 = new G1Point[](2);
        G2Point[] memory p2 = new G2Point[](2);
        p1[0] = a1;
        p1[1] = b1;
        p2[0] = a2;
        p2[1] = b2;
        return pairing(p1, p2);
    }
    /// Convenience method for a pairing check for three pairs.
    function pairingProd3(
            G1Point memory a1, G2Point memory a2,
            G1Point memory b1, G2Point memory b2,
            G1Point memory c1, G2Point memory c2
    ) internal view returns (bool) {
        G1Point[] memory p1 = new G1Point[](3);
        G2Point[] memory p2 = new G2Point[](3);
        p1[0] = a1;
        p1[1] = b1;
        p1[2] = c1;
        p2[0] = a2;
        p2[1] = b2;
        p2[2] = c2;
        return pairing(p1, p2);
    }
    /// Convenience method for a pairing check for four pairs.
    function pairingProd4(
            G1Point memory a1, G2Point memory a2,
            G1Point memory b1, G2Point memory b2,
            G1Point memory c1, G2Point memory c2,
            G1Point memory d1, G2Point memory d2
    ) internal view returns (bool) {
        G1Point[] memory p1 = new G1Point[](4);
        G2Point[] memory p2 = new G2Point[](4);
        p1[0] = a1;
        p1[1] = b1;
        p1[2] = c1;
        p1[3] = d1;
        p2[0] = a2;
        p2[1] = b2;
        p2[2] = c2;
        p2[3] = d2;
        return pairing(p1, p2);
    }
}
contract Verifier {
    using Pairing for *;
    struct VerifyingKey {
        Pairing.G1Point alfa1;
        Pairing.G2Point beta2;
        Pairing.G2Point gamma2;
        Pairing.G2Point delta2;
        Pairing.G1Point[] IC;
    }
    struct Proof {
        Pairing.G1Point A;
        Pairing.G2Point B;
        Pairing.G1Point C;
    }
    function verifyingKey() internal pure returns (VerifyingKey memory vk) {
        vk.alfa1 = Pairing.G1Point(
            <%=vk_alpha_1[0]%>,
            <%=vk_alpha_1[1]%>
        );

        vk.beta2 = Pairing.G2Point(
            [<%=vk_beta_2[0][1]%>,
             <%=vk_beta_2[0][0]%>],
            [<%=vk_beta_2[1][1]%>,
             <%=vk_beta_2[1][0]%>]
        );
        vk.gamma2 = Pairing.G2Point(
            [<%=vk_gamma_2[0][1]%>,
             <%=vk_gamma_2[0][0]%>],
            [<%=vk_gamma_2[1][1]%>,
             <%=vk_gamma_2[1][0]%>]
        );
        vk.delta2 = Pairing.G2Point(
            [<%=vk_delta_2[0][1]%>,
             <%=vk_delta_2[0][0]%>],
            [<%=vk_delta_2[1][1]%>,
             <%=vk_delta_2[1][0]%>]
        );
        vk.IC = new Pairing.G1Point[](<%=IC.length%>);
        <% for (let i=0; i<IC.length; i++) { %>
        vk.IC[<%=i%>] = Pairing.G1Point( 
            <%=IC[i][0]%>,
            <%=IC[i][1]%>
        );                                      
        <% } %>
    }
    function verify(uint[] memory input, Proof memory proof) internal view returns (uint) {
        uint256 snark_scalar_field = 21888242871839275222246405745257275088548364400416034343698204186575808495617;
        VerifyingKey memory vk = verifyingKey();
        require(input.length + 1 == vk.IC.length,"verifier-bad-input");
        // Compute the linear combination vk_x
        Pairing.G1Point memory vk_x = Pairing.G1Point(0, 0);
        for (uint i = 0; i < input.length; i++) {
            require(input[i] < snark_scalar_field,"verifier-gte-snark-scalar-field");
            vk_x = Pairing.addition(vk_x, Pairing.scalar_mul(vk.IC[i + 1], input[i]));
        }
        vk_x = Pairing.addition(vk_x, vk.IC[0]);
        if (!Pairing.pairingProd4(
            Pairing.negate(proof.A), proof.B,
            vk.alfa1, vk.beta2,
            vk_x, vk.gamma2,
            proof.C, vk.delta2
        )) return 1;
        return 0;
    }
    /// @return r  bool true if proof is valid
    function verifyProof(
            uint[2] memory a,
            uint[2][2] memory b,
            uint[2] memory c,
            uint[<%=IC.length-1%>] memory input
        ) public view returns (bool r) {
        Proof memory proof;
        proof.A = Pairing.G1Point(a[0], a[1]);
        proof.B = Pairing.G2Point([b[0][0], b[0][1]], [b[1][0], b[1][1]]);
        proof.C = Pairing.G1Point(c[0], c[1]);
        uint[] memory inputValues = new uint[](input.length);
        for(uint i = 0; i < input.length; i++){
            inputValues[i] = input[i];
        }
        if (verify(inputValues, proof) == 0) {
            return true;
        } else {
            return false;
        }
    }
}
`,bh=`// SPDX-License-Identifier: GPL-3.0
/*
    Copyright 2021 0KIMS association.

    This file is generated with [snarkJS](https://github.com/iden3/snarkjs).

    snarkJS is a free software: you can redistribute it and/or modify it
    under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    snarkJS is distributed in the hope that it will be useful, but WITHOUT
    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public
    License for more details.

    You should have received a copy of the GNU General Public License
    along with snarkJS. If not, see <https://www.gnu.org/licenses/>.
*/


pragma solidity >=0.7.0 <0.9.0;

contract PlonkVerifier {
    
    uint<%=2**Math.ceil(Math.log2(power))%> constant n =   <%=2**power%>;
    uint16 constant nPublic =  <%=nPublic%>;
    uint16 constant nLagrange = <%=Math.max(nPublic, 1)%>;
    
    uint256 constant Qmx = <%=Qm[0]%>;
    uint256 constant Qmy = <%=Qm[0] == "0" ? "0" : Qm[1]%>;
    uint256 constant Qlx = <%=Ql[0]%>;
    uint256 constant Qly = <%=Ql[0] == "0" ? "0" : Ql[1]%>;
    uint256 constant Qrx = <%=Qr[0]%>;
    uint256 constant Qry = <%=Qr[0] == "0" ? "0" : Qr[1]%>;
    uint256 constant Qox = <%=Qo[0]%>;
    uint256 constant Qoy = <%=Qo[0] == "0" ? "0" : Qo[1]%>;
    uint256 constant Qcx = <%=Qc[0]%>;
    uint256 constant Qcy = <%=Qc[0] == "0" ? "0" : Qc[1]%>;
    uint256 constant S1x = <%=S1[0]%>;
    uint256 constant S1y = <%=S1[0] == "0" ? "0" : S1[1]%>;
    uint256 constant S2x = <%=S2[0]%>;
    uint256 constant S2y = <%=S2[0] == "0" ? "0" : S2[1]%>;
    uint256 constant S3x = <%=S3[0]%>;
    uint256 constant S3y = <%=S3[0] == "0" ? "0" : S3[1]%>;
    uint256 constant k1 = 2;
    uint256 constant k2 = 3;
    uint256 constant X2x1 = <%=X_2[0][0]%>;
    uint256 constant X2x2 = <%=X_2[0][1]%>;
    uint256 constant X2y1 = <%=X_2[1][0]%>;
    uint256 constant X2y2 = <%=X_2[1][1]%>;
    
    uint256 constant q = 21888242871839275222246405745257275088548364400416034343698204186575808495617;
    uint256 constant qf = 21888242871839275222246405745257275088696311157297823662689037894645226208583;
    uint256 constant w1 = <%=w%>;    
    
    uint256 constant G1x = 1;
    uint256 constant G1y = 2;
    uint256 constant G2x1 = 10857046999023057135944570762232829481370756359578518086990519993285655852781;
    uint256 constant G2x2 = 11559732032986387107991004021392285783925812861821192530917403151452391805634;
    uint256 constant G2y1 = 8495653923123431417604973247489272438418190587263600148770280649306958101930;
    uint256 constant G2y2 = 4082367875863433681332203403145435568316851327593401208105741076214120093531;
    uint16 constant pA = 32;
    uint16 constant pB = 96;
    uint16 constant pC = 160;
    uint16 constant pZ = 224;
    uint16 constant pT1 = 288;
    uint16 constant pT2 = 352;
    uint16 constant pT3 = 416;
    uint16 constant pWxi = 480;
    uint16 constant pWxiw = 544;
    uint16 constant pEval_a = 608;
    uint16 constant pEval_b = 640;
    uint16 constant pEval_c = 672;
    uint16 constant pEval_s1 = 704;
    uint16 constant pEval_s2 = 736;
    uint16 constant pEval_zw = 768;
    uint16 constant pEval_r = 800;
    
    uint16 constant pAlpha = 0;
    uint16 constant pBeta = 32;
    uint16 constant pGamma = 64;
    uint16 constant pXi = 96;
    uint16 constant pXin = 128;
    uint16 constant pBetaXi = 160;
    uint16 constant pV1 = 192;
    uint16 constant pV2 = 224;
    uint16 constant pV3 = 256;
    uint16 constant pV4 = 288;
    uint16 constant pV5 = 320;
    uint16 constant pV6 = 352;
    uint16 constant pU = 384;
    uint16 constant pPl = 416;
    uint16 constant pEval_t = 448;
    uint16 constant pA1 = 480;
    uint16 constant pB1 = 544;
    uint16 constant pZh = 608;
    uint16 constant pZhInv = 640;
    <% for (let i=1; i<=Math.max(nPublic, 1); i++) { %>
    uint16 constant pEval_l<%=i%> = <%=640+i*32%>;
    <% } %>
    
    
    uint16 constant lastMem = <%=672+32*Math.max(nPublic,1)%>;


    function verifyProof(bytes memory proof, uint[] memory pubSignals) public view returns (bool) {
        assembly {
            /////////
            // Computes the inverse using the extended euclidean algorithm
            /////////
            function inverse(a, q) -> inv {
                let t := 0     
                let newt := 1
                let r := q     
                let newr := a
                let quotient
                let aux
                
                for { } newr { } {
                    quotient := sdiv(r, newr)
                    aux := sub(t, mul(quotient, newt))
                    t:= newt
                    newt:= aux
                    
                    aux := sub(r,mul(quotient, newr))
                    r := newr
                    newr := aux
                }
                
                if gt(r, 1) { revert(0,0) }
                if slt(t, 0) { t:= add(t, q) }

                inv := t
            }
            
            ///////
            // Computes the inverse of an array of values
            // See https://vitalik.ca/general/2018/07/21/starks_part_3.html in section where explain fields operations
            //////
            function inverseArray(pVals, n) {
    
                let pAux := mload(0x40)     // Point to the next free position
                let pIn := pVals
                let lastPIn := add(pVals, mul(n, 32))  // Read n elemnts
                let acc := mload(pIn)       // Read the first element
                pIn := add(pIn, 32)         // Point to the second element
                let inv
    
                
                for { } lt(pIn, lastPIn) { 
                    pAux := add(pAux, 32) 
                    pIn := add(pIn, 32)
                } 
                {
                    mstore(pAux, acc)
                    acc := mulmod(acc, mload(pIn), q)
                }
                acc := inverse(acc, q)
                
                // At this point pAux pint to the next free position we substract 1 to point to the last used
                pAux := sub(pAux, 32)
                // pIn points to the n+1 element, we substract to point to n
                pIn := sub(pIn, 32)
                lastPIn := pVals  // We don't process the first element 
                for { } gt(pIn, lastPIn) { 
                    pAux := sub(pAux, 32) 
                    pIn := sub(pIn, 32)
                } 
                {
                    inv := mulmod(acc, mload(pAux), q)
                    acc := mulmod(acc, mload(pIn), q)
                    mstore(pIn, inv)
                }
                // pIn points to first element, we just set it.
                mstore(pIn, acc)
            }
            
            function checkField(v) {
                if iszero(lt(v, q)) {
                    mstore(0, 0)
                    return(0,0x20)
                }
            }
            
            function checkInput(pProof) {
                if iszero(eq(mload(pProof), 800 )) {
                    mstore(0, 0)
                    return(0,0x20)
                }
                checkField(mload(add(pProof, pEval_a)))
                checkField(mload(add(pProof, pEval_b)))
                checkField(mload(add(pProof, pEval_c)))
                checkField(mload(add(pProof, pEval_s1)))
                checkField(mload(add(pProof, pEval_s2)))
                checkField(mload(add(pProof, pEval_zw)))
                checkField(mload(add(pProof, pEval_r)))

                // Points are checked in the point operations precompiled smart contracts
            }
            
            function calculateChallanges(pProof, pMem) {
            
                let a
                let b
                
                b := mod(keccak256(add(pProof, pA), 192), q) 
                mstore( add(pMem, pBeta), b)
                mstore( add(pMem, pGamma), mod(keccak256(add(pMem, pBeta), 32), q))
                mstore( add(pMem, pAlpha), mod(keccak256(add(pProof, pZ), 64), q))
                
                a := mod(keccak256(add(pProof, pT1), 192), q)
                mstore( add(pMem, pXi), a)
                mstore( add(pMem, pBetaXi), mulmod(b, a, q))
                <%for (let i=0; i<power;i++) {%>
                a:= mulmod(a, a, q)
                <%}%>
                mstore( add(pMem, pXin), a)
                a:= mod(add(sub(a, 1),q), q)
                mstore( add(pMem, pZh), a)
                mstore( add(pMem, pZhInv), a)  // We will invert later together with lagrange pols
                
                let v1 := mod(keccak256(add(pProof, pEval_a), 224), q)
                mstore( add(pMem, pV1), v1)
                a := mulmod(v1, v1, q)
                mstore( add(pMem, pV2), a)
                a := mulmod(a, v1, q)
                mstore( add(pMem, pV3), a)
                a := mulmod(a, v1, q)
                mstore( add(pMem, pV4), a)
                a := mulmod(a, v1, q)
                mstore( add(pMem, pV5), a)
                a := mulmod(a, v1, q)
                mstore( add(pMem, pV6), a)
                
                mstore( add(pMem, pU), mod(keccak256(add(pProof, pWxi), 128), q))
            }
            
            function calculateLagrange(pMem) {

                let w := 1                
                <% for (let i=1; i<=Math.max(nPublic, 1); i++) { %>
                mstore(
                    add(pMem, pEval_l<%=i%>), 
                    mulmod(
                        n, 
                        mod(
                            add(
                                sub(
                                    mload(add(pMem, pXi)), 
                                    w
                                ), 
                                q
                            ),
                            q
                        ), 
                        q
                    )
                )
                <% if (i<Math.max(nPublic, 1)) { %>
                w := mulmod(w, w1, q)
                <% } %>
                <% } %>
                
                inverseArray(add(pMem, pZhInv), <%=Math.max(nPublic, 1)+1%> )
                
                let zh := mload(add(pMem, pZh))
                w := 1
                <% for (let i=1; i<=Math.max(nPublic, 1); i++) { %>
                <% if (i==1) { %>
                mstore(
                    add(pMem, pEval_l1 ), 
                    mulmod(
                        mload(add(pMem, pEval_l1 )),
                        zh,
                        q
                    )
                )
                <% } else { %>
                mstore(
                    add(pMem, pEval_l<%=i%>), 
                    mulmod(
                        w,
                        mulmod(
                            mload(add(pMem, pEval_l<%=i%>)),
                            zh,
                            q
                        ),
                        q
                    )
                )
                <% } %>
                <% if (i<Math.max(nPublic, 1)) { %>
                w := mulmod(w, w1, q)
                <% } %>
                <% } %>


            }
            
            function calculatePl(pMem, pPub) {
                let pl := 0
                
                <% for (let i=0; i<nPublic; i++) { %> 
                pl := mod(
                    add(
                        sub(
                            pl,  
                            mulmod(
                                mload(add(pMem, pEval_l<%=i+1%>)),
                                mload(add(pPub, <%=32+i*32%>)),
                                q
                            )
                        ),
                        q
                    ),
                    q
                )
                <% } %>
                
                mstore(add(pMem, pPl), pl)
                

            }

            function calculateT(pProof, pMem) {
                let t
                let t1
                let t2
                t := addmod(
                    mload(add(pProof, pEval_r)), 
                    mload(add(pMem, pPl)), 
                    q
                )
                
                t1 := mulmod(
                    mload(add(pProof, pEval_s1)),
                    mload(add(pMem, pBeta)),
                    q
                )

                t1 := addmod(
                    t1,
                    mload(add(pProof, pEval_a)),
                    q
                )
                
                t1 := addmod(
                    t1,
                    mload(add(pMem, pGamma)),
                    q
                )

                t2 := mulmod(
                    mload(add(pProof, pEval_s2)),
                    mload(add(pMem, pBeta)),
                    q
                )

                t2 := addmod(
                    t2,
                    mload(add(pProof, pEval_b)),
                    q
                )
                
                t2 := addmod(
                    t2,
                    mload(add(pMem, pGamma)),
                    q
                )
                
                t1 := mulmod(t1, t2, q)
                
                t2 := addmod(
                    mload(add(pProof, pEval_c)),
                    mload(add(pMem, pGamma)),
                    q
                )

                t1 := mulmod(t1, t2, q)
                t1 := mulmod(t1, mload(add(pProof, pEval_zw)), q)
                t1 := mulmod(t1, mload(add(pMem, pAlpha)), q)
                
                t2 := mulmod(
                    mload(add(pMem, pEval_l1)), 
                    mload(add(pMem, pAlpha)), 
                    q
                )

                t2 := mulmod(
                    t2, 
                    mload(add(pMem, pAlpha)), 
                    q
                )

                t1 := addmod(t1, t2, q)
                
                t := mod(sub(add(t, q), t1), q)
                t := mulmod(t, mload(add(pMem, pZhInv)), q)
                
                mstore( add(pMem, pEval_t) , t)

            }
            
            function g1_set(pR, pP) {
                mstore(pR, mload(pP))
                mstore(add(pR, 32), mload(add(pP,32)))
            }

            function g1_acc(pR, pP) {
                let mIn := mload(0x40)
                mstore(mIn, mload(pR))
                mstore(add(mIn,32), mload(add(pR, 32)))
                mstore(add(mIn,64), mload(pP))
                mstore(add(mIn,96), mload(add(pP, 32)))

                let success := staticcall(sub(gas(), 2000), 6, mIn, 128, pR, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
            }

            function g1_mulAcc(pR, pP, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, mload(pP))
                mstore(add(mIn,32), mload(add(pP, 32)))
                mstore(add(mIn,64), s)

                success := staticcall(sub(gas(), 2000), 7, mIn, 96, mIn, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
                
                mstore(add(mIn,64), mload(pR))
                mstore(add(mIn,96), mload(add(pR, 32)))

                success := staticcall(sub(gas(), 2000), 6, mIn, 128, pR, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
                
            }

            function g1_mulAccC(pR, x, y, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x)
                mstore(add(mIn,32), y)
                mstore(add(mIn,64), s)

                success := staticcall(sub(gas(), 2000), 7, mIn, 96, mIn, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
                
                mstore(add(mIn,64), mload(pR))
                mstore(add(mIn,96), mload(add(pR, 32)))

                success := staticcall(sub(gas(), 2000), 6, mIn, 128, pR, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
            }

            function g1_mulSetC(pR, x, y, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x)
                mstore(add(mIn,32), y)
                mstore(add(mIn,64), s)

                success := staticcall(sub(gas(), 2000), 7, mIn, 96, pR, 64)
                
                if iszero(success) {
                    mstore(0, 0)
                    return(0,0x20)
                }
            }


            function calculateA1(pProof, pMem) {
                let p := add(pMem, pA1)
                g1_set(p, add(pProof, pWxi))
                g1_mulAcc(p, add(pProof, pWxiw), mload(add(pMem, pU)))
            }
            
            
            function calculateB1(pProof, pMem) {
                let s
                let s1
                let p := add(pMem, pB1)
                
                // Calculate D
                s := mulmod( mload(add(pProof, pEval_a)), mload(add(pMem, pV1)), q)
                g1_mulSetC(p, Qlx, Qly, s)

                s := mulmod( s, mload(add(pProof, pEval_b)), q)                
                g1_mulAccC(p, Qmx, Qmy, s)

                s := mulmod( mload(add(pProof, pEval_b)), mload(add(pMem, pV1)), q)
                g1_mulAccC(p, Qrx, Qry, s)
                
                s := mulmod( mload(add(pProof, pEval_c)), mload(add(pMem, pV1)), q)
                g1_mulAccC(p, Qox, Qoy, s)

                s :=mload(add(pMem, pV1))
                g1_mulAccC(p, Qcx, Qcy, s)

                s := addmod(mload(add(pProof, pEval_a)), mload(add(pMem, pBetaXi)), q)
                s := addmod(s, mload(add(pMem, pGamma)), q)
                s1 := mulmod(k1, mload(add(pMem, pBetaXi)), q)
                s1 := addmod(s1, mload(add(pProof, pEval_b)), q)
                s1 := addmod(s1, mload(add(pMem, pGamma)), q)
                s := mulmod(s, s1, q)
                s1 := mulmod(k2, mload(add(pMem, pBetaXi)), q)
                s1 := addmod(s1, mload(add(pProof, pEval_c)), q)
                s1 := addmod(s1, mload(add(pMem, pGamma)), q)
                s := mulmod(s, s1, q)
                s := mulmod(s, mload(add(pMem, pAlpha)), q)
                s := mulmod(s, mload(add(pMem, pV1)), q)
                s1 := mulmod(mload(add(pMem, pEval_l1)), mload(add(pMem, pAlpha)), q)
                s1 := mulmod(s1, mload(add(pMem, pAlpha)), q)
                s1 := mulmod(s1, mload(add(pMem, pV1)), q)
                s := addmod(s, s1, q)
                s := addmod(s, mload(add(pMem, pU)), q)
                g1_mulAcc(p, add(pProof, pZ), s)
                
                s := mulmod(mload(add(pMem, pBeta)), mload(add(pProof, pEval_s1)), q)
                s := addmod(s, mload(add(pProof, pEval_a)), q)
                s := addmod(s, mload(add(pMem, pGamma)), q)
                s1 := mulmod(mload(add(pMem, pBeta)), mload(add(pProof, pEval_s2)), q)
                s1 := addmod(s1, mload(add(pProof, pEval_b)), q)
                s1 := addmod(s1, mload(add(pMem, pGamma)), q)
                s := mulmod(s, s1, q)
                s := mulmod(s, mload(add(pMem, pAlpha)), q)
                s := mulmod(s, mload(add(pMem, pV1)), q)
                s := mulmod(s, mload(add(pMem, pBeta)), q)
                s := mulmod(s, mload(add(pProof, pEval_zw)), q)
                s := mod(sub(q, s), q)
                g1_mulAccC(p, S3x, S3y, s)


                // calculate F
                g1_acc(p , add(pProof, pT1))

                s := mload(add(pMem, pXin))
                g1_mulAcc(p, add(pProof, pT2), s)
                
                s := mulmod(s, s, q)
                g1_mulAcc(p, add(pProof, pT3), s)
                
                g1_mulAcc(p, add(pProof, pA), mload(add(pMem, pV2)))
                g1_mulAcc(p, add(pProof, pB), mload(add(pMem, pV3)))
                g1_mulAcc(p, add(pProof, pC), mload(add(pMem, pV4)))
                g1_mulAccC(p, S1x, S1y, mload(add(pMem, pV5)))
                g1_mulAccC(p, S2x, S2y, mload(add(pMem, pV6)))
                
                // calculate E
                s := mload(add(pMem, pEval_t))
                s := addmod(s, mulmod(mload(add(pProof, pEval_r)), mload(add(pMem, pV1)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_a)), mload(add(pMem, pV2)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_b)), mload(add(pMem, pV3)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_c)), mload(add(pMem, pV4)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_s1)), mload(add(pMem, pV5)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_s2)), mload(add(pMem, pV6)), q), q)
                s := addmod(s, mulmod(mload(add(pProof, pEval_zw)), mload(add(pMem, pU)), q), q)
                s := mod(sub(q, s), q)
                g1_mulAccC(p, G1x, G1y, s)
                
                
                // Last part of B
                s := mload(add(pMem, pXi))
                g1_mulAcc(p, add(pProof, pWxi), s)

                s := mulmod(mload(add(pMem, pU)), mload(add(pMem, pXi)), q)
                s := mulmod(s, w1, q)
                g1_mulAcc(p, add(pProof, pWxiw), s)

            }
            
            function checkPairing(pMem) -> isOk {
                let mIn := mload(0x40)
                mstore(mIn, mload(add(pMem, pA1)))
                mstore(add(mIn,32), mload(add(add(pMem, pA1), 32)))
                mstore(add(mIn,64), X2x2)
                mstore(add(mIn,96), X2x1)
                mstore(add(mIn,128), X2y2)
                mstore(add(mIn,160), X2y1)
                mstore(add(mIn,192), mload(add(pMem, pB1)))
                let s := mload(add(add(pMem, pB1), 32))
                s := mod(sub(qf, s), qf)
                mstore(add(mIn,224), s)
                mstore(add(mIn,256), G2x2)
                mstore(add(mIn,288), G2x1)
                mstore(add(mIn,320), G2y2)
                mstore(add(mIn,352), G2y1)
                
                let success := staticcall(sub(gas(), 2000), 8, mIn, 384, mIn, 0x20)
                
                isOk := and(success, mload(mIn))
            }
            
            let pMem := mload(0x40)
            mstore(0x40, add(pMem, lastMem))
            
            checkInput(proof)
            calculateChallanges(proof, pMem)
            calculateLagrange(pMem)
            calculatePl(pMem, pubSignals)
            calculateT(proof, pMem)
            calculateA1(proof, pMem)
            calculateB1(proof, pMem)
            let isValid := checkPairing(pMem)
            
            mstore(0x40, sub(pMem, lastMem))
            mstore(0, isValid)
            return(0,0x20)
        }
        
    }
}`,Ch='var snarkjs=function(t){"use strict";const e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function a(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}const i=a;function o(t){const a=t.toString(16);return 4*(a.length-1)+e[parseInt(a[0],16)]}function n(t){return BigInt(t)<BigInt(0)}function c(t){return!t}function r(t,e){return BigInt(t)<<BigInt(e)}function l(t,e){return BigInt(t)>>BigInt(e)}const s=r,d=l;function u(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function g(t){let e=BigInt(t);const a=[];for(;e;)e&BigInt(1)?a.push(1):a.push(0),e>>=BigInt(1);return a}function _(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(t)}function f(t,e){return BigInt(t)+BigInt(e)}function h(t,e){return BigInt(t)-BigInt(e)}function p(t){return-BigInt(t)}function m(t,e){return BigInt(t)*BigInt(e)}function L(t,e){return BigInt(t)**BigInt(e)}function w(t,e){return BigInt(t)/BigInt(e)}function A(t,e){return BigInt(t)%BigInt(e)}function b(t,e){return BigInt(t)==BigInt(e)}function y(t,e){return BigInt(t)>BigInt(e)}function I(t,e){return BigInt(t)>=BigInt(e)}function C(t,e){return BigInt(t)&BigInt(e)}function F(t,e,a,i){const o="0000000"+a.toString(16),n=new Uint32Array(t.buffer,e,i/4),c=1+(4*(o.length-7)-1>>5);for(let t=0;t<c;t++)n[t]=parseInt(o.substring(o.length-8*t-8,o.length-8*t),16);for(let t=c;t<n.length;t++)n[t]=0;for(let e=4*n.length;e<i;e++)t[e]=_(C(l(a,8*e),255))}function x(t,e,a,i){const o="0000000"+a.toString(16),n=new DataView(t.buffer,t.byteOffset+e,i),c=1+(4*(o.length-7)-1>>5);for(let t=0;t<c;t++)n.setUint32(i-4*t-4,parseInt(o.substring(o.length-8*t-8,o.length-8*t),16),!1);for(let t=0;t<i/4-c;t++)n[t]=0}function E(t,e,i){i=i||t.byteLength,e=e||0;const o=new Uint32Array(t.buffer,e,i/4),n=new Array(i/4);return o.forEach(((t,e)=>n[n.length-e-1]=t.toString(16).padStart(8,"0"))),a(n.join(""),16)}function B(t,e,i){i=i||t.byteLength,e=e||0;const o=new DataView(t.buffer,t.byteOffset+e,i),n=new Array(i/4);for(let t=0;t<i/4;t++)n[t]=o.getUint32(4*t,!1).toString(16).padStart(8,"0");return a(n.join(""),16)}function v(t,e){return t.toString(e)}function S(t){const e=new Uint8Array(Math.floor((o(t)-1)/8)+1);return F(e,0,t,e.byteLength),e}const G=i(0),P=i(1);var U=Object.freeze({__proto__:null,fromString:a,e:i,fromArray:function(t,e){let a=BigInt(0);e=BigInt(e);for(let i=0;i<t.length;i++)a=a*e+BigInt(t[i]);return a},bitLength:o,isNegative:n,isZero:c,shiftLeft:r,shiftRight:l,shl:s,shr:d,isOdd:u,naf:function(t){let e=BigInt(t);const a=[];for(;e;){if(e&BigInt(1)){const t=2-Number(e%BigInt(4));a.push(t),e-=BigInt(t)}else a.push(0);e>>=BigInt(1)}return a},bits:g,toNumber:_,toArray:function(t,e){const a=[];let i=BigInt(t);for(e=BigInt(e);i;)a.unshift(Number(i%e)),i/=e;return a},add:f,sub:h,neg:p,mul:m,square:function(t){return BigInt(t)*BigInt(t)},pow:L,exp:function(t,e){return BigInt(t)**BigInt(e)},abs:function(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)},div:w,mod:A,eq:b,neq:function(t,e){return BigInt(t)!=BigInt(e)},lt:function(t,e){return BigInt(t)<BigInt(e)},gt:y,leq:function(t,e){return BigInt(t)<=BigInt(e)},geq:I,band:C,bor:function(t,e){return BigInt(t)|BigInt(e)},bxor:function(t,e){return BigInt(t)^BigInt(e)},land:function(t,e){return BigInt(t)&&BigInt(e)},lor:function(t,e){return BigInt(t)||BigInt(e)},lnot:function(t){return!BigInt(t)},toRprLE:F,toRprBE:x,fromRprLE:E,fromRprBE:B,toString:v,toLEBuff:S,zero:G,one:P});function O(t,e,a){if(c(a))return t.one;const i=g(a);if(0==i.length)return t.one;let o=e;for(let a=i.length-2;a>=0;a--)o=t.square(o),i[a]&&(o=t.mul(o,e));return o}function z(t){if(t.m%2==1)if(b(A(t.p,4),1))if(b(A(t.p,8),1))if(b(A(t.p,16),1))!function(t){t.sqrt_q=L(t.p,t.m),t.sqrt_s=0,t.sqrt_t=h(t.sqrt_q,1);for(;!u(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=w(t.sqrt_t,2);let e=t.one;for(;t.eq(e,t.one);){const a=t.random();t.sqrt_z=t.pow(a,t.sqrt_t),e=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=w(h(t.sqrt_t,1),2),t.sqrt=function(t){const e=this;if(e.isZero(t))return e.zero;let a=e.pow(t,e.sqrt_tm1d2);const i=e.pow(e.mul(e.square(a),t),2**(e.sqrt_s-1));if(e.eq(i,e.negone))return null;let o=e.sqrt_s,n=e.mul(t,a),c=e.mul(n,a),r=e.sqrt_z;for(;!e.eq(c,e.one);){let t=e.square(c),i=1;for(;!e.eq(t,e.one);)t=e.square(t),i++;a=r;for(let t=0;t<o-i-1;t++)a=e.square(a);r=e.square(a),c=e.mul(c,r),n=e.mul(n,a),o=i}return e.geq(n,e.zero)?n:e.neg(n)}}(t);else{if(!b(A(t.p,16),9))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}(t)}else{if(!b(A(t.p,8),5))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}(t)}else b(A(t.p,4),3)&&function(t){t.sqrt_q=L(t.p,t.m),t.sqrt_e1=w(h(t.sqrt_q,3),4),t.sqrt=function(e){if(this.isZero(e))return this.zero;const a=this.pow(e,this.sqrt_e1),i=this.mul(this.square(a),e);if(this.eq(i,this.negone))return null;const o=this.mul(a,e);return t.geq(o,t.zero)?o:t.neg(o)}}(t);else{const e=A(L(t.p,t.m/2),4);1==e?function(t){t.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}(t):3==e?function(t){t.sqrt_q=L(t.p,t.m/2),t.sqrt_e34=w(h(t.sqrt_q,3),4),t.sqrt_e12=w(h(t.sqrt_q,1),2),t.frobenius=function(e,a){return e%2==1?t.conjugate(a):a},t.sqrt=function(t){const e=this,a=e.pow(t,e.sqrt_e34),i=e.mul(e.square(a),t),o=e.mul(e.frobenius(1,i),i);if(e.eq(o,e.negone))return null;const n=e.mul(a,t);let c;if(e.eq(i,e.negone))c=e.mul(n,[e.F.zero,e.F.one]);else{const t=e.pow(e.add(e.one,i),e.sqrt_e12);c=e.mul(t,n)}return e.geq(c,e.zero)?c:e.neg(c)}}(t):function(t){t.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}(t)}}function Q(t,e,a,i,o){t[e]=t[e]+t[a]>>>0,t[o]=(t[o]^t[e])>>>0,t[o]=(t[o]<<16|t[o]>>>16&65535)>>>0,t[i]=t[i]+t[o]>>>0,t[a]=(t[a]^t[i])>>>0,t[a]=(t[a]<<12|t[a]>>>20&4095)>>>0,t[e]=t[e]+t[a]>>>0,t[o]=(t[o]^t[e])>>>0,t[o]=(t[o]<<8|t[o]>>>24&255)>>>0,t[i]=t[i]+t[o]>>>0,t[a]=(t[a]^t[i])>>>0,t[a]=(t[a]<<7|t[a]>>>25&127)>>>0}class q{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return f(m(this.nextU32(),4294967296),this.nextU32())}nextBool(){return 1==(1&this.nextU32())}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let e=0;e<10;e++)Q(t=this.buff,0,4,8,12),Q(t,1,5,9,13),Q(t,2,6,10,14),Q(t,3,7,11,15),Q(t,0,5,10,15),Q(t,1,6,11,12),Q(t,2,7,8,13),Q(t,3,4,9,14);var t;for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}var M={};function T(t){let e=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(e);else for(let a=0;a<t;a++)e[a]=4294967296*Math.random()>>>0;return e}let k=null;function R(){return k||(k=new q(function(){const t=T(32),e=new Uint32Array(t.buffer),a=[];for(let t=0;t<8;t++)a.push(e[t]);return a}()),k)}class D{constructor(t,e,a){this.F=e,this.G=t,this.opMulGF=a;let i=e.sqrt_t||e.t,o=e.sqrt_s||e.s,n=e.one;for(;e.eq(e.pow(n,e.half),e.one);)n=e.add(n,e.one);this.w=new Array(o+1),this.wi=new Array(o+1),this.w[o]=this.F.pow(n,i),this.wi[o]=this.F.inv(this.w[o]);let c=o-1;for(;c>=0;)this.w[c]=this.F.square(this.w[c+1]),this.wi[c]=this.F.square(this.wi[c+1]),c--;this.roots=[],this._setRoots(Math.min(o,15))}_setRoots(t){for(let e=t;e>=0&&!this.roots[e];e--){let t=this.F.one;const a=1<<e,i=new Array(a);for(let o=0;o<a;o++)i[o]=t,t=this.F.mul(t,this.w[e]);this.roots[e]=i}}fft(t){if(t.length<=1)return t;const e=N(t.length-1)+1;this._setRoots(e);const a=1<<e;if(t.length!=a)throw new Error("Size must be multiple of 2");return V(this,t,e,0,1)}ifft(t){if(t.length<=1)return t;const e=N(t.length-1)+1;this._setRoots(e);const a=1<<e;if(t.length!=a)throw new Error("Size must be multiple of 2");const i=V(this,t,e,0,1),o=this.F.inv(this.F.mulScalar(this.F.one,a)),n=new Array(a);for(let t=0;t<a;t++)n[t]=this.opMulGF(i[(a-t)%a],o);return n}}function N(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function V(t,e,a,i,o){const n=1<<a;if(1==n)return[e[i]];if(2==n)return[t.G.add(e[i],e[i+o]),t.G.sub(e[i],e[i+o])];const c=n>>1,r=V(t,e,a-1,i,2*o),l=V(t,e,a-1,i+o,2*o),s=new Array(n);for(let e=0;e<c;e++)s[e]=t.G.add(r[e],t.opMulGF(l[e],t.roots[a][e])),s[e+c]=t.G.sub(r[e],t.opMulGF(l[e],t.roots[a][e]));return s}class K{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=o(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const e=this.negone>>this.one;this.nqr=this.two;let a=this.pow(this.nqr,e);for(;!this.eq(a,this.negone);)this.nqr=this.nqr+this.one,a=this.pow(this.nqr,e);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),z(this),this.FFT=new D(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,e){let a;if(e?16==e&&(a=BigInt("0x"+t)):a=BigInt(t),a<0){let t=-a;return t>=this.p&&(t%=this.p),this.p-t}return a>=this.p?a%this.p:a}add(t,e){const a=t+e;return a>=this.p?a-this.p:a}sub(t,e){return t>=e?t-e:this.p-e+t}neg(t){return t?this.p-t:t}mul(t,e){return t*e%this.p}mulScalar(t,e){return t*this.e(e)%this.p}square(t){return t*t%this.p}eq(t,e){return t==e}neq(t,e){return t!=e}lt(t,e){return(t>this.half?t-this.p:t)<(e>this.half?e-this.p:e)}gt(t,e){return(t>this.half?t-this.p:t)>(e>this.half?e-this.p:e)}leq(t,e){return(t>this.half?t-this.p:t)<=(e>this.half?e-this.p:e)}geq(t,e){return(t>this.half?t-this.p:t)>=(e>this.half?e-this.p:e)}div(t,e){return this.mul(t,this.inv(e))}idiv(t,e){if(!e)throw new Error("Division by zero");return t/e}inv(t){if(!t)throw new Error("Division by zero");let e=this.zero,a=this.p,i=this.one,o=t%this.p;for(;o;){let t=a/o;[e,i]=[i,e-t*i],[a,o]=[o,a-t*o]}return e<this.zero&&(e+=this.p),e}mod(t,e){return t%e}pow(t,e){return O(this,t,e)}exp(t,e){return O(this,t,e)}band(t,e){const a=t&e&this.mask;return a>=this.p?a-this.p:a}bor(t,e){const a=(t|e)&this.mask;return a>=this.p?a-this.p:a}bxor(t,e){const a=(t^e)&this.mask;return a>=this.p?a-this.p:a}bnot(t){const e=t^this.mask;return e>=this.p?e-this.p:e}shl(t,e){if(Number(e)<this.bitLength){const a=t<<e&this.mask;return a>=this.p?a-this.p:a}{const a=this.p-e;return Number(a)<this.bitLength?t>>a:this.zero}}shr(t,e){if(Number(e)<this.bitLength)return t>>e;{const a=this.p-e;if(Number(a)<this.bitLength){const e=t<<a&this.mask;return e>=this.p?e-this.p:e}return 0}}land(t,e){return t&&e?this.one:this.zero}lor(t,e){return t||e?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let e=this.s,a=this.nqr_to_t,i=this.pow(t,this.t),o=this.pow(t,this.add(this.t,this.one)>>this.one);for(;i!=this.one;){let t=this.square(i),n=1;for(;t!=this.one;)n++,t=this.square(t);let c=a;for(let t=0;t<e-n-1;t++)c=this.square(c);e=n,a=this.square(c),i=this.mul(i,a),o=this.mul(o,c)}return o>this.p>>this.one&&(o=this.neg(o)),o}normalize(t,e){if((t=BigInt(t,e))<0){let e=-t;return e>=this.p&&(e%=this.p),this.p-e}return t>=this.p?t%this.p:t}random(){const t=2*this.bitLength/8;let e=this.zero;for(let a=0;a<t;a++)e=(e<<BigInt(8))+BigInt(T(1)[0]);return e%this.p}toString(t,e){let a;if(e=e||10,t>this.half&&10==e){a="-"+(this.p-t).toString(e)}else a=t.toString(e);return a}isZero(t){return t==this.zero}fromRng(t){let e;do{e=this.zero;for(let a=0;a<this.n64;a++)e+=t.nextU64()<<BigInt(64*a);e&=this.mask}while(e>=this.p);return e=e*this.Ri%this.p,e}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,e,a){F(t,e,a,8*this.n64)}toRprBE(t,e,a){x(t,e,a,8*this.n64)}toRprBEM(t,e,a){return this.toRprBE(t,e,this.mul(this.R,a))}toRprLEM(t,e,a){return this.toRprLE(t,e,this.mul(this.R,a))}fromRprLE(t,e){return E(t,e,this.n8)}fromRprBE(t,e){return B(t,e,this.n8)}fromRprLEM(t,e){return this.mul(this.fromRprLE(t,e),this.Ri)}fromRprBEM(t,e){return this.mul(this.fromRprBE(t,e),this.Ri)}toObject(t){return t}}var j="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},H={bigInt2BytesLE:function(t,e){const a=Array(e);let i=BigInt(t);for(let t=0;t<e;t++)a[t]=Number(0xFFn&i),i>>=8n;return a},bigInt2U32LE:function(t,e){const a=Array(e);let i=BigInt(t);for(let t=0;t<e;t++)a[t]=Number(0xFFFFFFFFn&i),i>>=32n;return a},isOcamNum:function(t){return!!Array.isArray(t)&&(3==t.length&&("number"==typeof t[0]&&("number"==typeof t[1]&&!!Array.isArray(t[2]))))}},$=function(t,e,a,i,o,n,c){const r=t.addFunction(e);r.addParam("base","i32"),r.addParam("scalar","i32"),r.addParam("scalarLength","i32"),r.addParam("r","i32"),r.addLocal("i","i32"),r.addLocal("b","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(a));r.addCode(l.if(l.i32_eqz(l.getLocal("scalarLength")),[...l.call(c,l.getLocal("r")),...l.ret([])])),r.addCode(l.call(n,l.getLocal("base"),s)),r.addCode(l.call(c,l.getLocal("r"))),r.addCode(l.setLocal("i",l.getLocal("scalarLength"))),r.addCode(l.block(l.loop(l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.setLocal("b",l.i32_load8_u(l.i32_add(l.getLocal("scalar"),l.getLocal("i")))),...function(){const t=[];for(let e=0;e<8;e++)t.push(...l.call(o,l.getLocal("r"),l.getLocal("r")),...l.if(l.i32_ge_u(l.getLocal("b"),l.i32_const(128>>e)),[...l.setLocal("b",l.i32_sub(l.getLocal("b"),l.i32_const(128>>e))),...l.call(i,l.getLocal("r"),s,l.getLocal("r"))]));return t}(),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.br(0))))},Y=function(t,e){const a=8*t.modules[e].n64,i=t.addFunction(e+"_batchInverse");i.addParam("pIn","i32"),i.addParam("inStep","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addParam("outStep","i32"),i.addLocal("itAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(a));i.addCode(o.setLocal("itAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("itAux"),o.i32_mul(o.i32_add(o.getLocal("n"),o.i32_const(1)),o.i32_const(a))))),i.addCode(o.call(e+"_one",o.getLocal("itAux")),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(e+"_isZero",o.getLocal("itIn")),o.call(e+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(a)),o.getLocal("itAux")),o.call(e+"_mul",o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(a)),o.getLocal("itAux"))),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("itOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("outStep")))),o.call(e+"_inverse",o.getLocal("itAux"),o.getLocal("itAux")),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.if(o.call(e+"_isZero",o.getLocal("itIn")),[...o.call(e+"_copy",o.getLocal("itAux"),o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),...o.call(e+"_zero",o.getLocal("itOut"))],[...o.call(e+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(a)),n),...o.call(e+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),...o.call(e+"_mul",o.getLocal("itAux"),n,o.getLocal("itOut"))]),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itOut",o.i32_sub(o.getLocal("itOut"),o.getLocal("outStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),i.addCode(o.i32_store(o.i32_const(0),o.getLocal("itAux")))};var W=function(t,e,a,i,o,n){void 0===n&&(n=i<o);const c=t.addFunction(e);c.addParam("pIn","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn","i32"),c.addLocal("itOut","i32");const r=c.getCodeBuilder();n?c.addCode(r.setLocal("itIn",r.i32_add(r.getLocal("pIn"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(i)))),r.setLocal("itOut",r.i32_add(r.getLocal("pOut"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(o)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(a,r.getLocal("itIn"),r.getLocal("itOut")),r.setLocal("itIn",r.i32_sub(r.getLocal("itIn"),r.i32_const(i))),r.setLocal("itOut",r.i32_sub(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0)))):c.addCode(r.setLocal("itIn",r.getLocal("pIn")),r.setLocal("itOut",r.getLocal("pOut")),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(a,r.getLocal("itIn"),r.getLocal("itOut")),r.setLocal("itIn",r.i32_add(r.getLocal("itIn"),r.i32_const(i))),r.setLocal("itOut",r.i32_add(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))};var Z=function(t,e,a,i,o,n){void 0===n&&(n=i<o);const c=t.addFunction(e);c.addParam("pIn1","i32"),c.addParam("pIn2","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn1","i32"),c.addLocal("itIn2","i32"),c.addLocal("itOut","i32");const r=c.getCodeBuilder();n?c.addCode(r.setLocal("itIn1",r.i32_add(r.getLocal("pIn1"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(i)))),r.setLocal("itIn2",r.i32_add(r.getLocal("pIn2"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(i)))),r.setLocal("itOut",r.i32_add(r.getLocal("pOut"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(o)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(a,r.getLocal("itIn1"),r.getLocal("itIn2"),r.getLocal("itOut")),r.setLocal("itIn1",r.i32_sub(r.getLocal("itIn1"),r.i32_const(i))),r.setLocal("itIn2",r.i32_sub(r.getLocal("itIn2"),r.i32_const(i))),r.setLocal("itOut",r.i32_sub(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0)))):c.addCode(r.setLocal("itIn1",r.getLocal("pIn1")),r.setLocal("itIn2",r.getLocal("pIn2")),r.setLocal("itOut",r.getLocal("pOut")),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(a,r.getLocal("itIn1"),r.getLocal("itIn2"),r.getLocal("itOut")),r.setLocal("itIn1",r.i32_add(r.getLocal("itIn1"),r.i32_const(i))),r.setLocal("itIn2",r.i32_add(r.getLocal("itIn2"),r.i32_const(i))),r.setLocal("itOut",r.i32_add(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))};var J={};function X(t,e){return t===e?0:t>e?1:-1}function tt(t){return t*t}function et(t){return t%2n!==0n}function at(t){return t%2n===0n}function it(t){return t<0n}function ot(t){return t>0n}function nt(t){return it(t)?t.toString(2).length-1:t.toString(2).length}function ct(t){return t<0n?-t:t}function rt(t){return 1n===ct(t)}function lt(t,e){for(var a,i,o,n=0n,c=1n,r=e,l=ct(t);0n!==l;)a=r/l,i=n,o=r,n=c,r=l,c=i-a*c,l=o-a*l;if(!rt(r))throw new Error(t.toString()+" and "+e.toString()+" are not co-prime");return-1===X(n,0n)&&(n+=e),it(t)?-n:n}function st(t,e,a){if(0n===a)throw new Error("Cannot take modPow with modulus 0");var i=1n,o=t%a;for(it(e)&&(e*=-1n,o=lt(o,a));ot(e);){if(0n===o)return 0n;et(e)&&(i=i*o%a),e/=2n,o=tt(o)%a}return i}function dt(t,e){return 0n!==e&&(!!rt(e)||(0===function(t,e){return(t=t>=0n?t:-t)===(e=e>=0n?e:-e)?0:t>e?1:-1}(e,2n)?at(t):t%e===0n))}function ut(t,e){for(var a,i,o,n=function(t){return t-1n}(t),c=n,r=0;at(c);)c/=2n,r++;t:for(i=0;i<e.length;i++)if(!(t<e[i]||rt(o=st(BigInt(e[i]),c,t))||o===n)){for(a=r-1;0!=a;a--){if(rt(o=tt(o)%t))return!1;if(o===n)continue t}return!1}return!0}J.bitLength=nt,J.isOdd=et,J.isNegative=it,J.abs=ct,J.isUnit=rt,J.compare=X,J.modInv=lt,J.modPow=st,J.isPrime=function(t){var e=function(t){var e=ct(t);return!rt(e)&&(2n===e||3n===e||5n===e||!(at(e)||dt(e,3n)||dt(e,5n))&&(e<49n||void 0))}(t);if(void 0!==e)return e;var a=ct(t),i=nt(a);if(i<=64)return ut(a,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*Number(i),n=Math.ceil(o),c=[],r=0;r<n;r++)c.push(BigInt(r+2));return ut(a,c)},J.square=tt;const gt=function(t,e,a){const i=a||"int";if(t.modules[i])return i;t.modules[i]={};const o=2*e,n=8*e;return function(){const a=t.addFunction(i+"_copy");a.addParam("px","i32"),a.addParam("pr","i32");const o=a.getCodeBuilder();for(let t=0;t<e;t++)a.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_load(o.getLocal("px"),8*t)))}(),function(){const a=t.addFunction(i+"_zero");a.addParam("pr","i32");const o=a.getCodeBuilder();for(let t=0;t<e;t++)a.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_const(0)))}(),function(){const a=t.addFunction(i+"_isZero");a.addParam("px","i32"),a.setReturnType("i32");const o=a.getCodeBuilder();a.addCode(function t(e){return 0==e?o.ret(o.i64_eqz(o.i64_load(o.getLocal("px")))):o.if(o.i64_eqz(o.i64_load(o.getLocal("px"),8*e)),t(e-1),o.ret(o.i32_const(0)))}(e-1)),a.addCode(o.ret(o.i32_const(0)))}(),function(){const a=t.addFunction(i+"_one");a.addParam("pr","i32");const o=a.getCodeBuilder();a.addCode(o.i64_store(o.getLocal("pr"),0,o.i64_const(1)));for(let t=1;t<e;t++)a.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_const(0)))}(),function(){const a=t.addFunction(i+"_eq");a.addParam("px","i32"),a.addParam("py","i32"),a.setReturnType("i32");const o=a.getCodeBuilder();a.addCode(function t(e){return 0==e?o.ret(o.i64_eq(o.i64_load(o.getLocal("px")),o.i64_load(o.getLocal("py")))):o.if(o.i64_eq(o.i64_load(o.getLocal("px"),8*e),o.i64_load(o.getLocal("py"),8*e)),t(e-1),o.ret(o.i32_const(0)))}(e-1)),a.addCode(o.ret(o.i32_const(0)))}(),function(){const a=t.addFunction(i+"_gte");a.addParam("px","i32"),a.addParam("py","i32"),a.setReturnType("i32");const o=a.getCodeBuilder();a.addCode(function t(e){return 0==e?o.ret(o.i64_ge_u(o.i64_load(o.getLocal("px")),o.i64_load(o.getLocal("py")))):o.if(o.i64_lt_u(o.i64_load(o.getLocal("px"),8*e),o.i64_load(o.getLocal("py"),8*e)),o.ret(o.i32_const(0)),o.if(o.i64_gt_u(o.i64_load(o.getLocal("px"),8*e),o.i64_load(o.getLocal("py"),8*e)),o.ret(o.i32_const(1)),t(e-1)))}(e-1)),a.addCode(o.ret(o.i32_const(0)))}(),function(){const e=t.addFunction(i+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.setReturnType("i32"),e.addLocal("c","i64");const a=e.getCodeBuilder();e.addCode(a.setLocal("c",a.i64_add(a.i64_load32_u(a.getLocal("x")),a.i64_load32_u(a.getLocal("y"))))),e.addCode(a.i64_store32(a.getLocal("r"),a.getLocal("c")));for(let t=1;t<o;t++)e.addCode(a.setLocal("c",a.i64_add(a.i64_add(a.i64_load32_u(a.getLocal("x"),4*t),a.i64_load32_u(a.getLocal("y"),4*t)),a.i64_shr_u(a.getLocal("c"),a.i64_const(32))))),e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.getLocal("c")));e.addCode(a.i32_wrap_i64(a.i64_shr_u(a.getLocal("c"),a.i64_const(32))))}(),function(){const e=t.addFunction(i+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.setReturnType("i32"),e.addLocal("c","i64");const a=e.getCodeBuilder();e.addCode(a.setLocal("c",a.i64_sub(a.i64_load32_u(a.getLocal("x")),a.i64_load32_u(a.getLocal("y"))))),e.addCode(a.i64_store32(a.getLocal("r"),a.i64_and(a.getLocal("c"),a.i64_const("0xFFFFFFFF"))));for(let t=1;t<o;t++)e.addCode(a.setLocal("c",a.i64_add(a.i64_sub(a.i64_load32_u(a.getLocal("x"),4*t),a.i64_load32_u(a.getLocal("y"),4*t)),a.i64_shr_s(a.getLocal("c"),a.i64_const(32))))),e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.i64_and(a.getLocal("c"),a.i64_const("0xFFFFFFFF"))));e.addCode(a.i32_wrap_i64(a.i64_shr_s(a.getLocal("c"),a.i64_const(32))))}(),function(){const e=t.addFunction(i+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64");for(let t=0;t<o;t++)e.addLocal("x"+t,"i64"),e.addLocal("y"+t,"i64");const a=e.getCodeBuilder(),n=[],c=[];function r(t,e){let i,o;return n[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),n[t]=!0),c[e]?o=a.getLocal("y"+e):(o=a.teeLocal("y"+e,a.i64_load32_u(a.getLocal("y"),4*e)),c[e]=!0),a.i64_mul(i,o)}let l="c0",s="c1";for(let t=0;t<2*o-1;t++){for(let i=Math.max(0,t-o+1);i<=t&&i<o;i++){const o=t-i;e.addCode(a.setLocal(l,a.i64_add(a.i64_and(a.getLocal(l),a.i64_const(4294967295)),r(i,o)))),e.addCode(a.setLocal(s,a.i64_add(a.getLocal(s),a.i64_shr_u(a.getLocal(l),a.i64_const(32)))))}e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.getLocal(l))),[l,s]=[s,l],e.addCode(a.setLocal(s,a.i64_shr_u(a.getLocal(l),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),4*o*2-4,a.getLocal(l)))}(),function(){const e=t.addFunction(i+"_square");e.addParam("x","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("c0_old","i64"),e.addLocal("c1_old","i64");for(let t=0;t<o;t++)e.addLocal("x"+t,"i64");const a=e.getCodeBuilder(),n=[];function c(t,e){let i,o;return n[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),n[t]=!0),n[e]?o=a.getLocal("x"+e):(o=a.teeLocal("x"+e,a.i64_load32_u(a.getLocal("x"),4*e)),n[e]=!0),a.i64_mul(i,o)}let r="c0",l="c1",s="c0_old",d="c1_old";for(let t=0;t<2*o-1;t++){e.addCode(a.setLocal(r,a.i64_const(0)),a.setLocal(l,a.i64_const(0)));for(let i=Math.max(0,t-o+1);i<t+1>>1&&i<o;i++){const o=t-i;e.addCode(a.setLocal(r,a.i64_add(a.i64_and(a.getLocal(r),a.i64_const(4294967295)),c(i,o)))),e.addCode(a.setLocal(l,a.i64_add(a.getLocal(l),a.i64_shr_u(a.getLocal(r),a.i64_const(32)))))}e.addCode(a.setLocal(r,a.i64_shl(a.i64_and(a.getLocal(r),a.i64_const(4294967295)),a.i64_const(1)))),e.addCode(a.setLocal(l,a.i64_add(a.i64_shl(a.getLocal(l),a.i64_const(1)),a.i64_shr_u(a.getLocal(r),a.i64_const(32))))),t%2==0&&(e.addCode(a.setLocal(r,a.i64_add(a.i64_and(a.getLocal(r),a.i64_const(4294967295)),c(t>>1,t>>1)))),e.addCode(a.setLocal(l,a.i64_add(a.getLocal(l),a.i64_shr_u(a.getLocal(r),a.i64_const(32)))))),t>0&&(e.addCode(a.setLocal(r,a.i64_add(a.i64_and(a.getLocal(r),a.i64_const(4294967295)),a.i64_and(a.getLocal(s),a.i64_const(4294967295))))),e.addCode(a.setLocal(l,a.i64_add(a.i64_add(a.getLocal(l),a.i64_shr_u(a.getLocal(r),a.i64_const(32))),a.getLocal(d))))),e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.getLocal(r))),e.addCode(a.setLocal(s,a.getLocal(l)),a.setLocal(d,a.i64_shr_u(a.getLocal(s),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),4*o*2-4,a.getLocal(s)))}(),function(){const e=t.addFunction(i+"_squareOld");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(i+"_mul",a.getLocal("x"),a.getLocal("x"),a.getLocal("r")))}(),function(){!function(){const e=t.addFunction(i+"__mul1");e.addParam("px","i32"),e.addParam("y","i64"),e.addParam("pr","i32"),e.addLocal("c","i64");const a=e.getCodeBuilder();e.addCode(a.setLocal("c",a.i64_mul(a.i64_load32_u(a.getLocal("px"),0,0),a.getLocal("y")))),e.addCode(a.i64_store32(a.getLocal("pr"),0,0,a.getLocal("c")));for(let t=1;t<o;t++)e.addCode(a.setLocal("c",a.i64_add(a.i64_mul(a.i64_load32_u(a.getLocal("px"),4*t,0),a.getLocal("y")),a.i64_shr_u(a.getLocal("c"),a.i64_const(32))))),e.addCode(a.i64_store32(a.getLocal("pr"),4*t,0,a.getLocal("c")))}(),function(){const e=t.addFunction(i+"__add1");e.addParam("x","i32"),e.addParam("y","i64"),e.addLocal("c","i64"),e.addLocal("px","i32");const a=e.getCodeBuilder();e.addCode(a.setLocal("px",a.getLocal("x"))),e.addCode(a.setLocal("c",a.i64_add(a.i64_load32_u(a.getLocal("px"),0,0),a.getLocal("y")))),e.addCode(a.i64_store32(a.getLocal("px"),0,0,a.getLocal("c"))),e.addCode(a.setLocal("c",a.i64_shr_u(a.getLocal("c"),a.i64_const(32)))),e.addCode(a.block(a.loop(a.br_if(1,a.i64_eqz(a.getLocal("c"))),a.setLocal("px",a.i32_add(a.getLocal("px"),a.i32_const(4))),a.setLocal("c",a.i64_add(a.i64_load32_u(a.getLocal("px"),0,0),a.getLocal("c"))),a.i64_store32(a.getLocal("px"),0,0,a.getLocal("c")),a.setLocal("c",a.i64_shr_u(a.getLocal("c"),a.i64_const(32))),a.br(0))))}();const e=t.addFunction(i+"_div");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("c","i32"),e.addParam("r","i32"),e.addLocal("rr","i32"),e.addLocal("cc","i32"),e.addLocal("eX","i32"),e.addLocal("eY","i32"),e.addLocal("sy","i64"),e.addLocal("sx","i64"),e.addLocal("ec","i32");const a=e.getCodeBuilder(),c=a.i32_const(t.alloc(n)),r=a.i32_const(t.alloc(n)),l=a.i32_const(t.alloc(n)),s=a.getLocal("cc"),d=a.getLocal("rr"),u=t.alloc(2*n),g=a.i32_const(u),_=a.i32_const(u+n);e.addCode(a.if(a.getLocal("c"),a.setLocal("cc",a.getLocal("c")),a.setLocal("cc",r))),e.addCode(a.if(a.getLocal("r"),a.setLocal("rr",a.getLocal("r")),a.setLocal("rr",l))),e.addCode(a.call(i+"_copy",a.getLocal("x"),d)),e.addCode(a.call(i+"_copy",a.getLocal("y"),c)),e.addCode(a.call(i+"_zero",s)),e.addCode(a.call(i+"_zero",g)),e.addCode(a.setLocal("eX",a.i32_const(n-1))),e.addCode(a.setLocal("eY",a.i32_const(n-1))),e.addCode(a.block(a.loop(a.br_if(1,a.i32_or(a.i32_load8_u(a.i32_add(c,a.getLocal("eY")),0,0),a.i32_eq(a.getLocal("eY"),a.i32_const(3)))),a.setLocal("eY",a.i32_sub(a.getLocal("eY"),a.i32_const(1))),a.br(0)))),e.addCode(a.setLocal("sy",a.i64_add(a.i64_load32_u(a.i32_sub(a.i32_add(c,a.getLocal("eY")),a.i32_const(3)),0,0),a.i64_const(1)))),e.addCode(a.if(a.i64_eq(a.getLocal("sy"),a.i64_const(1)),a.drop(a.i64_div_u(a.i64_const(0),a.i64_const(0))))),e.addCode(a.block(a.loop(a.block(a.loop(a.br_if(1,a.i32_or(a.i32_load8_u(a.i32_add(d,a.getLocal("eX")),0,0),a.i32_eq(a.getLocal("eX"),a.i32_const(7)))),a.setLocal("eX",a.i32_sub(a.getLocal("eX"),a.i32_const(1))),a.br(0))),a.setLocal("sx",a.i64_load(a.i32_sub(a.i32_add(d,a.getLocal("eX")),a.i32_const(7)),0,0)),a.setLocal("sx",a.i64_div_u(a.getLocal("sx"),a.getLocal("sy"))),a.setLocal("ec",a.i32_sub(a.i32_sub(a.getLocal("eX"),a.getLocal("eY")),a.i32_const(4))),a.block(a.loop(a.br_if(1,a.i32_and(a.i64_eqz(a.i64_and(a.getLocal("sx"),a.i64_const("0xFFFFFFFF00000000"))),a.i32_ge_s(a.getLocal("ec"),a.i32_const(0)))),a.setLocal("sx",a.i64_shr_u(a.getLocal("sx"),a.i64_const(8))),a.setLocal("ec",a.i32_add(a.getLocal("ec"),a.i32_const(1))),a.br(0))),a.if(a.i64_eqz(a.getLocal("sx")),[...a.br_if(2,a.i32_eqz(a.call(i+"_gte",d,c))),...a.setLocal("sx",a.i64_const(1)),...a.setLocal("ec",a.i32_const(0))]),a.call(i+"__mul1",c,a.getLocal("sx"),_),a.drop(a.call(i+"_sub",d,a.i32_sub(_,a.getLocal("ec")),d)),a.call(i+"__add1",a.i32_add(s,a.getLocal("ec")),a.getLocal("sx")),a.br(0))))}(),function(){const e=t.addFunction(i+"_inverseMod");e.addParam("px","i32"),e.addParam("pm","i32"),e.addParam("pr","i32"),e.addLocal("t","i32"),e.addLocal("newt","i32"),e.addLocal("r","i32"),e.addLocal("qq","i32"),e.addLocal("qr","i32"),e.addLocal("newr","i32"),e.addLocal("swp","i32"),e.addLocal("x","i32"),e.addLocal("signt","i32"),e.addLocal("signnewt","i32"),e.addLocal("signx","i32");const a=e.getCodeBuilder(),o=a.i32_const(t.alloc(n)),c=a.i32_const(t.alloc(n)),r=a.i32_const(t.alloc(n)),l=a.i32_const(t.alloc(n)),s=a.i32_const(t.alloc(n)),d=a.i32_const(t.alloc(n)),u=a.i32_const(t.alloc(2*n)),g=a.i32_const(t.alloc(n));e.addCode(a.setLocal("t",o),a.call(i+"_zero",o),a.setLocal("signt",a.i32_const(0))),e.addCode(a.setLocal("r",c),a.call(i+"_copy",a.getLocal("pm"),c)),e.addCode(a.setLocal("newt",r),a.call(i+"_one",r),a.setLocal("signnewt",a.i32_const(0))),e.addCode(a.setLocal("newr",l),a.call(i+"_copy",a.getLocal("px"),l)),e.addCode(a.setLocal("qq",s)),e.addCode(a.setLocal("qr",d)),e.addCode(a.setLocal("x",g)),e.addCode(a.block(a.loop(a.br_if(1,a.call(i+"_isZero",a.getLocal("newr"))),a.call(i+"_div",a.getLocal("r"),a.getLocal("newr"),a.getLocal("qq"),a.getLocal("qr")),a.call(i+"_mul",a.getLocal("qq"),a.getLocal("newt"),u),a.if(a.getLocal("signt"),a.if(a.getLocal("signnewt"),a.if(a.call(i+"_gte",u,a.getLocal("t")),[...a.drop(a.call(i+"_sub",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(0))],[...a.drop(a.call(i+"_sub",a.getLocal("t"),u,a.getLocal("x"))),...a.setLocal("signx",a.i32_const(1))]),[...a.drop(a.call(i+"_add",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(1))]),a.if(a.getLocal("signnewt"),[...a.drop(a.call(i+"_add",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(0))],a.if(a.call(i+"_gte",a.getLocal("t"),u),[...a.drop(a.call(i+"_sub",a.getLocal("t"),u,a.getLocal("x"))),...a.setLocal("signx",a.i32_const(0))],[...a.drop(a.call(i+"_sub",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(1))]))),a.setLocal("swp",a.getLocal("t")),a.setLocal("t",a.getLocal("newt")),a.setLocal("newt",a.getLocal("x")),a.setLocal("x",a.getLocal("swp")),a.setLocal("signt",a.getLocal("signnewt")),a.setLocal("signnewt",a.getLocal("signx")),a.setLocal("swp",a.getLocal("r")),a.setLocal("r",a.getLocal("newr")),a.setLocal("newr",a.getLocal("qr")),a.setLocal("qr",a.getLocal("swp")),a.br(0)))),e.addCode(a.if(a.getLocal("signt"),a.drop(a.call(i+"_sub",a.getLocal("pm"),a.getLocal("t"),a.getLocal("pr"))),a.call(i+"_copy",a.getLocal("t"),a.getLocal("pr"))))}(),t.exportFunction(i+"_copy"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_gte"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_square"),t.exportFunction(i+"_squareOld"),t.exportFunction(i+"_div"),t.exportFunction(i+"_inverseMod"),i},_t=H,ft=$,ht=Y,pt=W,mt=Z,{bitLength:Lt,modInv:wt,modPow:At,isPrime:bt,isOdd:yt,square:It}=J;var Ct=function(t,e,a,i){const o=BigInt(e),n=Math.floor((Lt(o-1n)-1)/64)+1,c=2*n,r=8*n,l=a||"f1m";if(t.modules[l])return l;const s=gt(t,n,i),d=t.alloc(r,_t.bigInt2BytesLE(o,r)),u=t.alloc(_t.bigInt2BytesLE(It(1n<<BigInt(64*n))%o,r)),g=t.alloc(_t.bigInt2BytesLE((1n<<BigInt(64*n))%o,r)),_=t.alloc(_t.bigInt2BytesLE(0n,r)),f=o-1n,h=f>>1n,p=t.alloc(r,_t.bigInt2BytesLE(h,r)),m=h+1n,L=t.alloc(r,_t.bigInt2BytesLE(m,r));t.modules[l]={pq:d,pR2:u,n64:n,q:o,pOne:g,pZero:_,pePlusOne:L};let w=2n;if(bt(o))for(;At(w,h,o)!==f;)w+=1n;let A=0,b=f;for(;!yt(b)&&0n!==b;)A++,b>>=1n;const y=t.alloc(r,_t.bigInt2BytesLE(b,r)),I=At(w,b,o),C=t.alloc(_t.bigInt2BytesLE((I<<BigInt(64*n))%o,r)),F=b+1n>>1n,x=t.alloc(r,_t.bigInt2BytesLE(F,r));return t.exportFunction(s+"_copy",l+"_copy"),t.exportFunction(s+"_zero",l+"_zero"),t.exportFunction(s+"_isZero",l+"_isZero"),t.exportFunction(s+"_eq",l+"_eq"),function(){const e=t.addFunction(l+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const a=e.getCodeBuilder();e.addCode(a.ret(a.call(s+"_eq",a.getLocal("x"),a.i32_const(g))))}(),function(){const e=t.addFunction(l+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.if(a.call(s+"_add",a.getLocal("x"),a.getLocal("y"),a.getLocal("r")),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))),a.if(a.call(s+"_gte",a.getLocal("r"),a.i32_const(d)),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))))))}(),function(){const e=t.addFunction(l+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.if(a.call(s+"_sub",a.getLocal("x"),a.getLocal("y"),a.getLocal("r")),a.drop(a.call(s+"_add",a.getLocal("r"),a.i32_const(d),a.getLocal("r")))))}(),function(){const e=t.addFunction(l+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(l+"_sub",a.i32_const(_),a.getLocal("x"),a.getLocal("r")))}(),function(){const e=t.alloc(c*c*8),a=t.addFunction(l+"_mReduct");a.addParam("t","i32"),a.addParam("r","i32"),a.addLocal("np32","i64"),a.addLocal("c","i64"),a.addLocal("m","i64");const i=a.getCodeBuilder(),n=Number(0x100000000n-wt(o,0x100000000n));a.addCode(i.setLocal("np32",i.i64_const(n)));for(let t=0;t<c;t++){a.addCode(i.setLocal("c",i.i64_const(0))),a.addCode(i.setLocal("m",i.i64_and(i.i64_mul(i.i64_load32_u(i.getLocal("t"),4*t),i.getLocal("np32")),i.i64_const("0xFFFFFFFF"))));for(let e=0;e<c;e++)a.addCode(i.setLocal("c",i.i64_add(i.i64_add(i.i64_load32_u(i.getLocal("t"),4*(t+e)),i.i64_shr_u(i.getLocal("c"),i.i64_const(32))),i.i64_mul(i.i64_load32_u(i.i32_const(d),4*e),i.getLocal("m"))))),a.addCode(i.i64_store32(i.getLocal("t"),4*(t+e),i.getLocal("c")));a.addCode(i.i64_store32(i.i32_const(e),4*t,i.i64_shr_u(i.getLocal("c"),i.i64_const(32))))}a.addCode(i.call(l+"_add",i.i32_const(e),i.i32_add(i.getLocal("t"),i.i32_const(4*c)),i.getLocal("r")))}(),function(){const e=t.addFunction(l+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("np32","i64");for(let t=0;t<c;t++)e.addLocal("x"+t,"i64"),e.addLocal("y"+t,"i64"),e.addLocal("m"+t,"i64"),e.addLocal("q"+t,"i64");const a=e.getCodeBuilder(),i=Number(0x100000000n-wt(o,0x100000000n));e.addCode(a.setLocal("np32",a.i64_const(i)));const n=[],r=[],u=[];function g(t,e){let i,o;return n[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),n[t]=!0),r[e]?o=a.getLocal("y"+e):(o=a.teeLocal("y"+e,a.i64_load32_u(a.getLocal("y"),4*e)),r[e]=!0),a.i64_mul(i,o)}function _(t,e){let i,o;return u[t]?i=a.getLocal("q"+t):(i=a.teeLocal("q"+t,a.i64_load32_u(a.i32_const(0),d+4*t)),u[t]=!0),o=a.getLocal("m"+e),a.i64_mul(i,o)}let f="c0",h="c1";for(let t=0;t<2*c-1;t++){for(let i=Math.max(0,t-c+1);i<=t&&i<c;i++){const o=t-i;e.addCode(a.setLocal(f,a.i64_add(a.i64_and(a.getLocal(f),a.i64_const(4294967295)),g(i,o)))),e.addCode(a.setLocal(h,a.i64_add(a.getLocal(h),a.i64_shr_u(a.getLocal(f),a.i64_const(32)))))}for(let i=Math.max(1,t-c+1);i<=t&&i<c;i++){const o=t-i;e.addCode(a.setLocal(f,a.i64_add(a.i64_and(a.getLocal(f),a.i64_const(4294967295)),_(i,o)))),e.addCode(a.setLocal(h,a.i64_add(a.getLocal(h),a.i64_shr_u(a.getLocal(f),a.i64_const(32)))))}t<c&&(e.addCode(a.setLocal("m"+t,a.i64_and(a.i64_mul(a.i64_and(a.getLocal(f),a.i64_const(4294967295)),a.getLocal("np32")),a.i64_const("0xFFFFFFFF")))),e.addCode(a.setLocal(f,a.i64_add(a.i64_and(a.getLocal(f),a.i64_const(4294967295)),_(0,t)))),e.addCode(a.setLocal(h,a.i64_add(a.getLocal(h),a.i64_shr_u(a.getLocal(f),a.i64_const(32)))))),t>=c&&e.addCode(a.i64_store32(a.getLocal("r"),4*(t-c),a.getLocal(f))),[f,h]=[h,f],e.addCode(a.setLocal(h,a.i64_shr_u(a.getLocal(f),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),4*c-4,a.getLocal(f))),e.addCode(a.if(a.i32_wrap_i64(a.getLocal(h)),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))),a.if(a.call(s+"_gte",a.getLocal("r"),a.i32_const(d)),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))))))}(),function(){const e=t.addFunction(l+"_square");e.addParam("x","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("c0_old","i64"),e.addLocal("c1_old","i64"),e.addLocal("np32","i64");for(let t=0;t<c;t++)e.addLocal("x"+t,"i64"),e.addLocal("m"+t,"i64"),e.addLocal("q"+t,"i64");const a=e.getCodeBuilder(),i=Number(0x100000000n-wt(o,0x100000000n));e.addCode(a.setLocal("np32",a.i64_const(i)));const n=[],r=[];function u(t,e){let i,o;return n[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),n[t]=!0),n[e]?o=a.getLocal("x"+e):(o=a.teeLocal("x"+e,a.i64_load32_u(a.getLocal("x"),4*e)),n[e]=!0),a.i64_mul(i,o)}function g(t,e){let i,o;return r[t]?i=a.getLocal("q"+t):(i=a.teeLocal("q"+t,a.i64_load32_u(a.i32_const(0),d+4*t)),r[t]=!0),o=a.getLocal("m"+e),a.i64_mul(i,o)}let _="c0",f="c1",h="c0_old",p="c1_old";for(let t=0;t<2*c-1;t++){e.addCode(a.setLocal(_,a.i64_const(0)),a.setLocal(f,a.i64_const(0)));for(let i=Math.max(0,t-c+1);i<t+1>>1&&i<c;i++){const o=t-i;e.addCode(a.setLocal(_,a.i64_add(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),u(i,o)))),e.addCode(a.setLocal(f,a.i64_add(a.getLocal(f),a.i64_shr_u(a.getLocal(_),a.i64_const(32)))))}e.addCode(a.setLocal(_,a.i64_shl(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),a.i64_const(1)))),e.addCode(a.setLocal(f,a.i64_add(a.i64_shl(a.getLocal(f),a.i64_const(1)),a.i64_shr_u(a.getLocal(_),a.i64_const(32))))),t%2==0&&(e.addCode(a.setLocal(_,a.i64_add(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),u(t>>1,t>>1)))),e.addCode(a.setLocal(f,a.i64_add(a.getLocal(f),a.i64_shr_u(a.getLocal(_),a.i64_const(32)))))),t>0&&(e.addCode(a.setLocal(_,a.i64_add(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),a.i64_and(a.getLocal(h),a.i64_const(4294967295))))),e.addCode(a.setLocal(f,a.i64_add(a.i64_add(a.getLocal(f),a.i64_shr_u(a.getLocal(_),a.i64_const(32))),a.getLocal(p)))));for(let i=Math.max(1,t-c+1);i<=t&&i<c;i++){const o=t-i;e.addCode(a.setLocal(_,a.i64_add(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),g(i,o)))),e.addCode(a.setLocal(f,a.i64_add(a.getLocal(f),a.i64_shr_u(a.getLocal(_),a.i64_const(32)))))}t<c&&(e.addCode(a.setLocal("m"+t,a.i64_and(a.i64_mul(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),a.getLocal("np32")),a.i64_const("0xFFFFFFFF")))),e.addCode(a.setLocal(_,a.i64_add(a.i64_and(a.getLocal(_),a.i64_const(4294967295)),g(0,t)))),e.addCode(a.setLocal(f,a.i64_add(a.getLocal(f),a.i64_shr_u(a.getLocal(_),a.i64_const(32)))))),t>=c&&e.addCode(a.i64_store32(a.getLocal("r"),4*(t-c),a.getLocal(_))),e.addCode(a.setLocal(h,a.getLocal(f)),a.setLocal(p,a.i64_shr_u(a.getLocal(h),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),4*c-4,a.getLocal(h))),e.addCode(a.if(a.i32_wrap_i64(a.getLocal(p)),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))),a.if(a.call(s+"_gte",a.getLocal("r"),a.i32_const(d)),a.drop(a.call(s+"_sub",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))))))}(),function(){const e=t.addFunction(l+"_squareOld");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(l+"_mul",a.getLocal("x"),a.getLocal("x"),a.getLocal("r")))}(),function(){const e=t.addFunction(l+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(l+"_mul",a.getLocal("x"),a.i32_const(u),a.getLocal("r")))}(),function(){const e=t.alloc(2*r),a=t.addFunction(l+"_fromMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const i=a.getCodeBuilder();a.addCode(i.call(s+"_copy",i.getLocal("x"),i.i32_const(e))),a.addCode(i.call(s+"_zero",i.i32_const(e+r))),a.addCode(i.call(l+"_mReduct",i.i32_const(e),i.getLocal("r")))}(),function(){const e=t.addFunction(l+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(r));e.addCode(a.call(l+"_fromMontgomery",a.getLocal("x"),i),a.call(s+"_gte",i,a.i32_const(L)))}(),function(){const e=t.addFunction(l+"_sign");e.addParam("x","i32"),e.setReturnType("i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(r));e.addCode(a.if(a.call(s+"_isZero",a.getLocal("x")),a.ret(a.i32_const(0))),a.call(l+"_fromMontgomery",a.getLocal("x"),i),a.if(a.call(s+"_gte",i,a.i32_const(L)),a.ret(a.i32_const(-1))),a.ret(a.i32_const(1)))}(),function(){const e=t.addFunction(l+"_inverse");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(l+"_fromMontgomery",a.getLocal("x"),a.getLocal("r"))),e.addCode(a.call(s+"_inverseMod",a.getLocal("r"),a.i32_const(d),a.getLocal("r"))),e.addCode(a.call(l+"_toMontgomery",a.getLocal("r"),a.getLocal("r")))}(),function(){const e=t.addFunction(l+"_one");e.addParam("pr","i32");const a=e.getCodeBuilder();e.addCode(a.call(s+"_copy",a.i32_const(g),a.getLocal("pr")))}(),function(){const e=t.addFunction(l+"_load");e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32"),e.addLocal("p","i32"),e.addLocal("l","i32"),e.addLocal("i","i32"),e.addLocal("j","i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(r)),o=t.alloc(r),n=a.i32_const(o);e.addCode(a.call(s+"_zero",a.getLocal("r")),a.setLocal("i",a.i32_const(r)),a.setLocal("p",a.getLocal("scalar")),a.block(a.loop(a.br_if(1,a.i32_gt_u(a.getLocal("i"),a.getLocal("scalarLen"))),a.if(a.i32_eq(a.getLocal("i"),a.i32_const(r)),a.call(l+"_one",i),a.call(l+"_mul",i,a.i32_const(u),i)),a.call(l+"_mul",a.getLocal("p"),i,n),a.call(l+"_add",a.getLocal("r"),n,a.getLocal("r")),a.setLocal("p",a.i32_add(a.getLocal("p"),a.i32_const(r))),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(r))),a.br(0))),a.setLocal("l",a.i32_rem_u(a.getLocal("scalarLen"),a.i32_const(r))),a.if(a.i32_eqz(a.getLocal("l")),a.ret([])),a.call(s+"_zero",n),a.setLocal("j",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("j"),a.getLocal("l"))),a.i32_store8(a.getLocal("j"),o,a.i32_load8_u(a.getLocal("p"))),a.setLocal("p",a.i32_add(a.getLocal("p"),a.i32_const(1))),a.setLocal("j",a.i32_add(a.getLocal("j"),a.i32_const(1))),a.br(0))),a.if(a.i32_eq(a.getLocal("i"),a.i32_const(r)),a.call(l+"_one",i),a.call(l+"_mul",i,a.i32_const(u),i)),a.call(l+"_mul",n,i,n),a.call(l+"_add",a.getLocal("r"),n,a.getLocal("r")))}(),function(){const e=t.addFunction(l+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(r));e.addCode(a.call(l+"_load",a.getLocal("scalar"),a.getLocal("scalarLen"),i),a.call(l+"_toMontgomery",i,i),a.call(l+"_mul",a.getLocal("x"),i,a.getLocal("r")))}(),ht(t,l),pt(t,l+"_batchToMontgomery",l+"_toMontgomery",r,r),pt(t,l+"_batchFromMontgomery",l+"_fromMontgomery",r,r),pt(t,l+"_batchNeg",l+"_neg",r,r),mt(t,l+"_batchAdd",l+"_add",r,r),mt(t,l+"_batchSub",l+"_sub",r,r),mt(t,l+"_batchMul",l+"_mul",r,r),t.exportFunction(l+"_add"),t.exportFunction(l+"_sub"),t.exportFunction(l+"_neg"),t.exportFunction(l+"_isNegative"),t.exportFunction(l+"_isOne"),t.exportFunction(l+"_sign"),t.exportFunction(l+"_mReduct"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_squareOld"),t.exportFunction(l+"_fromMontgomery"),t.exportFunction(l+"_toMontgomery"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_one"),t.exportFunction(l+"_load"),t.exportFunction(l+"_timesScalar"),ft(t,l+"_exp",r,l+"_mul",l+"_square",s+"_copy",l+"_one"),t.exportFunction(l+"_exp"),t.exportFunction(l+"_batchInverse"),bt(o)&&(!function(){const e=t.addFunction(l+"_sqrt");e.addParam("n","i32"),e.addParam("r","i32"),e.addLocal("m","i32"),e.addLocal("i","i32"),e.addLocal("j","i32");const a=e.getCodeBuilder(),i=a.i32_const(g),o=a.i32_const(t.alloc(r)),n=a.i32_const(t.alloc(r)),c=a.i32_const(t.alloc(r)),s=a.i32_const(t.alloc(r)),d=a.i32_const(t.alloc(r));e.addCode(a.if(a.call(l+"_isZero",a.getLocal("n")),a.ret(a.call(l+"_zero",a.getLocal("r")))),a.setLocal("m",a.i32_const(A)),a.call(l+"_copy",a.i32_const(C),o),a.call(l+"_exp",a.getLocal("n"),a.i32_const(y),a.i32_const(r),n),a.call(l+"_exp",a.getLocal("n"),a.i32_const(x),a.i32_const(r),c),a.block(a.loop(a.br_if(1,a.call(l+"_eq",n,i)),a.call(l+"_square",n,s),a.setLocal("i",a.i32_const(1)),a.block(a.loop(a.br_if(1,a.call(l+"_eq",s,i)),a.call(l+"_square",s,s),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))),a.call(l+"_copy",o,d),a.setLocal("j",a.i32_sub(a.i32_sub(a.getLocal("m"),a.getLocal("i")),a.i32_const(1))),a.block(a.loop(a.br_if(1,a.i32_eqz(a.getLocal("j"))),a.call(l+"_square",d,d),a.setLocal("j",a.i32_sub(a.getLocal("j"),a.i32_const(1))),a.br(0))),a.setLocal("m",a.getLocal("i")),a.call(l+"_square",d,o),a.call(l+"_mul",n,o,n),a.call(l+"_mul",c,d,c),a.br(0))),a.if(a.call(l+"_isNegative",c),a.call(l+"_neg",c,a.getLocal("r")),a.call(l+"_copy",c,a.getLocal("r"))))}(),function(){const e=t.addFunction(l+"_isSquare");e.addParam("n","i32"),e.setReturnType("i32");const a=e.getCodeBuilder(),i=a.i32_const(g),o=a.i32_const(t.alloc(r));e.addCode(a.if(a.call(l+"_isZero",a.getLocal("n")),a.ret(a.i32_const(1))),a.call(l+"_exp",a.getLocal("n"),a.i32_const(p),a.i32_const(r),o),a.call(l+"_eq",o,i))}(),t.exportFunction(l+"_sqrt"),t.exportFunction(l+"_isSquare")),t.exportFunction(l+"_batchToMontgomery"),t.exportFunction(l+"_batchFromMontgomery"),l};const Ft=Ct,{bitLength:xt}=J;var Et=function(t,e,a,i,o){const n=BigInt(e),c=Math.floor((xt(n-1n)-1)/64)+1,r=8*c,l=a||"f1";if(t.modules[l])return l;t.modules[l]={n64:c};const s=o||"int",d=Ft(t,n,i,s),u=t.modules[d].pR2,g=t.modules[d].pq,_=t.modules[d].pePlusOne;return function(){const e=t.alloc(r),a=t.addFunction(l+"_mul");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const i=a.getCodeBuilder();a.addCode(i.call(d+"_mul",i.getLocal("x"),i.getLocal("y"),i.i32_const(e))),a.addCode(i.call(d+"_mul",i.i32_const(e),i.i32_const(u),i.getLocal("r")))}(),function(){const e=t.addFunction(l+"_square");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(l+"_mul",a.getLocal("x"),a.getLocal("x"),a.getLocal("r")))}(),function(){const e=t.addFunction(l+"_inverse");e.addParam("x","i32"),e.addParam("r","i32");const a=e.getCodeBuilder();e.addCode(a.call(s+"_inverseMod",a.getLocal("x"),a.i32_const(g),a.getLocal("r")))}(),function(){const e=t.addFunction(l+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const a=e.getCodeBuilder();e.addCode(a.call(s+"_gte",a.getLocal("x"),a.i32_const(_)))}(),t.exportFunction(d+"_add",l+"_add"),t.exportFunction(d+"_sub",l+"_sub"),t.exportFunction(d+"_neg",l+"_neg"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_isNegative"),t.exportFunction(d+"_copy",l+"_copy"),t.exportFunction(d+"_zero",l+"_zero"),t.exportFunction(d+"_one",l+"_one"),t.exportFunction(d+"_isZero",l+"_isZero"),t.exportFunction(d+"_eq",l+"_eq"),l};const Bt=$,vt=Y,St=H;var Gt=function(t,e,a,i){if(t.modules[a])return a;const o=8*t.modules[i].n64,n=t.modules[i].q;return t.modules[a]={n64:2*t.modules[i].n64},function(){const e=t.addFunction(a+"_isZero");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.i32_and(n.call(i+"_isZero",c),n.call(i+"_isZero",r)))}(),function(){const e=t.addFunction(a+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.ret(n.i32_and(n.call(i+"_isOne",c),n.call(i+"_isZero",r))))}(),function(){const e=t.addFunction(a+"_zero");e.addParam("x","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.call(i+"_zero",c),n.call(i+"_zero",r))}(),function(){const e=t.addFunction(a+"_one");e.addParam("x","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.call(i+"_one",c),n.call(i+"_zero",r))}(),function(){const e=t.addFunction(a+"_copy");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_copy",c,l),n.call(i+"_copy",r,s))}(),function(){const n=t.addFunction(a+"_mul");n.addParam("x","i32"),n.addParam("y","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.getLocal("y"),d=c.i32_add(c.getLocal("y"),c.i32_const(o)),u=c.getLocal("r"),g=c.i32_add(c.getLocal("r"),c.i32_const(o)),_=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o)),h=c.i32_const(t.alloc(o)),p=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_mul",r,s,_),c.call(i+"_mul",l,d,f),c.call(i+"_add",r,l,h),c.call(i+"_add",s,d,p),c.call(i+"_mul",h,p,h),c.call(e,f,u),c.call(i+"_add",_,u,u),c.call(i+"_add",_,f,g),c.call(i+"_sub",h,g,g))}(),function(){const e=t.addFunction(a+"_mul1");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("y"),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_mul",c,l,s),n.call(i+"_mul",r,l,d))}(),function(){const n=t.addFunction(a+"_square");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.getLocal("r"),d=c.i32_add(c.getLocal("r"),c.i32_const(o)),u=c.i32_const(t.alloc(o)),g=c.i32_const(t.alloc(o)),_=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_mul",r,l,u),c.call(i+"_add",r,l,g),c.call(e,l,_),c.call(i+"_add",r,_,_),c.call(e,u,f),c.call(i+"_add",f,u,f),c.call(i+"_mul",g,_,s),c.call(i+"_sub",s,f,s),c.call(i+"_add",u,u,d))}(),function(){const e=t.addFunction(a+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("y"),s=n.i32_add(n.getLocal("y"),n.i32_const(o)),d=n.getLocal("r"),u=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_add",c,l,d),n.call(i+"_add",r,s,u))}(),function(){const e=t.addFunction(a+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("y"),s=n.i32_add(n.getLocal("y"),n.i32_const(o)),d=n.getLocal("r"),u=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_sub",c,l,d),n.call(i+"_sub",r,s,u))}(),function(){const e=t.addFunction(a+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_neg",c,l),n.call(i+"_neg",r,s))}(),function(){const e=t.addFunction(a+"_conjugate");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_copy",c,l),n.call(i+"_neg",r,s))}(),function(){const e=t.addFunction(a+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_toMontgomery",c,l),n.call(i+"_toMontgomery",r,s))}(),function(){const e=t.addFunction(a+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_fromMontgomery",c,l),n.call(i+"_fromMontgomery",r,s))}(),function(){const e=t.addFunction(a+"_eq");e.addParam("x","i32"),e.addParam("y","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("y"),s=n.i32_add(n.getLocal("y"),n.i32_const(o));e.addCode(n.i32_and(n.call(i+"_eq",c,l),n.call(i+"_eq",r,s)))}(),function(){const n=t.addFunction(a+"_inverse");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.getLocal("r"),d=c.i32_add(c.getLocal("r"),c.i32_const(o)),u=c.i32_const(t.alloc(o)),g=c.i32_const(t.alloc(o)),_=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_square",r,u),c.call(i+"_square",l,g),c.call(e,g,_),c.call(i+"_sub",u,_,_),c.call(i+"_inverse",_,f),c.call(i+"_mul",r,f,s),c.call(i+"_mul",l,f,d),c.call(i+"_neg",d,d))}(),function(){const e=t.addFunction(a+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));e.addCode(n.call(i+"_timesScalar",c,n.getLocal("scalar"),n.getLocal("scalarLen"),l),n.call(i+"_timesScalar",r,n.getLocal("scalar"),n.getLocal("scalarLen"),s))}(),function(){const e=t.addFunction(a+"_sign");e.addParam("x","i32"),e.addLocal("s","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.setLocal("s",n.call(i+"_sign",r)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.ret(n.call(i+"_sign",c)))}(),function(){const e=t.addFunction(a+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));e.addCode(n.if(n.call(i+"_isZero",r),n.ret(n.call(i+"_isNegative",c))),n.ret(n.call(i+"_isNegative",r)))}(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_mul1"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_conjugate"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),vt(t,a),Bt(t,a+"_exp",2*o,a+"_mul",a+"_square",a+"_copy",a+"_one"),function(){const e=t.addFunction(a+"_sqrt");e.addParam("a","i32"),e.addParam("pr","i32");const c=e.getCodeBuilder(),r=c.i32_const(t.alloc(St.bigInt2BytesLE((BigInt(n||0)-3n)/4n,o))),l=c.i32_const(t.alloc(St.bigInt2BytesLE((BigInt(n||0)-1n)/2n,o))),s=c.getLocal("a"),d=c.i32_const(t.alloc(2*o)),u=c.i32_const(t.alloc(2*o)),g=c.i32_const(t.alloc(2*o)),_=t.alloc(2*o),f=c.i32_const(_),h=c.i32_const(_),p=c.i32_const(_+o),m=c.i32_const(t.alloc(2*o)),L=c.i32_const(t.alloc(2*o));e.addCode(c.call(a+"_one",f),c.call(a+"_neg",f,f),c.call(a+"_exp",s,r,c.i32_const(o),d),c.call(a+"_square",d,u),c.call(a+"_mul",s,u,u),c.call(a+"_conjugate",u,g),c.call(a+"_mul",g,u,g),c.if(c.call(a+"_eq",g,f),c.unreachable()),c.call(a+"_mul",d,s,m),c.if(c.call(a+"_eq",u,f),[...c.call(i+"_zero",h),...c.call(i+"_one",p),...c.call(a+"_mul",f,m,c.getLocal("pr"))],[...c.call(a+"_one",L),...c.call(a+"_add",L,u,L),...c.call(a+"_exp",L,l,c.i32_const(o),L),...c.call(a+"_mul",L,m,c.getLocal("pr"))]))}(),function(){const e=t.addFunction(a+"_isSquare");e.addParam("a","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),c=i.i32_const(t.alloc(St.bigInt2BytesLE((BigInt(n||0)-3n)/4n,o))),r=i.getLocal("a"),l=i.i32_const(t.alloc(2*o)),s=i.i32_const(t.alloc(2*o)),d=i.i32_const(t.alloc(2*o)),u=t.alloc(2*o),g=i.i32_const(u);e.addCode(i.call(a+"_one",g),i.call(a+"_neg",g,g),i.call(a+"_exp",r,c,i.i32_const(o),l),i.call(a+"_square",l,s),i.call(a+"_mul",r,s,s),i.call(a+"_conjugate",s,d),i.call(a+"_mul",d,s,d),i.if(i.call(a+"_eq",d,g),i.ret(i.i32_const(0))),i.ret(i.i32_const(1)))}(),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_sqrt"),t.exportFunction(a+"_isSquare"),t.exportFunction(a+"_isNegative"),a};const Pt=$,Ut=Y;var Ot=function(t,e,a,i){if(t.modules[a])return a;const o=8*t.modules[i].n64;return t.modules[a]={n64:3*t.modules[i].n64},function(){const e=t.addFunction(a+"_isZero");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.i32_and(n.i32_and(n.call(i+"_isZero",c),n.call(i+"_isZero",r)),n.call(i+"_isZero",l)))}(),function(){const e=t.addFunction(a+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.ret(n.i32_and(n.i32_and(n.call(i+"_isOne",c),n.call(i+"_isZero",r)),n.call(i+"_isZero",l))))}(),function(){const e=t.addFunction(a+"_zero");e.addParam("x","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.call(i+"_zero",c),n.call(i+"_zero",r),n.call(i+"_zero",l))}(),function(){const e=t.addFunction(a+"_one");e.addParam("x","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.call(i+"_one",c),n.call(i+"_zero",r),n.call(i+"_zero",l))}(),function(){const e=t.addFunction(a+"_copy");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_copy",c,s),n.call(i+"_copy",r,d),n.call(i+"_copy",l,u))}(),function(){const n=t.addFunction(a+"_mul");n.addParam("x","i32"),n.addParam("y","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.i32_add(c.getLocal("x"),c.i32_const(2*o)),d=c.getLocal("y"),u=c.i32_add(c.getLocal("y"),c.i32_const(o)),g=c.i32_add(c.getLocal("y"),c.i32_const(2*o)),_=c.getLocal("r"),f=c.i32_add(c.getLocal("r"),c.i32_const(o)),h=c.i32_add(c.getLocal("r"),c.i32_const(2*o)),p=c.i32_const(t.alloc(o)),m=c.i32_const(t.alloc(o)),L=c.i32_const(t.alloc(o)),w=c.i32_const(t.alloc(o)),A=c.i32_const(t.alloc(o)),b=c.i32_const(t.alloc(o)),y=c.i32_const(t.alloc(o)),I=c.i32_const(t.alloc(o)),C=c.i32_const(t.alloc(o)),F=c.i32_const(t.alloc(o)),x=c.i32_const(t.alloc(o)),E=c.i32_const(t.alloc(o)),B=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_mul",r,d,p),c.call(i+"_mul",l,u,m),c.call(i+"_mul",s,g,L),c.call(i+"_add",r,l,w),c.call(i+"_add",d,u,A),c.call(i+"_add",r,s,b),c.call(i+"_add",d,g,y),c.call(i+"_add",l,s,I),c.call(i+"_add",u,g,C),c.call(i+"_add",p,m,F),c.call(i+"_add",p,L,x),c.call(i+"_add",m,L,E),c.call(i+"_mul",I,C,_),c.call(i+"_sub",_,E,_),c.call(e,_,_),c.call(i+"_add",p,_,_),c.call(i+"_mul",w,A,f),c.call(i+"_sub",f,F,f),c.call(e,L,B),c.call(i+"_add",f,B,f),c.call(i+"_mul",b,y,h),c.call(i+"_sub",h,x,h),c.call(i+"_add",h,m,h))}(),function(){const n=t.addFunction(a+"_square");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.i32_add(c.getLocal("x"),c.i32_const(2*o)),d=c.getLocal("r"),u=c.i32_add(c.getLocal("r"),c.i32_const(o)),g=c.i32_add(c.getLocal("r"),c.i32_const(2*o)),_=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o)),h=c.i32_const(t.alloc(o)),p=c.i32_const(t.alloc(o)),m=c.i32_const(t.alloc(o)),L=c.i32_const(t.alloc(o)),w=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_square",r,_),c.call(i+"_mul",r,l,f),c.call(i+"_add",f,f,h),c.call(i+"_sub",r,l,p),c.call(i+"_add",p,s,p),c.call(i+"_square",p,p),c.call(i+"_mul",l,s,m),c.call(i+"_add",m,m,L),c.call(i+"_square",s,w),c.call(e,L,d),c.call(i+"_add",_,d,d),c.call(e,w,u),c.call(i+"_add",h,u,u),c.call(i+"_add",_,w,g),c.call(i+"_sub",L,g,g),c.call(i+"_add",p,g,g),c.call(i+"_add",h,g,g))}(),function(){const e=t.addFunction(a+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(o)),u=n.i32_add(n.getLocal("y"),n.i32_const(2*o)),g=n.getLocal("r"),_=n.i32_add(n.getLocal("r"),n.i32_const(o)),f=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_add",c,s,g),n.call(i+"_add",r,d,_),n.call(i+"_add",l,u,f))}(),function(){const e=t.addFunction(a+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(o)),u=n.i32_add(n.getLocal("y"),n.i32_const(2*o)),g=n.getLocal("r"),_=n.i32_add(n.getLocal("r"),n.i32_const(o)),f=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_sub",c,s,g),n.call(i+"_sub",r,d,_),n.call(i+"_sub",l,u,f))}(),function(){const e=t.addFunction(a+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_neg",c,s),n.call(i+"_neg",r,d),n.call(i+"_neg",l,u))}(),function(){const e=t.addFunction(a+"_sign");e.addParam("x","i32"),e.addLocal("s","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.setLocal("s",n.call(i+"_sign",l)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.setLocal("s",n.call(i+"_sign",r)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.ret(n.call(i+"_sign",c)))}(),function(){const e=t.addFunction(a+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_toMontgomery",c,s),n.call(i+"_toMontgomery",r,d),n.call(i+"_toMontgomery",l,u))}(),function(){const e=t.addFunction(a+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_fromMontgomery",c,s),n.call(i+"_fromMontgomery",r,d),n.call(i+"_fromMontgomery",l,u))}(),function(){const e=t.addFunction(a+"_eq");e.addParam("x","i32"),e.addParam("y","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(o)),u=n.i32_add(n.getLocal("y"),n.i32_const(2*o));e.addCode(n.i32_and(n.i32_and(n.call(i+"_eq",c,s),n.call(i+"_eq",r,d)),n.call(i+"_eq",l,u)))}(),function(){const n=t.addFunction(a+"_inverse");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.i32_add(c.getLocal("x"),c.i32_const(2*o)),d=c.getLocal("r"),u=c.i32_add(c.getLocal("r"),c.i32_const(o)),g=c.i32_add(c.getLocal("r"),c.i32_const(2*o)),_=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o)),h=c.i32_const(t.alloc(o)),p=c.i32_const(t.alloc(o)),m=c.i32_const(t.alloc(o)),L=c.i32_const(t.alloc(o)),w=c.i32_const(t.alloc(o)),A=c.i32_const(t.alloc(o)),b=c.i32_const(t.alloc(o)),y=c.i32_const(t.alloc(o)),I=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_square",r,_),c.call(i+"_square",l,f),c.call(i+"_square",s,h),c.call(i+"_mul",r,l,p),c.call(i+"_mul",r,s,m),c.call(i+"_mul",l,s,L),c.call(e,L,w),c.call(i+"_sub",_,w,w),c.call(e,h,A),c.call(i+"_sub",A,p,A),c.call(i+"_sub",f,m,b),c.call(i+"_mul",s,A,y),c.call(i+"_mul",l,b,I),c.call(i+"_add",y,I,y),c.call(e,y,y),c.call(i+"_mul",r,w,I),c.call(i+"_add",I,y,y),c.call(i+"_inverse",y,y),c.call(i+"_mul",y,w,d),c.call(i+"_mul",y,A,u),c.call(i+"_mul",y,b,g))}(),function(){const e=t.addFunction(a+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));e.addCode(n.call(i+"_timesScalar",c,n.getLocal("scalar"),n.getLocal("scalarLen"),s),n.call(i+"_timesScalar",r,n.getLocal("scalar"),n.getLocal("scalarLen"),d),n.call(i+"_timesScalar",l,n.getLocal("scalar"),n.getLocal("scalarLen"),u))}(),function(){const e=t.addFunction(a+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));e.addCode(n.if(n.call(i+"_isZero",l),n.if(n.call(i+"_isZero",r),n.ret(n.call(i+"_isNegative",c)),n.ret(n.call(i+"_isNegative",r)))),n.ret(n.call(i+"_isNegative",l)))}(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),Ut(t,a),Pt(t,a+"_exp",3*o,a+"_mul",a+"_square",a+"_copy",a+"_one"),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_isNegative"),a};const zt=function(t,e,a,i,o,n,c,r){const l=t.addFunction(e);l.addParam("base","i32"),l.addParam("scalar","i32"),l.addParam("scalarLength","i32"),l.addParam("r","i32"),l.addLocal("old0","i32"),l.addLocal("nbits","i32"),l.addLocal("i","i32"),l.addLocal("last","i32"),l.addLocal("cur","i32"),l.addLocal("carry","i32"),l.addLocal("p","i32");const s=l.getCodeBuilder(),d=s.i32_const(t.alloc(a));function u(t){return s.i32_and(s.i32_shr_u(s.i32_load(s.i32_add(s.getLocal("scalar"),s.i32_and(s.i32_shr_u(t,s.i32_const(3)),s.i32_const(4294967292)))),s.i32_and(t,s.i32_const(31))),s.i32_const(1))}function g(t){return[...s.i32_store8(s.getLocal("p"),s.i32_const(t)),...s.setLocal("p",s.i32_add(s.getLocal("p"),s.i32_const(1)))]}l.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(r,s.getLocal("r")),...s.ret([])]),s.setLocal("nbits",s.i32_shl(s.getLocal("scalarLength"),s.i32_const(3))),s.setLocal("old0",s.i32_load(s.i32_const(0))),s.setLocal("p",s.getLocal("old0")),s.i32_store(s.i32_const(0),s.i32_and(s.i32_add(s.i32_add(s.getLocal("old0"),s.i32_const(32)),s.getLocal("nbits")),s.i32_const(4294967288))),s.setLocal("i",s.i32_const(1)),s.setLocal("last",u(s.i32_const(0))),s.setLocal("carry",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("nbits"))),s.setLocal("cur",u(s.getLocal("i"))),s.if(s.getLocal("last"),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(1)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(255)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(255)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...g(1)])),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(0)],[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...g(0)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...g(0)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...g(0)]))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.getLocal("last"),s.if(s.getLocal("carry"),[...g(255),...g(0),...g(1)],[...g(1)]),s.if(s.getLocal("carry"),[...g(0),...g(1)])),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.call(c,s.getLocal("base"),d),s.call(r,s.getLocal("r")),s.block(s.loop(s.call(o,s.getLocal("r"),s.getLocal("r")),s.setLocal("cur",s.i32_load8_u(s.getLocal("p"))),s.if(s.getLocal("cur"),s.if(s.i32_eq(s.getLocal("cur"),s.i32_const(1)),s.call(i,s.getLocal("r"),d,s.getLocal("r")),s.call(n,s.getLocal("r"),d,s.getLocal("r")))),s.br_if(1,s.i32_eq(s.getLocal("old0"),s.getLocal("p"))),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.br(0))),s.i32_store(s.i32_const(0),s.getLocal("old0")))},Qt=W,qt=function(t,e,a,i,o){const n=8*t.modules[e].n64;function c(){const i=t.addFunction(a);i.addParam("pBases","i32"),i.addParam("pScalars","i32"),i.addParam("scalarSize","i32"),i.addParam("n","i32"),i.addParam("pr","i32"),i.addLocal("chunkSize","i32"),i.addLocal("nChunks","i32"),i.addLocal("itScalar","i32"),i.addLocal("endScalar","i32"),i.addLocal("itBase","i32"),i.addLocal("itBit","i32"),i.addLocal("i","i32"),i.addLocal("j","i32"),i.addLocal("nTable","i32"),i.addLocal("pTable","i32"),i.addLocal("idx","i32"),i.addLocal("pIdxTable","i32");const o=i.getCodeBuilder(),c=o.i32_const(t.alloc(n)),r=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);i.addCode(o.call(e+"_zero",o.getLocal("pr")),o.if(o.i32_eqz(o.getLocal("n")),o.ret([])),o.setLocal("chunkSize",o.i32_load8_u(o.i32_clz(o.getLocal("n")),r)),o.setLocal("nChunks",o.i32_add(o.i32_div_u(o.i32_sub(o.i32_shl(o.getLocal("scalarSize"),o.i32_const(3)),o.i32_const(1)),o.getLocal("chunkSize")),o.i32_const(1))),o.setLocal("itBit",o.i32_mul(o.i32_sub(o.getLocal("nChunks"),o.i32_const(1)),o.getLocal("chunkSize"))),o.block(o.loop(o.br_if(1,o.i32_lt_s(o.getLocal("itBit"),o.i32_const(0))),o.if(o.i32_eqz(o.call(e+"_isZero",o.getLocal("pr"))),[...o.setLocal("j",o.i32_const(0)),...o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("j"),o.getLocal("chunkSize"))),o.call(e+"_double",o.getLocal("pr"),o.getLocal("pr")),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0)))]),o.call(a+"_chunk",o.getLocal("pBases"),o.getLocal("pScalars"),o.getLocal("scalarSize"),o.getLocal("n"),o.getLocal("itBit"),o.getLocal("chunkSize"),c),o.call(e+"_add",o.getLocal("pr"),c,o.getLocal("pr")),o.setLocal("itBit",o.i32_sub(o.getLocal("itBit"),o.getLocal("chunkSize"))),o.br(0))))}!function(){const e=t.addFunction(a+"_getChunk");e.addParam("pScalar","i32"),e.addParam("scalarSize","i32"),e.addParam("startBit","i32"),e.addParam("chunkSize","i32"),e.addLocal("bitsToEnd","i32"),e.addLocal("mask","i32"),e.setReturnType("i32");const i=e.getCodeBuilder();e.addCode(i.setLocal("bitsToEnd",i.i32_sub(i.i32_mul(i.getLocal("scalarSize"),i.i32_const(8)),i.getLocal("startBit"))),i.if(i.i32_gt_s(i.getLocal("chunkSize"),i.getLocal("bitsToEnd")),i.setLocal("mask",i.i32_sub(i.i32_shl(i.i32_const(1),i.getLocal("bitsToEnd")),i.i32_const(1))),i.setLocal("mask",i.i32_sub(i.i32_shl(i.i32_const(1),i.getLocal("chunkSize")),i.i32_const(1)))),i.i32_and(i.i32_shr_u(i.i32_load(i.i32_add(i.getLocal("pScalar"),i.i32_shr_u(i.getLocal("startBit"),i.i32_const(3))),0,0),i.i32_and(i.getLocal("startBit"),i.i32_const(7))),i.getLocal("mask")))}(),function(){const i=t.addFunction(a+"_reduceTable");i.addParam("pTable","i32"),i.addParam("p","i32"),i.addLocal("half","i32"),i.addLocal("it1","i32"),i.addLocal("it2","i32"),i.addLocal("pAcc","i32");const o=i.getCodeBuilder();i.addCode(o.if(o.i32_eq(o.getLocal("p"),o.i32_const(1)),o.ret([])),o.setLocal("half",o.i32_shl(o.i32_const(1),o.i32_sub(o.getLocal("p"),o.i32_const(1)))),o.setLocal("it1",o.getLocal("pTable")),o.setLocal("it2",o.i32_add(o.getLocal("pTable"),o.i32_mul(o.getLocal("half"),o.i32_const(n)))),o.setLocal("pAcc",o.i32_sub(o.getLocal("it2"),o.i32_const(n))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("it1"),o.getLocal("pAcc"))),o.call(e+"_add",o.getLocal("it1"),o.getLocal("it2"),o.getLocal("it1")),o.call(e+"_add",o.getLocal("pAcc"),o.getLocal("it2"),o.getLocal("pAcc")),o.setLocal("it1",o.i32_add(o.getLocal("it1"),o.i32_const(n))),o.setLocal("it2",o.i32_add(o.getLocal("it2"),o.i32_const(n))),o.br(0))),o.call(a+"_reduceTable",o.getLocal("pTable"),o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.setLocal("p",o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("p"))),o.call(e+"_double",o.getLocal("pAcc"),o.getLocal("pAcc")),o.setLocal("p",o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.br(0))),o.call(e+"_add",o.getLocal("pTable"),o.getLocal("pAcc"),o.getLocal("pTable")))}(),function(){const c=t.addFunction(a+"_chunk");c.addParam("pBases","i32"),c.addParam("pScalars","i32"),c.addParam("scalarSize","i32"),c.addParam("n","i32"),c.addParam("startBit","i32"),c.addParam("chunkSize","i32"),c.addParam("pr","i32"),c.addLocal("nChunks","i32"),c.addLocal("itScalar","i32"),c.addLocal("endScalar","i32"),c.addLocal("itBase","i32"),c.addLocal("i","i32"),c.addLocal("j","i32"),c.addLocal("nTable","i32"),c.addLocal("pTable","i32"),c.addLocal("idx","i32"),c.addLocal("pIdxTable","i32");const r=c.getCodeBuilder();c.addCode(r.if(r.i32_eqz(r.getLocal("n")),[...r.call(e+"_zero",r.getLocal("pr")),...r.ret([])]),r.setLocal("nTable",r.i32_shl(r.i32_const(1),r.getLocal("chunkSize"))),r.setLocal("pTable",r.i32_load(r.i32_const(0))),r.i32_store(r.i32_const(0),r.i32_add(r.getLocal("pTable"),r.i32_mul(r.getLocal("nTable"),r.i32_const(n)))),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("j"),r.getLocal("nTable"))),r.call(e+"_zero",r.i32_add(r.getLocal("pTable"),r.i32_mul(r.getLocal("j"),r.i32_const(n)))),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("itBase",r.getLocal("pBases")),r.setLocal("itScalar",r.getLocal("pScalars")),r.setLocal("endScalar",r.i32_add(r.getLocal("pScalars"),r.i32_mul(r.getLocal("n"),r.getLocal("scalarSize")))),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("itScalar"),r.getLocal("endScalar"))),r.setLocal("idx",r.call(a+"_getChunk",r.getLocal("itScalar"),r.getLocal("scalarSize"),r.getLocal("startBit"),r.getLocal("chunkSize"))),r.if(r.getLocal("idx"),[...r.setLocal("pIdxTable",r.i32_add(r.getLocal("pTable"),r.i32_mul(r.i32_sub(r.getLocal("idx"),r.i32_const(1)),r.i32_const(n)))),...r.call(i,r.getLocal("pIdxTable"),r.getLocal("itBase"),r.getLocal("pIdxTable"))]),r.setLocal("itScalar",r.i32_add(r.getLocal("itScalar"),r.getLocal("scalarSize"))),r.setLocal("itBase",r.i32_add(r.getLocal("itBase"),r.i32_const(o))),r.br(0))),r.call(a+"_reduceTable",r.getLocal("pTable"),r.getLocal("chunkSize")),r.call(e+"_copy",r.getLocal("pTable"),r.getLocal("pr")),r.i32_store(r.i32_const(0),r.getLocal("pTable")))}(),c(),t.exportFunction(a),t.exportFunction(a+"_chunk")};var Mt=function(t,e,a,i){const o=t.modules[a].n64,n=8*o;if(t.modules[e])return e;return t.modules[e]={n64:3*o},function(){const i=t.addFunction(e+"_isZeroAffine");i.addParam("p1","i32"),i.setReturnType("i32");const o=i.getCodeBuilder();i.addCode(o.i32_and(o.call(a+"_isZero",o.getLocal("p1")),o.call(a+"_isZero",o.i32_add(o.getLocal("p1"),o.i32_const(n)))))}(),function(){const i=t.addFunction(e+"_isZero");i.addParam("p1","i32"),i.setReturnType("i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_isZero",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))))}(),function(){const i=t.addFunction(e+"_zeroAffine");i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_zero",o.getLocal("pr"))),i.addCode(o.call(a+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(n))))}(),function(){const i=t.addFunction(e+"_zero");i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_zero",o.getLocal("pr"))),i.addCode(o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(n)))),i.addCode(o.call(a+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))))}(),function(){const a=t.addFunction(e+"_copyAffine");a.addParam("ps","i32"),a.addParam("pd","i32");const i=a.getCodeBuilder();for(let t=0;t<2*o;t++)a.addCode(i.i64_store(i.getLocal("pd"),8*t,i.i64_load(i.getLocal("ps"),8*t)))}(),function(){const a=t.addFunction(e+"_copy");a.addParam("ps","i32"),a.addParam("pd","i32");const i=a.getCodeBuilder();for(let t=0;t<3*o;t++)a.addCode(i.i64_store(i.getLocal("pd"),8*t,i.i64_load(i.getLocal("ps"),8*t)))}(),function(){const i=t.addFunction(e+"_toJacobian");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(n)),d=o.i32_add(o.getLocal("pr"),o.i32_const(2*n));i.addCode(o.if(o.call(e+"_isZeroAffine",o.getLocal("p1")),o.call(e+"_zero",o.getLocal("pr")),[...o.call(a+"_one",d),...o.call(a+"_copy",r,s),...o.call(a+"_copy",c,l)]))}(),function(){const i=t.addFunction(e+"_eqAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder();i.addCode(o.ret(o.i32_and(o.call(a+"_eq",o.getLocal("p1"),o.getLocal("p2")),o.call(a+"_eq",o.i32_add(o.getLocal("p1"),o.i32_const(n)),o.i32_add(o.getLocal("p2"),o.i32_const(n))))))}(),function(){const i=t.addFunction(e+"_eqMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const l=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n)),u=o.i32_const(t.alloc(n)),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),o.ret(o.call(e+"_isZeroAffine",o.getLocal("p2")))),o.if(o.call(e+"_isZeroAffine",o.getLocal("p2")),o.ret(o.i32_const(0))),o.if(o.call(a+"_isOne",l),o.ret(o.call(e+"_eqAffine",o.getLocal("p1"),o.getLocal("p2")))),o.call(a+"_square",l,u),o.call(a+"_mul",s,u,g),o.call(a+"_mul",l,u,_),o.call(a+"_mul",d,_,f),o.if(o.call(a+"_eq",c,g),o.if(o.call(a+"_eq",r,f),o.ret(o.i32_const(1)))),o.ret(o.i32_const(0)))}(),function(){const i=t.addFunction(e+"_eq");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32"),i.addLocal("z2","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const l=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n));i.addCode(o.setLocal("z2",o.i32_add(o.getLocal("p2"),o.i32_const(2*n))));const u=o.getLocal("z2"),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),o.ret(o.call(e+"_isZero",o.getLocal("p2")))),o.if(o.call(e+"_isZero",o.getLocal("p2")),o.ret(o.i32_const(0))),o.if(o.call(a+"_isOne",l),o.ret(o.call(e+"_eqMixed",o.getLocal("p2"),o.getLocal("p1")))),o.if(o.call(a+"_isOne",u),o.ret(o.call(e+"_eqMixed",o.getLocal("p1"),o.getLocal("p2")))),o.call(a+"_square",l,g),o.call(a+"_square",u,_),o.call(a+"_mul",c,_,f),o.call(a+"_mul",s,g,h),o.call(a+"_mul",l,g,p),o.call(a+"_mul",u,_,m),o.call(a+"_mul",r,m,L),o.call(a+"_mul",d,p,w),o.if(o.call(a+"_eq",f,h),o.if(o.call(a+"_eq",L,w),o.ret(o.i32_const(1)))),o.ret(o.i32_const(0)))}(),function(){const i=t.addFunction(e+"_doubleAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(n)),d=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),u=o.i32_const(t.alloc(n)),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZeroAffine",o.getLocal("p1")),[...o.call(e+"_toJacobian",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.call(a+"_square",c,u),o.call(a+"_square",r,g),o.call(a+"_square",g,_),o.call(a+"_add",c,g,f),o.call(a+"_square",f,f),o.call(a+"_sub",f,u,f),o.call(a+"_sub",f,_,f),o.call(a+"_add",f,f,f),o.call(a+"_add",u,u,h),o.call(a+"_add",h,u,h),o.call(a+"_add",r,r,d),o.call(a+"_square",h,l),o.call(a+"_sub",l,f,l),o.call(a+"_sub",l,f,l),o.call(a+"_add",_,_,p),o.call(a+"_add",p,p,p),o.call(a+"_add",p,p,p),o.call(a+"_sub",f,l,s),o.call(a+"_mul",s,h,s),o.call(a+"_sub",s,p,s))}(),function(){const i=t.addFunction(e+"_double");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(e+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isOne",l),[...o.ret(o.call(e+"_doubleAffine",o.getLocal("p1"),o.getLocal("pr"))),...o.ret([])]),o.call(a+"_square",c,g),o.call(a+"_square",r,_),o.call(a+"_square",_,f),o.call(a+"_add",c,_,h),o.call(a+"_square",h,h),o.call(a+"_sub",h,g,h),o.call(a+"_sub",h,f,h),o.call(a+"_add",h,h,h),o.call(a+"_add",g,g,p),o.call(a+"_add",p,g,p),o.call(a+"_square",p,m),o.call(a+"_mul",r,l,L),o.call(a+"_add",h,h,s),o.call(a+"_sub",m,s,s),o.call(a+"_add",f,f,w),o.call(a+"_add",w,w,w),o.call(a+"_add",w,w,w),o.call(a+"_sub",h,s,d),o.call(a+"_mul",d,p,d),o.call(a+"_sub",d,w,d),o.call(a+"_add",L,L,u))}(),function(){const i=t.addFunction(e+"_addAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const l=o.getLocal("p2"),s=o.i32_add(o.getLocal("p2"),o.i32_const(n)),d=o.getLocal("pr"),u=o.i32_add(o.getLocal("pr"),o.i32_const(n)),g=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n)),A=o.i32_const(t.alloc(n)),b=o.i32_const(t.alloc(n)),y=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZeroAffine",o.getLocal("p1")),[...o.call(e+"_copyAffine",o.getLocal("p2"),o.getLocal("pr")),...o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))),...o.ret([])]),o.if(o.call(e+"_isZeroAffine",o.getLocal("p2")),[...o.call(e+"_copyAffine",o.getLocal("p1"),o.getLocal("pr")),...o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))),...o.ret([])]),o.if(o.call(a+"_eq",c,l),o.if(o.call(a+"_eq",r,s),[...o.call(e+"_doubleAffine",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])])),o.call(a+"_sub",l,c,_),o.call(a+"_sub",s,r,h),o.call(a+"_square",_,f),o.call(a+"_add",f,f,p),o.call(a+"_add",p,p,p),o.call(a+"_mul",_,p,m),o.call(a+"_add",h,h,L),o.call(a+"_mul",c,p,A),o.call(a+"_square",L,w),o.call(a+"_add",A,A,b),o.call(a+"_sub",w,m,d),o.call(a+"_sub",d,b,d),o.call(a+"_mul",r,m,y),o.call(a+"_add",y,y,y),o.call(a+"_sub",A,d,u),o.call(a+"_mul",u,L,u),o.call(a+"_sub",u,y,u),o.call(a+"_add",_,_,g))}(),function(){const i=t.addFunction(e+"_addMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const l=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n)),u=o.getLocal("pr"),g=o.i32_add(o.getLocal("pr"),o.i32_const(n)),_=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),f=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n)),A=o.i32_const(t.alloc(n)),b=o.i32_const(t.alloc(n)),y=o.i32_const(t.alloc(n)),I=o.i32_const(t.alloc(n)),C=o.i32_const(t.alloc(n)),F=o.i32_const(t.alloc(n)),x=o.i32_const(t.alloc(n)),E=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(e+"_copyAffine",o.getLocal("p2"),o.getLocal("pr")),...o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))),...o.ret([])]),o.if(o.call(e+"_isZeroAffine",o.getLocal("p2")),[...o.call(e+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isOne",l),[...o.call(e+"_addAffine",c,s,u),...o.ret([])]),o.call(a+"_square",l,f),o.call(a+"_mul",s,f,h),o.call(a+"_mul",l,f,p),o.call(a+"_mul",d,p,m),o.if(o.call(a+"_eq",c,h),o.if(o.call(a+"_eq",r,m),[...o.call(e+"_doubleAffine",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])])),o.call(a+"_sub",h,c,L),o.call(a+"_sub",m,r,A),o.call(a+"_square",L,w),o.call(a+"_add",w,w,b),o.call(a+"_add",b,b,b),o.call(a+"_mul",L,b,y),o.call(a+"_add",A,A,I),o.call(a+"_mul",c,b,F),o.call(a+"_square",I,C),o.call(a+"_add",F,F,x),o.call(a+"_sub",C,y,u),o.call(a+"_sub",u,x,u),o.call(a+"_mul",r,y,E),o.call(a+"_add",E,E,E),o.call(a+"_sub",F,u,g),o.call(a+"_mul",g,I,g),o.call(a+"_sub",g,E,g),o.call(a+"_add",l,L,_),o.call(a+"_square",_,_),o.call(a+"_sub",_,f,_),o.call(a+"_sub",_,w,_))}(),function(){const i=t.addFunction(e+"_add");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32"),i.addLocal("z2","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const l=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n));i.addCode(o.setLocal("z2",o.i32_add(o.getLocal("p2"),o.i32_const(2*n))));const u=o.getLocal("z2"),g=o.getLocal("pr"),_=o.i32_add(o.getLocal("pr"),o.i32_const(n)),f=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),h=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n)),A=o.i32_const(t.alloc(n)),b=o.i32_const(t.alloc(n)),y=o.i32_const(t.alloc(n)),I=o.i32_const(t.alloc(n)),C=o.i32_const(t.alloc(n)),F=o.i32_const(t.alloc(n)),x=o.i32_const(t.alloc(n)),E=o.i32_const(t.alloc(n)),B=o.i32_const(t.alloc(n)),v=o.i32_const(t.alloc(n)),S=o.i32_const(t.alloc(n)),G=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(e+"_copy",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(e+"_isZero",o.getLocal("p2")),[...o.call(e+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isOne",l),[...o.call(e+"_addMixed",s,c,g),...o.ret([])]),o.if(o.call(a+"_isOne",u),[...o.call(e+"_addMixed",c,s,g),...o.ret([])]),o.call(a+"_square",l,h),o.call(a+"_square",u,p),o.call(a+"_mul",c,p,m),o.call(a+"_mul",s,h,L),o.call(a+"_mul",l,h,w),o.call(a+"_mul",u,p,A),o.call(a+"_mul",r,A,b),o.call(a+"_mul",d,w,y),o.if(o.call(a+"_eq",m,L),o.if(o.call(a+"_eq",b,y),[...o.call(e+"_double",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])])),o.call(a+"_sub",L,m,I),o.call(a+"_sub",y,b,C),o.call(a+"_add",I,I,F),o.call(a+"_square",F,F),o.call(a+"_mul",I,F,x),o.call(a+"_add",C,C,E),o.call(a+"_mul",m,F,v),o.call(a+"_square",E,B),o.call(a+"_add",v,v,S),o.call(a+"_sub",B,x,g),o.call(a+"_sub",g,S,g),o.call(a+"_mul",b,x,G),o.call(a+"_add",G,G,G),o.call(a+"_sub",v,g,_),o.call(a+"_mul",_,E,_),o.call(a+"_sub",_,G,_),o.call(a+"_add",l,u,f),o.call(a+"_square",f,f),o.call(a+"_sub",f,h,f),o.call(a+"_sub",f,p,f),o.call(a+"_mul",f,I,f))}(),function(){const i=t.addFunction(e+"_negAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(n));i.addCode(o.call(a+"_copy",c,l),o.call(a+"_neg",r,s))}(),function(){const i=t.addFunction(e+"_neg");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*n));i.addCode(o.call(a+"_copy",c,s),o.call(a+"_neg",r,d),o.call(a+"_copy",l,u))}(),function(){const a=t.addFunction(e+"_subAffine");a.addParam("p1","i32"),a.addParam("p2","i32"),a.addParam("pr","i32");const i=a.getCodeBuilder(),o=i.i32_const(t.alloc(3*n));a.addCode(i.call(e+"_negAffine",i.getLocal("p2"),o),i.call(e+"_addAffine",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){const a=t.addFunction(e+"_subMixed");a.addParam("p1","i32"),a.addParam("p2","i32"),a.addParam("pr","i32");const i=a.getCodeBuilder(),o=i.i32_const(t.alloc(3*n));a.addCode(i.call(e+"_negAffine",i.getLocal("p2"),o),i.call(e+"_addMixed",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){const a=t.addFunction(e+"_sub");a.addParam("p1","i32"),a.addParam("p2","i32"),a.addParam("pr","i32");const i=a.getCodeBuilder(),o=i.i32_const(t.alloc(3*n));a.addCode(i.call(e+"_neg",i.getLocal("p2"),o),i.call(e+"_add",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){const i=t.addFunction(e+"_fromMontgomeryAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_fromMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<2;t++)i.addCode(o.call(a+"_fromMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(e+"_fromMontgomery");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_fromMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<3;t++)i.addCode(o.call(a+"_fromMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(e+"_toMontgomeryAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_toMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<2;t++)i.addCode(o.call(a+"_toMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(e+"_toMontgomery");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(a+"_toMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<3;t++)i.addCode(o.call(a+"_toMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(e+"_toAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_const(t.alloc(n)),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(a+"_zero",s),...o.call(a+"_zero",d)],[...o.call(a+"_inverse",l,u),...o.call(a+"_square",u,g),...o.call(a+"_mul",u,g,_),...o.call(a+"_mul",c,g,s),...o.call(a+"_mul",r,_,d)]))}(),function(){const o=t.addFunction(e+"_inCurveAffine");o.addParam("pIn","i32"),o.setReturnType("i32");const c=o.getCodeBuilder(),r=c.getLocal("pIn"),l=c.i32_add(c.getLocal("pIn"),c.i32_const(n)),s=c.i32_const(t.alloc(n)),d=c.i32_const(t.alloc(n));o.addCode(c.call(a+"_square",l,s),c.call(a+"_square",r,d),c.call(a+"_mul",r,d,d),c.call(a+"_add",d,c.i32_const(i),d),c.ret(c.call(a+"_eq",s,d)))}(),function(){const a=t.addFunction(e+"_inCurve");a.addParam("pIn","i32"),a.setReturnType("i32");const i=a.getCodeBuilder(),o=i.i32_const(t.alloc(2*n));a.addCode(i.call(e+"_toAffine",i.getLocal("pIn"),o),i.ret(i.call(e+"_inCurveAffine",o)))}(),function(){const i=t.addFunction(e+"_batchToAffine");i.addParam("pIn","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addLocal("pAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itAux","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");const o=i.getCodeBuilder(),c=o.i32_const(t.alloc(n));i.addCode(o.setLocal("pAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("pAux"),o.i32_mul(o.getLocal("n"),o.i32_const(n)))),o.call(a+"_batchInverse",o.i32_add(o.getLocal("pIn"),o.i32_const(2*n)),o.i32_const(3*n),o.getLocal("n"),o.getLocal("pAux"),o.i32_const(n)),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.getLocal("pAux")),o.setLocal("itOut",o.getLocal("pOut")),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(a+"_isZero",o.getLocal("itAux")),[...o.call(a+"_zero",o.getLocal("itOut")),...o.call(a+"_zero",o.i32_add(o.getLocal("itOut"),o.i32_const(n)))],[...o.call(a+"_mul",o.getLocal("itAux"),o.i32_add(o.getLocal("itIn"),o.i32_const(n)),c),...o.call(a+"_square",o.getLocal("itAux"),o.getLocal("itAux")),...o.call(a+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.getLocal("itOut")),...o.call(a+"_mul",o.getLocal("itAux"),c,o.i32_add(o.getLocal("itOut"),o.i32_const(n)))]),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.i32_const(3*n))),o.setLocal("itOut",o.i32_add(o.getLocal("itOut"),o.i32_const(2*n))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.i32_store(o.i32_const(0),o.getLocal("pAux")))}(),function(){const i=t.addFunction(e+"_normalize");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),o.call(e+"_zero",o.getLocal("pr")),[...o.call(a+"_inverse",l,g),...o.call(a+"_square",g,_),...o.call(a+"_mul",g,_,f),...o.call(a+"_mul",c,_,s),...o.call(a+"_mul",r,f,d),...o.call(a+"_one",u)]))}(),function(){const a=t.addFunction(e+"__reverseBytes");a.addParam("pIn","i32"),a.addParam("n","i32"),a.addParam("pOut","i32"),a.addLocal("itOut","i32"),a.addLocal("itIn","i32");const i=a.getCodeBuilder();a.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}(),function(){const a=t.addFunction(e+"_LEMtoU");a.addParam("pIn","i32"),a.addParam("pOut","i32");const i=a.getCodeBuilder(),o=t.alloc(2*n),c=i.i32_const(o),r=i.i32_const(o),l=i.i32_const(o+n);a.addCode(i.if(i.call(e+"_isZeroAffine",i.getLocal("pIn")),[...i.call(e+"_zeroAffine",i.getLocal("pOut")),...i.i32_store8(i.getLocal("pOut"),i.i32_const(64)),...i.ret([])]),i.call(e+"_fromMontgomeryAffine",i.getLocal("pIn"),c),i.call(e+"__reverseBytes",r,i.i32_const(n),i.getLocal("pOut")),i.call(e+"__reverseBytes",l,i.i32_const(n),i.i32_add(i.getLocal("pOut"),i.i32_const(n))))}(),function(){const i=t.addFunction(e+"_LEMtoC");i.addParam("pIn","i32"),i.addParam("pOut","i32");const o=i.getCodeBuilder(),c=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("pIn")),[...o.call(a+"_zero",o.getLocal("pOut")),...o.i32_store8(o.getLocal("pOut"),o.i32_const(64)),...o.ret([])]),o.call(a+"_fromMontgomery",o.getLocal("pIn"),c),o.call(e+"__reverseBytes",c,o.i32_const(n),o.getLocal("pOut")),o.if(o.i32_eq(o.call(a+"_sign",o.i32_add(o.getLocal("pIn"),o.i32_const(n))),o.i32_const(-1)),o.i32_store8(o.getLocal("pOut"),o.i32_or(o.i32_load8_u(o.getLocal("pOut")),o.i32_const(128)))))}(),function(){const a=t.addFunction(e+"_UtoLEM");a.addParam("pIn","i32"),a.addParam("pOut","i32");const i=a.getCodeBuilder(),o=t.alloc(2*n),c=i.i32_const(o),r=i.i32_const(o),l=i.i32_const(o+n);a.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(e+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(e+"__reverseBytes",i.getLocal("pIn"),i.i32_const(n),r),i.call(e+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(n)),i.i32_const(n),l),i.call(e+"_toMontgomeryAffine",c,i.getLocal("pOut")))}(),function(){const o=t.addFunction(e+"_CtoLEM");o.addParam("pIn","i32"),o.addParam("pOut","i32"),o.addLocal("firstByte","i32"),o.addLocal("greatest","i32");const c=o.getCodeBuilder(),r=t.alloc(2*n),l=c.i32_const(r),s=c.i32_const(r+n);o.addCode(c.setLocal("firstByte",c.i32_load8_u(c.getLocal("pIn"))),c.if(c.i32_and(c.getLocal("firstByte"),c.i32_const(64)),[...c.call(e+"_zeroAffine",c.getLocal("pOut")),...c.ret([])]),c.setLocal("greatest",c.i32_and(c.getLocal("firstByte"),c.i32_const(128))),c.call(a+"_copy",c.getLocal("pIn"),s),c.i32_store8(s,c.i32_and(c.getLocal("firstByte"),c.i32_const(63))),c.call(e+"__reverseBytes",s,c.i32_const(n),l),c.call(a+"_toMontgomery",l,c.getLocal("pOut")),c.call(a+"_square",c.getLocal("pOut"),s),c.call(a+"_mul",c.getLocal("pOut"),s,s),c.call(a+"_add",s,c.i32_const(i),s),c.call(a+"_sqrt",s,s),c.call(a+"_neg",s,l),c.if(c.i32_eq(c.call(a+"_sign",s),c.i32_const(-1)),c.if(c.getLocal("greatest"),c.call(a+"_copy",s,c.i32_add(c.getLocal("pOut"),c.i32_const(n))),c.call(a+"_neg",s,c.i32_add(c.getLocal("pOut"),c.i32_const(n)))),c.if(c.getLocal("greatest"),c.call(a+"_neg",s,c.i32_add(c.getLocal("pOut"),c.i32_const(n))),c.call(a+"_copy",s,c.i32_add(c.getLocal("pOut"),c.i32_const(n))))))}(),Qt(t,e+"_batchLEMtoU",e+"_LEMtoU",2*n,2*n),Qt(t,e+"_batchLEMtoC",e+"_LEMtoC",2*n,n),Qt(t,e+"_batchUtoLEM",e+"_UtoLEM",2*n,2*n),Qt(t,e+"_batchCtoLEM",e+"_CtoLEM",n,2*n,!0),Qt(t,e+"_batchToJacobian",e+"_toJacobian",2*n,3*n,!0),qt(t,e,e+"_multiexp",e+"_add",3*n),qt(t,e,e+"_multiexpAffine",e+"_addMixed",2*n),zt(t,e+"_timesScalar",3*n,e+"_add",e+"_double",e+"_sub",e+"_copy",e+"_zero"),zt(t,e+"_timesScalarAffine",2*n,e+"_addMixed",e+"_double",e+"_subMixed",e+"_copyAffine",e+"_zero"),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_isZeroAffine"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_eqMixed"),t.exportFunction(e+"_eqAffine"),t.exportFunction(e+"_copy"),t.exportFunction(e+"_copyAffine"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_zeroAffine"),t.exportFunction(e+"_double"),t.exportFunction(e+"_doubleAffine"),t.exportFunction(e+"_add"),t.exportFunction(e+"_addMixed"),t.exportFunction(e+"_addAffine"),t.exportFunction(e+"_neg"),t.exportFunction(e+"_negAffine"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_subMixed"),t.exportFunction(e+"_subAffine"),t.exportFunction(e+"_fromMontgomery"),t.exportFunction(e+"_fromMontgomeryAffine"),t.exportFunction(e+"_toMontgomery"),t.exportFunction(e+"_toMontgomeryAffine"),t.exportFunction(e+"_timesScalar"),t.exportFunction(e+"_timesScalarAffine"),t.exportFunction(e+"_normalize"),t.exportFunction(e+"_LEMtoU"),t.exportFunction(e+"_LEMtoC"),t.exportFunction(e+"_UtoLEM"),t.exportFunction(e+"_CtoLEM"),t.exportFunction(e+"_batchLEMtoU"),t.exportFunction(e+"_batchLEMtoC"),t.exportFunction(e+"_batchUtoLEM"),t.exportFunction(e+"_batchCtoLEM"),t.exportFunction(e+"_toAffine"),t.exportFunction(e+"_toJacobian"),t.exportFunction(e+"_batchToAffine"),t.exportFunction(e+"_batchToJacobian"),t.exportFunction(e+"_inCurve"),t.exportFunction(e+"_inCurveAffine"),e};const{isOdd:Tt,modInv:kt,modPow:Rt}=J,Dt=H;var Nt=function(t,e,a,i,o){const n=8*t.modules[i].n64,c=8*t.modules[a].n64,r=t.modules[i].q;let l=r-1n,s=0;for(;!Tt(l);)s++,l>>=1n;let d=2n;for(;1n===Rt(d,r>>1n,r);)d+=1n;const u=new Array(s+1);u[s]=Rt(d,l,r);let g=s-1;for(;g>=0;)u[g]=Rt(u[g+1],2n,r),g--;const _=[],f=(1n<<BigInt(8*n))%r;for(let t=0;t<u.length;t++){const e=u[t]*f%r;_.push(...Dt.bigInt2BytesLE(e,n))}const h=t.alloc(_),p=new Array(s+1);p[0]=1n;for(let t=1;t<=s;t++)p[t]=2n*p[t-1];const m=[];for(let t=0;t<=s;t++){const e=kt(p[t],r)*f%r;m.push(...Dt.bigInt2BytesLE(e,n))}const L=t.alloc(m),w=Rt(d,2n,r),A=[],b=[];for(let t=0;t<=s;t++){const e=Rt(w,2n**BigInt(t),r),a=kt(r+1n-e,r);A.push(...Dt.bigInt2BytesLE(e*f%r,n)),b.push(...Dt.bigInt2BytesLE(a*f%r,n))}const y=t.alloc(A),I=t.alloc(b);function C(t){let e=0;for(let a=0;a<8;a++)t&1<<a&&(e|=128>>a);return e}const F=Array(256);for(let t=0;t<256;t++)F[t]=C(t);const x=t.alloc(F);function E(){const a=t.addFunction(e+"_fft");a.addParam("px","i32"),a.addParam("n","i32"),a.addLocal("bits","i32");const o=a.getCodeBuilder(),c=o.i32_const(t.alloc(n));a.addCode(o.setLocal("bits",o.call(e+"__log2",o.getLocal("n"))),o.call(i+"_one",c),o.call(e+"_rawfft",o.getLocal("px"),o.getLocal("bits"),o.i32_const(0),c))}!function(){const a=t.addFunction(e+"__rev");a.addParam("x","i32"),a.addParam("bits","i32"),a.setReturnType("i32");const i=a.getCodeBuilder();a.addCode(i.i32_rotl(i.i32_add(i.i32_add(i.i32_shl(i.i32_load8_u(i.i32_and(i.getLocal("x"),i.i32_const(255)),x,0),i.i32_const(24)),i.i32_shl(i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(8)),i.i32_const(255)),x,0),i.i32_const(16))),i.i32_add(i.i32_shl(i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(16)),i.i32_const(255)),x,0),i.i32_const(8)),i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(24)),i.i32_const(255)),x,0))),i.getLocal("bits")))}(),function(){const i=t.addFunction(e+"__reversePermutation");i.addParam("px","i32"),i.addParam("bits","i32"),i.addLocal("n","i32"),i.addLocal("i","i32"),i.addLocal("ri","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(c));i.addCode(o.setLocal("n",o.i32_shl(o.i32_const(1),o.getLocal("bits"))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.setLocal("idx1",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("i"),o.i32_const(c)))),o.setLocal("ri",o.call(e+"__rev",o.getLocal("i"),o.getLocal("bits"))),o.setLocal("idx2",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("ri"),o.i32_const(c)))),o.if(o.i32_lt_u(o.getLocal("i"),o.getLocal("ri")),[...o.call(a+"_copy",o.getLocal("idx1"),n),...o.call(a+"_copy",o.getLocal("idx2"),o.getLocal("idx1")),...o.call(a+"_copy",n,o.getLocal("idx2"))]),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){const n=t.addFunction(e+"__fftFinal");n.addParam("px","i32"),n.addParam("bits","i32"),n.addParam("reverse","i32"),n.addParam("mulFactor","i32"),n.addLocal("n","i32"),n.addLocal("ndiv2","i32"),n.addLocal("pInv2","i32"),n.addLocal("i","i32"),n.addLocal("mask","i32"),n.addLocal("idx1","i32"),n.addLocal("idx2","i32");const r=n.getCodeBuilder(),l=r.i32_const(t.alloc(c));n.addCode(r.if(r.i32_and(r.i32_eqz(r.getLocal("reverse")),r.call(i+"_isOne",r.getLocal("mulFactor"))),r.ret([])),r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("mask",r.i32_sub(r.getLocal("n"),r.i32_const(1))),r.setLocal("i",r.i32_const(1)),r.setLocal("ndiv2",r.i32_shr_u(r.getLocal("n"),r.i32_const(1))),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("i"),r.getLocal("ndiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("i"),r.i32_const(c)))),r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.getLocal("i")),r.i32_const(c)))),r.if(r.getLocal("reverse"),r.if(r.call(i+"_isOne",r.getLocal("mulFactor")),[...r.call(a+"_copy",r.getLocal("idx1"),l),...r.call(a+"_copy",r.getLocal("idx2"),r.getLocal("idx1")),...r.call(a+"_copy",l,r.getLocal("idx2"))],[...r.call(a+"_copy",r.getLocal("idx1"),l),...r.call(o,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(o,l,r.getLocal("mulFactor"),r.getLocal("idx2"))]),r.if(r.call(i+"_isOne",r.getLocal("mulFactor")),[],[...r.call(o,r.getLocal("idx1"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(o,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))])),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))),r.if(r.call(i+"_isOne",r.getLocal("mulFactor")),[],[...r.call(o,r.getLocal("px"),r.getLocal("mulFactor"),r.getLocal("px")),...r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(c)))),...r.call(o,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))]))}(),function(){const r=t.addFunction(e+"_rawfft");r.addParam("px","i32"),r.addParam("bits","i32"),r.addParam("reverse","i32"),r.addParam("mulFactor","i32"),r.addLocal("s","i32"),r.addLocal("k","i32"),r.addLocal("j","i32"),r.addLocal("m","i32"),r.addLocal("mdiv2","i32"),r.addLocal("n","i32"),r.addLocal("pwm","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c)),u=l.i32_const(t.alloc(c));r.addCode(l.call(e+"__reversePermutation",l.getLocal("px"),l.getLocal("bits")),l.setLocal("n",l.i32_shl(l.i32_const(1),l.getLocal("bits"))),l.setLocal("s",l.i32_const(1)),l.block(l.loop(l.br_if(1,l.i32_gt_u(l.getLocal("s"),l.getLocal("bits"))),l.setLocal("m",l.i32_shl(l.i32_const(1),l.getLocal("s"))),l.setLocal("pwm",l.i32_add(l.i32_const(h),l.i32_mul(l.getLocal("s"),l.i32_const(n)))),l.setLocal("k",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_ge_u(l.getLocal("k"),l.getLocal("n"))),l.call(i+"_one",s),l.setLocal("mdiv2",l.i32_shr_u(l.getLocal("m"),l.i32_const(1))),l.setLocal("j",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_ge_u(l.getLocal("j"),l.getLocal("mdiv2"))),l.setLocal("idx1",l.i32_add(l.getLocal("px"),l.i32_mul(l.i32_add(l.getLocal("k"),l.getLocal("j")),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("idx1"),l.i32_mul(l.getLocal("mdiv2"),l.i32_const(c)))),l.call(o,l.getLocal("idx2"),s,d),l.call(a+"_copy",l.getLocal("idx1"),u),l.call(a+"_add",u,d,l.getLocal("idx1")),l.call(a+"_sub",u,d,l.getLocal("idx2")),l.call(i+"_mul",s,l.getLocal("pwm"),s),l.setLocal("j",l.i32_add(l.getLocal("j"),l.i32_const(1))),l.br(0))),l.setLocal("k",l.i32_add(l.getLocal("k"),l.getLocal("m"))),l.br(0))),l.setLocal("s",l.i32_add(l.getLocal("s"),l.i32_const(1))),l.br(0))),l.call(e+"__fftFinal",l.getLocal("px"),l.getLocal("bits"),l.getLocal("reverse"),l.getLocal("mulFactor")))}(),function(){const a=t.addFunction(e+"__log2");a.addParam("n","i32"),a.setReturnType("i32"),a.addLocal("bits","i32"),a.addLocal("aux","i32");const i=a.getCodeBuilder();a.addCode(i.setLocal("aux",i.i32_shr_u(i.getLocal("n"),i.i32_const(1)))),a.addCode(i.setLocal("bits",i.i32_const(0))),a.addCode(i.block(i.loop(i.br_if(1,i.i32_eqz(i.getLocal("aux"))),i.setLocal("aux",i.i32_shr_u(i.getLocal("aux"),i.i32_const(1))),i.setLocal("bits",i.i32_add(i.getLocal("bits"),i.i32_const(1))),i.br(0)))),a.addCode(i.if(i.i32_ne(i.getLocal("n"),i.i32_shl(i.i32_const(1),i.getLocal("bits"))),i.unreachable())),a.addCode(i.if(i.i32_gt_u(i.getLocal("bits"),i.i32_const(s)),i.unreachable())),a.addCode(i.getLocal("bits"))}(),E(),function(){const a=t.addFunction(e+"_ifft");a.addParam("px","i32"),a.addParam("n","i32"),a.addLocal("bits","i32"),a.addLocal("pInv2","i32");const i=a.getCodeBuilder();a.addCode(i.setLocal("bits",i.call(e+"__log2",i.getLocal("n"))),i.setLocal("pInv2",i.i32_add(i.i32_const(L),i.i32_mul(i.getLocal("bits"),i.i32_const(n)))),i.call(e+"_rawfft",i.getLocal("px"),i.getLocal("bits"),i.i32_const(1),i.getLocal("pInv2")))}(),function(){const r=t.addFunction(e+"_fftJoin");r.addParam("pBuff1","i32"),r.addParam("pBuff2","i32"),r.addParam("n","i32"),r.addParam("first","i32"),r.addParam("inc","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),r.addLocal("i","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c)),u=l.i32_const(t.alloc(c));r.addCode(l.call(i+"_copy",l.getLocal("first"),s),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.setLocal("idx1",l.i32_add(l.getLocal("pBuff1"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("pBuff2"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.call(o,l.getLocal("idx2"),s,d),l.call(a+"_copy",l.getLocal("idx1"),u),l.call(a+"_add",u,d,l.getLocal("idx1")),l.call(a+"_sub",u,d,l.getLocal("idx2")),l.call(i+"_mul",s,l.getLocal("inc"),s),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),function(){const r=t.addFunction(e+"_fftJoinExt");r.addParam("pBuff1","i32"),r.addParam("pBuff2","i32"),r.addParam("n","i32"),r.addParam("first","i32"),r.addParam("inc","i32"),r.addParam("totalBits","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),r.addLocal("i","i32"),r.addLocal("pShiftToM","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c));r.addCode(l.setLocal("pShiftToM",l.i32_add(l.i32_const(y),l.i32_mul(l.getLocal("totalBits"),l.i32_const(n)))),l.call(i+"_copy",l.getLocal("first"),s),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.setLocal("idx1",l.i32_add(l.getLocal("pBuff1"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("pBuff2"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.call(a+"_add",l.getLocal("idx1"),l.getLocal("idx2"),d),l.call(o,l.getLocal("idx2"),l.getLocal("pShiftToM"),l.getLocal("idx2")),l.call(a+"_add",l.getLocal("idx1"),l.getLocal("idx2"),l.getLocal("idx2")),l.call(o,l.getLocal("idx2"),s,l.getLocal("idx2")),l.call(a+"_copy",d,l.getLocal("idx1")),l.call(i+"_mul",s,l.getLocal("inc"),s),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),function(){const r=t.addFunction(e+"_fftJoinExtInv");r.addParam("pBuff1","i32"),r.addParam("pBuff2","i32"),r.addParam("n","i32"),r.addParam("first","i32"),r.addParam("inc","i32"),r.addParam("totalBits","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),r.addLocal("i","i32"),r.addLocal("pShiftToM","i32"),r.addLocal("pSConst","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c));r.addCode(l.setLocal("pShiftToM",l.i32_add(l.i32_const(y),l.i32_mul(l.getLocal("totalBits"),l.i32_const(n)))),l.setLocal("pSConst",l.i32_add(l.i32_const(I),l.i32_mul(l.getLocal("totalBits"),l.i32_const(n)))),l.call(i+"_copy",l.getLocal("first"),s),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.setLocal("idx1",l.i32_add(l.getLocal("pBuff1"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("pBuff2"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.call(o,l.getLocal("idx2"),s,d),l.call(a+"_sub",l.getLocal("idx1"),d,l.getLocal("idx2")),l.call(o,l.getLocal("idx2"),l.getLocal("pSConst"),l.getLocal("idx2")),l.call(o,l.getLocal("idx1"),l.getLocal("pShiftToM"),l.getLocal("idx1")),l.call(a+"_sub",d,l.getLocal("idx1"),l.getLocal("idx1")),l.call(o,l.getLocal("idx1"),l.getLocal("pSConst"),l.getLocal("idx1")),l.call(i+"_mul",s,l.getLocal("inc"),s),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),function(){const r=t.addFunction(e+"_fftMix");r.addParam("pBuff","i32"),r.addParam("n","i32"),r.addParam("exp","i32"),r.addLocal("nGroups","i32"),r.addLocal("nPerGroup","i32"),r.addLocal("nPerGroupDiv2","i32"),r.addLocal("pairOffset","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),r.addLocal("i","i32"),r.addLocal("j","i32"),r.addLocal("pwm","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c)),u=l.i32_const(t.alloc(c));r.addCode(l.setLocal("nPerGroup",l.i32_shl(l.i32_const(1),l.getLocal("exp"))),l.setLocal("nPerGroupDiv2",l.i32_shr_u(l.getLocal("nPerGroup"),l.i32_const(1))),l.setLocal("nGroups",l.i32_shr_u(l.getLocal("n"),l.getLocal("exp"))),l.setLocal("pairOffset",l.i32_mul(l.getLocal("nPerGroupDiv2"),l.i32_const(c))),l.setLocal("pwm",l.i32_add(l.i32_const(h),l.i32_mul(l.getLocal("exp"),l.i32_const(n)))),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("nGroups"))),l.call(i+"_one",s),l.setLocal("j",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("j"),l.getLocal("nPerGroupDiv2"))),l.setLocal("idx1",l.i32_add(l.getLocal("pBuff"),l.i32_mul(l.i32_add(l.i32_mul(l.getLocal("i"),l.getLocal("nPerGroup")),l.getLocal("j")),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("idx1"),l.getLocal("pairOffset"))),l.call(o,l.getLocal("idx2"),s,d),l.call(a+"_copy",l.getLocal("idx1"),u),l.call(a+"_add",u,d,l.getLocal("idx1")),l.call(a+"_sub",u,d,l.getLocal("idx2")),l.call(i+"_mul",s,l.getLocal("pwm"),s),l.setLocal("j",l.i32_add(l.getLocal("j"),l.i32_const(1))),l.br(0))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),function(){const i=t.addFunction(e+"_fftFinal");i.addParam("pBuff","i32"),i.addParam("n","i32"),i.addParam("factor","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("ndiv2","i32");const n=i.getCodeBuilder(),r=n.i32_const(t.alloc(c));i.addCode(n.setLocal("ndiv2",n.i32_shr_u(n.getLocal("n"),n.i32_const(1))),n.if(n.i32_and(n.getLocal("n"),n.i32_const(1)),n.call(o,n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("ndiv2"),n.i32_const(c))),n.getLocal("factor"),n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("ndiv2"),n.i32_const(c))))),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_ge_u(n.getLocal("i"),n.getLocal("ndiv2"))),n.setLocal("idx1",n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("i"),n.i32_const(c)))),n.setLocal("idx2",n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.i32_sub(n.i32_sub(n.getLocal("n"),n.i32_const(1)),n.getLocal("i")),n.i32_const(c)))),n.call(o,n.getLocal("idx2"),n.getLocal("factor"),r),n.call(o,n.getLocal("idx1"),n.getLocal("factor"),n.getLocal("idx2")),n.call(a+"_copy",r,n.getLocal("idx1")),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),function(){const r=t.addFunction(e+"_prepareLagrangeEvaluation");r.addParam("pBuff1","i32"),r.addParam("pBuff2","i32"),r.addParam("n","i32"),r.addParam("first","i32"),r.addParam("inc","i32"),r.addParam("totalBits","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),r.addLocal("i","i32"),r.addLocal("pShiftToM","i32"),r.addLocal("pSConst","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c));r.addCode(l.setLocal("pShiftToM",l.i32_add(l.i32_const(y),l.i32_mul(l.getLocal("totalBits"),l.i32_const(n)))),l.setLocal("pSConst",l.i32_add(l.i32_const(I),l.i32_mul(l.getLocal("totalBits"),l.i32_const(n)))),l.call(i+"_copy",l.getLocal("first"),s),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.setLocal("idx1",l.i32_add(l.getLocal("pBuff1"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("pBuff2"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.call(o,l.getLocal("idx1"),l.getLocal("pShiftToM"),d),l.call(a+"_sub",l.getLocal("idx2"),d,d),l.call(a+"_sub",l.getLocal("idx1"),l.getLocal("idx2"),l.getLocal("idx2")),l.call(o,d,l.getLocal("pSConst"),l.getLocal("idx1")),l.call(o,l.getLocal("idx2"),s,l.getLocal("idx2")),l.call(i+"_mul",s,l.getLocal("inc"),s),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),t.exportFunction(e+"_fft"),t.exportFunction(e+"_ifft"),t.exportFunction(e+"_rawfft"),t.exportFunction(e+"_fftJoin"),t.exportFunction(e+"_fftJoinExt"),t.exportFunction(e+"_fftJoinExtInv"),t.exportFunction(e+"_fftMix"),t.exportFunction(e+"_fftFinal"),t.exportFunction(e+"_prepareLagrangeEvaluation")},Vt=function(t,e,a){const i=8*t.modules[a].n64;return function(){const o=t.addFunction(e+"_zero");o.addParam("px","i32"),o.addParam("n","i32"),o.addLocal("lastp","i32"),o.addLocal("p","i32");const n=o.getCodeBuilder();o.addCode(n.setLocal("p",n.getLocal("px")),n.setLocal("lastp",n.i32_add(n.getLocal("px"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("p"),n.getLocal("lastp"))),n.call(a+"_zero",n.getLocal("p")),n.setLocal("p",n.i32_add(n.getLocal("p"),n.i32_const(i))),n.br(0))))}(),function(){const o=t.addFunction(e+"_constructLC");o.addParam("ppolynomials","i32"),o.addParam("psignals","i32"),o.addParam("nSignals","i32"),o.addParam("pres","i32"),o.addLocal("i","i32"),o.addLocal("j","i32"),o.addLocal("pp","i32"),o.addLocal("ps","i32"),o.addLocal("pd","i32"),o.addLocal("ncoefs","i32");const n=o.getCodeBuilder(),c=n.i32_const(t.alloc(i));o.addCode(n.setLocal("i",n.i32_const(0)),n.setLocal("pp",n.getLocal("ppolynomials")),n.setLocal("ps",n.getLocal("psignals")),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("nSignals"))),n.setLocal("ncoefs",n.i32_load(n.getLocal("pp"))),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(4))),n.setLocal("j",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("j"),n.getLocal("ncoefs"))),n.setLocal("pd",n.i32_add(n.getLocal("pres"),n.i32_mul(n.i32_load(n.getLocal("pp")),n.i32_const(i)))),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(4))),n.call(a+"_mul",n.getLocal("ps"),n.getLocal("pp"),c),n.call(a+"_add",c,n.getLocal("pd"),n.getLocal("pd")),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(i))),n.setLocal("j",n.i32_add(n.getLocal("j"),n.i32_const(1))),n.br(0))),n.setLocal("ps",n.i32_add(n.getLocal("ps"),n.i32_const(i))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),t.exportFunction(e+"_zero"),t.exportFunction(e+"_constructLC"),e},Kt=function(t,e,a){const i=8*t.modules[a].n64;return function(){const o=t.addFunction(e+"_buildABC");o.addParam("pCoefs","i32"),o.addParam("nCoefs","i32"),o.addParam("pWitness","i32"),o.addParam("pA","i32"),o.addParam("pB","i32"),o.addParam("pC","i32"),o.addParam("offsetOut","i32"),o.addParam("nOut","i32"),o.addParam("offsetWitness","i32"),o.addParam("nWitness","i32"),o.addLocal("it","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("last","i32"),o.addLocal("m","i32"),o.addLocal("c","i32"),o.addLocal("s","i32"),o.addLocal("pOut","i32");const n=o.getCodeBuilder(),c=n.i32_const(t.alloc(i));o.addCode(n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("nOut"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_zero",n.getLocal("ita")),n.call(a+"_zero",n.getLocal("itb")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.br(0))),n.setLocal("it",n.getLocal("pCoefs")),n.setLocal("last",n.i32_add(n.getLocal("pCoefs"),n.i32_mul(n.getLocal("nCoefs"),n.i32_const(i+12)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("it"),n.getLocal("last"))),n.setLocal("s",n.i32_load(n.getLocal("it"),8)),n.if(n.i32_or(n.i32_lt_u(n.getLocal("s"),n.getLocal("offsetWitness")),n.i32_ge_u(n.getLocal("s"),n.i32_add(n.getLocal("offsetWitness"),n.getLocal("nWitness")))),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)]),n.setLocal("m",n.i32_load(n.getLocal("it"))),n.if(n.i32_eq(n.getLocal("m"),n.i32_const(0)),n.setLocal("pOut",n.getLocal("pA")),n.if(n.i32_eq(n.getLocal("m"),n.i32_const(1)),n.setLocal("pOut",n.getLocal("pB")),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)])),n.setLocal("c",n.i32_load(n.getLocal("it"),4)),n.if(n.i32_or(n.i32_lt_u(n.getLocal("c"),n.getLocal("offsetOut")),n.i32_ge_u(n.getLocal("c"),n.i32_add(n.getLocal("offsetOut"),n.getLocal("nOut")))),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)]),n.setLocal("pOut",n.i32_add(n.getLocal("pOut"),n.i32_mul(n.i32_sub(n.getLocal("c"),n.getLocal("offsetOut")),n.i32_const(i)))),n.call(a+"_mul",n.i32_add(n.getLocal("pWitness"),n.i32_mul(n.i32_sub(n.getLocal("s"),n.getLocal("offsetWitness")),n.i32_const(i))),n.i32_add(n.getLocal("it"),n.i32_const(12)),c),n.call(a+"_add",n.getLocal("pOut"),c,n.getLocal("pOut")),n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),n.br(0))),n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("it",n.getLocal("pC")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("nOut"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_mul",n.getLocal("ita"),n.getLocal("itb"),n.getLocal("it")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i))),n.br(0))))}(),function(){const o=t.addFunction(e+"_joinABC");o.addParam("pA","i32"),o.addParam("pB","i32"),o.addParam("pC","i32"),o.addParam("n","i32"),o.addParam("pP","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("itc","i32"),o.addLocal("itp","i32"),o.addLocal("last","i32");const n=o.getCodeBuilder(),c=n.i32_const(t.alloc(i));o.addCode(n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("itc",n.getLocal("pC")),n.setLocal("itp",n.getLocal("pP")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_mul",n.getLocal("ita"),n.getLocal("itb"),c),n.call(a+"_sub",c,n.getLocal("itc"),n.getLocal("itp")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("itc",n.i32_add(n.getLocal("itc"),n.i32_const(i))),n.setLocal("itp",n.i32_add(n.getLocal("itp"),n.i32_const(i))),n.br(0))))}(),function(){const o=t.addFunction(e+"_batchAdd");o.addParam("pa","i32"),o.addParam("pb","i32"),o.addParam("n","i32"),o.addParam("pr","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("itr","i32"),o.addLocal("last","i32");const n=o.getCodeBuilder();o.addCode(n.setLocal("ita",n.getLocal("pa")),n.setLocal("itb",n.getLocal("pb")),n.setLocal("itr",n.getLocal("pr")),n.setLocal("last",n.i32_add(n.getLocal("pa"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_add",n.getLocal("ita"),n.getLocal("itb"),n.getLocal("itr")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("itr",n.i32_add(n.getLocal("itr"),n.i32_const(i))),n.br(0))))}(),t.exportFunction(e+"_buildABC"),t.exportFunction(e+"_joinABC"),t.exportFunction(e+"_batchAdd"),e},jt=function(t,e,a,i,o,n,c,r){const l=t.addFunction(e);l.addParam("pIn","i32"),l.addParam("n","i32"),l.addParam("pFirst","i32"),l.addParam("pInc","i32"),l.addParam("pOut","i32"),l.addLocal("pOldFree","i32"),l.addLocal("i","i32"),l.addLocal("pFrom","i32"),l.addLocal("pTo","i32");const s=l.getCodeBuilder(),d=s.i32_const(t.alloc(c));l.addCode(s.setLocal("pFrom",s.getLocal("pIn")),s.setLocal("pTo",s.getLocal("pOut"))),l.addCode(s.call(i+"_copy",s.getLocal("pFirst"),d)),l.addCode(s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(r,s.getLocal("pFrom"),d,s.getLocal("pTo")),s.setLocal("pFrom",s.i32_add(s.getLocal("pFrom"),s.i32_const(o))),s.setLocal("pTo",s.i32_add(s.getLocal("pTo"),s.i32_const(n))),s.call(i+"_mul",d,s.getLocal("pInc"),d),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))),t.exportFunction(e)};const Ht=H,$t=Ct,Yt=Et,Wt=Gt,Zt=Ot,Jt=Mt,Xt=Nt,te=Vt,ee=Kt,ae=jt,{bitLength:ie,modInv:oe,isOdd:ne,isNegative:ce}=J;const re=H,le=Ct,se=Et,de=Gt,ue=Ot,ge=Mt,_e=Nt,fe=Vt,he=Kt,pe=jt,{bitLength:me,isOdd:Le,isNegative:we}=J;var Ae=function(t,e){const a=e||"bn128";if(t.modules[a])return a;const i=21888242871839275222246405745257275088696311157297823662689037894645226208583n,o=21888242871839275222246405745257275088548364400416034343698204186575808495617n,n=Math.floor((ie(i-1n)-1)/64)+1,c=8*n,r=c,l=c,s=2*l,d=12*l,u=t.alloc(Ht.bigInt2BytesLE(o,r)),g=$t(t,i,"f1m");Yt(t,o,"fr","frm");const _=t.alloc(Ht.bigInt2BytesLE(w(3n),l)),f=Jt(t,"g1m","f1m",_);Xt(t,"frm","frm","frm","frm_mul"),te(t,"pol","frm"),ee(t,"qap","frm");const h=Wt(t,"f1m_neg","f2m","f1m"),p=t.alloc([...Ht.bigInt2BytesLE(w(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...Ht.bigInt2BytesLE(w(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]),m=Jt(t,"g2m","f2m",p);function L(e,a){const i=t.addFunction(e);i.addParam("pG","i32"),i.addParam("pFr","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(c));i.addCode(o.call("frm_fromMontgomery",o.getLocal("pFr"),n),o.call(a,o.getLocal("pG"),n,o.i32_const(c),o.getLocal("pr"))),t.exportFunction(e)}function w(t){return BigInt(t)*(1n<<BigInt(8*l))%i}L("g1m_timesFr","g1m_timesScalar"),Xt(t,"g1m","g1m","frm","g1m_timesFr"),L("g2m_timesFr","g2m_timesScalar"),Xt(t,"g2m","g2m","frm","g2m_timesFr"),L("g1m_timesFrAffine","g1m_timesScalarAffine"),L("g2m_timesFrAffine","g2m_timesScalarAffine"),ae(t,"frm_batchApplyKey","fmr","frm",c,c,c,"frm_mul"),ae(t,"g1m_batchApplyKey","g1m","frm",3*c,3*c,c,"g1m_timesFr"),ae(t,"g1m_batchApplyKeyMixed","g1m","frm",2*c,3*c,c,"g1m_timesFrAffine"),ae(t,"g2m_batchApplyKey","g2m","frm",2*c*3,3*c*2,c,"g2m_timesFr"),ae(t,"g2m_batchApplyKeyMixed","g2m","frm",2*c*2,3*c*2,c,"g2m_timesFrAffine");const A=[1n,2n,1n],b=t.alloc([...Ht.bigInt2BytesLE(w(A[0]),l),...Ht.bigInt2BytesLE(w(A[1]),l),...Ht.bigInt2BytesLE(w(A[2]),l)]),y=[0n,1n,0n],I=t.alloc([...Ht.bigInt2BytesLE(w(y[0]),l),...Ht.bigInt2BytesLE(w(y[1]),l),...Ht.bigInt2BytesLE(w(y[2]),l)]),C=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],F=t.alloc([...Ht.bigInt2BytesLE(w(C[0][0]),l),...Ht.bigInt2BytesLE(w(C[0][1]),l),...Ht.bigInt2BytesLE(w(C[1][0]),l),...Ht.bigInt2BytesLE(w(C[1][1]),l),...Ht.bigInt2BytesLE(w(C[2][0]),l),...Ht.bigInt2BytesLE(w(C[2][1]),l)]),x=[[0n,0n],[1n,0n],[0n,0n]],E=t.alloc([...Ht.bigInt2BytesLE(w(x[0][0]),l),...Ht.bigInt2BytesLE(w(x[0][1]),l),...Ht.bigInt2BytesLE(w(x[1][0]),l),...Ht.bigInt2BytesLE(w(x[1][1]),l),...Ht.bigInt2BytesLE(w(x[2][0]),l),...Ht.bigInt2BytesLE(w(x[2][1]),l)]),B=t.alloc([...Ht.bigInt2BytesLE(w(1),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l)]),v=t.alloc([...Ht.bigInt2BytesLE(w(9),l),...Ht.bigInt2BytesLE(w(1),l)]),S=t.alloc([...Ht.bigInt2BytesLE(w(oe(2n,i)),l),...Ht.bigInt2BytesLE(0n,l)]),G=v,P=t.alloc([...Ht.bigInt2BytesLE(w(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...Ht.bigInt2BytesLE(w(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]);!function(){const e=t.addFunction(a+"_mulNR6");e.addParam("x","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(h+"_mul",i.i32_const(v),i.getLocal("x"),i.getLocal("pr")))}();const U=Zt(t,a+"_mulNR6","f6m","f2m");!function(){const e=t.addFunction(a+"_mulNR12");e.addParam("x","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(h+"_mul",i.i32_const(v),i.i32_add(i.getLocal("x"),i.i32_const(4*c)),i.getLocal("pr")),i.call(h+"_copy",i.getLocal("x"),i.i32_add(i.getLocal("pr"),i.i32_const(2*c))),i.call(h+"_copy",i.i32_add(i.getLocal("x"),i.i32_const(2*c)),i.i32_add(i.getLocal("pr"),i.i32_const(4*c))))}();const O=Wt(t,a+"_mulNR12","ftm",U),z=function(t){let e=t;const a=[];for(;e>0n;)ne(e)?a.push(1):a.push(0),e>>=1n;return a}(29793968203157093288n),Q=t.alloc(z),q=3*s,M=z.length-1,T=z.reduce(((t,e)=>t+(0!=e?1:0)),0),k=6*c,R=3*c*2+(T+M+1)*q;t.modules[a]={n64:n,pG1gen:b,pG1zero:I,pG1b:_,pG2gen:F,pG2zero:E,pG2b:p,pq:t.modules.f1m.pq,pr:u,pOneT:B,prePSize:k,preQSize:R,r:o.toString(),q:i.toString()};const D=4965661367192848881n;function N(e){const o=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],n=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],c=t.addFunction(a+"__frobeniusMap"+e);c.addParam("x","i32"),c.addParam("r","i32");const r=c.getCodeBuilder();for(let a=0;a<6;a++){const i=0==a?r.getLocal("x"):r.i32_add(r.getLocal("x"),r.i32_const(a*s)),u=i,_=r.i32_add(r.getLocal("x"),r.i32_const(a*s+l)),f=0==a?r.getLocal("r"):r.i32_add(r.getLocal("r"),r.i32_const(a*s)),p=f,m=r.i32_add(r.getLocal("r"),r.i32_const(a*s+l)),L=d(o[Math.floor(a/3)][e%12],n[a%3][e%6]),A=t.alloc([...Ht.bigInt2BytesLE(w(L[0]),32),...Ht.bigInt2BytesLE(w(L[1]),32)]);e%2==1?c.addCode(r.call(g+"_copy",u,p),r.call(g+"_neg",_,m),r.call(h+"_mul",f,r.i32_const(A),f)):c.addCode(r.call(h+"_mul",i,r.i32_const(A),f))}function d(t,e){const a=BigInt(t[0]),o=BigInt(t[1]),n=BigInt(e[0]),c=BigInt(e[1]),r=[(a*n-o*c)%i,(a*c+o*n)%i];return ce(r[0])&&(r[0]=r[0]+i),r}}function V(e,i){const o=function(t){let e=t;const a=[];for(;e>0n;){if(ne(e)){const t=2-Number(e%4n);a.push(t),e-=BigInt(t)}else a.push(0);e>>=1n}return a}(e).map((t=>-1==t?255:t)),n=t.alloc(o),c=t.addFunction(a+"__cyclotomicExp_"+i);c.addParam("x","i32"),c.addParam("r","i32"),c.addLocal("bit","i32"),c.addLocal("i","i32");const r=c.getCodeBuilder(),l=r.getLocal("x"),s=r.getLocal("r"),u=r.i32_const(t.alloc(d));c.addCode(r.call(O+"_conjugate",l,u),r.call(O+"_one",s),r.if(r.teeLocal("bit",r.i32_load8_s(r.i32_const(o.length-1),n)),r.if(r.i32_eq(r.getLocal("bit"),r.i32_const(1)),r.call(O+"_mul",s,l,s),r.call(O+"_mul",s,u,s))),r.setLocal("i",r.i32_const(o.length-2)),r.block(r.loop(r.call(a+"__cyclotomicSquare",s,s),r.if(r.teeLocal("bit",r.i32_load8_s(r.getLocal("i"),n)),r.if(r.i32_eq(r.getLocal("bit"),r.i32_const(1)),r.call(O+"_mul",s,l,s),r.call(O+"_mul",s,u,s))),r.br_if(1,r.i32_eqz(r.getLocal("i"))),r.setLocal("i",r.i32_sub(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function K(){!function(){const e=t.addFunction(a+"__cyclotomicSquare");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(s)),c=i.i32_add(i.getLocal("x"),i.i32_const(2*s)),r=i.i32_add(i.getLocal("x"),i.i32_const(3*s)),l=i.i32_add(i.getLocal("x"),i.i32_const(4*s)),d=i.i32_add(i.getLocal("x"),i.i32_const(5*s)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(s)),_=i.i32_add(i.getLocal("r"),i.i32_const(2*s)),f=i.i32_add(i.getLocal("r"),i.i32_const(3*s)),p=i.i32_add(i.getLocal("r"),i.i32_const(4*s)),m=i.i32_add(i.getLocal("r"),i.i32_const(5*s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s)),y=i.i32_const(t.alloc(s)),I=i.i32_const(t.alloc(s)),C=i.i32_const(t.alloc(s)),F=i.i32_const(t.alloc(s));e.addCode(i.call(h+"_mul",o,l,C),i.call(h+"_mul",l,i.i32_const(v),L),i.call(h+"_add",o,L,L),i.call(h+"_add",o,l,F),i.call(h+"_mul",F,L,L),i.call(h+"_mul",i.i32_const(v),C,F),i.call(h+"_add",C,F,F),i.call(h+"_sub",L,F,L),i.call(h+"_add",C,C,w),i.call(h+"_mul",r,c,C),i.call(h+"_mul",c,i.i32_const(v),A),i.call(h+"_add",r,A,A),i.call(h+"_add",r,c,F),i.call(h+"_mul",F,A,A),i.call(h+"_mul",i.i32_const(v),C,F),i.call(h+"_add",C,F,F),i.call(h+"_sub",A,F,A),i.call(h+"_add",C,C,b),i.call(h+"_mul",n,d,C),i.call(h+"_mul",d,i.i32_const(v),y),i.call(h+"_add",n,y,y),i.call(h+"_add",n,d,F),i.call(h+"_mul",F,y,y),i.call(h+"_mul",i.i32_const(v),C,F),i.call(h+"_add",C,F,F),i.call(h+"_sub",y,F,y),i.call(h+"_add",C,C,I),i.call(h+"_sub",L,o,u),i.call(h+"_add",u,u,u),i.call(h+"_add",L,u,u),i.call(h+"_add",w,l,p),i.call(h+"_add",p,p,p),i.call(h+"_add",w,p,p),i.call(h+"_mul",I,i.i32_const(G),F),i.call(h+"_add",F,r,f),i.call(h+"_add",f,f,f),i.call(h+"_add",F,f,f),i.call(h+"_sub",y,c,_),i.call(h+"_add",_,_,_),i.call(h+"_add",y,_,_),i.call(h+"_sub",A,n,g),i.call(h+"_add",g,g,g),i.call(h+"_add",A,g,g),i.call(h+"_add",b,d,m),i.call(h+"_add",m,m,m),i.call(h+"_add",b,m,m))}(),V(D,"w0");const e=t.addFunction(a+"__finalExponentiationLastChunk");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),c=i.i32_const(t.alloc(d)),r=i.i32_const(t.alloc(d)),l=i.i32_const(t.alloc(d)),u=i.i32_const(t.alloc(d)),g=i.i32_const(t.alloc(d)),_=i.i32_const(t.alloc(d)),f=i.i32_const(t.alloc(d)),p=i.i32_const(t.alloc(d)),m=i.i32_const(t.alloc(d)),L=i.i32_const(t.alloc(d)),w=i.i32_const(t.alloc(d)),A=i.i32_const(t.alloc(d)),b=i.i32_const(t.alloc(d)),y=i.i32_const(t.alloc(d)),I=i.i32_const(t.alloc(d)),C=i.i32_const(t.alloc(d)),F=i.i32_const(t.alloc(d)),x=i.i32_const(t.alloc(d)),E=i.i32_const(t.alloc(d)),B=i.i32_const(t.alloc(d)),S=i.i32_const(t.alloc(d));e.addCode(i.call(a+"__cyclotomicExp_w0",o,c),i.call(O+"_conjugate",c,c),i.call(a+"__cyclotomicSquare",c,r),i.call(a+"__cyclotomicSquare",r,l),i.call(O+"_mul",l,r,u),i.call(a+"__cyclotomicExp_w0",u,g),i.call(O+"_conjugate",g,g),i.call(a+"__cyclotomicSquare",g,_),i.call(a+"__cyclotomicExp_w0",_,f),i.call(O+"_conjugate",f,f),i.call(O+"_conjugate",u,p),i.call(O+"_conjugate",f,m),i.call(O+"_mul",m,g,L),i.call(O+"_mul",L,p,w),i.call(O+"_mul",w,r,A),i.call(O+"_mul",w,g,b),i.call(O+"_mul",b,o,y),i.call(a+"__frobeniusMap1",A,I),i.call(O+"_mul",I,y,C),i.call(a+"__frobeniusMap2",w,F),i.call(O+"_mul",F,C,x),i.call(O+"_conjugate",o,E),i.call(O+"_mul",E,A,B),i.call(a+"__frobeniusMap3",B,S),i.call(O+"_mul",S,x,n))}const j=t.alloc(k),H=t.alloc(R);function $(e){const i=t.addFunction(a+"_pairingEq"+e);for(let t=0;t<e;t++)i.addParam("p_"+t,"i32"),i.addParam("q_"+t,"i32");i.addParam("c","i32"),i.setReturnType("i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(d)),c=o.i32_const(t.alloc(d));i.addCode(o.call(O+"_one",n));for(let t=0;t<e;t++)i.addCode(o.call(a+"_prepareG1",o.getLocal("p_"+t),o.i32_const(j))),i.addCode(o.call(a+"_prepareG2",o.getLocal("q_"+t),o.i32_const(H))),i.addCode(o.call(a+"_millerLoop",o.i32_const(j),o.i32_const(H),c)),i.addCode(o.call(O+"_mul",n,c,n));i.addCode(o.call(a+"_finalExponentiation",n,n)),i.addCode(o.call(O+"_eq",n,o.getLocal("c")))}!function(){const e=t.addFunction(a+"_prepAddStep");e.addParam("pQ","i32"),e.addParam("pR","i32"),e.addParam("pCoef","i32");const i=e.getCodeBuilder(),o=i.getLocal("pQ"),n=i.i32_add(i.getLocal("pQ"),i.i32_const(s)),c=i.getLocal("pR"),r=i.i32_add(i.getLocal("pR"),i.i32_const(s)),l=i.i32_add(i.getLocal("pR"),i.i32_const(2*s)),d=i.getLocal("pCoef"),u=i.i32_add(i.getLocal("pCoef"),i.i32_const(s)),g=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*s)),_=u,f=i.i32_const(t.alloc(s)),p=i.i32_const(t.alloc(s)),m=i.i32_const(t.alloc(s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s));e.addCode(i.call(h+"_mul",o,l,_),i.call(h+"_sub",c,_,_),i.call(h+"_mul",n,l,f),i.call(h+"_sub",r,f,f),i.call(h+"_square",_,p),i.call(h+"_square",f,m),i.call(h+"_mul",_,p,L),i.call(h+"_mul",c,p,w),i.call(h+"_add",w,w,b),i.call(h+"_mul",l,m,A),i.call(h+"_add",L,A,A),i.call(h+"_sub",A,b,A),i.call(h+"_mul",_,A,c),i.call(h+"_mul",L,r,r),i.call(h+"_sub",w,A,b),i.call(h+"_mul",f,b,b),i.call(h+"_sub",b,r,r),i.call(h+"_mul",l,L,l),i.call(h+"_mul",_,n,b),i.call(h+"_mul",f,o,d),i.call(h+"_sub",d,b,d),i.call(h+"_mul",d,i.i32_const(G),d),i.call(h+"_neg",f,g))}(),function(){const e=t.addFunction(a+"_prepDblStep");e.addParam("pR","i32"),e.addParam("pCoef","i32");const i=e.getCodeBuilder(),o=i.getLocal("pR"),n=i.i32_add(i.getLocal("pR"),i.i32_const(s)),c=i.i32_add(i.getLocal("pR"),i.i32_const(2*s)),r=i.getLocal("pCoef"),l=i.i32_add(i.getLocal("pCoef"),i.i32_const(s)),d=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*s)),u=i.i32_const(t.alloc(s)),g=i.i32_const(t.alloc(s)),_=i.i32_const(t.alloc(s)),f=i.i32_const(t.alloc(s)),p=i.i32_const(t.alloc(s)),m=i.i32_const(t.alloc(s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s)),y=i.i32_const(t.alloc(s)),I=i.i32_const(t.alloc(s));e.addCode(i.call(h+"_mul",n,i.i32_const(S),u),i.call(h+"_mul",o,u,u),i.call(h+"_square",n,g),i.call(h+"_square",c,_),i.call(h+"_add",_,_,f),i.call(h+"_add",f,_,f),i.call(h+"_mul",i.i32_const(P),f,p),i.call(h+"_add",p,p,m),i.call(h+"_add",p,m,m),i.call(h+"_add",g,m,L),i.call(h+"_mul",L,i.i32_const(S),L),i.call(h+"_add",g,_,I),i.call(h+"_add",n,c,w),i.call(h+"_square",w,w),i.call(h+"_sub",w,I,w),i.call(h+"_sub",p,g,A),i.call(h+"_square",o,b),i.call(h+"_square",p,y),i.call(h+"_sub",g,m,I),i.call(h+"_mul",u,I,o),i.call(h+"_add",y,y,I),i.call(h+"_add",y,I,I),i.call(h+"_square",L,n),i.call(h+"_sub",n,I,n),i.call(h+"_mul",g,w,c),i.call(h+"_mul",i.i32_const(G),A,r),i.call(h+"_neg",w,l),i.call(h+"_add",b,b,d),i.call(h+"_add",b,d,d))}(),function(){const e=t.addFunction(a+"_prepareG1");e.addParam("pP","i32"),e.addParam("ppreP","i32");const i=e.getCodeBuilder();e.addCode(i.call(f+"_normalize",i.getLocal("pP"),i.getLocal("ppreP")))}(),function(){!function(){const e=t.addFunction(a+"_mulByQ");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),o=i.getLocal("p1"),n=i.i32_add(i.getLocal("p1"),i.i32_const(s)),c=i.i32_add(i.getLocal("p1"),i.i32_const(2*s)),r=i.getLocal("pr"),d=i.i32_add(i.getLocal("pr"),i.i32_const(s)),u=i.i32_add(i.getLocal("pr"),i.i32_const(2*s)),g=i.i32_const(t.alloc([...Ht.bigInt2BytesLE(w("21575463638280843010398324269430826099269044274347216827212613867836435027261"),l),...Ht.bigInt2BytesLE(w("10307601595873709700152284273816112264069230130616436755625194854815875713954"),l)])),_=i.i32_const(t.alloc([...Ht.bigInt2BytesLE(w("2821565182194536844548159561693502659359617185244120367078079554186484126554"),l),...Ht.bigInt2BytesLE(w("3505843767911556378687030309984248845540243509899259641013678093033130930403"),l)]));e.addCode(i.call(h+"_conjugate",o,r),i.call(h+"_mul",g,r,r),i.call(h+"_conjugate",n,d),i.call(h+"_mul",_,d,d),i.call(h+"_conjugate",c,u))}();const e=t.addFunction(a+"_prepareG2");e.addParam("pQ","i32"),e.addParam("ppreQ","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),o=i.getLocal("pQ"),n=t.alloc(3*s),c=i.i32_const(n),r=i.i32_const(n),d=i.i32_const(n+s),u=i.i32_const(n+2*s),g=i.i32_add(i.getLocal("ppreQ"),i.i32_const(0)),_=i.i32_add(i.getLocal("ppreQ"),i.i32_const(s)),f=t.alloc(3*s),p=i.i32_const(f),L=t.alloc(3*s),A=i.i32_const(L),b=i.i32_const(L+s);e.addCode(i.call(m+"_normalize",o,g),i.call(h+"_copy",g,r),i.call(h+"_copy",_,d),i.call(h+"_one",u)),e.addCode(i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*s))),i.setLocal("i",i.i32_const(z.length-2)),i.block(i.loop(i.call(a+"_prepDblStep",c,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))),i.if(i.i32_load8_s(i.getLocal("i"),Q),[...i.call(a+"_prepAddStep",g,c,i.getLocal("pCoef")),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0)))),e.addCode(i.call(a+"_mulByQ",g,p),i.call(a+"_mulByQ",p,A)),e.addCode(i.call(h+"_neg",b,b),i.call(a+"_prepAddStep",p,c,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))),i.call(a+"_prepAddStep",A,c,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))))}(),function(){const e=t.addFunction(a+"__mulBy024");e.addParam("pEll0","i32"),e.addParam("pEllVW","i32"),e.addParam("pEllVV","i32"),e.addParam("pR","i32");const i=e.getCodeBuilder(),o=i.getLocal("pEll0"),n=i.getLocal("pEllVV"),r=i.getLocal("pEllVW"),l=i.getLocal("pR"),d=i.i32_add(i.getLocal("pR"),i.i32_const(2*c)),u=i.i32_add(i.getLocal("pR"),i.i32_const(4*c)),g=i.i32_add(i.getLocal("pR"),i.i32_const(6*c)),_=i.i32_add(i.getLocal("pR"),i.i32_const(8*c)),f=i.i32_add(i.getLocal("pR"),i.i32_const(10*c)),p=i.i32_const(t.alloc(s)),m=i.i32_const(t.alloc(s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s)),y=i.i32_const(t.alloc(s)),I=i.i32_const(t.alloc(s)),C=i.i32_const(t.alloc(s)),F=i.i32_const(t.alloc(s)),x=i.i32_const(t.alloc(s));e.addCode(i.call(h+"_mul",l,o,y),i.call(h+"_mul",u,n,I),i.call(h+"_mul",_,r,C),i.call(h+"_add",l,_,L),i.call(h+"_add",l,u,m),i.call(h+"_add",d,g,w),i.call(h+"_add",w,f,w),i.call(h+"_mul",d,n,F),i.call(h+"_add",F,C,A),i.call(h+"_mul",i.i32_const(v),A,b),i.call(h+"_add",b,y,l),i.call(h+"_mul",f,r,A),i.call(h+"_add",F,A,F),i.call(h+"_add",A,I,A),i.call(h+"_mul",i.i32_const(v),A,b),i.call(h+"_mul",d,o,A),i.call(h+"_add",F,A,F),i.call(h+"_add",b,A,d),i.call(h+"_add",o,n,p),i.call(h+"_mul",m,p,A),i.call(h+"_add",y,I,x),i.call(h+"_sub",A,x,A),i.call(h+"_mul",g,r,b),i.call(h+"_add",F,b,F),i.call(h+"_add",u,_,p),i.call(h+"_add",A,b,u),i.call(h+"_add",n,r,m),i.call(h+"_mul",m,p,A),i.call(h+"_add",I,C,x),i.call(h+"_sub",A,x,A),i.call(h+"_mul",i.i32_const(v),A,b),i.call(h+"_mul",g,o,A),i.call(h+"_add",F,A,F),i.call(h+"_add",b,A,g),i.call(h+"_mul",f,n,A),i.call(h+"_add",F,A,F),i.call(h+"_mul",i.i32_const(v),A,b),i.call(h+"_add",o,r,p),i.call(h+"_mul",L,p,A),i.call(h+"_add",y,C,x),i.call(h+"_sub",A,x,A),i.call(h+"_add",b,A,_),i.call(h+"_add",o,n,p),i.call(h+"_add",p,r,p),i.call(h+"_mul",w,p,A),i.call(h+"_sub",A,F,f))}(),function(){const e=t.addFunction(a+"__mulBy024Old");e.addParam("pEll0","i32"),e.addParam("pEllVW","i32"),e.addParam("pEllVV","i32"),e.addParam("pR","i32");const i=e.getCodeBuilder(),o=i.getLocal("pEll0"),n=i.getLocal("pEllVV"),c=i.getLocal("pEllVW"),r=i.getLocal("pR"),l=t.alloc(d),u=i.i32_const(l),g=i.i32_const(l),_=i.i32_const(l+s),f=i.i32_const(l+2*s),p=i.i32_const(l+3*s),m=i.i32_const(l+4*s),L=i.i32_const(l+5*s);e.addCode(i.call(h+"_copy",o,g),i.call(h+"_zero",_),i.call(h+"_copy",n,f),i.call(h+"_zero",p),i.call(h+"_copy",c,m),i.call(h+"_zero",L),i.call(O+"_mul",u,r,r))}(),function(){const e=t.addFunction(a+"_millerLoop");e.addParam("ppreP","i32"),e.addParam("ppreQ","i32"),e.addParam("r","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),o=i.getLocal("ppreP"),n=i.i32_add(i.getLocal("ppreP"),i.i32_const(l)),c=i.getLocal("pCoef"),r=i.i32_add(i.getLocal("pCoef"),i.i32_const(s)),d=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*s)),u=t.alloc(s),g=i.i32_const(u),_=t.alloc(s),f=i.i32_const(_),p=i.getLocal("r");e.addCode(i.call(O+"_one",p),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*s))),i.setLocal("i",i.i32_const(z.length-2)),i.block(i.loop(i.call(O+"_square",p,p),i.call(h+"_mul1",r,n,g),i.call(h+"_mul1",d,o,f),i.call(a+"__mulBy024",c,g,f,p),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))),i.if(i.i32_load8_s(i.getLocal("i"),Q),[...i.call(h+"_mul1",r,n,g),...i.call(h+"_mul1",d,o,f),...i.call(a+"__mulBy024",c,g,f,p),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0)))),e.addCode(i.call(h+"_mul1",r,n,g),i.call(h+"_mul1",d,o,f),i.call(a+"__mulBy024",c,g,f,p),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))),i.call(h+"_mul1",r,n,g),i.call(h+"_mul1",d,o,f),i.call(a+"__mulBy024",c,g,f,p),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))))}();for(let e=0;e<10;e++)N(e),t.exportFunction(a+"__frobeniusMap"+e);!function(){const e=t.addFunction(a+"_finalExponentiationOld");e.addParam("x","i32"),e.addParam("r","i32");const i=t.alloc(Ht.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),o=e.getCodeBuilder();e.addCode(o.call(O+"_exp",o.getLocal("x"),o.i32_const(i),o.i32_const(352),o.getLocal("r")))}(),function(){!function(){const e=t.addFunction(a+"__finalExponentiationFirstChunk");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=o,r=i.i32_add(o,i.i32_const(6*c)),l=i.getLocal("r"),s=t.alloc(d),u=i.i32_const(s),g=u,_=i.i32_const(s+6*c),f=i.i32_const(t.alloc(d)),h=i.i32_const(t.alloc(d)),p=i.i32_const(t.alloc(d));e.addCode(i.call(U+"_copy",n,g),i.call(U+"_neg",r,_),i.call(O+"_inverse",o,f),i.call(O+"_mul",u,f,h),i.call(a+"__frobeniusMap2",h,p),i.call(O+"_mul",h,p,l))}(),K();const e=t.addFunction(a+"_finalExponentiation");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),r=i.i32_const(t.alloc(d));e.addCode(i.call(a+"__finalExponentiationFirstChunk",o,r),i.call(a+"__finalExponentiationLastChunk",r,n))}();for(let e=1;e<=5;e++)$(e),t.exportFunction(a+"_pairingEq"+e);!function(){const e=t.addFunction(a+"_pairing");e.addParam("p","i32"),e.addParam("q","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.i32_const(t.alloc(d));e.addCode(i.call(a+"_prepareG1",i.getLocal("p"),i.i32_const(j))),e.addCode(i.call(a+"_prepareG2",i.getLocal("q"),i.i32_const(H))),e.addCode(i.call(a+"_millerLoop",i.i32_const(j),i.i32_const(H),o)),e.addCode(i.call(a+"_finalExponentiation",o,i.getLocal("r")))}(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__mulBy024"),t.exportFunction(a+"__mulBy024Old"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0")},be=function(t,e){const a=e||"bls12381";if(t.modules[a])return a;const i=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,o=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,n=Math.floor((me(i-1n)-1)/64)+1,c=8*n,r=c,l=2*r,s=12*r,d=Math.floor((me(o-1n)-1)/64)+1,u=8*d,g=u,_=t.alloc(re.bigInt2BytesLE(o,g)),f=le(t,i,"f1m","intq");se(t,o,"fr","frm","intr");const h=t.alloc(re.bigInt2BytesLE(b(4n),r)),p=ge(t,"g1m","f1m",h);_e(t,"frm","frm","frm","frm_mul"),fe(t,"pol","frm"),he(t,"qap","frm");const m=de(t,"f1m_neg","f2m","f1m"),L=t.alloc([...re.bigInt2BytesLE(b(4n),r),...re.bigInt2BytesLE(b(4n),r)]),w=ge(t,"g2m","f2m",L);function A(e,a){const i=t.addFunction(e);i.addParam("pG","i32"),i.addParam("pFr","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(u));i.addCode(o.call("frm_fromMontgomery",o.getLocal("pFr"),n),o.call(a,o.getLocal("pG"),n,o.i32_const(u),o.getLocal("pr"))),t.exportFunction(e)}function b(t){return BigInt(t)*(1n<<BigInt(8*r))%i}A("g1m_timesFr","g1m_timesScalar"),_e(t,"g1m","g1m","frm","g1m_timesFr"),A("g2m_timesFr","g2m_timesScalar"),_e(t,"g2m","g2m","frm","g2m_timesFr"),A("g1m_timesFrAffine","g1m_timesScalarAffine"),A("g2m_timesFrAffine","g2m_timesScalarAffine"),pe(t,"frm_batchApplyKey","fmr","frm",u,u,u,"frm_mul"),pe(t,"g1m_batchApplyKey","g1m","frm",3*c,3*c,u,"g1m_timesFr"),pe(t,"g1m_batchApplyKeyMixed","g1m","frm",2*c,3*c,u,"g1m_timesFrAffine"),pe(t,"g2m_batchApplyKey","g2m","frm",2*c*3,3*c*2,u,"g2m_timesFr"),pe(t,"g2m_batchApplyKeyMixed","g2m","frm",2*c*2,3*c*2,u,"g2m_timesFrAffine");const y=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],I=t.alloc([...re.bigInt2BytesLE(b(y[0]),r),...re.bigInt2BytesLE(b(y[1]),r),...re.bigInt2BytesLE(b(y[2]),r)]),C=[0n,1n,0n],F=t.alloc([...re.bigInt2BytesLE(b(C[0]),r),...re.bigInt2BytesLE(b(C[1]),r),...re.bigInt2BytesLE(b(C[2]),r)]),x=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],E=t.alloc([...re.bigInt2BytesLE(b(x[0][0]),r),...re.bigInt2BytesLE(b(x[0][1]),r),...re.bigInt2BytesLE(b(x[1][0]),r),...re.bigInt2BytesLE(b(x[1][1]),r),...re.bigInt2BytesLE(b(x[2][0]),r),...re.bigInt2BytesLE(b(x[2][1]),r)]),B=[[0n,0n],[1n,0n],[0n,0n]],v=t.alloc([...re.bigInt2BytesLE(b(B[0][0]),r),...re.bigInt2BytesLE(b(B[0][1]),r),...re.bigInt2BytesLE(b(B[1][0]),r),...re.bigInt2BytesLE(b(B[1][1]),r),...re.bigInt2BytesLE(b(B[2][0]),r),...re.bigInt2BytesLE(b(B[2][1]),r)]),S=t.alloc([...re.bigInt2BytesLE(b(1n),r),...re.bigInt2BytesLE(b(0n),r),...re.bigInt2BytesLE(b(0n),r),...re.bigInt2BytesLE(b(0n),r),...re.bigInt2BytesLE(b(0n),r),...re.bigInt2BytesLE(b(0n),r),...re.bigInt2BytesLE(b(0n),r),...re.bigInt2BytesLE(b(0n),r),...re.bigInt2BytesLE(b(0n),r),...re.bigInt2BytesLE(b(0n),r),...re.bigInt2BytesLE(b(0n),r),...re.bigInt2BytesLE(b(0n),r)]),G=t.alloc([...re.bigInt2BytesLE(b(1n),r),...re.bigInt2BytesLE(b(1n),r)]);!function(){const e=t.addFunction(m+"_mulNR");e.addParam("x","i32"),e.addParam("pr","i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(r)),o=a.getLocal("x"),n=a.i32_add(a.getLocal("x"),a.i32_const(r)),c=a.getLocal("pr"),l=a.i32_add(a.getLocal("pr"),a.i32_const(r));e.addCode(a.call(f+"_copy",o,i),a.call(f+"_sub",o,n,c),a.call(f+"_add",i,n,l))}();const P=ue(t,m+"_mulNR","f6m","f2m");!function(){const e=t.addFunction(P+"_mulNR");e.addParam("x","i32"),e.addParam("pr","i32");const a=e.getCodeBuilder(),i=a.i32_const(t.alloc(2*r));e.addCode(a.call(m+"_copy",a.getLocal("x"),i),a.call(m+"_mulNR",a.i32_add(a.getLocal("x"),a.i32_const(4*c)),a.getLocal("pr")),a.call(m+"_copy",a.i32_add(a.getLocal("x"),a.i32_const(2*c)),a.i32_add(a.getLocal("pr"),a.i32_const(4*c))),a.call(m+"_copy",i,a.i32_add(a.getLocal("pr"),a.i32_const(2*c))))}();const U=de(t,P+"_mulNR","ftm",P),O=function(t){let e=t;const a=[];for(;e>0n;)Le(e)?a.push(1):a.push(0),e>>=1n;return a}(0xd201000000010000n),z=t.alloc(O),Q=3*l,q=O.length-1,M=O.reduce(((t,e)=>t+(0!=e?1:0)),0),T=6*c,k=3*c*2+(M+q+1)*Q,R=15132376222941642752n;function D(e){const a=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],o=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],n=t.addFunction(U+"_frobeniusMap"+e);n.addParam("x","i32"),n.addParam("r","i32");const s=n.getCodeBuilder();for(let i=0;i<6;i++){const u=0==i?s.getLocal("x"):s.i32_add(s.getLocal("x"),s.i32_const(i*l)),g=u,_=s.i32_add(s.getLocal("x"),s.i32_const(i*l+r)),h=0==i?s.getLocal("r"):s.i32_add(s.getLocal("r"),s.i32_const(i*l)),p=h,L=s.i32_add(s.getLocal("r"),s.i32_const(i*l+r)),w=d(a[Math.floor(i/3)][e%12],o[i%3][e%6]),A=t.alloc([...re.bigInt2BytesLE(b(w[0]),c),...re.bigInt2BytesLE(b(w[1]),c)]);e%2==1?n.addCode(s.call(f+"_copy",g,p),s.call(f+"_neg",_,L),s.call(m+"_mul",h,s.i32_const(A),h)):n.addCode(s.call(m+"_mul",u,s.i32_const(A),h))}function d(t,e){const a=t[0],o=t[1],n=e[0],c=e[1],r=[(a*n-o*c)%i,(a*c+o*n)%i];return we(r[0])&&(r[0]=r[0]+i),r}}function N(e,i,o){const n=function(t){let e=t;const a=[];for(;e>0n;){if(Le(e)){const t=2-Number(e%4n);a.push(t),e-=BigInt(t)}else a.push(0);e>>=1n}return a}(e).map((t=>-1==t?255:t)),c=t.alloc(n),r=t.addFunction(a+"__cyclotomicExp_"+o);r.addParam("x","i32"),r.addParam("r","i32"),r.addLocal("bit","i32"),r.addLocal("i","i32");const l=r.getCodeBuilder(),d=l.getLocal("x"),u=l.getLocal("r"),g=l.i32_const(t.alloc(s));r.addCode(l.call(U+"_conjugate",d,g),l.call(U+"_one",u),l.if(l.teeLocal("bit",l.i32_load8_s(l.i32_const(n.length-1),c)),l.if(l.i32_eq(l.getLocal("bit"),l.i32_const(1)),l.call(U+"_mul",u,d,u),l.call(U+"_mul",u,g,u))),l.setLocal("i",l.i32_const(n.length-2)),l.block(l.loop(l.call(a+"__cyclotomicSquare",u,u),l.if(l.teeLocal("bit",l.i32_load8_s(l.getLocal("i"),c)),l.if(l.i32_eq(l.getLocal("bit"),l.i32_const(1)),l.call(U+"_mul",u,d,u),l.call(U+"_mul",u,g,u))),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.br(0)))),i&&r.addCode(l.call(U+"_conjugate",u,u))}t.modules[a]={n64q:n,n64r:d,n8q:c,n8r:u,pG1gen:I,pG1zero:F,pG1b:h,pG2gen:E,pG2zero:v,pG2b:L,pq:t.modules.f1m.pq,pr:_,pOneT:S,r:o,q:i,prePSize:T,preQSize:k},function(){const e=t.addFunction(P+"_mul1");e.addParam("pA","i32"),e.addParam("pC1","i32"),e.addParam("pR","i32");const a=e.getCodeBuilder(),i=a.getLocal("pA"),o=a.i32_add(a.getLocal("pA"),a.i32_const(2*r)),n=a.i32_add(a.getLocal("pA"),a.i32_const(4*r)),c=a.getLocal("pC1"),l=a.getLocal("pR"),s=a.i32_add(a.getLocal("pR"),a.i32_const(2*r)),d=a.i32_add(a.getLocal("pR"),a.i32_const(4*r)),u=a.i32_const(t.alloc(2*r)),g=a.i32_const(t.alloc(2*r));e.addCode(a.call(m+"_add",i,o,u),a.call(m+"_add",o,n,g),a.call(m+"_mul",o,c,d),a.call(m+"_mul",g,c,l),a.call(m+"_sub",l,d,l),a.call(m+"_mulNR",l,l),a.call(m+"_mul",u,c,s),a.call(m+"_sub",s,d,s))}(),function(){const e=t.addFunction(P+"_mul01");e.addParam("pA","i32"),e.addParam("pC0","i32"),e.addParam("pC1","i32"),e.addParam("pR","i32");const a=e.getCodeBuilder(),i=a.getLocal("pA"),o=a.i32_add(a.getLocal("pA"),a.i32_const(2*r)),n=a.i32_add(a.getLocal("pA"),a.i32_const(4*r)),c=a.getLocal("pC0"),l=a.getLocal("pC1"),s=a.getLocal("pR"),d=a.i32_add(a.getLocal("pR"),a.i32_const(2*r)),u=a.i32_add(a.getLocal("pR"),a.i32_const(4*r)),g=a.i32_const(t.alloc(2*r)),_=a.i32_const(t.alloc(2*r)),f=a.i32_const(t.alloc(2*r)),h=a.i32_const(t.alloc(2*r));e.addCode(a.call(m+"_mul",i,c,g),a.call(m+"_mul",o,l,_),a.call(m+"_add",i,o,f),a.call(m+"_add",i,n,h),a.call(m+"_add",o,n,s),a.call(m+"_mul",s,l,s),a.call(m+"_sub",s,_,s),a.call(m+"_mulNR",s,s),a.call(m+"_add",s,g,s),a.call(m+"_add",c,l,d),a.call(m+"_mul",d,f,d),a.call(m+"_sub",d,g,d),a.call(m+"_sub",d,_,d),a.call(m+"_mul",h,c,u),a.call(m+"_sub",u,g,u),a.call(m+"_add",u,_,u))}(),function(){const e=t.addFunction(U+"_mul014");e.addParam("pA","i32"),e.addParam("pC0","i32"),e.addParam("pC1","i32"),e.addParam("pC4","i32"),e.addParam("pR","i32");const a=e.getCodeBuilder(),i=a.getLocal("pA"),o=a.i32_add(a.getLocal("pA"),a.i32_const(6*r)),n=a.getLocal("pC0"),c=a.getLocal("pC1"),l=a.getLocal("pC4"),s=a.i32_const(t.alloc(6*r)),d=a.i32_const(t.alloc(6*r)),u=a.i32_const(t.alloc(2*r)),g=a.getLocal("pR"),_=a.i32_add(a.getLocal("pR"),a.i32_const(6*r));e.addCode(a.call(P+"_mul01",i,n,c,s),a.call(P+"_mul1",o,l,d),a.call(m+"_add",c,l,u),a.call(P+"_add",o,i,_),a.call(P+"_mul01",_,n,u,_),a.call(P+"_sub",_,s,_),a.call(P+"_sub",_,d,_),a.call(P+"_copy",d,g),a.call(P+"_mulNR",g,g),a.call(P+"_add",g,s,g))}(),function(){const e=t.addFunction(a+"_ell");e.addParam("pP","i32"),e.addParam("pCoefs","i32"),e.addParam("pF","i32");const i=e.getCodeBuilder(),o=i.getLocal("pP"),n=i.i32_add(i.getLocal("pP"),i.i32_const(c)),l=i.getLocal("pF"),s=i.getLocal("pCoefs"),d=i.i32_add(i.getLocal("pCoefs"),i.i32_const(r)),u=i.i32_add(i.getLocal("pCoefs"),i.i32_const(2*r)),g=i.i32_add(i.getLocal("pCoefs"),i.i32_const(3*r)),_=i.i32_add(i.getLocal("pCoefs"),i.i32_const(4*r)),h=t.alloc(2*r),p=i.i32_const(h),m=i.i32_const(h),L=i.i32_const(h+r),w=t.alloc(2*r),A=i.i32_const(w),b=i.i32_const(w),y=i.i32_const(w+r);e.addCode(i.call(f+"_mul",s,n,m),i.call(f+"_mul",d,n,L),i.call(f+"_mul",u,o,b),i.call(f+"_mul",g,o,y),i.call(U+"_mul014",l,_,A,p,l))}();const V=t.alloc(T),K=t.alloc(k);function j(e){const i=t.addFunction(a+"_pairingEq"+e);for(let t=0;t<e;t++)i.addParam("p_"+t,"i32"),i.addParam("q_"+t,"i32");i.addParam("c","i32"),i.setReturnType("i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(s)),c=o.i32_const(t.alloc(s));i.addCode(o.call(U+"_one",n));for(let t=0;t<e;t++)i.addCode(o.call(a+"_prepareG1",o.getLocal("p_"+t),o.i32_const(V))),i.addCode(o.call(a+"_prepareG2",o.getLocal("q_"+t),o.i32_const(K))),i.addCode(o.if(o.i32_eqz(o.call(p+"_inGroupAffine",o.i32_const(V))),o.ret(o.i32_const(0))),o.if(o.i32_eqz(o.call(w+"_inGroupAffine",o.i32_const(K))),o.ret(o.i32_const(0)))),i.addCode(o.call(a+"_millerLoop",o.i32_const(V),o.i32_const(K),c)),i.addCode(o.call(U+"_mul",n,c,n));i.addCode(o.call(a+"_finalExponentiation",n,n)),i.addCode(o.call(U+"_eq",n,o.getLocal("c")))}for(let e=0;e<10;e++)D(e),t.exportFunction(U+"_frobeniusMap"+e);!function(){const e=t.addFunction(p+"_inGroupAffine");e.addParam("p","i32"),e.setReturnType("i32");const a=e.getCodeBuilder(),i=(R*R-1n)/3n,o=a.i32_const(t.alloc(re.bigInt2BytesLE(b(4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n),c))),n=a.i32_const(t.alloc(re.bigInt2BytesLE(b(793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n),c))),l=a.i32_const(t.alloc(re.bigInt2BytesLE(i,16))),s=a.getLocal("p"),d=a.i32_add(a.getLocal("p"),a.i32_const(r)),u=t.alloc(3*r),g=a.i32_const(u),_=a.i32_const(u),h=a.i32_const(u+r),m=t.alloc(2*r),L=a.i32_const(m),w=a.i32_const(m),A=a.i32_const(m+r);e.addCode(a.if(a.call(p+"_isZeroAffine",a.getLocal("p")),a.ret(a.i32_const(1))),a.if(a.i32_eqz(a.call(p+"_inCurveAffine",a.getLocal("p"))),a.ret(a.i32_const(0))),a.call(f+"_mul",s,o,_),a.call(f+"_copy",d,h),a.call(f+"_mul",s,n,w),a.call(f+"_copy",d,A),a.call(p+"_doubleAffine",g,g),a.call(p+"_subMixed",g,a.getLocal("p"),g),a.call(p+"_subMixed",g,L,g),a.call(p+"_timesScalar",g,l,a.i32_const(16),g),a.ret(a.call(p+"_eqMixed",g,L)));const y=t.addFunction(p+"_inGroup");y.addParam("pIn","i32"),y.setReturnType("i32");const I=y.getCodeBuilder(),C=I.i32_const(t.alloc(2*r));y.addCode(I.call(p+"_toAffine",I.getLocal("pIn"),C),I.ret(I.call(p+"_inGroupAffine",C)))}(),function(){const e=t.addFunction(w+"_inGroupAffine");e.addParam("p","i32"),e.setReturnType("i32");const a=e.getCodeBuilder(),i=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],o=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],n=a.i32_const(t.alloc([...re.bigInt2BytesLE(b(i[0]),c),...re.bigInt2BytesLE(b(i[1]),c)])),s=a.i32_const(t.alloc(re.bigInt2BytesLE(b(4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n),c))),d=a.i32_const(t.alloc([...re.bigInt2BytesLE(b(o[0]),c),...re.bigInt2BytesLE(b(o[1]),c)])),u=a.i32_const(t.alloc(re.bigInt2BytesLE(R,8))),g=a.getLocal("p"),_=a.i32_add(a.getLocal("p"),a.i32_const(l)),h=a.i32_const(t.alloc(r)),p=a.i32_const(t.alloc(l)),L=a.i32_const(t.alloc(l)),A=t.alloc(2*l),y=a.i32_const(A),I=a.i32_const(A),C=a.i32_const(A),F=a.i32_const(A+r),x=a.i32_const(A+l),E=a.i32_const(A+l),B=a.i32_const(A+l+r),v=t.alloc(3*l),S=a.i32_const(v),G=a.i32_const(v),P=a.i32_const(v),U=a.i32_const(v+r),O=a.i32_const(v+l),z=a.i32_const(v+l),Q=a.i32_const(v+l+r),q=a.i32_const(v+2*l);e.addCode(a.if(a.call(w+"_isZeroAffine",a.getLocal("p")),a.ret(a.i32_const(1))),a.if(a.i32_eqz(a.call(w+"_inCurveAffine",a.getLocal("p"))),a.ret(a.i32_const(0))),a.call(m+"_mul",g,n,p),a.call(m+"_mul",_,n,L),a.call(m+"_mul1",p,s,I),a.call(m+"_neg",L,x),a.call(m+"_neg",p,G),a.call(m+"_mul",L,d,O),a.call(f+"_sub",C,F,h),a.call(f+"_add",C,F,F),a.call(f+"_copy",h,C),a.call(f+"_sub",E,B,h),a.call(f+"_add",E,B,B),a.call(f+"_copy",h,E),a.call(f+"_add",P,U,h),a.call(f+"_sub",P,U,U),a.call(f+"_copy",h,P),a.call(f+"_sub",Q,z,h),a.call(f+"_add",z,Q,Q),a.call(f+"_copy",h,z),a.call(m+"_one",q),a.call(w+"_timesScalar",S,u,a.i32_const(8),S),a.call(w+"_addMixed",S,y,S),a.ret(a.call(w+"_eqMixed",S,a.getLocal("p"))));const M=t.addFunction(w+"_inGroup");M.addParam("pIn","i32"),M.setReturnType("i32");const T=M.getCodeBuilder(),k=T.i32_const(t.alloc(2*l));M.addCode(T.call(w+"_toAffine",T.getLocal("pIn"),k),T.ret(T.call(w+"_inGroupAffine",k)))}(),function(){const e=t.addFunction(a+"_prepAddStep");e.addParam("R","i32"),e.addParam("Q","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("R"),n=i.i32_add(i.getLocal("R"),i.i32_const(2*c)),r=i.i32_add(i.getLocal("R"),i.i32_const(4*c)),s=i.getLocal("Q"),d=i.i32_add(i.getLocal("Q"),i.i32_const(2*c)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(2*c)),_=i.i32_add(i.getLocal("r"),i.i32_const(4*c)),f=i.i32_const(t.alloc(l)),h=i.i32_const(t.alloc(l)),p=i.i32_const(t.alloc(l)),L=i.i32_const(t.alloc(l)),w=i.i32_const(t.alloc(l)),A=i.i32_const(t.alloc(l)),b=i.i32_const(t.alloc(l)),y=i.i32_const(t.alloc(l)),I=i.i32_const(t.alloc(l)),C=i.i32_const(t.alloc(l)),F=i.i32_const(t.alloc(l));e.addCode(i.call(m+"_square",r,f),i.call(m+"_square",d,h),i.call(m+"_mul",f,s,L),i.call(m+"_add",d,r,g),i.call(m+"_square",g,g),i.call(m+"_sub",g,h,g),i.call(m+"_sub",g,f,g),i.call(m+"_mul",g,f,g),i.call(m+"_sub",L,o,w),i.call(m+"_square",w,A),i.call(m+"_add",A,A,b),i.call(m+"_add",b,b,b),i.call(m+"_mul",b,w,y),i.call(m+"_sub",g,n,I),i.call(m+"_sub",I,n,I),i.call(m+"_mul",I,s,_),i.call(m+"_mul",b,o,C),i.call(m+"_square",I,o),i.call(m+"_sub",o,y,o),i.call(m+"_sub",o,C,o),i.call(m+"_sub",o,C,o),i.call(m+"_add",r,w,r),i.call(m+"_square",r,r),i.call(m+"_sub",r,f,r),i.call(m+"_sub",r,A,r),i.call(m+"_add",d,r,u),i.call(m+"_sub",C,o,F),i.call(m+"_mul",F,I,F),i.call(m+"_mul",n,y,L),i.call(m+"_add",L,L,L),i.call(m+"_sub",F,L,n),i.call(m+"_square",u,u),i.call(m+"_sub",u,h,u),i.call(m+"_square",r,p),i.call(m+"_sub",u,p,u),i.call(m+"_add",_,_,_),i.call(m+"_sub",_,u,_),i.call(m+"_add",r,r,u),i.call(m+"_neg",I,I),i.call(m+"_add",I,I,g))}(),function(){const e=t.addFunction(a+"_prepDblStep");e.addParam("R","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("R"),n=i.i32_add(i.getLocal("R"),i.i32_const(2*c)),r=i.i32_add(i.getLocal("R"),i.i32_const(4*c)),s=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(2*c)),u=i.i32_add(i.getLocal("r"),i.i32_const(4*c)),g=i.i32_const(t.alloc(l)),_=i.i32_const(t.alloc(l)),f=i.i32_const(t.alloc(l)),h=i.i32_const(t.alloc(l)),p=i.i32_const(t.alloc(l));e.addCode(i.call(m+"_square",o,s),i.call(m+"_square",n,_),i.call(m+"_square",_,f),i.call(m+"_add",_,o,d),i.call(m+"_square",d,d),i.call(m+"_sub",d,s,d),i.call(m+"_sub",d,f,d),i.call(m+"_add",d,d,d),i.call(m+"_add",s,s,h),i.call(m+"_add",h,s,h),i.call(m+"_add",o,h,u),i.call(m+"_square",h,p),i.call(m+"_square",r,g),i.call(m+"_sub",p,d,o),i.call(m+"_sub",o,d,o),i.call(m+"_add",r,n,r),i.call(m+"_square",r,r),i.call(m+"_sub",r,_,r),i.call(m+"_sub",r,g,r),i.call(m+"_sub",d,o,n),i.call(m+"_mul",n,h,n),i.call(m+"_add",f,f,f),i.call(m+"_add",f,f,f),i.call(m+"_add",f,f,f),i.call(m+"_sub",n,f,n),i.call(m+"_mul",h,g,d),i.call(m+"_add",d,d,d),i.call(m+"_neg",d,d),i.call(m+"_square",u,u),i.call(m+"_sub",u,s,u),i.call(m+"_sub",u,p,u),i.call(m+"_add",_,_,_),i.call(m+"_add",_,_,_),i.call(m+"_sub",u,_,u),i.call(m+"_mul",r,g,s),i.call(m+"_add",s,s,s))}(),function(){const e=t.addFunction(a+"_prepareG1");e.addParam("pP","i32"),e.addParam("ppreP","i32");const i=e.getCodeBuilder();e.addCode(i.call(p+"_normalize",i.getLocal("pP"),i.getLocal("ppreP")))}(),function(){const e=t.addFunction(a+"_prepareG2");e.addParam("pQ","i32"),e.addParam("ppreQ","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),o=i.getLocal("pQ"),n=t.alloc(3*l),c=i.i32_const(n),r=i.getLocal("ppreQ");e.addCode(i.call(w+"_normalize",o,r),i.if(i.call(w+"_isZero",r),i.ret([])),i.call(w+"_copy",r,c),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*l)))),e.addCode(i.setLocal("i",i.i32_const(O.length-2)),i.block(i.loop(i.call(a+"_prepDblStep",c,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q))),i.if(i.i32_load8_s(i.getLocal("i"),z),[...i.call(a+"_prepAddStep",c,r,i.getLocal("pCoef")),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0))))}(),function(){const e=t.addFunction(a+"_millerLoop");e.addParam("ppreP","i32"),e.addParam("ppreQ","i32"),e.addParam("r","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),o=i.getLocal("ppreP"),n=i.getLocal("pCoef"),c=i.getLocal("r");e.addCode(i.call(U+"_one",c),i.if(i.call(p+"_isZero",o),i.ret([])),i.if(i.call(p+"_isZero",i.getLocal("ppreQ")),i.ret([])),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*l))),i.setLocal("i",i.i32_const(O.length-2)),i.block(i.loop(i.call(a+"_ell",o,n,c),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q))),i.if(i.i32_load8_s(i.getLocal("i"),z),[...i.call(a+"_ell",o,n,c),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q)))]),i.call(U+"_square",c,c),i.br_if(1,i.i32_eq(i.getLocal("i"),i.i32_const(1))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.call(a+"_ell",o,n,c)),e.addCode(i.call(U+"_conjugate",c,c))}(),function(){const e=t.addFunction(a+"_finalExponentiationOld");e.addParam("x","i32"),e.addParam("r","i32");const i=t.alloc(re.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),o=e.getCodeBuilder();e.addCode(o.call(U+"_exp",o.getLocal("x"),o.i32_const(i),o.i32_const(544),o.getLocal("r")))}(),function(){!function(){const e=t.addFunction(a+"__cyclotomicSquare");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(l)),c=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),r=i.i32_add(i.getLocal("x"),i.i32_const(3*l)),s=i.i32_add(i.getLocal("x"),i.i32_const(4*l)),d=i.i32_add(i.getLocal("x"),i.i32_const(5*l)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(l)),_=i.i32_add(i.getLocal("r"),i.i32_const(2*l)),f=i.i32_add(i.getLocal("r"),i.i32_const(3*l)),h=i.i32_add(i.getLocal("r"),i.i32_const(4*l)),p=i.i32_add(i.getLocal("r"),i.i32_const(5*l)),L=i.i32_const(t.alloc(l)),w=i.i32_const(t.alloc(l)),A=i.i32_const(t.alloc(l)),b=i.i32_const(t.alloc(l)),y=i.i32_const(t.alloc(l)),I=i.i32_const(t.alloc(l)),C=i.i32_const(t.alloc(l)),F=i.i32_const(t.alloc(l));e.addCode(i.call(m+"_mul",o,s,C),i.call(m+"_mulNR",s,L),i.call(m+"_add",o,L,L),i.call(m+"_add",o,s,F),i.call(m+"_mul",F,L,L),i.call(m+"_mulNR",C,F),i.call(m+"_add",C,F,F),i.call(m+"_sub",L,F,L),i.call(m+"_add",C,C,w),i.call(m+"_mul",r,c,C),i.call(m+"_mulNR",c,A),i.call(m+"_add",r,A,A),i.call(m+"_add",r,c,F),i.call(m+"_mul",F,A,A),i.call(m+"_mulNR",C,F),i.call(m+"_add",C,F,F),i.call(m+"_sub",A,F,A),i.call(m+"_add",C,C,b),i.call(m+"_mul",n,d,C),i.call(m+"_mulNR",d,y),i.call(m+"_add",n,y,y),i.call(m+"_add",n,d,F),i.call(m+"_mul",F,y,y),i.call(m+"_mulNR",C,F),i.call(m+"_add",C,F,F),i.call(m+"_sub",y,F,y),i.call(m+"_add",C,C,I),i.call(m+"_sub",L,o,u),i.call(m+"_add",u,u,u),i.call(m+"_add",L,u,u),i.call(m+"_add",w,s,h),i.call(m+"_add",h,h,h),i.call(m+"_add",w,h,h),i.call(m+"_mul",I,i.i32_const(G),F),i.call(m+"_add",F,r,f),i.call(m+"_add",f,f,f),i.call(m+"_add",F,f,f),i.call(m+"_sub",y,c,_),i.call(m+"_add",_,_,_),i.call(m+"_add",y,_,_),i.call(m+"_sub",A,n,g),i.call(m+"_add",g,g,g),i.call(m+"_add",A,g,g),i.call(m+"_add",b,d,p),i.call(m+"_add",p,p,p),i.call(m+"_add",b,p,p))}(),N(R,true,"w0");const e=t.addFunction(a+"_finalExponentiation");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),c=i.i32_const(t.alloc(s)),r=i.i32_const(t.alloc(s)),d=i.i32_const(t.alloc(s)),u=i.i32_const(t.alloc(s)),g=i.i32_const(t.alloc(s)),_=i.i32_const(t.alloc(s)),f=i.i32_const(t.alloc(s));e.addCode(i.call(U+"_frobeniusMap6",o,c),i.call(U+"_inverse",o,r),i.call(U+"_mul",c,r,d),i.call(U+"_copy",d,r),i.call(U+"_frobeniusMap2",d,d),i.call(U+"_mul",d,r,d),i.call(a+"__cyclotomicSquare",d,r),i.call(U+"_conjugate",r,r),i.call(a+"__cyclotomicExp_w0",d,u),i.call(a+"__cyclotomicSquare",u,g),i.call(U+"_mul",r,u,_),i.call(a+"__cyclotomicExp_w0",_,r),i.call(a+"__cyclotomicExp_w0",r,c),i.call(a+"__cyclotomicExp_w0",c,f),i.call(U+"_mul",f,g,f),i.call(a+"__cyclotomicExp_w0",f,g),i.call(U+"_conjugate",_,_),i.call(U+"_mul",g,_,g),i.call(U+"_mul",g,d,g),i.call(U+"_conjugate",d,_),i.call(U+"_mul",r,d,r),i.call(U+"_frobeniusMap3",r,r),i.call(U+"_mul",f,_,f),i.call(U+"_frobeniusMap1",f,f),i.call(U+"_mul",u,c,u),i.call(U+"_frobeniusMap2",u,u),i.call(U+"_mul",u,r,u),i.call(U+"_mul",u,f,u),i.call(U+"_mul",u,g,n))}();for(let e=1;e<=5;e++)j(e),t.exportFunction(a+"_pairingEq"+e);!function(){const e=t.addFunction(a+"_pairing");e.addParam("p","i32"),e.addParam("q","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),o=i.i32_const(t.alloc(s));e.addCode(i.call(a+"_prepareG1",i.getLocal("p"),i.i32_const(V))),e.addCode(i.call(a+"_prepareG2",i.getLocal("q"),i.i32_const(K))),e.addCode(i.call(a+"_millerLoop",i.i32_const(V),i.i32_const(K),o)),e.addCode(i.call(a+"_finalExponentiation",o,i.getLocal("r")))}(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0"),t.exportFunction(P+"_mul1"),t.exportFunction(P+"_mul01"),t.exportFunction(U+"_mul014"),t.exportFunction(p+"_inGroupAffine"),t.exportFunction(p+"_inGroup"),t.exportFunction(w+"_inGroupAffine"),t.exportFunction(w+"_inGroup")};function ye(t,e){let a=t;void 0===e&&0==(e=Math.floor((o(t)-1)/8)+1)&&(e=1);const i=new Uint8Array(e),n=new DataView(i.buffer);let c=0;for(;c<e;)c+4<=e?(n.setUint32(c,Number(a&BigInt(4294967295)),!0),c+=4,a>>=BigInt(32)):c+2<=e?(n.setUint16(Number(c,a&BigInt(65535)),!0),c+=2,a>>=BigInt(16)):(n.setUint8(Number(c,a&BigInt(255)),!0),c+=1,a>>=BigInt(8));if(a)throw new Error("Number does not fit in this length");return i}const Ie=[];for(let t=0;t<256;t++)Ie[t]=Ce(t,8);function Ce(t,e){let a=0,i=t;for(let t=0;t<e;t++)a<<=1,a|=1&i,i>>=1;return a}function Fe(t,e){return(Ie[t>>>24]|Ie[t>>>16&255]<<8|Ie[t>>>8&255]<<16|Ie[255&t]<<24)>>>32-e}function xe(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function Ee(t,e){const a=t.byteLength/e,i=xe(a);if(a!=1<<i)throw new Error("Invalid number of pointers");for(let o=0;o<a;o++){const a=Fe(o,i);if(o>a){const i=t.slice(o*e,(o+1)*e);t.set(t.slice(a*e,(a+1)*e),o*e),t.set(i,a*e)}}}function Be(t,e){const a=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)a.set(t[i],i*e);return a}function ve(t,e){const a=t.byteLength/e,i=new Array(a);for(let o=0;o<a;o++)i[o]=t.slice(o*e,o*e+e);return i}var Se=Object.freeze({__proto__:null,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return E(e,0);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const a={};return Object.keys(e).forEach((i=>{a[i]=t(e[i])})),a}return e},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e))return BigInt(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(t);if("object"==typeof e){if(null===e)return null;const a={};return Object.keys(e).forEach((i=>{a[i]=t(e[i])})),a}return e},beBuff2int:function(t){let e=BigInt(0),a=t.length,i=0;const o=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;a>0;)a>=4?(a-=4,e+=BigInt(o.getUint32(a))<<BigInt(8*i),i+=4):a>=2?(a-=2,e+=BigInt(o.getUint16(a))<<BigInt(8*i),i+=2):(a-=1,e+=BigInt(o.getUint8(a))<<BigInt(8*i),i+=1);return e},beInt2Buff:function(t,e){let a=t;const i=new Uint8Array(e),o=new DataView(i.buffer);let n=e;for(;n>0;)n-4>=0?(n-=4,o.setUint32(n,Number(a&BigInt(4294967295))),a>>=BigInt(32)):n-2>=0?(n-=2,o.setUint16(n,Number(a&BigInt(65535))),a>>=BigInt(16)):(n-=1,o.setUint8(n,Number(a&BigInt(255))),a>>=BigInt(8));if(a)throw new Error("Number does not fit in this length");return i},leBuff2int:function(t){let e=BigInt(0),a=0;const i=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;a<t.length;)a+4<=t.length?(e+=BigInt(i.getUint32(a,!0))<<BigInt(8*a),a+=4):a+4<=t.length?(e+=BigInt(i.getUint16(a,!0))<<BigInt(8*a),a+=2):(e+=BigInt(i.getUint8(a,!0))<<BigInt(8*a),a+=1);return e},leInt2Buff:ye,stringifyFElements:function t(e,a){if("bigint"==typeof a||void 0!==a.eq)return a.toString(10);if(a instanceof Uint8Array)return e.toString(e.e(a));if(Array.isArray(a))return a.map(t.bind(this,e));if("object"==typeof a){const i={};return Object.keys(a).forEach((o=>{i[o]=t(e,a[o])})),i}return a},unstringifyFElements:function t(e,a){if("string"==typeof a&&/^[0-9]+$/.test(a))return e.e(a);if("string"==typeof a&&/^0x[0-9a-fA-F]+$/.test(a))return e.e(a);if(Array.isArray(a))return a.map(t.bind(this,e));if("object"==typeof a){if(null===a)return null;const i={};return Object.keys(a).forEach((o=>{i[o]=t(e,a[o])})),i}return a},bitReverse:Fe,log2:xe,buffReverseBits:Ee,array2buffer:Be,buffer2array:ve});const Ge=1<<30;class Pe{constructor(t){this.buffers=[],this.byteLength=t;for(let e=0;e<t;e+=Ge){const a=Math.min(t-e,Ge);this.buffers.push(new Uint8Array(a))}}slice(t,e){void 0===e&&(e=this.byteLength),void 0===t&&(t=0);const a=e-t,i=Math.floor(t/Ge);if(i==Math.floor((t+a-1)/Ge)||0==a)return this.buffers[i].slice(t%Ge,t%Ge+a);let o,n=i,c=t%Ge,r=a;for(;r>0;){const t=c+r>Ge?Ge-c:r,e=new Uint8Array(this.buffers[n].buffer,this.buffers[n].byteOffset+c,t);if(t==a)return e.slice();o||(o=a<=Ge?new Uint8Array(a):new Pe(a)),o.set(e,a-r),r-=t,n++,c=0}return o}set(t,e){void 0===e&&(e=0);const a=t.byteLength;if(0==a)return;const i=Math.floor(e/Ge);if(i==Math.floor((e+a-1)/Ge))return t instanceof Pe&&1==t.buffers.length?this.buffers[i].set(t.buffers[0],e%Ge):this.buffers[i].set(t,e%Ge);let o=i,n=e%Ge,c=a;for(;c>0;){const e=n+c>Ge?Ge-n:c,i=t.slice(a-c,a-c+e);new Uint8Array(this.buffers[o].buffer,this.buffers[o].byteOffset+n,e).set(i),c-=e,o++,n=0}}}function Ue(t,e,a,i){return async function(o){const n=Math.floor(o.byteLength/a);if(n*a!==o.byteLength)throw new Error("Invalid buffer size");const c=Math.floor(n/t.concurrency),r=[];for(let l=0;l<t.concurrency;l++){let s;if(s=l<t.concurrency-1?c:n-l*c,0==s)continue;const d=[{cmd:"ALLOCSET",var:0,buff:o.slice(l*c*a,l*c*a+s*a)},{cmd:"ALLOC",var:1,len:i*s},{cmd:"CALL",fnName:e,params:[{var:0},{val:s},{var:1}]},{cmd:"GET",out:0,var:1,len:i*s}];r.push(t.queueAction(d))}const l=await Promise.all(r);let s;s=o instanceof Pe?new Pe(n*i):new Uint8Array(n*i);let d=0;for(let t=0;t<l.length;t++)s.set(l[t][0],d),d+=l[t][0].byteLength;return s}}class Oe{constructor(t,e,a,i){if(this.tm=t,this.prefix=e,this.p=i,this.n8=a,this.type="F1",this.m=1,this.half=l(i,P),this.bitLength=o(i),this.mask=h(r(P,this.bitLength),P),this.pOp1=t.alloc(a),this.pOp2=t.alloc(a),this.pOp3=t.alloc(a),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(a/8),this.n32=Math.floor(a/4),8*this.n64!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=l(this.p,P),this.nqr=this.two;let n=this.exp(this.nqr,this.half);for(;!this.eq(n,this.negone);)this.nqr=this.add(this.nqr,this.one),n=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let c=h(this.p,P);for(;!u(c);)this.s=this.s+1,c=l(c,P);this.w=[],this.w[this.s]=this.exp(this.nqr,c);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Ue(t,e+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Ue(t,e+"_batchFromMontgomery",this.n8,this.n8)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=S(i(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,e){if(t instanceof Uint8Array)return t;let a=i(t,e);n(a)?(a=p(a),y(a,this.p)&&(a=A(a,this.p)),a=h(this.p,a)):y(a,this.p)&&(a=A(a,this.p));const o=ye(a,this.n8);return this.toMontgomery(o)}toString(t,e){return v(E(this.fromMontgomery(t),0),e)}fromRng(t){let e;const a=new Uint8Array(this.n8);do{e=G;for(let a=0;a<this.n64;a++)e=f(e,r(t.nextU64(),64*a));e=C(e,this.mask)}while(I(e,this.p));return F(a,0,e,this.n8),a}random(){return this.fromRng(R())}toObject(t){return E(this.fromMontgomery(t),0)}fromObject(t){const e=new Uint8Array(this.n8);return F(e,0,t,this.n8),this.toMontgomery(e)}toRprLE(t,e,a){t.set(this.fromMontgomery(a),e)}toRprBE(t,e,a){const i=this.fromMontgomery(a);for(let t=0;t<this.n8/2;t++){const e=i[t];i[t]=i[this.n8-1-t],i[this.n8-1-t]=e}t.set(i,e)}fromRprLE(t,e){e=e||0;const a=t.slice(e,e+this.n8);return this.toMontgomery(a)}async batchInverse(t){let e=!1;const a=this.n8,i=this.n8;Array.isArray(t)?(t=Be(t,a),e=!0):t=t.slice(0,t.byteLength);const o=Math.floor(t.byteLength/a);if(o*a!==t.byteLength)throw new Error("Invalid buffer size");const n=Math.floor(o/this.tm.concurrency),c=[];for(let e=0;e<this.tm.concurrency;e++){let r;if(r=e<this.tm.concurrency-1?n:o-e*n,0==r)continue;const l=[{cmd:"ALLOCSET",var:0,buff:t.slice(e*n*a,e*n*a+r*a)},{cmd:"ALLOC",var:1,len:i*r},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:a},{val:r},{var:1},{val:i}]},{cmd:"GET",out:0,var:1,len:i*r}];c.push(this.tm.queueAction(l))}const r=await Promise.all(c);let l;l=t instanceof Pe?new Pe(o*i):new Uint8Array(o*i);let s=0;for(let t=0;t<r.length;t++)l.set(r[t][0],s),s+=r[t][0].byteLength;return e?ve(l,i):l}}class ze{constructor(t,e,a){this.tm=t,this.prefix=e,this.F=a,this.type="F2",this.m=2*a.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*a.n8),this.pOp2=t.alloc(2*a.n8),this.pOp3=t.alloc(2*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}mul1(t,e){return this.op2("_mul1",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=S(i(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){const a=this.F.e(t[0],e),i=this.F.e(t[1],e),o=new Uint8Array(2*this.F.n8);return o.set(a),o.set(i,2*this.F.n8),o}throw new Error("invalid F2")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),a=this.F.fromRng(t),i=new Uint8Array(2*this.F.n8);return i.set(e),i.set(a,this.F.n8),i}random(){return this.fromRng(R())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8))]}fromObject(t){const e=new Uint8Array(2*this.F.n8),a=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);return e.set(a),e.set(i,this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class Qe{constructor(t,e,a){this.tm=t,this.prefix=e,this.F=a,this.type="F3",this.m=3*a.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*a.n8),this.pOp2=t.alloc(3*a.n8),this.pOp3=t.alloc(3*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}add(t,e){return this.op2("_add",t,e)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=S(i(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){const a=this.F.e(t[0],e),i=this.F.e(t[1],e),o=this.F.e(t[2],e),n=new Uint8Array(3*this.F.n8);return n.set(a),n.set(i,this.F.n8),n.set(o,2*this.F.n8),n}throw new Error("invalid F3")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),a=this.F.fromRng(t),i=this.F.fromRng(t),o=new Uint8Array(3*this.F.n8);return o.set(e),o.set(a,this.F.n8),o.set(i,2*this.F.n8),o}random(){return this.fromRng(R())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8))]}fromObject(t){const e=new Uint8Array(3*this.F.n8),a=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]),o=this.F.fromObject(t[2]);return e.set(a),e.set(i,this.F.n8),e.set(o,2*this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class qe{constructor(t,e,a,i,o,n){this.tm=t,this.prefix=e,this.F=a,this.pOp1=t.alloc(3*a.n8),this.pOp2=t.alloc(3*a.n8),this.pOp3=t.alloc(3*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*a.n8),this.tm.instance.exports[e+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*a.n8),this.one=this.tm.getBuff(i,3*a.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(i,2*a.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(o,a.n8),n&&(this.cofactor=S(n)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Ue(t,e+"_batchLEMtoC",2*a.n8,a.n8),this.batchLEMtoU=Ue(t,e+"_batchLEMtoU",2*a.n8,2*a.n8),this.batchCtoLEM=Ue(t,e+"_batchCtoLEM",a.n8,2*a.n8),this.batchUtoLEM=Ue(t,e+"_batchUtoLEM",2*a.n8,2*a.n8),this.batchToJacobian=Ue(t,e+"_batchToJacobian",2*a.n8,3*a.n8),this.batchToAffine=Ue(t,e+"_batchToAffine",3*a.n8,2*a.n8)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_add",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_addMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_addMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_addAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}sub(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_sub",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_subMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_subMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_subAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,e){let a;if(e instanceof Uint8Array||(e=S(i(e))),t.byteLength==3*this.F.n8)a=this.prefix+"_timesScalar";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");a=this.prefix+"_timesScalarAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[a](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,e){let a;if(t.byteLength==3*this.F.n8)a=this.prefix+"_timesFr";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");a=this.prefix+"_timesFrAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eq",t,e);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,e,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}fromRprUncompressed(t,e){const a=t.slice(e,e+2*this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,e,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,this.F.n8);t.set(i,e)}fromRprCompressed(t,e){const a=t.slice(e,e+this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){const e=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(e,0,t),e}toRprLEM(t,e,a){if(a.byteLength!=2*this.F.n8){if(a.byteLength!=3*this.F.n8)throw new Error("invalid point size");{this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}}else t.set(a,e)}fromRprLEM(t,e){return e=e||0,t.slice(e,e+2*this.F.n8)}toString(t,e){if(t.byteLength==3*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)} ]`}if(t.byteLength==2*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)} ]`}throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const e=this.F,a=this.toAffine(t),i=a.slice(0,this.F.n8),o=a.slice(this.F.n8,2*this.F.n8),n=e.add(e.mul(e.square(i),i),this.b),c=e.square(o);return e.eq(n,c)}fromRng(t){const e=this.F;let a,i,o=[];do{o[0]=e.fromRng(t),a=t.nextBool(),i=e.add(e.mul(e.square(o[0]),o[0]),this.b)}while(!e.isSquare(i));o[1]=e.sqrt(i);a^e.isNegative(o[1])&&(o[1]=e.neg(o[1]));let n=new Uint8Array(2*this.F.n8);return n.set(o[0]),n.set(o[1],this.F.n8),this.cofactor&&(n=this.timesScalar(n,this.cofactor)),n}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const e=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));let i;return i=t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one),[e,a,i]}fromObject(t){const e=this.F.fromObject(t[0]),a=this.F.fromObject(t[1]);let i;if(i=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(i,this.F.one))return this.zeroAffine;if(this.F.eq(i,this.F.one)){const t=new Uint8Array(2*this.F.n8);return t.set(e),t.set(a,this.F.n8),t}{const t=new Uint8Array(3*this.F.n8);return t.set(e),t.set(a,this.F.n8),t.set(i,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function Me(t){const e=32767;let a,i;async function o(t){const o=new Uint8Array(t.code),n=await WebAssembly.compile(o);i=new WebAssembly.Memory({initial:t.init,maximum:e}),a=await WebAssembly.instantiate(n,{env:{memory:i}})}function n(t){const a=new Uint32Array(i.buffer,0,1);for(;3&a[0];)a[0]++;const o=a[0];if(a[0]+=t,a[0]+t>i.buffer.byteLength){const o=i.buffer.byteLength/65536;let n=Math.floor((a[0]+t)/65536)+1;n>e&&(n=e),i.grow(n-o)}return o}function c(t){const e=n(t.byteLength);return l(e,t),e}function r(t,e){const a=new Uint8Array(i.buffer);return new Uint8Array(a.buffer,a.byteOffset+t,e)}function l(t,e){new Uint8Array(i.buffer).set(new Uint8Array(e),t)}function s(t){if("INIT"==t[0].cmd)return o(t[0]);const e={vars:[],out:[]},s=new Uint32Array(i.buffer,0,1)[0];for(let i=0;i<t.length;i++)switch(t[i].cmd){case"ALLOCSET":e.vars[t[i].var]=c(t[i].buff);break;case"ALLOC":e.vars[t[i].var]=n(t[i].len);break;case"SET":l(e.vars[t[i].var],t[i].buff);break;case"CALL":{const o=[];for(let a=0;a<t[i].params.length;a++){const n=t[i].params[a];void 0!==n.var?o.push(e.vars[n.var]+(n.offset||0)):void 0!==n.val&&o.push(n.val)}a.exports[t[i].fnName](...o);break}case"GET":e.out[t[i].out]=r(e.vars[t[i].var],t[i].len).slice();break;default:throw new Error("Invalid cmd")}return new Uint32Array(i.buffer,0,1)[0]=s,e.out}return t&&(t.onmessage=function(e){let a;if(a=e.data?e.data:e,"INIT"==a[0].cmd)o(a[0]).then((function(){t.postMessage(a.result)}));else if("TERMINATE"==a[0].cmd)t.close();else{const e=s(a);t.postMessage(e)}}),s}var Te={},ke=Worker;class Re{constructor(){this.promise=new Promise(((t,e)=>{this.reject=e,this.resolve=t}))}}var De;const Ne="data:application/javascript;base64,"+(De="("+Me.toString()+")(self)",globalThis.btoa(De));class Ve{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,e,a,i){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=i||new Re,this.workers[t].postMessage(e,a),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(0==this.working[t]){const e=this.actionQueue.shift();this.postAction(t,e.data,e.transfers,e.deferred)}}queueAction(t,e){const a=new Re;if(this.singleThread){const e=this.taskManager(t);a.resolve(e)}else this.actionQueue.push({data:t,transfers:e,deferred:a}),this.processWorks();return a.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const e=this.alloc(t.byteLength);return this.setBuff(e,t),e}getBuff(t,e){return this.u8.slice(t,t+e)}setBuff(t,e){this.u8.set(new Uint8Array(e),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;const e=this.u32[0];return this.u32[0]+=t,e}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);var t;await(t=200,new Promise((e=>setTimeout(e,t))))}}function Ke(t,e){const a=t[e],i=t.Fr,o=t.tm;t[e].batchApplyKey=async function(t,n,c,r,l){let s,d,u,g,_;if(r=r||"affine",l=l||"affine","G1"==e)"jacobian"==r?(u=3*a.F.n8,s="g1m_batchApplyKey"):(u=2*a.F.n8,s="g1m_batchApplyKeyMixed"),g=3*a.F.n8,"jacobian"==l?_=3*a.F.n8:(d="g1m_batchToAffine",_=2*a.F.n8);else if("G2"==e)"jacobian"==r?(u=3*a.F.n8,s="g2m_batchApplyKey"):(u=2*a.F.n8,s="g2m_batchApplyKeyMixed"),g=3*a.F.n8,"jacobian"==l?_=3*a.F.n8:(d="g2m_batchToAffine",_=2*a.F.n8);else{if("Fr"!=e)throw new Error("Invalid group: "+e);s="frm_batchApplyKey",u=a.n8,g=a.n8,_=a.n8}const f=Math.floor(t.byteLength/u),h=Math.floor(f/o.concurrency),p=[];c=i.e(c);let m=i.e(n);for(let e=0;e<o.concurrency;e++){let a;if(a=e<o.concurrency-1?h:f-e*h,0==a)continue;const n=[];n.push({cmd:"ALLOCSET",var:0,buff:t.slice(e*h*u,e*h*u+a*u)}),n.push({cmd:"ALLOCSET",var:1,buff:m}),n.push({cmd:"ALLOCSET",var:2,buff:c}),n.push({cmd:"ALLOC",var:3,len:a*Math.max(g,_)}),n.push({cmd:"CALL",fnName:s,params:[{var:0},{val:a},{var:1},{var:2},{var:3}]}),d&&n.push({cmd:"CALL",fnName:d,params:[{var:3},{val:a},{var:3}]}),n.push({cmd:"GET",out:0,var:3,len:a*_}),p.push(o.queueAction(n)),m=i.mul(m,i.exp(c,a))}const L=await Promise.all(p);let w;w=t instanceof Pe?new Pe(f*_):new Uint8Array(f*_);let A=0;for(let t=0;t<L.length;t++)w.set(L[t][0],A),A+=L[t][0].byteLength;return w}}const je=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function He(t,e){const a=t[e],i=a.tm;async function o(t,i,o,n,c){if(!(t instanceof Uint8Array))throw n&&n.error(`${c} _multiExpChunk buffBases is not Uint8Array`),new Error(`${c} _multiExpChunk buffBases is not Uint8Array`);if(!(i instanceof Uint8Array))throw n&&n.error(`${c} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${c} _multiExpChunk buffScalars is not Uint8Array`);let r,l;if(o=o||"affine","G1"==e)"affine"==o?(l="g1m_multiexpAffine_chunk",r=2*a.F.n8):(l="g1m_multiexp_chunk",r=3*a.F.n8);else{if("G2"!=e)throw new Error("Invalid group");"affine"==o?(l="g2m_multiexpAffine_chunk",r=2*a.F.n8):(l="g2m_multiexp_chunk",r=3*a.F.n8)}const s=Math.floor(t.byteLength/r);if(0==s)return a.zero;const d=Math.floor(i.byteLength/s);if(d*s!=i.byteLength)throw new Error("Scalar size does not match");const u=je[xe(s)],g=Math.floor((8*d-1)/u)+1,_=[];for(let e=0;e<g;e++){const o=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:i},{cmd:"ALLOC",var:2,len:3*a.F.n8},{cmd:"CALL",fnName:l,params:[{var:0},{var:1},{val:d},{val:s},{val:e*u},{val:Math.min(8*d-e*u,u)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*a.F.n8}];_.push(a.tm.queueAction(o))}const f=await Promise.all(_);let h=a.zero;for(let t=f.length-1;t>=0;t--){if(!a.isZero(h))for(let t=0;t<u;t++)h=a.double(h);h=a.add(h,f[t][0])}return h}async function n(t,n,c,r,l){const s=1<<22;let d;if("G1"==e)d="affine"==c?2*a.F.n8:3*a.F.n8;else{if("G2"!=e)throw new Error("Invalid group");d="affine"==c?2*a.F.n8:3*a.F.n8}const u=Math.floor(t.byteLength/d),g=Math.floor(n.byteLength/u);if(g*u!=n.byteLength)throw new Error("Scalar size does not match");const _=je[xe(u)],f=Math.floor((8*g-1)/_)+1;let h;h=Math.floor(u/(i.concurrency/f)),h>s&&(h=s),h<1024&&(h=1024);const p=[];for(let e=0;e<u;e+=h){r&&r.debug(`Multiexp start: ${l}: ${e}/${u}`);const a=Math.min(u-e,h),i=t.slice(e*d,(e+a)*d),s=n.slice(e*g,(e+a)*g);p.push(o(i,s,c,r,l).then((t=>(r&&r.debug(`Multiexp end: ${l}: ${e}/${u}`),t))))}const m=await Promise.all(p);let L=a.zero;for(let t=m.length-1;t>=0;t--)L=a.add(L,m[t]);return L}a.multiExp=async function(t,e,a,i){return await n(t,e,"jacobian",a,i)},a.multiExpAffine=async function(t,e,a,i){return await n(t,e,"affine",a,i)}}function $e(t,e){const a=t[e],i=t.Fr,o=a.tm;async function n(t,r,l,s,d,u){l=l||"affine",s=s||"affine";let g,_,f,h,p,m,L,w;"G1"==e?("affine"==l?(g=2*a.F.n8,h="g1m_batchToJacobian"):g=3*a.F.n8,_=3*a.F.n8,r&&(w="g1m_fftFinal"),L="g1m_fftJoin",m="g1m_fftMix","affine"==s?(f=2*a.F.n8,p="g1m_batchToAffine"):f=3*a.F.n8):"G2"==e?("affine"==l?(g=2*a.F.n8,h="g2m_batchToJacobian"):g=3*a.F.n8,_=3*a.F.n8,r&&(w="g2m_fftFinal"),L="g2m_fftJoin",m="g2m_fftMix","affine"==s?(f=2*a.F.n8,p="g2m_batchToAffine"):f=3*a.F.n8):"Fr"==e&&(g=a.n8,_=a.n8,f=a.n8,r&&(w="frm_fftFinal"),m="frm_fftMix",L="frm_fftJoin");let A=!1;Array.isArray(t)?(t=Be(t,g),A=!0):t=t.slice(0,t.byteLength);const b=t.byteLength/g,y=xe(b);if(1<<y!=b)throw new Error("fft must be multiple of 2");if(y==i.s+1){let e;return e=r?await async function(t,e,a,o,r){let l,s;l=t.slice(0,t.byteLength/2),s=t.slice(t.byteLength/2,t.byteLength);const d=[];d.push(n(l,!0,e,"jacobian",o,r)),d.push(n(s,!0,e,"jacobian",o,r)),[l,s]=await Promise.all(d);const u=await c(l,s,"fftJoinExtInv",i.one,i.shiftInv,"jacobian",a,o,r);let g;g=u[0].byteLength>1<<28?new Pe(2*u[0].byteLength):new Uint8Array(2*u[0].byteLength);return g.set(u[0]),g.set(u[1],u[0].byteLength),g}(t,l,s,d,u):await async function(t,e,a,o,r){let l,s;l=t.slice(0,t.byteLength/2),s=t.slice(t.byteLength/2,t.byteLength);const d=[];[l,s]=await c(l,s,"fftJoinExt",i.one,i.shift,e,"jacobian",o,r),d.push(n(l,!1,"jacobian",a,o,r)),d.push(n(s,!1,"jacobian",a,o,r));const u=await Promise.all(d);let g;g=u[0].byteLength>1<<28?new Pe(2*u[0].byteLength):new Uint8Array(2*u[0].byteLength);return g.set(u[0]),g.set(u[1],u[0].byteLength),g}(t,l,s,d,u),A?ve(e,f):e}let I,C,F;r&&(I=i.inv(i.e(b))),Ee(t,g);let x=Math.min(16384,b),E=b/x;for(;E<o.concurrency&&x>=16;)E*=2,x/=2;const B=xe(x),v=[];for(let e=0;e<E;e++){d&&d.debug(`${u}: fft ${y} mix start: ${e}/${E}`);const a=[];a.push({cmd:"ALLOC",var:0,len:_*x});const i=t.slice(x*e*g,x*(e+1)*g);a.push({cmd:"SET",var:0,buff:i}),h&&a.push({cmd:"CALL",fnName:h,params:[{var:0},{val:x},{var:0}]});for(let t=1;t<=B;t++)a.push({cmd:"CALL",fnName:m,params:[{var:0},{val:x},{val:t}]});B==y?(w&&(a.push({cmd:"ALLOCSET",var:1,buff:I}),a.push({cmd:"CALL",fnName:w,params:[{var:0},{val:x},{var:1}]})),p&&a.push({cmd:"CALL",fnName:p,params:[{var:0},{val:x},{var:0}]}),a.push({cmd:"GET",out:0,var:0,len:x*f})):a.push({cmd:"GET",out:0,var:0,len:_*x}),v.push(o.queueAction(a).then((t=>(d&&d.debug(`${u}: fft ${y} mix end: ${e}/${E}`),t))))}F=await Promise.all(v);for(let t=0;t<E;t++)F[t]=F[t][0];for(let t=B+1;t<=y;t++){d&&d.debug(`${u}: fft  ${y}  join: ${t}/${y}`);const e=1<<y-t,a=E/e,n=[];for(let c=0;c<e;c++)for(let r=0;r<a/2;r++){const l=i.exp(i.w[t],r*x),s=i.w[t],g=c*a+r,h=c*a+r+a/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:F[g]}),m.push({cmd:"ALLOCSET",var:1,buff:F[h]}),m.push({cmd:"ALLOCSET",var:2,buff:l}),m.push({cmd:"ALLOCSET",var:3,buff:s}),m.push({cmd:"CALL",fnName:L,params:[{var:0},{var:1},{val:x},{var:2},{var:3}]}),t==y?(w&&(m.push({cmd:"ALLOCSET",var:4,buff:I}),m.push({cmd:"CALL",fnName:w,params:[{var:0},{val:x},{var:4}]}),m.push({cmd:"CALL",fnName:w,params:[{var:1},{val:x},{var:4}]})),p&&(m.push({cmd:"CALL",fnName:p,params:[{var:0},{val:x},{var:0}]}),m.push({cmd:"CALL",fnName:p,params:[{var:1},{val:x},{var:1}]})),m.push({cmd:"GET",out:0,var:0,len:x*f}),m.push({cmd:"GET",out:1,var:1,len:x*f})):(m.push({cmd:"GET",out:0,var:0,len:x*_}),m.push({cmd:"GET",out:1,var:1,len:x*_})),n.push(o.queueAction(m).then((i=>(d&&d.debug(`${u}: fft ${y} join  ${t}/${y}  ${c+1}/${e} ${r}/${a/2}`),i))))}const c=await Promise.all(n);for(let t=0;t<e;t++)for(let e=0;e<a/2;e++){const i=t*a+e,o=t*a+e+a/2,n=c.shift();F[i]=n[0],F[o]=n[1]}}if(C=t instanceof Pe?new Pe(b*f):new Uint8Array(b*f),r){C.set(F[0].slice((x-1)*f));let t=f;for(let e=E-1;e>0;e--)C.set(F[e],t),t+=x*f,delete F[e];C.set(F[0].slice(0,(x-1)*f),t),delete F[0]}else for(let t=0;t<E;t++)C.set(F[t],x*f*t),delete F[t];return A?ve(C,f):C}async function c(t,n,c,r,l,s,d,u,g){let _,f,h,p,m,L;if("G1"==e)"affine"==s?(m=2*a.F.n8,f="g1m_batchToJacobian"):m=3*a.F.n8,L=3*a.F.n8,_="g1m_"+c,"affine"==d?(h="g1m_batchToAffine",p=2*a.F.n8):p=3*a.F.n8;else if("G2"==e)"affine"==s?(m=2*a.F.n8,f="g2m_batchToJacobian"):m=3*a.F.n8,_="g2m_"+c,L=3*a.F.n8,"affine"==d?(h="g2m_batchToAffine",p=2*a.F.n8):p=3*a.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");m=i.n8,p=i.n8,L=i.n8,_="frm_"+c}if(t.byteLength!=n.byteLength)throw new Error("Invalid buffer size");const w=Math.floor(t.byteLength/m);if(w!=1<<xe(w))throw new Error("Invalid number of points");let A=Math.floor(w/o.concurrency);A<16&&(A=16),A>65536&&(A=65536);const b=[];for(let e=0;e<w;e+=A){u&&u.debug(`${g}: fftJoinExt Start: ${e}/${w}`);const a=Math.min(w-e,A),c=i.mul(r,i.exp(l,e)),s=[],d=t.slice(e*m,(e+a)*m),y=n.slice(e*m,(e+a)*m);s.push({cmd:"ALLOC",var:0,len:L*a}),s.push({cmd:"SET",var:0,buff:d}),s.push({cmd:"ALLOC",var:1,len:L*a}),s.push({cmd:"SET",var:1,buff:y}),s.push({cmd:"ALLOCSET",var:2,buff:c}),s.push({cmd:"ALLOCSET",var:3,buff:l}),f&&(s.push({cmd:"CALL",fnName:f,params:[{var:0},{val:a},{var:0}]}),s.push({cmd:"CALL",fnName:f,params:[{var:1},{val:a},{var:1}]})),s.push({cmd:"CALL",fnName:_,params:[{var:0},{var:1},{val:a},{var:2},{var:3},{val:i.s}]}),h&&(s.push({cmd:"CALL",fnName:h,params:[{var:0},{val:a},{var:0}]}),s.push({cmd:"CALL",fnName:h,params:[{var:1},{val:a},{var:1}]})),s.push({cmd:"GET",out:0,var:0,len:a*p}),s.push({cmd:"GET",out:1,var:1,len:a*p}),b.push(o.queueAction(s).then((t=>(u&&u.debug(`${g}: fftJoinExt End: ${e}/${w}`),t))))}const y=await Promise.all(b);let I,C;w*p>1<<28?(I=new Pe(w*p),C=new Pe(w*p)):(I=new Uint8Array(w*p),C=new Uint8Array(w*p));let F=0;for(let t=0;t<y.length;t++)I.set(y[t][0],F),C.set(y[t][1],F),F+=y[t][0].byteLength;return[I,C]}a.fft=async function(t,e,a,i,o){return await n(t,!1,e,a,i,o)},a.ifft=async function(t,e,a,i,o){return await n(t,!0,e,a,i,o)},a.lagrangeEvaluations=async function(t,o,r,l,s){let d;if(o=o||"affine",r=r||"affine","G1"==e)d="affine"==o?2*a.F.n8:3*a.F.n8;else if("G2"==e)d="affine"==o?2*a.F.n8:3*a.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");d=i.n8}const u=t.byteLength/d,g=xe(u);if(2**g*d!=t.byteLength)throw l&&l.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(g<=i.s)return await a.ifft(t,o,r,l,s);if(g>i.s+1)throw l&&l.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let _=t.slice(0,t.byteLength/2),f=t.slice(t.byteLength/2,t.byteLength);const h=i.exp(i.shift,u/2),p=i.inv(i.sub(i.one,h));[_,f]=await c(_,f,"prepareLagrangeEvaluation",p,i.shiftInv,o,"jacobian",l,s+" prep");const m=[];let L;return m.push(n(_,!0,"jacobian",r,l,s+" t0")),m.push(n(f,!0,"jacobian",r,l,s+" t1")),[_,f]=await Promise.all(m),L=_.byteLength>1<<28?new Pe(2*_.byteLength):new Uint8Array(2*_.byteLength),L.set(_),L.set(f,_.byteLength),L},a.fftMix=async function(t){const n=3*a.F.n8;let c,r;if("G1"==e)c="g1m_fftMix",r="g1m_fftJoin";else if("G2"==e)c="g2m_fftMix",r="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");c="frm_fftMix",r="frm_fftJoin"}const l=Math.floor(t.byteLength/n),s=xe(l);let d=1<<xe(o.concurrency);l<=2*d&&(d=1);const u=l/d,g=xe(u),_=[];for(let e=0;e<d;e++){const a=[],i=t.slice(e*u*n,(e+1)*u*n);a.push({cmd:"ALLOCSET",var:0,buff:i});for(let t=1;t<=g;t++)a.push({cmd:"CALL",fnName:c,params:[{var:0},{val:u},{val:t}]});a.push({cmd:"GET",out:0,var:0,len:u*n}),_.push(o.queueAction(a))}const f=await Promise.all(_),h=[];for(let t=0;t<f.length;t++)h[t]=f[t][0];for(let t=g+1;t<=s;t++){const e=1<<s-t,a=d/e,c=[];for(let l=0;l<e;l++)for(let e=0;e<a/2;e++){const s=i.exp(i.w[t],e*u),d=i.w[t],g=l*a+e,_=l*a+e+a/2,f=[];f.push({cmd:"ALLOCSET",var:0,buff:h[g]}),f.push({cmd:"ALLOCSET",var:1,buff:h[_]}),f.push({cmd:"ALLOCSET",var:2,buff:s}),f.push({cmd:"ALLOCSET",var:3,buff:d}),f.push({cmd:"CALL",fnName:r,params:[{var:0},{var:1},{val:u},{var:2},{var:3}]}),f.push({cmd:"GET",out:0,var:0,len:u*n}),f.push({cmd:"GET",out:1,var:1,len:u*n}),c.push(o.queueAction(f))}const l=await Promise.all(c);for(let t=0;t<e;t++)for(let e=0;e<a/2;e++){const i=t*a+e,o=t*a+e+a/2,n=l.shift();h[i]=n[0],h[o]=n[1]}}let p;p=t instanceof Pe?new Pe(l*n):new Uint8Array(l*n);let m=0;for(let t=0;t<d;t++)p.set(h[t],m),m+=h[t].byteLength;return p},a.fftJoin=async function(t,n,c,r){const l=3*a.F.n8;let s;if("G1"==e)s="g1m_fftJoin";else if("G2"==e)s="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");s="frm_fftJoin"}if(t.byteLength!=n.byteLength)throw new Error("Invalid buffer size");const d=Math.floor(t.byteLength/l);if(d!=1<<xe(d))throw new Error("Invalid number of points");let u=1<<xe(o.concurrency);d<=2*u&&(u=1);const g=d/u,_=[];for(let e=0;e<u;e++){const a=[],d=i.mul(c,i.exp(r,e*g)),u=t.slice(e*g*l,(e+1)*g*l),f=n.slice(e*g*l,(e+1)*g*l);a.push({cmd:"ALLOCSET",var:0,buff:u}),a.push({cmd:"ALLOCSET",var:1,buff:f}),a.push({cmd:"ALLOCSET",var:2,buff:d}),a.push({cmd:"ALLOCSET",var:3,buff:r}),a.push({cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:g},{var:2},{var:3}]}),a.push({cmd:"GET",out:0,var:0,len:g*l}),a.push({cmd:"GET",out:1,var:1,len:g*l}),_.push(o.queueAction(a))}const f=await Promise.all(_);let h,p;t instanceof Pe?(h=new Pe(d*l),p=new Pe(d*l)):(h=new Uint8Array(d*l),p=new Uint8Array(d*l));let m=0;for(let t=0;t<f.length;t++)h.set(f[t][0],m),p.set(f[t][1],m),m+=f[t][0].byteLength;return[h,p]},a.fftFinal=async function(t,i){const n=3*a.F.n8,c=2*a.F.n8;let r,l;if("G1"==e)r="g1m_fftFinal",l="g1m_batchToAffine";else{if("G2"!=e)throw new Error("Invalid group");r="g2m_fftFinal",l="g2m_batchToAffine"}const s=Math.floor(t.byteLength/n);if(s!=1<<xe(s))throw new Error("Invalid number of points");const d=Math.floor(s/o.concurrency),u=[];for(let e=0;e<o.concurrency;e++){let a;if(a=e<o.concurrency-1?d:s-e*d,0==a)continue;const g=[],_=t.slice(e*d*n,(e*d+a)*n);g.push({cmd:"ALLOCSET",var:0,buff:_}),g.push({cmd:"ALLOCSET",var:1,buff:i}),g.push({cmd:"CALL",fnName:r,params:[{var:0},{val:a},{var:1}]}),g.push({cmd:"CALL",fnName:l,params:[{var:0},{val:a},{var:0}]}),g.push({cmd:"GET",out:0,var:0,len:a*c}),u.push(o.queueAction(g))}const g=await Promise.all(u);let _;_=t instanceof Pe?new Pe(s*c):new Uint8Array(s*c);let f=0;for(let t=g.length-1;t>=0;t--)_.set(g[t][0],f),f+=g[t][0].byteLength;return _}}async function Ye(t){const e=await async function(t,e){const a=new Ve;a.memory=new WebAssembly.Memory({initial:25}),a.u8=new Uint8Array(a.memory.buffer),a.u32=new Uint32Array(a.memory.buffer);const i=await WebAssembly.compile(t.code);if(a.instance=await WebAssembly.instantiate(i,{env:{memory:a.memory}}),a.singleThread=e,a.initalPFree=a.u32[0],a.pq=t.pq,a.pr=t.pr,a.pG1gen=t.pG1gen,a.pG1zero=t.pG1zero,a.pG2gen=t.pG2gen,a.pG2zero=t.pG2zero,a.pOneT=t.pOneT,e)a.code=t.code,a.taskManager=Me(),await a.taskManager([{cmd:"INIT",init:25,code:a.code.slice()}]),a.concurrency=1;else{let e;a.workers=[],a.pendingDeferreds=[],a.working=[],e="object"==typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:Te.cpus().length,0==e&&(e=2),e>64&&(e=64),a.concurrency=e;for(let t=0;t<e;t++)a.workers[t]=new ke(Ne),a.workers[t].addEventListener("message",o(t)),a.working[t]=!1;const i=[];for(let e=0;e<a.workers.length;e++){const o=t.code.slice();i.push(a.postAction(e,[{cmd:"INIT",init:25,code:o}],[o.buffer]))}await Promise.all(i)}return a;function o(t){return function(e){let i;i=e&&e.data?e.data:e,a.working[t]=!1,a.pendingDeferreds[t].resolve(i),a.processWorks()}}}(t.wasm,t.singleThread),a={};return a.q=i(t.wasm.q.toString()),a.r=i(t.wasm.r.toString()),a.name=t.name,a.tm=e,a.prePSize=t.wasm.prePSize,a.preQSize=t.wasm.preQSize,a.Fr=new Oe(e,"frm",t.n8r,t.r),a.F1=new Oe(e,"f1m",t.n8q,t.q),a.F2=new ze(e,"f2m",a.F1),a.G1=new qe(e,"g1m",a.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),a.G2=new qe(e,"g2m",a.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),a.F6=new Qe(e,"f6m",a.F2),a.F12=new ze(e,"ftm",a.F6),a.Gt=a.F12,Ke(a,"G1"),Ke(a,"G2"),Ke(a,"Fr"),He(a,"G1"),He(a,"G2"),$e(a,"G1"),$e(a,"G2"),$e(a,"Fr"),function(t){const e=t.tm;t.pairing=function(a,i){e.startSyncOp();const o=e.allocBuff(t.G1.toJacobian(a)),n=e.allocBuff(t.G2.toJacobian(i)),c=e.alloc(t.Gt.n8);e.instance.exports[t.name+"_pairing"](o,n,c);const r=e.getBuff(c,t.Gt.n8);return e.endSyncOp(),r},t.pairingEq=async function(){let a,i;arguments.length%2==1?(a=arguments[arguments.length-1],i=(arguments.length-1)/2):(a=t.Gt.one,i=arguments.length/2);const o=[];for(let a=0;a<i;a++){const i=[],n=t.G1.toJacobian(arguments[2*a]);i.push({cmd:"ALLOCSET",var:0,buff:n}),i.push({cmd:"ALLOC",var:1,len:t.prePSize});const c=t.G2.toJacobian(arguments[2*a+1]);i.push({cmd:"ALLOCSET",var:2,buff:c}),i.push({cmd:"ALLOC",var:3,len:t.preQSize}),i.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),i.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),i.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),i.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),i.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),o.push(e.queueAction(i))}const n=await Promise.all(o);e.startSyncOp();const c=e.alloc(t.Gt.n8);e.instance.exports.ftm_one(c);for(let t=0;t<n.length;t++){const a=e.allocBuff(n[t][0]);e.instance.exports.ftm_mul(c,a,c)}e.instance.exports[t.name+"_finalExponentiation"](c,c);const r=e.allocBuff(a),l=!!e.instance.exports.ftm_eq(c,r);return e.endSyncOp(),l},t.prepareG1=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),a=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](e,a);const i=this.tm.getBuff(a,this.prePSize);return this.tm.endSyncOp(),i},t.prepareG2=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),a=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](e,a);const i=this.tm.getBuff(a,this.preQSize);return this.tm.endSyncOp(),i},t.millerLoop=function(t,e){this.tm.startSyncOp();const a=this.tm.allocBuff(t),i=this.tm.allocBuff(e),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](a,i,o);const n=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),n},t.finalExponentiation=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](e,a);const i=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),i}}(a),a.array2buffer=function(t,e){const a=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)a.set(t[i],i*e);return a},a.buffer2array=function(t,e){const a=t.byteLength/e,i=new Array(a);for(let o=0;o<a;o++)i[o]=t.slice(o*e,o*e+e);return i},a}function We(t){return BigInt(t)}function Ze(t){return t<0n}function Je(t){return 0n===t}function Xe(t){const e=[],a=We(t);return e.push(Number(0xFFn&a)),e.push(Number(a>>8n&0xFFn)),e.push(Number(a>>16n&0xFFn)),e.push(Number(a>>24n&0xFFn)),e}function ta(t){const e=function(t){for(var e=[],a=0;a<t.length;a++){var i=t.charCodeAt(a);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(a++,i=65536+((1023&i)<<10|1023&t.charCodeAt(a)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e}(t);return[...na(e.length),...e]}function ea(t){const e=[];let a=We(t);if(Ze(a))throw new Error("Number cannot be negative");for(;!Je(a);)e.push(Number(0x7Fn&a)),a>>=7n;0==e.length&&e.push(0);for(let t=0;t<e.length-1;t++)e[t]=128|e[t];return e}function aa(t){let e,a;const i=function(t){return Ze(t)?t.toString(2).length-1:t.toString(2).length}(t);t<0?(a=!0,e=(1n<<BigInt(i))+t):(a=!1,e=We(t));const o=7-i%7,n=(1<<7-o)-1|128,c=ea(e+((1n<<BigInt(o))-1n<<BigInt(i)));return a||(c[c.length-1]=c[c.length-1]&n),c}function ia(t){let e=We(t);if(e>0xFFFFFFFFn)throw new Error("Number too big");if(e>0x7FFFFFFFn&&(e-=0x100000000n),e<-2147483648n)throw new Error("Number too small");return aa(e)}function oa(t){let e=We(t);if(e>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(e>0x7FFFFFFFFFFFFFFFn&&(e-=0x10000000000000000n),e<-9223372036854775808n)throw new Error("Number too small");return aa(e)}function na(t){let e=We(t);if(e>0xFFFFFFFFn)throw new Error("Number too big");return ea(e)}function ca(t){return Array.from(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")}class ra{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,e){const a=this.func.localIdxByName[t];if(void 0===a)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,33,...na(a)]}teeLocal(t,e){const a=this.func.localIdxByName[t];if(void 0===a)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,34,...na(a)]}getLocal(t){const e=this.func.localIdxByName[t];if(void 0===e)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...na(e)]}i64_load8_s(t,e,a){return[...t,48,void 0===a?0:a,...na(e||0)]}i64_load8_u(t,e,a){return[...t,49,void 0===a?0:a,...na(e||0)]}i64_load16_s(t,e,a){return[...t,50,void 0===a?1:a,...na(e||0)]}i64_load16_u(t,e,a){return[...t,51,void 0===a?1:a,...na(e||0)]}i64_load32_s(t,e,a){return[...t,52,void 0===a?2:a,...na(e||0)]}i64_load32_u(t,e,a){return[...t,53,void 0===a?2:a,...na(e||0)]}i64_load(t,e,a){return[...t,41,void 0===a?3:a,...na(e||0)]}i64_store(t,e,a,i){let o,n,c;return Array.isArray(e)?(o=0,n=3,c=e):Array.isArray(a)?(o=e,n=3,c=a):Array.isArray(i)&&(o=e,n=a,c=i),[...t,...c,55,n,...na(o)]}i64_store32(t,e,a,i){let o,n,c;return Array.isArray(e)?(o=0,n=2,c=e):Array.isArray(a)?(o=e,n=2,c=a):Array.isArray(i)&&(o=e,n=a,c=i),[...t,...c,62,n,...na(o)]}i64_store16(t,e,a,i){let o,n,c;return Array.isArray(e)?(o=0,n=1,c=e):Array.isArray(a)?(o=e,n=1,c=a):Array.isArray(i)&&(o=e,n=a,c=i),[...t,...c,61,n,...na(o)]}i64_store8(t,e,a,i){let o,n,c;return Array.isArray(e)?(o=0,n=0,c=e):Array.isArray(a)?(o=e,n=0,c=a):Array.isArray(i)&&(o=e,n=a,c=i),[...t,...c,60,n,...na(o)]}i32_load8_s(t,e,a){return[...t,44,void 0===a?0:a,...na(e||0)]}i32_load8_u(t,e,a){return[...t,45,void 0===a?0:a,...na(e||0)]}i32_load16_s(t,e,a){return[...t,46,void 0===a?1:a,...na(e||0)]}i32_load16_u(t,e,a){return[...t,47,void 0===a?1:a,...na(e||0)]}i32_load(t,e,a){return[...t,40,void 0===a?2:a,...na(e||0)]}i32_store(t,e,a,i){let o,n,c;return Array.isArray(e)?(o=0,n=2,c=e):Array.isArray(a)?(o=e,n=2,c=a):Array.isArray(i)&&(o=e,n=a,c=i),[...t,...c,54,n,...na(o)]}i32_store16(t,e,a,i){let o,n,c;return Array.isArray(e)?(o=0,n=1,c=e):Array.isArray(a)?(o=e,n=1,c=a):Array.isArray(i)&&(o=e,n=a,c=i),[...t,...c,59,n,...na(o)]}i32_store8(t,e,a,i){let o,n,c;return Array.isArray(e)?(o=0,n=0,c=e):Array.isArray(a)?(o=e,n=0,c=a):Array.isArray(i)&&(o=e,n=a,c=i),[...t,...c,58,n,...na(o)]}call(t,...e){const a=this.module.functionIdxByName[t];if(void 0===a)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...e),16,...na(a)]}call_indirect(t,...e){return[...[].concat(...e),...t,17,0,0]}if(t,e,a){return a?[...t,4,64,...e,5,...a,11]:[...t,4,64,...e,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,e){return[...e,13,...na(t)]}br(t){return[12,...na(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...oa(t)]}i32_const(t){return[65,...ia(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,e){return[...t,...e,81]}i64_ne(t,e){return[...t,...e,82]}i64_lt_s(t,e){return[...t,...e,83]}i64_lt_u(t,e){return[...t,...e,84]}i64_gt_s(t,e){return[...t,...e,85]}i64_gt_u(t,e){return[...t,...e,86]}i64_le_s(t,e){return[...t,...e,87]}i64_le_u(t,e){return[...t,...e,88]}i64_ge_s(t,e){return[...t,...e,89]}i64_ge_u(t,e){return[...t,...e,90]}i64_add(t,e){return[...t,...e,124]}i64_sub(t,e){return[...t,...e,125]}i64_mul(t,e){return[...t,...e,126]}i64_div_s(t,e){return[...t,...e,127]}i64_div_u(t,e){return[...t,...e,128]}i64_rem_s(t,e){return[...t,...e,129]}i64_rem_u(t,e){return[...t,...e,130]}i64_and(t,e){return[...t,...e,131]}i64_or(t,e){return[...t,...e,132]}i64_xor(t,e){return[...t,...e,133]}i64_shl(t,e){return[...t,...e,134]}i64_shr_s(t,e){return[...t,...e,135]}i64_shr_u(t,e){return[...t,...e,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,e){return[...t,...e,70]}i32_ne(t,e){return[...t,...e,71]}i32_lt_s(t,e){return[...t,...e,72]}i32_lt_u(t,e){return[...t,...e,73]}i32_gt_s(t,e){return[...t,...e,74]}i32_gt_u(t,e){return[...t,...e,75]}i32_le_s(t,e){return[...t,...e,76]}i32_le_u(t,e){return[...t,...e,77]}i32_ge_s(t,e){return[...t,...e,78]}i32_ge_u(t,e){return[...t,...e,79]}i32_add(t,e){return[...t,...e,106]}i32_sub(t,e){return[...t,...e,107]}i32_mul(t,e){return[...t,...e,108]}i32_div_s(t,e){return[...t,...e,109]}i32_div_u(t,e){return[...t,...e,110]}i32_rem_s(t,e){return[...t,...e,111]}i32_rem_u(t,e){return[...t,...e,112]}i32_and(t,e){return[...t,...e,113]}i32_or(t,e){return[...t,...e,114]}i32_xor(t,e){return[...t,...e,115]}i32_shl(t,e){return[...t,...e,116]}i32_shr_s(t,e){return[...t,...e,117]}i32_shr_u(t,e){return[...t,...e,118]}i32_rotl(t,e){return[...t,...e,119]}i32_rotr(t,e){return[...t,...e,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}const la={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class sa{constructor(t,e,a,i,o){if("import"==a)this.fnType="import",this.moduleName=i,this.fieldName=o;else{if("internal"!=a)throw new Error("Invalid function fnType: "+a);this.fnType="internal"}this.module=t,this.fnName=e,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,e){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);const a=this.nextLocal++;this.localIdxByName[t]=a,this.params.push({type:e})}addLocal(t,e,a){const i=a||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);const o=this.nextLocal++;this.localIdxByName[t]=o,this.locals.push({type:e,length:i})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){return[96,...[...na(this.params.length),...this.params.map((t=>la[t.type]))],...this.returnType?[1,la[this.returnType]]:[0]]}getBody(){const t=this.locals.map((t=>[...na(t.length),la[t.type]])),e=[...na(this.locals.length),...[].concat(...t),...this.code,11];return[...na(e.length),...e]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new ra(this)}}class da{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Xe(1836278016),...Xe(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);const e=this.functions.length;return this.functionIdxByName[t]=e,this.functions.push(new sa(this,t,"internal")),this.nInternalFunctions++,this.functions[e]}addIimportFunction(t,e,a){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&"internal"==this.functions[this.functions.length-1].type)throw new Error(`Import functions must be declared before internal: ${t}`);let i=a||t;const o=this.functions.length;return this.functionIdxByName[t]=o,this.functions.push(new sa(this,t,"import",e,i)),this.nImportFunctions++,this.functions[o]}setMemory(t,e,a){this.memory={pagesSize:t,moduleName:e||"env",fieldName:a||"memory"}}exportFunction(t,e){const a=e||t;if(void 0===this.functionIdxByName[t])throw new Error(`Function not defined: ${t}`);const i=this.functionIdxByName[t];a!=t&&(this.functionIdxByName[a]=i),this.exports.push({exportName:a,idx:i})}addFunctionToTable(t){const e=this.functionIdxByName[t];this.functionsTable.push(e)}addData(t,e){this.datas.push({offset:t,bytes:e})}alloc(t,e){let a,i;(Array.isArray(t)||ArrayBuffer.isView(t))&&void 0===e?(a=t.length,i=t):(a=t,i=e),a=1+(a-1>>3)<<3;const o=this.free;return this.free+=a,i&&this.addData(o,i),o}allocString(t){const e=(new globalThis.TextEncoder).encode(t);return this.alloc([...e,0])}_setSignatures(){this.signatures=[];const t={};if(this.functionsTable.length>0){const e=this.functions[this.functionsTable[0]].getSignature();t["s_"+ca(e)]=0,this.signatures.push(e)}for(let e=0;e<this.functions.length;e++){const a=this.functions[e].getSignature(),i="s_"+ca(a);void 0===t[i]&&(t[i]=this.signatures.length,this.signatures.push(a)),this.functions[e].signatureIdx=t[i]}}_buildSection(t,e){return[t,...na(e.length),...e]}_buildType(){return this._buildSection(1,[...na(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const t=[];t.push([...ta(this.memory.moduleName),...ta(this.memory.fieldName),2,0,...na(this.memory.pagesSize)]);for(let e=0;e<this.nImportFunctions;e++)t.push([...ta(this.functions[e].moduleName),...ta(this.functions[e].fieldName),0,...na(this.functions[e].signatureIdx)]);return this._buildSection(2,na(t.length).concat(...t))}_buildFunctionDeclarations(){const t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(...na(this.functions[e].signatureIdx));return this._buildSection(3,[...na(t.length),...t])}_buildFunctionsTable(){return 0==this.functionsTable.length?[]:this._buildSection(4,[...na(1),112,0,...na(this.functionsTable.length)])}_buildElements(){if(0==this.functionsTable.length)return[];const t=[];for(let e=0;e<this.functionsTable.length;e++)t.push(...na(this.functionsTable[e]));return this._buildSection(9,[...na(1),...na(0),65,...ia(0),11,...na(this.functionsTable.length),...t])}_buildExports(){const t=[];for(let e=0;e<this.exports.length;e++)t.push([...ta(this.exports[e].exportName),0,...na(this.exports[e].idx)]);return this._buildSection(7,na(t.length).concat(...t))}_buildCode(){const t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(this.functions[e].getBody());return this._buildSection(10,na(t.length).concat(...t))}_buildData(){const t=[];t.push([0,65,0,11,4,...Xe(this.free)]);for(let e=0;e<this.datas.length;e++)t.push([0,65,...ia(this.datas[e].offset),11,...na(this.datas[e].bytes.length),...this.datas[e].bytes]);return this._buildSection(11,na(t.length).concat(...t))}}async function ua(t,e){const a=new da;a.setMemory(25),Ae(a),e&&e(a);const o={};if(o.code=a.build(),o.pq=a.modules.f1m.pq,o.pr=a.modules.frm.pq,o.pG1gen=a.modules.bn128.pG1gen,o.pG1zero=a.modules.bn128.pG1zero,o.pG1b=a.modules.bn128.pG1b,o.pG2gen=a.modules.bn128.pG2gen,o.pG2zero=a.modules.bn128.pG2zero,o.pG2b=a.modules.bn128.pG2b,o.pOneT=a.modules.bn128.pOneT,o.prePSize=a.modules.bn128.prePSize,o.preQSize=a.modules.bn128.preQSize,o.n8q=32,o.n8r=32,o.q=a.modules.bn128.q,o.r=a.modules.bn128.r,!t&&globalThis.curve_bn128)return globalThis.curve_bn128;const n={name:"bn128",wasm:o,q:i("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:i("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:i("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},c=await Ye(n);return c.terminate=async function(){n.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=c),c}async function ga(t,e){const a=new da;a.setMemory(25),be(a),e&&e(a);const o={};if(o.code=a.build(),o.pq=a.modules.f1m.pq,o.pr=a.modules.frm.pq,o.pG1gen=a.modules.bls12381.pG1gen,o.pG1zero=a.modules.bls12381.pG1zero,o.pG1b=a.modules.bls12381.pG1b,o.pG2gen=a.modules.bls12381.pG2gen,o.pG2zero=a.modules.bls12381.pG2zero,o.pG2b=a.modules.bls12381.pG2b,o.pOneT=a.modules.bls12381.pOneT,o.prePSize=a.modules.bls12381.prePSize,o.preQSize=a.modules.bls12381.preQSize,o.n8q=48,o.n8r=32,o.q=a.modules.bls12381.q,o.r=a.modules.bls12381.r,!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const n={name:"bls12381",wasm:o,q:i("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:i("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:i("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:i("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},c=await Ye(n);return c.terminate=async function(){n.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=c),c}globalThis.curve_bn128=null,globalThis.curve_bls12381=null;const _a=i("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),fa=i("21888242871839275222246405745257275088548364400416034343698204186575808495617");i("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),i("21888242871839275222246405745257275088696311157297823662689037894645226208583");const ha=U,pa=Se;var ma={};async function La(t,e,a,i){if(a=a||262144,"number"!=typeof e&&["w+","wx+","r","ax+","a+"].indexOf(e)<0)throw new Error("Invalid open option");const o=await ma.promises.open(t,e),n=await o.stat();return new wa(o,n,a,i,t)}class wa{constructor(t,e,a,i,o){for(this.fileName=o,this.fd=t,this.pos=0,this.pageSize=i||256;this.pageSize<e.blksize;)this.pageSize*=2;this.totalSize=e.size,this.totalPages=Math.floor((e.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(a/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){const e=this,a=new Promise(((a,i)=>{e.pendingLoads.push({page:t,resolve:a,reject:i})}));return e.__statusPage("After Load request: ",t),a}__statusPage(t,e){const a=[],i=this;if(!i.logHistory)return;a.push("=="+t+" "+e);let o="";for(let t=0;t<i.pendingLoads.length;t++)i.pendingLoads[t].page==e&&(o=o+" "+t);if(o&&a.push("Pending loads:"+o),void 0!==i.pages[e]){const t=i.pages[e];a.push("Loaded"),a.push("pendingOps: "+t.pendingOps),t.loading&&a.push("loading: "+t.loading),t.writing&&a.push("writing"),t.dirty&&a.push("dirty")}a.push("=="),i.history[e]||(i.history[e]=[]),i.history[e].push(a)}__printHistory(t){const e=this;e.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let a=0;a<e.history[t].length;a++)for(let i=0;i<e.history[t][a].length;i++)console.log("-> "+e.history[t][a][i])}_triggerLoad(){const t=this;if(t.reading)return;if(0==t.pendingLoads.length)return;const e=Object.keys(t.pages),a=[];for(let i=0;i<e.length;i++){const o=t.pages[parseInt(e[i])];0!=o.dirty||0!=o.pendingOps||o.writing||o.loading||a.push(parseInt(e[i]))}let i=t.maxPagesLoaded-e.length;const o=[];for(;t.pendingLoads.length>0&&(void 0!==t.pages[t.pendingLoads[0].page]||i>0||a.length>0);){const e=t.pendingLoads.shift();if(void 0!==t.pages[e.page]){t.pages[e.page].pendingOps++;const i=a.indexOf(e.page);i>=0&&a.splice(i,1),t.pages[e.page].loading?t.pages[e.page].loading.push(e):e.resolve(),t.__statusPage("After Load (cached): ",e.page)}else{if(i)i--;else{const e=a.shift();t.__statusPage("Before Unload: ",e),t.avBuffs.unshift(t.pages[e]),delete t.pages[e],t.__statusPage("After Unload: ",e)}e.page>=t.totalPages?(t.pages[e.page]=n(),e.resolve(),t.__statusPage("After Load (new): ",e.page)):(t.reading=!0,t.pages[e.page]=n(),t.pages[e.page].loading=[e],o.push(t.fd.read(t.pages[e.page].buff,0,t.pageSize,e.page*t.pageSize).then((a=>{t.pages[e.page].size=a.bytesRead;const i=t.pages[e.page].loading;delete t.pages[e.page].loading;for(let t=0;t<i.length;t++)i[t].resolve();return t.__statusPage("After Load (loaded): ",e.page),a}),(t=>{e.reject(t)}))),t.__statusPage("After Load (loading): ",e.page))}}function n(){if(t.avBuffs.length>0){const e=t.avBuffs.shift();return e.dirty=!1,e.pendingOps=1,e.size=0,e}return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}Promise.all(o).then((()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()}))}_triggerWrite(){const t=this;if(t.writing)return;const e=Object.keys(t.pages),a=[];for(let i=0;i<e.length;i++){const o=t.pages[parseInt(e[i])];o.dirty&&(o.dirty=!1,o.writing=!0,t.writing=!0,a.push(t.fd.write(o.buff,0,o.size,parseInt(e[i])*t.pageSize).then((()=>{o.writing=!1}),(e=>{console.log("ERROR Writing: "+e),t.error=e,t._tryClose()}))))}t.writing&&Promise.all(a).then((()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))}))}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,e){if(0==t.byteLength)return;const a=this;if(void 0===e&&(e=a.pos),a.pos=e+t.byteLength,a.totalSize<e+t.byteLength&&(a.totalSize=e+t.byteLength),a.pendingClose)throw new Error("Writing a closing file");const i=Math.floor(e/a.pageSize),o=Math.floor((e+t.byteLength-1)/a.pageSize),n=[];for(let t=i;t<=o;t++)n.push(a._loadPage(t));a._triggerLoad();let c=i,r=e%a.pageSize,l=t.byteLength;for(;l>0;){await n[c-i];const e=r+l>a.pageSize?a.pageSize-r:l,o=t.slice(t.byteLength-l,t.byteLength-l+e);new Uint8Array(a.pages[c].buff.buffer,r,e).set(o),a.pages[c].dirty=!0,a.pages[c].pendingOps--,a.pages[c].size=Math.max(r+e,a.pages[c].size),c>=a.totalPages&&(a.totalPages=c+1),l-=e,c++,r=0,a.writing||setImmediate(a._triggerWrite.bind(a))}}async read(t,e){let a=new Uint8Array(t);return await this.readToBuffer(a,0,t,e),a}async readToBuffer(t,e,a,i){if(0==a)return;const o=this;if(a>o.pageSize*o.maxPagesLoaded*.8){const t=Math.floor(1.1*a);this.maxPagesLoaded=Math.floor(t/o.pageSize)+1}if(void 0===i&&(i=o.pos),o.pos=i+a,o.pendingClose)throw new Error("Reading a closing file");const n=Math.floor(i/o.pageSize),c=Math.floor((i+a-1)/o.pageSize),r=[];for(let t=n;t<=c;t++)r.push(o._loadPage(t));o._triggerLoad();let l=n,s=i%o.pageSize,d=i+a>o.totalSize?a-(i+a-o.totalSize):a;for(;d>0;){await r[l-n],o.__statusPage("After Await (read): ",l);const i=s+d>o.pageSize?o.pageSize-s:d,c=new Uint8Array(o.pages[l].buff.buffer,o.pages[l].buff.byteOffset+s,i);t.set(c,e+a-d),o.pages[l].pendingOps--,o.__statusPage("After Op done: ",l),d-=i,l++,s=0,o.pendingLoads.length>0&&setImmediate(o._triggerLoad.bind(o))}this.pos=i+a}_tryClose(){const t=this;if(!t.pendingClose)return;t.error&&t.pendingCloseReject(t.error);t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0||t.pendingClose()}close(){const t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise(((e,a)=>{t.pendingClose=e,t.pendingCloseReject=a,t._tryClose()})).then((()=>{t.fd.close()}),(e=>{throw t.fd.close(),e}))}async discard(){await this.close(),await ma.promises.unlink(this.fileName)}async writeULE32(t,e){const a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,t,!0),await this.write(a,e)}async writeUBE32(t,e){const a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,t,!1),await this.write(a,e)}async writeULE64(t,e){const a=new Uint8Array(8),i=new DataView(a.buffer);i.setUint32(0,4294967295&t,!0),i.setUint32(4,Math.floor(t/4294967296),!0),await this.write(a,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),a=new Uint32Array(e.buffer);return 4294967296*a[1]+a[0]}async readString(t){const e=this;if(e.pendingClose)throw new Error("Reading a closing file");let a=void 0===t?e.pos:t,i=Math.floor(a/e.pageSize),o=!1,n="";for(;!o;){let t=e._loadPage(i);e._triggerLoad(),await t,e.__statusPage("After Await (read): ",i);let c=a%e.pageSize;const r=new Uint8Array(e.pages[i].buff.buffer,e.pages[i].buff.byteOffset+c,e.pageSize-c);let l=r.findIndex((t=>0===t));o=-1!==l,o?(n+=(new TextDecoder).decode(r.slice(0,l)),e.pos=i*this.pageSize+c+l+1):(n+=(new TextDecoder).decode(r),e.pos=i*this.pageSize+c+r.length),e.pages[i].pendingOps--,e.__statusPage("After Op done: ",i),a=e.pos,i++,e.pendingLoads.length>0&&setImmediate(e._triggerLoad.bind(e))}return n}}const Aa=new Uint8Array(4),ba=new DataView(Aa.buffer),ya=new Uint8Array(8),Ia=new DataView(ya.buffer);class Ca{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){const e=Math.max(this.allocSize+(1<<20),Math.floor(1.1*this.allocSize),t),a=new Uint8Array(e);a.set(this.o.data),this.o.data=a,this.allocSize=e}}async write(t,e){if(void 0===e&&(e=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength),this.o.data.set(t.slice(),e),e+t.byteLength>this.totalSize&&(this.totalSize=e+t.byteLength),this.pos=e+t.byteLength}async readToBuffer(t,e,a,i){if(void 0===i&&(i=this.pos),this.readOnly&&i+a>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(i+a);const o=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+i,a);t.set(o,e),this.pos=i+a}async read(t,e){const a=new Uint8Array(t);return await this.readToBuffer(a,0,t,e),a}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,e){ba.setUint32(0,t,!0),await this.write(Aa,e)}async writeUBE32(t,e){ba.setUint32(0,t,!1),await this.write(Aa,e)}async writeULE64(t,e){Ia.setUint32(0,4294967295&t,!0),Ia.setUint32(4,Math.floor(t/4294967296),!0),await this.write(ya,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),a=new Uint32Array(e.buffer);return 4294967296*a[1]+a[0]}async readString(t){const e=this;let a=void 0===t?e.pos:t;if(a>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}const i=new Uint8Array(e.o.data.buffer,a,this.totalSize-a);let o=i.findIndex((t=>0===t)),n="";return-1!==o?(n=(new TextDecoder).decode(i.slice(0,o)),e.pos=a+o+1):e.pos=a,n}}const Fa=1<<22;const xa=new Uint8Array(4),Ea=new DataView(xa.buffer),Ba=new Uint8Array(8),va=new DataView(Ba.buffer);class Sa{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const e=Math.floor((t-1)/Fa)+1;for(let a=Math.max(this.o.data.length-1,0);a<e;a++){const i=new Uint8Array(a<e-1?Fa:t-(e-1)*Fa);a==this.o.data.length-1&&i.set(this.o.data[a]),this.o.data[a]=i}this.totalSize=t}async write(t,e){const a=this;if(void 0===e&&(e=a.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength);let i=Math.floor(e/Fa),o=e%Fa,n=t.byteLength;for(;n>0;){const e=o+n>Fa?Fa-o:n,c=t.slice(t.byteLength-n,t.byteLength-n+e);new Uint8Array(a.o.data[i].buffer,o,e).set(c),n-=e,i++,o=0}this.pos=e+t.byteLength}async readToBuffer(t,e,a,i){const o=this;if(void 0===i&&(i=o.pos),this.readOnly&&i+a>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(i+a);let n=Math.floor(i/Fa),c=i%Fa,r=a;for(;r>0;){const i=c+r>Fa?Fa-c:r,l=new Uint8Array(o.o.data[n].buffer,c,i);t.set(l,e+a-r),r-=i,n++,c=0}this.pos=i+a}async read(t,e){const a=new Uint8Array(t);return await this.readToBuffer(a,0,t,e),a}close(){}async discard(){}async writeULE32(t,e){Ea.setUint32(0,t,!0),await this.write(xa,e)}async writeUBE32(t,e){Ea.setUint32(0,t,!1),await this.write(xa,e)}async writeULE64(t,e){va.setUint32(0,4294967295&t,!0),va.setUint32(4,Math.floor(t/4294967296),!0),await this.write(Ba,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),a=new Uint32Array(e.buffer);return 4294967296*a[1]+a[0]}async readString(t){const e=this;let a=void 0===t?e.pos:t;if(a>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}let i=!1,o="";for(;!i;){let t=Math.floor(a/Fa),n=a%Fa;if(void 0===e.o.data[t])throw new Error("ERROR");let c=Math.min(2048,e.o.data[t].length-n);const r=new Uint8Array(e.o.data[t].buffer,n,c);let l=r.findIndex((t=>0===t));i=-1!==l,i?(o+=(new TextDecoder).decode(r.slice(0,l)),e.pos=t*Fa+n+l+1):(o+=(new TextDecoder).decode(r),e.pos=t*Fa+n+r.length),a=e.pos}return o}}async function Ga(t,e,a){if("string"==typeof t&&(t={type:"file",fileName:t,cacheSize:e||65536,pageSize:a||8192}),"file"==t.type)return await La(t.fileName,1538,t.cacheSize,t.pageSize);if("mem"==t.type)return function(t){const e=t.initialSize||1<<20,a=new Ca;return a.o=t,a.o.data=new Uint8Array(e),a.allocSize=e,a.totalSize=0,a.readOnly=!1,a.pos=0,a}(t);if("bigMem"==t.type)return function(t){const e=t.initialSize||0,a=new Sa;a.o=t;const i=e?Math.floor((e-1)/Fa)+1:0;a.o.data=[];for(let t=0;t<i-1;t++)a.o.data.push(new Uint8Array(Fa));return i&&a.o.data.push(new Uint8Array(e-Fa*(i-1))),a.totalSize=0,a.readOnly=!1,a.pos=0,a}(t);throw new Error("Invalid FastFile type: "+t.type)}async function Pa(t,e,a){if(t instanceof Uint8Array&&(t={type:"mem",data:t}),"string"==typeof t){t={type:"mem",data:await fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return new Uint8Array(t)}))}}if("file"==t.type)return await La(t.fileName,0,t.cacheSize,t.pageSize);if("mem"==t.type)return await function(t){const e=new Ca;return e.o=t,e.allocSize=t.data.byteLength,e.totalSize=t.data.byteLength,e.readOnly=!0,e.pos=0,e}(t);if("bigMem"==t.type)return await function(t){const e=new Sa;return e.o=t,e.totalSize=(t.data.length-1)*Fa+t.data[t.data.length-1].byteLength,e.readOnly=!0,e.pos=0,e}(t);throw new Error("Invalid FastFile type: "+t.type)}async function Ua(t,e,a,i,o){const n=await Pa(t),c=await n.read(4);let r="";for(let t=0;t<4;t++)r+=String.fromCharCode(c[t]);if(r!=e)throw new Error(t+": Invalid File format");if(await n.readULE32()>a)throw new Error("Version not supported");const l=await n.readULE32();let s=[];for(let t=0;t<l;t++){let t=await n.readULE32(),e=await n.readULE64();void 0===s[t]&&(s[t]=[]),s[t].push({p:n.pos,size:e}),n.pos+=e}return{fd:n,sections:s}}async function Oa(t,e,a,i,o,n){const c=await Ga(t,o,n),r=new Uint8Array(4);for(let t=0;t<4;t++)r[t]=e.charCodeAt(t);return await c.write(r,0),await c.writeULE32(a),await c.writeULE32(i),c}async function za(t,e){if(void 0!==t.writingSection)throw new Error("Already writing a section");await t.writeULE32(e),t.writingSection={pSectionSize:t.pos},await t.writeULE64(0)}async function Qa(t){if(void 0===t.writingSection)throw new Error("Not writing a section");const e=t.pos-t.writingSection.pSectionSize-8,a=t.pos;t.pos=t.writingSection.pSectionSize,await t.writeULE64(e),t.pos=a,delete t.writingSection}async function qa(t,e,a){if(void 0!==t.readingSection)throw new Error("Already reading a section");if(!e[a])throw new Error(t.fileName+": Missing section "+a);if(e[a].length>1)throw new Error(t.fileName+": Section Duplicated "+a);t.pos=e[a][0].p,t.readingSection=e[a][0]}async function Ma(t,e){if(void 0===t.readingSection)throw new Error("Not reading a section");if(!e&&t.pos-t.readingSection.p!=t.readingSection.size)throw new Error("Invalid section size reading");delete t.readingSection}async function Ta(t,e,a,i){const o=new Uint8Array(a);ha.toRprLE(o,0,e,a),await t.write(o,i)}async function ka(t,e,a){const i=await t.read(e,a);return ha.fromRprLE(i,0,e)}async function Ra(t,e,a,i,o){void 0===o&&(o=e[i][0].size);const n=t.pageSize;await qa(t,e,i),await za(a,i);for(let e=0;e<o;e+=n){const i=Math.min(o-e,n),c=await t.read(i);await a.write(c)}await Qa(a),await Ma(t,o!=e[i][0].size)}async function Da(t,e,a,i,o){if((i=void 0===i?0:i)+(o=void 0===o?e[a][0].size-i:o)>e[a][0].size)throw new Error("Reading out of the range of the section");let n;return n=o<1<<30?new Uint8Array(o):new Pe(o),await t.readToBuffer(n,0,o,e[a][0].p+i),n}async function Na(t,e,a,i,o){const n=16*t.pageSize;if(await qa(t,e,o),await qa(a,i,o),e[o][0].size!=i[o][0].size)return!1;const c=e[o][0].size;for(let e=0;e<c;e+=n){const i=Math.min(c-e,n),o=await t.read(i),r=await a.read(i);for(let t=0;t<i;t++)if(o[t]!=r[t])return!1}return await Ma(t),await Ma(a),!0}ha.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),ha.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const Va=ha.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),Ka=ha.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function ja(t){let e;if(ha.eq(t,Ka))e=await ua();else{if(!ha.eq(t,Va))throw new Error(`Curve not supported: ${ha.toString(t)}`);e=await ga()}return e}async function Ha(t){let e;const a=t.toUpperCase().match(/[A-Za-z0-9]+/g).join("");if(["BN128","BN254","ALTBN128"].indexOf(a)>=0)e=await ua();else{if(!(["BLS12381"].indexOf(a)>=0))throw new Error(`Curve not supported: ${t}`);e=await ga()}return e}var $a={exports:{}},Ya=function t(e,a){if(!e){var i=new Wa(a);throw Error.captureStackTrace&&Error.captureStackTrace(i,t),i}};class Wa extends Error{}function Za(t){return t.length}Wa.prototype.name="AssertionError";var Ja={byteLength:Za,toString:function(t){const e=t.byteLength;let a="";for(let i=0;i<e;i++)a+=String.fromCharCode(t[i]);return a},write:function(t,e,a=0,i=Za(e)){const o=Math.min(i,t.byteLength-a);for(let i=0;i<o;i++)t[a+i]=e.charCodeAt(i);return o}};const Xa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ti=new Uint8Array(256);for(let t=0;t<Xa.length;t++)ti[Xa.charCodeAt(t)]=t;function ei(t){let e=t.length;return 61===t.charCodeAt(e-1)&&e--,e>1&&61===t.charCodeAt(e-1)&&e--,3*e>>>2}ti[45]=62,ti[95]=63;var ai={byteLength:ei,toString:function(t){const e=t.byteLength;let a="";for(let i=0;i<e;i+=3)a+=Xa[t[i]>>2]+Xa[(3&t[i])<<4|t[i+1]>>4]+Xa[(15&t[i+1])<<2|t[i+2]>>6]+Xa[63&t[i+2]];return e%3==2?a=a.substring(0,a.length-1)+"=":e%3==1&&(a=a.substring(0,a.length-2)+"=="),a},write:function(t,e,a=0,i=ei(e)){const o=Math.min(i,t.byteLength-a);for(let a=0,i=0;a<o;a+=4){const o=ti[e.charCodeAt(a)],n=ti[e.charCodeAt(a+1)],c=ti[e.charCodeAt(a+2)],r=ti[e.charCodeAt(a+3)];t[i++]=o<<2|n>>4,t[i++]=(15&n)<<4|c>>2,t[i++]=(3&c)<<6|63&r}return o}};function ii(t){return t.length>>>1}var oi={byteLength:ii,toString:function(t){const e=t.byteLength;t=new DataView(t.buffer,t.byteOffset,e);let a="",i=0;for(let o=e-e%4;i<o;i+=4)a+=t.getUint32(i).toString(16).padStart(8,"0");for(;i<e;i++)a+=t.getUint8(i).toString(16).padStart(2,"0");return a},write:function(t,e,a=0,i=ii(e)){const o=Math.min(i,t.byteLength-a);for(let i=0;i<o;i++){const o=ni(e.charCodeAt(2*i)),n=ni(e.charCodeAt(2*i+1));if(void 0===o||void 0===n)return t.subarray(0,i);t[a+i]=o<<4|n}return o}};function ni(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:void 0}function ci(t){let e=0;for(let a=0,i=t.length;a<i;a++){const o=t.charCodeAt(a);if(o>=55296&&o<=56319&&a+1<i){const i=t.charCodeAt(a+1);if(i>=56320&&i<=57343){e+=4,a++;continue}}e+=o<=127?1:o<=2047?2:3}return e}let ri,li;if("undefined"!=typeof TextDecoder){const t=new TextDecoder;ri=function(e){return t.decode(e)}}else ri=function(t){const e=t.byteLength;let a="",i=0;for(;i<e;){let o=t[i];if(o<=127){a+=String.fromCharCode(o),i++;continue}let n=0,c=0;if(o<=223?(n=1,c=31&o):o<=239?(n=2,c=15&o):o<=244&&(n=3,c=7&o),e-i-n>0){let e=0;for(;e<n;)o=t[i+e+1],c=c<<6|63&o,e+=1}else c=65533,n=e-i;a+=String.fromCodePoint(c),i+=n+1}return a};if("undefined"!=typeof TextEncoder){const t=new TextEncoder;li=function(e,a,i=0,o=ci(a)){const n=Math.min(o,e.byteLength-i);return t.encodeInto(a,e.subarray(i,i+n)),n}}else li=function(t,e,a=0,i=ci(e)){const o=Math.min(i,t.byteLength-a);t=t.subarray(a,a+o);let n=0,c=0;for(;n<e.length;){const a=e.codePointAt(n);if(a<=127){t[c++]=a,n++;continue}let i=0,o=0;for(a<=2047?(i=6,o=192):a<=65535?(i=12,o=224):a<=2097151&&(i=18,o=240),t[c++]=o|a>>i,i-=6;i>=0;)t[c++]=128|a>>i&63,i-=6;n+=a>=65536?2:1}return o};function si(t){return 2*t.length}var di={byteLength:si,toString:function(t){const e=t.byteLength;let a="";for(let i=0;i<e-1;i+=2)a+=String.fromCharCode(t[i]+256*t[i+1]);return a},write:function(t,e,a=0,i=si(e)){const o=Math.min(i,t.byteLength-a);let n=o;for(let i=0;i<e.length&&!((n-=2)<0);++i){const o=e.charCodeAt(i),n=o>>8,c=o%256;t[a+2*i]=c,t[a+2*i+1]=n}return o}};const ui=Ja,gi=ai,_i=oi,fi={byteLength:ci,toString:ri,write:li},hi=di,pi=255===new Uint8Array(Uint16Array.of(255).buffer)[0];function mi(t){switch(t){case"ascii":return ui;case"base64":return gi;case"hex":return _i;case"utf8":case"utf-8":case void 0:return fi;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return hi;default:throw new Error(`Unknown encoding: ${t}`)}}function Li(t){return t instanceof Uint8Array}function wi(t,e,a){return"string"==typeof t?function(t,e){const a=mi(e),i=new Uint8Array(a.byteLength(t));return a.write(i,t,0,i.byteLength),i}(t,e):Array.isArray(t)?function(t){const e=new Uint8Array(t.length);return e.set(t),e}(t):ArrayBuffer.isView(t)?function(t){const e=new Uint8Array(t.byteLength);return e.set(t),e}(t):function(t,e,a){return new Uint8Array(t,e,a)}(t,e,a)}function Ai(t,e,a,i,o){if(0===t.byteLength)return-1;if("string"==typeof a?(i=a,a=0):void 0===a?a=o?0:t.length-1:a<0&&(a+=t.byteLength),a>=t.byteLength){if(o)return-1;a=t.byteLength-1}else if(a<0){if(!o)return-1;a=0}if("string"==typeof e)e=wi(e,i);else if("number"==typeof e)return e&=255,o?t.indexOf(e,a):t.lastIndexOf(e,a);if(0===e.byteLength)return-1;if(o){let i=-1;for(let o=a;o<t.byteLength;o++)if(t[o]===e[-1===i?0:o-i]){if(-1===i&&(i=o),o-i+1===e.byteLength)return i}else-1!==i&&(o-=o-i),i=-1}else{a+e.byteLength>t.byteLength&&(a=t.byteLength-e.byteLength);for(let i=a;i>=0;i--){let a=!0;for(let o=0;o<e.byteLength;o++)if(t[i+o]!==e[o]){a=!1;break}if(a)return i}}return-1}function bi(t,e,a,i){return Ai(t,e,a,i,!0)}function yi(t,e,a){const i=t[e];t[e]=t[a],t[a]=i}var Ii,Ci,Fi={isBuffer:Li,isEncoding:function(t){try{return mi(t),!0}catch{return!1}},alloc:function(t,e,a){const i=new Uint8Array(t);return void 0!==e&&e(i,e,0,i.byteLength,a),i},allocUnsafe:function(t){return new Uint8Array(t)},allocUnsafeSlow:function(t){return new Uint8Array(t)},byteLength:function(t,e){return mi(e).byteLength(t)},compare:function(t,e){if(t===e)return 0;const a=Math.min(t.byteLength,e.byteLength);t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let i=0;for(let o=a-a%4;i<o;i+=4){if(t.getUint32(i,pi)!==e.getUint32(i,pi))break}for(;i<a;i++){const a=t.getUint8(i),o=e.getUint8(i);if(a<o)return-1;if(a>o)return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0},concat:function(t,e){void 0===e&&(e=t.reduce(((t,e)=>t+e.byteLength),0));const a=new Uint8Array(e);return t.reduce(((t,e)=>(a.set(e,t),t+e.byteLength)),0),a},copy:function(t,e,a=0,i=0,o=t.byteLength){if(o>0&&o<i)return 0;if(o===i)return 0;if(0===t.byteLength||0===e.byteLength)return 0;if(a<0)throw new RangeError("targetStart is out of range");if(i<0||i>=t.byteLength)throw new RangeError("sourceStart is out of range");if(o<0)throw new RangeError("sourceEnd is out of range");a>=e.byteLength&&(a=e.byteLength),o>t.byteLength&&(o=t.byteLength),e.byteLength-a<o-i&&(o=e.length-a+i);const n=o-i;return t===e?e.copyWithin(a,i,o):e.set(t.subarray(i,o),a),n},equals:function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;const a=t.byteLength;t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let i=0;for(let o=a-a%4;i<o;i+=4)if(t.getUint32(i,pi)!==e.getUint32(i,pi))return!1;for(;i<a;i++)if(t.getUint8(i)!==e.getUint8(i))return!1;return!0},fill:function(t,e,a,i,o){if("string"==typeof e?"string"==typeof a?(o=a,a=0,i=t.byteLength):"string"==typeof i&&(o=i,i=t.byteLength):"number"==typeof val?e&=255:"boolean"==typeof val&&(e=+e),a<0||t.byteLength<a||t.byteLength<i)throw new RangeError("Out of range index");if(void 0===a&&(a=0),void 0===i&&(i=t.byteLength),i<=a)return t;if(e||(e=0),"number"==typeof e)for(let o=a;o<i;++o)t[o]=e;else{const n=(e=Li(e)?e:wi(e,o)).byteLength;for(let o=0;o<i-a;++o)t[o+a]=e[o%n]}return t},from:wi,includes:function(t,e,a,i){return-1!==bi(t,e,a,i)},indexOf:bi,lastIndexOf:function(t,e,a,i){return Ai(t,e,a,i,!1)},swap16:function(t){const e=t.byteLength;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let a=0;a<e;a+=2)yi(t,a,a+1);return t},swap32:function(t){const e=t.byteLength;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let a=0;a<e;a+=4)yi(t,a,a+3),yi(t,a+1,a+2);return t},swap64:function(t){const e=t.byteLength;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let a=0;a<e;a+=8)yi(t,a,a+7),yi(t,a+1,a+6),yi(t,a+2,a+5),yi(t,a+3,a+4);return t},toBuffer:function(t){return t},toString:function(t,e,a=0,i=t.byteLength){const o=t.byteLength;return a>=o||i<=a?"":(a<0&&(a=0),i>o&&(i=o),(0!==a||i<o)&&(t=t.subarray(a,i)),mi(e).toString(t))},write:function(t,e,a,i,o){return void 0===a?o="utf8":void 0===i&&"string"==typeof a?(o=a,a=void 0):void 0===o&&"string"==typeof i&&(o=i,i=void 0),mi(o).write(t,e,a,i)},writeDoubleLE:function(t,e,a){return void 0===a&&(a=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(a,e,!0),a+8},writeFloatLE:function(t,e,a){return void 0===a&&(a=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(a,e,!0),a+4},writeUInt32LE:function(t,e,a){return void 0===a&&(a=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setUint32(a,e,!0),a+4},writeInt32LE:function(t,e,a){return void 0===a&&(a=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setInt32(a,e,!0),a+4},readDoubleLE:function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(e,!0)},readFloatLE:function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(e,!0)},readUInt32LE:function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getUint32(e,!0)},readInt32LE:function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getInt32(e,!0)}};var xi=Ya,Ei=Fi,Bi=null,vi="undefined"!=typeof WebAssembly&&function(){if(Ci)return Ii;Ci=1;var t=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var a=e.length,i=new Uint8Array(3*(a-("="==e[a-1])-("="==e[a-2]))/4|0),o=0,n=0;o<a;){var c=t[e.charCodeAt(o++)],r=t[e.charCodeAt(o++)],l=t[e.charCodeAt(o++)],s=t[e.charCodeAt(o++)];i[n++]=c<<2|r>>4,i[n++]=r<<4|l>>2,i[n++]=l<<6|s}return i}})(),e=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./blake2b.wat"(e,a){a.exports=t("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}}),a=e(),i=WebAssembly.compile(a);return Ii=async t=>(await WebAssembly.instantiate(await i,t)).exports}()().then((t=>{Bi=t})),Si=64,Gi=[];$a.exports=Mi;var Pi=$a.exports.BYTES_MIN=16,Ui=$a.exports.BYTES_MAX=64;$a.exports.BYTES=32;var Oi=$a.exports.KEYBYTES_MIN=16,zi=$a.exports.KEYBYTES_MAX=64;$a.exports.KEYBYTES=32;var Qi=$a.exports.SALTBYTES=16,qi=$a.exports.PERSONALBYTES=16;function Mi(t,e,a,i,o){if(!(this instanceof Mi))return new Mi(t,e,a,i,o);if(!Bi)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");t||(t=32),!0!==o&&(xi(t>=Pi,"digestLength must be at least "+Pi+", was given "+t),xi(t<=Ui,"digestLength must be at most "+Ui+", was given "+t),null!=e&&(xi(e instanceof Uint8Array,"key must be Uint8Array or Buffer"),xi(e.length>=Oi,"key must be at least "+Oi+", was given "+e.length),xi(e.length<=zi,"key must be at least "+zi+", was given "+e.length)),null!=a&&(xi(a instanceof Uint8Array,"salt must be Uint8Array or Buffer"),xi(a.length===Qi,"salt must be exactly "+Qi+", was given "+a.length)),null!=i&&(xi(i instanceof Uint8Array,"personal must be Uint8Array or Buffer"),xi(i.length===qi,"personal must be exactly "+qi+", was given "+i.length))),Gi.length||(Gi.push(Si),Si+=216),this.digestLength=t,this.finalized=!1,this.pointer=Gi.pop(),this._memory=new Uint8Array(Bi.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=e?e.length:0,this._memory[2]=1,this._memory[3]=1,a&&this._memory.set(a,32),i&&this._memory.set(i,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),Bi.blake2b_init(this.pointer,this.digestLength),e&&(this.update(e),this._memory.fill(0,Si,Si+e.length),this._memory[this.pointer+200]=128)}function Ti(){}function ki(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function Ri(t,e){const a=new DataView(t.buffer,t.byteOffset,t.byteLength);let i="";for(let t=0;t<4;t++){t>0&&(i+="\\n"),i+="\\t\\t";for(let e=0;e<4;e++)e>0&&(i+=" "),i+=a.getUint32(16*t+4*e).toString(16).padStart(8,"0")}return e&&(i=e+"\\n"+i),i}function Di(t,e){if(t.byteLength!=e.byteLength)return!1;for(var a=new Int8Array(t),i=new Int8Array(e),o=0;o!=t.byteLength;o++)if(a[o]!=i[o])return!1;return!0}function Ni(t){const e=t.getPartialHash(),a=$a.exports(64);return a.setPartialHash(e),a}async function Vi(t,e,a,i,o){if(t.G1.isZero(e))return!1;if(t.G1.isZero(a))return!1;if(t.G2.isZero(i))return!1;if(t.G2.isZero(o))return!1;return await t.pairingEq(e,o,t.G1.neg(a),i)}async function Ki(t){for(;!t;)t=await window.prompt("Enter a random text. (Entropy): ","");const e=$a.exports(64);e.update(M.randomBytes(64));const a=new TextEncoder;e.update(a.encode(t));const i=Buffer.from(e.digest()),o=[];for(let t=0;t<8;t++)o[t]=i.readUInt32BE(4*t);return new q(o)}function ji(t,e){let a,i;e<32?(a=1<<e>>>0,i=1):(a=4294967296,i=1<<e-32>>>0);let o=t;for(let t=0;t<i;t++)for(let t=0;t<a;t++)o=M.createHash("sha256").update(o).digest();const n=new DataView(o.buffer,o.byteOffset,o.byteLength),c=[];for(let t=0;t<8;t++)c[t]=n.getUint32(4*t,!1);return new q(c)}function Hi(t){return t instanceof Uint8Array?t:("0x"==t.slice(0,2)&&(t=t.slice(2)),new Uint8Array(t.match(/[\\da-f]{2}/gi).map((function(t){return parseInt(t,16)}))))}function $i(t){return Array.prototype.map.call(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")}function Yi(t,e){if(e instanceof Uint8Array)return t.toString(e);if(Array.isArray(e))return e.map(Yi.bind(null,t));if("object"==typeof e){const a={};return Object.keys(e).forEach((i=>{a[i]=Yi(t,e[i])})),a}return"bigint"==typeof e||void 0!==e.eq?e.toString(10):e}async function Wi(t,e){await za(t,1),await t.writeULE32(1),await Qa(t);const a=await ja(e.q);await za(t,2);const i=a.q,o=8*(Math.floor((ha.bitLength(i)-1)/64)+1),n=a.r,c=8*(Math.floor((ha.bitLength(n)-1)/64)+1);await t.writeULE32(o),await Ta(t,i,o),await t.writeULE32(c),await Ta(t,n,c),await t.writeULE32(e.nVars),await t.writeULE32(e.nPublic),await t.writeULE32(e.domainSize),await Zi(t,a,e.vk_alpha_1),await Zi(t,a,e.vk_beta_1),await Ji(t,a,e.vk_beta_2),await Ji(t,a,e.vk_gamma_2),await Zi(t,a,e.vk_delta_1),await Ji(t,a,e.vk_delta_2),await Qa(t)}async function Zi(t,e,a){const i=new Uint8Array(2*e.G1.F.n8);e.G1.toRprLEM(i,0,a),await t.write(i)}async function Ji(t,e,a){const i=new Uint8Array(2*e.G2.F.n8);e.G2.toRprLEM(i,0,a),await t.write(i)}async function Xi(t,e,a){const i=await t.read(2*e.G1.F.n8),o=e.G1.fromRprLEM(i,0);return a?e.G1.toObject(o):o}async function to(t,e,a){const i=await t.read(2*e.G2.F.n8),o=e.G2.fromRprLEM(i,0);return a?e.G2.toObject(o):o}async function eo(t,e,a){await qa(t,e,1);const i=await t.readULE32();if(await Ma(t),1==i)return await async function(t,e,a){const i={protocol:"groth16"};await qa(t,e,2);const o=await t.readULE32();i.n8q=o,i.q=await ka(t,o);const n=await t.readULE32();return i.n8r=n,i.r=await ka(t,n),i.curve=await ja(i.q),i.nVars=await t.readULE32(),i.nPublic=await t.readULE32(),i.domainSize=await t.readULE32(),i.power=ki(i.domainSize),i.vk_alpha_1=await Xi(t,i.curve,a),i.vk_beta_1=await Xi(t,i.curve,a),i.vk_beta_2=await to(t,i.curve,a),i.vk_gamma_2=await to(t,i.curve,a),i.vk_delta_1=await Xi(t,i.curve,a),i.vk_delta_2=await to(t,i.curve,a),await Ma(t),i}(t,e,a);if(2==i)return await async function(t,e,a){const i={protocol:"plonk"};await qa(t,e,2);const o=await t.readULE32();i.n8q=o,i.q=await ka(t,o);const n=await t.readULE32();return i.n8r=n,i.r=await ka(t,n),i.curve=await ja(i.q),i.nVars=await t.readULE32(),i.nPublic=await t.readULE32(),i.domainSize=await t.readULE32(),i.power=ki(i.domainSize),i.nAdditions=await t.readULE32(),i.nConstrains=await t.readULE32(),i.k1=await t.read(n),i.k2=await t.read(n),i.Qm=await Xi(t,i.curve,a),i.Ql=await Xi(t,i.curve,a),i.Qr=await Xi(t,i.curve,a),i.Qo=await Xi(t,i.curve,a),i.Qc=await Xi(t,i.curve,a),i.S1=await Xi(t,i.curve,a),i.S2=await Xi(t,i.curve,a),i.S3=await Xi(t,i.curve,a),i.X_2=await to(t,i.curve,a),await Ma(t),i}(t,e,a);throw new Error("Protocol not supported: ")}async function ao(t,e,a){const i={delta:{}};i.deltaAfter=await Xi(t,e,a),i.delta.g1_s=await Xi(t,e,a),i.delta.g1_sx=await Xi(t,e,a),i.delta.g2_spx=await to(t,e,a),i.transcript=await t.read(64),i.type=await t.readULE32();const o=await t.readULE32(),n=t.pos;let c=0;for(;t.pos-n<o;){const e=await t.read(1);if(e[0]<=c)throw new Error("Parameters in the contribution must be sorted");if(c=e[0],1==e[0]){const e=await t.read(1),a=await t.read(e[0]);i.name=(new TextDecoder).decode(a)}else if(2==e[0]){const e=await t.read(1);i.numIterationsExp=e[0]}else{if(3!=e[0])throw new Error("Parameter not recognized");{const e=await t.read(1);i.beaconHash=await t.read(e[0])}}}if(t.pos!=n+o)throw new Error("Parametes do not match");return i}async function io(t,e,a){await qa(t,a,10);const i={contributions:[]};i.csHash=await t.read(64);const o=await t.readULE32();for(let a=0;a<o;a++){const a=await ao(t,e);i.contributions.push(a)}return await Ma(t),i}async function oo(t,e,a){await Zi(t,e,a.deltaAfter),await Zi(t,e,a.delta.g1_s),await Zi(t,e,a.delta.g1_sx),await Ji(t,e,a.delta.g2_spx),await t.write(a.transcript),await t.writeULE32(a.type||0);const i=[];if(a.name){i.push(1);const t=new TextEncoder("utf-8").encode(a.name.substring(0,64));i.push(t.byteLength);for(let e=0;e<t.byteLength;e++)i.push(t[e])}if(1==a.type){i.push(2),i.push(a.numIterationsExp),i.push(3),i.push(a.beaconHash.byteLength);for(let t=0;t<a.beaconHash.byteLength;t++)i.push(a.beaconHash[t])}if(i.length>0){const e=new Uint8Array(i);await t.writeULE32(e.byteLength),await t.write(e)}else await t.writeULE32(0)}async function no(t,e,a){await za(t,10),await t.write(a.csHash),await t.writeULE32(a.contributions.length);for(let i=0;i<a.contributions.length;i++)await oo(t,e,a.contributions[i]);await Qa(t)}function co(t,e,a){const i=new Uint8Array(2*e.G1.F.n8);e.G1.toRprUncompressed(i,0,a),t.update(i)}function ro(t,e,a){co(t,e,a.deltaAfter),co(t,e,a.delta.g1_s),co(t,e,a.delta.g1_sx),function(t,e,a){const i=new Uint8Array(2*e.G2.F.n8);e.G2.toRprUncompressed(i,0,a),t.update(i)}(t,e,a.delta.g2_spx),t.update(a.transcript)}async function lo(t,e){await qa(t,e,1);const a=await t.readULE32(),i=await ka(t,a),o=await t.readULE32();return await Ma(t),{n8:a,q:i,nWitness:o}}Mi.prototype._realloc=function(t){Bi.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(Bi.memory.buffer)},Mi.prototype.update=function(t){return xi(!1===this.finalized,"Hash instance finalized"),xi(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),Si+t.length>this._memory.length&&this._realloc(Si+t.length),this._memory.set(t,Si),Bi.blake2b_update(this.pointer,Si,Si+t.length),this},Mi.prototype.digest=function(t){if(xi(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,Gi.push(this.pointer),Bi.blake2b_final(this.pointer),!t||"binary"===t)return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if("string"==typeof t)return Ei.toString(this._memory,t,this.pointer+128,this.pointer+128+this.digestLength);xi(t instanceof Uint8Array&&t.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var e=0;e<this.digestLength;e++)t[e]=this._memory[this.pointer+128+e];return t},Mi.prototype.final=Mi.prototype.digest,Mi.WASM=Bi,Mi.SUPPORTED="undefined"!=typeof WebAssembly,Mi.ready=function(t){return t||(t=Ti),vi?vi.then((()=>t()),t):t(new Error("WebAssembly not supported"))},Mi.prototype.ready=Mi.ready,Mi.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},Mi.prototype.setPartialHash=function(t){this._memory.set(t,this.pointer)};const{stringifyBigInts:so}=pa;async function uo(t,e,a){const{fd:i,sections:o}=await Ua(e,"wtns",2),n=await lo(i,o),{fd:c,sections:r}=await Ua(t,"zkey",2),l=await eo(c,r);if("groth16"!=l.protocol)throw new Error("zkey file is not groth16");if(!ha.eq(l.r,n.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(n.nWitness!=l.nVars)throw new Error(`Invalid witness length. Circuit: ${l.nVars}, witness: ${n.nWitness}`);const s=l.curve,d=s.Fr,u=s.G1,g=s.G2,_=ki(l.domainSize);a&&a.debug("Reading Wtns");const f=await Da(i,o,2);a&&a.debug("Reading Coeffs");const h=await Da(c,r,4);a&&a.debug("Building ABC");const[p,m,L]=await async function(t,e,a,i,o){const n=t.Fr.n8,c=12+e.n8r,r=(i.byteLength-4)/c,l=new Pe(e.domainSize*n),s=new Pe(e.domainSize*n),d=new Pe(e.domainSize*n),u=[l,s];for(let e=0;e<r;e++){o&&e%1e6==0&&o.debug(`QAP AB: ${e}/${r}`);const l=i.slice(4+e*c,4+e*c+c),s=new DataView(l.buffer),d=s.getUint32(0,!0),g=s.getUint32(4,!0),_=s.getUint32(8,!0),f=l.slice(12,12+n);u[d].set(t.Fr.add(u[d].slice(g*n,g*n+n),t.Fr.mul(f,a.slice(_*n,_*n+n))),g*n)}for(let a=0;a<e.domainSize;a++)o&&a%1e6==0&&o.debug(`QAP C: ${a}/${e.domainSize}`),d.set(t.Fr.mul(l.slice(a*n,a*n+n),s.slice(a*n,a*n+n)),a*n);return[l,s,d]}(s,l,f,h,a),w=_==d.s?s.Fr.shift:s.Fr.w[_+1],A=await d.ifft(p,"","",a,"IFFT_A"),b=await d.batchApplyKey(A,d.e(1),w),y=await d.fft(b,"","",a,"FFT_A"),I=await d.ifft(m,"","",a,"IFFT_B"),C=await d.batchApplyKey(I,d.e(1),w),F=await d.fft(C,"","",a,"FFT_B"),x=await d.ifft(L,"","",a,"IFFT_C"),E=await d.batchApplyKey(x,d.e(1),w),B=await d.fft(E,"","",a,"FFT_C");a&&a.debug("Join ABC");const v=await async function(t,e,a,i,o,n){const c=1<<22,r=t.Fr.n8,l=Math.floor(a.byteLength/t.Fr.n8),s=[];for(let e=0;e<l;e+=c){n&&n.debug(`JoinABC: ${e}/${l}`);const d=Math.min(l-e,c),u=[],g=a.slice(e*r,(e+d)*r),_=i.slice(e*r,(e+d)*r),f=o.slice(e*r,(e+d)*r);u.push({cmd:"ALLOCSET",var:0,buff:g}),u.push({cmd:"ALLOCSET",var:1,buff:_}),u.push({cmd:"ALLOCSET",var:2,buff:f}),u.push({cmd:"ALLOC",var:3,len:d*r}),u.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:d},{var:3}]}),u.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:d},{var:3}]}),u.push({cmd:"GET",out:0,var:3,len:d*r}),s.push(t.tm.queueAction(u))}const d=await Promise.all(s);let u;u=a instanceof Pe?new Pe(a.byteLength):new Uint8Array(a.byteLength);let g=0;for(let t=0;t<d.length;t++)u.set(d[t][0],g),g+=d[t][0].byteLength;return u}(s,0,y,F,B,a);let S={};a&&a.debug("Reading A Points");const G=await Da(c,r,5);S.pi_a=await s.G1.multiExpAffine(G,f,a,"multiexp A"),a&&a.debug("Reading B1 Points");const P=await Da(c,r,6);let U=await s.G1.multiExpAffine(P,f,a,"multiexp B1");a&&a.debug("Reading B2 Points");const O=await Da(c,r,7);S.pi_b=await s.G2.multiExpAffine(O,f,a,"multiexp B2"),a&&a.debug("Reading C Points");const z=await Da(c,r,8);S.pi_c=await s.G1.multiExpAffine(z,f.slice((l.nPublic+1)*s.Fr.n8),a,"multiexp C"),a&&a.debug("Reading H Points");const Q=await Da(c,r,9),q=await s.G1.multiExpAffine(Q,v,a,"multiexp H"),M=s.Fr.random(),T=s.Fr.random();S.pi_a=u.add(S.pi_a,l.vk_alpha_1),S.pi_a=u.add(S.pi_a,u.timesFr(l.vk_delta_1,M)),S.pi_b=g.add(S.pi_b,l.vk_beta_2),S.pi_b=g.add(S.pi_b,g.timesFr(l.vk_delta_2,T)),U=u.add(U,l.vk_beta_1),U=u.add(U,u.timesFr(l.vk_delta_1,T)),S.pi_c=u.add(S.pi_c,q),S.pi_c=u.add(S.pi_c,u.timesFr(S.pi_a,T)),S.pi_c=u.add(S.pi_c,u.timesFr(U,M)),S.pi_c=u.add(S.pi_c,u.timesFr(l.vk_delta_1,d.neg(d.mul(M,T))));let k=[];for(let t=1;t<=l.nPublic;t++){const e=f.slice(t*d.n8,t*d.n8+d.n8);k.push(ha.fromRprLE(e))}return S.pi_a=u.toObject(u.toAffine(S.pi_a)),S.pi_b=g.toObject(g.toAffine(S.pi_b)),S.pi_c=u.toObject(u.toAffine(S.pi_c)),S.protocol="groth16",S.curve=s.name,await c.close(),await i.close(),S=so(S),k=so(k),{proof:S,publicSignals:k}}function go(t){var e=[];return function t(e,a){if(Array.isArray(a))for(let i=0;i<a.length;i++)t(e,a[i]);else e.push(a)}(e,t),e}function _o(t){const e=BigInt(2)**BigInt(64);let a=BigInt("0xCBF29CE484222325");for(var i=0;i<t.length;i++)a^=BigInt(t[i].charCodeAt()),a*=BigInt(1099511628211),a%=e;let o=a.toString(16),n=16-o.length;return o="0".repeat(n).concat(o),o}function fo(t,e){const a=[];let i=BigInt(t);const o=BigInt(4294967296);for(;i;)a.unshift(Number(i%o)),i/=o;if(e)for(var n=e-a.length;n>0;)a.unshift(0),n--;return a}async function ho(t,e){e=e||{};let a,i=32767,o=!1;for(;!o;)try{a=new WebAssembly.Memory({initial:i}),o=!0}catch(t){if(1===i)throw t;console.warn("Could not allocate "+1024*i*64+" bytes. This may cause severe instability. Trying with "+1024*i*64/2+" bytes"),i=Math.floor(i/2)}const n=await WebAssembly.compile(t);let c,r="",l="",s=1,d=0,u=0;const g=await WebAssembly.instantiate(n,{env:{memory:a},runtime:{exceptionHandler:function(t){let e;throw e=1==t?"Signal not found. ":2==t?"Too many signals set. ":3==t?"Signal already set. ":4==t?"Assert Failed. ":5==t?"Not enough memory. ":6==t?"Input signal array access exceeds the size. ":"Unknown error. ",console.error("ERROR: ",t,r),new Error(e+r)},printErrorMessage:function(){r+=f()+"\\n"},writeBufferMessage:function(){const t=f();"\\n"===t?(console.log(l),l=""):(""!==l&&(l+=" "),l+=t)},showSharedRWMemory:function(){const t=g.exports.getFieldNumLen32(),e=new Uint32Array(t);for(let a=0;a<t;a++)e[t-1-a]=g.exports.readSharedRWMemory(a);if(s>=2&&(d>=1||u>=7)){""!==l&&(l+=" ");const t=ha.fromArray(e,4294967296).toString();l+=t}else console.log(ha.fromArray(e,4294967296))},error:function(t,a,i,o,n,r){let l;throw l=7==t?h(a)+" "+c.getFr(o).toString()+" != "+c.getFr(n).toString()+" "+h(r):9==t?h(a)+" "+c.getFr(o).toString()+" "+h(n):5==t&&e.sym?h(a)+" "+e.sym.labelIdx2Name[n]:h(a)+" "+i+" "+o+" "+n+" "+r,console.log("ERROR: ",t,l),new Error(l)},log:function(t){console.log(c.getFr(t).toString())},logGetSignal:function(t,a){e.logGetSignal&&e.logGetSignal(t,c.getFr(a))},logSetSignal:function(t,a){e.logSetSignal&&e.logSetSignal(t,c.getFr(a))},logStartComponent:function(t){e.logStartComponent&&e.logStartComponent(t)},logFinishComponent:function(t){e.logFinishComponent&&e.logFinishComponent(t)}}});"function"==typeof g.exports.getVersion&&(s=g.exports.getVersion()),"function"==typeof g.exports.getMinorVersion&&(d=g.exports.getMinorVersion()),"function"==typeof g.exports.getPatchVersion&&(u=g.exports.getPatchVersion());const _=e&&(e.sanityCheck||e.logGetSignal||e.logSetSignal||e.logStartComponent||e.logFinishComponent);return c=2===s?new mo(g,_):new po(a,g,_),c;function f(){for(var t="",e=g.exports.getMessageChar();0!=e;)t+=String.fromCharCode(e),e=g.exports.getMessageChar();return t}function h(t){const e=new Uint8Array(a.buffer),i=[];for(let a=0;e[t+a]>0;a++)i.push(e[t+a]);return String.fromCharCode.apply(null,i)}}class po{constructor(t,e,a){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=e,this.n32=(this.instance.exports.getFrLen()>>2)-2;const i=this.instance.exports.getPRawPrime(),o=new Array(this.n32);for(let t=0;t<this.n32;t++)o[this.n32-1-t]=this.i32[(i>>2)+t];this.prime=ha.fromArray(o,4294967296),this.Fr=new K(this.prime),this.mask32=ha.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(ha.shiftLeft(1,64*this.n64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=a}circom_version(){return 1}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);const a=this.allocInt(),i=this.allocFr();Object.keys(t).forEach((e=>{const o=_o(e),n=parseInt(o.slice(0,8),16),c=parseInt(o.slice(8,16),16);try{this.instance.exports.getSignalOffset32(a,0,n,c)}catch(t){throw new Error(`Signal ${e} is not an input of the circuit.`)}const r=this.getInt(a),l=go(t[e]);for(let t=0;t<l.length;t++)this.setFr(i,l[t]),this.instance.exports.setSignal(0,0,r+t,i)}))}async calculateWitness(t,e){const a=this,i=a.i32[0],o=[];await a._doCalculateWitness(t,e);for(let t=0;t<a.NVars;t++){const e=a.instance.exports.getPWitness(t);o.push(a.getFr(e))}return a.i32[0]=i,o}async calculateBinWitness(t,e){const a=this,i=a.i32[0];await a._doCalculateWitness(t,e);const o=a.instance.exports.getWitnessBuffer();a.i32[0]=i;const n=a.memory.buffer.slice(o,o+a.NVars*a.n64*8);return new Uint8Array(n)}allocInt(){const t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){const t=this.i32[0];return this.i32[0]=t+4*this.n32+8,t}getInt(t){return this.i32[t>>2]}setInt(t,e){this.i32[t>>2]=e}getFr(t){const e=this,a=t>>2;if(2147483648&e.i32[a+1]){const t=new Array(e.n32);for(let i=0;i<e.n32;i++)t[e.n32-1-i]=e.i32[a+2+i];const o=e.Fr.e(ha.fromArray(t,4294967296));return 1073741824&e.i32[a+1]?(i=o,e.Fr.mul(e.RInv,i)):o}return 2147483648&e.i32[a]?e.Fr.e(e.i32[a]-4294967296):e.Fr.e(e.i32[a]);var i}setFr(t,e){const a=this;e=a.Fr.e(e);const i=a.Fr.neg(a.Fr.e("80000000",16)),o=a.Fr.e("7FFFFFFF",16);if(a.Fr.geq(e,i)&&a.Fr.leq(e,o)){let o;return a.Fr.geq(e,a.Fr.zero)?o=ha.toNumber(e):(o=ha.toNumber(a.Fr.sub(e,i)),o-=2147483648,o=4294967296+o),a.i32[t>>2]=o,void(a.i32[1+(t>>2)]=0)}a.i32[t>>2]=0,a.i32[1+(t>>2)]=2147483648;const n=ha.toArray(e,4294967296);for(let e=0;e<a.n32;e++){const i=n.length-1-e;a.i32[2+(t>>2)+e]=i>=0?n[i]:0}}}class mo{constructor(t,e){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const a=new Array(this.n32);for(let t=0;t<this.n32;t++)a[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);this.prime=ha.fromArray(a,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=e}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);const a=Object.keys(t);var i=0;if(a.forEach((e=>{const a=_o(e),o=parseInt(a.slice(0,8),16),n=parseInt(a.slice(8,16),16),c=go(t[e]);for(let t=0;t<c.length;t++){const e=fo(c[t],this.n32);for(let t=0;t<this.n32;t++)this.instance.exports.writeSharedRWMemory(t,e[this.n32-1-t]);try{this.instance.exports.setInputSignal(o,n,t),i++}catch(t){throw new Error(t)}}})),i<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${i} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,e){const a=[];await this._doCalculateWitness(t,e);for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);const e=new Uint32Array(this.n32);for(let t=0;t<this.n32;t++)e[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);a.push(ha.fromArray(e,4294967296))}return a}async calculateWTNSBin(t,e){const a=new Uint32Array(this.witnessSize*this.n32+this.n32+11),i=new Uint8Array(a.buffer);await this._doCalculateWitness(t,e),i[0]="w".charCodeAt(0),i[1]="t".charCodeAt(0),i[2]="n".charCodeAt(0),i[3]="s".charCodeAt(0),a[1]=2,a[2]=2,a[3]=1;const o=4*this.n32,n=(8+o).toString(16);a[4]=parseInt(n.slice(0,8),16),a[5]=parseInt(n.slice(8,16),16),a[6]=o,this.instance.exports.getRawPrime();var c=7;for(let t=0;t<this.n32;t++)a[c+t]=this.instance.exports.readSharedRWMemory(t);a[c+=this.n32]=this.witnessSize,a[++c]=2,c++;const r=(o*this.witnessSize).toString(16);a[c]=parseInt(r.slice(0,8),16),a[c+1]=parseInt(r.slice(8,16),16),c+=2;for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);for(let t=0;t<this.n32;t++)a[c+t]=this.instance.exports.readSharedRWMemory(t);c+=this.n32}return i}}const{unstringifyBigInts:Lo}=pa;async function wo(t,e,a,i){const o=Lo(t),n=await Pa(e),c=await n.read(n.totalSize);await n.close();const r=await ho(c);if(1==r.circom_version()){const t=await r.calculateBinWitness(o),e=await Oa(a,"wtns",2,2);await async function(t,e,a){await za(t,1);const i=8*(Math.floor((ha.bitLength(a)-1)/64)+1);if(await t.writeULE32(i),await Ta(t,a,i),e.byteLength%i!=0)throw new Error("Invalid witness length");await t.writeULE32(e.byteLength/i),await Qa(t),await za(t,2),await t.write(e),await Qa(t)}(e,t,r.prime),await e.close()}else{const t=await Ga(a),e=await r.calculateWTNSBin(o);await t.write(e),await t.close()}}const{unstringifyBigInts:Ao}=pa;const{unstringifyBigInts:bo}=pa;const{unstringifyBigInts:yo}=pa;function Io(t){let e=t.toString(16);for(;e.length<64;)e="0"+e;return e=`"0x${e}"`,e}var Co=Object.freeze({__proto__:null,fullProve:async function(t,e,a,i){const o=Ao(t),n={type:"mem"};return await wo(o,e,n),await uo(a,n,i)},prove:uo,verify:async function(t,e,a,i){const o=bo(t),n=bo(a),c=bo(e),r=await Ha(o.curve),l=r.G1.fromObject(o.IC[0]),s=new Uint8Array(2*r.G1.F.n8*c.length),d=new Uint8Array(r.Fr.n8*c.length);for(let t=0;t<c.length;t++){const e=r.G1.fromObject(o.IC[t+1]);s.set(e,t*r.G1.F.n8*2),ha.toRprLE(d,r.Fr.n8*t,c[t],r.Fr.n8)}let u=await r.G1.multiExpAffine(s,d);u=r.G1.add(u,l);const g=r.G1.fromObject(n.pi_a),_=r.G2.fromObject(n.pi_b),f=r.G1.fromObject(n.pi_c),h=r.G2.fromObject(o.vk_gamma_2),p=r.G2.fromObject(o.vk_delta_2),m=r.G1.fromObject(o.vk_alpha_1),L=r.G2.fromObject(o.vk_beta_2);return await r.pairingEq(r.G1.neg(g),_,u,h,f,p,m,L)?(i&&i.info("OK!"),!0):(i&&i.error("Invalid proof"),!1)},exportSolidityCallData:async function(t,e){const a=yo(t),i=yo(e);let o,n="";for(let t=0;t<i.length;t++)""!=n&&(n+=","),n+=Io(i[t]);return o=`[${Io(a.pi_a[0])}, ${Io(a.pi_a[1])}],[[${Io(a.pi_b[0][1])}, ${Io(a.pi_b[0][0])}],[${Io(a.pi_b[1][1])}, ${Io(a.pi_b[1][0])}]],[${Io(a.pi_c[0])}, ${Io(a.pi_c[1])}],[${n}]`,o}});function Fo(t,e){const a=new DataView(e.buffer,e.byteOffset,e.byteLength),i=[];for(let t=0;t<8;t++)i[t]=a.getUint32(4*t);const o=new q(i);return t.G2.fromRng(o)}function xo(t,e,a,i,o){const n=$a.exports(64),c=new Uint8Array([e]);n.update(c),n.update(a);const r=t.G1.toUncompressed(i);n.update(r);const l=t.G1.toUncompressed(o);n.update(l);return Fo(t,n.digest())}function Eo(t,e,a,i,o){return t.g1_s=e.G1.toAffine(e.G1.fromRng(o)),t.g1_sx=e.G1.toAffine(e.G1.timesFr(t.g1_s,t.prvKey)),t.g2_sp=e.G2.toAffine(xo(e,a,i,t.g1_s,t.g1_sx)),t.g2_spx=e.G2.toAffine(e.G2.timesFr(t.g2_sp,t.prvKey)),t}function Bo(t,e,a){const i={tau:{},alpha:{},beta:{}};return i.tau.prvKey=t.Fr.fromRng(a),i.alpha.prvKey=t.Fr.fromRng(a),i.beta.prvKey=t.Fr.fromRng(a),Eo(i.tau,t,0,e,a),Eo(i.alpha,t,1,e,a),Eo(i.beta,t,2,e,a),i}async function vo(t,e,a,i){i||(i=a),await t.writeULE32(1);const o=t.pos;await t.writeULE64(0),await t.writeULE32(8*e.F1.n64);const n=new Uint8Array(e.F1.n8);ha.toRprLE(n,0,e.q,e.F1.n8),await t.write(n),await t.writeULE32(a),await t.writeULE32(i);const c=t.pos-o-8,r=t.pos;await t.writeULE64(c,o),t.pos=r}async function So(t,e){if(!e[1])throw new Error(t.fileName+": File has no  header");if(e[1].length>1)throw new Error(t.fileName+": File has more than one header");t.pos=e[1][0].p;const a=await t.readULE32(),i=await t.read(a),o=ha.fromRprLE(i),n=await ja(o);if(8*n.F1.n64!=a)throw new Error(t.fileName+": Invalid size");const c=await t.readULE32(),r=await t.readULE32();if(t.pos-e[1][0].p!=e[1][0].size)throw new Error("Invalid PTau header size");return{curve:n,power:c,ceremonyPower:r}}function Go(t,e,a,i){const o={tau:{},alpha:{},beta:{}};return o.tau.g1_s=n(),o.tau.g1_sx=n(),o.alpha.g1_s=n(),o.alpha.g1_sx=n(),o.beta.g1_s=n(),o.beta.g1_sx=n(),o.tau.g2_spx=c(),o.alpha.g2_spx=c(),o.beta.g2_spx=c(),o;function n(){let o;return o=i?a.G1.fromRprLEM(t,e):a.G1.fromRprUncompressed(t,e),e+=2*a.G1.F.n8,o}function c(){let o;return o=i?a.G2.fromRprLEM(t,e):a.G2.fromRprUncompressed(t,e),e+=2*a.G2.F.n8,o}}function Po(t,e,a,i,o){async function n(i){o?a.G1.toRprLEM(t,e,i):a.G1.toRprUncompressed(t,e,i),e+=2*a.F1.n8}async function c(i){o?a.G2.toRprLEM(t,e,i):a.G2.toRprUncompressed(t,e,i),e+=2*a.F2.n8}return n(i.tau.g1_s),n(i.tau.g1_sx),n(i.alpha.g1_s),n(i.alpha.g1_sx),n(i.beta.g1_s),n(i.beta.g1_sx),c(i.tau.g2_spx),c(i.alpha.g2_spx),c(i.beta.g2_spx),t}async function Uo(t,e){const a={};a.tauG1=await l(),a.tauG2=await s(),a.alphaG1=await l(),a.betaG1=await l(),a.betaG2=await s(),a.key=await async function(t,e,a){return Go(await t.read(2*e.F1.n8*6+2*e.F2.n8*3),0,e,a)}(t,e,!0),a.partialHash=await t.read(216),a.nextChallenge=await t.read(64),a.type=await t.readULE32();const i=new Uint8Array(2*e.G1.F.n8*6+2*e.G2.F.n8*3);Po(i,0,e,a.key,!1);const o=$a.exports(64);o.setPartialHash(a.partialHash),o.update(i),a.responseHash=o.digest();const n=await t.readULE32(),c=t.pos;let r=0;for(;t.pos-c<n;){const t=await d(1);if(t[0]<=r)throw new Error("Parameters in the contribution must be sorted");if(r=t[0],1==t[0]){const t=await d(1),e=await d(t[0]);a.name=(new TextDecoder).decode(e)}else if(2==t[0]){const t=await d(1);a.numIterationsExp=t[0]}else{if(3!=t[0])throw new Error("Parameter not recognized");{const t=await d(1);a.beaconHash=await d(t[0])}}}if(t.pos!=c+n)throw new Error("Parametes do not match");return a;async function l(){const a=await t.read(2*e.G1.F.n8);return e.G1.fromRprLEM(a)}async function s(){const a=await t.read(2*e.G2.F.n8);return e.G2.fromRprLEM(a)}async function d(e){const a=await t.read(e);return new Uint8Array(a)}}async function Oo(t,e,a){if(!a[7])throw new Error(t.fileName+": File has no  contributions");if(a[7][0].length>1)throw new Error(t.fileName+": File has more than one contributions section");t.pos=a[7][0].p;const i=await t.readULE32(),o=[];for(let a=0;a<i;a++){const i=await Uo(t,e);i.id=a+1,o.push(i)}if(t.pos-a[7][0].p!=a[7][0].size)throw new Error("Invalid contribution section size");return o}async function zo(t,e,a){const i=new Uint8Array(2*e.F1.n8),o=new Uint8Array(2*e.F2.n8);await c(a.tauG1),await r(a.tauG2),await c(a.alphaG1),await c(a.betaG1),await r(a.betaG2),await async function(t,e,a,i){const o=new Uint8Array(2*e.F1.n8*6+2*e.F2.n8*3);Po(o,0,e,a,i),await t.write(o)}(t,e,a.key,!0),await t.write(a.partialHash),await t.write(a.nextChallenge),await t.writeULE32(a.type||0);const n=[];if(a.name){n.push(1);const t=new TextEncoder("utf-8").encode(a.name.substring(0,64));n.push(t.byteLength);for(let e=0;e<t.byteLength;e++)n.push(t[e])}if(1==a.type){n.push(2),n.push(a.numIterationsExp),n.push(3),n.push(a.beaconHash.byteLength);for(let t=0;t<a.beaconHash.byteLength;t++)n.push(a.beaconHash[t])}if(n.length>0){const e=new Uint8Array(n);await t.writeULE32(e.byteLength),await t.write(e)}else await t.writeULE32(0);async function c(a){e.G1.toRprLEM(i,0,a),await t.write(i)}async function r(a){e.G2.toRprLEM(o,0,a),await t.write(o)}}async function Qo(t,e,a){await t.writeULE32(7);const i=t.pos;await t.writeULE64(0),await t.writeULE32(a.length);for(let i=0;i<a.length;i++)await zo(t,e,a[i]);const o=t.pos-i-8,n=t.pos;await t.writeULE64(o,i),t.pos=n}function qo(t,e,a){a&&a.debug("Calculating First Challenge Hash");const i=new $a.exports(64),o=new Uint8Array(2*t.G1.F.n8),n=new Uint8Array(2*t.G2.F.n8);let c;return t.G1.toRprUncompressed(o,0,t.G1.g),t.G2.toRprUncompressed(n,0,t.G2.g),i.update($a.exports(64).digest()),c=2**e*2-1,a&&a.debug("Calculate Initial Hash: tauG1"),r(o,c),c=2**e,a&&a.debug("Calculate Initial Hash: tauG2"),r(n,c),a&&a.debug("Calculate Initial Hash: alphaTauG1"),r(o,c),a&&a.debug("Calculate Initial Hash: betaTauG1"),r(o,c),i.update(n),i.digest();function r(t,e){const o=341e3,n=Math.floor(e/o),c=e%o,r=new Uint8Array(o*t.byteLength);for(let e=0;e<o;e++)r.set(t,e*t.byteLength);for(let t=0;t<n;t++)i.update(r),a&&a.debug("Initial hash: "+t*o);for(let e=0;e<c;e++)i.update(t)}}function Mo(t,e,a,i){return Bo(t,e,ji(a,i))}const To=Vi;async function ko(t,e,a,i){let o;if(1==e.type){const o=Mo(t,a.nextChallenge,e.beaconHash,e.numIterationsExp);if(!t.G1.eq(e.key.tau.g1_s,o.tau.g1_s))return i&&i.error(`BEACON key (tauG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.tau.g1_sx,o.tau.g1_sx))return i&&i.error(`BEACON key (tauG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.tau.g2_spx,o.tau.g2_spx))return i&&i.error(`BEACON key (tauG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.alpha.g1_s,o.alpha.g1_s))return i&&i.error(`BEACON key (alphaG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.alpha.g1_sx,o.alpha.g1_sx))return i&&i.error(`BEACON key (alphaG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.alpha.g2_spx,o.alpha.g2_spx))return i&&i.error(`BEACON key (alphaG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.beta.g1_s,o.beta.g1_s))return i&&i.error(`BEACON key (betaG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.beta.g1_sx,o.beta.g1_sx))return i&&i.error(`BEACON key (betaG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.beta.g2_spx,o.beta.g2_spx))return i&&i.error(`BEACON key (betaG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1}return e.key.tau.g2_sp=t.G2.toAffine(xo(t,0,a.nextChallenge,e.key.tau.g1_s,e.key.tau.g1_sx)),e.key.alpha.g2_sp=t.G2.toAffine(xo(t,1,a.nextChallenge,e.key.alpha.g1_s,e.key.alpha.g1_sx)),e.key.beta.g2_sp=t.G2.toAffine(xo(t,2,a.nextChallenge,e.key.beta.g1_s,e.key.beta.g1_sx)),o=await To(t,e.key.tau.g1_s,e.key.tau.g1_sx,e.key.tau.g2_sp,e.key.tau.g2_spx),!0!==o?(i&&i.error("INVALID key (tau) in challenge #"+e.id),!1):(o=await To(t,e.key.alpha.g1_s,e.key.alpha.g1_sx,e.key.alpha.g2_sp,e.key.alpha.g2_spx),!0!==o?(i&&i.error("INVALID key (alpha) in challenge #"+e.id),!1):(o=await To(t,e.key.beta.g1_s,e.key.beta.g1_sx,e.key.beta.g2_sp,e.key.beta.g2_spx),!0!==o?(i&&i.error("INVALID key (beta) in challenge #"+e.id),!1):(o=await To(t,a.tauG1,e.tauG1,e.key.tau.g2_sp,e.key.tau.g2_spx),!0!==o?(i&&i.error("INVALID tau*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(o=await To(t,e.key.tau.g1_s,e.key.tau.g1_sx,a.tauG2,e.tauG2),!0!==o?(i&&i.error("INVALID tau*G2. challenge #"+e.id+" It does not follow the previous contribution"),!1):(o=await To(t,a.alphaG1,e.alphaG1,e.key.alpha.g2_sp,e.key.alpha.g2_spx),!0!==o?(i&&i.error("INVALID alpha*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(o=await To(t,a.betaG1,e.betaG1,e.key.beta.g2_sp,e.key.beta.g2_spx),!0!==o?(i&&i.error("INVALID beta*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(o=await To(t,e.key.beta.g1_s,e.key.beta.g1_sx,a.betaG2,e.betaG2),!0!==o?(i&&i.error("INVALID beta*G2. challenge #"+e.id+"It does not follow the previous contribution"),!1):(i&&i.info("Powers Of tau file OK!"),!0))))))))}async function Ro(t,e,a,i,o,n,c,r,l,s){const d=o[n],u=2*d.F.n8,g=e[i][0].size/u;await qa(t,e,i),await za(a,i);let _=c;for(let e=0;e<g;e+=65536){s&&s.debug(`Applying key: ${l}: ${e}/${g}`);const i=Math.min(g-e,65536);let n;n=await t.read(i*u),n=await d.batchApplyKey(n,_,r),await a.write(n),_=o.Fr.mul(_,o.Fr.exp(r,i))}await Qa(a),await Ma(t)}async function Do(t,e,a,i,o,n,c,r,l,s,d){const u=i[o],g=2*u.F.n8,_=Math.floor((1<<20)/g);let f=c;for(let o=0;o<n;o+=_){d&&d.debug(`Applying key ${s}: ${o}/${n}`);const c=Math.min(n-o,_),h=await t.read(c*g),p=await u.batchUtoLEM(h),m=await u.batchApplyKey(p,f,r);let L;L="COMPRESSED"==l?await u.batchLEMtoC(m):await u.batchLEMtoU(m),a&&a.update(L),await e.write(L),f=i.Fr.mul(f,i.Fr.exp(r,c))}}var No=Object.freeze({__proto__:null,newAccumulator:async function(t,e,a,i){await $a.exports.ready();const o=await Oa(a,"ptau",1,7);await vo(o,t,e,0);const n=t.G1.oneAffine,c=t.G2.oneAffine;await za(o,2);const r=2**e*2-1;for(let t=0;t<r;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("tauG1: "+t);await Qa(o),await za(o,3);const l=2**e;for(let t=0;t<l;t++)await o.write(c),i&&t%1e5==0&&t&&i.log("tauG2: "+t);await Qa(o),await za(o,4);const s=2**e;for(let t=0;t<s;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("alphaTauG1: "+t);await Qa(o),await za(o,5);const d=2**e;for(let t=0;t<d;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("betaTauG1: "+t);await Qa(o),await za(o,6),await o.write(c),await Qa(o),await za(o,7),await o.writeULE32(0),await Qa(o),await o.close();const u=qo(t,e,i);return i&&i.debug(Ri($a.exports(64).digest(),"Blank Contribution Hash:")),i&&i.info(Ri(u,"First Contribution Hash:")),u},exportChallenge:async function(t,e,a){await $a.exports.ready();const{fd:i,sections:o}=await Ua(t,"ptau",1),{curve:n,power:c}=await So(i,o),r=await Oo(i,n,o);let l,s;0==r.length?(l=$a.exports(64).digest(),s=qo(n,c)):(l=r[r.length-1].responseHash,s=r[r.length-1].nextChallenge),a&&a.info(Ri(l,"Last Response Hash: ")),a&&a.info(Ri(s,"New Challenge Hash: "));const d=await Ga(e),u=$a.exports(64);await d.write(l),u.update(l),await _(2,"G1",2**c*2-1,"tauG1"),await _(3,"G2",2**c,"tauG2"),await _(4,"G1",2**c,"alphaTauG1"),await _(5,"G1",2**c,"betaTauG1"),await _(6,"G2",1,"betaG2"),await i.close(),await d.close();const g=u.digest();if(!Di(s,g))throw a&&a.info(Ri(g,"Calc Curret Challenge Hash: ")),a&&a.error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one"),new Error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one");return s;async function _(t,e,c,r){const l=n[e],s=2*l.F.n8,g=Math.floor((1<<24)/s);await qa(i,o,t);for(let t=0;t<c;t+=g){a&&a.debug(`Exporting ${r}: ${t}/${c}`);const e=Math.min(c-t,g);let o;o=await i.read(e*s),o=await l.batchLEMtoU(o),await d.write(o),u.update(o)}await Ma(i)}},importResponse:async function(t,e,a,i,o,n){await $a.exports.ready();const c=new Uint8Array(64);for(let t=0;t<64;t++)c[t]=255;const{fd:r,sections:l}=await Ua(t,"ptau",1),{curve:s,power:d}=await So(r,l),u=await Oo(r,s,l),g={};i&&(g.name=i);const _=2*s.F1.n8,f=s.F1.n8,h=2*s.F2.n8,p=s.F2.n8,m=await Pa(e);if(m.totalSize!=64+(2**d*2-1)*f+2**d*p+2**d*f+2**d*f+p+6*_+3*h)throw new Error("Size of the contribution is invalid");let L;L=u.length>0?u[u.length-1].nextChallenge:qo(s,d,n);const w=await Oa(a,"ptau",1,o?7:2);await vo(w,s,d);const A=await m.read(64);if(Di(c,L)&&(L=A,u[u.length-1].nextChallenge=L),!Di(A,L))throw new Error("Wrong contribution. this contribution is not based on the previus hash");const b=new $a.exports(64);b.update(A);const y=[];let I;I=await x(m,w,"G1",2,2**d*2-1,[1],"tauG1"),g.tauG1=I[0],I=await x(m,w,"G2",3,2**d,[1],"tauG2"),g.tauG2=I[0],I=await x(m,w,"G1",4,2**d,[0],"alphaG1"),g.alphaG1=I[0],I=await x(m,w,"G1",5,2**d,[0],"betaG1"),g.betaG1=I[0],I=await x(m,w,"G2",6,1,[0],"betaG2"),g.betaG2=I[0],g.partialHash=b.getPartialHash();const C=await m.read(2*s.F1.n8*6+2*s.F2.n8*3);g.key=Go(C,0,s,!1),b.update(new Uint8Array(C));const F=b.digest();if(n&&n.info(Ri(F,"Contribution Response Hash imported: ")),o){const t=new $a.exports(64);t.update(F),await E(t,w,"G1",2,2**d*2-1,"tauG1",n),await E(t,w,"G2",3,2**d,"tauG2",n),await E(t,w,"G1",4,2**d,"alphaTauG1",n),await E(t,w,"G1",5,2**d,"betaTauG1",n),await E(t,w,"G2",6,1,"betaG2",n),g.nextChallenge=t.digest(),n&&n.info(Ri(g.nextChallenge,"Next Challenge Hash: "))}else g.nextChallenge=c;return u.push(g),await Qo(w,s,u),await m.close(),await w.close(),await r.close(),g.nextChallenge;async function x(t,e,a,i,c,r,l){return o?await async function(t,e,a,i,o,c,r){const l=s[a],d=l.F.n8,u=2*l.F.n8,g=[];await za(e,i);const _=Math.floor((1<<24)/u);y[i]=e.pos;for(let a=0;a<o;a+=_){n&&n.debug(`Importing ${r}: ${a}/${o}`);const i=Math.min(o-a,_),s=await t.read(i*d);b.update(s);const f=await l.batchCtoLEM(s);await e.write(f);for(let t=0;t<c.length;t++){const e=c[t];if(e>=a&&e<a+i){const t=l.fromRprLEM(f,(e-a)*u);g.push(t)}}}return await Qa(e),g}(t,e,a,i,c,r,l):await async function(t,e,a,i,o,c,r){const l=s[a],d=l.F.n8,u=[],g=Math.floor((1<<24)/d);for(let e=0;e<o;e+=g){n&&n.debug(`Importing ${r}: ${e}/${o}`);const a=Math.min(o-e,g),i=await t.read(a*d);b.update(i);for(let t=0;t<c.length;t++){const o=c[t];if(o>=e&&o<e+a){const t=l.fromRprCompressed(i,(o-e)*d);u.push(t)}}}return u}(t,0,a,0,c,r,l)}async function E(t,e,a,i,o,n,c){const r=s[a],l=2*r.F.n8,d=Math.floor((1<<24)/l),u=e.pos;e.pos=y[i];for(let a=0;a<o;a+=d){c&&c.debug(`Hashing ${n}: ${a}/${o}`);const i=Math.min(o-a,d),s=await e.read(i*l),u=await r.batchLEMtoU(s);t.update(u)}e.pos=u}},verify:async function(t,e){let a;await $a.exports.ready();const{fd:i,sections:o}=await Ua(t,"ptau",1),{curve:n,power:c,ceremonyPower:r}=await So(i,o),l=await Oo(i,n,o);e&&e.debug("power: 2**"+c),e&&e.debug("Computing initial contribution hash");const s={tauG1:n.G1.g,tauG2:n.G2.g,alphaG1:n.G1.g,betaG1:n.G1.g,betaG2:n.G2.g,nextChallenge:qo(n,r,e),responseHash:$a.exports(64).digest()};if(0==l.length)return e&&e.error("This file has no contribution! It cannot be used in production"),!1;let d;d=l.length>1?l[l.length-2]:s;const u=l[l.length-1];if(e&&e.debug("Validating contribution #"+l[l.length-1].id),!await ko(n,u,d,e))return!1;const g=$a.exports(64);g.update(u.responseHash),e&&e.debug("Verifying powers in tau*G1 section");const _=await A(2,"G1","tauG1",2**c*2-1,[0,1],e);if(a=await To(n,_.R1,_.R2,n.G2.g,u.tauG2),!0!==a)return e&&e.error("tauG1 section. Powers do not match"),!1;if(!n.G1.eq(n.G1.g,_.singularPoints[0]))return e&&e.error("First element of tau*G1 section must be the generator"),!1;if(!n.G1.eq(u.tauG1,_.singularPoints[1]))return e&&e.error("Second element of tau*G1 section does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in tau*G2 section");const f=await A(3,"G2","tauG2",2**c,[0,1],e);if(a=await To(n,n.G1.g,u.tauG1,f.R1,f.R2),!0!==a)return e&&e.error("tauG2 section. Powers do not match"),!1;if(!n.G2.eq(n.G2.g,f.singularPoints[0]))return e&&e.error("First element of tau*G2 section must be the generator"),!1;if(!n.G2.eq(u.tauG2,f.singularPoints[1]))return e&&e.error("Second element of tau*G2 section does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in alpha*tau*G1 section");const h=await A(4,"G1","alphatauG1",2**c,[0],e);if(a=await To(n,h.R1,h.R2,n.G2.g,u.tauG2),!0!==a)return e&&e.error("alphaTauG1 section. Powers do not match"),!1;if(!n.G1.eq(u.alphaG1,h.singularPoints[0]))return e&&e.error("First element of alpha*tau*G1 section (alpha*G1) does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in beta*tau*G1 section");const p=await A(5,"G1","betatauG1",2**c,[0],e);if(a=await To(n,p.R1,p.R2,n.G2.g,u.tauG2),!0!==a)return e&&e.error("betaTauG1 section. Powers do not match"),!1;if(!n.G1.eq(u.betaG1,p.singularPoints[0]))return e&&e.error("First element of beta*tau*G1 section (beta*G1) does not match the one in the contribution section"),!1;const m=await async function(t){const e=n.G2,a=2*e.F.n8,c=new Uint8Array(a);if(!o[6])throw t.error("File has no BetaG2 section"),new Error("File has no BetaG2 section");if(o[6].length>1)throw t.error("File has no BetaG2 section"),new Error("File has more than one GetaG2 section");i.pos=o[6][0].p;const r=await i.read(a),l=e.fromRprLEM(r);return e.toRprUncompressed(c,0,l),g.update(c),l}(e);if(!n.G2.eq(u.betaG2,m))return e&&e.error("betaG2 element in betaG2 section does not match the one in the contribution section"),!1;const L=g.digest();if(c==r&&!Di(L,u.nextChallenge))return e&&e.error("Hash of the values does not match the next challenge of the last contributor in the contributions section"),!1;e&&e.info(Ri(L,"Next challenge hash: ")),w(u,d);for(let t=l.length-2;t>=0;t--){const a=l[t],i=t>0?l[t-1]:s;if(!await ko(n,a,i,e))return!1;w(a,i)}if(e&&e.info("-----------------------------------------------------"),o[12]&&o[13]&&o[14]&&o[15]){let t;if(t=await b("G1",2,12,"tauG1",e),!t)return!1;if(t=await b("G2",3,13,"tauG2",e),!t)return!1;if(t=await b("G1",4,14,"alphaTauG1",e),!t)return!1;if(t=await b("G1",5,15,"betaTauG1",e),!t)return!1}else e&&e.warn(\'this file does not contain phase2 precalculated values. Please run: \\n   snarkjs "powersoftau preparephase2" to prepare this file to be used in the phase2 ceremony.\');return await i.close(),e&&e.info("Powers of Tau Ok!"),!0;function w(t,a){if(!e)return;e.info("-----------------------------------------------------"),e.info(`Contribution #${t.id}: ${t.name||""}`),e.info(Ri(t.nextChallenge,"Next Challenge: "));const i=new Uint8Array(2*n.G1.F.n8*6+2*n.G2.F.n8*3);Po(i,0,n,t.key,!1);const o=$a.exports(64);o.setPartialHash(t.partialHash),o.update(i);const c=o.digest();e.info(Ri(c,"Response Hash:")),e.info(Ri(a.nextChallenge,"Response Hash:")),1==t.type&&(e.info(`Beacon generator: ${$i(t.beaconHash)}`),e.info(`Beacon iterations Exp: ${t.numIterationsExp}`))}async function A(t,e,a,c,r,l){const s=n[e],d=2*s.F.n8;await qa(i,o,t);const u=[];let _=s.zero,f=s.zero,h=s.zero;for(let t=0;t<c;t+=65536){l&&l.debug(`points relations: ${a}: ${t}/${c} `);const e=Math.min(c-t,65536),o=await i.read(e*d),n=await s.batchLEMtoU(o);g.update(n);const p=new Uint8Array(4*(e-1));if(M.randomFillSync(p),t>0){const t=s.fromRprLEM(o,0),e=M.randomBytes(4).readUInt32BE(0,!0);_=s.add(_,s.timesScalar(h,e)),f=s.add(f,s.timesScalar(t,e))}const m=await s.multiExpAffine(o.slice(0,(e-1)*d),p),L=await s.multiExpAffine(o.slice(d),p);_=s.add(_,m),f=s.add(f,L),h=s.fromRprLEM(o,(e-1)*d);for(let a=0;a<r.length;a++){const i=r[a];if(i>=t&&i<t+e){const e=s.fromRprLEM(o,(i-t)*d);u.push(e)}}}return await Ma(i),{R1:_,R2:f,singularPoints:u}}async function b(t,e,a,r,l){l&&l.debug(`Verifying phase2 calculated values ${r}...`);const s=n[t],d=2*s.F.n8,u=new Array(8);for(let t=0;t<8;t++)u[t]=M.randomBytes(4).readUInt32BE(0,!0);for(let t=0;t<=c;t++){if(!await g(t))return!1}if(2==e){if(!await g(c+1))return!1}return!0;async function g(t){l&&l.debug(`Power ${t}...`);const g=n.Fr.n8,_=2**t;let f,h=new Uint32Array(_),p=new q(u);l&&l.debug(`Creating random numbers Powers${t}...`);for(let e=0;e<_;e++)h[e]=t==c+1&&e==_-1?0:p.nextU32();h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength),l&&l.debug(`reading points Powers${t}...`),await qa(i,o,e),f=new Pe(_*d),t==c+1?(await i.readToBuffer(f,0,(_-1)*d),f.set(n.G1.zeroAffine,(_-1)*d)):await i.readToBuffer(f,0,_*d),await Ma(i,!0);const m=await s.multiExpAffine(f,h,l,r+"_"+t);h=new Pe(_*g),p=new q(u);const L=new Uint8Array(4),w=new DataView(L.buffer);l&&l.debug(`Creating random numbers Powers${t}...`);for(let e=0;e<_;e++)e==_-1&&t==c+1||(w.setUint32(0,p.nextU32(),!0),h.set(L,e*g));l&&l.debug(`batchToMontgomery ${t}...`),h=await n.Fr.batchToMontgomery(h),l&&l.debug(`fft ${t}...`),h=await n.Fr.fft(h),l&&l.debug(`batchFromMontgomery ${t}...`),h=await n.Fr.batchFromMontgomery(h),l&&l.debug(`reading points Lagrange${t}...`),await qa(i,o,a),i.pos+=d*(2**t-1),await i.readToBuffer(f,0,_*d),await Ma(i,!0);const A=await s.multiExpAffine(f,h,l,r+"_"+t+"_transformed");return!!s.eq(m,A)||(l&&l.error("Phase2 caclutation does not match with powers of tau"),!1)}}},challengeContribute:async function(t,e,a,i,o){await $a.exports.ready();const n=await Pa(e),c=8*t.F1.n64*2,r=8*t.F2.n64*2,l=(n.totalSize+c-64-r)/(4*c+r);let s=l,d=0;for(;s>1;)s/=2,d+=1;if(2**d!=l)throw new Error("Invalid file size");o&&o.debug("Power to tau size: "+d);const u=await Ki(i),g=await Ga(a),_=$a.exports(64);for(let t=0;t<n.totalSize;t+=n.pageSize){o&&o.debug(`Hashing challenge ${t}/${n.totalSize}`);const e=Math.min(n.totalSize-t,n.pageSize),a=await n.read(e);_.update(a)}const f=await n.read(64,0);o&&o.info(Ri(f,"Claimed Previous Response Hash: "));const h=_.digest();o&&o.info(Ri(h,"Current Challenge Hash: "));const p=Bo(t,h,u);o&&["tau","alpha","beta"].forEach((e=>{o.debug(e+".g1_s: "+t.G1.toString(p[e].g1_s,16)),o.debug(e+".g1_sx: "+t.G1.toString(p[e].g1_sx,16)),o.debug(e+".g2_sp: "+t.G2.toString(p[e].g2_sp,16)),o.debug(e+".g2_spx: "+t.G2.toString(p[e].g2_spx,16)),o.debug("")}));const m=$a.exports(64);await g.write(h),m.update(h),await Do(n,g,m,t,"G1",2**d*2-1,t.Fr.one,p.tau.prvKey,"COMPRESSED","tauG1",o),await Do(n,g,m,t,"G2",2**d,t.Fr.one,p.tau.prvKey,"COMPRESSED","tauG2",o),await Do(n,g,m,t,"G1",2**d,p.alpha.prvKey,p.tau.prvKey,"COMPRESSED","alphaTauG1",o),await Do(n,g,m,t,"G1",2**d,p.beta.prvKey,p.tau.prvKey,"COMPRESSED","betaTauG1",o),await Do(n,g,m,t,"G2",1,p.beta.prvKey,p.tau.prvKey,"COMPRESSED","betaTauG2",o);const L=new Uint8Array(2*t.F1.n8*6+2*t.F2.n8*3);Po(L,0,t,p,!1),await g.write(L),m.update(L);const w=m.digest();o&&o.info(Ri(w,"Contribution Response Hash: ")),await g.close(),await n.close()},beacon:async function(t,e,a,i,o,n){const c=Hi(i);if(0==c.byteLength||2*c.byteLength!=i.length)return n&&n.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(c.length>=256)return n&&n.error("Maximum lenght of beacon hash is 255 bytes"),!1;if((o=parseInt(o))<10||o>63)return n&&n.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;await $a.exports.ready();const{fd:r,sections:l}=await Ua(t,"ptau",1),{curve:s,power:d,ceremonyPower:u}=await So(r,l);if(d!=u)return n&&n.error("This file has been reduced. You cannot contribute into a reduced file."),!1;l[12]&&n&&n.warn("Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");const g=await Oo(r,s,l),_={name:a,type:1,numIterationsExp:o,beaconHash:c};let f;f=g.length>0?g[g.length-1].nextChallenge:qo(s,d,n),_.key=Mo(s,f,c,o);const h=new $a.exports(64);h.update(f);const p=await Oa(e,"ptau",1,7);await vo(p,s,d);const m=[];let L;L=await y(2,"G1",2**d*2-1,s.Fr.e(1),_.key.tau.prvKey,"tauG1",n),_.tauG1=L[1],L=await y(3,"G2",2**d,s.Fr.e(1),_.key.tau.prvKey,"tauG2",n),_.tauG2=L[1],L=await y(4,"G1",2**d,_.key.alpha.prvKey,_.key.tau.prvKey,"alphaTauG1",n),_.alphaG1=L[0],L=await y(5,"G1",2**d,_.key.beta.prvKey,_.key.tau.prvKey,"betaTauG1",n),_.betaG1=L[0],L=await y(6,"G2",1,_.key.beta.prvKey,_.key.tau.prvKey,"betaTauG2",n),_.betaG2=L[0],_.partialHash=h.getPartialHash();const w=new Uint8Array(2*s.F1.n8*6+2*s.F2.n8*3);Po(w,0,s,_.key,!1),h.update(new Uint8Array(w));const A=h.digest();n&&n.info(Ri(A,"Contribution Response Hash imported: "));const b=new $a.exports(64);return b.update(A),await I(p,"G1",2,2**d*2-1,"tauG1",n),await I(p,"G2",3,2**d,"tauG2",n),await I(p,"G1",4,2**d,"alphaTauG1",n),await I(p,"G1",5,2**d,"betaTauG1",n),await I(p,"G2",6,1,"betaG2",n),_.nextChallenge=b.digest(),n&&n.info(Ri(_.nextChallenge,"Next Challenge Hash: ")),g.push(_),await Qo(p,s,g),await r.close(),await p.close(),A;async function y(t,e,a,i,o,n,c){const d=[];r.pos=l[t][0].p,await za(p,t),m[t]=p.pos;const u=s[e],g=2*u.F.n8,_=Math.floor((1<<20)/g);let f=i;for(let t=0;t<a;t+=_){c&&c.debug(`applying key${n}: ${t}/${a}`);const e=Math.min(a-t,_),i=await r.read(e*g),l=await u.batchApplyKey(i,f,o),m=p.write(l),L=await u.batchLEMtoC(l);if(h.update(L),await m,0==t)for(let t=0;t<Math.min(2,a);t++)d.push(u.fromRprLEM(l,t*g));f=s.Fr.mul(f,s.Fr.exp(o,e))}return await Qa(p),d}async function I(t,e,a,i,o,n){const c=s[e],r=2*c.F.n8,l=Math.floor((1<<24)/r),d=t.pos;t.pos=m[a];for(let e=0;e<i;e+=l){n&&n.debug(`Hashing ${o}: ${e}/${i}`);const a=Math.min(i-e,l),s=await t.read(a*r),d=await c.batchLEMtoU(s);b.update(d)}t.pos=d}},contribute:async function(t,e,a,i,o){await $a.exports.ready();const{fd:n,sections:c}=await Ua(t,"ptau",1),{curve:r,power:l,ceremonyPower:s}=await So(n,c);if(l!=s)throw o&&o.error("This file has been reduced. You cannot contribute into a reduced file."),new Error("This file has been reduced. You cannot contribute into a reduced file.");c[12]&&o&&o.warn("WARNING: Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");const d=await Oo(n,r,c),u={name:a,type:0};let g;const _=await Ki(i);g=d.length>0?d[d.length-1].nextChallenge:qo(r,l,o),u.key=Bo(r,g,_);const f=new $a.exports(64);f.update(g);const h=await Oa(e,"ptau",1,7);await vo(h,r,l);const p=[];let m;m=await b(2,"G1",2**l*2-1,r.Fr.e(1),u.key.tau.prvKey,"tauG1"),u.tauG1=m[1],m=await b(3,"G2",2**l,r.Fr.e(1),u.key.tau.prvKey,"tauG2"),u.tauG2=m[1],m=await b(4,"G1",2**l,u.key.alpha.prvKey,u.key.tau.prvKey,"alphaTauG1"),u.alphaG1=m[0],m=await b(5,"G1",2**l,u.key.beta.prvKey,u.key.tau.prvKey,"betaTauG1"),u.betaG1=m[0],m=await b(6,"G2",1,u.key.beta.prvKey,u.key.tau.prvKey,"betaTauG2"),u.betaG2=m[0],u.partialHash=f.getPartialHash();const L=new Uint8Array(2*r.F1.n8*6+2*r.F2.n8*3);Po(L,0,r,u.key,!1),f.update(new Uint8Array(L));const w=f.digest();o&&o.info(Ri(w,"Contribution Response Hash imported: "));const A=new $a.exports(64);return A.update(w),await y(h,"G1",2,2**l*2-1,"tauG1"),await y(h,"G2",3,2**l,"tauG2"),await y(h,"G1",4,2**l,"alphaTauG1"),await y(h,"G1",5,2**l,"betaTauG1"),await y(h,"G2",6,1,"betaG2"),u.nextChallenge=A.digest(),o&&o.info(Ri(u.nextChallenge,"Next Challenge Hash: ")),d.push(u),await Qo(h,r,d),await n.close(),await h.close(),w;async function b(t,e,a,i,l,s){const d=[];n.pos=c[t][0].p,await za(h,t),p[t]=h.pos;const u=r[e],g=2*u.F.n8,_=Math.floor((1<<20)/g);let m=i;for(let t=0;t<a;t+=_){o&&o.debug(`processing: ${s}: ${t}/${a}`);const e=Math.min(a-t,_),i=await n.read(e*g),c=await u.batchApplyKey(i,m,l),p=h.write(c),L=await u.batchLEMtoC(c);if(f.update(L),await p,0==t)for(let t=0;t<Math.min(2,a);t++)d.push(u.fromRprLEM(c,t*g));m=r.Fr.mul(m,r.Fr.exp(l,e))}return await Qa(h),d}async function y(t,e,a,i,n){const c=r[e],l=2*c.F.n8,s=Math.floor((1<<24)/l),d=t.pos;t.pos=p[a];for(let e=0;e<i;e+=s){o&&e&&o.debug(`Hashing ${n}: `+e);const a=Math.min(i-e,s),r=await t.read(a*l),d=await c.batchLEMtoU(r);A.update(d)}t.pos=d}},preparePhase2:async function(t,e,a){const{fd:i,sections:o}=await Ua(t,"ptau",1),{curve:n,power:c}=await So(i,o),r=await Oa(e,"ptau",1,11);return await vo(r,n,c),await Ra(i,o,r,2),await Ra(i,o,r,3),await Ra(i,o,r,4),await Ra(i,o,r,5),await Ra(i,o,r,6),await Ra(i,o,r,7),await l(2,12,"G1","tauG1"),await l(3,13,"G2","tauG2"),await l(4,14,"G1","alphaTauG1"),await l(5,15,"G1","betaTauG1"),await i.close(),void await r.close();async function l(t,e,l,s){a&&a.debug("Starting section: "+s),await za(r,e);for(let t=0;t<=c;t++)await d(t);async function d(e){const d=2**e,u=n[l];n.Fr;const g=2*u.F.n8;let _;u.F.n8,_=new Pe(d*g),await qa(i,o,t),2==t&&e==c+1?(await i.readToBuffer(_,0,(d-1)*g),_.set(n.G1.zeroAffine,(d-1)*g)):await i.readToBuffer(_,0,d*g),await Ma(i,!0),_=await u.lagrangeEvaluations(_,"affine","affine",a,s),await r.write(_)}2==t&&await d(c+1),await Qa(r)}},truncate:async function(t,e,a){const{fd:i,sections:o}=await Ua(t,"ptau",1),{curve:n,power:c,ceremonyPower:r}=await So(i,o),l=2*n.G1.F.n8,s=2*n.G2.F.n8;for(let t=1;t<c;t++)await d(t);return await i.close(),!0;async function d(t){let c=t.toString();for(;c.length<2;)c="0"+c;a&&a.debug("Writing Power: "+c);const d=await Oa(e+c+".ptau","ptau",1,11);await vo(d,n,t,r),await Ra(i,o,d,2,(2**t*2-1)*l),await Ra(i,o,d,3,2**t*s),await Ra(i,o,d,4,2**t*l),await Ra(i,o,d,5,2**t*l),await Ra(i,o,d,6,s),await Ra(i,o,d,7),await Ra(i,o,d,12,(2**(t+1)*2-1)*l),await Ra(i,o,d,13,(2**t*2-1)*s),await Ra(i,o,d,14,(2**t*2-1)*l),await Ra(i,o,d,15,(2**t*2-1)*l),await d.close()}},convert:async function(t,e,a){const{fd:i,sections:o}=await Ua(t,"ptau",1),{curve:n,power:c}=await So(i,o),r=await Oa(e,"ptau",1,11);return await vo(r,n,c),await Ra(i,o,r,2),await Ra(i,o,r,3),await Ra(i,o,r,4),await Ra(i,o,r,5),await Ra(i,o,r,6),await Ra(i,o,r,7),await async function(t,e,l,s){a&&a.debug("Starting section: "+s);await za(r,e);const d=o[e][0].size,u=i.pageSize;await qa(i,o,e);for(let t=0;t<d;t+=u){const e=Math.min(d-t,u),a=await i.read(e);await r.write(a)}await Ma(i),2==t&&await async function(e){const d=2**e,u=n[l],g=2*u.F.n8;let _;_=new Pe(d*g),await qa(i,o,t),2==t&&e==c+1?(await i.readToBuffer(_,0,(d-1)*g),_.set(n.G1.zeroAffine,(d-1)*g)):await i.readToBuffer(_,0,d*g);await Ma(i,!0),_=await u.lagrangeEvaluations(_,"affine","affine",a,s),await r.write(_)}(c+1);await Qa(r)}(2,12,"G1","tauG1"),await Ra(i,o,r,13),await Ra(i,o,r,14),await Ra(i,o,r,15),await i.close(),void await r.close()},exportJson:async function(t,e){const{fd:a,sections:i}=await Ua(t,"ptau",1),{curve:o,power:n}=await So(a,i),c={};return c.q=o.q,c.power=n,c.contributions=await Oo(a,o,i),c.tauG1=await r(2,"G1",2**n*2-1,"tauG1"),c.tauG2=await r(3,"G2",2**n,"tauG2"),c.alphaTauG1=await r(4,"G1",2**n,"alphaTauG1"),c.betaTauG1=await r(5,"G1",2**n,"betaTauG1"),c.betaG2=await r(6,"G2",1,"betaG2"),c.lTauG1=await l(12,"G1","lTauG1"),c.lTauG2=await l(13,"G2","lTauG2"),c.lAlphaTauG1=await l(14,"G1","lAlphaTauG2"),c.lBetaTauG1=await l(15,"G1","lBetaTauG2"),await a.close(),Yi(o.Fr,c);async function r(t,n,c,r){const l=o[n],s=2*l.F.n8,d=[];await qa(a,i,t);for(let t=0;t<c;t++){e&&t&&t%1e4==0&&console.log(`${r}: `+t);const i=await a.read(s);d.push(l.fromRprLEM(i,0))}return await Ma(a),d}async function l(t,c,r){const l=o[c],s=2*l.F.n8,d=[];await qa(a,i,t);for(let t=0;t<=n;t++){e&&console.log(`${r}: Power: ${t}`),d[t]=[];const i=2**t;for(let o=0;o<i;o++){e&&o&&o%1e4==0&&console.log(`${r}: ${o}/${i}`);const n=await a.read(s);d[t].push(l.fromRprLEM(n,0))}}return await Ma(a,!0),d}}});const Vo=262144,Ko={get:function(t,e){return isNaN(e)?t[e]:t.getElement(e)},set:function(t,e,a){return isNaN(e)?(t[e]=a,!0):t.setElement(e,a)}};class jo{constructor(t){this.length=t||0,this.arr=new Array(Vo);for(let e=0;e<t;e+=Vo)this.arr[e/Vo]=new Array(Math.min(Vo,t-e));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,e){const a=new Array(e-t);for(let i=t;i<e;i++)a[i-t]=this.getElement(i);return a}getElement(t){t=parseInt(t);const e=Math.floor(t/Vo),a=t%Vo;return this.arr[e]?this.arr[e][a]:void 0}setElement(t,e){t=parseInt(t);const a=Math.floor(t/Vo);this.arr[a]||(this.arr[a]=new Array(Vo));const i=t%Vo;return this.arr[a][i]=e,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new Ho;for(let e=0;e<this.arr.length;e++)if(this.arr[e])for(let a=0;a<this.arr[e].length;a++)void 0!==this.arr[e][a]&&t.push(e*Vo+a);return t}}class Ho{constructor(t){const e=new jo(t);return new Proxy(e,Ko)}}async function $o(t,e,a){let i;i="object"==typeof a?a:void 0===a?{singleThread:!1}:{singleThread:a};const o={};if(await qa(t,e,1),o.n8=await t.readULE32(),o.prime=await ka(t,o.n8),i.F){if(i.F.p!=o.prime)throw new Error("Different Prime");o.F=i.F}else if(i.getFieldFromPrime)o.F=await i.getFieldFromPrime(o.prime,i.singleThread);else if(i.getCurveFromPrime)o.curve=await i.getCurveFromPrime(o.prime,i.singleThread),o.F=o.curve.Fr;else try{o.curve=await async function(t,e,a){let i;if(b(t,fa))i=await ua(e,a);else{if(!b(t,_a))throw new Error(`Curve not supported: ${v(t)}`);i=await ga(e,a)}return i}(o.prime,i.singleThread),o.F=o.curve.Fr}catch(t){o.F=new K(o.prime)}return o.nVars=await t.readULE32(),o.nOutputs=await t.readULE32(),o.nPubInputs=await t.readULE32(),o.nPrvInputs=await t.readULE32(),o.nLabels=await t.readULE64(),o.nConstraints=await t.readULE32(),o.useCustomGates=void 0!==e[4]&&null!==e[4]&&void 0!==e[5]&&null!==e[5],await Ma(t),o}async function Yo(t,e,a){if("object"!=typeof a)throw new Error("readR1csFd: options must be an object");a.loadConstraints=a.loadConstraints||!0,a.loadMap=a.loadMap||!1,a.loadCustomGates=a.loadCustomGates||!0;const i=await $o(t,e,a);return a.loadConstraints&&(i.constraints=await async function(t,e,a,i,o){let n;n="object"==typeof i?i:void 0===i?{}:{logger:i,loggerCtx:o};const c=await Da(t,e,2);let r,l=0;r=a.nConstraints>1<<20?new Ho:[];for(let t=0;t<a.nConstraints;t++){n.logger&&t%1e5==0&&n.logger.info(`${n.loggerCtx}: Loading constraints: ${t}/${a.nConstraints}`);const e=s();r.push(e)}return r;function s(){const t=[];return t[0]=d(),t[1]=d(),t[2]=d(),t}function d(){const t={},e=c.slice(l,l+4);l+=4;const i=new DataView(e.buffer).getUint32(0,!0),o=c.slice(l,l+(4+a.n8)*i);l+=(4+a.n8)*i;const n=new DataView(o.buffer);for(let e=0;e<i;e++){const i=n.getUint32(e*(4+a.n8),!0),c=a.F.fromRprLE(o,e*(4+a.n8)+4);t[i]=c}return t}}(t,e,i,a)),a.loadMap&&(i.map=await async function(t,e,a,i,o){let n;n="object"==typeof i?i:void 0===i?{}:{logger:i,loggerCtx:o};const c=await Da(t,e,3);let r,l=0;r=a.nVars>1<<20?new Ho:[];for(let t=0;t<a.nVars;t++){n.logger&&t%1e4==0&&n.logger.info(`${n.loggerCtx}: Loading map: ${t}/${a.nVars}`);const e=s();r.push(e)}return r;function s(){const t=c.slice(l,l+8);l+=8;const e=new DataView(t.buffer),a=e.getUint32(0,!0);return 4294967296*e.getUint32(4,!0)+a}}(t,e,i,a)),a.loadCustomGates&&(i.useCustomGates?(i.customGates=await async function(t,e,a){await qa(t,e,4);let i=await t.readULE32(),o=[];for(let e=0;e<i;e++){let e={};e.templateName=await t.readString();let i=await t.readULE32();e.parameters=Array(i);let n=await t.read(a*i);for(let t=0;t<i;t++)e.parameters[t]=n.slice(t*a,t*a+a);o.push(e)}return await Ma(t),o}(t,e,i.F.n8),i.customGatesUses=await async function(t,e,a){const i=await Da(t,e,5),o=new Uint32Array(i.buffer,i.byteOffset,i.byteLength/4),n=o[0];let c,r=1;c=n>1<<20?new Ho:[];for(let t=0;t<n;t++){a.logger&&t%1e5==0&&a.logger.info(`${a.loggerCtx}: Loading custom gate uses: ${t}/${n}`);let e={};e.id=o[r++];let i=o[r++];e.signals=[];for(let t=0;t<i;t++){const t=o[r++],a=o[r++];e.signals.push(4294967296*a+t)}c.push(e)}return c}(t,e,a)):(i.customGates=[],i.customGatesUses=[])),i}async function Wo(t,e,a,i,o,n){let c;c="object"==typeof e?e:void 0===e?{loadConstraints:!0,loadMap:!1,loadCustomGates:!0}:{loadConstraints:e,loadMap:a,singleThread:i,logger:o,loggerCtx:n};const{fd:r,sections:l}=await Ua(t,"r1cs",1),s=await Yo(r,l,c);return await r.close(),s}const Zo=ha.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),Jo=ha.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");var Xo=Object.freeze({__proto__:null,print:function(t,e,a){for(let e=0;e<t.constraints.length;e++)i(t.constraints[e]);function i(i){const o=a=>{let i="";return Object.keys(a).forEach((o=>{let n=e.varIdx2Name[o];"one"==n&&(n="");let c=t.curve.Fr.toString(a[o]);"1"==c&&(c=""),"-1"==c&&(c="-"),""!=i&&"-"!=c[0]&&(c="+"+c),""!=i&&(c=" "+c),i=i+c+n})),i},n=`[ ${o(i[0])} ] * [ ${o(i[1])} ] - [ ${o(i[2])} ] = 0`;a&&a.info(n)}},info:async function(t,e){const a=await Wo(t);return ha.eq(a.prime,Jo)?e&&e.info("Curve: bn-128"):ha.eq(a.prime,Zo)?e&&e.info("Curve: bls12-381"):e&&e.info(`Unknown Curve. Prime: ${ha.toString(a.prime)}`),e&&e.info(`# of Wires: ${a.nVars}`),e&&e.info(`# of Constraints: ${a.nConstraints}`),e&&e.info(`# of Private Inputs: ${a.nPrvInputs}`),e&&e.info(`# of Public Inputs: ${a.nPubInputs}`),e&&e.info(`# of Labels: ${a.nLabels}`),e&&e.info(`# of Outputs: ${a.nOutputs}`),a},exportJson:async function(t,e){const a=await Wo(t,!0,!0,!0,e),i=a.curve.Fr;return delete a.curve,delete a.F,Yi(i,a)}});async function tn(t){const e={labelIdx2Name:["one"],varIdx2Name:["one"],componentIdx2Name:[]},a=await Pa(t),i=await a.read(a.totalSize),o=new TextDecoder("utf-8").decode(i).split("\\n");for(let t=0;t<o.length;t++){const a=o[t].split(",");4==a.length&&(e.varIdx2Name[a[1]]?e.varIdx2Name[a[1]]+="|"+a[3]:e.varIdx2Name[a[1]]=a[3],e.labelIdx2Name[a[0]]=a[3],e.componentIdx2Name[a[2]]||(e.componentIdx2Name[a[2]]=n(a[3])))}return await a.close(),e;function n(t){const e=t.split(".");return e.pop(),e.join(".")}}const{unstringifyBigInts:en}=pa;var an=Object.freeze({__proto__:null,calculate:wo,debug:async function(t,e,a,i,o,n){const c=en(t),r=await Pa(e),l=await r.read(r.totalSize);await r.close();let s={sanityCheck:!0},d=await tn(i);o.set&&(d||(d=await tn(i)),s.logSetSignal=function(t,e){n&&n.info("SET "+d.labelIdx2Name[t]+" <-- "+e.toString())}),o.get&&(d||(d=await tn(i)),s.logGetSignal=function(t,e){n&&n.info("GET "+d.labelIdx2Name[t]+" --\\x3e "+e.toString())}),o.trigger&&(d||(d=await tn(i)),s.logStartComponent=function(t){n&&n.info("START: "+d.componentIdx2Name[t])},s.logFinishComponent=function(t){n&&n.info("FINISH: "+d.componentIdx2Name[t])}),s.sym=d;const u=await ho(l,s),g=await u.calculateWitness(c),_=await Oa(a,"wtns",2,2);await async function(t,e,a){await za(t,1);const i=8*(Math.floor((ha.bitLength(a)-1)/64)+1);await t.writeULE32(i),await Ta(t,a,i),await t.writeULE32(e.length),await Qa(t),await za(t,2);for(let a=0;a<e.length;a++)await Ta(t,e[a],i);await Qa(t)}(_,g,u.prime),await _.close()},exportJson:async function(t){return await async function(t){const{fd:e,sections:a}=await Ua(t,"wtns",2),{n8:i,nWitness:o}=await lo(e,a);await qa(e,a,2);const n=[];for(let t=0;t<o;t++){const t=await ka(e,i);n.push(t)}return await Ma(e),await e.close(),n}(t)}});const on=262144,nn={get:function(t,e){return isNaN(e)?t[e]:t.getElement(e)},set:function(t,e,a){return isNaN(e)?(t[e]=a,!0):t.setElement(e,a)}};class cn{constructor(t){this.length=t||0,this.arr=new Array(on);for(let e=0;e<t;e+=on)this.arr[e/on]=new Array(Math.min(on,t-e));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,e){const a=new Array(e-t);for(let i=t;i<e;i++)a[i-t]=this.getElement(i);return a}getElement(t){t=parseInt(t);const e=Math.floor(t/on),a=t%on;return this.arr[e]?this.arr[e][a]:void 0}setElement(t,e){t=parseInt(t);const a=Math.floor(t/on);this.arr[a]||(this.arr[a]=new Array(on));const i=t%on;return this.arr[a][i]=e,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new rn;for(let e=0;e<this.arr.length;e++)if(this.arr[e])for(let a=0;a<this.arr[e].length;a++)void 0!==this.arr[e][a]&&t.push(e*on+a);return t}}class rn{constructor(t){const e=new cn(t);return new Proxy(e,nn)}}async function ln(t,e,a,i){await $a.exports.ready();const o=$a.exports(64),{fd:n,sections:c}=await Ua(e,"ptau",1),{curve:r,power:l}=await So(n,c),{fd:s,sections:d}=await Ua(t,"r1cs",1),u=await $o(s,d,!1),g=await Oa(a,"zkey",1,10,1<<22,1<<24),_=2*r.G1.F.n8,f=2*r.G2.F.n8;if(u.prime!=r.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;const h=ki(u.nConstraints+u.nPubInputs+u.nOutputs+1-1)+1;if(h>l)return i&&i.error(`circuit too big for this power of tau ceremony. ${u.nConstraints}*2 > 2**${l}`),-1;if(!c[12])return i&&i.error("Powers of tau is not prepared."),-1;const p=u.nOutputs+u.nPubInputs,m=2**h;await za(g,1),await g.writeULE32(1),await Qa(g),await za(g,2);const L=r.q,w=8*(Math.floor((ha.bitLength(L)-1)/64)+1),A=r.r,b=8*(Math.floor((ha.bitLength(A)-1)/64)+1),y=ha.mod(ha.shl(1,8*b),A),I=r.Fr.e(ha.mod(ha.mul(y,y),A));let C,F,x;await g.writeULE32(w),await Ta(g,L,w),await g.writeULE32(b),await Ta(g,A,b),await g.writeULE32(u.nVars),await g.writeULE32(p),await g.writeULE32(m),C=await n.read(_,c[4][0].p),await g.write(C),C=await r.G1.batchLEMtoU(C),o.update(C),F=await n.read(_,c[5][0].p),await g.write(F),F=await r.G1.batchLEMtoU(F),o.update(F),x=await n.read(f,c[6][0].p),await g.write(x),x=await r.G2.batchLEMtoU(x),o.update(x);const E=new Uint8Array(_);r.G1.toRprLEM(E,0,r.G1.g);const B=new Uint8Array(f);r.G2.toRprLEM(B,0,r.G2.g);const v=new Uint8Array(_);r.G1.toRprUncompressed(v,0,r.G1.g);const S=new Uint8Array(f);r.G2.toRprUncompressed(S,0,r.G2.g),await g.write(B),await g.write(E),await g.write(B),o.update(S),o.update(v),o.update(S),await Qa(g),i&&i.info("Reading r1cs");let G=await Da(s,d,2);const P=new rn(u.nVars),U=new rn(u.nVars),O=new rn(u.nVars),z=new rn(u.nVars-p-1),Q=new Array(p+1);i&&i.info("Reading tauG1");let q=await Da(n,c,12,(m-1)*_,m*_);i&&i.info("Reading tauG2");let M=await Da(n,c,13,(m-1)*f,m*f);i&&i.info("Reading alphatauG1");let T=await Da(n,c,14,(m-1)*_,m*_);i&&i.info("Reading betatauG1");let k=await Da(n,c,15,(m-1)*_,m*_);await async function(){const t=new Uint8Array(12+r.Fr.n8),e=new DataView(t.buffer),a=new Uint8Array(r.Fr.n8);r.Fr.toRprLE(a,0,r.Fr.e(1));let o=0;function n(){const t=G.slice(o,o+4);o+=4;return new DataView(t.buffer).getUint32(0,!0)}const c=new rn;for(let t=0;t<u.nConstraints;t++){i&&t%1e4==0&&i.debug(`processing constraints: ${t}/${u.nConstraints}`);const e=n();for(let a=0;a<e;a++){const e=n(),a=o;o+=r.Fr.n8;const i=0,l=_*t,s=3,d=_*t;void 0===P[e]&&(P[e]=[]),P[e].push([i,l,a]),e<=p?(void 0===Q[e]&&(Q[e]=[]),Q[e].push([s,d,a])):(void 0===z[e-p-1]&&(z[e-p-1]=[]),z[e-p-1].push([s,d,a])),c.push([0,t,e,a])}const a=n();for(let e=0;e<a;e++){const e=n(),a=o;o+=r.Fr.n8;const i=0,l=_*t,s=1,d=f*t,u=2,g=_*t;void 0===U[e]&&(U[e]=[]),U[e].push([i,l,a]),void 0===O[e]&&(O[e]=[]),O[e].push([s,d,a]),e<=p?(void 0===Q[e]&&(Q[e]=[]),Q[e].push([u,g,a])):(void 0===z[e-p-1]&&(z[e-p-1]=[]),z[e-p-1].push([u,g,a])),c.push([1,t,e,a])}const l=n();for(let e=0;e<l;e++){const e=n(),a=o;o+=r.Fr.n8;const i=0,c=_*t;e<=p?(void 0===Q[e]&&(Q[e]=[]),Q[e].push([i,c,a])):(void 0===z[e-p-1]&&(z[e-p-1]=[]),z[e-p-1].push([i,c,a]))}}for(let t=0;t<=p;t++){const e=0,a=_*(u.nConstraints+t),i=3,o=_*(u.nConstraints+t);void 0===P[t]&&(P[t]=[]),P[t].push([e,a,-1]),void 0===Q[t]&&(Q[t]=[]),Q[t].push([i,o,-1]),c.push([0,u.nConstraints+t,t,-1])}await za(g,4);const l=new Pe(c.length*(12+r.Fr.n8)+4),s=new Uint8Array(4);new DataView(s.buffer).setUint32(0,c.length,!0),l.set(s);let d=4;for(let t=0;t<c.length;t++)i&&t%1e5==0&&i.debug(`writing coeffs: ${t}/${c.length}`),h(c[t]);function h(i){let o;e.setUint32(0,i[0],!0),e.setUint32(4,i[1],!0),e.setUint32(8,i[2],!0),o=i[3]>=0?r.Fr.fromRprLE(G.slice(i[3],i[3]+r.Fr.n8),0):r.Fr.fromRprLE(a,0);const n=r.Fr.mul(o,I);r.Fr.toRprLE(t,12,n),l.set(t,d),d+=t.length}await g.write(l),await Qa(g)}(),await D(3,"G1",Q,"IC"),await async function(){await za(g,9);const t=new Pe(m*_);if(h<r.Fr.s){let e=await Da(n,c,12,(2*m-1)*_,2*m*_);for(let a=0;a<m;a++){i&&a%1e4==0&&i.debug(`spliting buffer: ${a}/${m}`);const o=e.slice((2*a+1)*_,(2*a+1)*_+_);t.set(o,a*_)}}else{if(h!=r.Fr.s)throw i&&i.error("Circuit too big"),new Error("Circuit too big for this curve");{const e=c[12][0].p+(2**(h+1)-1)*_;await n.readToBuffer(t,0,m*_,e+m*_)}}await g.write(t),await Qa(g)}(),await async function(){j(m-1);for(let t=0;t<m-1;t+=16384){i&&i.debug(`HashingHPoints: ${t}/${m}`);const e=Math.min(m-1,16384);await V(t,e)}}(),await D(8,"G1",z,"C"),await D(5,"G1",P,"A"),await D(6,"G1",U,"B1"),await D(7,"G2",O,"B2");const R=o.digest();return await za(g,10),await g.write(R),await g.writeULE32(0),await Qa(g),i&&i.info(Ri(R,"Circuit hash: ")),await g.close(),await s.close(),await n.close(),R;async function D(t,e,a,n){const c=r[e];j(a.length),await za(g,t);let l=[],s=0;for(;s<a.length;){let t=0;for(;s<a.length&&t<r.tm.concurrency;){i&&i.debug(`Writing points start ${n}: ${s}/${a.length}`);let o=1,c=a[s]?a[s].length:0;for(;s+o<a.length&&c+(a[s+o]?a[s+o].length:0)<32768&&o<32768;)c+=a[s+o]?a[s+o].length:0,o++;const r=a.slice(s,s+o),d=s;l.push(N(e,r,i,n).then((t=>(i&&i.debug(`Writing points end ${n}: ${d}/${a.length}`),t)))),s+=o,t++}const d=await Promise.all(l);for(let t=0;t<d.length;t++){await g.write(d[t][0]);const e=await c.batchLEMtoU(d[t][0]);o.update(e)}l=[]}await Qa(g)}async function N(t,e,a,i){const o=r[t],n=2*o.F.n8,c=3*o.F.n8,l=2*o.F.n8;let s,d,u,g;if("G1"==t)s="g1m_timesScalarAffine",d="g1m_multiexpAffine",u="g1m_batchToAffine",g="g1m_zero";else{if("G2"!=t)throw new Error("Invalid group");s="g2m_timesScalarAffine",d="g2m_multiexpAffine",u="g2m_batchToAffine",g="g2m_zero"}let _,f,h=0;for(let t=0;t<e.length;t++)h+=e[t]?e[t].length:0;h>32768?(_=new Pe(h*n),f=new Pe(h*r.Fr.n8)):(_=new Uint8Array(h*n),f=new Uint8Array(h*r.Fr.n8));let p=0,m=0;const L=[q,M,T,k],w=new Uint8Array(r.Fr.n8);r.Fr.toRprLE(w,0,r.Fr.e(1));let A=0;for(let t=0;t<e.length;t++)if(e[t])for(let o=0;o<e[t].length;o++)a&&o&&o%1e4==0&&a.debug(`Configuring big array ${i}: ${o}/${e[t].length}`),_.set(L[e[t][o][0]].slice(e[t][o][1],e[t][o][1]+n),A*n),e[t][o][2]>=0?f.set(G.slice(e[t][o][2],e[t][o][2]+r.Fr.n8),A*r.Fr.n8):f.set(w,A*r.Fr.n8),A++;if(e.length>1){const t=[];t.push({cmd:"ALLOCSET",var:0,buff:_}),t.push({cmd:"ALLOCSET",var:1,buff:f}),t.push({cmd:"ALLOC",var:2,len:e.length*c}),p=0,m=0;let a=0;for(let i=0;i<e.length;i++)e[i]?(1==e[i].length?t.push({cmd:"CALL",fnName:s,params:[{var:0,offset:p},{var:1,offset:m},{val:r.Fr.n8},{var:2,offset:a}]}):t.push({cmd:"CALL",fnName:d,params:[{var:0,offset:p},{var:1,offset:m},{val:r.Fr.n8},{val:e[i].length},{var:2,offset:a}]}),p+=n*e[i].length,m+=r.Fr.n8*e[i].length,a+=c):(t.push({cmd:"CALL",fnName:g,params:[{var:2,offset:a}]}),a+=c);t.push({cmd:"CALL",fnName:u,params:[{var:2},{val:e.length},{var:2}]}),t.push({cmd:"GET",out:0,var:2,len:e.length*l});return await r.tm.queueAction(t)}{let t=await o.multiExpAffine(_,f,a,i);return t=[o.toAffine(t)],t}}async function V(t,e){const a=await n.read(e*_,c[2][0].p+(t+m)*_),i=await n.read(e*_,c[2][0].p+t*_),l=r.tm.concurrency,s=Math.floor(e/l),d=[];for(let t=0;t<l;t++){let o;if(o=t<l-1?s:e-t*s,0==o)continue;const n=a.slice(t*s*_,(t*s+o)*_),c=i.slice(t*s*_,(t*s+o)*_);d.push(K(n,c))}const u=await Promise.all(d);for(let t=0;t<u.length;t++)o.update(u[t][0])}async function K(t,e){const a=t.byteLength/_,i=3*r.G1.F.n8,o=[];o.push({cmd:"ALLOCSET",var:0,buff:t}),o.push({cmd:"ALLOCSET",var:1,buff:e}),o.push({cmd:"ALLOC",var:2,len:a*i});for(let t=0;t<a;t++)o.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:t*_},{var:1,offset:t*_},{var:2,offset:t*i}]});o.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:a},{var:2}]}),o.push({cmd:"CALL",fnName:"g1m_batchLEMtoU",params:[{var:2},{val:a},{var:2}]}),o.push({cmd:"GET",out:0,var:2,len:a*_});return await r.tm.queueAction(o)}function j(t){const e=new Uint8Array(4);new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(0,t,!1),o.update(e)}}const sn=Vi;async function dn(t,e,a,i){let o;await $a.exports.ready();const{fd:n,sections:c}=await Ua(a,"zkey",2),r=await eo(n,c,!1);if("groth16"!=r.protocol)throw new Error("zkey file is not groth16");const l=await ja(r.q),s=2*l.G1.F.n8,d=await io(n,l,c),u=$a.exports(64);u.update(d.csHash);let g=l.G1.g;for(let t=0;t<d.contributions.length;t++){const e=d.contributions[t],a=Ni(u);if(co(a,l,e.delta.g1_s),co(a,l,e.delta.g1_sx),!Di(a.digest(),e.transcript))return console.log(`INVALID(${t}): Inconsistent transcript `),!1;const i=Fo(l,e.transcript);if(o=await sn(l,e.delta.g1_s,e.delta.g1_sx,i,e.delta.g2_spx),!0!==o)return console.log(`INVALID(${t}): public key G1 and G2 do not have the same ration `),!1;if(o=await sn(l,g,e.deltaAfter,i,e.delta.g2_spx),!0!==o)return console.log(`INVALID(${t}): deltaAfter does not fillow the public key `),!1;if(1==e.type){const a=ji(e.beaconHash,e.numIterationsExp),i=l.Fr.fromRng(a),o=l.G1.toAffine(l.G1.fromRng(a)),n=l.G1.toAffine(l.G1.timesFr(o,i));if(!0!==l.G1.eq(o,e.delta.g1_s))return console.log(`INVALID(${t}): Key of the beacon does not match. g1_s `),!1;if(!0!==l.G1.eq(n,e.delta.g1_sx))return console.log(`INVALID(${t}): Key of the beacon does not match. g1_sx `),!1}ro(u,l,e);const n=$a.exports(64);ro(n,l,e),e.contributionHash=n.digest(),g=e.deltaAfter}const{fd:_,sections:f}=await Ua(t,"zkey",2),h=await eo(_,f,!1);if("groth16"!=h.protocol)throw new Error("zkeyinit file is not groth16");if(!ha.eq(h.q,r.q)||!ha.eq(h.r,r.r)||h.n8q!=r.n8q||h.n8r!=r.n8r)return i&&i.error("INVALID:  Different curves"),!1;if(h.nVars!=r.nVars||h.nPublic!=r.nPublic||h.domainSize!=r.domainSize)return i&&i.error("INVALID:  Different circuit parameters"),!1;if(!l.G1.eq(r.vk_alpha_1,h.vk_alpha_1))return i&&i.error("INVALID:  Invalid alpha1"),!1;if(!l.G1.eq(r.vk_beta_1,h.vk_beta_1))return i&&i.error("INVALID:  Invalid beta1"),!1;if(!l.G2.eq(r.vk_beta_2,h.vk_beta_2))return i&&i.error("INVALID:  Invalid beta2"),!1;if(!l.G2.eq(r.vk_gamma_2,h.vk_gamma_2))return i&&i.error("INVALID:  Invalid gamma2"),!1;if(!l.G1.eq(r.vk_delta_1,g))return i&&i.error("INVALID:  Invalid delta1"),!1;if(o=await sn(l,l.G1.g,g,l.G2.g,r.vk_delta_2),!0!==o)return i&&i.error("INVALID:  Invalid delta2"),!1;const p=await io(_,l,f);if(!Di(d.csHash,p.csHash))return i&&i.error("INVALID:  Circuit does not match"),!1;if(c[8][0].size!=s*(r.nVars-r.nPublic-1))return i&&i.error("INVALID:  Invalid L section size"),!1;if(c[9][0].size!=s*r.domainSize)return i&&i.error("INVALID:  Invalid H section size"),!1;let m;if(m=await Na(n,c,_,f,3),!m)return i&&i.error("INVALID:  IC section is not identical"),!1;if(m=await Na(n,c,_,f,4),!m)return i&&i.error("Coeffs section is not identical"),!1;if(m=await Na(n,c,_,f,5),!m)return i&&i.error("A section is not identical"),!1;if(m=await Na(n,c,_,f,6),!m)return i&&i.error("B1 section is not identical"),!1;if(m=await Na(n,c,_,f,7),!m)return i&&i.error("B2 section is not identical"),!1;if(o=await async function(t,e,a,n,c,r,s,d,u){const g=1<<20,_=l[t],f=2*_.F.n8;await qa(e,a,r),await qa(n,c,r);let h=_.zero,p=_.zero;const m=a[r][0].size/f;for(let t=0;t<m;t+=g){i&&i.debug(`Same ratio check ${u}:  ${t}/${m}`);const a=Math.min(m-t,g),o=await e.read(a*f),c=await n.read(a*f),r=new Uint8Array(4*a);M.randomFillSync(r);const l=await _.multiExpAffine(o,r),s=await _.multiExpAffine(c,r);h=_.add(h,l),p=_.add(p,s)}return await Ma(e),await Ma(n),0==m||(o=await sn(l,h,p,s,d),!0===o)}("G1",_,f,n,c,8,r.vk_delta_2,h.vk_delta_2,"L section"),!0!==o)return i&&i.error("L section does not match"),!1;if(o=await async function(){const t=1<<20,a=l.G1,s=l.Fr,d=2*a.F.n8,{fd:u,sections:g}=await Ua(e,"ptau",1);let _=new Pe(r.domainSize*r.n8r);const f=new Array(8);for(let t=0;t<8;t++)f[t]=M.randomBytes(4).readUInt32BE(0,!0);const p=new q(f);for(let t=0;t<r.domainSize-1;t++){const e=s.fromRng(p);s.toRprLE(_,t*r.n8r,e)}s.toRprLE(_,(r.domainSize-1)*r.n8r,s.zero);let m,w=a.zero;for(let e=0;e<r.domainSize;e+=t){i&&i.debug(`H Verificaition(tau):  ${e}/${r.domainSize}`);const o=Math.min(r.domainSize-e,t),n=await u.read(d*o,g[2][0].p+r.domainSize*d+e*d),c=await u.read(d*o,g[2][0].p+e*d),l=await L(n,c),s=_.slice(e*r.n8r,(e+o)*r.n8r),f=await a.multiExpAffine(l,s);w=a.add(w,f)}if(_=await s.batchToMontgomery(_),r.power<s.s)m=s.neg(s.e(2));else{const t=2**s.s,e=s.exp(s.shift,t);m=s.sub(e,s.one)}const A=r.power<s.s?s.w[r.power+1]:s.shift;_=await s.batchApplyKey(_,m,A),_=await s.fft(_),_=await s.batchFromMontgomery(_),await qa(n,c,9);let b=a.zero;for(let e=0;e<r.domainSize;e+=t){i&&i.debug(`H Verificaition(lagrange):  ${e}/${r.domainSize}`);const o=Math.min(r.domainSize-e,t),c=await n.read(d*o),l=_.slice(e*r.n8r,(e+o)*r.n8r),s=await a.multiExpAffine(c,l);b=a.add(b,s)}return await Ma(n),o=await sn(l,w,b,r.vk_delta_2,h.vk_delta_2),!0===o}(),!0!==o)return i&&i.error("H section does not match"),!1;i&&i.info(Ri(d.csHash,"Circuit Hash: ")),await n.close(),await _.close();for(let t=d.contributions.length-1;t>=0;t--){const e=d.contributions[t];i&&i.info("-------------------------"),i&&i.info(Ri(e.contributionHash,`contribution #${t+1} ${e.name?e.name:""}:`)),1==e.type&&(i&&i.info(`Beacon generator: ${$i(e.beaconHash)}`),i&&i.info(`Beacon iterations Exp: ${e.numIterationsExp}`))}return i&&i.info("-------------------------"),i&&i.info("ZKey Ok!"),!0;async function L(t,e){const a=2*l.G1.F.n8,i=t.byteLength/a,o=l.tm.concurrency,n=Math.floor(i/o),c=[];for(let a=0;a<o;a++){let r;if(r=a<o-1?n:i-a*n,0==r)continue;const l=t.slice(a*n*s,(a*n+r)*s),d=e.slice(a*n*s,(a*n+r)*s);c.push(w(l,d))}const r=await Promise.all(c),d=new Uint8Array(i*a);let u=0;for(let t=0;t<r.length;t++)d.set(r[t][0],u),u+=r[t][0].byteLength;return d}async function w(t,e){const a=2*l.G1.F.n8,i=3*l.G1.F.n8,o=t.byteLength/a,n=[];n.push({cmd:"ALLOCSET",var:0,buff:t}),n.push({cmd:"ALLOCSET",var:1,buff:e}),n.push({cmd:"ALLOC",var:2,len:o*i});for(let t=0;t<o;t++)n.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:t*a},{var:1,offset:t*a},{var:2,offset:t*i}]});n.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:o},{var:2}]}),n.push({cmd:"GET",out:0,var:2,len:o*a});return await l.tm.queueAction(n)}}const{stringifyBigInts:un}=pa;async function gn(t){const{fd:e,sections:a}=await Ua(t,"zkey",2),i=await eo(e,a);let o;if("groth16"==i.protocol)o=await async function(t,e,a){const i=await ja(t.q),o=2*i.G1.F.n8,n=await i.pairing(t.vk_alpha_1,t.vk_beta_2);let c={protocol:t.protocol,curve:i.name,nPublic:t.nPublic,vk_alpha_1:i.G1.toObject(t.vk_alpha_1),vk_beta_2:i.G2.toObject(t.vk_beta_2),vk_gamma_2:i.G2.toObject(t.vk_gamma_2),vk_delta_2:i.G2.toObject(t.vk_delta_2),vk_alphabeta_12:i.Gt.toObject(n)};await qa(e,a,3),c.IC=[];for(let a=0;a<=t.nPublic;a++){const t=await e.read(o),a=i.G1.toObject(t);c.IC.push(a)}return await Ma(e),c=un(c),c}(i,e,a);else{if("plonk"!=i.protocol)throw new Error("zkey file is not groth16");o=await async function(t){const e=await ja(t.q);let a={protocol:t.protocol,curve:e.name,nPublic:t.nPublic,power:t.power,k1:e.Fr.toObject(t.k1),k2:e.Fr.toObject(t.k2),Qm:e.G1.toObject(t.Qm),Ql:e.G1.toObject(t.Ql),Qr:e.G1.toObject(t.Qr),Qo:e.G1.toObject(t.Qo),Qc:e.G1.toObject(t.Qc),S1:e.G1.toObject(t.S1),S2:e.G1.toObject(t.S2),S3:e.G1.toObject(t.S3),X_2:e.G2.toObject(t.X_2),w:e.Fr.toObject(e.Fr.w[t.power])};return a=un(a),a}(i)}return await e.close(),o}var _n={};var fn=Object.freeze({__proto__:null,newZKey:ln,exportBellman:async function(t,e,a){const{fd:i,sections:o}=await Ua(t,"zkey",2),n=await eo(i,o);if("groth16"!=n.protocol)throw new Error("zkey file is not groth16");const c=await ja(n.q),r=2*c.G1.F.n8,l=2*c.G2.F.n8,s=await io(i,c,o),d=await Ga(e);let u;await L(n.vk_alpha_1),await L(n.vk_beta_1),await w(n.vk_beta_2),await w(n.vk_gamma_2),await L(n.vk_delta_1),await w(n.vk_delta_2),u=await Da(i,o,3),u=await c.G1.batchLEMtoU(u),await A("G1",u);const g=await Da(i,o,9);let _,f,h,p,m;_=await c.G1.fft(g,"affine","jacobian",a),_=await c.G1.batchApplyKey(_,c.Fr.neg(c.Fr.e(2)),c.Fr.w[n.power+1],"jacobian","affine",a),_=_.slice(0,_.byteLength-r),_=await c.G1.batchLEMtoU(_),await A("G1",_),f=await Da(i,o,8),f=await c.G1.batchLEMtoU(f),await A("G1",f),h=await Da(i,o,5),h=await c.G1.batchLEMtoU(h),await A("G1",h),p=await Da(i,o,6),p=await c.G1.batchLEMtoU(p),await A("G1",p),m=await Da(i,o,7),m=await c.G2.batchLEMtoU(m),await A("G2",m),await d.write(s.csHash),await async function(t){const e=new Uint8Array(4);new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(0,t,!1),await d.write(e)}(s.contributions.length);for(let t=0;t<s.contributions.length;t++){const e=s.contributions[t];await L(e.deltaAfter),await L(e.delta.g1_s),await L(e.delta.g1_sx),await w(e.delta.g2_spx),await d.write(e.transcript)}async function L(t){const e=new Uint8Array(r);c.G1.toRprUncompressed(e,0,t),await d.write(e)}async function w(t){const e=new Uint8Array(l);c.G2.toRprUncompressed(e,0,t),await d.write(e)}async function A(t,e){let a;a="G1"==t?r:l;const i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,e.byteLength/a,!1),await d.write(i),await d.write(e)}await i.close(),await d.close()},importBellman:async function(t,e,a,i,o){const{fd:n,sections:c}=await Ua(t,"zkey",2),r=await eo(n,c,!1);if("groth16"!=r.protocol)throw new Error("zkey file is not groth16");const l=await ja(r.q),s=2*l.G1.F.n8,d=2*l.G2.F.n8,u=await io(n,l,c),g={},_=await Pa(e);_.pos=3*s+3*d+8+s*r.nVars+4+s*(r.domainSize-1)+4+s*r.nVars+4+s*r.nVars+4+d*r.nVars,g.csHash=await _.read(64);const f=await _.readUBE32();g.contributions=[];for(let t=0;t<f;t++){const e={delta:{}};e.deltaAfter=await y(_),e.delta.g1_s=await y(_),e.delta.g1_sx=await y(_),e.delta.g2_spx=await I(_),e.transcript=await _.read(64),t<u.contributions.length&&(e.type=u.contributions[t].type,1==e.type&&(e.beaconHash=u.contributions[t].beaconHash,e.numIterationsExp=u.contributions[t].numIterationsExp),u.contributions[t].name&&(e.name=u.contributions[t].name)),g.contributions.push(e)}if(!Di(g.csHash,u.csHash))return o&&o.error("Hash of the original circuit does not match with the MPC one"),!1;if(u.contributions.length>g.contributions.length)return o&&o.error("The impoerted file does not include new contributions"),!1;for(let t=0;t<u.contributions.length;t++)if(!C(u.contributions[t],g.contributions[t]))return o&&o.error(`Previos contribution ${t} does not match`),!1;if(i)for(let t=u.contributions.length;t<g.contributions.length;t++)g.contributions[t].name=i;const h=await Oa(a,"zkey",1,10);if(_.pos=0,_.pos+=s,_.pos+=s,_.pos+=d,_.pos+=d,r.vk_delta_1=await y(_),r.vk_delta_2=await I(_),await Wi(h,r),await _.readUBE32()!=r.nPublic+1)return o&&o.error("Invalid number of points in IC"),await h.discard(),!1;if(_.pos+=s*(r.nPublic+1),await Ra(n,c,h,3),await Ra(n,c,h,4),await _.readUBE32()!=r.domainSize-1)return o&&o.error("Invalid number of points in H"),await h.discard(),!1;let p;const m=await _.read(s*(r.domainSize-1)),L=await l.G1.batchUtoLEM(m);p=new Uint8Array(r.domainSize*s),p.set(L),l.G1.toRprLEM(p,s*(r.domainSize-1),l.G1.zeroAffine);const w=l.Fr.neg(l.Fr.inv(l.Fr.e(2))),A=l.Fr.inv(l.Fr.w[r.power+1]);if(p=await l.G1.batchApplyKey(p,w,A,"affine","jacobian",o),p=await l.G1.ifft(p,"jacobian","affine",o),await za(h,9),await h.write(p),await Qa(h),await _.readUBE32()!=r.nVars-r.nPublic-1)return o&&o.error("Invalid number of points in L"),await h.discard(),!1;let b;return b=await _.read(s*(r.nVars-r.nPublic-1)),b=await l.G1.batchUtoLEM(b),await za(h,8),await h.write(b),await Qa(h),await _.readUBE32()!=r.nVars?(o&&o.error("Invalid number of points in A"),await h.discard(),!1):(_.pos+=s*r.nVars,await Ra(n,c,h,5),await _.readUBE32()!=r.nVars?(o&&o.error("Invalid number of points in B1"),await h.discard(),!1):(_.pos+=s*r.nVars,await Ra(n,c,h,6),await _.readUBE32()!=r.nVars?(o&&o.error("Invalid number of points in B2"),await h.discard(),!1):(_.pos+=d*r.nVars,await Ra(n,c,h,7),await no(h,l,g),await _.close(),await h.close(),await n.close(),!0)));async function y(t){const e=await t.read(2*l.G1.F.n8);return l.G1.fromRprUncompressed(e,0)}async function I(t){const e=await t.read(2*l.G2.F.n8);return l.G2.fromRprUncompressed(e,0)}function C(t,e){return!!l.G1.eq(t.deltaAfter,e.deltaAfter)&&(!!l.G1.eq(t.delta.g1_s,e.delta.g1_s)&&(!!l.G1.eq(t.delta.g1_sx,e.delta.g1_sx)&&(!!l.G2.eq(t.delta.g2_spx,e.delta.g2_spx)&&!!Di(t.transcript,e.transcript))))}},verifyFromR1cs:async function(t,e,a,i){const o={type:"bigMem"};return await ln(t,e,o,i),await dn(o,e,a,i)},verifyFromInit:dn,contribute:async function(t,e,a,i,o){await $a.exports.ready();const{fd:n,sections:c}=await Ua(t,"zkey",2),r=await eo(n,c);if("groth16"!=r.protocol)throw new Error("zkey file is not groth16");const l=await ja(r.q),s=await io(n,l,c),d=await Oa(e,"zkey",1,10),u=await Ki(i),g=$a.exports(64);g.update(s.csHash);for(let t=0;t<s.contributions.length;t++)ro(g,l,s.contributions[t]);const _={delta:{}};_.delta.prvKey=l.Fr.fromRng(u),_.delta.g1_s=l.G1.toAffine(l.G1.fromRng(u)),_.delta.g1_sx=l.G1.toAffine(l.G1.timesFr(_.delta.g1_s,_.delta.prvKey)),co(g,l,_.delta.g1_s),co(g,l,_.delta.g1_sx),_.transcript=g.digest(),_.delta.g2_sp=Fo(l,_.transcript),_.delta.g2_spx=l.G2.toAffine(l.G2.timesFr(_.delta.g2_sp,_.delta.prvKey)),r.vk_delta_1=l.G1.timesFr(r.vk_delta_1,_.delta.prvKey),r.vk_delta_2=l.G2.timesFr(r.vk_delta_2,_.delta.prvKey),_.deltaAfter=r.vk_delta_1,_.type=0,a&&(_.name=a),s.contributions.push(_),await Wi(d,r),await Ra(n,c,d,3),await Ra(n,c,d,4),await Ra(n,c,d,5),await Ra(n,c,d,6),await Ra(n,c,d,7);const f=l.Fr.inv(_.delta.prvKey);await Ro(n,c,d,8,l,"G1",f,l.Fr.e(1),"L Section",o),await Ro(n,c,d,9,l,"G1",f,l.Fr.e(1),"H Section",o),await no(d,l,s),await n.close(),await d.close();const h=$a.exports(64);ro(h,l,_);const p=h.digest();return o&&o.info(Ri(s.csHash,"Circuit Hash: ")),o&&o.info(Ri(p,"Contribution Hash: ")),p},beacon:async function(t,e,a,i,o,n){await $a.exports.ready();const c=Hi(i);if(0==c.byteLength||2*c.byteLength!=i.length)return n&&n.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(c.length>=256)return n&&n.error("Maximum lenght of beacon hash is 255 bytes"),!1;if((o=parseInt(o))<10||o>63)return n&&n.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;const{fd:r,sections:l}=await Ua(t,"zkey",2),s=await eo(r,l);if("groth16"!=s.protocol)throw new Error("zkey file is not groth16");const d=await ja(s.q),u=await io(r,d,l),g=await Oa(e,"zkey",1,10),_=await ji(c,o),f=$a.exports(64);f.update(u.csHash);for(let t=0;t<u.contributions.length;t++)ro(f,d,u.contributions[t]);const h={delta:{}};h.delta.prvKey=d.Fr.fromRng(_),h.delta.g1_s=d.G1.toAffine(d.G1.fromRng(_)),h.delta.g1_sx=d.G1.toAffine(d.G1.timesFr(h.delta.g1_s,h.delta.prvKey)),co(f,d,h.delta.g1_s),co(f,d,h.delta.g1_sx),h.transcript=f.digest(),h.delta.g2_sp=Fo(d,h.transcript),h.delta.g2_spx=d.G2.toAffine(d.G2.timesFr(h.delta.g2_sp,h.delta.prvKey)),s.vk_delta_1=d.G1.timesFr(s.vk_delta_1,h.delta.prvKey),s.vk_delta_2=d.G2.timesFr(s.vk_delta_2,h.delta.prvKey),h.deltaAfter=s.vk_delta_1,h.type=1,h.numIterationsExp=o,h.beaconHash=c,a&&(h.name=a),u.contributions.push(h),await Wi(g,s),await Ra(r,l,g,3),await Ra(r,l,g,4),await Ra(r,l,g,5),await Ra(r,l,g,6),await Ra(r,l,g,7);const p=d.Fr.inv(h.delta.prvKey);await Ro(r,l,g,8,d,"G1",p,d.Fr.e(1),"L Section",n),await Ro(r,l,g,9,d,"G1",p,d.Fr.e(1),"H Section",n),await no(g,d,u),await r.close(),await g.close();const m=$a.exports(64);ro(m,d,h);const L=m.digest();return n&&n.info(Ri(L,"Contribution Hash: ")),L},exportJson:async function(t){const e=await async function(t,e){const{fd:a,sections:i}=await Ua(t,"zkey",1),o=await eo(a,i,e),n=new K(o.r),c=ha.mod(ha.shl(1,8*o.n8r),o.r),r=n.inv(c),l=n.mul(r,r);let s=await ja(o.q);await qa(a,i,3),o.IC=[];for(let t=0;t<=o.nPublic;t++){const t=await Xi(a,s,e);o.IC.push(t)}await Ma(a),await qa(a,i,4);const d=await a.readULE32();o.ccoefs=[];for(let t=0;t<d;t++){const t=await a.readULE32(),e=await a.readULE32(),i=await a.readULE32(),n=await u();o.ccoefs.push({matrix:t,constraint:e,signal:i,value:n})}await Ma(a),await qa(a,i,5),o.A=[];for(let t=0;t<o.nVars;t++){const i=await Xi(a,s,e);o.A[t]=i}await Ma(a),await qa(a,i,6),o.B1=[];for(let t=0;t<o.nVars;t++){const i=await Xi(a,s,e);o.B1[t]=i}await Ma(a),await qa(a,i,7),o.B2=[];for(let t=0;t<o.nVars;t++){const i=await to(a,s,e);o.B2[t]=i}await Ma(a),await qa(a,i,8),o.C=[];for(let t=o.nPublic+1;t<o.nVars;t++){const i=await Xi(a,s,e);o.C[t]=i}await Ma(a),await qa(a,i,9),o.hExps=[];for(let t=0;t<o.domainSize;t++){const t=await Xi(a,s,e);o.hExps.push(t)}return await Ma(a),await a.close(),o;async function u(){const t=await ka(a,o.n8r);return n.mul(t,l)}}(t,!0);return delete e.curve,delete e.F,pa.stringifyBigInts(e)},bellmanContribute:async function(t,e,a,i,o){await $a.exports.ready();const n=await Ki(i),c=t.Fr.fromRng(n),r=t.Fr.inv(c),l=2*t.G1.F.n8,s=2*t.G2.F.n8,d=await Pa(e),u=await Ga(a);await B(l),await B(l),await B(s),await B(s);const g=await v(),_=t.G1.timesFr(g,c);await G(_);const f=await S(),h=t.G2.timesFr(f,c);await P(h);const p=await d.readUBE32();await u.writeUBE32(p),await B(p*l);const m=await d.readUBE32();await u.writeUBE32(m),await Do(d,u,null,t,"G1",m,r,t.Fr.e(1),"UNCOMPRESSED","H",o);const L=await d.readUBE32();await u.writeUBE32(L),await Do(d,u,null,t,"G1",L,r,t.Fr.e(1),"UNCOMPRESSED","L",o);const w=await d.readUBE32();await u.writeUBE32(w),await B(w*l);const A=await d.readUBE32();await u.writeUBE32(A),await B(A*l);const b=await d.readUBE32();await u.writeUBE32(b),await B(b*s);const y=$a.exports(64),I={};I.csHash=await d.read(64),y.update(I.csHash);const C=await d.readUBE32();I.contributions=[];for(let e=0;e<C;e++){const e={delta:{}};e.deltaAfter=await v(),e.delta.g1_s=await v(),e.delta.g1_sx=await v(),e.delta.g2_spx=await S(),e.transcript=await d.read(64),I.contributions.push(e),ro(y,t,e)}const F={delta:{}};F.delta.prvKey=c,F.delta.g1_s=t.G1.toAffine(t.G1.fromRng(n)),F.delta.g1_sx=t.G1.toAffine(t.G1.timesFr(F.delta.g1_s,c)),co(y,t,F.delta.g1_s),co(y,t,F.delta.g1_sx),F.transcript=y.digest(),F.delta.g2_sp=Fo(t,F.transcript),F.delta.g2_spx=t.G2.toAffine(t.G2.timesFr(F.delta.g2_sp,c)),F.deltaAfter=_,F.type=0,I.contributions.push(F),await u.write(I.csHash),await u.writeUBE32(I.contributions.length);for(let t=0;t<I.contributions.length;t++){const e=I.contributions[t];await G(e.deltaAfter),await G(e.delta.g1_s),await G(e.delta.g1_sx),await P(e.delta.g2_spx),await u.write(e.transcript)}const x=$a.exports(64);ro(x,t,F);const E=x.digest();return o&&o.info(Ri(E,"Contribution Hash: ")),await u.close(),await d.close(),E;async function B(t){const e=2*d.pageSize;for(let a=0;a<t;a+=e){const i=Math.min(t-a,e),o=await d.read(i);await u.write(o)}}async function v(){const e=await d.read(2*t.G1.F.n8);return t.G1.fromRprUncompressed(e,0)}async function S(){const e=await d.read(2*t.G2.F.n8);return t.G2.fromRprUncompressed(e,0)}async function G(e){const a=new Uint8Array(l);t.G1.toRprUncompressed(a,0,e),await u.write(a)}async function P(e){const a=new Uint8Array(s);t.G2.toRprUncompressed(a,0,e),await u.write(a)}},exportVerificationKey:gn,exportSolidityVerifier:async function(t,e,a){const i=await gn(t);let o=e[i.protocol];return _n.render(o,i)}});var hn,pn={exports:{}};\n/**\n     * [js-sha3]{@link https://github.com/emn178/js-sha3}\n     *\n     * @version 0.8.0\n     * @author Chen, Yi-Cyuan [emn178@gmail.com]\n     * @copyright Chen, Yi-Cyuan 2015-2018\n     * @license MIT\n     */hn=pn,function(){var t="input is invalid type",e="object"==typeof window,a=e?window:{};a.JS_SHA3_NO_WINDOW&&(e=!1);var i=!e&&"object"==typeof self;!a.JS_SHA3_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node?a=j:i&&(a=self);var o=!a.JS_SHA3_NO_COMMON_JS&&hn.exports,n=!a.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,c="0123456789abcdef".split(""),r=[4,1024,262144,67108864],l=[0,8,16,24],s=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],d=[224,256,384,512],u=[128,256],g=["hex","buffer","arrayBuffer","array","digest"],_={128:168,256:136};!a.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!n||!a.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});for(var f=function(t,e,a){return function(i){return new v(t,e,t).update(i)[a]()}},h=function(t,e,a){return function(i,o){return new v(t,e,o).update(i)[a]()}},p=function(t,e,a){return function(e,i,o,n){return b["cshake"+t].update(e,i,o,n)[a]()}},m=function(t,e,a){return function(e,i,o,n){return b["kmac"+t].update(e,i,o,n)[a]()}},L=function(t,e,a,i){for(var o=0;o<g.length;++o){var n=g[o];t[n]=e(a,i,n)}return t},w=function(t,e){var a=f(t,e,"hex");return a.create=function(){return new v(t,e,t)},a.update=function(t){return a.create().update(t)},L(a,f,t,e)},A=[{name:"keccak",padding:[1,256,65536,16777216],bits:d,createMethod:w},{name:"sha3",padding:[6,1536,393216,100663296],bits:d,createMethod:w},{name:"shake",padding:[31,7936,2031616,520093696],bits:u,createMethod:function(t,e){var a=h(t,e,"hex");return a.create=function(a){return new v(t,e,a)},a.update=function(t,e){return a.create(e).update(t)},L(a,h,t,e)}},{name:"cshake",padding:r,bits:u,createMethod:function(t,e){var a=_[t],i=p(t,0,"hex");return i.create=function(i,o,n){return o||n?new v(t,e,i).bytepad([o,n],a):b["shake"+t].create(i)},i.update=function(t,e,a,o){return i.create(e,a,o).update(t)},L(i,p,t,e)}},{name:"kmac",padding:r,bits:u,createMethod:function(t,e){var a=_[t],i=m(t,0,"hex");return i.create=function(i,o,n){return new S(t,e,o).bytepad(["KMAC",n],a).bytepad([i],a)},i.update=function(t,e,a,o){return i.create(t,a,o).update(e)},L(i,m,t,e)}}],b={},y=[],I=0;I<A.length;++I)for(var C=A[I],F=C.bits,x=0;x<F.length;++x){var E=C.name+"_"+F[x];if(y.push(E),b[E]=C.createMethod(F[x],C.padding),"sha3"!==C.name){var B=C.name+F[x];y.push(B),b[B]=b[E]}}function v(t,e,a){this.blocks=[],this.s=[],this.padding=e,this.outputBits=a,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=a>>5,this.extraBytes=(31&a)>>3;for(var i=0;i<50;++i)this.s[i]=0}function S(t,e,a){v.call(this,t,e,a)}v.prototype.update=function(e){if(this.finalized)throw new Error("finalize already called");var a,i=typeof e;if("string"!==i){if("object"!==i)throw new Error(t);if(null===e)throw new Error(t);if(n&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||n&&ArrayBuffer.isView(e)))throw new Error(t);a=!0}for(var o,c,r=this.blocks,s=this.byteCount,d=e.length,u=this.blockCount,g=0,_=this.s;g<d;){if(this.reset)for(this.reset=!1,r[0]=this.block,o=1;o<u+1;++o)r[o]=0;if(a)for(o=this.start;g<d&&o<s;++g)r[o>>2]|=e[g]<<l[3&o++];else for(o=this.start;g<d&&o<s;++g)(c=e.charCodeAt(g))<128?r[o>>2]|=c<<l[3&o++]:c<2048?(r[o>>2]|=(192|c>>6)<<l[3&o++],r[o>>2]|=(128|63&c)<<l[3&o++]):c<55296||c>=57344?(r[o>>2]|=(224|c>>12)<<l[3&o++],r[o>>2]|=(128|c>>6&63)<<l[3&o++],r[o>>2]|=(128|63&c)<<l[3&o++]):(c=65536+((1023&c)<<10|1023&e.charCodeAt(++g)),r[o>>2]|=(240|c>>18)<<l[3&o++],r[o>>2]|=(128|c>>12&63)<<l[3&o++],r[o>>2]|=(128|c>>6&63)<<l[3&o++],r[o>>2]|=(128|63&c)<<l[3&o++]);if(this.lastByteIndex=o,o>=s){for(this.start=o-s,this.block=r[u],o=0;o<u;++o)_[o]^=r[o];G(_),this.reset=!0}else this.start=o}return this},v.prototype.encode=function(t,e){var a=255&t,i=1,o=[a];for(a=255&(t>>=8);a>0;)o.unshift(a),a=255&(t>>=8),++i;return e?o.push(i):o.unshift(i),this.update(o),o.length},v.prototype.encodeString=function(e){var a,i=typeof e;if("string"!==i){if("object"!==i)throw new Error(t);if(null===e)throw new Error(t);if(n&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||n&&ArrayBuffer.isView(e)))throw new Error(t);a=!0}var o=0,c=e.length;if(a)o=c;else for(var r=0;r<e.length;++r){var l=e.charCodeAt(r);l<128?o+=1:l<2048?o+=2:l<55296||l>=57344?o+=3:(l=65536+((1023&l)<<10|1023&e.charCodeAt(++r)),o+=4)}return o+=this.encode(8*o),this.update(e),o},v.prototype.bytepad=function(t,e){for(var a=this.encode(e),i=0;i<t.length;++i)a+=this.encodeString(t[i]);var o=e-a%e,n=[];return n.length=o,this.update(n),this},v.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex,a=this.blockCount,i=this.s;if(t[e>>2]|=this.padding[3&e],this.lastByteIndex===this.byteCount)for(t[0]=t[a],e=1;e<a+1;++e)t[e]=0;for(t[a-1]|=2147483648,e=0;e<a;++e)i[e]^=t[e];G(i)}},v.prototype.toString=v.prototype.hex=function(){this.finalize();for(var t,e=this.blockCount,a=this.s,i=this.outputBlocks,o=this.extraBytes,n=0,r=0,l="";r<i;){for(n=0;n<e&&r<i;++n,++r)t=a[n],l+=c[t>>4&15]+c[15&t]+c[t>>12&15]+c[t>>8&15]+c[t>>20&15]+c[t>>16&15]+c[t>>28&15]+c[t>>24&15];r%e==0&&(G(a),n=0)}return o&&(t=a[n],l+=c[t>>4&15]+c[15&t],o>1&&(l+=c[t>>12&15]+c[t>>8&15]),o>2&&(l+=c[t>>20&15]+c[t>>16&15])),l},v.prototype.arrayBuffer=function(){this.finalize();var t,e=this.blockCount,a=this.s,i=this.outputBlocks,o=this.extraBytes,n=0,c=0,r=this.outputBits>>3;t=o?new ArrayBuffer(i+1<<2):new ArrayBuffer(r);for(var l=new Uint32Array(t);c<i;){for(n=0;n<e&&c<i;++n,++c)l[c]=a[n];c%e==0&&G(a)}return o&&(l[n]=a[n],t=t.slice(0,r)),t},v.prototype.buffer=v.prototype.arrayBuffer,v.prototype.digest=v.prototype.array=function(){this.finalize();for(var t,e,a=this.blockCount,i=this.s,o=this.outputBlocks,n=this.extraBytes,c=0,r=0,l=[];r<o;){for(c=0;c<a&&r<o;++c,++r)t=r<<2,e=i[c],l[t]=255&e,l[t+1]=e>>8&255,l[t+2]=e>>16&255,l[t+3]=e>>24&255;r%a==0&&G(i)}return n&&(t=r<<2,e=i[c],l[t]=255&e,n>1&&(l[t+1]=e>>8&255),n>2&&(l[t+2]=e>>16&255)),l},S.prototype=new v,S.prototype.finalize=function(){return this.encode(this.outputBits,!0),v.prototype.finalize.call(this)};var G=function(t){var e,a,i,o,n,c,r,l,d,u,g,_,f,h,p,m,L,w,A,b,y,I,C,F,x,E,B,v,S,G,P,U,O,z,Q,q,M,T,k,R,D,N,V,K,j,H,$,Y,W,Z,J,X,tt,et,at,it,ot,nt,ct,rt,lt,st,dt;for(i=0;i<48;i+=2)o=t[0]^t[10]^t[20]^t[30]^t[40],n=t[1]^t[11]^t[21]^t[31]^t[41],c=t[2]^t[12]^t[22]^t[32]^t[42],r=t[3]^t[13]^t[23]^t[33]^t[43],l=t[4]^t[14]^t[24]^t[34]^t[44],d=t[5]^t[15]^t[25]^t[35]^t[45],u=t[6]^t[16]^t[26]^t[36]^t[46],g=t[7]^t[17]^t[27]^t[37]^t[47],e=(_=t[8]^t[18]^t[28]^t[38]^t[48])^(c<<1|r>>>31),a=(f=t[9]^t[19]^t[29]^t[39]^t[49])^(r<<1|c>>>31),t[0]^=e,t[1]^=a,t[10]^=e,t[11]^=a,t[20]^=e,t[21]^=a,t[30]^=e,t[31]^=a,t[40]^=e,t[41]^=a,e=o^(l<<1|d>>>31),a=n^(d<<1|l>>>31),t[2]^=e,t[3]^=a,t[12]^=e,t[13]^=a,t[22]^=e,t[23]^=a,t[32]^=e,t[33]^=a,t[42]^=e,t[43]^=a,e=c^(u<<1|g>>>31),a=r^(g<<1|u>>>31),t[4]^=e,t[5]^=a,t[14]^=e,t[15]^=a,t[24]^=e,t[25]^=a,t[34]^=e,t[35]^=a,t[44]^=e,t[45]^=a,e=l^(_<<1|f>>>31),a=d^(f<<1|_>>>31),t[6]^=e,t[7]^=a,t[16]^=e,t[17]^=a,t[26]^=e,t[27]^=a,t[36]^=e,t[37]^=a,t[46]^=e,t[47]^=a,e=u^(o<<1|n>>>31),a=g^(n<<1|o>>>31),t[8]^=e,t[9]^=a,t[18]^=e,t[19]^=a,t[28]^=e,t[29]^=a,t[38]^=e,t[39]^=a,t[48]^=e,t[49]^=a,h=t[0],p=t[1],H=t[11]<<4|t[10]>>>28,$=t[10]<<4|t[11]>>>28,v=t[20]<<3|t[21]>>>29,S=t[21]<<3|t[20]>>>29,rt=t[31]<<9|t[30]>>>23,lt=t[30]<<9|t[31]>>>23,N=t[40]<<18|t[41]>>>14,V=t[41]<<18|t[40]>>>14,z=t[2]<<1|t[3]>>>31,Q=t[3]<<1|t[2]>>>31,m=t[13]<<12|t[12]>>>20,L=t[12]<<12|t[13]>>>20,Y=t[22]<<10|t[23]>>>22,W=t[23]<<10|t[22]>>>22,G=t[33]<<13|t[32]>>>19,P=t[32]<<13|t[33]>>>19,st=t[42]<<2|t[43]>>>30,dt=t[43]<<2|t[42]>>>30,et=t[5]<<30|t[4]>>>2,at=t[4]<<30|t[5]>>>2,q=t[14]<<6|t[15]>>>26,M=t[15]<<6|t[14]>>>26,w=t[25]<<11|t[24]>>>21,A=t[24]<<11|t[25]>>>21,Z=t[34]<<15|t[35]>>>17,J=t[35]<<15|t[34]>>>17,U=t[45]<<29|t[44]>>>3,O=t[44]<<29|t[45]>>>3,F=t[6]<<28|t[7]>>>4,x=t[7]<<28|t[6]>>>4,it=t[17]<<23|t[16]>>>9,ot=t[16]<<23|t[17]>>>9,T=t[26]<<25|t[27]>>>7,k=t[27]<<25|t[26]>>>7,b=t[36]<<21|t[37]>>>11,y=t[37]<<21|t[36]>>>11,X=t[47]<<24|t[46]>>>8,tt=t[46]<<24|t[47]>>>8,K=t[8]<<27|t[9]>>>5,j=t[9]<<27|t[8]>>>5,E=t[18]<<20|t[19]>>>12,B=t[19]<<20|t[18]>>>12,nt=t[29]<<7|t[28]>>>25,ct=t[28]<<7|t[29]>>>25,R=t[38]<<8|t[39]>>>24,D=t[39]<<8|t[38]>>>24,I=t[48]<<14|t[49]>>>18,C=t[49]<<14|t[48]>>>18,t[0]=h^~m&w,t[1]=p^~L&A,t[10]=F^~E&v,t[11]=x^~B&S,t[20]=z^~q&T,t[21]=Q^~M&k,t[30]=K^~H&Y,t[31]=j^~$&W,t[40]=et^~it&nt,t[41]=at^~ot&ct,t[2]=m^~w&b,t[3]=L^~A&y,t[12]=E^~v&G,t[13]=B^~S&P,t[22]=q^~T&R,t[23]=M^~k&D,t[32]=H^~Y&Z,t[33]=$^~W&J,t[42]=it^~nt&rt,t[43]=ot^~ct&lt,t[4]=w^~b&I,t[5]=A^~y&C,t[14]=v^~G&U,t[15]=S^~P&O,t[24]=T^~R&N,t[25]=k^~D&V,t[34]=Y^~Z&X,t[35]=W^~J&tt,t[44]=nt^~rt&st,t[45]=ct^~lt&dt,t[6]=b^~I&h,t[7]=y^~C&p,t[16]=G^~U&F,t[17]=P^~O&x,t[26]=R^~N&z,t[27]=D^~V&Q,t[36]=Z^~X&K,t[37]=J^~tt&j,t[46]=rt^~st&et,t[47]=lt^~dt&at,t[8]=I^~h&m,t[9]=C^~p&L,t[18]=U^~F&E,t[19]=O^~x&B,t[28]=N^~z&q,t[29]=V^~Q&M,t[38]=X^~K&H,t[39]=tt^~j&$,t[48]=st^~et&it,t[49]=dt^~at&ot,t[0]^=s[i],t[1]^=s[i+1]};if(o)hn.exports=b;else for(I=0;I<y.length;++I)a[y[I]]=b[y[I]]}();var mn=pn.exports;const{stringifyBigInts:Ln}=pa,{keccak256:wn}=mn;async function An(t,e,a){const{fd:i,sections:o}=await Ua(e,"wtns",2),n=await lo(i,o),{fd:c,sections:r}=await Ua(t,"zkey",2),l=await eo(c,r);if("plonk"!=l.protocol)throw new Error("zkey file is not plonk");if(!ha.eq(l.r,n.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(n.nWitness!=l.nVars-l.nAdditions)throw new Error(`Invalid witness length. Circuit: ${l.nVars}, witness: ${n.nWitness}, ${l.nAdditions}`);const s=l.curve,d=s.Fr,u=s.G1,g=s.Fr.n8;a&&a.debug("Reading Wtns");const _=await Da(i,o,2);_.set(d.zero,0);const f=new Pe(g*l.nAdditions);let h,p,m,L,w,A,b,y,I,C,F,x,E,B;await async function(){const t=await Da(c,r,3),e=8+2*s.Fr.n8;for(let a=0;a<l.nAdditions;a++){const i=q(t,a*e),o=q(t,a*e+4),n=t.slice(a*e+8,a*e+8+g),c=t.slice(a*e+8+g,a*e+8+2*g),r=M(i),l=M(o),d=s.Fr.add(s.Fr.mul(n,r),s.Fr.mul(c,l));f.set(d,g*a)}}();let v={};const S=new Pe(l.domainSize*g*4*3);let G=r[12][0].p+l.domainSize*g;await c.readToBuffer(S,0,l.domainSize*g*4,G),G+=l.domainSize*g*5,await c.readToBuffer(S,l.domainSize*g*4,l.domainSize*g*4,G),G+=l.domainSize*g*5,await c.readToBuffer(S,l.domainSize*g*8,l.domainSize*g*4,G);const P=new Pe(l.domainSize*g);await c.readToBuffer(P,0,l.domainSize*g,r[12][0].p);const U=new Pe(l.domainSize*g);await c.readToBuffer(U,0,l.domainSize*g,r[12][0].p+5*l.domainSize*g);const O=await Da(c,r,14),z={};await async function(){z.b=[];for(let t=1;t<=11;t++)z.b[t]=s.Fr.random();[h,p,m]=await async function(){let t=new Pe(l.domainSize*g),e=new Pe(l.domainSize*g),a=new Pe(l.domainSize*g);const i=await Da(c,r,4),o=await Da(c,r,5),n=await Da(c,r,6);for(let c=0;c<l.nConstrains;c++){const r=q(i,4*c);t.set(M(r),c*g);const l=q(o,4*c);e.set(M(l),c*g);const s=q(n,4*c);a.set(M(s),c*g)}return t=await d.batchToMontgomery(t),e=await d.batchToMontgomery(e),a=await d.batchToMontgomery(a),[t,e,a]}(),[I,w]=await N(h,[z.b[2],z.b[1]]),[C,A]=await N(p,[z.b[4],z.b[3]]),[F,b]=await N(m,[z.b[6],z.b[5]]),v.A=await D(I,"multiexp A"),v.B=await D(C,"multiexp B"),v.C=await D(F,"multiexp C")}(),await async function(){const t=new Uint8Array(l.nPublic*g+2*u.F.n8*3);for(let e=0;e<l.nPublic;e++)d.toRprBE(t,e*g,h.slice(e*g,(e+1)*g));u.toRprUncompressed(t,l.nPublic*g+0,v.A),u.toRprUncompressed(t,l.nPublic*g+2*u.F.n8,v.B),u.toRprUncompressed(t,l.nPublic*g+4*u.F.n8,v.C),z.beta=T(t),a&&a.debug("beta: "+d.toString(z.beta));const e=new Uint8Array(g);d.toRprBE(e,0,z.beta),z.gamma=T(e),a&&a.debug("gamma: "+d.toString(z.gamma));let i=new Pe(d.n8*l.domainSize),o=new Pe(d.n8*l.domainSize);i.set(d.one,0),o.set(d.one,0);let n=d.one;for(let t=0;t<l.domainSize;t++){let e=h.slice(t*g,(t+1)*g);e=d.add(e,d.mul(z.beta,n)),e=d.add(e,z.gamma);let a=p.slice(t*g,(t+1)*g);a=d.add(a,d.mul(l.k1,d.mul(z.beta,n))),a=d.add(a,z.gamma);let c=m.slice(t*g,(t+1)*g);c=d.add(c,d.mul(l.k2,d.mul(z.beta,n))),c=d.add(c,z.gamma);const r=d.mul(e,d.mul(a,c));let s=h.slice(t*g,(t+1)*g);s=d.add(s,d.mul(S.slice(t*g*4,t*g*4+g),z.beta)),s=d.add(s,z.gamma);let u=p.slice(t*g,(t+1)*g);u=d.add(u,d.mul(S.slice(4*(l.domainSize+t)*g,4*(l.domainSize+t)*g+g),z.beta)),u=d.add(u,z.gamma);let _=m.slice(t*g,(t+1)*g);_=d.add(_,d.mul(S.slice(4*(2*l.domainSize+t)*g,4*(2*l.domainSize+t)*g+g),z.beta)),_=d.add(_,z.gamma);const f=d.mul(s,d.mul(u,_));i.set(d.mul(i.slice(t*g,(t+1)*g),r),(t+1)%l.domainSize*g),o.set(d.mul(o.slice(t*g,(t+1)*g),f),(t+1)%l.domainSize*g),n=d.mul(n,d.w[l.power])}o=await d.batchInverse(o);for(let t=0;t<l.domainSize;t++)i.set(d.mul(i.slice(t*g,(t+1)*g),o.slice(t*g,(t+1)*g)),t*g);if(!d.eq(i.slice(0,g),d.one))throw new Error("Copy constraints does not match");L=i,[x,y]=await N(L,[z.b[9],z.b[8],z.b[7]]),v.Z=await D(x,"multiexp Z")}(),await async function(){a&&a.debug("phse3: Reading QM4");const t=new Pe(4*l.domainSize*g);await c.readToBuffer(t,0,l.domainSize*g*4,r[7][0].p+l.domainSize*g),a&&a.debug("phse3: Reading QL4");const e=new Pe(4*l.domainSize*g);await c.readToBuffer(e,0,l.domainSize*g*4,r[8][0].p+l.domainSize*g),a&&a.debug("phse3: Reading QR4");const i=new Pe(4*l.domainSize*g);await c.readToBuffer(i,0,l.domainSize*g*4,r[9][0].p+l.domainSize*g),a&&a.debug("phse3: Reading QO4");const o=new Pe(4*l.domainSize*g);await c.readToBuffer(o,0,l.domainSize*g*4,r[10][0].p+l.domainSize*g),a&&a.debug("phse3: Reading QC4");const n=new Pe(4*l.domainSize*g);await c.readToBuffer(n,0,l.domainSize*g*4,r[11][0].p+l.domainSize*g);const s=await Da(c,r,13),_=new Uint8Array(2*u.F.n8);u.toRprUncompressed(_,0,v.Z),z.alpha=T(_),a&&a.debug("alpha: "+d.toString(z.alpha));const f=[d.zero,d.add(d.e(-1),d.w[2]),d.e(-2),d.sub(d.e(-1),d.w[2])],p=[d.zero,d.add(d.zero,d.mul(d.e(-2),d.w[2])),d.e(4),d.sub(d.zero,d.mul(d.e(-2),d.w[2]))],m=[d.zero,d.add(d.e(2),d.mul(d.e(2),d.w[2])),d.e(-8),d.sub(d.e(2),d.mul(d.e(2),d.w[2]))],L=new Pe(4*l.domainSize*g),I=new Pe(4*l.domainSize*g);let C=d.one;for(let c=0;c<4*l.domainSize;c++){c%4096==0&&a&&a.debug(`calculating t ${c}/${4*l.domainSize}`);const r=w.slice(c*g,c*g+g),u=A.slice(c*g,c*g+g),_=b.slice(c*g,c*g+g),f=y.slice(c*g,c*g+g),p=y.slice((c+4*l.domainSize+4)%(4*l.domainSize)*g,(c+4*l.domainSize+4)%(4*l.domainSize)*g+g),m=t.slice(c*g,c*g+g),F=e.slice(c*g,c*g+g),x=i.slice(c*g,c*g+g),E=o.slice(c*g,c*g+g),B=n.slice(c*g,c*g+g),v=S.slice(c*g,c*g+g),G=S.slice((c+4*l.domainSize)*g,(c+4*l.domainSize)*g+g),P=S.slice((c+8*l.domainSize)*g,(c+8*l.domainSize)*g+g),U=d.add(z.b[2],d.mul(z.b[1],C)),O=d.add(z.b[4],d.mul(z.b[3],C)),M=d.add(z.b[6],d.mul(z.b[5],C)),T=d.square(C),k=d.add(d.add(d.mul(z.b[7],T),d.mul(z.b[8],C)),z.b[9]),R=d.mul(C,d.w[l.power]),D=d.square(R),N=d.add(d.add(d.mul(z.b[7],D),d.mul(z.b[8],R)),z.b[9]);let V=d.zero;for(let t=0;t<l.nPublic;t++)V=d.sub(V,d.mul(s.slice((5*t*l.domainSize+l.domainSize+c)*g,(5*t*l.domainSize+l.domainSize+c+1)*g),h.slice(t*g,(t+1)*g)));let[K,j]=Q(r,u,U,O,c%4);K=d.mul(K,m),j=d.mul(j,m),K=d.add(K,d.mul(r,F)),j=d.add(j,d.mul(U,F)),K=d.add(K,d.mul(u,x)),j=d.add(j,d.mul(O,x)),K=d.add(K,d.mul(_,E)),j=d.add(j,d.mul(M,E)),K=d.add(K,V),K=d.add(K,B);const H=d.mul(z.beta,C);let $=r;$=d.add($,H),$=d.add($,z.gamma);let Y=u;Y=d.add(Y,d.mul(H,l.k1)),Y=d.add(Y,z.gamma);let W=_;W=d.add(W,d.mul(H,l.k2)),W=d.add(W,z.gamma);let Z=f,[J,X]=q($,Y,W,Z,U,O,M,k,c%4);J=d.mul(J,z.alpha),X=d.mul(X,z.alpha);let tt=r;tt=d.add(tt,d.mul(z.beta,v)),tt=d.add(tt,z.gamma);let et=u;et=d.add(et,d.mul(z.beta,G)),et=d.add(et,z.gamma);let at=_;at=d.add(at,d.mul(z.beta,P)),at=d.add(at,z.gamma);let it=p,[ot,nt]=q(tt,et,at,it,U,O,M,N,c%4);ot=d.mul(ot,z.alpha),nt=d.mul(nt,z.alpha);let ct=d.sub(f,d.one);ct=d.mul(ct,s.slice((l.domainSize+c)*g,(l.domainSize+c+1)*g)),ct=d.mul(ct,d.mul(z.alpha,z.alpha));let rt=d.mul(k,s.slice((l.domainSize+c)*g,(l.domainSize+c+1)*g));rt=d.mul(rt,d.mul(z.alpha,z.alpha));let lt=d.add(d.sub(d.add(K,J),ot),ct),st=d.add(d.sub(d.add(j,X),nt),rt);L.set(lt,c*g),I.set(st,c*g),C=d.mul(C,d.w[l.power+2])}a&&a.debug("ifft T");let F=await d.ifft(L);a&&a.debug("dividing T/Z");for(let t=0;t<l.domainSize;t++)F.set(d.neg(F.slice(t*g,t*g+g)),t*g);for(let t=l.domainSize;t<4*l.domainSize;t++){const e=d.sub(F.slice((t-l.domainSize)*g,(t-l.domainSize)*g+g),F.slice(t*g,t*g+g));if(F.set(e,t*g),t>3*l.domainSize-4&&!d.isZero(e))throw new Error("T Polynomial is not divisible")}a&&a.debug("ifft Tz");const x=await d.ifft(I);for(let t=0;t<4*l.domainSize;t++){const e=x.slice(t*g,(t+1)*g);if(t>3*l.domainSize+5){if(!d.isZero(e))throw new Error("Tz Polynomial is not well calculated")}else F.set(d.add(F.slice(t*g,(t+1)*g),e),t*g)}E=F.slice(0,(3*l.domainSize+6)*g);let B=new Pe((l.domainSize+1)*g);B.set(F.slice(0,l.domainSize*g),0),B.set(z.b[10],l.domainSize*g);let G=new Pe((l.domainSize+1)*g);G.set(F.slice(l.domainSize*g,2*l.domainSize*g),0);const P=d.sub(G.slice(0,g),z.b[10]);G.set(P,0),G.set(z.b[11],l.domainSize*g);let U=new Pe((l.domainSize+6)*g);U.set(F.slice(2*l.domainSize*g,(3*l.domainSize+6)*g),0);const O=d.sub(U.slice(0,g),z.b[11]);function Q(t,e,a,i,o){let n,c;const r=d.mul(t,e),l=d.mul(t,i),s=d.mul(a,e);n=r;let u=d.mul(a,i);return c=d.add(l,s),o&&(c=d.add(c,d.mul(f[o],u))),[n,c]}function q(t,e,a,i,o,n,c,r,l){let s,u;const g=d.mul(t,e),_=d.mul(t,n),h=d.mul(o,e),L=d.mul(o,n),w=d.mul(a,i),A=d.mul(a,r),b=d.mul(c,i),y=d.mul(c,r);s=d.mul(g,w);let I=d.mul(h,w);I=d.add(I,d.mul(_,w)),I=d.add(I,d.mul(g,b)),I=d.add(I,d.mul(g,A));let C=d.mul(L,w);C=d.add(C,d.mul(h,b)),C=d.add(C,d.mul(h,A)),C=d.add(C,d.mul(_,b)),C=d.add(C,d.mul(_,A)),C=d.add(C,d.mul(g,y));let F=d.mul(_,y);F=d.add(F,d.mul(h,y)),F=d.add(F,d.mul(L,A)),F=d.add(F,d.mul(L,b));let x=d.mul(L,y);return u=I,l&&(u=d.add(u,d.mul(f[l],C)),u=d.add(u,d.mul(p[l],F)),u=d.add(u,d.mul(m[l],x))),[s,u]}U.set(O,0),v.T1=await D(B,"multiexp T1"),v.T2=await D(G,"multiexp T2"),v.T3=await D(U,"multiexp T3")}(),await async function(){const t=new Pe(l.domainSize*g);await c.readToBuffer(t,0,l.domainSize*g,r[7][0].p);const e=new Pe(l.domainSize*g);await c.readToBuffer(e,0,l.domainSize*g,r[8][0].p);const i=new Pe(l.domainSize*g);await c.readToBuffer(i,0,l.domainSize*g,r[9][0].p);const o=new Pe(l.domainSize*g);await c.readToBuffer(o,0,l.domainSize*g,r[10][0].p);const n=new Pe(l.domainSize*g);await c.readToBuffer(n,0,l.domainSize*g,r[11][0].p);const s=new Pe(l.domainSize*g);await c.readToBuffer(s,0,l.domainSize*g,r[12][0].p+10*l.domainSize*g);const _=new Uint8Array(2*u.F.n8*3);u.toRprUncompressed(_,0,v.T1),u.toRprUncompressed(_,2*u.F.n8,v.T2),u.toRprUncompressed(_,4*u.F.n8,v.T3),z.xi=T(_),a&&a.debug("xi: "+d.toString(z.xi));v.eval_a=k(I,z.xi),v.eval_b=k(C,z.xi),v.eval_c=k(F,z.xi),v.eval_s1=k(P,z.xi),v.eval_s2=k(U,z.xi),v.eval_t=k(E,z.xi),v.eval_zw=k(x,d.mul(z.xi,d.w[l.power]));const f=d.mul(v.eval_a,v.eval_b);let h=v.eval_a;const p=d.mul(z.beta,z.xi);h=d.add(h,p),h=d.add(h,z.gamma);let m=v.eval_b;m=d.add(m,d.mul(p,l.k1)),m=d.add(m,z.gamma);let L=v.eval_c;L=d.add(L,d.mul(p,l.k2)),L=d.add(L,z.gamma);const w=d.mul(d.mul(d.mul(h,m),L),z.alpha);let A=v.eval_a;A=d.add(A,d.mul(z.beta,v.eval_s1)),A=d.add(A,z.gamma);let b=v.eval_b;b=d.add(b,d.mul(z.beta,v.eval_s2)),b=d.add(b,z.gamma);let y=d.mul(A,b);y=d.mul(y,z.beta),y=d.mul(y,v.eval_zw),y=d.mul(y,z.alpha),z.xim=z.xi;for(let t=0;t<l.power;t++)z.xim=d.mul(z.xim,z.xim);const S=d.div(d.sub(z.xim,d.one),d.mul(d.sub(z.xi,d.one),d.e(l.domainSize))),G=d.mul(S,d.mul(z.alpha,z.alpha)),O=y,Q=d.add(w,G);B=new Pe((l.domainSize+3)*g);for(let a=0;a<l.domainSize+3;a++){let c=d.mul(Q,x.slice(a*g,(a+1)*g));a<l.domainSize&&(c=d.add(c,d.mul(f,t.slice(a*g,(a+1)*g))),c=d.add(c,d.mul(v.eval_a,e.slice(a*g,(a+1)*g))),c=d.add(c,d.mul(v.eval_b,i.slice(a*g,(a+1)*g))),c=d.add(c,d.mul(v.eval_c,o.slice(a*g,(a+1)*g))),c=d.add(c,n.slice(a*g,(a+1)*g)),c=d.sub(c,d.mul(O,s.slice(a*g,(a+1)*g)))),B.set(c,a*g)}v.eval_r=k(B,z.xi)}(),await async function(){const t=new Uint8Array(7*g);d.toRprBE(t,0,v.eval_a),d.toRprBE(t,g,v.eval_b),d.toRprBE(t,2*g,v.eval_c),d.toRprBE(t,3*g,v.eval_s1),d.toRprBE(t,4*g,v.eval_s2),d.toRprBE(t,5*g,v.eval_zw),d.toRprBE(t,6*g,v.eval_r),z.v=[],z.v[1]=T(t),a&&a.debug("v: "+d.toString(z.v[1]));for(let t=2;t<=6;t++)z.v[t]=d.mul(z.v[t-1],z.v[1]);let e=new Pe((l.domainSize+6)*g);const i=d.mul(z.xim,z.xim);for(let t=0;t<l.domainSize+6;t++){let a=d.zero;const o=E.slice((2*l.domainSize+t)*g,(2*l.domainSize+t+1)*g);if(a=d.add(a,d.mul(i,o)),t<l.domainSize+3&&(a=d.add(a,d.mul(z.v[1],B.slice(t*g,(t+1)*g)))),t<l.domainSize+2&&(a=d.add(a,d.mul(z.v[2],I.slice(t*g,(t+1)*g))),a=d.add(a,d.mul(z.v[3],C.slice(t*g,(t+1)*g))),a=d.add(a,d.mul(z.v[4],F.slice(t*g,(t+1)*g)))),t<l.domainSize){const e=E.slice(t*g,(t+1)*g);a=d.add(a,e);const i=E.slice((l.domainSize+t)*g,(l.domainSize+t+1)*g);a=d.add(a,d.mul(z.xim,i)),a=d.add(a,d.mul(z.v[5],P.slice(t*g,(t+1)*g))),a=d.add(a,d.mul(z.v[6],U.slice(t*g,(t+1)*g)))}0===t&&(a=d.sub(a,d.mul(i,z.b[11])),a=d.sub(a,d.mul(z.xim,z.b[10]))),t===l.domainSize&&(a=d.add(a,z.b[10]),a=d.add(a,d.mul(z.xim,z.b[11]))),e.set(a,t*g)}let o=e.slice(0,g);o=d.sub(o,v.eval_t),o=d.sub(o,d.mul(z.v[1],v.eval_r)),o=d.sub(o,d.mul(z.v[2],v.eval_a)),o=d.sub(o,d.mul(z.v[3],v.eval_b)),o=d.sub(o,d.mul(z.v[4],v.eval_c)),o=d.sub(o,d.mul(z.v[5],v.eval_s1)),o=d.sub(o,d.mul(z.v[6],v.eval_s2)),e.set(o,0),e=R(e,z.xi),v.Wxi=await D(e,"multiexp Wxi");let n=new Pe((l.domainSize+3)*g);for(let t=0;t<l.domainSize+3;t++){const e=x.slice(t*g,(t+1)*g);n.set(e,t*g)}o=n.slice(0,g),o=d.sub(o,v.eval_zw),n.set(o,0),n=R(n,d.mul(z.xi,d.w[l.power])),v.Wxiw=await D(n,"multiexp Wxiw")}(),v.protocol="plonk",v.curve=s.name,await c.close(),await i.close();let Q=[];for(let t=1;t<=l.nPublic;t++){const e=_.slice(t*d.n8,t*d.n8+d.n8);Q.push(ha.fromRprLE(e))}return v.A=u.toObject(v.A),v.B=u.toObject(v.B),v.C=u.toObject(v.C),v.Z=u.toObject(v.Z),v.T1=u.toObject(v.T1),v.T2=u.toObject(v.T2),v.T3=u.toObject(v.T3),v.eval_a=d.toObject(v.eval_a),v.eval_b=d.toObject(v.eval_b),v.eval_c=d.toObject(v.eval_c),v.eval_s1=d.toObject(v.eval_s1),v.eval_s2=d.toObject(v.eval_s2),v.eval_zw=d.toObject(v.eval_zw),v.eval_t=d.toObject(v.eval_t),v.eval_r=d.toObject(v.eval_r),v.Wxi=u.toObject(v.Wxi),v.Wxiw=u.toObject(v.Wxiw),delete v.eval_t,v=Ln(v),Q=Ln(Q),{proof:v,publicSignals:Q};function q(t,e){const a=t.slice(e,e+4);return new DataView(a.buffer,a.byteOffset,a.byteLength).getUint32(0,!0)}function M(t){return t<l.nVars-l.nAdditions?_.slice(t*g,t*g+g):t<l.nVars?f.slice((t-(l.nVars-l.nAdditions))*g,(t-(l.nVars-l.nAdditions))*g+g):s.Fr.zero}function T(t){const e=ha.fromRprBE(new Uint8Array(wn.arrayBuffer(t)));return d.e(e)}function k(t,e){const a=t.byteLength/g;if(0==a)return d.zero;let i=t.slice((a-1)*g,a*g);for(let o=a-2;o>=0;o--)i=d.add(d.mul(i,e),t.slice(o*g,(o+1)*g));return i}function R(t,e){const a=t.byteLength/g,i=new Pe(a*g);i.set(d.zero,(a-1)*g),i.set(t.slice((a-1)*g,a*g),(a-2)*g);for(let o=a-3;o>=0;o--)i.set(d.add(t.slice((o+1)*g,(o+2)*g),d.mul(e,i.slice((o+1)*g,(o+2)*g))),o*g);if(!d.eq(t.slice(0,g),d.mul(d.neg(e),i.slice(0,g))))throw new Error("Polinomial does not divide");return i}async function D(t,e){const i=t.byteLength/g,o=O.slice(0,i*s.G1.F.n8*2),n=await s.Fr.batchFromMontgomery(t);let c=await s.G1.multiExpAffine(o,n,a,e);return c=s.G1.toAffine(c),c}async function N(t,e){e=e||[];let a=await d.ifft(t);const i=new Pe(g*l.domainSize*4);i.set(a,0);const o=new Pe(g*(l.domainSize+e.length));o.set(a,0);for(let t=0;t<e.length;t++)o.set(d.add(o.slice((l.domainSize+t)*g,(l.domainSize+t+1)*g),e[t]),(l.domainSize+t)*g),o.set(d.sub(o.slice(t*g,(t+1)*g),e[t]),t*g);return[o,await d.fft(i)]}}const{unstringifyBigInts:bn}=pa;const{unstringifyBigInts:yn}=pa,{keccak256:In}=mn;function Cn(t,e){const a=ha.fromRprBE(new Uint8Array(In.arrayBuffer(e)));return t.Fr.e(a)}const{unstringifyBigInts:Fn}=pa;function xn(t){return("0"+t.toString(16)).slice(-2)}function En(t){let e=t.toString(16);for(;e.length<64;)e="0"+e;return e=`"0x${e}"`,e}var Bn=Object.freeze({__proto__:null,setup:async function(t,e,a,i){globalThis.gc&&globalThis.gc(),await $a.exports.ready();const{fd:o,sections:n}=await Ua(e,"ptau",1),{curve:c,power:r}=await So(o,n),{fd:l,sections:s}=await Ua(t,"r1cs",1),d=await Yo(l,s,{loadConstraints:!0,loadCustomGates:!0}),u=2*c.G1.F.n8,g=c.G1,_=2*c.G2.F.n8,f=c.Fr,h=c.Fr.n8;i&&i.info("Reading r1cs"),await Da(l,s,2);const p=new rn,m=new rn;let L=d.nVars;const w=d.nOutputs+d.nPubInputs;await async function(t,e,a){function i(t){const e=Object.keys(t);for(let a=0;a<e.length;a++)0n==t[e[a]]&&delete t[e[a]]}function o(e,a,o){const n={};for(let i in e)void 0===n[i]?n[i]=t.mul(a,e[i]):n[i]=t.add(n[i],t.mul(a,e[i]));for(let e in o)void 0===n[e]?n[e]=o[e]:n[e]=t.add(n[e],o[e]);return i(n),n}function n(e,a){const i={k:t.zero,s:[],coefs:[]},o=[];for(let a in e)0==a?i.k=t.add(i.k,e[a]):0n!=e[a]&&o.push([Number(a),e[a]]);for(;o.length>a;){const e=o.shift(),a=o.shift(),i=e[0],n=a[0],c=L++,r=t.zero,l=t.neg(e[1]),s=t.neg(a[1]),d=t.one,u=t.zero;p.push([i,n,c,r,l,s,d,u]),m.push([i,n,e[1],a[1]]),o.push([c,t.one])}for(let t=0;t<o.length;t++)i.s[t]=o[t][0],i.coefs[t]=o[t][1];for(;i.coefs.length<a;)i.s.push(0),i.coefs.push(t.zero);return i}function c(e){const a=n(e,3),i=a.s[0],o=a.s[1],c=a.s[2],r=t.zero,l=a.coefs[0],s=a.coefs[1],d=a.coefs[2],u=a.k;p.push([i,o,c,r,l,s,d,u])}function r(e){let a=t.zero,i=0;const o=Object.keys(e);for(let n=0;n<o.length;n++)0n==e[o[n]]?delete e[o[n]]:0==o[n]?a=t.add(a,e[o[n]]):i++;return i>0?i.toString():a!=t.zero?"k":"0"}function l(e,a,l){const s=r(e),d=r(a);if("0"===s||"0"===d)i(l),c(l);else if("k"===s){c(o(a,e[0],l))}else if("k"===d){c(o(e,a[0],l))}else!function(e,a,i){const o=n(e,1),c=n(a,1),r=n(i,1),l=o.s[0],s=c.s[0],d=r.s[0],u=t.mul(o.coefs[0],c.coefs[0]),g=t.mul(o.coefs[0],c.k),_=t.mul(o.k,c.coefs[0]),f=t.neg(r.coefs[0]),h=t.sub(t.mul(o.k,c.k),r.k);p.push([l,s,d,u,g,_,f,h])}(e,a,l)}for(let e=1;e<=w;e++){const a=e,i=0,o=0,n=t.zero,c=t.one,r=t.zero,l=t.zero,s=t.zero;p.push([a,i,o,n,c,r,l,s])}for(let t=0;t<e.constraints.length;t++)a&&t%1e4==0&&a.debug(`processing constraints: ${t}/${e.nConstraints}`),l(...e.constraints[t])}(c.Fr,d,i),globalThis.gc&&globalThis.gc();const A=await Oa(a,"zkey",1,14,1<<22,1<<24);if(d.prime!=c.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;let b=ki(p.length-1)+1;b<3&&(b=3);const y=2**b;if(i&&i.info("Plonk constraints: "+p.length),b>r)return i&&i.error(`circuit too big for this power of tau ceremony. ${p.length} > 2**${r}`),-1;if(!n[12])return i&&i.error("Powers of tau is not prepared."),-1;const I=new Pe(y*u),C=n[12][0].p+(2**b-1)*u;await o.readToBuffer(I,0,y*u,C);const[F,x]=function(){let t=f.two;for(;a(t,[],b);)f.add(t,f.one);let e=f.add(t,f.one);for(;a(e,[t],b);)f.add(e,f.one);return[t,e];function a(t,e,a){const i=2**a;let o=f.one;for(let n=0;n<i;n++){if(f.eq(t,o))return!0;for(let a=0;a<e.length;a++)if(f.eq(t,f.mul(e[a],o)))return!0;o=f.mul(o,f.w[a])}return!1}}(),E={};await async function(t,e){await za(A,t);const a=new Uint8Array(8+2*h),o=new DataView(a.buffer);for(let t=0;t<m.length;t++){const n=m[t];let c=0;o.setUint32(c,n[0],!0),c+=4,o.setUint32(c,n[1],!0),c+=4,a.set(n[2],c),c+=h,a.set(n[3],c),c+=h,await A.write(a),i&&t%1e6==0&&i.debug(`writing ${e}: ${t}/${m.length}`)}await Qa(A)}(3,"Additions"),globalThis.gc&&globalThis.gc(),await v(4,0,"Amap"),globalThis.gc&&globalThis.gc(),await v(5,1,"Bmap"),globalThis.gc&&globalThis.gc(),await v(6,2,"Cmap"),globalThis.gc&&globalThis.gc(),await S(7,3,"Qm"),globalThis.gc&&globalThis.gc(),await S(8,4,"Ql"),globalThis.gc&&globalThis.gc(),await S(9,5,"Qr"),globalThis.gc&&globalThis.gc(),await S(10,6,"Qo"),globalThis.gc&&globalThis.gc(),await S(11,7,"Qc"),globalThis.gc&&globalThis.gc(),await async function(t,e){const a=new Pe(h*y*3),o=new rn(L),n=new rn(L);let r=f.one;for(let t=0;t<y;t++)t<p.length?(u(p[t][0],t),u(p[t][1],y+t),u(p[t][2],2*y+t)):(u(0,t),u(0,y+t),u(0,2*y+t)),r=f.mul(r,f.w[b]),i&&t%1e6==0&&i.debug(`writing ${e} phase1: ${t}/${p.length}`);for(let t=0;t<L;t++)void 0!==n[t]?a.set(o[t],n[t]*h):console.log("Variable not used"),i&&t%1e6==0&&i.debug(`writing ${e} phase2: ${t}/${L}`);globalThis.gc&&globalThis.gc();await za(A,t);let l=a.slice(0,y*h);await G(l),globalThis.gc&&globalThis.gc();let s=a.slice(y*h,y*h*2);await G(s),globalThis.gc&&globalThis.gc();let d=a.slice(y*h*2,y*h*3);await G(d),globalThis.gc&&globalThis.gc();await Qa(A),l=await f.batchFromMontgomery(l),s=await f.batchFromMontgomery(s),d=await f.batchFromMontgomery(d),E.S1=await c.G1.multiExpAffine(I,l,i,"multiexp S1"),globalThis.gc&&globalThis.gc();E.S2=await c.G1.multiExpAffine(I,s,i,"multiexp S2"),globalThis.gc&&globalThis.gc();E.S3=await c.G1.multiExpAffine(I,d,i,"multiexp S3"),globalThis.gc&&globalThis.gc();function u(t,e){let i;void 0===o[t]?n[t]=e:a.set(o[t],e*h),i=e<y?r:e<2*y?f.mul(r,F):f.mul(r,x),o[t]=i}}(12,"sigma"),globalThis.gc&&globalThis.gc(),await async function(t,e){await za(A,t);const a=Math.max(w,1);for(let t=0;t<a;t++){let o=new Pe(y*h);o.set(f.one,t*h),await G(o),i&&i.debug(`writing ${e} ${t}/${a}`)}await Qa(A)}(13,"lagrange polynomials"),globalThis.gc&&globalThis.gc(),await za(A,14);const B=new Pe((y+6)*u);return await o.readToBuffer(B,0,(y+6)*u,n[2][0].p),await A.write(B),await Qa(A),globalThis.gc&&globalThis.gc(),await async function(){await za(A,1),await A.writeULE32(2),await Qa(A),await za(A,2);const t=c.q,e=8*(Math.floor((ha.bitLength(t)-1)/64)+1),a=c.r,i=8*(Math.floor((ha.bitLength(a)-1)/64)+1);let r;await A.writeULE32(e),await Ta(A,t,e),await A.writeULE32(i),await Ta(A,a,i),await A.writeULE32(L),await A.writeULE32(w),await A.writeULE32(y),await A.writeULE32(m.length),await A.writeULE32(p.length),await A.write(F),await A.write(x),await A.write(g.toAffine(E.Qm)),await A.write(g.toAffine(E.Ql)),await A.write(g.toAffine(E.Qr)),await A.write(g.toAffine(E.Qo)),await A.write(g.toAffine(E.Qc)),await A.write(g.toAffine(E.S1)),await A.write(g.toAffine(E.S2)),await A.write(g.toAffine(E.S3)),r=await o.read(_,n[3][0].p+_),await A.write(r),await Qa(A)}(),await A.close(),await l.close(),await o.close(),void(i&&i.info("Setup Finished"));async function v(t,e,a){await za(A,t);for(let t=0;t<p.length;t++)await A.writeULE32(p[t][e]),i&&t%1e6==0&&i.debug(`writing ${a}: ${t}/${p.length}`);await Qa(A)}async function S(t,e,a){let o=new Pe(y*h);for(let t=0;t<p.length;t++)o.set(p[t][e],t*h),i&&t%1e6==0&&i.debug(`writing ${a}: ${t}/${p.length}`);await za(A,t),await G(o),await Qa(A),o=await f.batchFromMontgomery(o),E[a]=await c.G1.multiExpAffine(I,o,i,"multiexp "+a)}async function G(t){const e=await f.ifft(t),a=new Pe(y*h*4);a.set(e,0);const i=await f.fft(a);await A.write(e),await A.write(i)}},fullProve:async function(t,e,a,i){const o=bn(t),n={type:"mem"};return await wo(o,e,n),await An(a,n,i)},prove:An,verify:async function(t,e,a,i){let o=yn(t),n=yn(a),c=yn(e);const r=await Ha(o.curve),l=r.Fr,s=r.G1;if(n=function(t,e){const a=t.G1,i=t.Fr,o={};return o.A=a.fromObject(e.A),o.B=a.fromObject(e.B),o.C=a.fromObject(e.C),o.Z=a.fromObject(e.Z),o.T1=a.fromObject(e.T1),o.T2=a.fromObject(e.T2),o.T3=a.fromObject(e.T3),o.eval_a=i.fromObject(e.eval_a),o.eval_b=i.fromObject(e.eval_b),o.eval_c=i.fromObject(e.eval_c),o.eval_zw=i.fromObject(e.eval_zw),o.eval_s1=i.fromObject(e.eval_s1),o.eval_s2=i.fromObject(e.eval_s2),o.eval_r=i.fromObject(e.eval_r),o.Wxi=a.fromObject(e.Wxi),o.Wxiw=a.fromObject(e.Wxiw),o}(r,n),o=function(t,e){const a=t.G1,i=t.G2,o=t.Fr,n=e;return n.Qm=a.fromObject(e.Qm),n.Ql=a.fromObject(e.Ql),n.Qr=a.fromObject(e.Qr),n.Qo=a.fromObject(e.Qo),n.Qc=a.fromObject(e.Qc),n.S1=a.fromObject(e.S1),n.S2=a.fromObject(e.S2),n.S3=a.fromObject(e.S3),n.k1=o.fromObject(e.k1),n.k2=o.fromObject(e.k2),n.X_2=i.fromObject(e.X_2),n}(r,o),!function(t,e){const a=t.G1;return!!a.isValid(e.A)&&(!!a.isValid(e.B)&&(!!a.isValid(e.C)&&(!!a.isValid(e.Z)&&(!!a.isValid(e.T1)&&(!!a.isValid(e.T2)&&(!!a.isValid(e.T3)&&(!!a.isValid(e.Wxi)&&!!a.isValid(e.Wxiw))))))))}(r,n))return i.error("Proof is not well constructed"),!1;if(c.length!=o.nPublic)return i.error("Invalid number of public inputs"),!1;const d=function(t,e,a){const i=t.G1,o=t.Fr,n=t.Fr.n8,c={},r=new Uint8Array(a.length*n+2*i.F.n8*3);for(let t=0;t<a.length;t++)o.toRprBE(r,t*n,o.e(a[t]));i.toRprUncompressed(r,a.length*n+0,e.A),i.toRprUncompressed(r,a.length*n+2*i.F.n8,e.B),i.toRprUncompressed(r,a.length*n+4*i.F.n8,e.C),c.beta=Cn(t,r);const l=new Uint8Array(n);o.toRprBE(l,0,c.beta),c.gamma=Cn(t,l);const s=new Uint8Array(2*i.F.n8);i.toRprUncompressed(s,0,e.Z),c.alpha=Cn(t,s);const d=new Uint8Array(2*i.F.n8*3);i.toRprUncompressed(d,0,e.T1),i.toRprUncompressed(d,2*i.F.n8,e.T2),i.toRprUncompressed(d,4*i.F.n8,e.T3),c.xi=Cn(t,d);const u=new Uint8Array(7*n);o.toRprBE(u,0,e.eval_a),o.toRprBE(u,n,e.eval_b),o.toRprBE(u,2*n,e.eval_c),o.toRprBE(u,3*n,e.eval_s1),o.toRprBE(u,4*n,e.eval_s2),o.toRprBE(u,5*n,e.eval_zw),o.toRprBE(u,6*n,e.eval_r),c.v=[],c.v[1]=Cn(t,u);for(let t=2;t<=6;t++)c.v[t]=o.mul(c.v[t-1],c.v[1]);const g=new Uint8Array(2*i.F.n8*2);return i.toRprUncompressed(g,0,e.Wxi),i.toRprUncompressed(g,2*i.F.n8,e.Wxiw),c.u=Cn(t,g),c}(r,n,c);i&&(i.debug("beta: "+l.toString(d.beta,16)),i.debug("gamma: "+l.toString(d.gamma,16)),i.debug("alpha: "+l.toString(d.alpha,16)),i.debug("xi: "+l.toString(d.xi,16)),i.debug("v1: "+l.toString(d.v[1],16)),i.debug("v6: "+l.toString(d.v[6],16)),i.debug("u: "+l.toString(d.u,16)));const u=function(t,e,a){const i=t.Fr;let o=e.xi,n=1;for(let t=0;t<a.power;t++)o=i.square(o),n*=2;e.xin=o,e.zh=i.sub(o,i.one);const c=[],r=i.e(n);let l=i.one;for(let t=1;t<=Math.max(1,a.nPublic);t++)c[t]=i.div(i.mul(l,e.zh),i.mul(r,i.sub(e.xi,l))),l=i.mul(l,i.w[a.power]);return c}(r,d,o);if(i){i.debug("Lagrange Evaluations: ");for(let t=1;t<u.length;t++)i.debug(`L${t}(xi)=`+l.toString(u[t],16))}if(c.length!=o.nPublic)return i.error("Number of public signals does not match with vk"),!1;const g=function(t,e,a){const i=t.Fr;let o=i.zero;for(let t=0;t<e.length;t++){const n=i.e(e[t]);o=i.sub(o,i.mul(n,a[t+1]))}return o}(r,c,u);i&&i.debug("Pl: "+l.toString(g,16));const _=function(t,e,a,i,o){const n=t.Fr;let c=e.eval_r;c=n.add(c,i);let r=e.eval_a;r=n.add(r,n.mul(a.beta,e.eval_s1)),r=n.add(r,a.gamma);let l=e.eval_b;l=n.add(l,n.mul(a.beta,e.eval_s2)),l=n.add(l,a.gamma);let s=e.eval_c;s=n.add(s,a.gamma);let d=n.mul(n.mul(r,l),s);d=n.mul(d,e.eval_zw),d=n.mul(d,a.alpha),c=n.sub(c,d),c=n.sub(c,n.mul(o,n.square(a.alpha)));return n.div(c,a.zh)}(r,n,d,g,u[1]);i&&i.debug("t: "+l.toString(_,16));const f=function(t,e,a,i,o){const n=t.G1,c=t.Fr;let r=c.mul(c.mul(e.eval_a,e.eval_b),a.v[1]),l=n.timesFr(i.Qm,r),s=c.mul(e.eval_a,a.v[1]);l=n.add(l,n.timesFr(i.Ql,s));let d=c.mul(e.eval_b,a.v[1]);l=n.add(l,n.timesFr(i.Qr,d));let u=c.mul(e.eval_c,a.v[1]);l=n.add(l,n.timesFr(i.Qo,u)),l=n.add(l,n.timesFr(i.Qc,a.v[1]));const g=c.mul(a.beta,a.xi);let _=e.eval_a;_=c.add(_,g),_=c.add(_,a.gamma);let f=e.eval_b;f=c.add(f,c.mul(g,i.k1)),f=c.add(f,a.gamma);let h=e.eval_c;h=c.add(h,c.mul(g,i.k2)),h=c.add(h,a.gamma);let p=c.mul(c.mul(_,f),h);p=c.mul(p,c.mul(a.alpha,a.v[1]));let m=c.mul(c.mul(o,c.square(a.alpha)),a.v[1]);p=c.add(p,m),p=c.add(p,a.u),l=n.add(l,n.timesFr(e.Z,p));let L=e.eval_a;L=c.add(L,c.mul(a.beta,e.eval_s1)),L=c.add(L,a.gamma);let w=e.eval_b;w=c.add(w,c.mul(a.beta,e.eval_s2)),w=c.add(w,a.gamma);let A=c.mul(L,w);return A=c.mul(A,a.alpha),A=c.mul(A,a.v[1]),A=c.mul(A,a.beta),A=c.mul(A,e.eval_zw),l=n.sub(l,n.timesFr(i.S3,A)),l}(r,n,d,o,u[1]);i&&i.debug("D: "+s.toString(s.toAffine(f),16));const h=function(t,e,a,i,o){const n=t.G1,c=t.Fr;let r=e.T1;return r=n.add(r,n.timesFr(e.T2,a.xin)),r=n.add(r,n.timesFr(e.T3,c.square(a.xin))),r=n.add(r,o),r=n.add(r,n.timesFr(e.A,a.v[2])),r=n.add(r,n.timesFr(e.B,a.v[3])),r=n.add(r,n.timesFr(e.C,a.v[4])),r=n.add(r,n.timesFr(i.S1,a.v[5])),r=n.add(r,n.timesFr(i.S2,a.v[6])),r}(r,n,d,o,f);i&&i.debug("F: "+s.toString(s.toAffine(h),16));const p=function(t,e,a,i,o){const n=t.G1,c=t.Fr;let r=o;r=c.add(r,c.mul(a.v[1],e.eval_r)),r=c.add(r,c.mul(a.v[2],e.eval_a)),r=c.add(r,c.mul(a.v[3],e.eval_b)),r=c.add(r,c.mul(a.v[4],e.eval_c)),r=c.add(r,c.mul(a.v[5],e.eval_s1)),r=c.add(r,c.mul(a.v[6],e.eval_s2)),r=c.add(r,c.mul(a.u,e.eval_zw));return n.timesFr(n.one,r)}(r,n,d,0,_);i&&i.debug("E: "+s.toString(s.toAffine(p),16));const m=await async function(t,e,a,i,o,n){const c=t.G1,r=t.Fr;let l=e.Wxi;l=c.add(l,c.timesFr(e.Wxiw,a.u));let s=c.timesFr(e.Wxi,a.xi);const d=r.mul(r.mul(a.u,a.xi),r.w[i.power]);s=c.add(s,c.timesFr(e.Wxiw,d)),s=c.add(s,n),s=c.sub(s,o);return await t.pairingEq(c.neg(l),i.X_2,s,t.G2.one)}(r,n,d,o,p,h);return i&&(m?i.info("OK!"):i.warn("Invalid Proof")),m},exportSolidityCallData:async function(t,e){const a=Fn(t),i=Fn(e),o=await Ha(a.curve),n=o.G1,c=o.Fr;let r="";for(let t=0;t<i.length;t++)""!=r&&(r+=","),r+=En(i[t]);const l=new Uint8Array(2*n.F.n8*9+7*c.n8);return n.toRprUncompressed(l,0,n.e(a.A)),n.toRprUncompressed(l,2*n.F.n8,n.e(a.B)),n.toRprUncompressed(l,4*n.F.n8,n.e(a.C)),n.toRprUncompressed(l,6*n.F.n8,n.e(a.Z)),n.toRprUncompressed(l,8*n.F.n8,n.e(a.T1)),n.toRprUncompressed(l,10*n.F.n8,n.e(a.T2)),n.toRprUncompressed(l,12*n.F.n8,n.e(a.T3)),n.toRprUncompressed(l,14*n.F.n8,n.e(a.Wxi)),n.toRprUncompressed(l,16*n.F.n8,n.e(a.Wxiw)),c.toRprBE(l,18*n.F.n8,c.e(a.eval_a)),c.toRprBE(l,18*n.F.n8+c.n8,c.e(a.eval_b)),c.toRprBE(l,18*n.F.n8+2*c.n8,c.e(a.eval_c)),c.toRprBE(l,18*n.F.n8+3*c.n8,c.e(a.eval_s1)),c.toRprBE(l,18*n.F.n8+4*c.n8,c.e(a.eval_s2)),c.toRprBE(l,18*n.F.n8+5*c.n8,c.e(a.eval_zw)),c.toRprBE(l,18*n.F.n8+6*c.n8,c.e(a.eval_r)),"0x"+Array.from(l).map(xn).join("")+",["+r+"]"}});return t.groth16=Co,t.plonk=Bn,t.powersOfTau=No,t.r1cs=Xo,t.wtns=an,t.zKey=fn,Object.defineProperty(t,"__esModule",{value:!0}),t}({});',Sh=`<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf8" />
    <title>zkREPL Demo App</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
                sans-serif;
        }
        .main {
            padding: 20px;
            margin: 0 auto;
            max-width: 500px;
        }

        .banner {
            background: linear-gradient(#673ab7, #344395);
            color: white;
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            text-align: center;
        }

        #proofData {
            width: 100%;
            height: 150px;
            display: block;
            margin-bottom: 10px;
            padding: 10px;
        }

        #publicSignals {
            width: 100%;
            height: 50px;
            display: block;
            margin-bottom: 10px;
            padding: 10px;
        }
        button {
            display: block;
            width: 100%;
            background: #ef8e00;
            border: 0;
            color: white;
            padding: 10px;
            border-radius: 10px;
            font-weight: bold;
            font-size: inherit;
            cursor: pointer;
        }
        button[disabled] {
            opacity: 0.5;
            cursor: wait;
        }
        #result {
            margin-top: 10px;
        }
        #inputs {
            width:  100%;
        }
        #inputs textarea, #inputs input {
            width:  100%;
        }
    </style>
</head>
<body>
    <div class="banner">
        This is a demo application automatically generated by zkREPL.
    </div>
    <div class="main">
        <h4>Inputs</h4>
        <table id="inputs"></table>

        <h4>Proof</h4>

        <button onclick="calculateProof()" id="proofbutton">
            Generate Proof
        </button>

        <div id="proof"></div>
        <h4>Verify</h4>
        <textarea
            id="proofData"
            placeholder="Click 'Generate Proof' to generate a proof"
        ></textarea>

        <textarea placeholder="Public signals..." id="publicSignals"></textarea>
        <button onclick="verifyProof()" id="verifybutton">Verify Proof</button>

        <div id="result"></div>

        <h4>Audit</h4>

        <p>
            Click the "Verify" button on <a href="{{ZKREPL_URL}}">zkREPL</a>
            to confirm that the current proving key matches the source code for
            the claimed circuit
        </p>
        <button onclick="downloadZKey()">Download ZKey</button>
    </div>

    <script>
        const INPUT_JSON = "{{INPUT_JSON}}"
    <\/script>

    <script>
        for (let key in INPUT_JSON) {
            const tr = document.createElement("tr")
            const label = document.createElement("td")
            const field = document.createElement("td")
            label.appendChild(document.createTextNode(key + ":"))

            if (Array.isArray(INPUT_JSON[key])) {
                const input = document.createElement("textarea")
                input.id = "input_" + key
                input.value = JSON.stringify(INPUT_JSON[key])
                field.appendChild(input)
            } else {
                const input = document.createElement("input")
                input.type = "number"
                input.id = "input_" + key
                input.value = INPUT_JSON[key]
                field.appendChild(input)
            }

            tr.appendChild(label)
            tr.appendChild(field)
            document.getElementById("inputs").appendChild(tr)
        }

        async function calculateProof() {
            document.getElementById("proofbutton").disabled = true
            try {
                const input_obj = {}

                for (let key in INPUT_JSON) {
                    if (Array.isArray(INPUT_JSON[key])) {
                        input_obj[key] = JSON.parse(
                            document.getElementById("input_" + key).value
                        )
                    } else {
                        input_obj[key] = document.getElementById(
                            "input_" + key
                        ).value
                    }
                }
                const prover =
                    VKEY_DATA.protocol === "groth16"
                        ? snarkjs.groth16
                        : snarkjs.plonk
                const { proof, publicSignals } = await prover.fullProve(
                    input_obj,
                    WASM_URL,
                    ZKEY_DATA
                )

                document.getElementById("proofData").value =
                    JSON.stringify(proof)
                document.getElementById("publicSignals").value =
                    JSON.stringify(publicSignals)
            } catch (err) {
                document.getElementById("proofData").value = err
            }
            document.getElementById("proofbutton").disabled = false
        }

        async function verifyProof() {
            document.getElementById("verifybutton").disabled = true
            document.getElementById("result").innerHTML =
                "\u231B\uFE0F Checking proof..."
            await new Promise((resolve) => setTimeout(resolve, 50))
            try {
                const publicSignals = JSON.parse(
                    document.getElementById("publicSignals").value
                )
                const proof = JSON.parse(
                    document.getElementById("proofData").value
                )
                const prover =
                    VKEY_DATA.protocol === "groth16"
                        ? snarkjs.groth16
                        : snarkjs.plonk
                const res = await prover.verify(VKEY_DATA, publicSignals, proof)
                document.getElementById("result").innerHTML = res
                    ? "\u2705 Proof is valid"
                    : "\u274C Proof is invalid"
            } catch (err) {
                document.getElementById("result").innerHTML =
                    "\u274C Error while verifying proof"
            }
            document.getElementById("verifybutton").disabled = false
        }

        async function downloadZKey() {
            const a = document.createElement("a")
            a.href = ZKEY_DATA
            a.download = "main.zkey"
            a.click()
        }
    <\/script>
    <script>
        const VKEY_DATA = "{{VKEY_DATA}}"
    <\/script>
    <script>
        /*{{SNARK_JS}}*/
    <\/script>
    <script>
        const ZKEY_DATA = "{{ZKEY_DATA}}"
    <\/script>

    <script>
        const WASM_URL = "{{WASM_URL}}"
    <\/script>
</body>
`;Zt.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),Zt.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const Fh=Zt.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),vh=Zt.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function mn(e){let t;if(Zt.eq(e,vh))t=await Tl();else if(Zt.eq(e,Fh))t=await Pl();else throw new Error(`Curve not supported: ${Zt.toString(e)}`);return t}var oe={exports:{}},Bh=Vl;class Kl extends Error{}Kl.prototype.name="AssertionError";function Vl(e,t){if(!e){var n=new Kl(t);throw Error.captureStackTrace&&Error.captureStackTrace(n,Vl),n}}function jl(e){return e.length}function xh(e){const t=e.byteLength;let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}function Th(e,t,n=0,i=jl(t)){const a=Math.min(i,e.byteLength-n);for(let o=0;o<a;o++)e[n+o]=t.charCodeAt(o);return a}var Ph={byteLength:jl,toString:xh,write:Th};const ri="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rn=new Uint8Array(256);for(let e=0;e<ri.length;e++)Rn[ri.charCodeAt(e)]=e;Rn[45]=62,Rn[95]=63;function Yl(e){let t=e.length;return e.charCodeAt(t-1)===61&&t--,t>1&&e.charCodeAt(t-1)===61&&t--,t*3>>>2}function Oh(e){const t=e.byteLength;let n="";for(let i=0;i<t;i+=3)n+=ri[e[i]>>2]+ri[(e[i]&3)<<4|e[i+1]>>4]+ri[(e[i+1]&15)<<2|e[i+2]>>6]+ri[e[i+2]&63];return t%3===2?n=n.substring(0,n.length-1)+"=":t%3===1&&(n=n.substring(0,n.length-2)+"=="),n}function Rh(e,t,n=0,i=Yl(t)){const a=Math.min(i,e.byteLength-n);for(let o=0,s=0;o<a;o+=4){const d=Rn[t.charCodeAt(o)],h=Rn[t.charCodeAt(o+1)],f=Rn[t.charCodeAt(o+2)],l=Rn[t.charCodeAt(o+3)];e[s++]=d<<2|h>>4,e[s++]=(h&15)<<4|f>>2,e[s++]=(f&3)<<6|l&63}return a}var Uh={byteLength:Yl,toString:Oh,write:Rh};function $l(e){return e.length>>>1}function Gh(e){const t=e.byteLength;e=new DataView(e.buffer,e.byteOffset,t);let n="",i=0;for(let a=t-t%4;i<a;i+=4)n+=e.getUint32(i).toString(16).padStart(8,"0");for(;i<t;i++)n+=e.getUint8(i).toString(16).padStart(2,"0");return n}function Mh(e,t,n=0,i=$l(t)){const a=Math.min(i,e.byteLength-n);for(let o=0;o<a;o++){const s=Zl(t.charCodeAt(o*2)),d=Zl(t.charCodeAt(o*2+1));if(s===void 0||d===void 0)return e.subarray(0,o);e[n+o]=s<<4|d}return a}var Dh={byteLength:$l,toString:Gh,write:Mh};function Zl(e){if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-65+10;if(e>=97&&e<=102)return e-97+10}function nr(e){let t=0;for(let n=0,i=e.length;n<i;n++){const a=e.charCodeAt(n);if(a>=55296&&a<=56319&&n+1<i){const o=e.charCodeAt(n+1);if(o>=56320&&o<=57343){t+=4,n++;continue}}a<=127?t+=1:a<=2047?t+=2:t+=3}return t}let ir;if(typeof TextDecoder<"u"){const e=new TextDecoder;ir=function(n){return e.decode(n)}}else ir=function(t){const n=t.byteLength;let i="",a=0;for(;a<n;){let o=t[a];if(o<=127){i+=String.fromCharCode(o),a++;continue}let s=0,d=0;if(o<=223?(s=1,d=o&31):o<=239?(s=2,d=o&15):o<=244&&(s=3,d=o&7),n-a-s>0){let h=0;for(;h<s;)o=t[a+h+1],d=d<<6|o&63,h+=1}else d=65533,s=n-a;i+=String.fromCodePoint(d),a+=s+1}return i};let ar;if(typeof TextEncoder<"u"){const e=new TextEncoder;ar=function(n,i,a=0,o=nr(i)){const s=Math.min(o,n.byteLength-a);return e.encodeInto(i,n.subarray(a,a+s)),s}}else ar=function(t,n,i=0,a=nr(n)){const o=Math.min(a,t.byteLength-i);t=t.subarray(i,i+o);let s=0,d=0;for(;s<n.length;){const h=n.codePointAt(s);if(h<=127){t[d++]=h,s++;continue}let f=0,l=0;for(h<=2047?(f=6,l=192):h<=65535?(f=12,l=224):h<=2097151&&(f=18,l=240),t[d++]=l|h>>f,f-=6;f>=0;)t[d++]=128|h>>f&63,f-=6;s+=h>=65536?2:1}return o};var Nh={byteLength:nr,toString:ir,write:ar};function Jl(e){return e.length*2}function kh(e){const t=e.byteLength;let n="";for(let i=0;i<t-1;i+=2)n+=String.fromCharCode(e[i]+e[i+1]*256);return n}function zh(e,t,n=0,i=Jl(t)){const a=Math.min(i,e.byteLength-n);let o=a;for(let s=0;s<t.length&&!((o-=2)<0);++s){const d=t.charCodeAt(s),h=d>>8,f=d%256;e[n+s*2]=f,e[n+s*2+1]=h}return a}var qh={byteLength:Jl,toString:kh,write:zh};const Qh=Ph,Hh=Uh,Wh=Dh,Kh=Nh,Vh=qh,ya=new Uint8Array(Uint16Array.of(255).buffer)[0]===255;function qi(e){switch(e){case"ascii":return Qh;case"base64":return Hh;case"hex":return Wh;case"utf8":case"utf-8":case void 0:return Kh;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Vh;default:throw new Error(`Unknown encoding: ${e}`)}}function Xl(e){return e instanceof Uint8Array}function jh(e){try{return qi(e),!0}catch{return!1}}function Yh(e,t,n){const i=new Uint8Array(e);return t!==void 0&&t(i,t,0,i.byteLength,n),i}function $h(e){return new Uint8Array(e)}function Zh(e){return new Uint8Array(e)}function Jh(e,t){return qi(t).byteLength(e)}function Xh(e,t){if(e===t)return 0;const n=Math.min(e.byteLength,t.byteLength);e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let i=0;for(let a=n-n%4;i<a;i+=4){const o=e.getUint32(i,ya),s=t.getUint32(i,ya);if(o!==s)break}for(;i<n;i++){const a=e.getUint8(i),o=t.getUint8(i);if(a<o)return-1;if(a>o)return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}function tg(e,t){t===void 0&&(t=e.reduce((i,a)=>i+a.byteLength,0));const n=new Uint8Array(t);return e.reduce((i,a)=>(n.set(a,i),i+a.byteLength),0),n}function eg(e,t,n=0,i=0,a=e.byteLength){if(a>0&&a<i||a===i||e.byteLength===0||t.byteLength===0)return 0;if(n<0)throw new RangeError("targetStart is out of range");if(i<0||i>=e.byteLength)throw new RangeError("sourceStart is out of range");if(a<0)throw new RangeError("sourceEnd is out of range");n>=t.byteLength&&(n=t.byteLength),a>e.byteLength&&(a=e.byteLength),t.byteLength-n<a-i&&(a=t.length-n+i);const o=a-i;return e===t?t.copyWithin(n,i,a):t.set(e.subarray(i,a),n),o}function ng(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const n=e.byteLength;e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let i=0;for(let a=n-n%4;i<a;i+=4)if(e.getUint32(i,ya)!==t.getUint32(i,ya))return!1;for(;i<n;i++)if(e.getUint8(i)!==t.getUint8(i))return!1;return!0}function ig(e,t,n,i,a){if(typeof t=="string"?typeof n=="string"?(a=n,n=0,i=e.byteLength):typeof i=="string"&&(a=i,i=e.byteLength):typeof val=="number"?t=t&255:typeof val=="boolean"&&(t=+t),n<0||e.byteLength<n||e.byteLength<i)throw new RangeError("Out of range index");if(n===void 0&&(n=0),i===void 0&&(i=e.byteLength),i<=n)return e;if(t||(t=0),typeof t=="number")for(let o=n;o<i;++o)e[o]=t;else{t=Xl(t)?t:or(t,a);const o=t.byteLength;for(let s=0;s<i-n;++s)e[s+n]=t[s%o]}return e}function or(e,t,n){return typeof e=="string"?ag(e,t):Array.isArray(e)?og(e):ArrayBuffer.isView(e)?rg(e):sg(e,t,n)}function ag(e,t){const n=qi(t),i=new Uint8Array(n.byteLength(e));return n.write(i,e,0,i.byteLength),i}function og(e){const t=new Uint8Array(e.length);return t.set(e),t}function rg(e){const t=new Uint8Array(e.byteLength);return t.set(e),t}function sg(e,t,n){return new Uint8Array(e,t,n)}function cg(e,t,n,i){return ed(e,t,n,i)!==-1}function td(e,t,n,i,a){if(e.byteLength===0)return-1;if(typeof n=="string"?(i=n,n=0):n===void 0?n=a?0:e.length-1:n<0&&(n+=e.byteLength),n>=e.byteLength){if(a)return-1;n=e.byteLength-1}else if(n<0)if(a)n=0;else return-1;if(typeof t=="string")t=or(t,i);else if(typeof t=="number")return t=t&255,a?e.indexOf(t,n):e.lastIndexOf(t,n);if(t.byteLength===0)return-1;if(a){let o=-1;for(let s=n;s<e.byteLength;s++)if(e[s]===t[o===-1?0:s-o]){if(o===-1&&(o=s),s-o+1===t.byteLength)return o}else o!==-1&&(s-=s-o),o=-1}else{n+t.byteLength>e.byteLength&&(n=e.byteLength-t.byteLength);for(let o=n;o>=0;o--){let s=!0;for(let d=0;d<t.byteLength;d++)if(e[o+d]!==t[d]){s=!1;break}if(s)return o}}return-1}function ed(e,t,n,i){return td(e,t,n,i,!0)}function lg(e,t,n,i){return td(e,t,n,i,!1)}function Un(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function dg(e){const t=e.byteLength;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<t;n+=2)Un(e,n,n+1);return e}function ug(e){const t=e.byteLength;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<t;n+=4)Un(e,n,n+3),Un(e,n+1,n+2);return e}function fg(e){const t=e.byteLength;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<t;n+=8)Un(e,n,n+7),Un(e,n+1,n+6),Un(e,n+2,n+5),Un(e,n+3,n+4);return e}function _g(e){return e}function hg(e,t,n=0,i=e.byteLength){const a=e.byteLength;return n>=a||i<=n?"":(n<0&&(n=0),i>a&&(i=a),(n!==0||i<a)&&(e=e.subarray(n,i)),qi(t).toString(e))}function gg(e,t,n,i,a){return n===void 0?a="utf8":i===void 0&&typeof n=="string"?(a=n,n=void 0):a===void 0&&typeof i=="string"&&(a=i,i=void 0),qi(a).write(e,t,n,i)}function pg(e,t,n){return n===void 0&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t,!0),n+8}function mg(e,t,n){return n===void 0&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t,!0),n+4}function Lg(e,t,n){return n===void 0&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(n,t,!0),n+4}function Ag(e,t,n){return n===void 0&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(n,t,!0),n+4}function yg(e,t){return t===void 0&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)}function wg(e,t){return t===void 0&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)}function Ig(e,t){return t===void 0&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(t,!0)}function Eg(e,t){return t===void 0&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t,!0)}var bg={isBuffer:Xl,isEncoding:jh,alloc:Yh,allocUnsafe:$h,allocUnsafeSlow:Zh,byteLength:Jh,compare:Xh,concat:tg,copy:eg,equals:ng,fill:ig,from:or,includes:cg,indexOf:ed,lastIndexOf:lg,swap16:dg,swap32:ug,swap64:fg,toBuffer:_g,toString:hg,write:gg,writeDoubleLE:pg,writeFloatLE:mg,writeUInt32LE:Lg,writeInt32LE:Ag,readDoubleLE:yg,readFloatLE:wg,readUInt32LE:Ig,readInt32LE:Eg},rr,nd;function Cg(){if(nd)return rr;nd=1;var e=(o,s)=>function(){return s||(0,o[Object.keys(o)[0]])((s={exports:{}}).exports,s),s.exports},t=(()=>{for(var o=new Uint8Array(128),s=0;s<64;s++)o[s<26?s+65:s<52?s+71:s<62?s-4:s*4-205]=s;return d=>{for(var h=d.length,f=new Uint8Array((h-(d[h-1]=="=")-(d[h-2]=="="))*3/4|0),l=0,m=0;l<h;){var I=o[d.charCodeAt(l++)],g=o[d.charCodeAt(l++)],B=o[d.charCodeAt(l++)],P=o[d.charCodeAt(l++)];f[m++]=I<<2|g>>4,f[m++]=g<<4|B>>2,f[m++]=B<<6|P}return f}})(),n=e({"wasm-binary:./blake2b.wat"(o,s){s.exports=t("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}}),i=n(),a=WebAssembly.compile(i);return rr=async o=>(await WebAssembly.instantiate(await a,o)).exports,rr}var Te=Bh,Sg=bg,rn=null,id=typeof WebAssembly<"u"&&Cg()().then(e=>{rn=e}),sn=64,wa=[];oe.exports=Ie;var ad=oe.exports.BYTES_MIN=16,od=oe.exports.BYTES_MAX=64;oe.exports.BYTES=32;var rd=oe.exports.KEYBYTES_MIN=16,sd=oe.exports.KEYBYTES_MAX=64;oe.exports.KEYBYTES=32;var cd=oe.exports.SALTBYTES=16,ld=oe.exports.PERSONALBYTES=16;function Ie(e,t,n,i,a){if(!(this instanceof Ie))return new Ie(e,t,n,i,a);if(!rn)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");e||(e=32),a!==!0&&(Te(e>=ad,"digestLength must be at least "+ad+", was given "+e),Te(e<=od,"digestLength must be at most "+od+", was given "+e),t!=null&&(Te(t instanceof Uint8Array,"key must be Uint8Array or Buffer"),Te(t.length>=rd,"key must be at least "+rd+", was given "+t.length),Te(t.length<=sd,"key must be at least "+sd+", was given "+t.length)),n!=null&&(Te(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),Te(n.length===cd,"salt must be exactly "+cd+", was given "+n.length)),i!=null&&(Te(i instanceof Uint8Array,"personal must be Uint8Array or Buffer"),Te(i.length===ld,"personal must be exactly "+ld+", was given "+i.length))),wa.length||(wa.push(sn),sn+=216),this.digestLength=e,this.finalized=!1,this.pointer=wa.pop(),this._memory=new Uint8Array(rn.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=t?t.length:0,this._memory[2]=1,this._memory[3]=1,n&&this._memory.set(n,32),i&&this._memory.set(i,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),rn.blake2b_init(this.pointer,this.digestLength),t&&(this.update(t),this._memory.fill(0,sn,sn+t.length),this._memory[this.pointer+200]=128)}Ie.prototype._realloc=function(e){rn.memory.grow(Math.max(0,Math.ceil(Math.abs(e-this._memory.length)/65536))),this._memory=new Uint8Array(rn.memory.buffer)},Ie.prototype.update=function(e){return Te(this.finalized===!1,"Hash instance finalized"),Te(e instanceof Uint8Array,"input must be Uint8Array or Buffer"),sn+e.length>this._memory.length&&this._realloc(sn+e.length),this._memory.set(e,sn),rn.blake2b_update(this.pointer,sn,sn+e.length),this},Ie.prototype.digest=function(e){if(Te(this.finalized===!1,"Hash instance finalized"),this.finalized=!0,wa.push(this.pointer),rn.blake2b_final(this.pointer),!e||e==="binary")return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if(typeof e=="string")return Sg.toString(this._memory,e,this.pointer+128,this.pointer+128+this.digestLength);Te(e instanceof Uint8Array&&e.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var t=0;t<this.digestLength;t++)e[t]=this._memory[this.pointer+128+t];return e},Ie.prototype.final=Ie.prototype.digest,Ie.WASM=rn,Ie.SUPPORTED=typeof WebAssembly<"u",Ie.ready=function(e){return e||(e=Fg),id?id.then(()=>e(),e):e(new Error("WebAssembly not supported"))},Ie.prototype.ready=Ie.ready,Ie.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},Ie.prototype.setPartialHash=function(e){this._memory.set(e,this.pointer)};function Fg(){}function Ia(e){return((e&4294901760)!==0?(e&=4294901760,16):0)|((e&4278255360)!==0?(e&=4278255360,8):0)|((e&4042322160)!==0?(e&=4042322160,4):0)|((e&3435973836)!==0?(e&=3435973836,2):0)|(e&2863311530)!==0}function Qi(e,t){const n=new DataView(e.buffer,e.byteOffset,e.byteLength);let i="";for(let a=0;a<4;a++){a>0&&(i+=`
`),i+="		";for(let o=0;o<4;o++)o>0&&(i+=" "),i+=n.getUint32(a*16+o*4).toString(16).padStart(8,"0")}return t&&(i=t+`
`+i),i}function dd(e,t){if(e.byteLength!=t.byteLength)return!1;for(var n=new Int8Array(e),i=new Int8Array(t),a=0;a!=e.byteLength;a++)if(n[a]!=i[a])return!1;return!0}function vg(e){const t=e.getPartialHash(),n=oe.exports(64);return n.setPartialHash(t),n}async function Bg(e,t,n,i,a){return e.G1.isZero(t)||e.G1.isZero(n)||e.G2.isZero(i)||e.G2.isZero(a)?!1:await e.pairingEq(t,a,e.G1.neg(n),i)}function xg(){return window.prompt("Enter a random text. (Entropy): ","")}async function Tg(e){for(;!e;)e=await xg();const t=oe.exports(64);t.update(_a.randomBytes(64));const n=new TextEncoder;t.update(n.encode(e));const i=Buffer.from(t.digest()),a=[];for(let s=0;s<8;s++)a[s]=i.readUInt32BE(s*4);return new Pi(a)}function Pg(e,t){let n,i;t<32?(n=1<<t>>>0,i=1):(n=4294967296,i=1<<t-32>>>0);let a=e;for(let h=0;h<i;h++)for(let f=0;f<n;f++)a=_a.createHash("sha256").update(a).digest();const o=new DataView(a.buffer,a.byteOffset,a.byteLength),s=[];for(let h=0;h<8;h++)s[h]=o.getUint32(h*4,!1);return new Pi(s)}function Og(e){return Array.prototype.map.call(e,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}async function Rg(e,t){await se(e,1),await e.writeULE32(1),await ce(e);const n=await mn(t.q);await se(e,2);const i=n.q,a=(Math.floor((Zt.bitLength(i)-1)/64)+1)*8,o=n.r,s=(Math.floor((Zt.bitLength(o)-1)/64)+1)*8;await e.writeULE32(a),await oi(e,i,a),await e.writeULE32(s),await oi(e,o,s),await e.writeULE32(t.nVars),await e.writeULE32(t.nPublic),await e.writeULE32(t.domainSize),await si(e,n,t.vk_alpha_1),await si(e,n,t.vk_beta_1),await Ea(e,n,t.vk_beta_2),await Ea(e,n,t.vk_gamma_2),await si(e,n,t.vk_delta_1),await Ea(e,n,t.vk_delta_2),await ce(e)}async function si(e,t,n){const i=new Uint8Array(t.G1.F.n8*2);t.G1.toRprLEM(i,0,n),await e.write(i)}async function Ea(e,t,n){const i=new Uint8Array(t.G2.F.n8*2);t.G2.toRprLEM(i,0,n),await e.write(i)}async function Fe(e,t,n){const i=await e.read(t.G1.F.n8*2),a=t.G1.fromRprLEM(i,0);return n?t.G1.toObject(a):a}async function Hi(e,t,n){const i=await e.read(t.G2.F.n8*2),a=t.G2.fromRprLEM(i,0);return n?t.G2.toObject(a):a}async function ba(e,t,n){await ge(e,t,1);const i=await e.readULE32();if(await pe(e),i==1)return await Ug(e,t,n);if(i==2)return await Gg(e,t,n);throw new Error("Protocol not supported: ")}async function Ug(e,t,n){const i={};i.protocol="groth16",await ge(e,t,2);const a=await e.readULE32();i.n8q=a,i.q=await On(e,a);const o=await e.readULE32();return i.n8r=o,i.r=await On(e,o),i.curve=await mn(i.q),i.nVars=await e.readULE32(),i.nPublic=await e.readULE32(),i.domainSize=await e.readULE32(),i.power=Ia(i.domainSize),i.vk_alpha_1=await Fe(e,i.curve,n),i.vk_beta_1=await Fe(e,i.curve,n),i.vk_beta_2=await Hi(e,i.curve,n),i.vk_gamma_2=await Hi(e,i.curve,n),i.vk_delta_1=await Fe(e,i.curve,n),i.vk_delta_2=await Hi(e,i.curve,n),await pe(e),i}async function Gg(e,t,n){const i={};i.protocol="plonk",await ge(e,t,2);const a=await e.readULE32();i.n8q=a,i.q=await On(e,a);const o=await e.readULE32();return i.n8r=o,i.r=await On(e,o),i.curve=await mn(i.q),i.nVars=await e.readULE32(),i.nPublic=await e.readULE32(),i.domainSize=await e.readULE32(),i.power=Ia(i.domainSize),i.nAdditions=await e.readULE32(),i.nConstrains=await e.readULE32(),i.k1=await e.read(o),i.k2=await e.read(o),i.Qm=await Fe(e,i.curve,n),i.Ql=await Fe(e,i.curve,n),i.Qr=await Fe(e,i.curve,n),i.Qo=await Fe(e,i.curve,n),i.Qc=await Fe(e,i.curve,n),i.S1=await Fe(e,i.curve,n),i.S2=await Fe(e,i.curve,n),i.S3=await Fe(e,i.curve,n),i.X_2=await Hi(e,i.curve,n),await pe(e),i}async function Mg(e,t,n){const i={delta:{}};i.deltaAfter=await Fe(e,t,n),i.delta.g1_s=await Fe(e,t,n),i.delta.g1_sx=await Fe(e,t,n),i.delta.g2_spx=await Hi(e,t,n),i.transcript=await e.read(64),i.type=await e.readULE32();const a=await e.readULE32(),o=e.pos;let s=0;for(;e.pos-o<a;){const d=await e.read(1);if(d[0]<=s)throw new Error("Parameters in the contribution must be sorted");if(s=d[0],d[0]==1){const h=await e.read(1),f=await e.read(h[0]);i.name=new TextDecoder().decode(f)}else if(d[0]==2){const h=await e.read(1);i.numIterationsExp=h[0]}else if(d[0]==3){const h=await e.read(1);i.beaconHash=await e.read(h[0])}else throw new Error("Parameter not recognized")}if(e.pos!=o+a)throw new Error("Parametes do not match");return i}async function sr(e,t,n){await ge(e,n,10);const i={contributions:[]};i.csHash=await e.read(64);const a=await e.readULE32();for(let o=0;o<a;o++){const s=await Mg(e,t);i.contributions.push(s)}return await pe(e),i}async function Dg(e,t,n){await si(e,t,n.deltaAfter),await si(e,t,n.delta.g1_s),await si(e,t,n.delta.g1_sx),await Ea(e,t,n.delta.g2_spx),await e.write(n.transcript),await e.writeULE32(n.type||0);const i=[];if(n.name){i.push(1);const a=new TextEncoder("utf-8").encode(n.name.substring(0,64));i.push(a.byteLength);for(let o=0;o<a.byteLength;o++)i.push(a[o])}if(n.type==1){i.push(2),i.push(n.numIterationsExp),i.push(3),i.push(n.beaconHash.byteLength);for(let a=0;a<n.beaconHash.byteLength;a++)i.push(n.beaconHash[a])}if(i.length>0){const a=new Uint8Array(i);await e.writeULE32(a.byteLength),await e.write(a)}else await e.writeULE32(0)}async function Ng(e,t,n){await se(e,10),await e.write(n.csHash),await e.writeULE32(n.contributions.length);for(let i=0;i<n.contributions.length;i++)await Dg(e,t,n.contributions[i]);await ce(e)}function Gn(e,t,n){const i=new Uint8Array(t.G1.F.n8*2);t.G1.toRprUncompressed(i,0,n),e.update(i)}function kg(e,t,n){const i=new Uint8Array(t.G2.F.n8*2);t.G2.toRprUncompressed(i,0,n),e.update(i)}function Ca(e,t,n){Gn(e,t,n.deltaAfter),Gn(e,t,n.delta.g1_s),Gn(e,t,n.delta.g1_sx),kg(e,t,n.delta.g2_spx),e.update(n.transcript)}function ud(e,t){const n=new DataView(t.buffer,t.byteOffset,t.byteLength),i=[];for(let s=0;s<8;s++)i[s]=n.getUint32(s*4);const a=new Pi(i);return e.G2.fromRng(a)}async function fd(e,t){if(!t[1])throw new Error(e.fileName+": File has no  header");if(t[1].length>1)throw new Error(e.fileName+": File has more than one header");e.pos=t[1][0].p;const n=await e.readULE32(),i=await e.read(n),a=Zt.fromRprLE(i),o=await mn(a);if(o.F1.n64*8!=n)throw new Error(e.fileName+": Invalid size");const s=await e.readULE32(),d=await e.readULE32();if(e.pos-t[1][0].p!=t[1][0].size)throw new Error("Invalid PTau header size");return{curve:o,power:s,ceremonyPower:d}}async function _d(e,t,n,i,a,o,s,d,h,f){const m=a[o],I=m.F.n8*2,g=t[i][0].size/I;await ge(e,t,i),await se(n,i);let B=s;for(let P=0;P<g;P+=65536){f&&f.debug(`Applying key: ${h}: ${P}/${g}`);const C=Math.min(g-P,65536);let N;N=await e.read(C*I),N=await m.batchApplyKey(N,B,d),await n.write(N),B=a.Fr.mul(B,a.Fr.exp(d,C))}await ce(n),await pe(e)}const cr=4,lr=5;async function hd(e,t,n){let i;typeof n=="object"?i=n:typeof n>"u"?i={singleThread:!1}:i={singleThread:n};const a={};if(await ge(e,t,1),a.n8=await e.readULE32(),a.prime=await On(e,a.n8),i.F){if(i.F.p!=a.prime)throw new Error("Different Prime");a.F=i.F}else if(i.getFieldFromPrime)a.F=await i.getFieldFromPrime(a.prime,i.singleThread);else if(i.getCurveFromPrime)a.curve=await i.getCurveFromPrime(a.prime,i.singleThread),a.F=a.curve.Fr;else try{a.curve=await Ol(a.prime,i.singleThread),a.F=a.curve.Fr}catch{a.F=new Dc(a.prime)}return a.nVars=await e.readULE32(),a.nOutputs=await e.readULE32(),a.nPubInputs=await e.readULE32(),a.nPrvInputs=await e.readULE32(),a.nLabels=await e.readULE64(),a.nConstraints=await e.readULE32(),a.useCustomGates=typeof t[cr]<"u"&&t[cr]!==null&&typeof t[lr]<"u"&&t[lr]!==null,await pe(e),a}async function zg(e,t,n,i,a){let o;typeof i=="object"?o=i:typeof i>"u"?o={}:o={logger:i,loggerCtx:a};const s=await Me(e,t,2);let d=0,h;n.nConstraints>1<<20?h=new Aa:h=[];for(let m=0;m<n.nConstraints;m++){o.logger&&m%1e5==0&&o.logger.info(`${o.loggerCtx}: Loading constraints: ${m}/${n.nConstraints}`);const I=f();h.push(I)}return h;function f(){const m=[];return m[0]=l(),m[1]=l(),m[2]=l(),m}function l(){const m={},I=s.slice(d,d+4);d+=4;const B=new DataView(I.buffer).getUint32(0,!0),P=s.slice(d,d+(4+n.n8)*B);d+=(4+n.n8)*B;const C=new DataView(P.buffer);for(let N=0;N<B;N++){const T=C.getUint32(N*(4+n.n8),!0),K=n.F.fromRprLE(P,N*(4+n.n8)+4);m[T]=K}return m}}async function qg(e,t,n,i,a){let o;typeof i=="object"?o=i:typeof i>"u"?o={}:o={logger:i,loggerCtx:a};const s=await Me(e,t,3);let d=0,h;n.nVars>1<<20?h=new Aa:h=[];for(let l=0;l<n.nVars;l++){o.logger&&l%1e4==0&&o.logger.info(`${o.loggerCtx}: Loading map: ${l}/${n.nVars}`);const m=f();h.push(m)}return h;function f(){const l=s.slice(d,d+8);d+=8;const m=new DataView(l.buffer),I=m.getUint32(0,!0);return m.getUint32(4,!0)*4294967296+I}}async function Qg(e,t,n){if(typeof n!="object")throw new Error("readR1csFd: options must be an object");n.loadConstraints=n.loadConstraints||!0,n.loadMap=n.loadMap||!1,n.loadCustomGates=n.loadCustomGates||!0;const i=await hd(e,t,n);return n.loadConstraints&&(i.constraints=await zg(e,t,i,n)),n.loadMap&&(i.map=await qg(e,t,i,n)),n.loadCustomGates&&(i.useCustomGates?(i.customGates=await Hg(e,t,i.F.n8),i.customGatesUses=await Wg(e,t,n)):(i.customGates=[],i.customGatesUses=[])),i}async function Hg(e,t,n){await ge(e,t,cr);let i=await e.readULE32(),a=[];for(let o=0;o<i;o++){let s={};s.templateName=await e.readString();let d=await e.readULE32();s.parameters=Array(d);let h=await e.read(n*d);for(let f=0;f<d;f++)s.parameters[f]=h.slice(f*n,f*n+n);a.push(s)}return await pe(e),a}async function Wg(e,t,n){const i=await Me(e,t,lr),a=new Uint32Array(i.buffer,i.byteOffset,i.byteLength/4),o=a[0];let s=1,d;o>1<<20?d=new Aa:d=[];for(let h=0;h<o;h++){n.logger&&h%1e5==0&&n.logger.info(`${n.loggerCtx}: Loading custom gate uses: ${h}/${o}`);let f={};f.id=a[s++];let l=a[s++];f.signals=[];for(let m=0;m<l;m++)f.signals.push(a[s++]);d.push(f)}return d}Zt.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),Zt.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const je=262144,Kg={get:function(e,t){return isNaN(t)?e[t]:e.getElement(t)},set:function(e,t,n){return isNaN(t)?(e[t]=n,!0):e.setElement(t,n)}};class Vg{constructor(t){this.length=t||0,this.arr=new Array(je);for(let n=0;n<t;n+=je)this.arr[n/je]=new Array(Math.min(je,t-n));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,n){const i=new Array(n-t);for(let a=t;a<n;a++)i[a-t]=this.getElement(a);return i}getElement(t){t=parseInt(t);const n=Math.floor(t/je),i=t%je;return this.arr[n]?this.arr[n][i]:void 0}setElement(t,n){t=parseInt(t);const i=Math.floor(t/je);this.arr[i]||(this.arr[i]=new Array(je));const a=t%je;return this.arr[i][a]=n,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new Ye;for(let n=0;n<this.arr.length;n++)if(this.arr[n])for(let i=0;i<this.arr[n].length;i++)typeof this.arr[n][i]<"u"&&t.push(n*je+i);return t}}class Ye{constructor(t){const n=new Vg(t);return new Proxy(n,Kg)}}async function gd(e,t,n,i){await oe.exports.ready();const h=oe.exports(64),{fd:f,sections:l}=await xe(t,"ptau",1),{curve:m,power:I}=await fd(f,l),{fd:g,sections:B}=await xe(e,"r1cs",1),P=await hd(g,B,!1),C=await er(n,"zkey",1,10,1<<22,1<<24),N=m.G1.F.n8*2,T=m.G2.F.n8*2;if(P.prime!=m.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;const K=Ia(P.nConstraints+P.nPubInputs+P.nOutputs+1-1)+1;if(K>I)return i&&i.error(`circuit too big for this power of tau ceremony. ${P.nConstraints}*2 > 2**${I}`),-1;if(!l[12])return i&&i.error("Powers of tau is not prepared."),-1;const M=P.nOutputs+P.nPubInputs,V=2**K;await se(C,1),await C.writeULE32(1),await ce(C),await se(C,2);const v=m.q,p=(Math.floor((Zt.bitLength(v)-1)/64)+1)*8,L=m.r,U=(Math.floor((Zt.bitLength(L)-1)/64)+1)*8,q=Zt.mod(Zt.shl(1,U*8),L),O=m.Fr.e(Zt.mod(Zt.mul(q,q),L));await C.writeULE32(p),await oi(C,v,p),await C.writeULE32(U),await oi(C,L,U),await C.writeULE32(P.nVars),await C.writeULE32(M),await C.writeULE32(V);let R;R=await f.read(N,l[4][0].p),await C.write(R),R=await m.G1.batchLEMtoU(R),h.update(R);let b;b=await f.read(N,l[5][0].p),await C.write(b),b=await m.G1.batchLEMtoU(b),h.update(b);let D;D=await f.read(T,l[6][0].p),await C.write(D),D=await m.G2.batchLEMtoU(D),h.update(D);const j=new Uint8Array(N);m.G1.toRprLEM(j,0,m.G1.g);const J=new Uint8Array(T);m.G2.toRprLEM(J,0,m.G2.g);const tt=new Uint8Array(N);m.G1.toRprUncompressed(tt,0,m.G1.g);const $=new Uint8Array(T);m.G2.toRprUncompressed($,0,m.G2.g),await C.write(J),await C.write(j),await C.write(J),h.update($),h.update(tt),h.update($),await ce(C),i&&i.info("Reading r1cs");let et=await Me(g,B,2);const X=new Ye(P.nVars),dt=new Ye(P.nVars),rt=new Ye(P.nVars),mt=new Ye(P.nVars-M-1),gt=new Array(M+1);i&&i.info("Reading tauG1");let A=await Me(f,l,12,(V-1)*N,V*N);i&&i.info("Reading tauG2");let u=await Me(f,l,13,(V-1)*T,V*T);i&&i.info("Reading alphatauG1");let F=await Me(f,l,14,(V-1)*N,V*N);i&&i.info("Reading betatauG1");let _=await Me(f,l,15,(V-1)*N,V*N);await w(),await k(3,"G1",gt,"IC"),await G(),await Y(),await k(8,"G1",mt,"C"),await k(5,"G1",X,"A"),await k(6,"G1",dt,"B1"),await k(7,"G2",rt,"B2");const Q=h.digest();return await se(C,10),await C.write(Q),await C.writeULE32(0),await ce(C),i&&i.info(Qi(Q,"Circuit hash: ")),await C.close(),await g.close(),await f.close(),Q;async function G(){await se(C,9);const At=new Wt(V*N);if(K<m.Fr.s){let ht=await Me(f,l,12,(V*2-1)*N,V*2*N);for(let ct=0;ct<V;ct++){i&&ct%1e4==0&&i.debug(`spliting buffer: ${ct}/${V}`);const _t=ht.slice((ct*2+1)*N,(ct*2+1)*N+N);At.set(_t,ct*N)}}else if(K==m.Fr.s){const ht=l[12][0].p+(2**(K+1)-1)*N;await f.readToBuffer(At,0,V*N,ht+V*N)}else throw i&&i.error("Circuit too big"),new Error("Circuit too big for this curve");await C.write(At),await ce(C)}async function w(){const At=new Uint8Array(12+m.Fr.n8),ht=new DataView(At.buffer),ct=new Uint8Array(m.Fr.n8);m.Fr.toRprLE(ct,0,m.Fr.e(1));let _t=0;function wt(){const bt=et.slice(_t,_t+4);return _t+=4,new DataView(bt.buffer).getUint32(0,!0)}const Et=new Ye;for(let bt=0;bt<P.nConstraints;bt++){i&&bt%1e4==0&&i.debug(`processing constraints: ${bt}/${P.nConstraints}`);const Ht=wt();for(let E=0;E<Ht;E++){const r=wt(),c=_t;_t+=m.Fr.n8;const y=0,S=N*bt,x=3,z=N*bt;typeof X[r]>"u"&&(X[r]=[]),X[r].push([y,S,c]),r<=M?(typeof gt[r]>"u"&&(gt[r]=[]),gt[r].push([x,z,c])):(typeof mt[r-M-1]>"u"&&(mt[r-M-1]=[]),mt[r-M-1].push([x,z,c])),Et.push([0,bt,r,c])}const Qt=wt();for(let E=0;E<Qt;E++){const r=wt(),c=_t;_t+=m.Fr.n8;const y=0,S=N*bt,x=1,z=T*bt,W=2,Z=N*bt;typeof dt[r]>"u"&&(dt[r]=[]),dt[r].push([y,S,c]),typeof rt[r]>"u"&&(rt[r]=[]),rt[r].push([x,z,c]),r<=M?(typeof gt[r]>"u"&&(gt[r]=[]),gt[r].push([W,Z,c])):(typeof mt[r-M-1]>"u"&&(mt[r-M-1]=[]),mt[r-M-1].push([W,Z,c])),Et.push([1,bt,r,c])}const Yt=wt();for(let E=0;E<Yt;E++){const r=wt(),c=_t;_t+=m.Fr.n8;const y=0,S=N*bt;r<=M?(typeof gt[r]>"u"&&(gt[r]=[]),gt[r].push([y,S,c])):(typeof mt[r-M-1]>"u"&&(mt[r-M-1]=[]),mt[r-M-1].push([y,S,c]))}}for(let bt=0;bt<=M;bt++){const Qt=N*(P.nConstraints+bt),Yt=3,E=N*(P.nConstraints+bt);typeof X[bt]>"u"&&(X[bt]=[]),X[bt].push([0,Qt,-1]),typeof gt[bt]>"u"&&(gt[bt]=[]),gt[bt].push([Yt,E,-1]),Et.push([0,P.nConstraints+bt,bt,-1])}await se(C,4);const Tt=new Wt(Et.length*(12+m.Fr.n8)+4),Nt=new Uint8Array(4);new DataView(Nt.buffer).setUint32(0,Et.length,!0),Tt.set(Nt);let Kt=4;for(let bt=0;bt<Et.length;bt++)i&&bt%1e5==0&&i.debug(`writing coeffs: ${bt}/${Et.length}`),Mt(Et[bt]);await C.write(Tt),await ce(C);function Mt(bt){ht.setUint32(0,bt[0],!0),ht.setUint32(4,bt[1],!0),ht.setUint32(8,bt[2],!0);let Ht;bt[3]>=0?Ht=m.Fr.fromRprLE(et.slice(bt[3],bt[3]+m.Fr.n8),0):Ht=m.Fr.fromRprLE(ct,0);const Qt=m.Fr.mul(Ht,O);m.Fr.toRprLE(At,12,Qt),Tt.set(At,Kt),Kt+=At.length}}async function k(At,ht,ct,_t){const Et=m[ht];Lt(ct.length),await se(C,At);let Tt=[],Nt=0;for(;Nt<ct.length;){let kt=0;for(;Nt<ct.length&&kt<m.tm.concurrency;){i&&i.debug(`Writing points start ${_t}: ${Nt}/${ct.length}`);let Mt=1,bt=ct[Nt]?ct[Nt].length:0;for(;Nt+Mt<ct.length&&bt+(ct[Nt+Mt]?ct[Nt+Mt].length:0)<32768&&Mt<32768;)bt+=ct[Nt+Mt]?ct[Nt+Mt].length:0,Mt++;const Ht=ct.slice(Nt,Nt+Mt),Qt=Nt;Tt.push(ot(ht,Ht,i,_t).then(Yt=>(i&&i.debug(`Writing points end ${_t}: ${Qt}/${ct.length}`),Yt))),Nt+=Mt,kt++}const Kt=await Promise.all(Tt);for(let Mt=0;Mt<Kt.length;Mt++){await C.write(Kt[Mt][0]);const bt=await Et.batchLEMtoU(Kt[Mt][0]);h.update(bt)}Tt=[]}await ce(C)}async function ot(At,ht,ct,_t){const wt=m[At],Et=wt.F.n8*2,Tt=wt.F.n8*3,Nt=wt.F.n8*2;let kt,Kt,Mt,bt;if(At=="G1")kt="g1m_timesScalarAffine",Kt="g1m_multiexpAffine",Mt="g1m_batchToAffine",bt="g1m_zero";else if(At=="G2")kt="g2m_timesScalarAffine",Kt="g2m_multiexpAffine",Mt="g2m_batchToAffine",bt="g2m_zero";else throw new Error("Invalid group");let Ht=0;for(let x=0;x<ht.length;x++)Ht+=ht[x]?ht[x].length:0;let Qt,Yt;Ht>2<<14?(Qt=new Wt(Ht*Et),Yt=new Wt(Ht*m.Fr.n8)):(Qt=new Uint8Array(Ht*Et),Yt=new Uint8Array(Ht*m.Fr.n8));let E=0,r=0;const c=[A,u,F,_],y=new Uint8Array(m.Fr.n8);m.Fr.toRprLE(y,0,m.Fr.e(1));let S=0;for(let x=0;x<ht.length;x++)if(!!ht[x])for(let z=0;z<ht[x].length;z++)ct&&z&&z%1e4==0&&ct.debug(`Configuring big array ${_t}: ${z}/${ht[x].length}`),Qt.set(c[ht[x][z][0]].slice(ht[x][z][1],ht[x][z][1]+Et),S*Et),ht[x][z][2]>=0?Yt.set(et.slice(ht[x][z][2],ht[x][z][2]+m.Fr.n8),S*m.Fr.n8):Yt.set(y,S*m.Fr.n8),S++;if(ht.length>1){const x=[];x.push({cmd:"ALLOCSET",var:0,buff:Qt}),x.push({cmd:"ALLOCSET",var:1,buff:Yt}),x.push({cmd:"ALLOC",var:2,len:ht.length*Tt}),E=0,r=0;let z=0;for(let Z=0;Z<ht.length;Z++){if(!ht[Z]){x.push({cmd:"CALL",fnName:bt,params:[{var:2,offset:z}]}),z+=Tt;continue}ht[Z].length==1?x.push({cmd:"CALL",fnName:kt,params:[{var:0,offset:E},{var:1,offset:r},{val:m.Fr.n8},{var:2,offset:z}]}):x.push({cmd:"CALL",fnName:Kt,params:[{var:0,offset:E},{var:1,offset:r},{val:m.Fr.n8},{val:ht[Z].length},{var:2,offset:z}]}),E+=Et*ht[Z].length,r+=m.Fr.n8*ht[Z].length,z+=Tt}return x.push({cmd:"CALL",fnName:Mt,params:[{var:2},{val:ht.length},{var:2}]}),x.push({cmd:"GET",out:0,var:2,len:ht.length*Nt}),await m.tm.queueAction(x)}else{let x=await wt.multiExpAffine(Qt,Yt,ct,_t);return x=[wt.toAffine(x)],x}}async function Y(){Lt(V-1);for(let ht=0;ht<V-1;ht+=16384){i&&i.debug(`HashingHPoints: ${ht}/${V}`);const ct=Math.min(V-1,16384);await nt(ht,ct)}}async function nt(At,ht){const ct=await f.read(ht*N,l[2][0].p+(At+V)*N),_t=await f.read(ht*N,l[2][0].p+At*N),wt=m.tm.concurrency,Et=Math.floor(ht/wt),Tt=[];for(let kt=0;kt<wt;kt++){let Kt;if(kt<wt-1?Kt=Et:Kt=ht-kt*Et,Kt==0)continue;const Mt=ct.slice(kt*Et*N,(kt*Et+Kt)*N),bt=_t.slice(kt*Et*N,(kt*Et+Kt)*N);Tt.push(ft(Mt,bt))}const Nt=await Promise.all(Tt);for(let kt=0;kt<Nt.length;kt++)h.update(Nt[kt][0])}async function ft(At,ht){const ct=At.byteLength/N,_t=m.G1.F.n8*3,wt=[];wt.push({cmd:"ALLOCSET",var:0,buff:At}),wt.push({cmd:"ALLOCSET",var:1,buff:ht}),wt.push({cmd:"ALLOC",var:2,len:ct*_t});for(let Tt=0;Tt<ct;Tt++)wt.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:Tt*N},{var:1,offset:Tt*N},{var:2,offset:Tt*_t}]});return wt.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:ct},{var:2}]}),wt.push({cmd:"CALL",fnName:"g1m_batchLEMtoU",params:[{var:2},{val:ct},{var:2}]}),wt.push({cmd:"GET",out:0,var:2,len:ct*N}),await m.tm.queueAction(wt)}function Lt(At){const ht=new Uint8Array(4);new DataView(ht.buffer,ht.byteOffset,ht.byteLength).setUint32(0,At,!1),h.update(ht)}}const Wi=Bg;async function jg(e,t,n,i){let a;await oe.exports.ready();const{fd:o,sections:s}=await xe(n,"zkey",2),d=await ba(o,s,!1);if(d.protocol!="groth16")throw new Error("zkey file is not groth16");const h=await mn(d.q),f=h.G1.F.n8*2,l=await sr(o,h,s),m=oe.exports(64);m.update(l.csHash);let I=h.G1.g;for(let v=0;v<l.contributions.length;v++){const p=l.contributions[v],L=vg(m);if(Gn(L,h,p.delta.g1_s),Gn(L,h,p.delta.g1_sx),!dd(L.digest(),p.transcript))return console.log(`INVALID(${v}): Inconsistent transcript `),!1;const U=ud(h,p.transcript);if(a=await Wi(h,p.delta.g1_s,p.delta.g1_sx,U,p.delta.g2_spx),a!==!0)return console.log(`INVALID(${v}): public key G1 and G2 do not have the same ration `),!1;if(a=await Wi(h,I,p.deltaAfter,U,p.delta.g2_spx),a!==!0)return console.log(`INVALID(${v}): deltaAfter does not fillow the public key `),!1;if(p.type==1){const O=Pg(p.beaconHash,p.numIterationsExp),R=h.Fr.fromRng(O),b=h.G1.toAffine(h.G1.fromRng(O)),D=h.G1.toAffine(h.G1.timesFr(b,R));if(h.G1.eq(b,p.delta.g1_s)!==!0)return console.log(`INVALID(${v}): Key of the beacon does not match. g1_s `),!1;if(h.G1.eq(D,p.delta.g1_sx)!==!0)return console.log(`INVALID(${v}): Key of the beacon does not match. g1_sx `),!1}Ca(m,h,p);const q=oe.exports(64);Ca(q,h,p),p.contributionHash=q.digest(),I=p.deltaAfter}const{fd:g,sections:B}=await xe(e,"zkey",2),P=await ba(g,B,!1);if(P.protocol!="groth16")throw new Error("zkeyinit file is not groth16");if(!Zt.eq(P.q,d.q)||!Zt.eq(P.r,d.r)||P.n8q!=d.n8q||P.n8r!=d.n8r)return i&&i.error("INVALID:  Different curves"),!1;if(P.nVars!=d.nVars||P.nPublic!=d.nPublic||P.domainSize!=d.domainSize)return i&&i.error("INVALID:  Different circuit parameters"),!1;if(!h.G1.eq(d.vk_alpha_1,P.vk_alpha_1))return i&&i.error("INVALID:  Invalid alpha1"),!1;if(!h.G1.eq(d.vk_beta_1,P.vk_beta_1))return i&&i.error("INVALID:  Invalid beta1"),!1;if(!h.G2.eq(d.vk_beta_2,P.vk_beta_2))return i&&i.error("INVALID:  Invalid beta2"),!1;if(!h.G2.eq(d.vk_gamma_2,P.vk_gamma_2))return i&&i.error("INVALID:  Invalid gamma2"),!1;if(!h.G1.eq(d.vk_delta_1,I))return i&&i.error("INVALID:  Invalid delta1"),!1;if(a=await Wi(h,h.G1.g,I,h.G2.g,d.vk_delta_2),a!==!0)return i&&i.error("INVALID:  Invalid delta2"),!1;const C=await sr(g,h,B);if(!dd(l.csHash,C.csHash))return i&&i.error("INVALID:  Circuit does not match"),!1;if(s[8][0].size!=f*(d.nVars-d.nPublic-1))return i&&i.error("INVALID:  Invalid L section size"),!1;if(s[9][0].size!=f*d.domainSize)return i&&i.error("INVALID:  Invalid H section size"),!1;let N;if(N=await zi(o,s,g,B,3),!N)return i&&i.error("INVALID:  IC section is not identical"),!1;if(N=await zi(o,s,g,B,4),!N)return i&&i.error("Coeffs section is not identical"),!1;if(N=await zi(o,s,g,B,5),!N)return i&&i.error("A section is not identical"),!1;if(N=await zi(o,s,g,B,6),!N)return i&&i.error("B1 section is not identical"),!1;if(N=await zi(o,s,g,B,7),!N)return i&&i.error("B2 section is not identical"),!1;if(a=await T("G1",g,B,o,s,8,d.vk_delta_2,P.vk_delta_2,"L section"),a!==!0)return i&&i.error("L section does not match"),!1;if(a=await K(),a!==!0)return i&&i.error("H section does not match"),!1;i&&i.info(Qi(l.csHash,"Circuit Hash: ")),await o.close(),await g.close();for(let v=l.contributions.length-1;v>=0;v--){const p=l.contributions[v];i&&i.info("-------------------------"),i&&i.info(Qi(p.contributionHash,`contribution #${v+1} ${p.name?p.name:""}:`)),p.type==1&&(i&&i.info(`Beacon generator: ${Og(p.beaconHash)}`),i&&i.info(`Beacon iterations Exp: ${p.numIterationsExp}`))}return i&&i.info("-------------------------"),i&&i.info("ZKey Ok!"),!0;async function T(v,p,L,U,q,O,R,b,D){const J=h[v],tt=J.F.n8*2;await ge(p,L,O),await ge(U,q,O);let $=J.zero,et=J.zero;const X=L[O][0].size/tt;for(let dt=0;dt<X;dt+=1048576){i&&i.debug(`Same ratio check ${D}:  ${dt}/${X}`);const rt=Math.min(X-dt,1048576),mt=await p.read(rt*tt),gt=await U.read(rt*tt),A=new Uint8Array(4*rt);_a.randomFillSync(A);const u=await J.multiExpAffine(mt,A),F=await J.multiExpAffine(gt,A);$=J.add($,u),et=J.add(et,F)}return await pe(p),await pe(U),X==0?!0:(a=await Wi(h,$,et,R,b),a===!0)}async function K(){const p=h.G1,L=h.Fr,U=p.F.n8*2,{fd:q,sections:O}=await xe(t,"ptau",1);let R=new Wt(d.domainSize*d.n8r);const b=new Array(8);for(let et=0;et<8;et++)b[et]=_a.randomBytes(4).readUInt32BE(0,!0);const D=new Pi(b);for(let et=0;et<d.domainSize-1;et++){const X=L.fromRng(D);L.toRprLE(R,et*d.n8r,X)}L.toRprLE(R,(d.domainSize-1)*d.n8r,L.zero);let j=p.zero;for(let et=0;et<d.domainSize;et+=1048576){i&&i.debug(`H Verificaition(tau):  ${et}/${d.domainSize}`);const X=Math.min(d.domainSize-et,1048576),dt=await q.read(U*X,O[2][0].p+d.domainSize*U+et*U),rt=await q.read(U*X,O[2][0].p+et*U),mt=await M(dt,rt),gt=R.slice(et*d.n8r,(et+X)*d.n8r),A=await p.multiExpAffine(mt,gt);j=p.add(j,A)}R=await L.batchToMontgomery(R);let J;if(d.power<L.s)J=L.neg(L.e(2));else{const et=2**L.s,X=L.exp(L.shift,et);J=L.sub(X,L.one)}const tt=d.power<L.s?L.w[d.power+1]:L.shift;R=await L.batchApplyKey(R,J,tt),R=await L.fft(R),R=await L.batchFromMontgomery(R),await ge(o,s,9);let $=p.zero;for(let et=0;et<d.domainSize;et+=1048576){i&&i.debug(`H Verificaition(lagrange):  ${et}/${d.domainSize}`);const X=Math.min(d.domainSize-et,1048576),dt=await o.read(U*X),rt=R.slice(et*d.n8r,(et+X)*d.n8r),mt=await p.multiExpAffine(dt,rt);$=p.add($,mt)}return await pe(o),a=await Wi(h,j,$,d.vk_delta_2,P.vk_delta_2),a===!0}async function M(v,p){const L=h.G1.F.n8*2,U=v.byteLength/L,q=h.tm.concurrency,O=Math.floor(U/q),R=[];for(let J=0;J<q;J++){let tt;if(J<q-1?tt=O:tt=U-J*O,tt==0)continue;const $=v.slice(J*O*f,(J*O+tt)*f),et=p.slice(J*O*f,(J*O+tt)*f);R.push(V($,et))}const b=await Promise.all(R),D=new Uint8Array(U*L);let j=0;for(let J=0;J<b.length;J++)D.set(b[J][0],j),j+=b[J][0].byteLength;return D}async function V(v,p){const L=h.G1.F.n8*2,U=h.G1.F.n8*3,q=v.byteLength/L,O=[];O.push({cmd:"ALLOCSET",var:0,buff:v}),O.push({cmd:"ALLOCSET",var:1,buff:p}),O.push({cmd:"ALLOC",var:2,len:q*U});for(let b=0;b<q;b++)O.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:b*L},{var:1,offset:b*L},{var:2,offset:b*U}]});return O.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:q},{var:2}]}),O.push({cmd:"GET",out:0,var:2,len:q*L}),await h.tm.queueAction(O)}}async function Yg(e,t,n,i,a){await oe.exports.ready();const{fd:o,sections:s}=await xe(e,"zkey",2),d=await ba(o,s);if(d.protocol!="groth16")throw new Error("zkey file is not groth16");const h=await mn(d.q),f=await sr(o,h,s),l=await er(t,"zkey",1,10),m=await Tg(i),I=oe.exports(64);I.update(f.csHash);for(let N=0;N<f.contributions.length;N++)Ca(I,h,f.contributions[N]);const g={};g.delta={},g.delta.prvKey=h.Fr.fromRng(m),g.delta.g1_s=h.G1.toAffine(h.G1.fromRng(m)),g.delta.g1_sx=h.G1.toAffine(h.G1.timesFr(g.delta.g1_s,g.delta.prvKey)),Gn(I,h,g.delta.g1_s),Gn(I,h,g.delta.g1_sx),g.transcript=I.digest(),g.delta.g2_sp=ud(h,g.transcript),g.delta.g2_spx=h.G2.toAffine(h.G2.timesFr(g.delta.g2_sp,g.delta.prvKey)),d.vk_delta_1=h.G1.timesFr(d.vk_delta_1,g.delta.prvKey),d.vk_delta_2=h.G2.timesFr(d.vk_delta_2,g.delta.prvKey),g.deltaAfter=d.vk_delta_1,g.type=0,n&&(g.name=n),f.contributions.push(g),await Rg(l,d),await ki(o,s,l,3),await ki(o,s,l,4),await ki(o,s,l,5),await ki(o,s,l,6),await ki(o,s,l,7);const B=h.Fr.inv(g.delta.prvKey);await _d(o,s,l,8,h,"G1",B,h.Fr.e(1),"L Section",a),await _d(o,s,l,9,h,"G1",B,h.Fr.e(1),"H Section",a),await Ng(l,h,f),await o.close(),await l.close();const P=oe.exports(64);Ca(P,h,g);const C=P.digest();return a&&a.info(Qi(f.csHash,"Circuit Hash: ")),a&&a.info(Qi(C,"Contribution Hash: ")),C}const{stringifyBigInts:pd}=rh;async function dr(e){const{fd:t,sections:n}=await xe(e,"zkey",2),i=await ba(t,n);let a;if(i.protocol=="groth16")a=await $g(i,t,n);else if(i.protocol=="plonk")a=await Zg(i);else throw new Error("zkey file is not groth16");return await t.close(),a}async function $g(e,t,n){const i=await mn(e.q),a=i.G1.F.n8*2,o=await i.pairing(e.vk_alpha_1,e.vk_beta_2);let s={protocol:e.protocol,curve:i.name,nPublic:e.nPublic,vk_alpha_1:i.G1.toObject(e.vk_alpha_1),vk_beta_2:i.G2.toObject(e.vk_beta_2),vk_gamma_2:i.G2.toObject(e.vk_gamma_2),vk_delta_2:i.G2.toObject(e.vk_delta_2),vk_alphabeta_12:i.Gt.toObject(o)};await ge(t,n,3),s.IC=[];for(let d=0;d<=e.nPublic;d++){const h=await t.read(a),f=i.G1.toObject(h);s.IC.push(f)}return await pe(t),s=pd(s),s}async function Zg(e){const t=await mn(e.q);let n={protocol:e.protocol,curve:t.name,nPublic:e.nPublic,power:e.power,k1:t.Fr.toObject(e.k1),k2:t.Fr.toObject(e.k2),Qm:t.G1.toObject(e.Qm),Ql:t.G1.toObject(e.Ql),Qr:t.G1.toObject(e.Qr),Qo:t.G1.toObject(e.Qo),Qc:t.G1.toObject(e.Qc),S1:t.G1.toObject(e.S1),S2:t.G1.toObject(e.S2),S3:t.G1.toObject(e.S3),X_2:t.G2.toObject(e.X_2),w:t.Fr.toObject(t.Fr.w[e.power])};return n=pd(n),n}var md={},Jg=Ra(sh),Xg=Ra(K_),Ld={};(function(e){var t=/[|\\{}()[\]^$+*?.]/g,n=Object.prototype.hasOwnProperty,i=function(h,f){return n.apply(h,[f])};e.escapeRegExpChars=function(h){return h?String(h).replace(t,"\\$&"):""};var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},o=/[&<>'"]/g;function s(h){return a[h]||h}var d=`var _ENCODE_HTML_RULES = {
      "&": "&amp;"
    , "<": "&lt;"
    , ">": "&gt;"
    , '"': "&#34;"
    , "'": "&#39;"
    }
  , _MATCH_HTML = /[&<>'"]/g;
function encode_char(c) {
  return _ENCODE_HTML_RULES[c] || c;
};
`;e.escapeXML=function(h){return h==null?"":String(h).replace(o,s)},e.escapeXML.toString=function(){return Function.prototype.toString.call(this)+`;
`+d},e.shallowCopy=function(h,f){if(f=f||{},h!=null)for(var l in f)!i(f,l)||l==="__proto__"||l==="constructor"||(h[l]=f[l]);return h},e.shallowCopyFromList=function(h,f,l){if(l=l||[],f=f||{},h!=null)for(var m=0;m<l.length;m++){var I=l[m];if(typeof f[I]<"u"){if(!i(f,I)||I==="__proto__"||I==="constructor")continue;h[I]=f[I]}}return h},e.cache={_data:{},set:function(h,f){this._data[h]=f},get:function(h){return this._data[h]},remove:function(h){delete this._data[h]},reset:function(){this._data={}}},e.hyphenToCamel=function(h){return h.replace(/-[a-z]/g,function(f){return f[1].toUpperCase()})},e.createNullProtoObjWherePossible=function(){return typeof Object.create=="function"?function(){return Object.create(null)}:{__proto__:null}instanceof Object?function(){return{}}:function(){return{__proto__:null}}}()})(Ld);var tp={name:"ejs",description:"Embedded JavaScript templates",keywords:["template","engine","ejs"],version:"3.1.8",author:"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)",license:"Apache-2.0",bin:{ejs:"./bin/cli.js"},main:"./lib/ejs.js",jsdelivr:"ejs.min.js",unpkg:"ejs.min.js",repository:{type:"git",url:"git://github.com/mde/ejs.git"},bugs:"https://github.com/mde/ejs/issues",homepage:"https://github.com/mde/ejs",dependencies:{jake:"^10.8.5"},devDependencies:{browserify:"^16.5.1",eslint:"^6.8.0","git-directory-deploy":"^1.5.1",jsdoc:"^3.6.7","lru-cache":"^4.0.1",mocha:"^7.1.1","uglify-js":"^3.3.16"},engines:{node:">=0.10.0"},scripts:{test:"mocha"}};(function(e){/**
 * @file Embedded JavaScript templating engine. {@link http://ejs.co}
 * @author Matthew Eernisse <mde@fleegix.org>
 * @author Tiancheng "Timothy" Gu <timothygu99@gmail.com>
 * @project EJS
 * @license {@link http://www.apache.org/licenses/LICENSE-2.0 Apache License, Version 2.0}
 */var t=Jg,n=Xg,i=Ld,a=!1,o=tp.version,s="<",d=">",h="%",f="locals",l="ejs",m="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",I=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],g=I.concat("cache"),B=/^\uFEFF/,P=/^[a-zA-Z_$][0-9a-zA-Z_$]*$/;e.cache=i.cache,e.fileLoader=t.readFileSync,e.localsName=f,e.promiseImpl=new Function("return this;")().Promise,e.resolveInclude=function(U,q,O){var R=n.dirname,b=n.extname,D=n.resolve,j=D(O?q:R(q),U),J=b(U);return J||(j+=".ejs"),j};function C(U,q){var O;if(q.some(function(R){return O=e.resolveInclude(U,R,!0),t.existsSync(O)}))return O}function N(U,q){var O,R,b=q.views,D=/^[A-Za-z]+:\\|^\//.exec(U);if(D&&D.length)U=U.replace(/^\/*/,""),Array.isArray(q.root)?O=C(U,q.root):O=e.resolveInclude(U,q.root||"/",!0);else if(q.filename&&(R=e.resolveInclude(U,q.filename),t.existsSync(R)&&(O=R)),!O&&Array.isArray(b)&&(O=C(U,b)),!O&&typeof q.includer!="function")throw new Error('Could not find the include file "'+q.escapeFunction(U)+'"');return O}function T(U,q){var O,R=U.filename,b=arguments.length>1;if(U.cache){if(!R)throw new Error("cache option requires a filename");if(O=e.cache.get(R),O)return O;b||(q=M(R).toString().replace(B,""))}else if(!b){if(!R)throw new Error("Internal EJS error: no file name or template provided");q=M(R).toString().replace(B,"")}return O=e.compile(q,U),U.cache&&e.cache.set(R,O),O}function K(U,q,O){var R;if(O){try{R=T(U)(q)}catch(b){return O(b)}O(null,R)}else{if(typeof e.promiseImpl=="function")return new e.promiseImpl(function(b,D){try{R=T(U)(q),b(R)}catch(j){D(j)}});throw new Error("Please provide a callback function")}}function M(U){return e.fileLoader(U)}function V(U,q){var O=i.shallowCopy(i.createNullProtoObjWherePossible(),q);if(O.filename=N(U,O),typeof q.includer=="function"){var R=q.includer(U,O.filename);if(R&&(R.filename&&(O.filename=R.filename),R.template))return T(O,R.template)}return T(O)}function v(U,q,O,R,b){var D=q.split(`
`),j=Math.max(R-3,0),J=Math.min(D.length,R+3),tt=b(O),$=D.slice(j,J).map(function(et,X){var dt=X+j+1;return(dt==R?" >> ":"    ")+dt+"| "+et}).join(`
`);throw U.path=tt,U.message=(tt||"ejs")+":"+R+`
`+$+`

`+U.message,U}function p(U){return U.replace(/;(\s*$)/,"$1")}e.compile=function(q,O){var R;return O&&O.scope&&(a||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),a=!0),O.context||(O.context=O.scope),delete O.scope),R=new L(q,O),R.compile()},e.render=function(U,q,O){var R=q||i.createNullProtoObjWherePossible(),b=O||i.createNullProtoObjWherePossible();return arguments.length==2&&i.shallowCopyFromList(b,R,I),T(b,U)(R)},e.renderFile=function(){var U=Array.prototype.slice.call(arguments),q=U.shift(),O,R={filename:q},b,D;return typeof arguments[arguments.length-1]=="function"&&(O=U.pop()),U.length?(b=U.shift(),U.length?i.shallowCopy(R,U.pop()):(b.settings&&(b.settings.views&&(R.views=b.settings.views),b.settings["view cache"]&&(R.cache=!0),D=b.settings["view options"],D&&i.shallowCopy(R,D)),i.shallowCopyFromList(R,b,g)),R.filename=q):b=i.createNullProtoObjWherePossible(),K(R,b,O)},e.Template=L,e.clearCache=function(){e.cache.reset()};function L(U,q){q=q||i.createNullProtoObjWherePossible();var O=i.createNullProtoObjWherePossible();this.templateText=U,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",O.client=q.client||!1,O.escapeFunction=q.escape||q.escapeFunction||i.escapeXML,O.compileDebug=q.compileDebug!==!1,O.debug=!!q.debug,O.filename=q.filename,O.openDelimiter=q.openDelimiter||e.openDelimiter||s,O.closeDelimiter=q.closeDelimiter||e.closeDelimiter||d,O.delimiter=q.delimiter||e.delimiter||h,O.strict=q.strict||!1,O.context=q.context,O.cache=q.cache||!1,O.rmWhitespace=q.rmWhitespace,O.root=q.root,O.includer=q.includer,O.outputFunctionName=q.outputFunctionName,O.localsName=q.localsName||e.localsName||f,O.views=q.views,O.async=q.async,O.destructuredLocals=q.destructuredLocals,O.legacyInclude=typeof q.legacyInclude<"u"?!!q.legacyInclude:!0,O.strict?O._with=!1:O._with=typeof q._with<"u"?q._with:!0,this.opts=O,this.regex=this.createRegex()}L.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},L.prototype={createRegex:function(){var U=m,q=i.escapeRegExpChars(this.opts.delimiter),O=i.escapeRegExpChars(this.opts.openDelimiter),R=i.escapeRegExpChars(this.opts.closeDelimiter);return U=U.replace(/%/g,q).replace(/</g,O).replace(/>/g,R),new RegExp(U)},compile:function(){var U,q,O=this.opts,R="",b="",D=O.escapeFunction,j,J=O.filename?JSON.stringify(O.filename):"undefined";if(!this.source){if(this.generateSource(),R+=`  var __output = "";
  function __append(s) { if (s !== undefined && s !== null) __output += s }
`,O.outputFunctionName){if(!P.test(O.outputFunctionName))throw new Error("outputFunctionName is not a valid JS identifier.");R+="  var "+O.outputFunctionName+` = __append;
`}if(O.localsName&&!P.test(O.localsName))throw new Error("localsName is not a valid JS identifier.");if(O.destructuredLocals&&O.destructuredLocals.length){for(var tt="  var __locals = ("+O.localsName+` || {}),
`,$=0;$<O.destructuredLocals.length;$++){var et=O.destructuredLocals[$];if(!P.test(et))throw new Error("destructuredLocals["+$+"] is not a valid JS identifier.");$>0&&(tt+=`,
  `),tt+=et+" = __locals."+et}R+=tt+`;
`}O._with!==!1&&(R+="  with ("+O.localsName+` || {}) {
`,b+=`  }
`),b+=`  return __output;
`,this.source=R+this.source+b}O.compileDebug?U=`var __line = 1
  , __lines = `+JSON.stringify(this.templateText)+`
  , __filename = `+J+`;
try {
`+this.source+`} catch (e) {
  rethrow(e, __lines, __filename, __line, escapeFn);
}
`:U=this.source,O.client&&(U="escapeFn = escapeFn || "+D.toString()+`;
`+U,O.compileDebug&&(U="rethrow = rethrow || "+v.toString()+`;
`+U)),O.strict&&(U=`"use strict";
`+U),O.debug&&console.log(U),O.compileDebug&&O.filename&&(U=U+`
//# sourceURL=`+J+`
`);try{if(O.async)try{j=new Function("return (async function(){}).constructor;")()}catch(mt){throw mt instanceof SyntaxError?new Error("This environment does not support async/await"):mt}else j=Function;q=new j(O.localsName+", escapeFn, include, rethrow",U)}catch(mt){throw mt instanceof SyntaxError&&(O.filename&&(mt.message+=" in "+O.filename),mt.message+=` while compiling ejs

`,mt.message+=`If the above error is not helpful, you may want to try EJS-Lint:
`,mt.message+="https://github.com/RyanZim/EJS-Lint",O.async||(mt.message+=`
`,mt.message+="Or, if you meant to create an async function, pass `async: true` as an option.")),mt}var X=O.client?q:function(gt){var A=function(u,F){var _=i.shallowCopy(i.createNullProtoObjWherePossible(),gt);return F&&(_=i.shallowCopy(_,F)),V(u,O)(_)};return q.apply(O.context,[gt||i.createNullProtoObjWherePossible(),D,A,v])};if(O.filename&&typeof Object.defineProperty=="function"){var dt=O.filename,rt=n.basename(dt,n.extname(dt));try{Object.defineProperty(X,"name",{value:rt,writable:!1,enumerable:!1,configurable:!0})}catch{}}return X},generateSource:function(){var U=this.opts;U.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,`
`).replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var q=this,O=this.parseTemplateText(),R=this.opts.delimiter,b=this.opts.openDelimiter,D=this.opts.closeDelimiter;O&&O.length&&O.forEach(function(j,J){var tt;if(j.indexOf(b+R)===0&&j.indexOf(b+R+R)!==0&&(tt=O[J+2],!(tt==R+D||tt=="-"+R+D||tt=="_"+R+D)))throw new Error('Could not find matching close tag for "'+j+'".');q.scanLine(j)})},parseTemplateText:function(){for(var U=this.templateText,q=this.regex,O=q.exec(U),R=[],b;O;)b=O.index,b!==0&&(R.push(U.substring(0,b)),U=U.slice(b)),R.push(O[0]),U=U.slice(O[0].length),O=q.exec(U);return U&&R.push(U),R},_addOutput:function(U){if(this.truncate&&(U=U.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!U)return U;U=U.replace(/\\/g,"\\\\"),U=U.replace(/\n/g,"\\n"),U=U.replace(/\r/g,"\\r"),U=U.replace(/"/g,'\\"'),this.source+='    ; __append("'+U+`")
`},scanLine:function(U){var q=this,O=this.opts.delimiter,R=this.opts.openDelimiter,b=this.opts.closeDelimiter,D=0;switch(D=U.split(`
`).length-1,U){case R+O:case R+O+"_":this.mode=L.modes.EVAL;break;case R+O+"=":this.mode=L.modes.ESCAPED;break;case R+O+"-":this.mode=L.modes.RAW;break;case R+O+"#":this.mode=L.modes.COMMENT;break;case R+O+O:this.mode=L.modes.LITERAL,this.source+='    ; __append("'+U.replace(R+O+O,R+O)+`")
`;break;case O+O+b:this.mode=L.modes.LITERAL,this.source+='    ; __append("'+U.replace(O+O+b,O+b)+`")
`;break;case O+b:case"-"+O+b:case"_"+O+b:this.mode==L.modes.LITERAL&&this._addOutput(U),this.mode=null,this.truncate=U.indexOf("-")===0||U.indexOf("_")===0;break;default:if(this.mode){switch(this.mode){case L.modes.EVAL:case L.modes.ESCAPED:case L.modes.RAW:U.lastIndexOf("//")>U.lastIndexOf(`
`)&&(U+=`
`)}switch(this.mode){case L.modes.EVAL:this.source+="    ; "+U+`
`;break;case L.modes.ESCAPED:this.source+="    ; __append(escapeFn("+p(U)+`))
`;break;case L.modes.RAW:this.source+="    ; __append("+p(U)+`)
`;break;case L.modes.COMMENT:break;case L.modes.LITERAL:this._addOutput(U);break}}else this._addOutput(U)}q.opts.compileDebug&&D&&(this.currentLine+=D,this.source+="    ; __line = "+this.currentLine+`
`)}},e.escapeXML=i.escapeXML,e.__express=e.renderFile,e.VERSION=o,e.name=l,typeof window<"u"&&(window.ejs=e)})(md);async function Ad(e,t,n){const i=await dr(e);let a=t[i.protocol];return md.render(a,i)}async function ep(e,t,n,i){globalThis.gc&&globalThis.gc(),await oe.exports.ready();const{fd:a,sections:o}=await xe(t,"ptau",1),{curve:s,power:d}=await fd(a,o),{fd:h,sections:f}=await xe(e,"r1cs",1),l=await Qg(h,f,{loadConstraints:!0,loadCustomGates:!0}),m=s.G1.F.n8*2,I=s.G1,g=s.G2.F.n8*2,B=s.Fr,P=s.Fr.n8;i&&i.info("Reading r1cs"),await Me(h,f,2);const C=new Ye,N=new Ye;let T=l.nVars;const K=l.nOutputs+l.nPubInputs;await b(s.Fr,l,i),globalThis.gc&&globalThis.gc();const M=await er(n,"zkey",1,14,1<<22,1<<24);if(l.prime!=s.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;let V=Ia(C.length-1)+1;V<3&&(V=3);const v=2**V;if(i&&i.info("Plonk constraints: "+C.length),V>d)return i&&i.error(`circuit too big for this power of tau ceremony. ${C.length} > 2**${d}`),-1;if(!o[12])return i&&i.error("Powers of tau is not prepared."),-1;const p=new Wt(v*m),L=o[12][0].p+(2**V-1)*m;await a.readToBuffer(p,0,v*m,L);const[U,q]=dt(),O={};await tt(3,"Additions"),globalThis.gc&&globalThis.gc(),await D(4,0,"Amap"),globalThis.gc&&globalThis.gc(),await D(5,1,"Bmap"),globalThis.gc&&globalThis.gc(),await D(6,2,"Cmap"),globalThis.gc&&globalThis.gc(),await j(7,3,"Qm"),globalThis.gc&&globalThis.gc(),await j(8,4,"Ql"),globalThis.gc&&globalThis.gc(),await j(9,5,"Qr"),globalThis.gc&&globalThis.gc(),await j(10,6,"Qo"),globalThis.gc&&globalThis.gc(),await j(11,7,"Qc"),globalThis.gc&&globalThis.gc(),await $(12,"sigma"),globalThis.gc&&globalThis.gc(),await et(13,"lagrange polynomials"),globalThis.gc&&globalThis.gc(),await se(M,14);const R=new Wt((v+6)*m);await a.readToBuffer(R,0,(v+6)*m,o[2][0].p),await M.write(R),await ce(M),globalThis.gc&&globalThis.gc(),await X(),await M.close(),await h.close(),await a.close(),i&&i.info("Setup Finished");return;async function b(rt,mt,gt){function A(k){const ot=Object.keys(k);for(let Y=0;Y<ot.length;Y++)k[ot[Y]]==0n&&delete k[ot[Y]]}function u(k,ot,Y){const nt={};for(let ft in k)typeof nt[ft]>"u"?nt[ft]=rt.mul(ot,k[ft]):nt[ft]=rt.add(nt[ft],rt.mul(ot,k[ft]));for(let ft in Y)typeof nt[ft]>"u"?nt[ft]=Y[ft]:nt[ft]=rt.add(nt[ft],Y[ft]);return A(nt),nt}function F(k,ot){const Y={k:rt.zero,s:[],coefs:[]},nt=[];for(let ft in k)ft==0?Y.k=rt.add(Y.k,k[ft]):k[ft]!=0n&&nt.push([Number(ft),k[ft]]);for(;nt.length>ot;){const ft=nt.shift(),Lt=nt.shift(),At=ft[0],ht=Lt[0],ct=T++,_t=rt.zero,wt=rt.neg(ft[1]),Et=rt.neg(Lt[1]),Tt=rt.one,Nt=rt.zero;C.push([At,ht,ct,_t,wt,Et,Tt,Nt]),N.push([At,ht,ft[1],Lt[1]]),nt.push([ct,rt.one])}for(let ft=0;ft<nt.length;ft++)Y.s[ft]=nt[ft][0],Y.coefs[ft]=nt[ft][1];for(;Y.coefs.length<ot;)Y.s.push(0),Y.coefs.push(rt.zero);return Y}function _(k){const ot=F(k,3),Y=ot.s[0],nt=ot.s[1],ft=ot.s[2],Lt=rt.zero,At=ot.coefs[0],ht=ot.coefs[1],ct=ot.coefs[2],_t=ot.k;C.push([Y,nt,ft,Lt,At,ht,ct,_t])}function Q(k,ot,Y){const nt=F(k,1),ft=F(ot,1),Lt=F(Y,1),At=nt.s[0],ht=ft.s[0],ct=Lt.s[0],_t=rt.mul(nt.coefs[0],ft.coefs[0]),wt=rt.mul(nt.coefs[0],ft.k),Et=rt.mul(nt.k,ft.coefs[0]),Tt=rt.neg(Lt.coefs[0]),Nt=rt.sub(rt.mul(nt.k,ft.k),Lt.k);C.push([At,ht,ct,_t,wt,Et,Tt,Nt])}function G(k){let ot=rt.zero,Y=0;const nt=Object.keys(k);for(let ft=0;ft<nt.length;ft++)k[nt[ft]]==0n?delete k[nt[ft]]:nt[ft]==0?ot=rt.add(ot,k[nt[ft]]):Y++;return Y>0?Y.toString():ot!=rt.zero?"k":"0"}function w(k,ot,Y){const nt=G(k),ft=G(ot);if(nt==="0"||ft==="0")A(Y),_(Y);else if(nt==="k"){const Lt=u(ot,k[0],Y);_(Lt)}else if(ft==="k"){const Lt=u(k,ot[0],Y);_(Lt)}else Q(k,ot,Y)}for(let k=1;k<=K;k++){const ot=k,Y=0,nt=0,ft=rt.zero,Lt=rt.one,At=rt.zero,ht=rt.zero,ct=rt.zero;C.push([ot,Y,nt,ft,Lt,At,ht,ct])}for(let k=0;k<mt.constraints.length;k++)gt&&k%1e4===0&&gt.debug(`processing constraints: ${k}/${mt.nConstraints}`),w(...mt.constraints[k])}async function D(rt,mt,gt){await se(M,rt);for(let A=0;A<C.length;A++)await M.writeULE32(C[A][mt]),i&&A%1e6==0&&i.debug(`writing ${gt}: ${A}/${C.length}`);await ce(M)}async function j(rt,mt,gt){let A=new Wt(v*P);for(let u=0;u<C.length;u++)A.set(C[u][mt],u*P),i&&u%1e6==0&&i.debug(`writing ${gt}: ${u}/${C.length}`);await se(M,rt),await J(A),await ce(M),A=await B.batchFromMontgomery(A),O[gt]=await s.G1.multiExpAffine(p,A,i,"multiexp "+gt)}async function J(rt){const mt=await B.ifft(rt),gt=new Wt(v*P*4);gt.set(mt,0);const A=await B.fft(gt);await M.write(mt),await M.write(A)}async function tt(rt,mt){await se(M,rt);const gt=new Uint8Array(2*4+2*P),A=new DataView(gt.buffer);for(let u=0;u<N.length;u++){const F=N[u];let _=0;A.setUint32(_,F[0],!0),_+=4,A.setUint32(_,F[1],!0),_+=4,gt.set(F[2],_),_+=P,gt.set(F[3],_),_+=P,await M.write(gt),i&&u%1e6==0&&i.debug(`writing ${mt}: ${u}/${N.length}`)}await ce(M)}async function $(rt,mt){const gt=new Wt(P*v*3),A=new Ye(T),u=new Ye(T);let F=B.one;for(let k=0;k<v;k++)k<C.length?(w(C[k][0],k),w(C[k][1],v+k),w(C[k][2],v*2+k)):(w(0,k),w(0,v+k),w(0,v*2+k)),F=B.mul(F,B.w[V]),i&&k%1e6==0&&i.debug(`writing ${mt} phase1: ${k}/${C.length}`);for(let k=0;k<T;k++)typeof u[k]<"u"?gt.set(A[k],u[k]*P):console.log("Variable not used"),i&&k%1e6==0&&i.debug(`writing ${mt} phase2: ${k}/${T}`);globalThis.gc&&globalThis.gc(),await se(M,rt);let _=gt.slice(0,v*P);await J(_),globalThis.gc&&globalThis.gc();let Q=gt.slice(v*P,v*P*2);await J(Q),globalThis.gc&&globalThis.gc();let G=gt.slice(v*P*2,v*P*3);await J(G),globalThis.gc&&globalThis.gc(),await ce(M),_=await B.batchFromMontgomery(_),Q=await B.batchFromMontgomery(Q),G=await B.batchFromMontgomery(G),O.S1=await s.G1.multiExpAffine(p,_,i,"multiexp S1"),globalThis.gc&&globalThis.gc(),O.S2=await s.G1.multiExpAffine(p,Q,i,"multiexp S2"),globalThis.gc&&globalThis.gc(),O.S3=await s.G1.multiExpAffine(p,G,i,"multiexp S3"),globalThis.gc&&globalThis.gc();function w(k,ot){typeof A[k]>"u"?u[k]=ot:gt.set(A[k],ot*P);let Y;ot<v?Y=F:ot<2*v?Y=B.mul(F,U):Y=B.mul(F,q),A[k]=Y}}async function et(rt,mt){await se(M,rt);const gt=Math.max(K,1);for(let A=0;A<gt;A++){let u=new Wt(v*P);u.set(B.one,A*P),await J(u),i&&i.debug(`writing ${mt} ${A}/${gt}`)}await ce(M)}async function X(){await se(M,1),await M.writeULE32(2),await ce(M),await se(M,2);const rt=s.q,mt=(Math.floor((Zt.bitLength(rt)-1)/64)+1)*8,gt=s.r,A=(Math.floor((Zt.bitLength(gt)-1)/64)+1)*8;await M.writeULE32(mt),await oi(M,rt,mt),await M.writeULE32(A),await oi(M,gt,A),await M.writeULE32(T),await M.writeULE32(K),await M.writeULE32(v),await M.writeULE32(N.length),await M.writeULE32(C.length),await M.write(U),await M.write(q),await M.write(I.toAffine(O.Qm)),await M.write(I.toAffine(O.Ql)),await M.write(I.toAffine(O.Qr)),await M.write(I.toAffine(O.Qo)),await M.write(I.toAffine(O.Qc)),await M.write(I.toAffine(O.S1)),await M.write(I.toAffine(O.S2)),await M.write(I.toAffine(O.S3));let u;u=await a.read(g,o[3][0].p+g),await M.write(u),await ce(M)}function dt(){let rt=B.two;for(;gt(rt,[],V);)B.add(rt,B.one);let mt=B.add(rt,B.one);for(;gt(mt,[rt],V);)B.add(mt,B.one);return[rt,mt];function gt(A,u,F){const _=2**F;let Q=B.one;for(let G=0;G<_;G++){if(B.eq(A,Q))return!0;for(let w=0;w<u.length;w++)if(B.eq(A,B.mul(u[w],Q)))return!0;Q=B.mul(Q,B.w[F])}return!1}}}var np={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(e){(function(){var t="input is invalid type",n="finalize already called",i=typeof window=="object",a=i?window:{};a.JS_SHA3_NO_WINDOW&&(i=!1);var o=!i&&typeof self=="object",s=!a.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;s?a=Oa:o&&(a=self);var d=!a.JS_SHA3_NO_COMMON_JS&&!0&&e.exports,h=!a.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",f="0123456789abcdef".split(""),l=[31,7936,2031616,520093696],m=[4,1024,262144,67108864],I=[1,256,65536,16777216],g=[6,1536,393216,100663296],B=[0,8,16,24],P=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],C=[224,256,384,512],N=[128,256],T=["hex","buffer","arrayBuffer","array","digest"],K={128:168,256:136};(a.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(A){return Object.prototype.toString.call(A)==="[object Array]"}),h&&(a.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(A){return typeof A=="object"&&A.buffer&&A.buffer.constructor===ArrayBuffer});for(var M=function(A,u,F){return function(_){return new rt(A,u,A).update(_)[F]()}},V=function(A,u,F){return function(_,Q){return new rt(A,u,Q).update(_)[F]()}},v=function(A,u,F){return function(_,Q,G,w){return D["cshake"+A].update(_,Q,G,w)[F]()}},p=function(A,u,F){return function(_,Q,G,w){return D["kmac"+A].update(_,Q,G,w)[F]()}},L=function(A,u,F,_){for(var Q=0;Q<T.length;++Q){var G=T[Q];A[G]=u(F,_,G)}return A},U=function(A,u){var F=M(A,u,"hex");return F.create=function(){return new rt(A,u,A)},F.update=function(_){return F.create().update(_)},L(F,M,A,u)},q=function(A,u){var F=V(A,u,"hex");return F.create=function(_){return new rt(A,u,_)},F.update=function(_,Q){return F.create(Q).update(_)},L(F,V,A,u)},O=function(A,u){var F=K[A],_=v(A,u,"hex");return _.create=function(Q,G,w){return!G&&!w?D["shake"+A].create(Q):new rt(A,u,Q).bytepad([G,w],F)},_.update=function(Q,G,w,k){return _.create(G,w,k).update(Q)},L(_,v,A,u)},R=function(A,u){var F=K[A],_=p(A,u,"hex");return _.create=function(Q,G,w){return new mt(A,u,G).bytepad(["KMAC",w],F).bytepad([Q],F)},_.update=function(Q,G,w,k){return _.create(Q,w,k).update(G)},L(_,p,A,u)},b=[{name:"keccak",padding:I,bits:C,createMethod:U},{name:"sha3",padding:g,bits:C,createMethod:U},{name:"shake",padding:l,bits:N,createMethod:q},{name:"cshake",padding:m,bits:N,createMethod:O},{name:"kmac",padding:m,bits:N,createMethod:R}],D={},j=[],J=0;J<b.length;++J)for(var tt=b[J],$=tt.bits,et=0;et<$.length;++et){var X=tt.name+"_"+$[et];if(j.push(X),D[X]=tt.createMethod($[et],tt.padding),tt.name!=="sha3"){var dt=tt.name+$[et];j.push(dt),D[dt]=D[X]}}function rt(A,u,F){this.blocks=[],this.s=[],this.padding=u,this.outputBits=F,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(A<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=F>>5,this.extraBytes=(F&31)>>3;for(var _=0;_<50;++_)this.s[_]=0}rt.prototype.update=function(A){if(this.finalized)throw new Error(n);var u,F=typeof A;if(F!=="string"){if(F==="object"){if(A===null)throw new Error(t);if(h&&A.constructor===ArrayBuffer)A=new Uint8Array(A);else if(!Array.isArray(A)&&(!h||!ArrayBuffer.isView(A)))throw new Error(t)}else throw new Error(t);u=!0}for(var _=this.blocks,Q=this.byteCount,G=A.length,w=this.blockCount,k=0,ot=this.s,Y,nt;k<G;){if(this.reset)for(this.reset=!1,_[0]=this.block,Y=1;Y<w+1;++Y)_[Y]=0;if(u)for(Y=this.start;k<G&&Y<Q;++k)_[Y>>2]|=A[k]<<B[Y++&3];else for(Y=this.start;k<G&&Y<Q;++k)nt=A.charCodeAt(k),nt<128?_[Y>>2]|=nt<<B[Y++&3]:nt<2048?(_[Y>>2]|=(192|nt>>6)<<B[Y++&3],_[Y>>2]|=(128|nt&63)<<B[Y++&3]):nt<55296||nt>=57344?(_[Y>>2]|=(224|nt>>12)<<B[Y++&3],_[Y>>2]|=(128|nt>>6&63)<<B[Y++&3],_[Y>>2]|=(128|nt&63)<<B[Y++&3]):(nt=65536+((nt&1023)<<10|A.charCodeAt(++k)&1023),_[Y>>2]|=(240|nt>>18)<<B[Y++&3],_[Y>>2]|=(128|nt>>12&63)<<B[Y++&3],_[Y>>2]|=(128|nt>>6&63)<<B[Y++&3],_[Y>>2]|=(128|nt&63)<<B[Y++&3]);if(this.lastByteIndex=Y,Y>=Q){for(this.start=Y-Q,this.block=_[w],Y=0;Y<w;++Y)ot[Y]^=_[Y];gt(ot),this.reset=!0}else this.start=Y}return this},rt.prototype.encode=function(A,u){var F=A&255,_=1,Q=[F];for(A=A>>8,F=A&255;F>0;)Q.unshift(F),A=A>>8,F=A&255,++_;return u?Q.push(_):Q.unshift(_),this.update(Q),Q.length},rt.prototype.encodeString=function(A){var u,F=typeof A;if(F!=="string"){if(F==="object"){if(A===null)throw new Error(t);if(h&&A.constructor===ArrayBuffer)A=new Uint8Array(A);else if(!Array.isArray(A)&&(!h||!ArrayBuffer.isView(A)))throw new Error(t)}else throw new Error(t);u=!0}var _=0,Q=A.length;if(u)_=Q;else for(var G=0;G<A.length;++G){var w=A.charCodeAt(G);w<128?_+=1:w<2048?_+=2:w<55296||w>=57344?_+=3:(w=65536+((w&1023)<<10|A.charCodeAt(++G)&1023),_+=4)}return _+=this.encode(_*8),this.update(A),_},rt.prototype.bytepad=function(A,u){for(var F=this.encode(u),_=0;_<A.length;++_)F+=this.encodeString(A[_]);var Q=u-F%u,G=[];return G.length=Q,this.update(G),this},rt.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var A=this.blocks,u=this.lastByteIndex,F=this.blockCount,_=this.s;if(A[u>>2]|=this.padding[u&3],this.lastByteIndex===this.byteCount)for(A[0]=A[F],u=1;u<F+1;++u)A[u]=0;for(A[F-1]|=2147483648,u=0;u<F;++u)_[u]^=A[u];gt(_)}},rt.prototype.toString=rt.prototype.hex=function(){this.finalize();for(var A=this.blockCount,u=this.s,F=this.outputBlocks,_=this.extraBytes,Q=0,G=0,w="",k;G<F;){for(Q=0;Q<A&&G<F;++Q,++G)k=u[Q],w+=f[k>>4&15]+f[k&15]+f[k>>12&15]+f[k>>8&15]+f[k>>20&15]+f[k>>16&15]+f[k>>28&15]+f[k>>24&15];G%A===0&&(gt(u),Q=0)}return _&&(k=u[Q],w+=f[k>>4&15]+f[k&15],_>1&&(w+=f[k>>12&15]+f[k>>8&15]),_>2&&(w+=f[k>>20&15]+f[k>>16&15])),w},rt.prototype.arrayBuffer=function(){this.finalize();var A=this.blockCount,u=this.s,F=this.outputBlocks,_=this.extraBytes,Q=0,G=0,w=this.outputBits>>3,k;_?k=new ArrayBuffer(F+1<<2):k=new ArrayBuffer(w);for(var ot=new Uint32Array(k);G<F;){for(Q=0;Q<A&&G<F;++Q,++G)ot[G]=u[Q];G%A===0&&gt(u)}return _&&(ot[Q]=u[Q],k=k.slice(0,w)),k},rt.prototype.buffer=rt.prototype.arrayBuffer,rt.prototype.digest=rt.prototype.array=function(){this.finalize();for(var A=this.blockCount,u=this.s,F=this.outputBlocks,_=this.extraBytes,Q=0,G=0,w=[],k,ot;G<F;){for(Q=0;Q<A&&G<F;++Q,++G)k=G<<2,ot=u[Q],w[k]=ot&255,w[k+1]=ot>>8&255,w[k+2]=ot>>16&255,w[k+3]=ot>>24&255;G%A===0&&gt(u)}return _&&(k=G<<2,ot=u[Q],w[k]=ot&255,_>1&&(w[k+1]=ot>>8&255),_>2&&(w[k+2]=ot>>16&255)),w};function mt(A,u,F){rt.call(this,A,u,F)}mt.prototype=new rt,mt.prototype.finalize=function(){return this.encode(this.outputBits,!0),rt.prototype.finalize.call(this)};var gt=function(A){var u,F,_,Q,G,w,k,ot,Y,nt,ft,Lt,At,ht,ct,_t,wt,Et,Tt,Nt,kt,Kt,Mt,bt,Ht,Qt,Yt,E,r,c,y,S,x,z,W,Z,at,st,it,ut,Ct,It,yt,Ft,vt,Dt,Bt,xt,St,Vt,me,Pe,ci,Ln,An,li,yn,wn,di,cn,$e,Mn,Fa;for(_=0;_<48;_+=2)Q=A[0]^A[10]^A[20]^A[30]^A[40],G=A[1]^A[11]^A[21]^A[31]^A[41],w=A[2]^A[12]^A[22]^A[32]^A[42],k=A[3]^A[13]^A[23]^A[33]^A[43],ot=A[4]^A[14]^A[24]^A[34]^A[44],Y=A[5]^A[15]^A[25]^A[35]^A[45],nt=A[6]^A[16]^A[26]^A[36]^A[46],ft=A[7]^A[17]^A[27]^A[37]^A[47],Lt=A[8]^A[18]^A[28]^A[38]^A[48],At=A[9]^A[19]^A[29]^A[39]^A[49],u=Lt^(w<<1|k>>>31),F=At^(k<<1|w>>>31),A[0]^=u,A[1]^=F,A[10]^=u,A[11]^=F,A[20]^=u,A[21]^=F,A[30]^=u,A[31]^=F,A[40]^=u,A[41]^=F,u=Q^(ot<<1|Y>>>31),F=G^(Y<<1|ot>>>31),A[2]^=u,A[3]^=F,A[12]^=u,A[13]^=F,A[22]^=u,A[23]^=F,A[32]^=u,A[33]^=F,A[42]^=u,A[43]^=F,u=w^(nt<<1|ft>>>31),F=k^(ft<<1|nt>>>31),A[4]^=u,A[5]^=F,A[14]^=u,A[15]^=F,A[24]^=u,A[25]^=F,A[34]^=u,A[35]^=F,A[44]^=u,A[45]^=F,u=ot^(Lt<<1|At>>>31),F=Y^(At<<1|Lt>>>31),A[6]^=u,A[7]^=F,A[16]^=u,A[17]^=F,A[26]^=u,A[27]^=F,A[36]^=u,A[37]^=F,A[46]^=u,A[47]^=F,u=nt^(Q<<1|G>>>31),F=ft^(G<<1|Q>>>31),A[8]^=u,A[9]^=F,A[18]^=u,A[19]^=F,A[28]^=u,A[29]^=F,A[38]^=u,A[39]^=F,A[48]^=u,A[49]^=F,ht=A[0],ct=A[1],Dt=A[11]<<4|A[10]>>>28,Bt=A[10]<<4|A[11]>>>28,E=A[20]<<3|A[21]>>>29,r=A[21]<<3|A[20]>>>29,cn=A[31]<<9|A[30]>>>23,$e=A[30]<<9|A[31]>>>23,It=A[40]<<18|A[41]>>>14,yt=A[41]<<18|A[40]>>>14,z=A[2]<<1|A[3]>>>31,W=A[3]<<1|A[2]>>>31,_t=A[13]<<12|A[12]>>>20,wt=A[12]<<12|A[13]>>>20,xt=A[22]<<10|A[23]>>>22,St=A[23]<<10|A[22]>>>22,c=A[33]<<13|A[32]>>>19,y=A[32]<<13|A[33]>>>19,Mn=A[42]<<2|A[43]>>>30,Fa=A[43]<<2|A[42]>>>30,Ln=A[5]<<30|A[4]>>>2,An=A[4]<<30|A[5]>>>2,Z=A[14]<<6|A[15]>>>26,at=A[15]<<6|A[14]>>>26,Et=A[25]<<11|A[24]>>>21,Tt=A[24]<<11|A[25]>>>21,Vt=A[34]<<15|A[35]>>>17,me=A[35]<<15|A[34]>>>17,S=A[45]<<29|A[44]>>>3,x=A[44]<<29|A[45]>>>3,bt=A[6]<<28|A[7]>>>4,Ht=A[7]<<28|A[6]>>>4,li=A[17]<<23|A[16]>>>9,yn=A[16]<<23|A[17]>>>9,st=A[26]<<25|A[27]>>>7,it=A[27]<<25|A[26]>>>7,Nt=A[36]<<21|A[37]>>>11,kt=A[37]<<21|A[36]>>>11,Pe=A[47]<<24|A[46]>>>8,ci=A[46]<<24|A[47]>>>8,Ft=A[8]<<27|A[9]>>>5,vt=A[9]<<27|A[8]>>>5,Qt=A[18]<<20|A[19]>>>12,Yt=A[19]<<20|A[18]>>>12,wn=A[29]<<7|A[28]>>>25,di=A[28]<<7|A[29]>>>25,ut=A[38]<<8|A[39]>>>24,Ct=A[39]<<8|A[38]>>>24,Kt=A[48]<<14|A[49]>>>18,Mt=A[49]<<14|A[48]>>>18,A[0]=ht^~_t&Et,A[1]=ct^~wt&Tt,A[10]=bt^~Qt&E,A[11]=Ht^~Yt&r,A[20]=z^~Z&st,A[21]=W^~at&it,A[30]=Ft^~Dt&xt,A[31]=vt^~Bt&St,A[40]=Ln^~li&wn,A[41]=An^~yn&di,A[2]=_t^~Et&Nt,A[3]=wt^~Tt&kt,A[12]=Qt^~E&c,A[13]=Yt^~r&y,A[22]=Z^~st&ut,A[23]=at^~it&Ct,A[32]=Dt^~xt&Vt,A[33]=Bt^~St&me,A[42]=li^~wn&cn,A[43]=yn^~di&$e,A[4]=Et^~Nt&Kt,A[5]=Tt^~kt&Mt,A[14]=E^~c&S,A[15]=r^~y&x,A[24]=st^~ut&It,A[25]=it^~Ct&yt,A[34]=xt^~Vt&Pe,A[35]=St^~me&ci,A[44]=wn^~cn&Mn,A[45]=di^~$e&Fa,A[6]=Nt^~Kt&ht,A[7]=kt^~Mt&ct,A[16]=c^~S&bt,A[17]=y^~x&Ht,A[26]=ut^~It&z,A[27]=Ct^~yt&W,A[36]=Vt^~Pe&Ft,A[37]=me^~ci&vt,A[46]=cn^~Mn&Ln,A[47]=$e^~Fa&An,A[8]=Kt^~ht&_t,A[9]=Mt^~ct&wt,A[18]=S^~bt&Qt,A[19]=x^~Ht&Yt,A[28]=It^~z&Z,A[29]=yt^~W&at,A[38]=Pe^~Ft&Dt,A[39]=ci^~vt&Bt,A[48]=Mn^~Ln&li,A[49]=Fa^~An&yn,A[0]^=P[_],A[1]^=P[_+1]};if(d)e.exports=D;else for(J=0;J<j.length;++J)a[j[J]]=D[j[J]]})()})(np);let Sa,Jt,yd,ur;async function wd(e){const t=await Xn;for(var n of e)t.fs.writeFileSync(n.name,Ic(n.value));const i=e.find(o=>o.active&&o.value.includes("component main"))?.name||e.find(o=>o.name==="main.circom")?.name||e.find(o=>o.value.includes("component main"))?.name||"main.circom";return Jt=i.replace(/\..*$/,""),{mainCode:e.find(o=>o.name===i).value,wasmFs:t,fileName:i}}async function ip(e){const t=performance.now(),{mainCode:n,wasmFs:i,fileName:a}=await wd(e),o=/\/\/\s*zkrepl:\s*(.*)/i.exec(n),s=o?o[1].split(/[\s,]+/):[],d={nowasm:s.includes("nowasm"),nor1cs:s.includes("nor1cs"),nosym:s.includes("nosym"),nowtns:s.includes("nowtns")};await m2(a,d);const h=i.fs.readFileSync("/dev/stderr","utf8");h&&postMessage({type:"stderr",text:h});let f=await i.getStdOut();postMessage({type:"stdout",text:f+`Compiled in ${((performance.now()-t)/1e3).toFixed(2)}s`});let l,m=[],I,g;d.nowasm||(I=i.fs.readFileSync(`${Jt}_js/${Jt}.wasm`),d.nowtns||(l=await Sd(I,{log(T){m.push(T.toString())}})));let B;if(!d.nor1cs){g=i.fs.readFileSync(`${Jt}.r1cs`);const{fd:T,sections:K}=await xe(g,"r1cs",1);B=await Wl(T,K,!0),await T.close()}const P=/\/*\s*INPUT\s*=\s*(\{[\s\S]+\})\s*\*\//.exec(n);let C={};P?(C=JSON.parse(P[1]),yd=C):B&&B.nPrvInputs+B.nPubInputs>0&&postMessage({type:"stderr",text:`To specify inputs, add to your circuit: 

INPUT = { "a": "1234" }`});try{l&&(Sa=await l.calculateWTNSBin(C,!0))}finally{m.length>0&&postMessage({type:"log",text:m.join(`
`)})}if(B&&B.nOutputs>0){const{fd:T,sections:K}=await xe(Sa,"wtns",2),M=await bd(T,K),V=await Me(T,K,2);let v={};if(!d.nosym){const L=i.fs.readFileSync(`${Jt}.sym`);let U=0,q=new TextDecoder("utf-8");for(let O=0;O<L.length;O++)if(L[O]===10){let R=q.decode(L.slice(U,O)),b=+R.split(",")[0];b<=B.nOutputs&&(v[b]=R.split(",")[3].replace("main.","")+" = "),U=O}}let p=[];for(let L=1;L<=B.nOutputs;L++){const U=V.slice(L*M.n8,L*M.n8+M.n8),q=v[L]||"";p.push(q+Zt.fromRprLE(U).toString())}postMessage({type:"Output",text:p.join(`
`)}),await T.close()}const N=performance.now()-t;postMessage({type:"Artifacts",text:`Finished in ${(N/1e3).toFixed(2)}s`,done:!0,files:Object.fromEntries(Object.entries({[`${Jt}.wasm`]:I,[`${Jt}.js`]:I&&i.fs.readFileSync(`${Jt}_js/witness_calculator.js`),[`${Jt}.wtns`]:!d.nowtns&&!d.nowasm&&Sa,[`${Jt}.r1cs`]:g,[`${Jt}.sym`]:!d.nosym&&i.fs.readFileSync(`${Jt}.sym`)}).filter(([T,K])=>K))})}function ap(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}async function op(e){const t=await Xn;let n=new RegExp("\\b"+ap(e)+"(\\b|$)"),i=h=>n.test(h),a=[];const o=t.fs.readFileSync(`${Jt}.sym`);let s=0,d=new TextDecoder("utf-8");for(let h=0;h<o.length;h++){if(o[h]!==10)continue;const l=d.decode(o.slice(s,h)).split(",");if(l[3]&&i(l[3])){const{fd:m,sections:I}=await xe(Sa,"wtns",2),g=await bd(m,I),B=await Me(m,I,2),P=parseInt(l[1]);if(P!==-1){const C=B.slice(P*g.n8,P*g.n8+g.n8);a.push("*"+l[3].replace("main.","")+" =* "+Zt.fromRprLE(C).toString())}if(await m.close(),a.length>3){a.push("...");break}}s=h+1}postMessage({type:"hover",text:a.join(`

`)})}onmessage=e=>{const t=e.data;t.type==="run"?ip(t.files).catch(n=>{postMessage({type:"fail",done:!0,text:n.message})}).then(()=>{Id(t.files).catch(n=>{console.error(n)})}):t.type==="hover"?op(t.symbol).catch(n=>{console.log("hover err",n),postMessage({type:"hover",text:""})}):t.type==="groth16"?(ur=t.url,lp().catch(n=>{postMessage({type:"fail",done:!0,text:n.message})})):t.type==="plonk"?(ur=t.url,cp().catch(n=>{postMessage({type:"fail",done:!0,text:n.message})})):t.type==="verify"?rp(t.data).catch(n=>{postMessage({type:"fail",done:!0,text:n.message})}):t.type==="analyze"&&Id(t.files).catch(n=>{console.error(n)})};async function Id(e){const{mainCode:t,wasmFs:n,fileName:i}=await wd(e);console.time("start circomspect"),await p2(i),postMessage({type:"sarif",result:JSON.parse(n.fs.readFileSync("__circomspect.sarif","utf8"))}),console.timeEnd("start circomspect")}async function rp(e){const{r1cs:t,r1csFile:n}=await fr(),i=await hr(t.nConstraints),[a,o]=_r(),s={type:"bigMem"},d=await gd(n,i,s,a);for(;o.pop(););console.log("circuitHash",d);const h=await jg(s,i,new Uint8Array(e),a);postMessage({type:"verified",done:!0,text:h?"\u2705 Successfully verified zkey matches circuit":"\u274C Circuit does not match zkey"}),o.length>0&&postMessage({type:"log",text:o.join(`
`)})}async function fr(){const t=(await Xn).fs.readFileSync(`${Jt}.r1cs`),{fd:n,sections:i}=await xe(t,"r1cs",1),a=await Wl(n,i,!0);return await n.close(),{r1cs:a,r1csFile:t}}function sp(e){return 4*3*e.nConstraints+e.nPubInputs+e.nOutputs}async function cp(){const{r1cs:e,r1csFile:t}=await fr(),n=await hr(sp(e)),i={type:"mem",data:null},[a,o]=_r();await ep(t,n,i,a);const s=JSON.stringify(await dr(i.data),null,"  "),d=await Ad(i.data,{plonk:bh});postMessage({type:"plonk keys",done:!0,files:{[Jt+".plonk.zkey"]:i.data,[Jt+".plonk.vkey.json"]:s,[Jt+".plonk.sol"]:d,[Jt+".plonk.html"]:await Ed(i,s)}})}async function Ed(e,t){const n=await Xn;return Sh.replace('"{{INPUT_JSON}}"',JSON.stringify(yd)).replace('"{{VKEY_DATA}}"',t).replace("{{ZKREPL_URL}}",ur).replace("/*{{SNARK_JS}}*/",Ch).replace("{{ZKEY_DATA}}","data:application/octet-stream;base64,"+Buffer.from(e.data).toString("base64")).replace("{{WASM_URL}}","data:application/wasm;base64,"+Buffer.from(n.fs.readFileSync(`${Jt}_js/${Jt}.wasm`)).toString("base64"))}function _r(){const e=[];return[{info(n){e.push(n),console.log("INFO",n)},warn(n){console.log("WARN",n)},debug(n){},error(n){console.log("ERROR",n)}},e]}async function lp(){const{r1cs:e,r1csFile:t}=await fr(),n=await hr(e.nConstraints),i={type:"mem",data:null},[a,o]=_r(),s=await gd(t,n,i,a),d={type:"mem",data:null},h=globalThis.crypto.getRandomValues(new Uint8Array(512)),f=await Yg(i.data,d,"zkrepl",h);console.log("ZKEY",s,d,f);const l=JSON.stringify(await dr(d.data),null,"  "),m=await Ad(d.data,{groth16:Eh});await Xn,postMessage({type:"groth16 keys",done:!0,files:{[Jt+".groth16.zkey"]:d.data,[Jt+".groth16.vkey.json"]:l,[Jt+".groth16.sol"]:m,[Jt+".groth16.html"]:await Ed(d,l)}})}async function hr(e){const n=[{url:"https://bafybeiazktpgt2ima2wfaw6iqgl34o2l5jddy4e3doptcyrd2prsob4emu.ipfs.dweb.link/powersOfTau28_hez_final_11.ptau",name:"powersOfTau28_hez_final_11.ptau",maxConstraints:2048,size:2442392},{url:"https://bafybeicjy5sx3rxl46qudsfqfa3d6tcbbtzcg3ky5xioj6ni7wrmab74we.ipfs.dweb.link/powersOfTau28_hez_final_12.ptau",name:"powersOfTau28_hez_final_12.ptau",maxConstraints:4096,size:4801688},{url:"https://bafybeihxscoclwj7bklijpc7lsu5bwfv7av3qvtbzamlf3ovkki3pzqlpa.ipfs.dweb.link/powersOfTau28_hez_final_13.ptau",name:"powersOfTau28_hez_final_13.ptau",maxConstraints:8192,size:9520280},{url:"https://bafybeigizi7cwad4bvvcgbzflua5qwxqh223zeexokh7xurhycgjkv6sga.ipfs.dweb.link/powersOfTau28_hez_final_14.ptau",name:"powersOfTau28_hez_final_14.ptau",maxConstraints:16384,size:18957464},{url:"https://bafybeihi5cez3vyfhuuloytld7vdvsdizvbih7x3aa553son7fjvfb6kru.ipfs.dweb.link/powersOfTau28_hez_final_15.ptau",name:"powersOfTau28_hez_final_15.ptau",maxConstraints:32768,size:37831832},{url:"https://bafybeifkc4fasai6londgxwrkrrcdooptnn6227lckkawx2euoxusfutoe.ipfs.dweb.link/powersOfTau28_hez_final_16.ptau",name:"powersOfTau28_hez_final_16.ptau",maxConstraints:65536,size:75580568},{url:"https://bafybeih4ffiue7ac3cnahd2biyu3aqax3avcpwpnftj7etkuj3alp563fi.ipfs.dweb.link/powersOfTau28_hez_final_17.ptau",name:"powersOfTau28_hez_final_17.ptau",maxConstraints:131072,size:151078040},{url:"https://bafybeifg7o3tjsjvphzmghckydrj6cvebzrulgljgzmq2j5fu4g5p3nxpu.ipfs.dweb.link/powersOfTau28_hez_final_18.ptau",name:"powersOfTau28_hez_final_18.ptau",maxConstraints:262144,size:302072984}].find(d=>d.maxConstraints>=e);if(!n)throw new Error("No powers of tau supported for "+e+" constraints");console.log(e,n),postMessage({type:"progress",fraction:null});const i=await fetch(n.url);let a=0;const o=new Response(new ReadableStream({async start(d){const h=i.body.getReader();for(;;){const{done:f,value:l}=await h.read();if(f)break;a+=l.byteLength,postMessage({type:"progress",fraction:a/n.size}),d.enqueue(l)}d.close()}}));return new Uint8Array(await o.arrayBuffer())}async function bd(e,t){await ge(e,t,1);const n=await e.readULE32(),i=await On(e,n),a=await e.readULE32();return await pe(e),{n8:n,q:i,nWitness:a}}})();
