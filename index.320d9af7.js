import{l as h,R as P,w as K,a as e,e as w,K as x,b as C,U as M,_ as T,c as _}from"./vendor.34b805a6.js";const G=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&u(i)}).observe(document,{childList:!0,subtree:!0});function p(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(n){if(n.ep)return;n.ep=!0;const o=p(n);fetch(n.href,o)}};G();h.register({id:"circom"});let L=d=>{};h.registerHoverProvider("circom",{provideHover:async function(d,c){if(!A||A.running)return null;const p=d.getLineContent(c.lineNumber),u=/([a-z$_][a-z0-9$_]*)(\.[a-z$_][a-z0-9$_]*)*(\[\d+\])?/g,n=c.column;let o;if(o=/(include\s+)"([^"]+)"/g.exec(p),o){let i=[];return o[2].startsWith("circomlib/")?i.push({value:`[View Source](https://github.com/iden3/circomlib/blob/master/circuits/${o[2].replace("circomlib/","")})`}):o[2].startsWith("gist:")?i.push({value:`[View Source](https://gist.github.com/${o[2].replace("gist:","")})`}):(o[2].startsWith("http://")||o[2].startsWith("https://"))&&i.push({value:`[View Source](${o[2]})`}),{range:new P(c.lineNumber,1+o.index+o[1].length,c.lineNumber,1+o.index+o[0].length),contents:i}}for(;(o=u.exec(p))&&!(o.index>n);){if(o.index+o[0].length<n)continue;const i=o[0],f=await new Promise(l=>{L=k=>{l(k.text),L=()=>{}},A.postMessage({type:"hover",symbol:i})});return{range:new P(c.lineNumber,1+o.index,c.lineNumber,1+o.index+o[0].length),contents:[{value:f}]}}return null}});h.setLanguageConfiguration("circom",{wordPattern:/(-?\d*\.\d\w*)|([^\`\~\!\@\#\%\^\&\*\(\)\-\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\?\s]+)/g,comments:{lineComment:"//",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],onEnterRules:[{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:h.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:h.IndentAction.None,appendText:" * "}},{beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:h.IndentAction.None,appendText:"* "}},{beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/,action:{indentAction:h.IndentAction.None,removeText:1}}],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"',notIn:["string"]},{open:"'",close:"'",notIn:["string","comment"]},{open:"`",close:"`",notIn:["string","comment"]},{open:"/**",close:" */",notIn:["string"]}],folding:{markers:{start:new RegExp("^\\s*//\\s*#?region\\b"),end:new RegExp("^\\s*//\\s*#?endregion\\b")}}});h.setMonarchTokensProvider("circom",{keywords:["signal","input","output","public","template","component","parallel","custom","var","function","return","if","else","for","while","do","log","assert","include","pragma"],typeKeywords:["input","output","public"],operators:["!","~","-","||","&&","==","!=","<",">","<=",">=","|","&","<<",">>","+","-","*","/","\\","%","**","^","=","<--","<=="],escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,tokenizer:{root:[[/[a-z_$][\w$]*/,{cases:{"@typeKeywords":"keyword","@keywords":"keyword","@default":"identifier"}}],[/[A-Z][\w\$]*/,"type.identifier"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/@\s*[a-zA-Z_\$][\w\$]*/,{token:"annotation",log:"annotation token: $0"}],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F]+/,"number.hex"],[/\d+/,"number"],[/[;,.]/,"delimiter"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/"/,{token:"string.quote",bracket:"@open",next:"@string"}],[/'[^\\']'/,"string"],[/(')(@escapes)(')/,["string","string.escape","string"]],[/'/,"string.invalid"]],comment:[[/[^\/*]+/,"comment"],[/\/\*/,"comment","@push"],["\\*/","comment","@pop"],[/[\/*]/,"comment"]],string:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]]}});var R=`pragma circom 2.0.6;

include "circomlib/poseidon.circom";
// include "https://github.com/0xPARC/circom-secp256k1/blob/master/circuits/bigint.circom";

template Example () {
    signal input a;
    signal input b;
    signal output c;
    
    c <== a * b;

    assert(a > 2);
    
    component hash = Poseidon(2);
    hash.inputs[0] <== a;
    hash.inputs[1] <== b;

    log("hash", hash.out);
}

component main { public [ a ] } = Example();

/* INPUT = {
    "a": "5",
    "b": "77"
} */`;function F(){return new Worker("worker.8ea9a909.js",{type:"module"})}var U="circomlib.acbc52cb.zip";console.log(U,K);var A;function W(){const[d,c]=e.useState(!1),[p,u]=e.useState([]),[n,o]=e.useState(null),i=e.useRef([]),f=e.useRef(null),l=e.useRef(null),[k,z]=e.useState(1),$=e.useRef({}),y=new URLSearchParams(location.search).get("gist"),b=()=>{(!l.current||l.current.running)&&(l.current&&(l.current.terminate(),l.current=null),l.current=new F,A=l.current,l.current.onmessage=t=>{const r=t.data;if(r.done)c(!1),l.current.running=!1;else{if(r.type==="hover")return L(r);if(r.type==="debug")console.log(r.text);else if(r.type==="progress"){z(r.fraction);return}}u(a=>[...a,r])},l.current.onerror=t=>{console.error(t),u(r=>[...r,{type:"error",text:t.message}])}),l.current.running=!0,c(Math.random()+1),u([]),l.current.postMessage({type:"run",files:O(i.current)})},O=t=>t.map(r=>({value:r.getValue(),name:r.uri.path.slice(1),active:r.isAttachedToEditor()})),N=(t,r)=>{const a=[];for(const s in r==null?void 0:r.files){if(s==="about_zkrepl.md")continue;const m=w.createModel((r==null?void 0:r.files[s].content)||"// Unable to load gist","circom",new M().with({path:s}));a.push(m)}i.current=a,t.setModel(a[0])},E=()=>{const t={};for(const r of O(i.current))t[r.name]={content:r.value};return{files:t}},S=()=>{const t=new URLSearchParams(location.search).get("gist"),r=()=>{localStorage.GithubNavigationCodeSnapshot=JSON.stringify(E()),location.href="https://github.com/login/oauth/authorize?client_id=85123c5a3a8a8f73f015&scope=gist"};if(history.state===JSON.stringify(E()))console.log("Already saved!");else if(localStorage.GithubAccessToken){c(Math.random()+1);const a=async s=>{const m=E();return s&&(m.files["about_zkrepl.md"]={content:`Open this in [zkREPL \u2192](https://zkrepl.dev/?gist=${s})

This file can be included into other zkREPLs with \`\`\`include "gist:`+s+'";```'}),fetch(s?"https://api.github.com/gists/"+s:"https://api.github.com/gists",{method:"POST",body:JSON.stringify(m),headers:{Authorization:"token "+localStorage.GithubAccessToken}}).then(g=>g.json())};a(t).then(s=>s.id&&!t?a(s.id):s).then(s=>{s.id?(history.replaceState(JSON.stringify(E()),"","/?gist="+s.id),u(m=>[...m,{type:"save",url:`https://gist.github.com/${s.id}`,text:"Saved to Github"}])):s.message==="Bad credentials"?r():s.message==="Not Found"&&t&&(history.replaceState(null,"","/"),S()),c(!1)})}else r()};e.useEffect(()=>{if(f&&!n){const t=w.create(f.current,{language:"circom",theme:"vs",automaticLayout:!0,hover:{enabled:!0}});window.addEventListener("beforeunload",()=>{sessionStorage.ZKReplState=JSON.stringify(E())}),window.addEventListener("keydown",a=>{(a.metaKey||a.ctrlKey)&&a.key==="r"&&a.preventDefault()}),t.addCommand(x.CtrlCmd|C.KeyS,S),t.addCommand(x.CtrlCmd|C.Enter,b),t.addCommand(x.Shift|C.Enter,b),t.addCommand(x.CtrlCmd|C.Period,function(){console.log("Abort kernel!"),c(!1),u(a=>[...a,{type:"abort",text:"Execution manually interrupted"}]),l.current&&(l.current.terminate(),l.current=null)});const r=new URLSearchParams(location.search).get("code");r?(history.replaceState(null,"","/"),fetch("https://kikks470wl.execute-api.us-west-1.amazonaws.com/access_token?code="+r,{method:"POST"}).then(a=>a.formData()).then(a=>{a.get("access_token")?(localStorage.GithubAccessToken=a.get("access_token"),N(t,JSON.parse(localStorage.GithubNavigationCodeSnapshot)),S()):alert("Failed to get access token")})):sessionStorage.ZKReplState?(N(t,JSON.parse(sessionStorage.ZKReplState)),delete sessionStorage.ZKReplState,b()):y?fetch("https://api.github.com/gists/"+y).then(a=>a.json()).then(a=>{N(t,a),b()}):(N(t,{files:{"main.circom":{content:R}}}),b()),o(t)}return()=>n==null?void 0:n.dispose()},[f.current]);const I=t=>{const r=n==null?void 0:n.saveViewState();r&&(n==null?void 0:n.getModel())&&($.current[n==null?void 0:n.getModel().uri.path]=r),n==null||n.setModel(t),$.current[t.uri.path]&&(n==null||n.restoreViewState($.current[t.uri.path])),u(a=>a.slice(0))};return e.createElement("div",{className:"layout"},e.createElement("div",{className:"primary"},e.createElement("div",{className:"tabs"},i.current.map((t,r)=>{const a=s=>{var m;if((((m=t==null?void 0:t.getValue())==null?void 0:m.length)||0)<30||(t==null?void 0:t.getValue())===R||confirm(`Are you sure you want to remove "${t.uri.path.slice(1)}"?`)){if(t.dispose(),i.current.length==1){const g=w.createModel(R,"circom",new M().with({path:"main.circom"}));i.current.push(g),n.setModel(g)}i.current.splice(r,1),n==null||n.setModel(i.current[0]),u(g=>g.slice(0)),s.stopPropagation()}};return e.createElement("div",{className:"tab "+((n==null?void 0:n.getModel().uri.path)===t.uri.path?"active":"inactive"),onClick:s=>{I(t)},onMouseUp:s=>{s.button==1&&a(s)},key:r},e.createElement("input",{value:t.uri.path.slice(1),spellCheck:!1,onChange:s=>{const m=s.target.value;if(!i.current.some(v=>v.uri.path==="/"+m)){const v=w.createModel(t.getValue(),"circom",new M().with({path:m}));t.dispose(),i.current.splice(r,1,v),n==null||n.setModel(v)}s.target.style.width="0px",s.target.style.width=s.target.scrollWidth+2+"px",u(v=>v.slice(0))},ref:s=>{s&&(s.style.width="0px",s.style.width=s.scrollWidth+2+"px")}}),e.createElement("div",{className:"x",onClick:a},e.createElement("div",null,"\xD7")))}),e.createElement("div",{className:"add",onClick:()=>{let t="untitled.circom";for(let a=2;i.current.some(s=>s.uri.path=="/"+t);a++)t=`untitled${a}.circom`;const r=w.createModel(R,"circom",new M().with({path:t}));i.current.push(r),n.setModel(r),u(p.slice(0))}},"+ Add File")),e.createElement("div",{className:"editor",ref:f})),e.createElement("div",{className:"sidebar"},e.createElement("div",{className:"output"},e.createElement("div",{className:"heading"},e.createElement("div",{className:"description"},e.createElement("b",null,"Shift-Enter")," to"," ",e.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),b()}},"run")," ",e.createElement("br",null),e.createElement("b",null,"Cmd-S")," to"," ",e.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),S()}},"save")," ","as"," ",y?e.createElement("a",{href:`https://gist.github.com/${y}`,target:"_blank"},"Github Gist"):"Github Gist"),e.createElement("img",{className:"logo",src:new URL("logo.effa8f98.png",self.location).toString(),alt:"zkrepl"})),e.createElement("br",null),p.map((t,r)=>e.createElement("div",{key:r,className:"message"},e.createElement("div",{className:"label"},t.type,": "),t.type==="groth16 keys"&&e.createElement("div",{className:"insecure"},"WARNING: These keys are strictly for testing purposes, and are generated without a proper trusted setup!"),t.url?e.createElement("a",{href:t.url},e.createElement(T,null,t.text)):e.createElement(T,null,t.text),t.type==="save"&&e.createElement("div",{className:"embed-snippet"},e.createElement("textarea",{readOnly:!0,onClick:a=>{a.target.select(),document.execCommand("copy")},value:`<iframe src="https://zkrepl.dev/?gist=${y}" height="400" width="1000" style="border:1px solid #ddd"></iframe>`})),t.files&&e.createElement("div",{className:"files"},Object.entries(t.files).map(([a,s])=>e.createElement("li",{key:a},e.createElement("a",{href:URL.createObjectURL(new Blob([s],{type:"application/octet-stream"})),download:a},a)," ","(",(s.length/1e3).toFixed(2),"KB)"))))),!d&&l.current&&e.createElement("div",null,e.createElement("div",{className:"label"},"Keys + Solidity + HTML:"," "),e.createElement("div",{className:"phase2"},e.createElement("input",{type:"file",id:"zkey_upload",accept:".zkey",className:"hidden-file",onChange:t=>{var a,s;const r=(s=(a=t.target)==null?void 0:a.files)==null?void 0:s[0];if(r){const m=new FileReader;m.onload=()=>{l.current.postMessage({type:"verify",data:m.result}),c(Math.random())},m.readAsArrayBuffer(r)}}}),e.createElement("button",{onClick:()=>{l.current.postMessage({type:"groth16",url:location.href}),c(Math.random())},title:"Click here to generate Groth16 prover and verifier keys, as well as a solidity verifier contract, and a sample interactive SnarkJS web application. Note that the Groth16 proving system requires a per-circuit trusted setup, and this implementation only adds a single contribution which is insufficient for production. "},"Groth16"),e.createElement("button",{onClick:()=>{l.current.postMessage({type:"plonk",url:location.href}),c(Math.random())},title:"Click here to generate PLONK prover and verifier keys, as well as a solidity verifier contract, and a sample interactive SnarkJS web application."},"PLONK"),e.createElement("button",{title:"Upload a ZKey here to check that it is compiled from the same source code as this current zkREPL.",onClick:()=>{document.getElementById("zkey_upload").click()}},"Verify"))),k!==1&&e.createElement("div",{className:"progress-container"},e.createElement("progress",{value:k})),d?e.createElement(J,{key:d}):null)))}function J(){const[d,c]=e.useState(0);return e.useEffect(()=>{const p=Date.now(),u=setInterval(()=>{c(Date.now()-p)},16);return()=>clearInterval(u)},[]),e.createElement("div",{className:"loading"},e.createElement("div",{className:"lds-ellipsis"},e.createElement("div",null),e.createElement("div",null),e.createElement("div",null),e.createElement("div",null)),d>200&&e.createElement("div",{className:"time"},(d/1e3).toFixed(2),"s"),e.createElement("div",{className:"time"},e.createElement("small",null,e.createElement("b",null,"Cmd-.")," to interrupt")))}_.createRoot(document.getElementById("root")).render(e.createElement(W,null));
